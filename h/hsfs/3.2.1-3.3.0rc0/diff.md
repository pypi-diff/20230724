# Comparing `tmp/hsfs-3.2.1.tar.gz` & `tmp/hsfs-3.3.0rc0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "hsfs-3.2.1.tar", last modified: Mon Jul 24 10:06:24 2023, max compression
+gzip compressed data, was "hsfs-3.3.0rc0.tar", last modified: Mon Jul  3 11:50:55 2023, max compression
```

## Comparing `hsfs-3.2.1.tar` & `hsfs-3.3.0rc0.tar`

### file list

```diff
@@ -1,109 +1,111 @@
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.261813 hsfs-3.2.1/
--rw-r--r--   0     1006     1006       40 2023-06-05 14:18:50.000000 hsfs-3.2.1/MANIFEST.in
--rw-r--r--   0     1006     1006     7708 2023-07-24 10:06:24.261813 hsfs-3.2.1/PKG-INFO
--rw-r--r--   0     1006     1006     5539 2023-07-24 10:06:23.000000 hsfs-3.2.1/README.md
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.237813 hsfs-3.2.1/hsfs/
--rw-r--r--   0     1006     1006     1182 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/__init__.py
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.241813 hsfs-3.2.1/hsfs/client/
--rw-r--r--   0     1006     1006     1694 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/client/__init__.py
--rw-r--r--   0     1006     1006     1132 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/client/auth.py
--rw-r--r--   0     1006     1006     6622 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/client/base.py
--rw-r--r--   0     1006     1006     2090 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/client/exceptions.py
--rw-r--r--   0     1006     1006    11621 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/client/external.py
--rw-r--r--   0     1006     1006     7924 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/client/hopsworks.py
--rw-r--r--   0     1006     1006     1536 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/code.py
--rw-r--r--   0     1006     1006    18899 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/connection.py
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.245813 hsfs-3.2.1/hsfs/constructor/
--rw-r--r--   0     1006     1006      605 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/constructor/__init__.py
--rw-r--r--   0     1006     1006     1261 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/constructor/external_feature_group_alias.py
--rw-r--r--   0     1006     1006     5106 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/constructor/filter.py
--rw-r--r--   0     1006     1006     2981 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/constructor/fs_query.py
--rw-r--r--   0     1006     1006     1731 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/constructor/hudi_feature_group_alias.py
--rw-r--r--   0     1006     1006     2152 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/constructor/join.py
--rw-r--r--   0     1006     1006     1577 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/constructor/prepared_statement_parameter.py
--rw-r--r--   0     1006     1006    20138 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/constructor/query.py
--rw-r--r--   0     1006     1006     3331 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/constructor/serving_prepared_statement.py
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.261813 hsfs-3.2.1/hsfs/core/
--rw-r--r--   0     1006     1006      605 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/__init__.py
--rw-r--r--   0     1006     1006     3688 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/builtin_transformation_function.py
--rw-r--r--   0     1006     1006     1853 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/code_api.py
--rw-r--r--   0     1006     1006     3292 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/code_engine.py
--rw-r--r--   0     1006     1006     3509 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/dataset_api.py
--rw-r--r--   0     1006     1006     1030 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/deltastreamer_jobconf.py
--rw-r--r--   0     1006     1006     1609 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/execution.py
--rw-r--r--   0     1006     1006     5396 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/expectation_api.py
--rw-r--r--   0     1006     1006     2632 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/expectation_engine.py
--rw-r--r--   0     1006     1006     6356 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/expectation_suite_api.py
--rw-r--r--   0     1006     1006     4061 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/expectation_suite_engine.py
--rw-r--r--   0     1006     1006     9792 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/explicit_provenance.py
--rw-r--r--   0     1006     1006     5418 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/external_feature_group_engine.py
--rw-r--r--   0     1006     1006    13334 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/feature_group_api.py
--rw-r--r--   0     1006     1006     6610 2023-07-14 08:54:50.000000 hsfs-3.2.1/hsfs/core/feature_group_base_engine.py
--rw-r--r--   0     1006     1006    13164 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/feature_group_engine.py
--rw-r--r--   0     1006     1006     1238 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/feature_store_api.py
--rw-r--r--   0     1006     1006     9739 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/feature_view_api.py
--rw-r--r--   0     1006     1006    24896 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/feature_view_engine.py
--rw-r--r--   0     1006     1006     5024 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/great_expectation_engine.py
--rw-r--r--   0     1006     1006      828 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/hosts_api.py
--rw-r--r--   0     1006     1006    11546 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/hudi_engine.py
--rw-r--r--   0     1006     1006     1211 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/ingestion_job.py
--rw-r--r--   0     1006     1006     2262 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/ingestion_job_conf.py
--rw-r--r--   0     1006     1006     1077 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/inode.py
--rw-r--r--   0     1006     1006     2906 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/job.py
--rw-r--r--   0     1006     1006     2004 2023-07-14 08:54:50.000000 hsfs-3.2.1/hsfs/core/job_api.py
--rw-r--r--   0     1006     1006     2048 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/job_configuration.py
--rw-r--r--   0     1006     1006     1530 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/kafka_api.py
--rw-r--r--   0     1006     1006      898 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/project_api.py
--rw-r--r--   0     1006     1006     1093 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/query_constructor_api.py
--rw-r--r--   0     1006     1006      875 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/services_api.py
--rw-r--r--   0     1006     1006     4204 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/statistics_api.py
--rw-r--r--   0     1006     1006     8159 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/statistics_engine.py
--rw-r--r--   0     1006     1006     2325 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/storage_connector_api.py
--rw-r--r--   0     1006     1006     4696 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/tags_api.py
--rw-r--r--   0     1006     1006     6685 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/training_dataset_api.py
--rw-r--r--   0     1006     1006     6357 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/training_dataset_engine.py
--rw-r--r--   0     1006     1006     2148 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/training_dataset_job_conf.py
--rw-r--r--   0     1006     1006     4161 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/core/transformation_function_api.py
--rw-r--r--   0     1006     1006    14792 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/transformation_function_engine.py
--rw-r--r--   0     1006     1006     4773 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/validation_report_api.py
--rw-r--r--   0     1006     1006     3640 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/validation_report_engine.py
--rw-r--r--   0     1006     1006     2158 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/validation_result_api.py
--rw-r--r--   0     1006     1006     5469 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/core/validation_result_engine.py
--rw-r--r--   0     1006     1006     1261 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/variable_api.py
--rw-r--r--   0     1006     1006    18519 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/core/vector_server.py
--rw-r--r--   0     1006     1006     1655 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/decorators.py
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.261813 hsfs-3.2.1/hsfs/engine/
--rw-r--r--   0     1006     1006     2244 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/engine/__init__.py
--rw-r--r--   0     1006     1006    46955 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/engine/python.py
--rw-r--r--   0     1006     1006    43466 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/engine/spark.py
--rw-r--r--   0     1006     1006    23594 2023-06-26 14:55:39.000000 hsfs-3.2.1/hsfs/expectation_suite.py
--rw-r--r--   0     1006     1006     6857 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/feature.py
--rw-r--r--   0     1006     1006   110697 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/feature_group.py
--rw-r--r--   0     1006     1006     3338 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/feature_group_commit.py
--rw-r--r--   0     1006     1006     1986 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/feature_group_writer.py
--rw-r--r--   0     1006     1006    62935 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/feature_store.py
--rw-r--r--   0     1006     1006    95713 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/feature_view.py
--rw-r--r--   0     1006     1006     4822 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/ge_expectation.py
--rw-r--r--   0     1006     1006     8633 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/ge_validation_result.py
--rw-r--r--   0     1006     1006     1450 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/split_statistics.py
--rw-r--r--   0     1006     1006     2893 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/statistics.py
--rw-r--r--   0     1006     1006     3313 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/statistics_config.py
--rw-r--r--   0     1006     1006    39092 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/storage_connector.py
--rw-r--r--   0     1006     1006     1850 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/tag.py
--rw-r--r--   0     1006     1006    35625 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/training_dataset.py
--rw-r--r--   0     1006     1006     3542 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/training_dataset_feature.py
--rw-r--r--   0     1006     1006     2759 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/training_dataset_split.py
--rw-r--r--   0     1006     1006     8929 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/transformation_function.py
--rw-r--r--   0     1006     1006     2179 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/transformation_function_attached.py
--rw-r--r--   0     1006     1006     3491 2023-06-05 14:18:50.000000 hsfs-3.2.1/hsfs/user.py
--rw-r--r--   0     1006     1006    11410 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/util.py
--rw-r--r--   0     1006     1006     7519 2023-06-19 21:22:26.000000 hsfs-3.2.1/hsfs/validation_report.py
--rw-r--r--   0     1006     1006      628 2023-07-24 10:06:15.000000 hsfs-3.2.1/hsfs/version.py
-drwxr-xr-x   0     1006     1006        0 2023-07-24 10:06:24.237813 hsfs-3.2.1/hsfs.egg-info/
--rw-r--r--   0     1006     1006     7708 2023-07-24 10:06:24.000000 hsfs-3.2.1/hsfs.egg-info/PKG-INFO
--rw-r--r--   0     1006     1006     2805 2023-07-24 10:06:24.000000 hsfs-3.2.1/hsfs.egg-info/SOURCES.txt
--rw-r--r--   0     1006     1006        1 2023-07-24 10:06:24.000000 hsfs-3.2.1/hsfs.egg-info/dependency_links.txt
--rw-r--r--   0     1006     1006      679 2023-07-24 10:06:24.000000 hsfs-3.2.1/hsfs.egg-info/requires.txt
--rw-r--r--   0     1006     1006        5 2023-07-24 10:06:24.000000 hsfs-3.2.1/hsfs.egg-info/top_level.txt
--rw-r--r--   0     1006     1006       38 2023-07-24 10:06:24.261813 hsfs-3.2.1/setup.cfg
--rw-r--r--   0     1006     1006     2756 2023-07-24 10:06:15.000000 hsfs-3.2.1/setup.py
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.165521 hsfs-3.3.0rc0/
+-rw-r--r--   0     1006     1006       40 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/MANIFEST.in
+-rw-r--r--   0     1006     1006     7742 2023-07-03 11:50:55.165521 hsfs-3.3.0rc0/PKG-INFO
+-rw-r--r--   0     1006     1006     5539 2023-07-03 11:50:54.000000 hsfs-3.3.0rc0/README.md
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.145522 hsfs-3.3.0rc0/hsfs/
+-rw-r--r--   0     1006     1006     1182 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/__init__.py
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.149522 hsfs-3.3.0rc0/hsfs/client/
+-rw-r--r--   0     1006     1006     1694 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/client/__init__.py
+-rw-r--r--   0     1006     1006     1132 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/client/auth.py
+-rw-r--r--   0     1006     1006     6622 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/client/base.py
+-rw-r--r--   0     1006     1006     2090 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/client/exceptions.py
+-rw-r--r--   0     1006     1006    11621 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/client/external.py
+-rw-r--r--   0     1006     1006     7924 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/client/hopsworks.py
+-rw-r--r--   0     1006     1006     1536 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/code.py
+-rw-r--r--   0     1006     1006    18899 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/connection.py
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.149522 hsfs-3.3.0rc0/hsfs/constructor/
+-rw-r--r--   0     1006     1006      605 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/constructor/__init__.py
+-rw-r--r--   0     1006     1006     1487 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/constructor/external_feature_group_alias.py
+-rw-r--r--   0     1006     1006     5143 2023-06-30 06:14:21.000000 hsfs-3.3.0rc0/hsfs/constructor/filter.py
+-rw-r--r--   0     1006     1006     3158 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/constructor/fs_query.py
+-rw-r--r--   0     1006     1006     1731 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/constructor/hudi_feature_group_alias.py
+-rw-r--r--   0     1006     1006     2151 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/constructor/join.py
+-rw-r--r--   0     1006     1006     1577 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/constructor/prepared_statement_parameter.py
+-rw-r--r--   0     1006     1006    26740 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/constructor/query.py
+-rw-r--r--   0     1006     1006     3331 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/constructor/serving_prepared_statement.py
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.165521 hsfs-3.3.0rc0/hsfs/core/
+-rw-r--r--   0     1006     1006      605 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/__init__.py
+-rw-r--r--   0     1006     1006    10185 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/arrow_flight_client.py
+-rw-r--r--   0     1006     1006     3688 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/builtin_transformation_function.py
+-rw-r--r--   0     1006     1006     1853 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/code_api.py
+-rw-r--r--   0     1006     1006     3291 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/code_engine.py
+-rw-r--r--   0     1006     1006     3509 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/dataset_api.py
+-rw-r--r--   0     1006     1006     1030 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/deltastreamer_jobconf.py
+-rw-r--r--   0     1006     1006     1609 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/execution.py
+-rw-r--r--   0     1006     1006     5396 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/expectation_api.py
+-rw-r--r--   0     1006     1006     2632 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/expectation_engine.py
+-rw-r--r--   0     1006     1006     6356 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/expectation_suite_api.py
+-rw-r--r--   0     1006     1006     4060 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/expectation_suite_engine.py
+-rw-r--r--   0     1006     1006     9792 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/explicit_provenance.py
+-rw-r--r--   0     1006     1006     5331 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/external_feature_group_engine.py
+-rw-r--r--   0     1006     1006    13467 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/feature_group_api.py
+-rw-r--r--   0     1006     1006     6610 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/feature_group_base_engine.py
+-rw-r--r--   0     1006     1006    13066 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/feature_group_engine.py
+-rw-r--r--   0     1006     1006     1238 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/feature_store_api.py
+-rw-r--r--   0     1006     1006     9739 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/feature_view_api.py
+-rw-r--r--   0     1006     1006    24309 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/feature_view_engine.py
+-rw-r--r--   0     1006     1006     5023 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/great_expectation_engine.py
+-rw-r--r--   0     1006     1006      828 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/hosts_api.py
+-rw-r--r--   0     1006     1006    11701 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/hudi_engine.py
+-rw-r--r--   0     1006     1006     1211 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/ingestion_job.py
+-rw-r--r--   0     1006     1006     2262 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/ingestion_job_conf.py
+-rw-r--r--   0     1006     1006     1077 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/inode.py
+-rw-r--r--   0     1006     1006     4285 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/job.py
+-rw-r--r--   0     1006     1006     2004 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/job_api.py
+-rw-r--r--   0     1006     1006     2047 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/job_configuration.py
+-rw-r--r--   0     1006     1006     1530 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/kafka_api.py
+-rw-r--r--   0     1006     1006      898 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/project_api.py
+-rw-r--r--   0     1006     1006     1093 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/query_constructor_api.py
+-rw-r--r--   0     1006     1006      875 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/services_api.py
+-rw-r--r--   0     1006     1006     1981 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/spine_group_engine.py
+-rw-r--r--   0     1006     1006     4204 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/statistics_api.py
+-rw-r--r--   0     1006     1006     8159 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/statistics_engine.py
+-rw-r--r--   0     1006     1006     2325 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/storage_connector_api.py
+-rw-r--r--   0     1006     1006     4696 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/tags_api.py
+-rw-r--r--   0     1006     1006     6685 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/training_dataset_api.py
+-rw-r--r--   0     1006     1006     6357 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/training_dataset_engine.py
+-rw-r--r--   0     1006     1006     2148 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/training_dataset_job_conf.py
+-rw-r--r--   0     1006     1006     4161 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/core/transformation_function_api.py
+-rw-r--r--   0     1006     1006    12422 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/transformation_function_engine.py
+-rw-r--r--   0     1006     1006     4773 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/validation_report_api.py
+-rw-r--r--   0     1006     1006     3640 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/validation_report_engine.py
+-rw-r--r--   0     1006     1006     2158 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/validation_result_api.py
+-rw-r--r--   0     1006     1006     5469 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/core/validation_result_engine.py
+-rw-r--r--   0     1006     1006     2297 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/variable_api.py
+-rw-r--r--   0     1006     1006    19974 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/core/vector_server.py
+-rw-r--r--   0     1006     1006     1655 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/decorators.py
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.165521 hsfs-3.3.0rc0/hsfs/engine/
+-rw-r--r--   0     1006     1006     2244 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/engine/__init__.py
+-rw-r--r--   0     1006     1006    50175 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/engine/python.py
+-rw-r--r--   0     1006     1006    44416 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/engine/spark.py
+-rw-r--r--   0     1006     1006    23594 2023-06-26 14:55:39.000000 hsfs-3.3.0rc0/hsfs/expectation_suite.py
+-rw-r--r--   0     1006     1006     6857 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/feature.py
+-rw-r--r--   0     1006     1006   118825 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/feature_group.py
+-rw-r--r--   0     1006     1006     3937 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/feature_group_commit.py
+-rw-r--r--   0     1006     1006     1985 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/feature_group_writer.py
+-rw-r--r--   0     1006     1006    69498 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/feature_store.py
+-rw-r--r--   0     1006     1006   106306 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/feature_view.py
+-rw-r--r--   0     1006     1006     4822 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/ge_expectation.py
+-rw-r--r--   0     1006     1006     8633 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/ge_validation_result.py
+-rw-r--r--   0     1006     1006     1449 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/split_statistics.py
+-rw-r--r--   0     1006     1006     2893 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/statistics.py
+-rw-r--r--   0     1006     1006     3313 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/statistics_config.py
+-rw-r--r--   0     1006     1006    41656 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/storage_connector.py
+-rw-r--r--   0     1006     1006     1850 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/tag.py
+-rw-r--r--   0     1006     1006    35625 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/training_dataset.py
+-rw-r--r--   0     1006     1006     3771 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/training_dataset_feature.py
+-rw-r--r--   0     1006     1006     2758 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/training_dataset_split.py
+-rw-r--r--   0     1006     1006     8929 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/transformation_function.py
+-rw-r--r--   0     1006     1006     2179 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/transformation_function_attached.py
+-rw-r--r--   0     1006     1006     3491 2023-06-05 14:18:50.000000 hsfs-3.3.0rc0/hsfs/user.py
+-rw-r--r--   0     1006     1006    12670 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/util.py
+-rw-r--r--   0     1006     1006     7519 2023-06-19 21:22:26.000000 hsfs-3.3.0rc0/hsfs/validation_report.py
+-rw-r--r--   0     1006     1006      631 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/hsfs/version.py
+drwxr-xr-x   0     1006     1006        0 2023-07-03 11:50:55.145522 hsfs-3.3.0rc0/hsfs.egg-info/
+-rw-r--r--   0     1006     1006     7742 2023-07-03 11:50:54.000000 hsfs-3.3.0rc0/hsfs.egg-info/PKG-INFO
+-rw-r--r--   0     1006     1006     2870 2023-07-03 11:50:55.000000 hsfs-3.3.0rc0/hsfs.egg-info/SOURCES.txt
+-rw-r--r--   0     1006     1006        1 2023-07-03 11:50:54.000000 hsfs-3.3.0rc0/hsfs.egg-info/dependency_links.txt
+-rw-r--r--   0     1006     1006      830 2023-07-03 11:50:54.000000 hsfs-3.3.0rc0/hsfs.egg-info/requires.txt
+-rw-r--r--   0     1006     1006        5 2023-07-03 11:50:54.000000 hsfs-3.3.0rc0/hsfs.egg-info/top_level.txt
+-rw-r--r--   0     1006     1006       38 2023-07-03 11:50:55.165521 hsfs-3.3.0rc0/setup.cfg
+-rw-r--r--   0     1006     1006     3074 2023-07-03 11:50:50.000000 hsfs-3.3.0rc0/setup.py
```

### Comparing `hsfs-3.2.1/PKG-INFO` & `hsfs-3.3.0rc0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 Metadata-Version: 2.1
 Name: hsfs
-Version: 3.2.1
+Version: 3.3.0rc0
 Summary: HSFS: An environment independent client to interact with the Hopsworks Featurestore
 Home-page: https://github.com/logicalclocks/feature-store-api
 Author: Hopsworks AB
 Author-email: moritz@logicalclocks.com
 License: Apache License 2.0
-Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.2.1
+Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.3.0rc0
 Description: # Hopsworks Feature Store
         
         <p align="center">
           <a href="https://community.hopsworks.ai"><img
             src="https://img.shields.io/discourse/users?label=Hopsworks%20Community&server=https%3A%2F%2Fcommunity.hopsworks.ai"
             alt="Hopsworks Community"
           /></a>
@@ -165,10 +165,11 @@
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Intended Audience :: Developers
 Requires-Python: >=3.7,<3.11
 Description-Content-Type: text/markdown
 Provides-Extra: dev
+Provides-Extra: dev-pandas1
 Provides-Extra: docs
 Provides-Extra: hive
 Provides-Extra: python
```

#### html2text {}

```diff
@@ -1,12 +1,12 @@
-Metadata-Version: 2.1 Name: hsfs Version: 3.2.1 Summary: HSFS: An environment
-independent client to interact with the Hopsworks Featurestore Home-page:
-https://github.com/logicalclocks/feature-store-api Author: Hopsworks AB Author-
-email: moritz@logicalclocks.com License: Apache License 2.0 Download-URL:
-https://github.com/logicalclocks/feature-store-api/releases/tag/3.2.1
+Metadata-Version: 2.1 Name: hsfs Version: 3.3.0rc0 Summary: HSFS: An
+environment independent client to interact with the Hopsworks Featurestore
+Home-page: https://github.com/logicalclocks/feature-store-api Author: Hopsworks
+AB Author-email: moritz@logicalclocks.com License: Apache License 2.0 Download-
+URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.3.0rc0
 Description: # Hopsworks Feature Store
   [Hopsworks_Community] [Hopsworks_Feature_Store_Documentation] [PyPiStatus]
            [Scala/Java_Artifacts] [Downloads] [CodeStyle] [License]
 HSFS is the library to interact with the Hopsworks Feature Store. The library
 makes creating new features, feature groups and training datasets easy. The
 library is environment independent and can be used in two modes: - Spark mode:
 For data engineering jobs that create and write features into the feature store
@@ -63,9 +63,9 @@
 Guidelines](CONTRIBUTING.md). Keywords: Hopsworks,Feature Store,Spark,Machine
 Learning,MLOps,DataOps Platform: UNKNOWN Classifier: Development Status :: 5 -
 Production/Stable Classifier: Topic :: Utilities Classifier: License :: OSI
 Approved :: Apache Software License Classifier: Programming Language :: Python
 :: 3.8 Classifier: Programming Language :: Python :: 3.9 Classifier:
 Programming Language :: Python :: 3.10 Classifier: Intended Audience ::
 Developers Requires-Python: >=3.7,<3.11 Description-Content-Type: text/markdown
-Provides-Extra: dev Provides-Extra: docs Provides-Extra: hive Provides-Extra:
-python
+Provides-Extra: dev Provides-Extra: dev-pandas1 Provides-Extra: docs Provides-
+Extra: hive Provides-Extra: python
```

### Comparing `hsfs-3.2.1/README.md` & `hsfs-3.3.0rc0/README.md`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/__init__.py` & `hsfs-3.3.0rc0/hsfs/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/client/__init__.py` & `hsfs-3.3.0rc0/hsfs/client/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/client/auth.py` & `hsfs-3.3.0rc0/hsfs/client/auth.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/client/base.py` & `hsfs-3.3.0rc0/hsfs/client/base.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/client/exceptions.py` & `hsfs-3.3.0rc0/hsfs/client/exceptions.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/client/external.py` & `hsfs-3.3.0rc0/hsfs/client/external.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/client/hopsworks.py` & `hsfs-3.3.0rc0/hsfs/client/hopsworks.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/code.py` & `hsfs-3.3.0rc0/hsfs/code.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/connection.py` & `hsfs-3.3.0rc0/hsfs/connection.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/constructor/__init__.py` & `hsfs-3.3.0rc0/hsfs/constructor/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/constructor/external_feature_group_alias.py` & `hsfs-3.3.0rc0/hsfs/constructor/prepared_statement_parameter.py`

 * *Files 17% similar despite different names*

```diff
@@ -1,42 +1,57 @@
 #
-#   Copyright 2020 Logical Clocks AB
+#  Copyright 2021. Logical Clocks AB
+#  Licensed under the Apache License, Version 2.0 (the "License");
+#  you may not use this file except in compliance with the License.
+#  You may obtain a copy of the License at
 #
-#   Licensed under the Apache License, Version 2.0 (the "License");
-#   you may not use this file except in compliance with the License.
-#   You may obtain a copy of the License at
+#  http://www.apache.org/licenses/LICENSE-2.0
 #
-#       http://www.apache.org/licenses/LICENSE-2.0
-#
-#   Unless required by applicable law or agreed to in writing, software
-#   distributed under the License is distributed on an "AS IS" BASIS,
-#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-#   See the License for the specific language governing permissions and
-#   limitations under the License.
+#  Unless required by applicable law or agreed to in writing, software
+#  distributed under the License is distributed on an "AS IS" BASIS,
+#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#  See the License for the specific language governing permissions and
+#  limitations under the License.
 #
 
 import humps
+import json
 
-from hsfs import feature_group
+from hsfs import util
 
 
-class ExternalFeatureGroupAlias:
-    def __init__(self, on_demand_feature_group, alias):
-        self._on_demand_feature_group = (
-            feature_group.ExternalFeatureGroup.from_response_json(
-                on_demand_feature_group
-            )
-        )
-        self._alias = alias
+class PreparedStatementParameter:
+    def __init__(self, name=None, index=None, type=None, href=None):
+        self._name = name
+        self._index = index
 
     @classmethod
     def from_response_json(cls, json_dict):
         json_decamelized = humps.decamelize(json_dict)
         return cls(**json_decamelized)
 
+    def update_from_response_json(self, json_dict):
+        json_decamelized = humps.decamelize(json_dict)
+        self.__init__(**json_decamelized)
+        return self
+
+    def json(self):
+        return json.dumps(self, cls=util.FeatureStoreEncoder)
+
+    def to_dict(self):
+        return {"name": self._name, "index": self._index}
+
     @property
-    def on_demand_feature_group(self):
-        return self._on_demand_feature_group
+    def name(self):
+        return self._name
 
     @property
-    def alias(self):
-        return self._alias
+    def index(self):
+        return self._index
+
+    @name.setter
+    def name(self, name):
+        self._name = name
+
+    @index.setter
+    def prepared_statement_index(self, index):
+        self._index = index
```

### Comparing `hsfs-3.2.1/hsfs/constructor/filter.py` & `hsfs-3.3.0rc0/hsfs/constructor/filter.py`

 * *Files 2% similar despite different names*

```diff
@@ -48,15 +48,15 @@
     def json(self):
         return json.dumps(self, cls=util.FeatureStoreEncoder)
 
     def to_dict(self):
         return {
             "feature": self._feature,
             "condition": self._condition,
-            "value": str(self._value),
+            "value": str(self._value) if self._value is not None else None,
         }
 
     def __and__(self, other):
         if isinstance(other, Filter):
             return Logic.And(left_f=self, right_f=other)
         elif isinstance(other, Logic):
             return Logic.And(left_f=self, right_l=other)
```

### Comparing `hsfs-3.2.1/hsfs/constructor/fs_query.py` & `hsfs-3.3.0rc0/hsfs/constructor/fs_query.py`

 * *Files 9% similar despite different names*

```diff
@@ -75,19 +75,21 @@
     def on_demand_fg_aliases(self):
         return self._on_demand_fg_aliases
 
     @property
     def hudi_cached_feature_groups(self):
         return self._hudi_cached_feature_groups
 
-    def register_external(self):
+    def register_external(self, spine=None):
         if self._on_demand_fg_aliases is None:
             return
 
         for external_fg_alias in self._on_demand_fg_aliases:
+            if type(external_fg_alias.on_demand_feature_group).__name__ == "SpineGroup":
+                external_fg_alias.on_demand_feature_group.dataframe = spine
             engine.get_instance().register_external_temporary_table(
                 external_fg_alias.on_demand_feature_group,
                 external_fg_alias.alias,
             )
 
     def register_hudi_tables(self, feature_store_id, feature_store_name, read_options):
         for hudi_fg in self._hudi_cached_feature_groups:
```

### Comparing `hsfs-3.2.1/hsfs/constructor/hudi_feature_group_alias.py` & `hsfs-3.3.0rc0/hsfs/constructor/hudi_feature_group_alias.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/constructor/join.py` & `hsfs-3.3.0rc0/hsfs/constructor/join.py`

 * *Files 4% similar despite different names*

```diff
@@ -25,15 +25,14 @@
     RIGHT = "RIGHT"
     FULL = "FULL"
     CROSS = "CROSS"
     LEFT_SEMI_JOIN = "LEFT_SEMI_JOIN"
     COMMA = "COMMA"
 
     def __init__(self, query, on, left_on, right_on, join_type, prefix):
-
         self._query = query
         self._on = util.parse_features(on)
         self._left_on = util.parse_features(left_on)
         self._right_on = util.parse_features(right_on)
         self._join_type = join_type or self.INNER
         self._prefix = prefix
```

### Comparing `hsfs-3.2.1/hsfs/constructor/prepared_statement_parameter.py` & `hsfs-3.3.0rc0/hsfs/core/ingestion_job.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,57 +1,46 @@
 #
-#  Copyright 2021. Logical Clocks AB
-#  Licensed under the Apache License, Version 2.0 (the "License");
-#  you may not use this file except in compliance with the License.
-#  You may obtain a copy of the License at
+#   Copyright 2020 Logical Clocks AB
 #
-#  http://www.apache.org/licenses/LICENSE-2.0
+#   Licensed under the Apache License, Version 2.0 (the "License");
+#   you may not use this file except in compliance with the License.
+#   You may obtain a copy of the License at
 #
-#  Unless required by applicable law or agreed to in writing, software
-#  distributed under the License is distributed on an "AS IS" BASIS,
-#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-#  See the License for the specific language governing permissions and
-#  limitations under the License.
+#       http://www.apache.org/licenses/LICENSE-2.0
+#
+#   Unless required by applicable law or agreed to in writing, software
+#   distributed under the License is distributed on an "AS IS" BASIS,
+#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+#   See the License for the specific language governing permissions and
+#   limitations under the License.
 #
 
 import humps
-import json
-
-from hsfs import util
+from hsfs.core.job import Job
 
 
-class PreparedStatementParameter:
-    def __init__(self, name=None, index=None, type=None, href=None):
-        self._name = name
-        self._index = index
+class IngestionJob:
+    def __init__(
+        self,
+        data_path,
+        job,
+        href=None,
+        expand=None,
+        items=None,
+        count=None,
+        type=None,
+    ):
+        self._data_path = data_path
+        self._job = Job.from_response_json(job)
 
     @classmethod
     def from_response_json(cls, json_dict):
         json_decamelized = humps.decamelize(json_dict)
         return cls(**json_decamelized)
 
-    def update_from_response_json(self, json_dict):
-        json_decamelized = humps.decamelize(json_dict)
-        self.__init__(**json_decamelized)
-        return self
-
-    def json(self):
-        return json.dumps(self, cls=util.FeatureStoreEncoder)
-
-    def to_dict(self):
-        return {"name": self._name, "index": self._index}
-
     @property
-    def name(self):
-        return self._name
+    def data_path(self):
+        return self._data_path
 
     @property
-    def index(self):
-        return self._index
-
-    @name.setter
-    def name(self, name):
-        self._name = name
-
-    @index.setter
-    def prepared_statement_index(self, index):
-        self._index = index
+    def job(self):
+        return self._job
```

### Comparing `hsfs-3.2.1/hsfs/constructor/serving_prepared_statement.py` & `hsfs-3.3.0rc0/hsfs/constructor/serving_prepared_statement.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/__init__.py` & `hsfs-3.3.0rc0/hsfs/core/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/builtin_transformation_function.py` & `hsfs-3.3.0rc0/hsfs/core/builtin_transformation_function.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/code_api.py` & `hsfs-3.3.0rc0/hsfs/core/code_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/code_engine.py` & `hsfs-3.3.0rc0/hsfs/core/code_engine.py`

 * *Files 0% similar despite different names*

```diff
@@ -20,15 +20,14 @@
 from hsfs import code
 from hsfs.core import code_api
 import json
 import os
 
 
 class CodeEngine:
-
     WEB_PROXY_ENV = "APPLICATION_WEB_PROXY_BASE"
 
     # JUPYTER
     KERNEL_ENV = "HOPSWORKS_KERNEL_ID"
 
     # JOB
     JOB_ENV = "HOPSWORKS_JOB_NAME"
```

### Comparing `hsfs-3.2.1/hsfs/core/dataset_api.py` & `hsfs-3.3.0rc0/hsfs/core/dataset_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/deltastreamer_jobconf.py` & `hsfs-3.3.0rc0/hsfs/core/deltastreamer_jobconf.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/execution.py` & `hsfs-3.3.0rc0/hsfs/core/execution.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/expectation_api.py` & `hsfs-3.3.0rc0/hsfs/core/expectation_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/expectation_engine.py` & `hsfs-3.3.0rc0/hsfs/core/expectation_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/expectation_suite_api.py` & `hsfs-3.3.0rc0/hsfs/core/expectation_suite_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/expectation_suite_engine.py` & `hsfs-3.3.0rc0/hsfs/core/expectation_suite_engine.py`

 * *Files 0% similar despite different names*

```diff
@@ -71,15 +71,14 @@
         expectation_suite_name: str,
         run_validation: bool,
         validation_ingestion_policy: str,
         meta: Union[str, Dict[str, Any]],
         expectations: List[GeExpectation],
         **kwargs,
     ):
-
         self._expectation_suite_api.update_metadata(
             es.ExpectationSuite(
                 id=id,
                 expectation_suite_name=expectation_suite_name,
                 run_validation=run_validation,
                 validation_ingestion_policy=validation_ingestion_policy,
                 meta=meta,
```

### Comparing `hsfs-3.2.1/hsfs/core/explicit_provenance.py` & `hsfs-3.3.0rc0/hsfs/core/explicit_provenance.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/external_feature_group_engine.py` & `hsfs-3.3.0rc0/hsfs/core/external_feature_group_engine.py`

 * *Files 5% similar despite different names*

```diff
@@ -94,19 +94,17 @@
             ),
             ge_report,
         )
 
     def _update_features_metadata(self, feature_group, features):
         # perform changes on copy in case the update fails, so we don't leave
         # the user object in corrupted state
-        copy_feature_group = fg.ExternalFeatureGroup(
-            storage_connector=feature_group.storage_connector,
-            id=feature_group.id,
-            features=features,
-        )
+        fg_dict = feature_group.to_dict()
+        copy_feature_group = fg.ExternalFeatureGroup.from_response_json(fg_dict)
+        copy_feature_group.features = features
         self._feature_group_api.update_metadata(
             feature_group, copy_feature_group, "updateMetadata"
         )
 
     def update_features(self, feature_group, updated_features):
         """Updates features safely."""
         self._update_features_metadata(
@@ -118,16 +116,13 @@
         self._update_features_metadata(
             feature_group,
             feature_group.features + new_features,  # todo allows for duplicates
         )
 
     def update_description(self, feature_group, description):
         """Updates the description of a feature group."""
-        copy_feature_group = fg.ExternalFeatureGroup(
-            storage_connector=feature_group.storage_connector,
-            id=feature_group.id,
-            description=description,
-            features=feature_group.features,
-        )
+        fg_dict = feature_group.to_dict()
+        copy_feature_group = fg.ExternalFeatureGroup.from_response_json(fg_dict)
+        copy_feature_group.description = description
         self._feature_group_api.update_metadata(
             feature_group, copy_feature_group, "updateMetadata"
         )
```

### Comparing `hsfs-3.2.1/hsfs/core/feature_group_api.py` & `hsfs-3.3.0rc0/hsfs/core/feature_group_api.py`

 * *Files 1% similar despite different names*

```diff
@@ -20,14 +20,15 @@
 
 from hsfs.core import explicit_provenance
 
 
 class FeatureGroupApi:
     CACHED = "cached"
     ONDEMAND = "ondemand"
+    SPINE = "spine"
 
     def __init__(self, feature_store_id):
         self._feature_store_id = feature_store_id
 
     def save(self, feature_group_instance):
         """Save feature group metadata to the feature store.
 
@@ -78,14 +79,16 @@
             name,
         ]
         query_params = None if version is None else {"version": version}
         json_list = _client._send_request("GET", path_params, query_params)
 
         if fg_type == self.CACHED:
             fg_list = feature_group.FeatureGroup.from_response_json(json_list)
+        elif fg_type == self.SPINE:
+            fg_list = feature_group.SpineGroup.from_response_json(json_list)
         else:
             fg_list = feature_group.ExternalFeatureGroup.from_response_json(json_list)
 
         if version is not None:
             return fg_list[0]
         else:
             return fg_list
```

### Comparing `hsfs-3.2.1/hsfs/core/feature_group_base_engine.py` & `hsfs-3.3.0rc0/hsfs/core/feature_group_base_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/feature_group_engine.py` & `hsfs-3.3.0rc0/hsfs/core/feature_group_engine.py`

 * *Files 5% similar despite different names*

```diff
@@ -31,20 +31,19 @@
     def save(
         self,
         feature_group,
         feature_dataframe,
         write_options,
         validation_options: dict = {},
     ):
-
         dataframe_features = engine.get_instance().parse_schema_feature_group(
             feature_dataframe, feature_group.time_travel_format
         )
 
-        self._save_feature_group_metadata(
+        self.save_feature_group_metadata(
             feature_group, dataframe_features, write_options
         )
 
         # ge validation on python and non stream feature groups on spark
         ge_report = feature_group._great_expectation_engine.validate(
             feature_group=feature_group,
             dataframe=feature_dataframe,
@@ -79,22 +78,21 @@
         feature_dataframe,
         overwrite,
         operation,
         storage,
         write_options,
         validation_options: dict = {},
     ):
-
         dataframe_features = engine.get_instance().parse_schema_feature_group(
             feature_dataframe, feature_group.time_travel_format
         )
 
         if not feature_group._id:
             # only save metadata if feature group does not exist
-            self._save_feature_group_metadata(
+            self.save_feature_group_metadata(
                 feature_group, dataframe_features, write_options
             )
         else:
             # else, just verify that feature group schema matches user-provided dataframe
             self._verify_schema_compatibility(
                 feature_group.features, dataframe_features
             )
@@ -185,23 +183,16 @@
             dataframe_type,
             read_options,
         )
 
     def _update_features_metadata(self, feature_group, features):
         # perform changes on copy in case the update fails, so we don't leave
         # the user object in corrupted state
-        copy_feature_group = fg.FeatureGroup(
-            name=None,
-            version=None,
-            featurestore_id=None,
-            description=None,
-            id=feature_group.id,
-            stream=feature_group.stream,
-            features=features,
-        )
+        copy_feature_group = fg.FeatureGroup.from_response_json(feature_group.to_dict())
+        copy_feature_group.features = features
         self._feature_group_api.update_metadata(
             feature_group, copy_feature_group, "updateMetadata"
         )
 
     def update_features(self, feature_group, updated_features):
         """Updates features safely."""
         self._update_features_metadata(
@@ -216,23 +207,16 @@
         )
 
         # write empty dataframe to update parquet schema
         engine.get_instance().save_empty_dataframe(feature_group)
 
     def update_description(self, feature_group, description):
         """Updates the description of a feature group."""
-        copy_feature_group = fg.FeatureGroup(
-            name=None,
-            version=None,
-            featurestore_id=None,
-            description=description,
-            id=feature_group.id,
-            stream=feature_group.stream,
-            features=feature_group.features,
-        )
+        copy_feature_group = fg.FeatureGroup.from_response_json(feature_group.to_dict())
+        copy_feature_group.description = description
         self._feature_group_api.update_metadata(
             feature_group, copy_feature_group, "updateMetadata"
         )
 
     def insert_stream(
         self,
         feature_group,
@@ -240,27 +224,26 @@
         query_name,
         output_mode,
         await_termination,
         timeout,
         checkpoint_dir,
         write_options,
     ):
-
         if not feature_group.online_enabled and not feature_group.stream:
             raise exceptions.FeatureStoreException(
                 "Online storage is not enabled for this feature group. "
                 "It is currently only possible to stream to the online storage."
             )
 
         dataframe_features = engine.get_instance().parse_schema_feature_group(
             dataframe, feature_group.time_travel_format
         )
 
         if not feature_group._id:
-            self._save_feature_group_metadata(
+            self.save_feature_group_metadata(
                 feature_group, dataframe_features, write_options
             )
 
             if not feature_group.stream:
                 # insert_stream method was called on non stream feature group object that has not been saved.
                 # we will use save_dataframe method on empty dataframe to create directory structure
                 offline_write_options = write_options
@@ -297,23 +280,22 @@
             timeout,
             checkpoint_dir,
             write_options,
         )
 
         return streaming_query
 
-    def _save_feature_group_metadata(
+    def save_feature_group_metadata(
         self, feature_group, dataframe_features, write_options
     ):
-
         # this means FG doesn't exist and should create the new one
         if len(feature_group.features) == 0:
             # User didn't provide a schema; extract it from the dataframe
             feature_group._features = dataframe_features
-        else:
+        elif dataframe_features:
             # User provided a schema; check if it is compatible with dataframe.
             self._verify_schema_compatibility(
                 feature_group.features, dataframe_features
             )
 
         # set primary and partition key columns
         # we should move this to the backend
@@ -329,17 +311,22 @@
                 and feat.name == feature_group.hudi_precombine_key
             ):
                 feat.hudi_precombine_key = True
 
         if feature_group.stream:
             # when creating a stream feature group, users have the possibility of passing
             # a spark_job_configuration object as part of the write_options with the key "spark"
+            # filter out consumer config, not needed for delta streamer
             _spark_options = write_options.pop("spark", None)
             _write_options = (
-                [{"name": k, "value": v} for k, v in write_options.items()]
+                [
+                    {"name": k, "value": v}
+                    for k, v in write_options.items()
+                    if k != "kafka_producer_config"
+                ]
                 if write_options
                 else None
             )
             feature_group._deltastreamer_jobconf = DeltaStreamerJobConf(
                 _write_options, _spark_options
             )
```

### Comparing `hsfs-3.2.1/hsfs/core/feature_store_api.py` & `hsfs-3.3.0rc0/hsfs/core/feature_store_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/feature_view_api.py` & `hsfs-3.3.0rc0/hsfs/core/feature_view_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/feature_view_engine.py` & `hsfs-3.3.0rc0/hsfs/core/feature_view_engine.py`

 * *Files 2% similar despite different names*

```diff
@@ -12,15 +12,15 @@
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import datetime
 import warnings
-from hsfs import engine, training_dataset_feature, client, util
+from hsfs import engine, training_dataset_feature, client, util, feature_group
 from hsfs.client import exceptions
 from hsfs.client.exceptions import FeatureStoreException
 from hsfs.training_dataset_split import TrainingDatasetSplit
 from hsfs.core import (
     tags_api,
     storage_connector_api,
     transformation_function_engine,
@@ -33,21 +33,14 @@
 
 
 class FeatureViewEngine:
     ENTITY_TYPE = "featureview"
     _TRAINING_DATA_API_PATH = "trainingdatasets"
     _OVERWRITE = "overwrite"
     _APPEND = "append"
-    AMBIGUOUS_LABEL_ERROR = (
-        "Provided label '{}' is ambiguous and exists in more than one feature groups. "
-        "You can provide the label with the prefix you specify in the join."
-    )
-    LABEL_NOT_EXIST_ERROR = (
-        "Provided label '{}' do not exist in any of the feature groups."
-    )
 
     def __init__(self, feature_store_id):
         self._feature_store_id = feature_store_id
 
         self._feature_view_api = feature_view_api.FeatureViewApi(feature_store_id)
         self._tags_api = tags_api.TagsApi(feature_store_id, self.ENTITY_TYPE)
         self._storage_connector_api = storage_connector_api.StorageConnectorApi(
@@ -72,61 +65,27 @@
     def save(self, feature_view_obj):
         if feature_view_obj.query.is_time_travel():
             warnings.warn(
                 "`as_of` argument in the `Query` will be ignored because"
                 " feature view does not support time travel query."
             )
         if feature_view_obj.labels:
-            # If provided label matches column with prefix, then attach label.
-            # If provided label matches only one column without prefix, then attach label. (For
-            # backward compatibility purpose, as of v3.0, labels are matched to columns without prefix.)
-            # If provided label matches multiple columns without prefix, then raise exception because it is ambiguous.
-            prefix_feature_map = {}
-            feature_map = {}
-            for feat in feature_view_obj.query.features:
-                prefix_feature_map[feat.name] = (
-                    feat.name,
-                    feature_view_obj.query._left_feature_group,
-                )
-            for join in feature_view_obj.query.joins:
-                for feat in join.query.features:
-                    if join.prefix:
-                        prefix_feature_map[join.prefix + feat.name] = (
-                            feat.name,
-                            join.query._left_feature_group,
-                        )
-                    feature_map[feat.name] = feature_map.get(feat.name, []) + [
-                        join.query._left_feature_group
-                    ]
-
             for label_name in feature_view_obj.labels:
-                if label_name in prefix_feature_map:
-                    feature_view_obj._features.append(
-                        training_dataset_feature.TrainingDatasetFeature(
-                            name=prefix_feature_map[label_name][0],
-                            label=True,
-                            featuregroup=prefix_feature_map[label_name][1],
-                        )
-                    )
-                elif label_name in feature_map:
-                    if len(feature_map[label_name]) > 1:
-                        raise FeatureStoreException(
-                            FeatureViewEngine.AMBIGUOUS_LABEL_ERROR.format(label_name)
-                        )
-                    feature_view_obj._features.append(
-                        training_dataset_feature.TrainingDatasetFeature(
-                            name=label_name,
-                            label=True,
-                            featuregroup=feature_map[label_name][0],
-                        )
-                    )
-                else:
-                    raise FeatureStoreException(
-                        FeatureViewEngine.LABEL_NOT_EXIST_ERROR.format(label_name)
+                (
+                    feature,
+                    prefix,
+                    featuregroup,
+                ) = feature_view_obj.query._get_feature_by_name(label_name)
+                feature_view_obj._features.append(
+                    training_dataset_feature.TrainingDatasetFeature(
+                        name=feature.name,
+                        label=True,
+                        featuregroup=featuregroup,
                     )
+                )
         self._transformation_function_engine.attach_transformation_fn(feature_view_obj)
         updated_fv = self._feature_view_api.post(feature_view_obj)
         self.attach_transformation_function(updated_fv)
         print(
             "Feature view created successfully, explore it at \n"
             + self._get_feature_view_url(updated_fv)
         )
@@ -165,25 +124,48 @@
     def get_batch_query(
         self,
         feature_view_obj,
         start_time,
         end_time,
         with_label=False,
         training_dataset_version=None,
+        spine=None,
     ):
         try:
-            return self._feature_view_api.get_batch_query(
+            query = self._feature_view_api.get_batch_query(
                 feature_view_obj.name,
                 feature_view_obj.version,
                 util.convert_event_time_to_timestamp(start_time),
                 util.convert_event_time_to_timestamp(end_time),
                 training_dataset_version=training_dataset_version,
                 is_python_engine=engine.get_type() == "python",
                 with_label=with_label,
             )
+            # verify whatever is passed 1. spine group with dataframe contained, or 2. dataframe
+            # the schema has to be consistent
+
+            # allow passing new spine group or dataframe
+            if isinstance(spine, feature_group.SpineGroup):
+                # schema of original fg on left side needs to be consistent with schema contained in the
+                # spine group to overwrite the feature group
+                dataframe_features = engine.get_instance().parse_schema_feature_group(
+                    spine.dataframe
+                )
+                spine._feature_group_engine._verify_schema_compatibility(
+                    query._left_feature_group.features, dataframe_features
+                )
+                query._left_feature_group = spine
+            elif isinstance(query._left_feature_group, feature_group.SpineGroup):
+                if spine is None:
+                    raise FeatureStoreException(
+                        "Feature View was created with a spine group, setting the `spine` argument is mandatory."
+                    )
+                # the dataframe setter will verify the schema of the dataframe
+                query._left_feature_group.dataframe = spine
+            return query
         except exceptions.RestAPIError as e:
             if e.response.json().get("errorCode", "") == 270172:
                 raise ValueError(
                     "Cannot generate dataset(s) from the given start/end time because"
                     " event time column is not available in the left feature groups."
                     " A start/end time should not be provided as parameters."
                 )
@@ -231,34 +213,36 @@
         else:
             transformation_functions_dict = {
                 transformation_functions.name: transformation_functions.transformation_function
             }
         return transformation_functions_dict
 
     def create_training_dataset(
-        self, feature_view_obj, training_dataset_obj, user_write_options
+        self, feature_view_obj, training_dataset_obj, user_write_options, spine=None
     ):
         self._set_event_time(feature_view_obj, training_dataset_obj)
         updated_instance = self._create_training_data_metadata(
             feature_view_obj, training_dataset_obj
         )
         td_job = self.compute_training_dataset(
             feature_view_obj,
             user_write_options,
             training_dataset_obj=training_dataset_obj,
+            spine=spine,
         )
         return updated_instance, td_job
 
     def get_training_data(
         self,
         feature_view_obj,
         read_options=None,
         splits=[],
         training_dataset_obj=None,
         training_dataset_version=None,
+        spine=None,
     ):
         # check if provided td version has already existed.
         if training_dataset_version:
             td_updated = self._get_training_data_metadata(
                 feature_view_obj, training_dataset_version
             )
         else:
@@ -290,14 +274,15 @@
             self._check_feature_group_accessibility(feature_view_obj)
             query = self.get_batch_query(
                 feature_view_obj,
                 training_dataset_version=td_updated.version,
                 start_time=td_updated.event_start_time,
                 end_time=td_updated.event_end_time,
                 with_label=True,
+                spine=spine,
             )
             split_df = engine.get_instance().get_training_data(
                 td_updated, feature_view_obj, query, read_options
             )
             self.compute_training_dataset_statistics(
                 feature_view_obj, td_updated, split_df, calc_stat=True
             )
@@ -349,23 +334,24 @@
         return 1000
 
     def _get_end_time(self):
         # end time is current time
         return int(float(datetime.datetime.now().timestamp()) * 1000)
 
     def recreate_training_dataset(
-        self, feature_view_obj, training_dataset_version, user_write_options
+        self, feature_view_obj, training_dataset_version, user_write_options, spine=None
     ):
         training_dataset_obj = self._get_training_data_metadata(
             feature_view_obj, training_dataset_version
         )
         td_job = self.compute_training_dataset(
             feature_view_obj,
             user_write_options,
             training_dataset_obj=training_dataset_obj,
+            spine=spine,
         )
         return training_dataset_obj, td_job
 
     def _read_from_storage_connector(
         self, training_data_obj, splits, read_options, schema=None
     ):
         if splits:
@@ -411,14 +397,15 @@
     # This method is used by hsfs_utils to launch a job for python client
     def compute_training_dataset(
         self,
         feature_view_obj,
         user_write_options,
         training_dataset_obj=None,
         training_dataset_version=None,
+        spine=None,
     ):
         if training_dataset_obj:
             pass
         elif training_dataset_version:
             training_dataset_obj = self._get_training_data_metadata(
                 feature_view_obj, training_dataset_version
             )
@@ -427,14 +414,15 @@
 
         batch_query = self.get_batch_query(
             feature_view_obj,
             training_dataset_obj.event_start_time,
             training_dataset_obj.event_end_time,
             with_label=True,
             training_dataset_version=training_dataset_obj.version,
+            spine=spine,
         )
         td_job = engine.get_instance().write_training_dataset(
             training_dataset_obj,
             batch_query,
             user_write_options,
             self._OVERWRITE,
             feature_view_obj=feature_view_obj,
@@ -533,23 +521,25 @@
         self,
         feature_view_obj,
         start_time,
         end_time,
         training_dataset_version,
         transformation_functions,
         read_options=None,
+        spine=None,
     ):
         self._check_feature_group_accessibility(feature_view_obj)
 
         feature_dataframe = self.get_batch_query(
             feature_view_obj,
             start_time,
             end_time,
             with_label=False,
             training_dataset_version=training_dataset_version,
+            spine=spine,
         ).read(read_options=read_options)
         if transformation_functions:
             return engine.get_instance()._apply_transformation_function(
                 transformation_functions, dataset=feature_dataframe
             )
         else:
             return feature_dataframe
@@ -595,18 +585,20 @@
         return self._feature_view_api.get_parent_feature_groups(
             feature_view_obj.name, feature_view_obj.version
         )
 
     def _check_feature_group_accessibility(self, feature_view_obj):
         if (
             engine.get_type() == "python" or engine.get_type() == "hive"
-        ) and not feature_view_obj.query.from_cache_feature_group_only():
+        ) and not feature_view_obj.query.is_cache_feature_group_only():
             raise NotImplementedError(
-                "Python kernel can only read from cached feature group."
-                " Please use `feature_view.create_training_data` instead."
+                "Python kernel can only read from cached feature groups."
+                " When using external feature groups please use "
+                "`feature_view.create_training_data` instead. "
+                "If you are using spines, use a Spark Kernel."
             )
 
     def _get_feature_view_url(self, feature_view):
         path = (
             "/p/"
             + str(client.get_instance()._project_id)
             + "/fs/"
```

### Comparing `hsfs-3.2.1/hsfs/core/great_expectation_engine.py` & `hsfs-3.3.0rc0/hsfs/core/great_expectation_engine.py`

 * *Files 0% similar despite different names*

```diff
@@ -121,15 +121,14 @@
         save_report: bool,
         ge_type: bool,
         validation_options: Dict[str, Any],
         ingestion_result: str = "UNKNOWN",
     ) -> Union[
         ge.core.ExpectationSuiteValidationResult, validation_report.ValidationReport
     ]:
-
         save_report = validation_options.get("save_report", save_report)
         if save_report:
             return feature_group.save_validation_report(
                 report, ingestion_result=ingestion_result, ge_type=ge_type
             )
 
         if ge_type:
```

### Comparing `hsfs-3.2.1/hsfs/core/hosts_api.py` & `hsfs-3.3.0rc0/hsfs/core/hosts_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/hudi_engine.py` & `hsfs-3.3.0rc0/hsfs/core/hudi_engine.py`

 * *Files 2% similar despite different names*

```diff
@@ -80,15 +80,14 @@
         self._feature_store_name = feature_store_name
 
         self._feature_group_api = feature_group_api.FeatureGroupApi(feature_store_id)
 
     def save_hudi_fg(
         self, dataset, save_mode, operation, write_options, validation_id=None
     ):
-
         fg_commit = self._write_hudi_dataset(
             dataset, save_mode, operation, write_options
         )
         fg_commit.validation_id = validation_id
         return self._feature_group_api.commit(self._feature_group, fg_commit)
 
     def delete_record(self, delete_df, write_options):
@@ -264,8 +263,11 @@
             commit_date_string=commit_timeline.lastInstant().get().getTimestamp(),
             commit_time=util.get_timestamp_from_date_string(
                 commit_timeline.lastInstant().get().getTimestamp()
             ),
             rows_inserted=commit_metadata.fetchTotalInsertRecordsWritten(),
             rows_updated=commit_metadata.fetchTotalUpdateRecordsWritten(),
             rows_deleted=commit_metadata.getTotalRecordsDeleted(),
+            last_active_commit_time=util.get_timestamp_from_date_string(
+                commit_timeline.firstInstant().get().getTimestamp()
+            ),
         )
```

### Comparing `hsfs-3.2.1/hsfs/core/ingestion_job.py` & `hsfs-3.3.0rc0/hsfs/core/inode.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,8 +1,7 @@
-#
 #   Copyright 2020 Logical Clocks AB
 #
 #   Licensed under the Apache License, Version 2.0 (the "License");
 #   you may not use this file except in compliance with the License.
 #   You may obtain a copy of the License at
 #
 #       http://www.apache.org/licenses/LICENSE-2.0
@@ -11,36 +10,23 @@
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import humps
-from hsfs.core.job import Job
 
 
-class IngestionJob:
-    def __init__(
-        self,
-        data_path,
-        job,
-        href=None,
-        expand=None,
-        items=None,
-        count=None,
-        type=None,
-    ):
-        self._data_path = data_path
-        self._job = Job.from_response_json(job)
+class Inode:
+    def __init__(self, href=None, attributes=None, zip_state=None, tags=None):
+        self._path = attributes["path"]
 
     @classmethod
     def from_response_json(cls, json_dict):
-        json_decamelized = humps.decamelize(json_dict)
-        return cls(**json_decamelized)
-
-    @property
-    def data_path(self):
-        return self._data_path
+        json_decamelized = humps.decamelize(json_dict)["items"]
+        for inode in json_decamelized:
+            _ = inode.pop("type", None)
+        return [cls(**inode) for inode in json_decamelized]
 
     @property
-    def job(self):
-        return self._job
+    def path(self):
+        return self._path
```

### Comparing `hsfs-3.2.1/hsfs/core/ingestion_job_conf.py` & `hsfs-3.3.0rc0/hsfs/core/ingestion_job_conf.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/inode.py` & `hsfs-3.3.0rc0/hsfs/tag.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,7 +1,8 @@
+#
 #   Copyright 2020 Logical Clocks AB
 #
 #   Licensed under the Apache License, Version 2.0 (the "License");
 #   you may not use this file except in compliance with the License.
 #   You may obtain a copy of the License at
 #
 #       http://www.apache.org/licenses/LICENSE-2.0
@@ -10,23 +11,66 @@
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import humps
+import json
+
+from hsfs import util
+
 
+class Tag:
+    def __init__(
+        self,
+        name,
+        value,
+        schema=None,
+        href=None,
+        expand=None,
+        items=None,
+        count=None,
+        type=None,
+    ):
+        self._name = name
+        self._value = value
 
-class Inode:
-    def __init__(self, href=None, attributes=None, zip_state=None, tags=None):
-        self._path = attributes["path"]
+    def to_dict(self):
+        return {
+            "name": self._name,
+            "value": self._value,
+        }
+
+    def json(self):
+        return json.dumps(self, cls=util.FeatureStoreEncoder)
 
     @classmethod
     def from_response_json(cls, json_dict):
-        json_decamelized = humps.decamelize(json_dict)["items"]
-        for inode in json_decamelized:
-            _ = inode.pop("type", None)
-        return [cls(**inode) for inode in json_decamelized]
+        json_decamelized = humps.decamelize(json_dict)
+        if "count" not in json_decamelized or json_decamelized["count"] == 0:
+            return []
+        return [cls(**tag) for tag in json_decamelized["items"]]
+
+    @property
+    def name(self):
+        """Name of the tag."""
+        return self._name
+
+    @name.setter
+    def name(self, name):
+        self._name = name
 
     @property
-    def path(self):
-        return self._path
+    def value(self):
+        """Value of tag."""
+        return self._value
+
+    @value.setter
+    def value(self, value):
+        self._value = value
+
+    def __str__(self):
+        return self.json()
+
+    def __repr__(self):
+        return f"Tag({self._name!r}, {self._value!r})"
```

### Comparing `hsfs-3.2.1/hsfs/core/job.py` & `hsfs-3.3.0rc0/hsfs/training_dataset_split.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,106 +1,101 @@
 #
-#   Copyright 2020 Logical Clocks AB
+#   Copyright 2022 Logical Clocks AB
 #
 #   Licensed under the Apache License, Version 2.0 (the "License");
 #   you may not use this file except in compliance with the License.
 #   You may obtain a copy of the License at
 #
 #       http://www.apache.org/licenses/LICENSE-2.0
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
+import json
+from hsfs import util
 import humps
-from hsfs import engine
-from hsfs.core import job_api
 
 
-class Job:
+class TrainingDatasetSplit:
+    TIME_SERIES_SPLIT = "TIME_SERIES_SPLIT"
+    RANDOM_SPLIT = "RANDOM_SPLIT"
+    TRAIN = "train"
+    VALIDATION = "validation"
+    TEST = "test"
+
     def __init__(
-        self,
-        id,
-        name,
-        creation_time,
-        config,
-        job_type,
-        creator,
-        executions=None,
-        type=None,
-        href=None,
-        expand=None,
-        items=None,
-        count=None,
+        self, name, split_type, percentage=None, start_time=None, end_time=None
     ):
-        self._id = id
         self._name = name
-        self._executions = executions
-        self._href = href
-        self._config = config
-
-        self._job_api = job_api.JobApi()
-
-    @classmethod
-    def from_response_json(cls, json_dict):
-        # Job config should not be decamelized when updated
-        config = json_dict.pop("config")
-        json_decamelized = humps.decamelize(json_dict)
-        json_decamelized["config"] = config
-        return cls(**json_decamelized)
+        self._percentage = percentage
+        self._split_type = split_type
+        self._start_time = start_time
+        self._end_time = end_time
 
     @property
     def name(self):
         return self._name
 
+    @name.setter
+    def name(self, name):
+        self._name = name
+
     @property
-    def id(self):
-        return self._id
+    def percentage(self):
+        return self._percentage
+
+    @percentage.setter
+    def percentage(self, percentage):
+        self._percentage = percentage
 
     @property
-    def executions(self):
-        return self._executions
+    def split_type(self):
+        return self._split_type
+
+    @split_type.setter
+    def split_type(self, split_type):
+        self._split_type = split_type
 
     @property
-    def href(self):
-        return self._href
+    def start_time(self):
+        return self._start_time
+
+    @start_time.setter
+    def start_time(self, start_time):
+        self._start_time = start_time
 
     @property
-    def config(self):
-        """Configuration for the job"""
-        return self._config
-
-    def run(self, args: str = None, await_termination: bool = True):
-        """Run the job.
-
-        Runs the job, by default awaiting its completion.
-
-        !!! example
-            ```python
-            # connect to the Feature Store
-            fs = ...
-
-            # get the Feature Group instances
-            fg = fs.get_or_create_feature_group(...)
-
-            # insert in to feature group
-            job, _ = fg.insert(df, write_options={"start_offline_backfill": False})
-
-            # run job
-            job.run()
-            ```
-
-        # Arguments
-            args: Optional runtime arguments for the job.
-            await_termination: Identifies if the client should wait for the job to complete, defaults to True.
-        """
-        print(f"Launching job: {self.name}")
-        self._job_api.launch(self.name, args=args)
-        print(
-            "Job started successfully, you can follow the progress at \n{}".format(
-                engine.get_instance().get_job_url(self.href)
-            )
+    def end_time(self):
+        return self._end_time
+
+    @end_time.setter
+    def end_time(self, end_time):
+        self._end_time = end_time
+
+    def json(self):
+        return json.dumps(self, cls=util.FeatureStoreEncoder)
+
+    def to_dict(self):
+        return {
+            "name": self._name,
+            "percentage": self._percentage,
+            "splitType": self._split_type,
+            "startTime": self._start_time,
+            "endTime": self._end_time,
+        }
+
+    @classmethod
+    def from_response_json(cls, json_dict):
+        json_decamelized = humps.decamelize(json_dict)
+        return cls(
+            name=json_decamelized["name"],
+            split_type=json_decamelized.get(
+                "split_type", TrainingDatasetSplit.RANDOM_SPLIT
+            ),
+            percentage=json_decamelized.get("percentage", None),
+            start_time=json_decamelized.get("start_time", None),
+            end_time=json_decamelized.get("end_time", None),
         )
-        engine.get_instance().wait_for_job(self, await_termination=await_termination)
```

### Comparing `hsfs-3.2.1/hsfs/core/job_api.py` & `hsfs-3.3.0rc0/hsfs/core/job_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/job_configuration.py` & `hsfs-3.3.0rc0/hsfs/core/job_configuration.py`

 * *Files 0% similar despite different names*

```diff
@@ -16,15 +16,14 @@
 
 import json
 
 from hsfs import util
 
 
 class JobConfiguration:
-
     DTO_TYPE = "sparkJobConfiguration"
 
     def __init__(
         self,
         am_memory=2048,
         am_cores=1,
         executor_memory=4096,
```

### Comparing `hsfs-3.2.1/hsfs/core/kafka_api.py` & `hsfs-3.3.0rc0/hsfs/core/kafka_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/project_api.py` & `hsfs-3.3.0rc0/hsfs/core/project_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/query_constructor_api.py` & `hsfs-3.3.0rc0/hsfs/core/query_constructor_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/services_api.py` & `hsfs-3.3.0rc0/hsfs/core/services_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/statistics_api.py` & `hsfs-3.3.0rc0/hsfs/core/statistics_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/statistics_engine.py` & `hsfs-3.3.0rc0/hsfs/core/statistics_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/storage_connector_api.py` & `hsfs-3.3.0rc0/hsfs/core/storage_connector_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/tags_api.py` & `hsfs-3.3.0rc0/hsfs/core/tags_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/training_dataset_api.py` & `hsfs-3.3.0rc0/hsfs/core/training_dataset_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/training_dataset_engine.py` & `hsfs-3.3.0rc0/hsfs/core/training_dataset_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/training_dataset_job_conf.py` & `hsfs-3.3.0rc0/hsfs/core/training_dataset_job_conf.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/transformation_function_api.py` & `hsfs-3.3.0rc0/hsfs/core/transformation_function_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/transformation_function_engine.py` & `hsfs-3.3.0rc0/hsfs/core/transformation_function_engine.py`

 * *Files 18% similar despite different names*

```diff
@@ -15,15 +15,14 @@
 #
 
 import numpy
 import datetime
 from functools import partial
 
 from hsfs import training_dataset, training_dataset_feature
-from hsfs.client.exceptions import FeatureStoreException
 from hsfs.core import transformation_function_api, statistics_api
 from hsfs.core.builtin_transformation_function import BuiltInTransformationFunction
 from hsfs import util
 
 
 class TransformationFunctionEngine:
     BUILTIN_FN_NAMES = [
@@ -96,81 +95,38 @@
 
     @staticmethod
     def attach_transformation_fn(training_dataset_obj=None, feature_view_obj=None):
         if training_dataset_obj:
             target_obj = training_dataset_obj  # todo why provide td and fv just to convert to target_obj?
         else:
             target_obj = feature_view_obj
-        # If provided feature matches column with prefix, then attach transformation function.
-        # If provided feature matches only one column without prefix, then attach transformation function. (For
-        # backward compatibility purpose, as of v3.0, features are matched to columns without prefix.)
-        # If provided feature matches multiple columns without prefix, then raise exception because it is ambiguous.
-        prefix_feature_map = {}
-        feature_map = {}
-        for feat in target_obj.query.features:
-            prefix_feature_map[feat.name] = (
-                feat.name,
-                target_obj.query._left_feature_group,
-            )
-        for join in target_obj.query.joins:
-            for feat in join.query.features:
-                if join.prefix:
-                    prefix_feature_map[join.prefix + feat.name] = (
-                        feat.name,
-                        join.query._left_feature_group,
-                    )
-                feature_map[feat.name] = feature_map.get(feat.name, []) + [
-                    join.query._left_feature_group
-                ]
 
         if target_obj._transformation_functions:
             for (
                 feature_name,
                 transformation_fn,
             ) in target_obj._transformation_functions.items():
                 if feature_name in target_obj.labels:  # todo td does not have labels
                     raise ValueError(
                         "Online transformations for training dataset labels are not supported."
                     )
-                if feature_name in prefix_feature_map:
-                    target_obj._features.append(
-                        training_dataset_feature.TrainingDatasetFeature(
-                            name=feature_name,
-                            feature_group_feature_name=prefix_feature_map[feature_name][
-                                0
-                            ],
-                            featuregroup=prefix_feature_map[feature_name][1],
-                            type=transformation_fn.output_type,
-                            label=False,
-                            transformation_function=transformation_fn,
-                        )
-                    )
-                elif feature_name in feature_map:
-                    if len(feature_map[feature_name]) > 1:
-                        raise FeatureStoreException(
-                            TransformationFunctionEngine.AMBIGUOUS_FEATURE_ERROR.format(
-                                feature_name
-                            )
-                        )
-                    target_obj._features.append(
-                        training_dataset_feature.TrainingDatasetFeature(
-                            name=feature_name,
-                            feature_group_feature_name=feature_name,
-                            featuregroup=feature_map[feature_name][0],
-                            type=transformation_fn.output_type,
-                            label=False,
-                            transformation_function=transformation_fn,
-                        )
-                    )
-                else:
-                    raise FeatureStoreException(
-                        TransformationFunctionEngine.FEATURE_NOT_EXIST_ERROR.format(
-                            feature_name
-                        )
+
+                feature, prefix, featuregroup = target_obj.query._get_feature_by_name(
+                    feature_name
+                )
+                target_obj._features.append(
+                    training_dataset_feature.TrainingDatasetFeature(
+                        name=feature_name,
+                        feature_group_feature_name=feature.name,
+                        featuregroup=featuregroup,
+                        type=transformation_fn.output_type,
+                        label=False,
+                        transformation_function=transformation_fn,
                     )
+                )
 
     def is_builtin(self, transformation_fn_instance):
         return (
             transformation_fn_instance.name in self.BUILTIN_FN_NAMES
             and transformation_fn_instance.version == 1
         )
```

### Comparing `hsfs-3.2.1/hsfs/core/validation_report_api.py` & `hsfs-3.3.0rc0/hsfs/core/validation_report_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/validation_report_engine.py` & `hsfs-3.3.0rc0/hsfs/core/validation_report_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/validation_result_api.py` & `hsfs-3.3.0rc0/hsfs/core/validation_result_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/validation_result_engine.py` & `hsfs-3.3.0rc0/hsfs/core/validation_result_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/core/variable_api.py` & `hsfs-3.3.0rc0/hsfs/core/variable_api.py`

 * *Files 26% similar despite different names*

```diff
@@ -13,32 +13,68 @@
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 from hsfs import client
 import re
 
+from hsfs.client.exceptions import RestAPIError
+
 
 class VariableApi:
     def __init__(self):
         pass
 
     def get_version(self, software: str):
-
         _client = client.get_instance()
         path_params = [
             "variables",
             "versions",
         ]
 
         resp = _client._send_request("GET", path_params)
         for entry in resp:
             if entry["software"] == software:
                 return entry["version"]
         return None
 
     def parse_major_and_minor(self, backend_version):
-
         version_pattern = r"(\d+)\.(\d+)"
         matches = re.match(version_pattern, backend_version)
 
         return matches.group(1), matches.group(2)
+
+    def get_flyingduck_enabled(self):
+        _client = client.get_instance()
+        path_params = [
+            "variables",
+            "enable_flyingduck",
+        ]
+
+        resp = _client._send_request("GET", path_params)
+        return resp["successMessage"] == "true"
+
+    def get_loadbalancer_external_domain(self):
+        _client = client.get_instance()
+        path_params = [
+            "variables",
+            "loadbalancer_external_domain",
+        ]
+
+        try:
+            resp = _client._send_request("GET", path_params)
+            return resp["successMessage"]
+        except RestAPIError:
+            return ""
+
+    def get_service_discovery_domain(self):
+        _client = client.get_instance()
+        path_params = [
+            "variables",
+            "service_discovery_domain",
+        ]
+
+        try:
+            resp = _client._send_request("GET", path_params)
+            return resp["successMessage"]
+        except RestAPIError:
+            return ""
```

### Comparing `hsfs-3.2.1/hsfs/core/vector_server.py` & `hsfs-3.3.0rc0/hsfs/core/vector_server.py`

 * *Files 4% similar despite different names*

```diff
@@ -14,14 +14,16 @@
 #   limitations under the License.
 #
 import re
 import io
 import avro.schema
 import avro.io
 from sqlalchemy import sql, bindparam, exc, text
+import numpy as np
+import pandas as pd
 from hsfs import util
 from hsfs import training_dataset, feature_view, client
 from hsfs.core import (
     training_dataset_api,
     storage_connector_api,
     transformation_function_engine,
     feature_view_api,
@@ -139,30 +141,29 @@
         self._serving_keys = serving_vector_keys
         self._pkname_by_serving_index = pkname_by_serving_index
         self._prefix_by_serving_index = prefix_by_serving_index
 
         # get schemas for complex features once
         self._complex_features = self.get_complex_feature_schemas()
 
-    def get_feature_vector(self, entry, passed_features={}):
+    def get_feature_vector(self, entry, return_type, passed_features={}):
         """Assembles serving vector from online feature store."""
 
         if all([isinstance(val, list) for val in entry.values()]):
             raise ValueError(
                 "Entry is expected to be single value per primary key. "
                 "If you have already initialised prepared statements for single vector and now want to retrieve "
                 "batch vector please reinitialise prepared statements with  "
                 "`training_dataset.init_prepared_statement()` "
                 "or `feature_view.init_serving()`"
             )
 
         # Initialize the set of values
         serving_vector = {}
         with self._prepared_statement_engine.connect() as mysql_conn:
-
             for prepared_statement_index in self._prepared_statements:
                 if any(
                     e not in entry.keys()
                     for e in self._pkname_by_serving_index[prepared_statement_index]
                 ):
                     # User did not provide the necessary serving keys, we expect they have
                     # provided the necessary features as passed_features.
@@ -188,17 +189,30 @@
 
         # Add the passed features
         serving_vector.update(passed_features)
 
         # apply transformation functions
         result_dict = self._apply_transformation(serving_vector)
 
-        return self._generate_vector(result_dict)
+        vector, feature_names = self._generate_vector(result_dict)
+
+        if return_type.lower() == "list":
+            return vector
+        elif return_type.lower() == "numpy":
+            return np.array(vector)
+        elif return_type.lower() == "pandas":
+            pandas_df = pd.DataFrame(vector).transpose()
+            pandas_df.columns = feature_names
+            return pandas_df
+        else:
+            raise Exception(
+                "Unknown return type. Supported return types are 'list', 'pandas' and 'numpy'"
+            )
 
-    def get_feature_vectors(self, entry, passed_features=[]):
+    def get_feature_vectors(self, entry, return_type, passed_features=[]):
         """Assembles serving vector from online feature store."""
 
         # create dict object that will have of order of the vector as key and values as
         # vector itself to stitch them correctly if there are multiple feature groups involved. At this point we
         # expect that backend will return correctly ordered vectors.
         batch_results = {}
         with self._prepared_statement_engine.connect() as mysql_conn:
@@ -261,21 +275,43 @@
         batch_transformed = list(
             map(
                 lambda results_dict: self._apply_transformation(results_dict),
                 batch_results.values(),
             )
         )
 
-        return list(
+        # get column names for pandas dataframe
+        feature_names = list(
             map(
-                lambda result_dict: self._generate_vector(result_dict),
+                lambda result_dict: self._generate_vector(result_dict)[1],
+                [batch_transformed[0]],
+            )
+        )[0]
+
+        # get vectors
+        vectors = list(
+            map(
+                lambda result_dict: self._generate_vector(result_dict)[0],
                 batch_transformed,
             )
         )
 
+        if return_type.lower() == "list":
+            return vectors
+        elif return_type.lower() == "numpy":
+            return np.array(vectors)
+        elif return_type.lower() == "pandas":
+            pandas_df = pd.DataFrame(vectors)
+            pandas_df.columns = feature_names
+            return pandas_df
+        else:
+            raise Exception(
+                "Unknown return type. Supported return types are 'list', 'pandas' and 'numpy'"
+            )
+
     def get_complex_feature_schemas(self):
         return {
             f.name: avro.io.DatumReader(
                 avro.schema.parse(f._feature_group._get_feature_avro_schema(f.name))
             )
             for f in self._features
             if f.is_complex()
@@ -302,32 +338,35 @@
     def _set_mysql_connection(self, options=None):
         online_conn = self._storage_connector_api.get_online_connector()
         self._prepared_statement_engine = util.create_mysql_engine(
             online_conn, self._external, options=options
         )
 
     def _generate_vector(self, result_dict):
+        # feature values
         vector = []
+        # column names for pandas dataframe
+        feature_names = []
         for feature in self._features:
             if feature.label:
                 # Skip the label
                 continue
 
             if feature.name not in result_dict:
                 raise Exception(
                     "Feature "
                     + feature.name
                     + " is missing from vector. "
                     + "Please provide the required entry to retrieve it from the feature store "
                     + " or provide the feature as passed_feature"
                 )
-
+            feature_names.append(feature.name)
             vector.append(result_dict[feature.name])
 
-        return vector
+        return vector, feature_names
 
     def _apply_transformation(self, row_dict):
         for feature_name in self._transformation_functions:
             if feature_name in row_dict:
                 transformation_fn = self._transformation_functions[
                     feature_name
                 ].transformation_fn
```

### Comparing `hsfs-3.2.1/hsfs/decorators.py` & `hsfs-3.3.0rc0/hsfs/decorators.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/engine/__init__.py` & `hsfs-3.3.0rc0/hsfs/engine/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/engine/python.py` & `hsfs-3.3.0rc0/hsfs/engine/python.py`

 * *Files 4% similar despite different names*

```diff
@@ -17,14 +17,15 @@
 import pandas as pd
 import numpy as np
 import boto3
 import time
 import re
 import ast
 import warnings
+import logging
 import avro
 import socket
 import pyarrow as pa
 import json
 import random
 import uuid
 import decimal
@@ -53,22 +54,29 @@
     ingestion_job_conf,
     kafka_api,
     statistics_api,
     training_dataset_api,
     training_dataset_job_conf,
     feature_view_api,
     transformation_function_engine,
+    arrow_flight_client,
+    variable_api,
 )
 from hsfs.constructor import query
 from hsfs.training_dataset_split import TrainingDatasetSplit
 from hsfs.client import exceptions, hopsworks
 from hsfs.feature_group import FeatureGroup
 from thrift.transport.TTransport import TTransportException
 from pyhive.exc import OperationalError
 
+from hsfs.storage_connector import StorageConnector
+
+# Disable pyhive INFO logging
+logging.getLogger("pyhive").setLevel(logging.WARNING)
+
 HAS_FAST = False
 try:
     from fastavro import schemaless_writer
     from fastavro.schema import parse_schema
 
     HAS_FAST = True
 except ImportError:
@@ -102,44 +110,72 @@
                 hive_config=read_options.get("hive_config") if read_options else None,
             )
         else:
             return self._jdbc(
                 sql_query, online_conn, dataframe_type, read_options, schema
             )
 
+    def is_flyingduck_query_supported(self, query, read_options):
+        return arrow_flight_client.get_instance().is_query_supported(
+            query, read_options
+        )
+
     def _sql_offline(
-        self, sql_query, feature_store, dataframe_type, schema=None, hive_config=None
+        self,
+        sql_query,
+        feature_store,
+        dataframe_type,
+        schema=None,
+        hive_config=None,
     ):
-        with self._create_hive_connection(
-            feature_store, hive_config=hive_config
-        ) as hive_conn:
-            result_df = pd.read_sql(sql_query, hive_conn)
-            if schema:
-                result_df = Engine.cast_columns(result_df, schema)
+        if arrow_flight_client.get_instance().is_flyingduck_query_object(sql_query):
+            result_df = util.run_with_loading_animation(
+                "Reading data from Hopsworks, using FlyingDuck",
+                arrow_flight_client.get_instance().read_query,
+                sql_query,
+            )
+        else:
+            with self._create_hive_connection(
+                feature_store, hive_config=hive_config
+            ) as hive_conn:
+                # Suppress SQLAlchemy pandas warning
+                with warnings.catch_warnings():
+                    warnings.simplefilter("ignore", UserWarning)
+                    result_df = util.run_with_loading_animation(
+                        "Reading data from Hopsworks, using Hive",
+                        pd.read_sql,
+                        sql_query,
+                        hive_conn,
+                    )
+
+        if schema:
+            result_df = Engine.cast_columns(result_df, schema)
         return self._return_dataframe_type(result_df, dataframe_type)
 
     def _jdbc(self, sql_query, connector, dataframe_type, read_options, schema=None):
         if self._mysql_online_fs_engine is None:
             self._mysql_online_fs_engine = util.create_mysql_engine(
                 connector,
                 (
                     isinstance(client.get_instance(), client.external.Client)
                     if "external" not in read_options
                     else read_options["external"]
                 ),
             )
         with self._mysql_online_fs_engine.connect() as mysql_conn:
-            result_df = pd.read_sql(sql.text(sql_query), mysql_conn)
+            if "sqlalchemy" in str(type(mysql_conn)):
+                sql_query = sql.text(sql_query)
+            result_df = pd.read_sql(sql_query, mysql_conn)
             if schema:
                 result_df = Engine.cast_columns(result_df, schema, online=True)
         return self._return_dataframe_type(result_df, dataframe_type)
 
     def read(self, storage_connector, data_format, read_options, location):
         if storage_connector.type == storage_connector.HOPSFS:
-            df_list = self._read_hopsfs(location, data_format)
+            df_list = self._read_hopsfs(location, data_format, read_options)
         elif storage_connector.type == storage_connector.S3:
             df_list = self._read_s3(storage_connector, location, data_format)
         else:
             raise NotImplementedError(
                 "{} Storage Connectors for training datasets are not supported yet for external environments.".format(
                     storage_connector.type
                 )
@@ -158,53 +194,59 @@
         else:
             raise TypeError(
                 "{} training dataset format is not supported to read as pandas dataframe.".format(
                     data_format
                 )
             )
 
-    def _read_hopsfs(self, location, data_format):
+    def _read_hopsfs(self, location, data_format, read_options={}):
         # providing more informative error
         try:
             from pydoop import hdfs
         except ModuleNotFoundError:
-            return self._read_hopsfs_rest(location, data_format)
-
+            return self._read_hopsfs_remote(location, data_format, read_options)
         util.setup_pydoop()
         path_list = hdfs.ls(location, recursive=True)
 
         df_list = []
         for path in path_list:
             if (
                 hdfs.path.isfile(path)
                 and not path.endswith("_SUCCESS")
                 and hdfs.path.getsize(path) > 0
             ):
                 df_list.append(self._read_pandas(data_format, path))
         return df_list
 
-    # This is a version of the read method that uses the Hopsworks REST APIs
+    # This is a version of the read method that uses the Hopsworks REST APIs or Flyginduck Server
     # To read the training dataset content, this to avoid the pydoop dependency
     # requirement and allow users to read Hopsworks training dataset from outside
-    def _read_hopsfs_rest(self, location, data_format):
+    def _read_hopsfs_remote(self, location, data_format, read_options={}):
         total_count = 10000
         offset = 0
         df_list = []
 
         while offset < total_count:
             total_count, inode_list = self._dataset_api.list_files(
                 location, offset, 100
             )
 
             for inode in inode_list:
                 if not inode.path.endswith("_SUCCESS"):
-                    content_stream = self._dataset_api.read_content(inode.path)
-                    df_list.append(
-                        self._read_pandas(data_format, BytesIO(content_stream.content))
-                    )
+                    if arrow_flight_client.get_instance().is_data_format_supported(
+                        data_format, read_options
+                    ):
+                        df = arrow_flight_client.get_instance().read_path(inode.path)
+                    else:
+                        content_stream = self._dataset_api.read_content(inode.path)
+                        df = self._read_pandas(
+                            data_format, BytesIO(content_stream.content)
+                        )
+
+                    df_list.append(df)
                 offset += 1
 
         return df_list
 
     def _read_s3(self, storage_connector, location, data_format):
         # get key prefix
         path_parts = location.replace("s3://", "").split("/")
@@ -263,16 +305,18 @@
         options,
         include_metadata,
     ):
         raise NotImplementedError(
             "Streaming Sources are not supported for pure Python Environments."
         )
 
-    def show(self, sql_query, feature_store, n, online_conn):
-        return self.sql(sql_query, feature_store, online_conn, "default", {}).head(n)
+    def show(self, sql_query, feature_store, n, online_conn, read_options={}):
+        return self.sql(
+            sql_query, feature_store, online_conn, "default", read_options
+        ).head(n)
 
     def register_external_temporary_table(self, external_fg, alias):
         # No op to avoid query failure
         pass
 
     def register_hudi_temporary_table(
         self, hudi_fg_alias, feature_store_id, feature_store_name, read_options
@@ -312,15 +356,16 @@
         if not relevant_columns:
             stats = df.describe()
         else:
             target_cols = [col for col in df.columns if col in relevant_columns]
             stats = df[target_cols].describe()
         final_stats = []
         for col in stats.columns:
-            stat = self._convert_pandas_statistics(stats[col].to_dict())
+            stats_dict = json.loads(stats[col].to_json())
+            stat = self._convert_pandas_statistics(stats_dict)
             stat["dataType"] = (
                 "Fractional"
                 if isinstance(stats[col].dtype, type(np.dtype(np.float64)))
                 else "Integral"
             )
             stat["isDataTypeInferred"] = "false"
             stat["column"] = col.split(".")[-1]
@@ -396,14 +441,16 @@
             # convert timestamps with timezone to UTC
             for col in dataframe_copy.columns:
                 if isinstance(
                     dataframe_copy[col].dtype, pd.core.dtypes.dtypes.DatetimeTZDtype
                 ):
                     dataframe_copy[col] = dataframe_copy[col].dt.tz_convert(None)
             return dataframe_copy
+        elif dataframe == "spine":
+            return None
 
         raise TypeError(
             "The provided dataframe type is not recognized. Supported types are: pandas dataframe. "
             + "The provided dataframe has type: {}".format(type(dataframe))
         )
 
     def parse_schema_feature_group(self, dataframe, time_travel_format=None):
@@ -656,17 +703,23 @@
             td_job,
             await_termination=user_write_options.get("wait_for_job", True),
         )
 
         return td_job
 
     def _create_hive_connection(self, feature_store, hive_config=None):
+        host = variable_api.VariableApi().get_loadbalancer_external_domain()
+        if host == "":
+            # If the load balancer is not configured, then fall back to use
+            # the hive server on the head node
+            host = client.get_instance().host
+
         try:
             return hive.Connection(
-                host=client.get_instance()._host,
+                host=host,
                 port=9085,
                 # database needs to be set every time, 'default' doesn't work in pyhive
                 database=feature_store,
                 configuration=hive_config,
                 auth="CERTIFICATES",
                 truststore=client.get_instance()._get_jks_trust_store_path(),
                 keystore=client.get_instance()._get_jks_key_store_path(),
@@ -883,14 +936,16 @@
                 # for avro to be able to serialize them, they need to be python data types
                 if isinstance(row[k], np.ndarray):
                     row[k] = row[k].tolist()
                 if isinstance(row[k], pd.Timestamp):
                     row[k] = row[k].to_pydatetime()
                 if isinstance(row[k], datetime) and row[k].tzinfo is None:
                     row[k] = row[k].replace(tzinfo=timezone.utc)
+                if isinstance(row[k], pd._libs.missing.NAType):
+                    row[k] = None
 
             # encode complex features
             row = self._encode_complex_features(feature_writers, row)
 
             # encode feature row
             with BytesIO() as outf:
                 writer(row, outf)
@@ -921,23 +976,23 @@
                 warnings.warn(
                     "This is the first ingestion after an upgrade or backup/restore, running backfill job even though `start_offline_backfill` was set to `False`.",
                     util.FeatureGroupWarning,
                 )
             feature_group.backfill_job.run(
                 args=feature_group.backfill_job.config.get("defaultArgs", "")
                 + " -kafkaOffsetReset true",
-                await_termination=offline_write_options.get("wait_for_job", True),
+                await_termination=offline_write_options.get("wait_for_job", False),
             )
         elif (
             not isinstance(feature_group, ExternalFeatureGroup)
             and offline_write_options is not None
             and offline_write_options.get("start_offline_backfill", True)
         ):
             feature_group.backfill_job.run(
-                await_termination=offline_write_options.get("wait_for_job", True)
+                await_termination=offline_write_options.get("wait_for_job", False)
             )
         if isinstance(feature_group, ExternalFeatureGroup):
             return None
         return feature_group.backfill_job
 
     def _kafka_produce(
         self, producer, feature_group, key, encoded_row, acked, offline_write_options
@@ -1102,22 +1157,40 @@
         raise ValueError(f"dtype '{dtype}' not supported")
 
     @staticmethod
     def _convert_pandas_object_type_to_offline_type(arrow_type):
         if pa.types.is_list(arrow_type):
             # figure out sub type
             sub_arrow_type = arrow_type.value_type
-            sub_dtype = np.dtype(sub_arrow_type.to_pandas_dtype())
+            try:
+                sub_dtype = np.dtype(sub_arrow_type.to_pandas_dtype())
+            except NotImplementedError:
+                sub_dtype = np.dtype("object")
             subtype = Engine._convert_pandas_dtype_to_offline_type(
                 sub_dtype, sub_arrow_type
             )
             return "array<{}>".format(subtype)
         if pa.types.is_struct(arrow_type):
-            # best effort, based on pyarrow's string representation
-            return str(arrow_type)
+            struct_schema = {}
+            for index in range(arrow_type.num_fields):
+                sub_arrow_type = arrow_type.field(index).type
+                try:
+                    sub_dtype = np.dtype(sub_arrow_type.to_pandas_dtype())
+                except NotImplementedError:
+                    sub_dtype = np.dtype("object")
+                struct_schema[
+                    arrow_type.field(index).name
+                ] = Engine._convert_pandas_dtype_to_offline_type(
+                    sub_dtype, arrow_type.field(index).type
+                )
+            return (
+                "struct<"
+                + ",".join([f"{key}:{value}" for key, value in struct_schema.items()])
+                + ">"
+            )
         # Currently not supported
         # elif pa.types.is_decimal(arrow_type):
         #    return str(arrow_type).replace("decimal128", "decimal")
         elif pa.types.is_date(arrow_type):
             return "date"
         elif pa.types.is_binary(arrow_type):
             return "binary"
@@ -1216,7 +1289,19 @@
                     df[_feat.name], _feat.type
                 )
             else:
                 df[_feat.name] = Engine._cast_column_to_online_type(
                     df[_feat.name], _feat.online_type
                 )
         return df
+
+    @staticmethod
+    def is_connector_type_supported(connector_type):
+        return connector_type in [
+            StorageConnector.HOPSFS,
+            StorageConnector.S3,
+            StorageConnector.JDBC,
+            StorageConnector.REDSHIFT,
+            StorageConnector.ADLS,
+            StorageConnector.SNOWFLAKE,
+            StorageConnector.KAFKA,
+        ]
```

### Comparing `hsfs-3.2.1/hsfs/engine/spark.py` & `hsfs-3.3.0rc0/hsfs/engine/spark.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,14 +28,15 @@
 from datetime import datetime, timezone
 
 import tzlocal
 
 # in case importing in %%local
 
 try:
+    import pyspark
     from pyspark import SparkFiles
     from pyspark.sql import SparkSession, DataFrame, SQLContext
     from pyspark.rdd import RDD
     from pyspark.sql.functions import (
         struct,
         concat,
         col,
@@ -58,19 +59,26 @@
         TimestampType,
         ArrayType,
         StructType,
         BinaryType,
         BooleanType,
         StructField,
     )
+
+    if pd.__version__ >= "2.0.0" and pyspark.__version__ < "3.2.3":
+
+        def iteritems(self):
+            return self.items()
+
+        setattr(pd.DataFrame, "iteritems", iteritems)
 except ImportError:
     pass
 
 from hsfs import feature, training_dataset_feature, client, util
-from hsfs.feature_group import ExternalFeatureGroup
+from hsfs.feature_group import ExternalFeatureGroup, SpineGroup
 from hsfs.storage_connector import StorageConnector
 from hsfs.client.exceptions import FeatureStoreException
 from hsfs.client import hopsworks
 from hsfs.core import hudi_engine, transformation_function_engine, kafka_api
 from hsfs.constructor import query
 from hsfs.training_dataset_split import TrainingDatasetSplit
 
@@ -119,32 +127,40 @@
             result_df = self._sql_offline(sql_query, feature_store)
         else:
             result_df = connector.read(sql_query, None, {}, None)
 
         self.set_job_group("", "")
         return self._return_dataframe_type(result_df, dataframe_type)
 
+    def is_flyingduck_query_supported(self, query, read_options):
+        return False  # we do not support flyingduck on pyspark clients
+
     def _sql_offline(self, sql_query, feature_store):
         # set feature store
         self._spark_session.sql("USE {}".format(feature_store))
         return self._spark_session.sql(sql_query)
 
-    def show(self, sql_query, feature_store, n, online_conn):
-        return self.sql(sql_query, feature_store, online_conn, "default", {}).show(n)
+    def show(self, sql_query, feature_store, n, online_conn, read_options={}):
+        return self.sql(
+            sql_query, feature_store, online_conn, "default", read_options
+        ).show(n)
 
     def set_job_group(self, group_id, description):
         self._spark_session.sparkContext.setJobGroup(group_id, description)
 
     def register_external_temporary_table(self, external_fg, alias):
-        external_dataset = external_fg.storage_connector.read(
-            external_fg.query,
-            external_fg.data_format,
-            external_fg.options,
-            external_fg.storage_connector._get_path(external_fg.path),
-        )
+        if not isinstance(external_fg, SpineGroup):
+            external_dataset = external_fg.storage_connector.read(
+                external_fg.query,
+                external_fg.data_format,
+                external_fg.options,
+                external_fg.storage_connector._get_path(external_fg.path),
+            )
+        else:
+            external_dataset = external_fg.dataframe
         if external_fg.location:
             self._spark_session.sparkContext.textFile(external_fg.location).collect()
 
         external_dataset.createOrReplaceTempView(alias)
         return external_dataset
 
     def register_hudi_temporary_table(
@@ -239,14 +255,16 @@
                 for struct_field in nullable_schema:
                     struct_field.nullable = True
                 lowercase_dataframe = self._spark_session.createDataFrame(
                     lowercase_dataframe.rdd, nullable_schema
                 )
 
             return lowercase_dataframe
+        if dataframe == "spine":
+            return None
 
         raise TypeError(
             "The provided dataframe type is not recognized. Supported types are: spark rdds, spark dataframes, "
             "pandas dataframes, python 2D lists, and numpy 2D arrays. The provided dataframe has type: {}".format(
                 type(dataframe)
             )
         )
@@ -371,15 +389,14 @@
             ).partitionBy(
                 feature_group.partition_key if feature_group.partition_key else []
             ).saveAsTable(
                 feature_group._get_table_name()
             )
 
     def _save_online_dataframe(self, feature_group, dataframe, write_options):
-
         write_options = self._get_kafka_config(write_options)
 
         serialized_df = self._online_fg_to_avro(
             feature_group, self._encode_complex_features(feature_group, dataframe)
         )
 
         version = str(feature_group.subject["version"]).encode("utf8")
@@ -839,14 +856,15 @@
             return self._setup_adls_hadoop_conf(storage_connector, path)
         elif storage_connector.type == StorageConnector.GCS:
             return self._setup_gcp_hadoop_conf(storage_connector, path)
         else:
             return path
 
     def _setup_s3_hadoop_conf(self, storage_connector, path):
+        FS_S3_ENDPOINT = "fs.s3a.endpoint"
         if storage_connector.access_key:
             self._spark_context._jsc.hadoopConfiguration().set(
                 "fs.s3a.access.key", storage_connector.access_key
             )
         if storage_connector.secret_key:
             self._spark_context._jsc.hadoopConfiguration().set(
                 "fs.s3a.secret.key", storage_connector.secret_key
@@ -866,14 +884,19 @@
                 "fs.s3a.aws.credentials.provider",
                 "org.apache.hadoop.fs.s3a.TemporaryAWSCredentialsProvider",
             )
             self._spark_context._jsc.hadoopConfiguration().set(
                 "fs.s3a.session.token",
                 storage_connector.session_token,
             )
+        if FS_S3_ENDPOINT in storage_connector.arguments:
+            self._spark_context._jsc.hadoopConfiguration().set(
+                FS_S3_ENDPOINT, storage_connector.spark_options().get(FS_S3_ENDPOINT)
+            )
+
         return path.replace("s3", "s3a", 1) if path is not None else None
 
     def _setup_adls_hadoop_conf(self, storage_connector, path):
         for k, v in storage_connector.spark_options().items():
             self._spark_context._jsc.hadoopConfiguration().set(k, v)
 
         return path
@@ -956,15 +979,14 @@
 
         # generate entire expression and execute it
         transformation_fn_expressions.extend(no_transformation_expr)
         transformed_dataset = dataset.selectExpr(*transformation_fn_expressions)
         return transformed_dataset.select(*dataset.columns)
 
     def _setup_gcp_hadoop_conf(self, storage_connector, path):
-
         PROPERTY_ENCRYPTION_KEY = "fs.gs.encryption.key"
         PROPERTY_ENCRYPTION_HASH = "fs.gs.encryption.key.hash"
         PROPERTY_ALGORITHM = "fs.gs.encryption.algorithm"
         PROPERTY_GCS_FS_KEY = "fs.AbstractFileSystem.gs.impl"
         PROPERTY_GCS_FS_VALUE = "com.google.cloud.hadoop.fs.gcs.GoogleHadoopFS"
         PROPERTY_GCS_ACCOUNT_ENABLE = "google.cloud.auth.service.account.enable"
         PROPERTY_ACCT_EMAIL = "fs.gs.auth.service.account.email"
@@ -1104,15 +1126,14 @@
         )
         for _feat in pyspark_schema:
             df = df.withColumn(_feat, col(_feat).cast(pyspark_schema[_feat]))
         return df
 
     def _get_kafka_config(self, write_options: dict = {}) -> dict:
         if self._kafka_config is None:
-
             self._kafka_config = {
                 "kafka.security.protocol": "SSL",
                 "kafka.ssl.truststore.location": client.get_instance()._get_jks_trust_store_path(),
                 "kafka.ssl.truststore.password": client.get_instance()._cert_key,
                 "kafka.ssl.keystore.location": client.get_instance()._get_jks_key_store_path(),
                 "kafka.ssl.keystore.password": client.get_instance()._cert_key,
                 "kafka.ssl.key.password": client.get_instance()._cert_key,
@@ -1137,10 +1158,14 @@
                             externalListeners=True
                         )
                     ]
                 )
 
         return {**write_options, **self._kafka_config}
 
+    @staticmethod
+    def is_connector_type_supported(type):
+        return True
+
 
 class SchemaError(Exception):
     """Thrown when schemas don't match"""
```

### Comparing `hsfs-3.2.1/hsfs/expectation_suite.py` & `hsfs-3.3.0rc0/hsfs/expectation_suite.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/feature.py` & `hsfs-3.3.0rc0/hsfs/feature.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/feature_group.py` & `hsfs-3.3.0rc0/hsfs/feature_group.py`

 * *Files 2% similar despite different names*

```diff
@@ -70,6850 +70,7358 @@
 00000450: 2020 2020 6578 7065 6374 6174 696f 6e5f      expectation_
 00000460: 7375 6974 655f 656e 6769 6e65 2c0a 2020  suite_engine,.  
 00000470: 2020 7661 6c69 6461 7469 6f6e 5f72 6570    validation_rep
 00000480: 6f72 745f 656e 6769 6e65 2c0a 2020 2020  ort_engine,.    
 00000490: 636f 6465 5f65 6e67 696e 652c 0a20 2020  code_engine,.   
 000004a0: 2065 7874 6572 6e61 6c5f 6665 6174 7572   external_featur
 000004b0: 655f 6772 6f75 705f 656e 6769 6e65 2c0a  e_group_engine,.
-000004c0: 2020 2020 7661 6c69 6461 7469 6f6e 5f72      validation_r
-000004d0: 6573 756c 745f 656e 6769 6e65 2c0a 2020  esult_engine,.  
-000004e0: 2020 6a6f 625f 6170 692c 0a29 0a0a 6672    job_api,.)..fr
-000004f0: 6f6d 2068 7366 732e 7374 6174 6973 7469  om hsfs.statisti
-00000500: 6373 5f63 6f6e 6669 6720 696d 706f 7274  cs_config import
-00000510: 2053 7461 7469 7374 6963 7343 6f6e 6669   StatisticsConfi
-00000520: 670a 6672 6f6d 2068 7366 732e 6578 7065  g.from hsfs.expe
-00000530: 6374 6174 696f 6e5f 7375 6974 6520 696d  ctation_suite im
-00000540: 706f 7274 2045 7870 6563 7461 7469 6f6e  port Expectation
-00000550: 5375 6974 650a 6672 6f6d 2068 7366 732e  Suite.from hsfs.
-00000560: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
-00000570: 7420 696d 706f 7274 2056 616c 6964 6174  t import Validat
-00000580: 696f 6e52 6570 6f72 740a 6672 6f6d 2068  ionReport.from h
-00000590: 7366 732e 636f 6e73 7472 7563 746f 7220  sfs.constructor 
-000005a0: 696d 706f 7274 2071 7565 7279 2c20 6669  import query, fi
-000005b0: 6c74 6572 0a66 726f 6d20 6873 6673 2e63  lter.from hsfs.c
-000005c0: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-000005d0: 2069 6d70 6f72 7420 4665 6174 7572 6553   import FeatureS
-000005e0: 746f 7265 4578 6365 7074 696f 6e0a 6672  toreException.fr
-000005f0: 6f6d 2068 7366 732e 636f 7265 2e6a 6f62  om hsfs.core.job
-00000600: 2069 6d70 6f72 7420 4a6f 620a 6672 6f6d   import Job.from
-00000610: 2068 7366 732e 636f 7265 2e76 6172 6961   hsfs.core.varia
-00000620: 626c 655f 6170 6920 696d 706f 7274 2056  ble_api import V
-00000630: 6172 6961 626c 6541 7069 0a66 726f 6d20  ariableApi.from 
-00000640: 6873 6673 2e63 6f72 6520 696d 706f 7274  hsfs.core import
-00000650: 2067 7265 6174 5f65 7870 6563 7461 7469   great_expectati
-00000660: 6f6e 5f65 6e67 696e 650a 0a0a 636c 6173  on_engine...clas
-00000670: 7320 4665 6174 7572 6547 726f 7570 4261  s FeatureGroupBa
-00000680: 7365 3a0a 2020 2020 6465 6620 5f5f 696e  se:.    def __in
-00000690: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
-000006a0: 6c66 2c0a 2020 2020 2020 2020 6665 6174  lf,.        feat
-000006b0: 7572 6573 746f 7265 5f69 642c 0a20 2020  urestore_id,.   
-000006c0: 2020 2020 206c 6f63 6174 696f 6e2c 0a20       location,. 
-000006d0: 2020 2020 2020 2065 7665 6e74 5f74 696d         event_tim
-000006e0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-000006f0: 6f6e 6c69 6e65 5f65 6e61 626c 6564 3d46  online_enabled=F
-00000700: 616c 7365 2c0a 2020 2020 2020 2020 6964  alse,.        id
-00000710: 3d4e 6f6e 652c 0a20 2020 2020 2020 2065  =None,.        e
-00000720: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-00000730: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
-00000740: 6e6c 696e 655f 746f 7069 635f 6e61 6d65  nline_topic_name
-00000750: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-00000760: 2020 2020 2020 7365 6c66 2e65 7665 6e74        self.event
-00000770: 5f74 696d 6520 3d20 6576 656e 745f 7469  _time = event_ti
-00000780: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
-00000790: 5f6f 6e6c 696e 655f 656e 6162 6c65 6420  _online_enabled 
-000007a0: 3d20 6f6e 6c69 6e65 5f65 6e61 626c 6564  = online_enabled
-000007b0: 0a20 2020 2020 2020 2073 656c 662e 5f6c  .        self._l
-000007c0: 6f63 6174 696f 6e20 3d20 6c6f 6361 7469  ocation = locati
-000007d0: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
-000007e0: 5f69 6420 3d20 6964 0a20 2020 2020 2020  _id = id.       
-000007f0: 2073 656c 662e 5f73 7562 6a65 6374 203d   self._subject =
-00000800: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00000810: 6c66 2e5f 6f6e 6c69 6e65 5f74 6f70 6963  lf._online_topic
-00000820: 5f6e 616d 6520 3d20 6f6e 6c69 6e65 5f74  _name = online_t
-00000830: 6f70 6963 5f6e 616d 650a 2020 2020 2020  opic_name.      
-00000840: 2020 7365 6c66 2e5f 6665 6174 7572 655f    self._feature_
-00000850: 7374 6f72 655f 6964 203d 2066 6561 7475  store_id = featu
-00000860: 7265 7374 6f72 655f 6964 0a20 2020 2020  restore_id.     
-00000870: 2020 2023 2075 7365 2073 6574 7465 7220     # use setter 
-00000880: 666f 7220 636f 7272 6563 7420 636f 6e76  for correct conv
-00000890: 6572 7369 6f6e 0a20 2020 2020 2020 2073  ersion.        s
-000008a0: 656c 662e 6578 7065 6374 6174 696f 6e5f  elf.expectation_
-000008b0: 7375 6974 6520 3d20 6578 7065 6374 6174  suite = expectat
-000008c0: 696f 6e5f 7375 6974 650a 2020 2020 2020  ion_suite.      
-000008d0: 2020 7365 6c66 2e5f 7374 6174 6973 7469    self._statisti
-000008e0: 6373 5f65 6e67 696e 6520 3d20 7374 6174  cs_engine = stat
-000008f0: 6973 7469 6373 5f65 6e67 696e 652e 5374  istics_engine.St
-00000900: 6174 6973 7469 6373 456e 6769 6e65 280a  atisticsEngine(.
-00000910: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00000920: 7572 6573 746f 7265 5f69 642c 2073 656c  urestore_id, sel
-00000930: 662e 454e 5449 5459 5f54 5950 450a 2020  f.ENTITY_TYPE.  
-00000940: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00000950: 7365 6c66 2e5f 636f 6465 5f65 6e67 696e  self._code_engin
-00000960: 6520 3d20 636f 6465 5f65 6e67 696e 652e  e = code_engine.
-00000970: 436f 6465 456e 6769 6e65 2866 6561 7475  CodeEngine(featu
-00000980: 7265 7374 6f72 655f 6964 2c20 7365 6c66  restore_id, self
-00000990: 2e45 4e54 4954 595f 5459 5045 290a 2020  .ENTITY_TYPE).  
-000009a0: 2020 2020 2020 7365 6c66 2e5f 6772 6561        self._grea
-000009b0: 745f 6578 7065 6374 6174 696f 6e5f 656e  t_expectation_en
-000009c0: 6769 6e65 203d 2028 0a20 2020 2020 2020  gine = (.       
-000009d0: 2020 2020 2067 7265 6174 5f65 7870 6563       great_expec
-000009e0: 7461 7469 6f6e 5f65 6e67 696e 652e 4772  tation_engine.Gr
-000009f0: 6561 7445 7870 6563 7461 7469 6f6e 456e  eatExpectationEn
-00000a00: 6769 6e65 2866 6561 7475 7265 7374 6f72  gine(featurestor
-00000a10: 655f 6964 290a 2020 2020 2020 2020 290a  e_id).        ).
-00000a20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00000a30: 5f69 6420 6973 206e 6f74 204e 6f6e 653a  _id is not None:
-00000a40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00000a50: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00000a60: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00000a70: 2020 2073 656c 662e 5f65 7870 6563 7461     self._expecta
-00000a80: 7469 6f6e 5f73 7569 7465 2e5f 696e 6974  tion_suite._init
-00000a90: 5f65 7870 6563 7461 7469 6f6e 5f65 6e67  _expectation_eng
-00000aa0: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
-00000ab0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00000ac0: 5f73 746f 7265 5f69 643d 6665 6174 7572  _store_id=featur
-00000ad0: 6573 746f 7265 5f69 642c 2066 6561 7475  estore_id, featu
-00000ae0: 7265 5f67 726f 7570 5f69 643d 7365 6c66  re_group_id=self
-00000af0: 2e5f 6964 0a20 2020 2020 2020 2020 2020  ._id.           
-00000b00: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00000b10: 2020 2073 656c 662e 5f65 7870 6563 7461     self._expecta
-00000b20: 7469 6f6e 5f73 7569 7465 5f65 6e67 696e  tion_suite_engin
-00000b30: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
-00000b40: 2020 2020 2020 6578 7065 6374 6174 696f        expectatio
-00000b50: 6e5f 7375 6974 655f 656e 6769 6e65 2e45  n_suite_engine.E
-00000b60: 7870 6563 7461 7469 6f6e 5375 6974 6545  xpectationSuiteE
-00000b70: 6e67 696e 6528 0a20 2020 2020 2020 2020  ngine(.         
-00000b80: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00000b90: 7265 5f73 746f 7265 5f69 643d 6665 6174  re_store_id=feat
-00000ba0: 7572 6573 746f 7265 5f69 642c 2066 6561  urestore_id, fea
-00000bb0: 7475 7265 5f67 726f 7570 5f69 643d 7365  ture_group_id=se
-00000bc0: 6c66 2e5f 6964 0a20 2020 2020 2020 2020  lf._id.         
-00000bd0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00000be0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00000bf0: 2020 2073 656c 662e 5f76 616c 6964 6174     self._validat
-00000c00: 696f 6e5f 7265 706f 7274 5f65 6e67 696e  ion_report_engin
-00000c10: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
-00000c20: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
-00000c30: 5f72 6570 6f72 745f 656e 6769 6e65 2e56  _report_engine.V
-00000c40: 616c 6964 6174 696f 6e52 6570 6f72 7445  alidationReportE
-00000c50: 6e67 696e 6528 0a20 2020 2020 2020 2020  ngine(.         
-00000c60: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00000c70: 7265 7374 6f72 655f 6964 2c20 7365 6c66  restore_id, self
-00000c80: 2e5f 6964 0a20 2020 2020 2020 2020 2020  ._id.           
-00000c90: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00000ca0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00000cb0: 2073 656c 662e 5f76 616c 6964 6174 696f   self._validatio
-00000cc0: 6e5f 7265 7375 6c74 5f65 6e67 696e 6520  n_result_engine 
-00000cd0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00000ce0: 2020 2020 7661 6c69 6461 7469 6f6e 5f72      validation_r
-00000cf0: 6573 756c 745f 656e 6769 6e65 2e56 616c  esult_engine.Val
-00000d00: 6964 6174 696f 6e52 6573 756c 7445 6e67  idationResultEng
-00000d10: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
-00000d20: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00000d30: 7374 6f72 655f 6964 2c20 7365 6c66 2e5f  store_id, self._
-00000d40: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-00000d50: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00000d60: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
-00000d70: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
-00000d80: 6964 203d 2066 6561 7475 7265 7374 6f72  id = featurestor
-00000d90: 655f 6964 0a20 2020 2020 2020 2073 656c  e_id.        sel
-00000da0: 662e 5f76 6172 6961 626c 655f 6170 6920  f._variable_api 
-00000db0: 3d20 5661 7269 6162 6c65 4170 6928 290a  = VariableApi().
-00000dc0: 2020 2020 2020 2020 7365 6c66 2e5f 6665          self._fe
-00000dd0: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
-00000de0: 6e65 203d 204e 6f6e 650a 2020 2020 2020  ne = None.      
-00000df0: 2020 7365 6c66 2e5f 6d75 6c74 695f 7061    self._multi_pa
-00000e00: 7274 5f69 6e73 6572 7420 3d20 4661 6c73  rt_insert = Fals
-00000e10: 650a 0a20 2020 2064 6566 2064 656c 6574  e..    def delet
-00000e20: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00000e30: 2022 2222 4472 6f70 2074 6865 2065 6e74   """Drop the ent
-00000e40: 6972 6520 6665 6174 7572 6520 6772 6f75  ire feature grou
-00000e50: 7020 616c 6f6e 6720 7769 7468 2069 7473  p along with its
-00000e60: 2066 6561 7475 7265 2064 6174 612e 0a0a   feature data...
-00000e70: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
-00000e80: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
-00000e90: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00000ea0: 2020 2020 2020 2320 636f 6e6e 6563 7420        # connect 
-00000eb0: 746f 2074 6865 2046 6561 7475 7265 2053  to the Feature S
-00000ec0: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
-00000ed0: 2066 7320 3d20 2e2e 2e0a 0a20 2020 2020   fs = .....     
-00000ee0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
-00000ef0: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
-00000f00: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
-00000f10: 2020 2020 6667 203d 2066 732e 6765 745f      fg = fs.get_
-00000f20: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
-00000f30: 655f 6772 6f75 7028 0a20 2020 2020 2020  e_group(.       
-00000f40: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-00000f50: 653d 2762 6974 636f 696e 5f70 7269 6365  e='bitcoin_price
-00000f60: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00000f70: 2020 2020 2020 2076 6572 7369 6f6e 3d31         version=1
-00000f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000f90: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00000fa0: 2020 2020 2320 6465 6c65 7465 2074 6865      # delete the
-00000fb0: 2066 6561 7475 7265 2067 726f 7570 0a20   feature group. 
-00000fc0: 2020 2020 2020 2020 2020 2066 672e 6465             fg.de
-00000fd0: 6c65 7465 2829 0a20 2020 2020 2020 2020  lete().         
-00000fe0: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-00000ff0: 2121 2120 6461 6e67 6572 2022 506f 7465  !!! danger "Pote
-00001000: 6e74 6961 6c6c 7920 6461 6e67 6572 6f75  ntially dangerou
-00001010: 7320 6f70 6572 6174 696f 6e22 0a20 2020  s operation".   
-00001020: 2020 2020 2020 2020 2054 6869 7320 6f70           This op
-00001030: 6572 6174 696f 6e20 6472 6f70 7320 616c  eration drops al
-00001040: 6c20 6d65 7461 6461 7461 2061 7373 6f63  l metadata assoc
-00001050: 6961 7465 6420 7769 7468 202a 2a74 6869  iated with **thi
-00001060: 7320 7665 7273 696f 6e2a 2a20 6f66 2074  s version** of t
-00001070: 6865 0a20 2020 2020 2020 2020 2020 2066  he.            f
-00001080: 6561 7475 7265 2067 726f 7570 202a 2a61  eature group **a
-00001090: 6e64 2a2a 2061 6c6c 2074 6865 2066 6561  nd** all the fea
-000010a0: 7475 7265 2064 6174 6120 696e 206f 6666  ture data in off
-000010b0: 6c69 6e65 2061 6e64 206f 6e6c 696e 6520  line and online 
-000010c0: 7374 6f72 6167 650a 2020 2020 2020 2020  storage.        
-000010d0: 2020 2020 6173 736f 6369 6174 6564 2077      associated w
-000010e0: 6974 6820 6974 2e0a 0a20 2020 2020 2020  ith it...       
-000010f0: 2023 2052 6169 7365 730a 2020 2020 2020   # Raises.      
-00001100: 2020 2020 2020 6068 7366 732e 636c 6965        `hsfs.clie
-00001110: 6e74 2e65 7863 6570 7469 6f6e 732e 5265  nt.exceptions.Re
-00001120: 7374 4150 4945 7272 6f72 602e 0a20 2020  stAPIError`..   
-00001130: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00001140: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-00001150: 2020 2020 2020 2020 2020 2020 2241 6c6c              "All
-00001160: 206a 6f62 7320 6173 736f 6369 6174 6564   jobs associated
-00001170: 2074 6f20 6665 6174 7572 6520 6772 6f75   to feature grou
-00001180: 7020 607b 7d60 2c20 7665 7273 696f 6e20  p `{}`, version 
-00001190: 607b 7d60 2077 696c 6c20 6265 2072 656d  `{}` will be rem
-000011a0: 6f76 6564 2e22 2e66 6f72 6d61 7428 0a20  oved.".format(. 
-000011b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000011c0: 656c 662e 5f6e 616d 652c 2073 656c 662e  elf._name, self.
-000011d0: 5f76 6572 7369 6f6e 0a20 2020 2020 2020  _version.       
-000011e0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-000011f0: 2020 2020 7574 696c 2e4a 6f62 5761 726e      util.JobWarn
-00001200: 696e 672c 0a20 2020 2020 2020 2029 0a20  ing,.        ). 
-00001210: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
-00001220: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
-00001230: 652e 6465 6c65 7465 2873 656c 6629 0a0a  e.delete(self)..
-00001240: 2020 2020 6465 6620 7365 6c65 6374 5f61      def select_a
-00001250: 6c6c 280a 2020 2020 2020 2020 7365 6c66  ll(.        self
-00001260: 2c0a 2020 2020 2020 2020 696e 636c 7564  ,.        includ
-00001270: 655f 7072 696d 6172 795f 6b65 793a 204f  e_primary_key: O
-00001280: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-00001290: 5472 7565 2c0a 2020 2020 2020 2020 696e  True,.        in
-000012a0: 636c 7564 655f 6576 656e 745f 7469 6d65  clude_event_time
-000012b0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-000012c0: 203d 2054 7275 652c 0a20 2020 2029 3a0a   = True,.    ):.
-000012d0: 2020 2020 2020 2020 2222 2253 656c 6563          """Selec
-000012e0: 7420 616c 6c20 6665 6174 7572 6573 2069  t all features i
-000012f0: 6e20 7468 6520 6665 6174 7572 6520 6772  n the feature gr
-00001300: 6f75 7020 616e 6420 7265 7475 726e 2061  oup and return a
-00001310: 2071 7565 7279 206f 626a 6563 742e 0a0a   query object...
-00001320: 2020 2020 2020 2020 5468 6520 7175 6572          The quer
-00001330: 7920 6361 6e20 6265 2075 7365 6420 746f  y can be used to
-00001340: 2063 6f6e 7374 7275 6374 206a 6f69 6e73   construct joins
-00001350: 206f 6620 6665 6174 7572 6520 6772 6f75   of feature grou
-00001360: 7073 206f 7220 6372 6561 7465 2061 0a20  ps or create a. 
-00001370: 2020 2020 2020 2066 6561 7475 7265 2076         feature v
-00001380: 6965 772e 0a0a 2020 2020 2020 2020 2121  iew...        !!
-00001390: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-000013a0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-000013b0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-000013c0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
-000013d0: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
-000013e0: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
-000013f0: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
-00001400: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
-00001410: 726f 7570 2069 6e73 7461 6e63 6573 0a20  roup instances. 
-00001420: 2020 2020 2020 2020 2020 2066 6731 203d             fg1 =
-00001430: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
-00001440: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
-00001450: 2e2e 2e29 0a20 2020 2020 2020 2020 2020  ...).           
-00001460: 2066 6732 203d 2066 732e 6765 745f 6f72   fg2 = fs.get_or
-00001470: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
-00001480: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
-00001490: 2020 2020 2020 2020 2320 636f 6e73 7472          # constr
-000014a0: 7563 7420 7468 6520 7175 6572 790a 2020  uct the query.  
-000014b0: 2020 2020 2020 2020 2020 7175 6572 7920            query 
-000014c0: 3d20 6667 312e 7365 6c65 6374 5f61 6c6c  = fg1.select_all
-000014d0: 2829 2e6a 6f69 6e28 6667 322e 7365 6c65  ().join(fg2.sele
-000014e0: 6374 5f61 6c6c 2829 290a 0a20 2020 2020  ct_all())..     
-000014f0: 2020 2020 2020 2023 2073 686f 7720 6669         # show fi
-00001500: 7273 7420 3520 726f 7773 0a20 2020 2020  rst 5 rows.     
-00001510: 2020 2020 2020 2071 7565 7279 2e73 686f         query.sho
-00001520: 7728 3529 0a0a 0a20 2020 2020 2020 2020  w(5)...         
-00001530: 2020 2023 2073 656c 6563 7420 616c 6c20     # select all 
-00001540: 6665 6174 7572 6573 2065 7863 6c75 6465  features exclude
-00001550: 2070 7269 6d61 7279 206b 6579 2061 6e64   primary key and
-00001560: 2065 7665 6e74 2074 696d 650a 2020 2020   event time.    
-00001570: 2020 2020 2020 2020 6672 6f6d 2068 7366          from hsf
-00001580: 732e 6665 6174 7572 6520 696d 706f 7274  s.feature import
-00001590: 2046 6561 7475 7265 0a20 2020 2020 2020   Feature.       
-000015a0: 2020 2020 2066 6720 3d20 6673 2e63 7265       fg = fs.cre
-000015b0: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
-000015c0: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-000015d0: 2020 2020 2020 2022 6667 222c 0a20 2020         "fg",.   
-000015e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000015f0: 2066 6561 7475 7265 733d 5b0a 2020 2020   features=[.    
-00001600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001610: 2020 2020 2020 2020 4665 6174 7572 6528          Feature(
-00001620: 2269 6422 2c20 7479 7065 3d22 7374 7269  "id", type="stri
-00001630: 6e67 2229 2c0a 2020 2020 2020 2020 2020  ng"),.          
-00001640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001650: 2020 4665 6174 7572 6528 2274 7322 2c20    Feature("ts", 
-00001660: 7479 7065 3d22 6269 6769 6e74 2229 2c0a  type="bigint"),.
-00001670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001680: 2020 2020 2020 2020 2020 2020 4665 6174              Feat
-00001690: 7572 6528 2266 3122 2c20 7479 7065 3d22  ure("f1", type="
-000016a0: 6461 7465 2229 2c0a 2020 2020 2020 2020  date"),.        
-000016b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000016c0: 2020 2020 4665 6174 7572 6528 2266 3222      Feature("f2"
-000016d0: 2c20 7479 7065 3d22 646f 7562 6c65 2229  , type="double")
-000016e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000016f0: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+000004c0: 2020 2020 7370 696e 655f 6772 6f75 705f      spine_group_
+000004d0: 656e 6769 6e65 2c0a 2020 2020 7661 6c69  engine,.    vali
+000004e0: 6461 7469 6f6e 5f72 6573 756c 745f 656e  dation_result_en
+000004f0: 6769 6e65 2c0a 2020 2020 6a6f 625f 6170  gine,.    job_ap
+00000500: 692c 0a29 0a0a 6672 6f6d 2068 7366 732e  i,.)..from hsfs.
+00000510: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+00000520: 6720 696d 706f 7274 2053 7461 7469 7374  g import Statist
+00000530: 6963 7343 6f6e 6669 670a 6672 6f6d 2068  icsConfig.from h
+00000540: 7366 732e 6578 7065 6374 6174 696f 6e5f  sfs.expectation_
+00000550: 7375 6974 6520 696d 706f 7274 2045 7870  suite import Exp
+00000560: 6563 7461 7469 6f6e 5375 6974 650a 6672  ectationSuite.fr
+00000570: 6f6d 2068 7366 732e 7661 6c69 6461 7469  om hsfs.validati
+00000580: 6f6e 5f72 6570 6f72 7420 696d 706f 7274  on_report import
+00000590: 2056 616c 6964 6174 696f 6e52 6570 6f72   ValidationRepor
+000005a0: 740a 6672 6f6d 2068 7366 732e 636f 6e73  t.from hsfs.cons
+000005b0: 7472 7563 746f 7220 696d 706f 7274 2071  tructor import q
+000005c0: 7565 7279 2c20 6669 6c74 6572 0a66 726f  uery, filter.fro
+000005d0: 6d20 6873 6673 2e63 6c69 656e 742e 6578  m hsfs.client.ex
+000005e0: 6365 7074 696f 6e73 2069 6d70 6f72 7420  ceptions import 
+000005f0: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
+00000600: 7074 696f 6e0a 6672 6f6d 2068 7366 732e  ption.from hsfs.
+00000610: 636f 7265 2e6a 6f62 2069 6d70 6f72 7420  core.job import 
+00000620: 4a6f 620a 6672 6f6d 2068 7366 732e 636f  Job.from hsfs.co
+00000630: 7265 2e76 6172 6961 626c 655f 6170 6920  re.variable_api 
+00000640: 696d 706f 7274 2056 6172 6961 626c 6541  import VariableA
+00000650: 7069 0a66 726f 6d20 6873 6673 2e63 6f72  pi.from hsfs.cor
+00000660: 6520 696d 706f 7274 2067 7265 6174 5f65  e import great_e
+00000670: 7870 6563 7461 7469 6f6e 5f65 6e67 696e  xpectation_engin
+00000680: 650a 0a0a 636c 6173 7320 4665 6174 7572  e...class Featur
+00000690: 6547 726f 7570 4261 7365 3a0a 2020 2020  eGroupBase:.    
+000006a0: 6465 6620 5f5f 696e 6974 5f5f 280a 2020  def __init__(.  
+000006b0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+000006c0: 2020 2020 6665 6174 7572 6573 746f 7265      featurestore
+000006d0: 5f69 642c 0a20 2020 2020 2020 206c 6f63  _id,.        loc
+000006e0: 6174 696f 6e2c 0a20 2020 2020 2020 2065  ation,.        e
+000006f0: 7665 6e74 5f74 696d 653d 4e6f 6e65 2c0a  vent_time=None,.
+00000700: 2020 2020 2020 2020 6f6e 6c69 6e65 5f65          online_e
+00000710: 6e61 626c 6564 3d46 616c 7365 2c0a 2020  nabled=False,.  
+00000720: 2020 2020 2020 6964 3d4e 6f6e 652c 0a20        id=None,. 
+00000730: 2020 2020 2020 2065 7870 6563 7461 7469         expectati
+00000740: 6f6e 5f73 7569 7465 3d4e 6f6e 652c 0a20  on_suite=None,. 
+00000750: 2020 2020 2020 206f 6e6c 696e 655f 746f         online_to
+00000760: 7069 635f 6e61 6d65 3d4e 6f6e 652c 0a20  pic_name=None,. 
+00000770: 2020 2029 3a0a 2020 2020 2020 2020 7365     ):.        se
+00000780: 6c66 2e65 7665 6e74 5f74 696d 6520 3d20  lf.event_time = 
+00000790: 6576 656e 745f 7469 6d65 0a20 2020 2020  event_time.     
+000007a0: 2020 2073 656c 662e 5f6f 6e6c 696e 655f     self._online_
+000007b0: 656e 6162 6c65 6420 3d20 6f6e 6c69 6e65  enabled = online
+000007c0: 5f65 6e61 626c 6564 0a20 2020 2020 2020  _enabled.       
+000007d0: 2073 656c 662e 5f6c 6f63 6174 696f 6e20   self._location 
+000007e0: 3d20 6c6f 6361 7469 6f6e 0a20 2020 2020  = location.     
+000007f0: 2020 2073 656c 662e 5f69 6420 3d20 6964     self._id = id
+00000800: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
+00000810: 7562 6a65 6374 203d 204e 6f6e 650a 2020  ubject = None.  
+00000820: 2020 2020 2020 7365 6c66 2e5f 6f6e 6c69        self._onli
+00000830: 6e65 5f74 6f70 6963 5f6e 616d 6520 3d20  ne_topic_name = 
+00000840: 6f6e 6c69 6e65 5f74 6f70 6963 5f6e 616d  online_topic_nam
+00000850: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00000860: 6665 6174 7572 655f 7374 6f72 655f 6964  feature_store_id
+00000870: 203d 2066 6561 7475 7265 7374 6f72 655f   = featurestore_
+00000880: 6964 0a20 2020 2020 2020 2023 2075 7365  id.        # use
+00000890: 2073 6574 7465 7220 666f 7220 636f 7272   setter for corr
+000008a0: 6563 7420 636f 6e76 6572 7369 6f6e 0a20  ect conversion. 
+000008b0: 2020 2020 2020 2073 656c 662e 6578 7065         self.expe
+000008c0: 6374 6174 696f 6e5f 7375 6974 6520 3d20  ctation_suite = 
+000008d0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+000008e0: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+000008f0: 7374 6174 6973 7469 6373 5f65 6e67 696e  statistics_engin
+00000900: 6520 3d20 7374 6174 6973 7469 6373 5f65  e = statistics_e
+00000910: 6e67 696e 652e 5374 6174 6973 7469 6373  ngine.Statistics
+00000920: 456e 6769 6e65 280a 2020 2020 2020 2020  Engine(.        
+00000930: 2020 2020 6665 6174 7572 6573 746f 7265      featurestore
+00000940: 5f69 642c 2073 656c 662e 454e 5449 5459  _id, self.ENTITY
+00000950: 5f54 5950 450a 2020 2020 2020 2020 290a  _TYPE.        ).
+00000960: 2020 2020 2020 2020 7365 6c66 2e5f 636f          self._co
+00000970: 6465 5f65 6e67 696e 6520 3d20 636f 6465  de_engine = code
+00000980: 5f65 6e67 696e 652e 436f 6465 456e 6769  _engine.CodeEngi
+00000990: 6e65 2866 6561 7475 7265 7374 6f72 655f  ne(featurestore_
+000009a0: 6964 2c20 7365 6c66 2e45 4e54 4954 595f  id, self.ENTITY_
+000009b0: 5459 5045 290a 2020 2020 2020 2020 7365  TYPE).        se
+000009c0: 6c66 2e5f 6772 6561 745f 6578 7065 6374  lf._great_expect
+000009d0: 6174 696f 6e5f 656e 6769 6e65 203d 2028  ation_engine = (
+000009e0: 0a20 2020 2020 2020 2020 2020 2067 7265  .            gre
+000009f0: 6174 5f65 7870 6563 7461 7469 6f6e 5f65  at_expectation_e
+00000a00: 6e67 696e 652e 4772 6561 7445 7870 6563  ngine.GreatExpec
+00000a10: 7461 7469 6f6e 456e 6769 6e65 2866 6561  tationEngine(fea
+00000a20: 7475 7265 7374 6f72 655f 6964 290a 2020  turestore_id).  
+00000a30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00000a40: 6966 2073 656c 662e 5f69 6420 6973 206e  if self._id is n
+00000a50: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00000a60: 2020 2020 2069 6620 6578 7065 6374 6174       if expectat
+00000a70: 696f 6e5f 7375 6974 653a 0a20 2020 2020  ion_suite:.     
+00000a80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000a90: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
+00000aa0: 7465 2e5f 696e 6974 5f65 7870 6563 7461  te._init_expecta
+00000ab0: 7469 6f6e 5f65 6e67 696e 6528 0a20 2020  tion_engine(.   
+00000ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ad0: 2066 6561 7475 7265 5f73 746f 7265 5f69   feature_store_i
+00000ae0: 643d 6665 6174 7572 6573 746f 7265 5f69  d=featurestore_i
+00000af0: 642c 2066 6561 7475 7265 5f67 726f 7570  d, feature_group
+00000b00: 5f69 643d 7365 6c66 2e5f 6964 0a20 2020  _id=self._id.   
+00000b10: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00000b20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000b30: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
+00000b40: 7465 5f65 6e67 696e 6520 3d20 280a 2020  te_engine = (.  
+00000b50: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00000b60: 7065 6374 6174 696f 6e5f 7375 6974 655f  pectation_suite_
+00000b70: 656e 6769 6e65 2e45 7870 6563 7461 7469  engine.Expectati
+00000b80: 6f6e 5375 6974 6545 6e67 696e 6528 0a20  onSuiteEngine(. 
+00000b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000ba0: 2020 2066 6561 7475 7265 5f73 746f 7265     feature_store
+00000bb0: 5f69 643d 6665 6174 7572 6573 746f 7265  _id=featurestore
+00000bc0: 5f69 642c 2066 6561 7475 7265 5f67 726f  _id, feature_gro
+00000bd0: 7570 5f69 643d 7365 6c66 2e5f 6964 0a20  up_id=self._id. 
+00000be0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00000bf0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00000c00: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00000c10: 5f76 616c 6964 6174 696f 6e5f 7265 706f  _validation_repo
+00000c20: 7274 5f65 6e67 696e 6520 3d20 280a 2020  rt_engine = (.  
+00000c30: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00000c40: 6c69 6461 7469 6f6e 5f72 6570 6f72 745f  lidation_report_
+00000c50: 656e 6769 6e65 2e56 616c 6964 6174 696f  engine.Validatio
+00000c60: 6e52 6570 6f72 7445 6e67 696e 6528 0a20  nReportEngine(. 
+00000c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000c80: 2020 2066 6561 7475 7265 7374 6f72 655f     featurestore_
+00000c90: 6964 2c20 7365 6c66 2e5f 6964 0a20 2020  id, self._id.   
+00000ca0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00000cb0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00000cc0: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
+00000cd0: 616c 6964 6174 696f 6e5f 7265 7375 6c74  alidation_result
+00000ce0: 5f65 6e67 696e 6520 3d20 280a 2020 2020  _engine = (.    
+00000cf0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+00000d00: 6461 7469 6f6e 5f72 6573 756c 745f 656e  dation_result_en
+00000d10: 6769 6e65 2e56 616c 6964 6174 696f 6e52  gine.ValidationR
+00000d20: 6573 756c 7445 6e67 696e 6528 0a20 2020  esultEngine(.   
+00000d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000d40: 2066 6561 7475 7265 7374 6f72 655f 6964   featurestore_id
+00000d50: 2c20 7365 6c66 2e5f 6964 0a20 2020 2020  , self._id.     
+00000d60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00000d70: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00000d80: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
+00000d90: 655f 7374 6f72 655f 6964 203d 2066 6561  e_store_id = fea
+00000da0: 7475 7265 7374 6f72 655f 6964 0a20 2020  turestore_id.   
+00000db0: 2020 2020 2073 656c 662e 5f76 6172 6961       self._varia
+00000dc0: 626c 655f 6170 6920 3d20 5661 7269 6162  ble_api = Variab
+00000dd0: 6c65 4170 6928 290a 2020 2020 2020 2020  leApi().        
+00000de0: 7365 6c66 2e5f 6665 6174 7572 655f 6772  self._feature_gr
+00000df0: 6f75 705f 656e 6769 6e65 203d 204e 6f6e  oup_engine = Non
+00000e00: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00000e10: 6d75 6c74 695f 7061 7274 5f69 6e73 6572  multi_part_inser
+00000e20: 7420 3d20 4661 6c73 650a 0a20 2020 2064  t = False..    d
+00000e30: 6566 2064 656c 6574 6528 7365 6c66 293a  ef delete(self):
+00000e40: 0a20 2020 2020 2020 2022 2222 4472 6f70  .        """Drop
+00000e50: 2074 6865 2065 6e74 6972 6520 6665 6174   the entire feat
+00000e60: 7572 6520 6772 6f75 7020 616c 6f6e 6720  ure group along 
+00000e70: 7769 7468 2069 7473 2066 6561 7475 7265  with its feature
+00000e80: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
+00000e90: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
+00000ea0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+00000eb0: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
+00000ec0: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
+00000ed0: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
+00000ee0: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
+00000ef0: 2e0a 0a20 2020 2020 2020 2020 2020 2023  ...            #
+00000f00: 2067 6574 2074 6865 2046 6561 7475 7265   get the Feature
+00000f10: 2047 726f 7570 2069 6e73 7461 6e63 650a   Group instance.
+00000f20: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
+00000f30: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
+00000f40: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
+00000f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000f60: 2020 2020 206e 616d 653d 2762 6974 636f       name='bitco
+00000f70: 696e 5f70 7269 6365 272c 0a20 2020 2020  in_price',.     
+00000f80: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00000f90: 6572 7369 6f6e 3d31 0a20 2020 2020 2020  ersion=1.       
+00000fa0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00000fb0: 2020 2020 2020 2020 2020 2020 2320 6465              # de
+00000fc0: 6c65 7465 2074 6865 2066 6561 7475 7265  lete the feature
+00000fd0: 2067 726f 7570 0a20 2020 2020 2020 2020   group.         
+00000fe0: 2020 2066 672e 6465 6c65 7465 2829 0a20     fg.delete(). 
+00000ff0: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+00001000: 2020 2020 2020 2020 2121 2120 6461 6e67          !!! dang
+00001010: 6572 2022 506f 7465 6e74 6961 6c6c 7920  er "Potentially 
+00001020: 6461 6e67 6572 6f75 7320 6f70 6572 6174  dangerous operat
+00001030: 696f 6e22 0a20 2020 2020 2020 2020 2020  ion".           
+00001040: 2054 6869 7320 6f70 6572 6174 696f 6e20   This operation 
+00001050: 6472 6f70 7320 616c 6c20 6d65 7461 6461  drops all metada
+00001060: 7461 2061 7373 6f63 6961 7465 6420 7769  ta associated wi
+00001070: 7468 202a 2a74 6869 7320 7665 7273 696f  th **this versio
+00001080: 6e2a 2a20 6f66 2074 6865 0a20 2020 2020  n** of the.     
+00001090: 2020 2020 2020 2066 6561 7475 7265 2067         feature g
+000010a0: 726f 7570 202a 2a61 6e64 2a2a 2061 6c6c  roup **and** all
+000010b0: 2074 6865 2066 6561 7475 7265 2064 6174   the feature dat
+000010c0: 6120 696e 206f 6666 6c69 6e65 2061 6e64  a in offline and
+000010d0: 206f 6e6c 696e 6520 7374 6f72 6167 650a   online storage.
+000010e0: 2020 2020 2020 2020 2020 2020 6173 736f              asso
+000010f0: 6369 6174 6564 2077 6974 6820 6974 2e0a  ciated with it..
+00001100: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
+00001110: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
+00001120: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+00001130: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
+00001140: 6f72 602e 0a20 2020 2020 2020 2022 2222  or`..        """
+00001150: 0a20 2020 2020 2020 2077 6172 6e69 6e67  .        warning
+00001160: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00001170: 2020 2020 2241 6c6c 206a 6f62 7320 6173      "All jobs as
+00001180: 736f 6369 6174 6564 2074 6f20 6665 6174  sociated to feat
+00001190: 7572 6520 6772 6f75 7020 607b 7d60 2c20  ure group `{}`, 
+000011a0: 7665 7273 696f 6e20 607b 7d60 2077 696c  version `{}` wil
+000011b0: 6c20 6265 2072 656d 6f76 6564 2e22 2e66  l be removed.".f
+000011c0: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+000011d0: 2020 2020 2020 2073 656c 662e 5f6e 616d         self._nam
+000011e0: 652c 2073 656c 662e 5f76 6572 7369 6f6e  e, self._version
+000011f0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00001200: 2020 2020 2020 2020 2020 2020 7574 696c              util
+00001210: 2e4a 6f62 5761 726e 696e 672c 0a20 2020  .JobWarning,.   
+00001220: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
+00001230: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
+00001240: 7570 5f65 6e67 696e 652e 6465 6c65 7465  up_engine.delete
+00001250: 2873 656c 6629 0a0a 2020 2020 6465 6620  (self)..    def 
+00001260: 7365 6c65 6374 5f61 6c6c 280a 2020 2020  select_all(.    
+00001270: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00001280: 2020 696e 636c 7564 655f 7072 696d 6172    include_primar
+00001290: 795f 6b65 793a 204f 7074 696f 6e61 6c5b  y_key: Optional[
+000012a0: 626f 6f6c 5d20 3d20 5472 7565 2c0a 2020  bool] = True,.  
+000012b0: 2020 2020 2020 696e 636c 7564 655f 6576        include_ev
+000012c0: 656e 745f 7469 6d65 3a20 4f70 7469 6f6e  ent_time: Option
+000012d0: 616c 5b62 6f6f 6c5d 203d 2054 7275 652c  al[bool] = True,
+000012e0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000012f0: 2222 2253 656c 6563 7420 616c 6c20 6665  """Select all fe
+00001300: 6174 7572 6573 2069 6e20 7468 6520 6665  atures in the fe
+00001310: 6174 7572 6520 6772 6f75 7020 616e 6420  ature group and 
+00001320: 7265 7475 726e 2061 2071 7565 7279 206f  return a query o
+00001330: 626a 6563 742e 0a0a 2020 2020 2020 2020  bject...        
+00001340: 5468 6520 7175 6572 7920 6361 6e20 6265  The query can be
+00001350: 2075 7365 6420 746f 2063 6f6e 7374 7275   used to constru
+00001360: 6374 206a 6f69 6e73 206f 6620 6665 6174  ct joins of feat
+00001370: 7572 6520 6772 6f75 7073 206f 7220 6372  ure groups or cr
+00001380: 6561 7465 2061 0a20 2020 2020 2020 2066  eate a.        f
+00001390: 6561 7475 7265 2076 6965 772e 0a0a 2020  eature view...  
+000013a0: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
+000013b0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+000013c0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+000013d0: 2020 2020 2320 636f 6e6e 6563 7420 746f      # connect to
+000013e0: 2074 6865 2046 6561 7475 7265 2053 746f   the Feature Sto
+000013f0: 7265 0a20 2020 2020 2020 2020 2020 2066  re.            f
+00001400: 7320 3d20 2e2e 2e0a 0a20 2020 2020 2020  s = .....       
+00001410: 2020 2020 2023 2067 6574 2074 6865 2046       # get the F
+00001420: 6561 7475 7265 2047 726f 7570 2069 6e73  eature Group ins
+00001430: 7461 6e63 6573 0a20 2020 2020 2020 2020  tances.         
+00001440: 2020 2066 6731 203d 2066 732e 6765 745f     fg1 = fs.get_
+00001450: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
+00001460: 655f 6772 6f75 7028 2e2e 2e29 0a20 2020  e_group(...).   
+00001470: 2020 2020 2020 2020 2066 6732 203d 2066           fg2 = f
+00001480: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+00001490: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+000014a0: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+000014b0: 2320 636f 6e73 7472 7563 7420 7468 6520  # construct the 
+000014c0: 7175 6572 790a 2020 2020 2020 2020 2020  query.          
+000014d0: 2020 7175 6572 7920 3d20 6667 312e 7365    query = fg1.se
+000014e0: 6c65 6374 5f61 6c6c 2829 2e6a 6f69 6e28  lect_all().join(
+000014f0: 6667 322e 7365 6c65 6374 5f61 6c6c 2829  fg2.select_all()
+00001500: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00001510: 2073 686f 7720 6669 7273 7420 3520 726f   show first 5 ro
+00001520: 7773 0a20 2020 2020 2020 2020 2020 2071  ws.            q
+00001530: 7565 7279 2e73 686f 7728 3529 0a0a 0a20  uery.show(5)... 
+00001540: 2020 2020 2020 2020 2020 2023 2073 656c             # sel
+00001550: 6563 7420 616c 6c20 6665 6174 7572 6573  ect all features
+00001560: 2065 7863 6c75 6465 2070 7269 6d61 7279   exclude primary
+00001570: 206b 6579 2061 6e64 2065 7665 6e74 2074   key and event t
+00001580: 696d 650a 2020 2020 2020 2020 2020 2020  ime.            
+00001590: 6672 6f6d 2068 7366 732e 6665 6174 7572  from hsfs.featur
+000015a0: 6520 696d 706f 7274 2046 6561 7475 7265  e import Feature
+000015b0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+000015c0: 3d20 6673 2e63 7265 6174 655f 6665 6174  = fs.create_feat
+000015d0: 7572 655f 6772 6f75 7028 0a20 2020 2020  ure_group(.     
+000015e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000015f0: 6667 222c 0a20 2020 2020 2020 2020 2020  fg",.           
+00001600: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00001610: 733d 5b0a 2020 2020 2020 2020 2020 2020  s=[.            
+00001620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001630: 4665 6174 7572 6528 2269 6422 2c20 7479  Feature("id", ty
+00001640: 7065 3d22 7374 7269 6e67 2229 2c0a 2020  pe="string"),.  
+00001650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001660: 2020 2020 2020 2020 2020 4665 6174 7572            Featur
+00001670: 6528 2274 7322 2c20 7479 7065 3d22 6269  e("ts", type="bi
+00001680: 6769 6e74 2229 2c0a 2020 2020 2020 2020  gint"),.        
+00001690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000016a0: 2020 2020 4665 6174 7572 6528 2266 3122      Feature("f1"
+000016b0: 2c20 7479 7065 3d22 6461 7465 2229 2c0a  , type="date"),.
+000016c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000016d0: 2020 2020 2020 2020 2020 2020 4665 6174              Feat
+000016e0: 7572 6528 2266 3222 2c20 7479 7065 3d22  ure("f2", type="
+000016f0: 646f 7562 6c65 2229 0a20 2020 2020 2020  double").       
 00001700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001710: 2020 2020 7072 696d 6172 795f 6b65 793d      primary_key=
-00001720: 5b22 6964 225d 2c0a 2020 2020 2020 2020  ["id"],.        
-00001730: 2020 2020 2020 2020 2020 2020 6576 656e              even
-00001740: 745f 7469 6d65 3d22 7473 2229 0a0a 2020  t_time="ts")..  
-00001750: 2020 2020 2020 2020 2020 7175 6572 7920            query 
-00001760: 3d20 6667 2e73 656c 6563 745f 616c 6c28  = fg.select_all(
-00001770: 290a 2020 2020 2020 2020 2020 2020 7175  ).            qu
-00001780: 6572 792e 6665 6174 7572 6573 0a20 2020  ery.features.   
-00001790: 2020 2020 2020 2020 2023 205b 4665 6174           # [Feat
-000017a0: 7572 6528 2769 6427 2c20 2e2e 2e29 2c20  ure('id', ...), 
-000017b0: 4665 6174 7572 6528 2774 7327 2c20 2e2e  Feature('ts', ..
-000017c0: 2e29 2c20 4665 6174 7572 6528 2766 3127  .), Feature('f1'
-000017d0: 2c20 2e2e 2e29 2c20 4665 6174 7572 6528  , ...), Feature(
-000017e0: 2766 3227 2c20 2e2e 2e29 5d0a 0a20 2020  'f2', ...)]..   
-000017f0: 2020 2020 2020 2020 2071 7565 7279 203d           query =
-00001800: 2066 672e 7365 6c65 6374 5f61 6c6c 2869   fg.select_all(i
-00001810: 6e63 6c75 6465 5f70 7269 6d61 7279 5f6b  nclude_primary_k
-00001820: 6579 3d46 616c 7365 2c20 696e 636c 7564  ey=False, includ
-00001830: 655f 6576 656e 745f 7469 6d65 3d46 616c  e_event_time=Fal
-00001840: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-00001850: 7175 6572 792e 6665 6174 7572 6573 0a20  query.features. 
-00001860: 2020 2020 2020 2020 2020 2023 205b 4665             # [Fe
-00001870: 6174 7572 6528 2766 3127 2c20 2e2e 2e29  ature('f1', ...)
-00001880: 2c20 4665 6174 7572 6528 2766 3227 2c20  , Feature('f2', 
-00001890: 2e2e 2e29 5d0a 2020 2020 2020 2020 2020  ...)].          
-000018a0: 2020 6060 600a 0a20 2020 2020 2020 2023    ```..        #
-000018b0: 2041 7267 756d 656e 7473 0a20 2020 2020   Arguments.     
-000018c0: 2020 2020 2020 2069 6e63 6c75 6465 5f70         include_p
-000018d0: 7269 6d61 7279 5f6b 6579 3a20 4966 2054  rimary_key: If T
-000018e0: 7275 652c 2069 6e63 6c75 6465 2070 7269  rue, include pri
-000018f0: 6d61 7279 206b 6579 206f 6620 7468 6520  mary key of the 
-00001900: 6665 6174 7572 6520 6772 6f75 700a 2020  feature group.  
-00001910: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00001920: 2074 6865 2066 6561 7475 7265 206c 6973   the feature lis
-00001930: 742e 2044 6566 6175 6c74 7320 746f 2054  t. Defaults to T
-00001940: 7275 652e 0a20 2020 2020 2020 2020 2020  rue..           
-00001950: 2069 6e63 6c75 6465 5f65 7665 6e74 5f74   include_event_t
-00001960: 696d 653a 2049 6620 5472 7565 2c20 696e  ime: If True, in
-00001970: 636c 7564 6520 6576 656e 7420 7469 6d65  clude event time
-00001980: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00001990: 6772 6f75 700a 2020 2020 2020 2020 2020  group.          
-000019a0: 2020 2020 2020 746f 2074 6865 2066 6561        to the fea
-000019b0: 7475 7265 206c 6973 742e 2044 6566 6175  ture list. Defau
-000019c0: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
-000019d0: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
-000019e0: 2020 2020 2020 2020 2020 2060 5175 6572             `Quer
-000019f0: 7960 2e20 4120 7175 6572 7920 6f62 6a65  y`. A query obje
-00001a00: 6374 2077 6974 6820 616c 6c20 6665 6174  ct with all feat
-00001a10: 7572 6573 206f 6620 7468 6520 6665 6174  ures of the feat
-00001a20: 7572 6520 6772 6f75 702e 0a20 2020 2020  ure group..     
-00001a30: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00001a40: 6620 696e 636c 7564 655f 6576 656e 745f  f include_event_
-00001a50: 7469 6d65 2061 6e64 2069 6e63 6c75 6465  time and include
-00001a60: 5f70 7269 6d61 7279 5f6b 6579 3a0a 2020  _primary_key:.  
-00001a70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001a80: 2071 7565 7279 2e51 7565 7279 280a 2020   query.Query(.  
-00001a90: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00001aa0: 6674 5f66 6561 7475 7265 5f67 726f 7570  ft_feature_group
-00001ab0: 3d73 656c 662c 0a20 2020 2020 2020 2020  =self,.         
-00001ac0: 2020 2020 2020 206c 6566 745f 6665 6174         left_feat
-00001ad0: 7572 6573 3d73 656c 662e 5f66 6561 7475  ures=self._featu
-00001ae0: 7265 732c 0a20 2020 2020 2020 2020 2020  res,.           
-00001af0: 2020 2020 2066 6561 7475 7265 5f73 746f       feature_sto
-00001b00: 7265 5f6e 616d 653d 7365 6c66 2e5f 6665  re_name=self._fe
-00001b10: 6174 7572 655f 7374 6f72 655f 6e61 6d65  ature_store_name
-00001b20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00001b30: 2020 6665 6174 7572 655f 7374 6f72 655f    feature_store_
-00001b40: 6964 3d73 656c 662e 5f66 6561 7475 7265  id=self._feature
-00001b50: 5f73 746f 7265 5f69 642c 0a20 2020 2020  _store_id,.     
-00001b60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00001b70: 2065 6c69 6620 696e 636c 7564 655f 6576   elif include_ev
-00001b80: 656e 745f 7469 6d65 3a0a 2020 2020 2020  ent_time:.      
-00001b90: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00001ba0: 662e 7365 6c65 6374 5f65 7863 6570 7428  f.select_except(
-00001bb0: 7365 6c66 2e70 7269 6d61 7279 5f6b 6579  self.primary_key
-00001bc0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00001bd0: 6e63 6c75 6465 5f70 7269 6d61 7279 5f6b  nclude_primary_k
-00001be0: 6579 3a0a 2020 2020 2020 2020 2020 2020  ey:.            
-00001bf0: 7265 7475 726e 2073 656c 662e 7365 6c65  return self.sele
-00001c00: 6374 5f65 7863 6570 7428 5b73 656c 662e  ct_except([self.
-00001c10: 6576 656e 745f 7469 6d65 5d29 0a20 2020  event_time]).   
-00001c20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00001c30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00001c40: 6c66 2e73 656c 6563 745f 6578 6365 7074  lf.select_except
-00001c50: 2873 656c 662e 7072 696d 6172 795f 6b65  (self.primary_ke
-00001c60: 7920 2b20 5b73 656c 662e 6576 656e 745f  y + [self.event_
-00001c70: 7469 6d65 5d29 0a0a 2020 2020 6465 6620  time])..    def 
-00001c80: 7365 6c65 6374 2873 656c 662c 2066 6561  select(self, fea
-00001c90: 7475 7265 733a 204f 7074 696f 6e61 6c5b  tures: Optional[
-00001ca0: 4c69 7374 5b55 6e69 6f6e 5b73 7472 2c20  List[Union[str, 
-00001cb0: 6665 6174 7572 652e 4665 6174 7572 655d  feature.Feature]
-00001cc0: 5d5d 203d 205b 5d29 3a0a 2020 2020 2020  ]] = []):.      
-00001cd0: 2020 2222 2253 656c 6563 7420 6120 7375    """Select a su
-00001ce0: 6273 6574 206f 6620 6665 6174 7572 6573  bset of features
-00001cf0: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00001d00: 6772 6f75 7020 616e 6420 7265 7475 726e  group and return
-00001d10: 2061 2071 7565 7279 206f 626a 6563 742e   a query object.
-00001d20: 0a0a 2020 2020 2020 2020 5468 6520 7175  ..        The qu
-00001d30: 6572 7920 6361 6e20 6265 2075 7365 6420  ery can be used 
-00001d40: 746f 2063 6f6e 7374 7275 6374 206a 6f69  to construct joi
-00001d50: 6e73 206f 6620 6665 6174 7572 6520 6772  ns of feature gr
-00001d60: 6f75 7073 206f 7220 6372 6561 7465 2061  oups or create a
-00001d70: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00001d80: 2076 6965 7720 7769 7468 2061 2073 7562   view with a sub
-00001d90: 7365 7420 6f66 2066 6561 7475 7265 7320  set of features 
-00001da0: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-00001db0: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
-00001dc0: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
-00001dd0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-00001de0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00001df0: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-00001e00: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-00001e10: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-00001e20: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00001e30: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
-00001e40: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
-00001e50: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00001e60: 6873 6673 2e66 6561 7475 7265 2069 6d70  hsfs.feature imp
-00001e70: 6f72 7420 4665 6174 7572 650a 2020 2020  ort Feature.    
-00001e80: 2020 2020 2020 2020 6667 203d 2066 732e          fg = fs.
-00001e90: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-00001ea0: 726f 7570 280a 2020 2020 2020 2020 2020  roup(.          
-00001eb0: 2020 2020 2020 2020 2020 2266 6722 2c0a            "fg",.
+00001710: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+00001720: 2020 2020 2020 2020 2020 2020 7072 696d              prim
+00001730: 6172 795f 6b65 793d 5b22 6964 225d 2c0a  ary_key=["id"],.
+00001740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001750: 2020 2020 6576 656e 745f 7469 6d65 3d22      event_time="
+00001760: 7473 2229 0a0a 2020 2020 2020 2020 2020  ts")..          
+00001770: 2020 7175 6572 7920 3d20 6667 2e73 656c    query = fg.sel
+00001780: 6563 745f 616c 6c28 290a 2020 2020 2020  ect_all().      
+00001790: 2020 2020 2020 7175 6572 792e 6665 6174        query.feat
+000017a0: 7572 6573 0a20 2020 2020 2020 2020 2020  ures.           
+000017b0: 2023 205b 4665 6174 7572 6528 2769 6427   # [Feature('id'
+000017c0: 2c20 2e2e 2e29 2c20 4665 6174 7572 6528  , ...), Feature(
+000017d0: 2774 7327 2c20 2e2e 2e29 2c20 4665 6174  'ts', ...), Feat
+000017e0: 7572 6528 2766 3127 2c20 2e2e 2e29 2c20  ure('f1', ...), 
+000017f0: 4665 6174 7572 6528 2766 3227 2c20 2e2e  Feature('f2', ..
+00001800: 2e29 5d0a 0a20 2020 2020 2020 2020 2020  .)]..           
+00001810: 2071 7565 7279 203d 2066 672e 7365 6c65   query = fg.sele
+00001820: 6374 5f61 6c6c 2869 6e63 6c75 6465 5f70  ct_all(include_p
+00001830: 7269 6d61 7279 5f6b 6579 3d46 616c 7365  rimary_key=False
+00001840: 2c20 696e 636c 7564 655f 6576 656e 745f  , include_event_
+00001850: 7469 6d65 3d46 616c 7365 290a 2020 2020  time=False).    
+00001860: 2020 2020 2020 2020 7175 6572 792e 6665          query.fe
+00001870: 6174 7572 6573 0a20 2020 2020 2020 2020  atures.         
+00001880: 2020 2023 205b 4665 6174 7572 6528 2766     # [Feature('f
+00001890: 3127 2c20 2e2e 2e29 2c20 4665 6174 7572  1', ...), Featur
+000018a0: 6528 2766 3227 2c20 2e2e 2e29 5d0a 2020  e('f2', ...)].  
+000018b0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
+000018c0: 2020 2020 2020 2023 2041 7267 756d 656e         # Argumen
+000018d0: 7473 0a20 2020 2020 2020 2020 2020 2069  ts.            i
+000018e0: 6e63 6c75 6465 5f70 7269 6d61 7279 5f6b  nclude_primary_k
+000018f0: 6579 3a20 4966 2054 7275 652c 2069 6e63  ey: If True, inc
+00001900: 6c75 6465 2070 7269 6d61 7279 206b 6579  lude primary key
+00001910: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+00001920: 6772 6f75 700a 2020 2020 2020 2020 2020  group.          
+00001930: 2020 2020 2020 746f 2074 6865 2066 6561        to the fea
+00001940: 7475 7265 206c 6973 742e 2044 6566 6175  ture list. Defau
+00001950: 6c74 7320 746f 2054 7275 652e 0a20 2020  lts to True..   
+00001960: 2020 2020 2020 2020 2069 6e63 6c75 6465           include
+00001970: 5f65 7665 6e74 5f74 696d 653a 2049 6620  _event_time: If 
+00001980: 5472 7565 2c20 696e 636c 7564 6520 6576  True, include ev
+00001990: 656e 7420 7469 6d65 206f 6620 7468 6520  ent time of the 
+000019a0: 6665 6174 7572 6520 6772 6f75 700a 2020  feature group.  
+000019b0: 2020 2020 2020 2020 2020 2020 2020 746f                to
+000019c0: 2074 6865 2066 6561 7475 7265 206c 6973   the feature lis
+000019d0: 742e 2044 6566 6175 6c74 7320 746f 2054  t. Defaults to T
+000019e0: 7275 652e 0a20 2020 2020 2020 2023 2052  rue..        # R
+000019f0: 6574 7572 6e73 0a20 2020 2020 2020 2020  eturns.         
+00001a00: 2020 2060 5175 6572 7960 2e20 4120 7175     `Query`. A qu
+00001a10: 6572 7920 6f62 6a65 6374 2077 6974 6820  ery object with 
+00001a20: 616c 6c20 6665 6174 7572 6573 206f 6620  all features of 
+00001a30: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+00001a40: 702e 0a20 2020 2020 2020 2022 2222 0a20  p..        """. 
+00001a50: 2020 2020 2020 2069 6620 696e 636c 7564         if includ
+00001a60: 655f 6576 656e 745f 7469 6d65 2061 6e64  e_event_time and
+00001a70: 2069 6e63 6c75 6465 5f70 7269 6d61 7279   include_primary
+00001a80: 5f6b 6579 3a0a 2020 2020 2020 2020 2020  _key:.          
+00001a90: 2020 7265 7475 726e 2071 7565 7279 2e51    return query.Q
+00001aa0: 7565 7279 280a 2020 2020 2020 2020 2020  uery(.          
+00001ab0: 2020 2020 2020 6c65 6674 5f66 6561 7475        left_featu
+00001ac0: 7265 5f67 726f 7570 3d73 656c 662c 0a20  re_group=self,. 
+00001ad0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00001ae0: 6566 745f 6665 6174 7572 6573 3d73 656c  eft_features=sel
+00001af0: 662e 5f66 6561 7475 7265 732c 0a20 2020  f._features,.   
+00001b00: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00001b10: 7475 7265 5f73 746f 7265 5f6e 616d 653d  ture_store_name=
+00001b20: 7365 6c66 2e5f 6665 6174 7572 655f 7374  self._feature_st
+00001b30: 6f72 655f 6e61 6d65 2c0a 2020 2020 2020  ore_name,.      
+00001b40: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00001b50: 655f 7374 6f72 655f 6964 3d73 656c 662e  e_store_id=self.
+00001b60: 5f66 6561 7475 7265 5f73 746f 7265 5f69  _feature_store_i
+00001b70: 642c 0a20 2020 2020 2020 2020 2020 2029  d,.            )
+00001b80: 0a20 2020 2020 2020 2065 6c69 6620 696e  .        elif in
+00001b90: 636c 7564 655f 6576 656e 745f 7469 6d65  clude_event_time
+00001ba0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00001bb0: 7475 726e 2073 656c 662e 7365 6c65 6374  turn self.select
+00001bc0: 5f65 7863 6570 7428 7365 6c66 2e70 7269  _except(self.pri
+00001bd0: 6d61 7279 5f6b 6579 290a 2020 2020 2020  mary_key).      
+00001be0: 2020 656c 6966 2069 6e63 6c75 6465 5f70    elif include_p
+00001bf0: 7269 6d61 7279 5f6b 6579 3a0a 2020 2020  rimary_key:.    
+00001c00: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00001c10: 656c 662e 7365 6c65 6374 5f65 7863 6570  elf.select_excep
+00001c20: 7428 5b73 656c 662e 6576 656e 745f 7469  t([self.event_ti
+00001c30: 6d65 5d29 0a20 2020 2020 2020 2065 6c73  me]).        els
+00001c40: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00001c50: 6574 7572 6e20 7365 6c66 2e73 656c 6563  eturn self.selec
+00001c60: 745f 6578 6365 7074 2873 656c 662e 7072  t_except(self.pr
+00001c70: 696d 6172 795f 6b65 7920 2b20 5b73 656c  imary_key + [sel
+00001c80: 662e 6576 656e 745f 7469 6d65 5d29 0a0a  f.event_time])..
+00001c90: 2020 2020 6465 6620 7365 6c65 6374 2873      def select(s
+00001ca0: 656c 662c 2066 6561 7475 7265 733a 204f  elf, features: O
+00001cb0: 7074 696f 6e61 6c5b 4c69 7374 5b55 6e69  ptional[List[Uni
+00001cc0: 6f6e 5b73 7472 2c20 6665 6174 7572 652e  on[str, feature.
+00001cd0: 4665 6174 7572 655d 5d5d 203d 205b 5d29  Feature]]] = [])
+00001ce0: 3a0a 2020 2020 2020 2020 2222 2253 656c  :.        """Sel
+00001cf0: 6563 7420 6120 7375 6273 6574 206f 6620  ect a subset of 
+00001d00: 6665 6174 7572 6573 206f 6620 7468 6520  features of the 
+00001d10: 6665 6174 7572 6520 6772 6f75 7020 616e  feature group an
+00001d20: 6420 7265 7475 726e 2061 2071 7565 7279  d return a query
+00001d30: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
+00001d40: 2020 5468 6520 7175 6572 7920 6361 6e20    The query can 
+00001d50: 6265 2075 7365 6420 746f 2063 6f6e 7374  be used to const
+00001d60: 7275 6374 206a 6f69 6e73 206f 6620 6665  ruct joins of fe
+00001d70: 6174 7572 6520 6772 6f75 7073 206f 7220  ature groups or 
+00001d80: 6372 6561 7465 2061 0a20 2020 2020 2020  create a.       
+00001d90: 2066 6561 7475 7265 2076 6965 7720 7769   feature view wi
+00001da0: 7468 2061 2073 7562 7365 7420 6f66 2066  th a subset of f
+00001db0: 6561 7475 7265 7320 6f66 2074 6865 2066  eatures of the f
+00001dc0: 6561 7475 7265 2067 726f 7570 2e0a 0a20  eature group... 
+00001dd0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00001de0: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
+00001df0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+00001e00: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
+00001e10: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
+00001e20: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+00001e30: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
+00001e40: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
+00001e50: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
+00001e60: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+00001e70: 2020 2066 726f 6d20 6873 6673 2e66 6561     from hsfs.fea
+00001e80: 7475 7265 2069 6d70 6f72 7420 4665 6174  ture import Feat
+00001e90: 7572 650a 2020 2020 2020 2020 2020 2020  ure.            
+00001ea0: 6667 203d 2066 732e 6372 6561 7465 5f66  fg = fs.create_f
+00001eb0: 6561 7475 7265 5f67 726f 7570 280a 2020  eature_group(.  
 00001ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ed0: 2020 2020 6665 6174 7572 6573 3d5b 0a20      features=[. 
-00001ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001ef0: 2020 2020 2020 2020 2020 2046 6561 7475             Featu
-00001f00: 7265 2822 6964 222c 2074 7970 653d 2273  re("id", type="s
-00001f10: 7472 696e 6722 292c 0a20 2020 2020 2020  tring"),.       
-00001f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001f30: 2020 2020 2046 6561 7475 7265 2822 7473       Feature("ts
-00001f40: 222c 2074 7970 653d 2262 6967 696e 7422  ", type="bigint"
-00001f50: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00001f60: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-00001f70: 6561 7475 7265 2822 6631 222c 2074 7970  eature("f1", typ
-00001f80: 653d 2264 6174 6522 292c 0a20 2020 2020  e="date"),.     
-00001f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fa0: 2020 2020 2020 2046 6561 7475 7265 2822         Feature("
-00001fb0: 6632 222c 2074 7970 653d 2264 6f75 626c  f2", type="doubl
-00001fc0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00001fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001fe0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00001ff0: 2020 2020 2020 2070 7269 6d61 7279 5f6b         primary_k
-00002000: 6579 3d5b 2269 6422 5d2c 0a20 2020 2020  ey=["id"],.     
-00002010: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00002020: 7665 6e74 5f74 696d 653d 2274 7322 290a  vent_time="ts").
-00002030: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00002040: 6f6e 7374 7275 6374 2071 7565 7279 0a20  onstruct query. 
-00002050: 2020 2020 2020 2020 2020 2071 7565 7279             query
-00002060: 203d 2066 672e 7365 6c65 6374 285b 2269   = fg.select(["i
-00002070: 6422 2c20 2266 3122 5d29 0a20 2020 2020  d", "f1"]).     
-00002080: 2020 2020 2020 2071 7565 7279 2e66 6561         query.fea
-00002090: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
-000020a0: 2020 2320 5b46 6561 7475 7265 2827 6964    # [Feature('id
-000020b0: 272c 202e 2e2e 292c 2046 6561 7475 7265  ', ...), Feature
-000020c0: 2827 6631 272c 202e 2e2e 295d 0a20 2020  ('f1', ...)].   
-000020d0: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
-000020e0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
-000020f0: 730a 2020 2020 2020 2020 2020 2020 6665  s.            fe
-00002100: 6174 7572 6573 3a20 4120 6c69 7374 206f  atures: A list o
-00002110: 6620 6046 6561 7475 7265 6020 6f62 6a65  f `Feature` obje
-00002120: 6374 7320 6f72 2066 6561 7475 7265 206e  cts or feature n
-00002130: 616d 6573 2061 730a 2020 2020 2020 2020  ames as.        
-00002140: 2020 2020 2020 2020 7374 7269 6e67 7320          strings 
-00002150: 746f 2062 6520 7365 6c65 6374 6564 2c20  to be selected, 
-00002160: 6465 6661 756c 7473 2074 6f20 5b5d 2e0a  defaults to []..
-00002170: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-00002180: 6e73 0a20 2020 2020 2020 2020 2020 2060  ns.            `
-00002190: 5175 6572 7960 3a20 4120 7175 6572 7920  Query`: A query 
-000021a0: 6f62 6a65 6374 2077 6974 6820 7468 6520  object with the 
-000021b0: 7365 6c65 6374 6564 2066 6561 7475 7265  selected feature
-000021c0: 7320 6f66 2074 6865 2066 6561 7475 7265  s of the feature
-000021d0: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
-000021e0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000021f0: 726e 2071 7565 7279 2e51 7565 7279 280a  rn query.Query(.
-00002200: 2020 2020 2020 2020 2020 2020 6c65 6674              left
-00002210: 5f66 6561 7475 7265 5f67 726f 7570 3d73  _feature_group=s
-00002220: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
-00002230: 206c 6566 745f 6665 6174 7572 6573 3d66   left_features=f
-00002240: 6561 7475 7265 732c 0a20 2020 2020 2020  eatures,.       
-00002250: 2020 2020 2066 6561 7475 7265 5f73 746f       feature_sto
-00002260: 7265 5f6e 616d 653d 7365 6c66 2e5f 6665  re_name=self._fe
-00002270: 6174 7572 655f 7374 6f72 655f 6e61 6d65  ature_store_name
-00002280: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-00002290: 6174 7572 655f 7374 6f72 655f 6964 3d73  ature_store_id=s
-000022a0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-000022b0: 7265 5f69 642c 0a20 2020 2020 2020 2029  re_id,.        )
-000022c0: 0a0a 2020 2020 6465 6620 7365 6c65 6374  ..    def select
-000022d0: 5f65 7863 6570 7428 7365 6c66 2c20 6665  _except(self, fe
-000022e0: 6174 7572 6573 3a20 4f70 7469 6f6e 616c  atures: Optional
-000022f0: 5b4c 6973 745b 556e 696f 6e5b 7374 722c  [List[Union[str,
-00002300: 2066 6561 7475 7265 2e46 6561 7475 7265   feature.Feature
-00002310: 5d5d 5d20 3d20 5b5d 293a 0a20 2020 2020  ]]] = []):.     
-00002320: 2020 2022 2222 5365 6c65 6374 2061 6c6c     """Select all
-00002330: 2066 6561 7475 7265 7320 696e 636c 7564   features includ
-00002340: 696e 6720 7072 696d 6172 7920 6b65 7920  ing primary key 
-00002350: 616e 6420 6576 656e 7420 7469 6d65 2066  and event time f
-00002360: 6561 7475 7265 0a20 2020 2020 2020 206f  eature.        o
-00002370: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
-00002380: 6f75 7020 6578 6365 7074 2070 726f 7669  oup except provi
-00002390: 6465 6420 6066 6561 7475 7265 7360 2061  ded `features` a
-000023a0: 6e64 2072 6574 7572 6e20 6120 7175 6572  nd return a quer
-000023b0: 7920 6f62 6a65 6374 2e0a 0a20 2020 2020  y object...     
-000023c0: 2020 2054 6865 2071 7565 7279 2063 616e     The query can
-000023d0: 2062 6520 7573 6564 2074 6f20 636f 6e73   be used to cons
-000023e0: 7472 7563 7420 6a6f 696e 7320 6f66 2066  truct joins of f
-000023f0: 6561 7475 7265 2067 726f 7570 7320 6f72  eature groups or
-00002400: 2063 7265 6174 6520 610a 2020 2020 2020   create a.      
-00002410: 2020 6665 6174 7572 6520 7669 6577 2077    feature view w
-00002420: 6974 6820 6120 7375 6273 6574 206f 6620  ith a subset of 
-00002430: 6665 6174 7572 6573 206f 6620 7468 6520  features of the 
-00002440: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
-00002450: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
-00002460: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
-00002470: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-00002480: 2020 2020 2020 2320 636f 6e6e 6563 7420        # connect 
-00002490: 746f 2074 6865 2046 6561 7475 7265 2053  to the Feature S
-000024a0: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
-000024b0: 2066 7320 3d20 2e2e 2e0a 0a20 2020 2020   fs = .....     
-000024c0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
-000024d0: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
-000024e0: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
-000024f0: 2020 2020 6672 6f6d 2068 7366 732e 6665      from hsfs.fe
-00002500: 6174 7572 6520 696d 706f 7274 2046 6561  ature import Fea
-00002510: 7475 7265 0a20 2020 2020 2020 2020 2020  ture.           
-00002520: 2066 6720 3d20 6673 2e63 7265 6174 655f   fg = fs.create_
-00002530: 6665 6174 7572 655f 6772 6f75 7028 0a20  feature_group(. 
-00002540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002550: 2020 2022 6667 222c 0a20 2020 2020 2020     "fg",.       
-00002560: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00002570: 7475 7265 733d 5b0a 2020 2020 2020 2020  tures=[.        
-00002580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002590: 2020 2020 4665 6174 7572 6528 2269 6422      Feature("id"
-000025a0: 2c20 7479 7065 3d22 7374 7269 6e67 2229  , type="string")
-000025b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000025c0: 2020 2020 2020 2020 2020 2020 2020 4665                Fe
-000025d0: 6174 7572 6528 2274 7322 2c20 7479 7065  ature("ts", type
-000025e0: 3d22 6269 6769 6e74 2229 2c0a 2020 2020  ="bigint"),.    
-000025f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002600: 2020 2020 2020 2020 4665 6174 7572 6528          Feature(
-00002610: 2266 3122 2c20 7479 7065 3d22 6461 7465  "f1", type="date
-00002620: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
-00002630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002640: 4665 6174 7572 6528 2266 3222 2c20 7479  Feature("f2", ty
-00002650: 7065 3d22 646f 7562 6c65 2229 0a20 2020  pe="double").   
-00002660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002670: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
+00001ed0: 2020 2266 6722 2c0a 2020 2020 2020 2020    "fg",.        
+00001ee0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00001ef0: 7572 6573 3d5b 0a20 2020 2020 2020 2020  ures=[.         
+00001f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f10: 2020 2046 6561 7475 7265 2822 6964 222c     Feature("id",
+00001f20: 2074 7970 653d 2273 7472 696e 6722 292c   type="string"),
+00001f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001f40: 2020 2020 2020 2020 2020 2020 2046 6561               Fea
+00001f50: 7475 7265 2822 7473 222c 2074 7970 653d  ture("ts", type=
+00001f60: 2262 6967 696e 7422 292c 0a20 2020 2020  "bigint"),.     
+00001f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f80: 2020 2020 2020 2046 6561 7475 7265 2822         Feature("
+00001f90: 6631 222c 2074 7970 653d 2264 6174 6522  f1", type="date"
+00001fa0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00001fb0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+00001fc0: 6561 7475 7265 2822 6632 222c 2074 7970  eature("f2", typ
+00001fd0: 653d 2264 6f75 626c 6522 290a 2020 2020  e="double").    
+00001fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001ff0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+00002000: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00002010: 7269 6d61 7279 5f6b 6579 3d5b 2269 6422  rimary_key=["id"
+00002020: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00002030: 2020 2020 2020 2065 7665 6e74 5f74 696d         event_tim
+00002040: 653d 2274 7322 290a 0a20 2020 2020 2020  e="ts")..       
+00002050: 2020 2020 2023 2063 6f6e 7374 7275 6374       # construct
+00002060: 2071 7565 7279 0a20 2020 2020 2020 2020   query.         
+00002070: 2020 2071 7565 7279 203d 2066 672e 7365     query = fg.se
+00002080: 6c65 6374 285b 2269 6422 2c20 2266 3122  lect(["id", "f1"
+00002090: 5d29 0a20 2020 2020 2020 2020 2020 2071  ]).            q
+000020a0: 7565 7279 2e66 6561 7475 7265 730a 2020  uery.features.  
+000020b0: 2020 2020 2020 2020 2020 2320 5b46 6561            # [Fea
+000020c0: 7475 7265 2827 6964 272c 202e 2e2e 292c  ture('id', ...),
+000020d0: 2046 6561 7475 7265 2827 6631 272c 202e   Feature('f1', .
+000020e0: 2e2e 295d 0a20 2020 2020 2020 2020 2020  ..)].           
+000020f0: 2060 6060 0a0a 2020 2020 2020 2020 2320   ```..        # 
+00002100: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
+00002110: 2020 2020 2020 6665 6174 7572 6573 3a20        features: 
+00002120: 4120 6c69 7374 206f 6620 6046 6561 7475  A list of `Featu
+00002130: 7265 6020 6f62 6a65 6374 7320 6f72 2066  re` objects or f
+00002140: 6561 7475 7265 206e 616d 6573 2061 730a  eature names as.
+00002150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002160: 7374 7269 6e67 7320 746f 2062 6520 7365  strings to be se
+00002170: 6c65 6374 6564 2c20 6465 6661 756c 7473  lected, defaults
+00002180: 2074 6f20 5b5d 2e0a 0a20 2020 2020 2020   to []...       
+00002190: 2023 2052 6574 7572 6e73 0a20 2020 2020   # Returns.     
+000021a0: 2020 2020 2020 2060 5175 6572 7960 3a20         `Query`: 
+000021b0: 4120 7175 6572 7920 6f62 6a65 6374 2077  A query object w
+000021c0: 6974 6820 7468 6520 7365 6c65 6374 6564  ith the selected
+000021d0: 2066 6561 7475 7265 7320 6f66 2074 6865   features of the
+000021e0: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
+000021f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00002200: 2020 2020 7265 7475 726e 2071 7565 7279      return query
+00002210: 2e51 7565 7279 280a 2020 2020 2020 2020  .Query(.        
+00002220: 2020 2020 6c65 6674 5f66 6561 7475 7265      left_feature
+00002230: 5f67 726f 7570 3d73 656c 662c 0a20 2020  _group=self,.   
+00002240: 2020 2020 2020 2020 206c 6566 745f 6665           left_fe
+00002250: 6174 7572 6573 3d66 6561 7475 7265 732c  atures=features,
+00002260: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+00002270: 7475 7265 5f73 746f 7265 5f6e 616d 653d  ture_store_name=
+00002280: 7365 6c66 2e5f 6665 6174 7572 655f 7374  self._feature_st
+00002290: 6f72 655f 6e61 6d65 2c0a 2020 2020 2020  ore_name,.      
+000022a0: 2020 2020 2020 6665 6174 7572 655f 7374        feature_st
+000022b0: 6f72 655f 6964 3d73 656c 662e 5f66 6561  ore_id=self._fea
+000022c0: 7475 7265 5f73 746f 7265 5f69 642c 0a20  ture_store_id,. 
+000022d0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+000022e0: 6620 7365 6c65 6374 5f65 7863 6570 7428  f select_except(
+000022f0: 7365 6c66 2c20 6665 6174 7572 6573 3a20  self, features: 
+00002300: 4f70 7469 6f6e 616c 5b4c 6973 745b 556e  Optional[List[Un
+00002310: 696f 6e5b 7374 722c 2066 6561 7475 7265  ion[str, feature
+00002320: 2e46 6561 7475 7265 5d5d 5d20 3d20 5b5d  .Feature]]] = []
+00002330: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
+00002340: 6c65 6374 2061 6c6c 2066 6561 7475 7265  lect all feature
+00002350: 7320 696e 636c 7564 696e 6720 7072 696d  s including prim
+00002360: 6172 7920 6b65 7920 616e 6420 6576 656e  ary key and even
+00002370: 7420 7469 6d65 2066 6561 7475 7265 0a20  t time feature. 
+00002380: 2020 2020 2020 206f 6620 7468 6520 6665         of the fe
+00002390: 6174 7572 6520 6772 6f75 7020 6578 6365  ature group exce
+000023a0: 7074 2070 726f 7669 6465 6420 6066 6561  pt provided `fea
+000023b0: 7475 7265 7360 2061 6e64 2072 6574 7572  tures` and retur
+000023c0: 6e20 6120 7175 6572 7920 6f62 6a65 6374  n a query object
+000023d0: 2e0a 0a20 2020 2020 2020 2054 6865 2071  ...        The q
+000023e0: 7565 7279 2063 616e 2062 6520 7573 6564  uery can be used
+000023f0: 2074 6f20 636f 6e73 7472 7563 7420 6a6f   to construct jo
+00002400: 696e 7320 6f66 2066 6561 7475 7265 2067  ins of feature g
+00002410: 726f 7570 7320 6f72 2063 7265 6174 6520  roups or create 
+00002420: 610a 2020 2020 2020 2020 6665 6174 7572  a.        featur
+00002430: 6520 7669 6577 2077 6974 6820 6120 7375  e view with a su
+00002440: 6273 6574 206f 6620 6665 6174 7572 6573  bset of features
+00002450: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+00002460: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+00002470: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
+00002480: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+00002490: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
+000024a0: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
+000024b0: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
+000024c0: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
+000024d0: 2e0a 0a20 2020 2020 2020 2020 2020 2023  ...            #
+000024e0: 2067 6574 2074 6865 2046 6561 7475 7265   get the Feature
+000024f0: 2047 726f 7570 2069 6e73 7461 6e63 650a   Group instance.
+00002500: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00002510: 2068 7366 732e 6665 6174 7572 6520 696d   hsfs.feature im
+00002520: 706f 7274 2046 6561 7475 7265 0a20 2020  port Feature.   
+00002530: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
+00002540: 2e63 7265 6174 655f 6665 6174 7572 655f  .create_feature_
+00002550: 6772 6f75 7028 0a20 2020 2020 2020 2020  group(.         
+00002560: 2020 2020 2020 2020 2020 2022 6667 222c             "fg",
+00002570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002580: 2020 2020 2066 6561 7475 7265 733d 5b0a       features=[.
+00002590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000025a0: 2020 2020 2020 2020 2020 2020 4665 6174              Feat
+000025b0: 7572 6528 2269 6422 2c20 7479 7065 3d22  ure("id", type="
+000025c0: 7374 7269 6e67 2229 2c0a 2020 2020 2020  string"),.      
+000025d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000025e0: 2020 2020 2020 4665 6174 7572 6528 2274        Feature("t
+000025f0: 7322 2c20 7479 7065 3d22 6269 6769 6e74  s", type="bigint
+00002600: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00002610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002620: 4665 6174 7572 6528 2266 3122 2c20 7479  Feature("f1", ty
+00002630: 7065 3d22 6461 7465 2229 2c0a 2020 2020  pe="date"),.    
+00002640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002650: 2020 2020 2020 2020 4665 6174 7572 6528          Feature(
+00002660: 2266 3222 2c20 7479 7065 3d22 646f 7562  "f2", type="doub
+00002670: 6c65 2229 0a20 2020 2020 2020 2020 2020  le").           
 00002680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002690: 7072 696d 6172 795f 6b65 793d 5b22 6964  primary_key=["id
-000026a0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-000026b0: 2020 2020 2020 2020 6576 656e 745f 7469          event_ti
-000026c0: 6d65 3d22 7473 2229 0a0a 2020 2020 2020  me="ts")..      
-000026d0: 2020 2020 2020 2320 636f 6e73 7472 7563        # construc
-000026e0: 7420 7175 6572 790a 2020 2020 2020 2020  t query.        
-000026f0: 2020 2020 7175 6572 7920 3d20 6667 2e73      query = fg.s
-00002700: 656c 6563 745f 6578 6365 7074 285b 2274  elect_except(["t
-00002710: 7322 2c20 2266 3122 5d29 0a20 2020 2020  s", "f1"]).     
-00002720: 2020 2020 2020 2071 7565 7279 2e66 6561         query.fea
-00002730: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
-00002740: 2020 2320 5b46 6561 7475 7265 2827 6964    # [Feature('id
-00002750: 272c 202e 2e2e 292c 2046 6561 7475 7265  ', ...), Feature
-00002760: 2827 6631 272c 202e 2e2e 295d 0a20 2020  ('f1', ...)].   
-00002770: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
-00002780: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
-00002790: 730a 2020 2020 2020 2020 2020 2020 6665  s.            fe
-000027a0: 6174 7572 6573 3a20 4120 6c69 7374 206f  atures: A list o
-000027b0: 6620 6046 6561 7475 7265 6020 6f62 6a65  f `Feature` obje
-000027c0: 6374 7320 6f72 2066 6561 7475 7265 206e  cts or feature n
-000027d0: 616d 6573 2061 730a 2020 2020 2020 2020  ames as.        
-000027e0: 2020 2020 2020 2020 7374 7269 6e67 7320          strings 
-000027f0: 746f 2062 6520 6578 636c 7564 6564 2066  to be excluded f
-00002800: 726f 6d20 7468 6520 7365 6c65 6374 696f  rom the selectio
-00002810: 6e2e 2044 6566 6175 6c74 7320 746f 205b  n. Defaults to [
-00002820: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00002830: 2020 2073 656c 6563 7469 6e67 2061 6c6c     selecting all
-00002840: 2066 6561 7475 7265 732e 0a0a 2020 2020   features...    
-00002850: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-00002860: 2020 2020 2020 2020 2020 6051 7565 7279            `Query
-00002870: 603a 2041 2071 7565 7279 206f 626a 6563  `: A query objec
-00002880: 7420 7769 7468 2074 6865 2073 656c 6563  t with the selec
-00002890: 7465 6420 6665 6174 7572 6573 206f 6620  ted features of 
-000028a0: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-000028b0: 702e 0a20 2020 2020 2020 2022 2222 0a20  p..        """. 
-000028c0: 2020 2020 2020 2069 6620 6665 6174 7572         if featur
-000028d0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-000028e0: 6578 6365 7074 5f66 6561 7475 7265 7320  except_features 
-000028f0: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
-00002900: 2020 2020 662e 6e61 6d65 2069 6620 6973      f.name if is
-00002910: 696e 7374 616e 6365 2866 2c20 6665 6174  instance(f, feat
-00002920: 7572 652e 4665 6174 7572 6529 2065 6c73  ure.Feature) els
-00002930: 6520 6620 666f 7220 6620 696e 2066 6561  e f for f in fea
-00002940: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
-00002950: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-00002960: 7265 7475 726e 2071 7565 7279 2e51 7565  return query.Que
-00002970: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
-00002980: 2020 2020 6c65 6674 5f66 6561 7475 7265      left_feature
-00002990: 5f67 726f 7570 3d73 656c 662c 0a20 2020  _group=self,.   
-000029a0: 2020 2020 2020 2020 2020 2020 206c 6566               lef
-000029b0: 745f 6665 6174 7572 6573 3d5b 0a20 2020  t_features=[.   
-000029c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000029d0: 2066 2066 6f72 2066 2069 6e20 7365 6c66   f for f in self
-000029e0: 2e5f 6665 6174 7572 6573 2069 6620 662e  ._features if f.
-000029f0: 6e61 6d65 206e 6f74 2069 6e20 6578 6365  name not in exce
-00002a00: 7074 5f66 6561 7475 7265 730a 2020 2020  pt_features.    
-00002a10: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-00002a20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00002a30: 6561 7475 7265 5f73 746f 7265 5f6e 616d  eature_store_nam
-00002a40: 653d 7365 6c66 2e5f 6665 6174 7572 655f  e=self._feature_
-00002a50: 7374 6f72 655f 6e61 6d65 2c0a 2020 2020  store_name,.    
-00002a60: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00002a70: 7572 655f 7374 6f72 655f 6964 3d73 656c  ure_store_id=sel
-00002a80: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-00002a90: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-00002aa0: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-00002ab0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00002ac0: 7572 6e20 7365 6c66 2e73 656c 6563 745f  urn self.select_
-00002ad0: 616c 6c28 290a 0a20 2020 2064 6566 2066  all()..    def f
-00002ae0: 696c 7465 7228 7365 6c66 2c20 663a 2055  ilter(self, f: U
-00002af0: 6e69 6f6e 5b66 696c 7465 722e 4669 6c74  nion[filter.Filt
-00002b00: 6572 2c20 6669 6c74 6572 2e4c 6f67 6963  er, filter.Logic
-00002b10: 5d29 3a0a 2020 2020 2020 2020 2222 2241  ]):.        """A
-00002b20: 7070 6c79 2066 696c 7465 7220 746f 2074  pply filter to t
-00002b30: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-00002b40: 2e0a 0a20 2020 2020 2020 2053 656c 6563  ...        Selec
-00002b50: 7473 2061 6c6c 2066 6561 7475 7265 7320  ts all features 
-00002b60: 616e 6420 7265 7475 726e 7320 7468 6520  and returns the 
-00002b70: 7265 7375 6c74 696e 6720 6051 7565 7279  resulting `Query
-00002b80: 6020 7769 7468 2074 6865 2061 7070 6c69  ` with the appli
-00002b90: 6564 2066 696c 7465 722e 0a20 2020 2020  ed filter..     
-00002ba0: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
-00002bb0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-00002bc0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-00002bd0: 2066 726f 6d20 6873 6673 2e66 6561 7475   from hsfs.featu
-00002be0: 7265 2069 6d70 6f72 7420 4665 6174 7572  re import Featur
-00002bf0: 650a 0a20 2020 2020 2020 2020 2020 2023  e..            #
-00002c00: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-00002c10: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-00002c20: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-00002c30: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-00002c40: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-00002c50: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-00002c60: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
-00002c70: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
-00002c80: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
-00002c90: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
-00002ca0: 2020 2066 672e 6669 6c74 6572 2846 6561     fg.filter(Fea
-00002cb0: 7475 7265 2822 7765 656b 6c79 5f73 616c  ture("weekly_sal
-00002cc0: 6573 2229 203e 2031 3030 3029 0a20 2020  es") > 1000).   
-00002cd0: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
-00002ce0: 2020 2020 2020 4966 2079 6f75 2061 7265        If you are
-00002cf0: 2070 6c61 6e6e 696e 6720 746f 206a 6f69   planning to joi
-00002d00: 6e20 7468 6520 6669 6c74 6572 6564 2066  n the filtered f
-00002d10: 6561 7475 7265 2067 726f 7570 206c 6174  eature group lat
-00002d20: 6572 206f 6e20 7769 7468 2061 6e6f 7468  er on with anoth
-00002d30: 6572 0a20 2020 2020 2020 2066 6561 7475  er.        featu
-00002d40: 7265 2067 726f 7570 2c20 6d61 6b65 2073  re group, make s
-00002d50: 7572 6520 746f 2073 656c 6563 7420 7468  ure to select th
-00002d60: 6520 6669 6c74 6572 6564 2066 6561 7475  e filtered featu
-00002d70: 7265 2065 7870 6c69 6369 746c 7920 6672  re explicitly fr
-00002d80: 6f6d 2074 6865 0a20 2020 2020 2020 2072  om the.        r
-00002d90: 6573 7065 6374 6976 6520 6665 6174 7572  espective featur
-00002da0: 6520 6772 6f75 703a 0a20 2020 2020 2020  e group:.       
-00002db0: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-00002dc0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00002dd0: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
-00002de0: 672e 6669 6c74 6572 2866 672e 6665 6174  g.filter(fg.feat
-00002df0: 7572 6531 203d 3d20 3129 2e73 686f 7728  ure1 == 1).show(
-00002e00: 3130 290a 2020 2020 2020 2020 2020 2020  10).            
-00002e10: 6060 600a 0a20 2020 2020 2020 2043 6f6d  ```..        Com
-00002e20: 706f 7369 7465 2066 696c 7465 7273 2072  posite filters r
-00002e30: 6571 7569 7265 2070 6172 656e 7468 6573  equire parenthes
-00002e40: 6973 3a0a 2020 2020 2020 2020 2121 2120  is:.        !!! 
-00002e50: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
-00002e60: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-00002e70: 2020 2020 2020 2020 2020 6667 2e66 696c            fg.fil
-00002e80: 7465 7228 2866 672e 6665 6174 7572 6531  ter((fg.feature1
-00002e90: 203d 3d20 3129 207c 2028 6667 2e66 6561   == 1) | (fg.fea
-00002ea0: 7475 7265 3220 3e3d 2032 2929 0a20 2020  ture2 >= 2)).   
-00002eb0: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
-00002ec0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
-00002ed0: 730a 2020 2020 2020 2020 2020 2020 663a  s.            f:
-00002ee0: 2046 696c 7465 7220 6f62 6a65 6374 2e0a   Filter object..
-00002ef0: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-00002f00: 6e73 0a20 2020 2020 2020 2020 2020 2060  ns.            `
-00002f10: 5175 6572 7960 2e20 5468 6520 7175 6572  Query`. The quer
-00002f20: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
-00002f30: 6520 6170 706c 6965 6420 6669 6c74 6572  e applied filter
-00002f40: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00002f50: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00002f60: 662e 7365 6c65 6374 5f61 6c6c 2829 2e66  f.select_all().f
-00002f70: 696c 7465 7228 6629 0a0a 2020 2020 6465  ilter(f)..    de
-00002f80: 6620 6164 645f 7461 6728 7365 6c66 2c20  f add_tag(self, 
-00002f90: 6e61 6d65 3a20 7374 722c 2076 616c 7565  name: str, value
-00002fa0: 293a 0a20 2020 2020 2020 2022 2222 4174  ):.        """At
-00002fb0: 7461 6368 2061 2074 6167 2074 6f20 6120  tach a tag to a 
-00002fc0: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
-00002fd0: 2020 2020 2020 2020 4120 7461 6720 636f          A tag co
-00002fe0: 6e73 6973 7473 206f 6620 6120 3c6e 616d  nsists of a <nam
-00002ff0: 652c 7661 6c75 653e 2070 6169 722e 2054  e,value> pair. T
-00003000: 6167 206e 616d 6573 2061 7265 2075 6e69  ag names are uni
-00003010: 7175 6520 6964 656e 7469 6669 6572 7320  que identifiers 
-00003020: 6163 726f 7373 2074 6865 2077 686f 6c65  across the whole
-00003030: 2063 6c75 7374 6572 2e0a 2020 2020 2020   cluster..      
-00003040: 2020 5468 6520 7661 6c75 6520 6f66 2061    The value of a
-00003050: 2074 6167 2063 616e 2062 6520 616e 7920   tag can be any 
-00003060: 7661 6c69 6420 6a73 6f6e 202d 2070 7269  valid json - pri
-00003070: 6d69 7469 7665 732c 2061 7272 6179 7320  mitives, arrays 
-00003080: 6f72 206a 736f 6e20 6f62 6a65 6374 732e  or json objects.
-00003090: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
-000030a0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-000030b0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-000030c0: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-000030d0: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-000030e0: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-000030f0: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-00003100: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-00003110: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-00003120: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-00003130: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
-00003140: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
-00003150: 7572 655f 6772 6f75 7028 2e2e 2e29 0a0a  ure_group(...)..
-00003160: 2020 2020 2020 2020 2020 2020 6667 2e61              fg.a
-00003170: 6464 5f74 6167 286e 616d 653d 2265 7861  dd_tag(name="exa
-00003180: 6d70 6c65 5f74 6167 222c 2076 616c 7565  mple_tag", value
-00003190: 3d22 3432 2229 0a20 2020 2020 2020 2020  ="42").         
-000031a0: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-000031b0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
-000031c0: 2020 2020 2020 2020 6e61 6d65 3a20 4e61          name: Na
-000031d0: 6d65 206f 6620 7468 6520 7461 6720 746f  me of the tag to
-000031e0: 2062 6520 6164 6465 642e 0a20 2020 2020   be added..     
-000031f0: 2020 2020 2020 2076 616c 7565 3a20 5661         value: Va
-00003200: 6c75 6520 6f66 2074 6865 2074 6167 2074  lue of the tag t
-00003210: 6f20 6265 2061 6464 6564 2e0a 0a20 2020  o be added...   
-00003220: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
-00003230: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-00003240: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-00003250: 732e 5265 7374 4150 4945 7272 6f72 6020  s.RestAPIError` 
-00003260: 696e 2063 6173 6520 7468 6520 6261 636b  in case the back
-00003270: 656e 6420 6661 696c 7320 746f 2061 6464  end fails to add
-00003280: 2074 6865 2074 6167 2e0a 2020 2020 2020   the tag..      
-00003290: 2020 2222 220a 0a20 2020 2020 2020 2073    """..        s
-000032a0: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
-000032b0: 7570 5f65 6e67 696e 652e 6164 645f 7461  up_engine.add_ta
-000032c0: 6728 7365 6c66 2c20 6e61 6d65 2c20 7661  g(self, name, va
-000032d0: 6c75 6529 0a0a 2020 2020 6465 6620 6465  lue)..    def de
-000032e0: 6c65 7465 5f74 6167 2873 656c 662c 206e  lete_tag(self, n
-000032f0: 616d 653a 2073 7472 293a 0a20 2020 2020  ame: str):.     
-00003300: 2020 2022 2222 4465 6c65 7465 2061 2074     """Delete a t
-00003310: 6167 2061 7474 6163 6865 6420 746f 2061  ag attached to a
-00003320: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
-00003330: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
-00003340: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
-00003350: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-00003360: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
-00003370: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
-00003380: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
-00003390: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
-000033a0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-000033b0: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
-000033c0: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
-000033d0: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
-000033e0: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
-000033f0: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
-00003400: 2020 2020 2020 2020 2020 2066 672e 6465             fg.de
-00003410: 6c65 7465 5f74 6167 2822 6578 616d 706c  lete_tag("exampl
-00003420: 655f 7461 6722 290a 2020 2020 2020 2020  e_tag").        
-00003430: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-00003440: 2023 2041 7267 756d 656e 7473 0a20 2020   # Arguments.   
-00003450: 2020 2020 2020 2020 206e 616d 653a 204e           name: N
-00003460: 616d 6520 6f66 2074 6865 2074 6167 2074  ame of the tag t
-00003470: 6f20 6265 2072 656d 6f76 6564 2e0a 0a20  o be removed... 
-00003480: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
-00003490: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-000034a0: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-000034b0: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
-000034c0: 6020 696e 2063 6173 6520 7468 6520 6261  ` in case the ba
-000034d0: 636b 656e 6420 6661 696c 7320 746f 2064  ckend fails to d
-000034e0: 656c 6574 6520 7468 6520 7461 672e 0a20  elete the tag.. 
-000034f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00003500: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-00003510: 5f67 726f 7570 5f65 6e67 696e 652e 6465  _group_engine.de
-00003520: 6c65 7465 5f74 6167 2873 656c 662c 206e  lete_tag(self, n
-00003530: 616d 6529 0a0a 2020 2020 6465 6620 6765  ame)..    def ge
-00003540: 745f 7461 6728 7365 6c66 2c20 6e61 6d65  t_tag(self, name
-00003550: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
-00003560: 2222 2247 6574 2074 6865 2074 6167 7320  """Get the tags 
-00003570: 6f66 2061 2066 6561 7475 7265 2067 726f  of a feature gro
-00003580: 7570 2e0a 0a20 2020 2020 2020 2021 2121  up...        !!!
-00003590: 2065 7861 6d70 6c65 0a20 2020 2020 2020   example.       
-000035a0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
-000035b0: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
-000035c0: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
-000035d0: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
-000035e0: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
-000035f0: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
-00003600: 7420 7468 6520 4665 6174 7572 6520 4772  t the Feature Gr
-00003610: 6f75 7020 696e 7374 616e 6365 0a20 2020  oup instance.   
-00003620: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
-00003630: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
-00003640: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
-00003650: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00003660: 675f 7461 675f 7661 6c75 6520 3d20 6667  g_tag_value = fg
-00003670: 2e67 6574 5f74 6167 2822 6578 616d 706c  .get_tag("exampl
-00003680: 655f 7461 6722 290a 2020 2020 2020 2020  e_tag").        
-00003690: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-000036a0: 2023 2041 7267 756d 656e 7473 0a20 2020   # Arguments.   
-000036b0: 2020 2020 2020 2020 206e 616d 653a 204e           name: N
-000036c0: 616d 6520 6f66 2074 6865 2074 6167 2074  ame of the tag t
-000036d0: 6f20 6765 742e 0a0a 2020 2020 2020 2020  o get...        
-000036e0: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
-000036f0: 2020 2020 2020 7461 6720 7661 6c75 650a        tag value.
-00003700: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
-00003710: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
-00003720: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
-00003730: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
-00003740: 6f72 6020 696e 2063 6173 6520 7468 6520  or` in case the 
-00003750: 6261 636b 656e 6420 6661 696c 7320 746f  backend fails to
-00003760: 2072 6574 7269 6576 6520 7468 6520 7461   retrieve the ta
-00003770: 672e 0a20 2020 2020 2020 2022 2222 0a20  g..        """. 
-00003780: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00003790: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
-000037a0: 705f 656e 6769 6e65 2e67 6574 5f74 6167  p_engine.get_tag
-000037b0: 2873 656c 662c 206e 616d 6529 0a0a 2020  (self, name)..  
-000037c0: 2020 6465 6620 6765 745f 7461 6773 2873    def get_tags(s
-000037d0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000037e0: 2252 6574 7269 6576 6573 2061 6c6c 2074  "Retrieves all t
-000037f0: 6167 7320 6174 7461 6368 6564 2074 6f20  ags attached to 
-00003800: 6120 6665 6174 7572 6520 6772 6f75 702e  a feature group.
-00003810: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
-00003820: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
-00003830: 6044 6963 745b 7374 722c 206f 626a 5d60  `Dict[str, obj]`
-00003840: 206f 6620 7461 6773 2e0a 0a20 2020 2020   of tags...     
-00003850: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
-00003860: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-00003870: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-00003880: 5265 7374 4150 4945 7272 6f72 6020 696e  RestAPIError` in
-00003890: 2063 6173 6520 7468 6520 6261 636b 656e   case the backen
-000038a0: 6420 6661 696c 7320 746f 2072 6574 7269  d fails to retri
-000038b0: 6576 6520 7468 6520 7461 6773 2e0a 2020  eve the tags..  
-000038c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000038d0: 2020 7265 7475 726e 2073 656c 662e 5f66    return self._f
-000038e0: 6561 7475 7265 5f67 726f 7570 5f65 6e67  eature_group_eng
-000038f0: 696e 652e 6765 745f 7461 6773 2873 656c  ine.get_tags(sel
-00003900: 6629 0a0a 2020 2020 6465 6620 6765 745f  f)..    def get_
-00003910: 7061 7265 6e74 5f66 6561 7475 7265 5f67  parent_feature_g
-00003920: 726f 7570 7328 7365 6c66 293a 0a20 2020  roups(self):.   
-00003930: 2020 2020 2022 2222 4765 7420 7468 6520       """Get the 
-00003940: 7061 7265 6e74 7320 6f66 2074 6869 7320  parents of this 
-00003950: 6665 6174 7572 6520 6772 6f75 702c 2062  feature group, b
-00003960: 6173 6564 206f 6e20 6578 706c 6963 6974  ased on explicit
-00003970: 2070 726f 7665 6e61 6e63 652e 0a20 2020   provenance..   
-00003980: 2020 2020 2050 6172 656e 7473 2061 7265       Parents are
-00003990: 2066 6561 7475 7265 2067 726f 7570 7320   feature groups 
-000039a0: 6f72 2065 7874 6572 6e61 6c20 6665 6174  or external feat
-000039b0: 7572 6520 6772 6f75 7073 2e20 5468 6573  ure groups. Thes
-000039c0: 6520 6665 6174 7572 650a 2020 2020 2020  e feature.      
-000039d0: 2020 6772 6f75 7073 2063 616e 2062 6520    groups can be 
-000039e0: 6163 6365 7373 6962 6c65 2c20 6465 6c65  accessible, dele
-000039f0: 7465 6420 6f72 2069 6e61 6363 6573 7369  ted or inaccessi
-00003a00: 626c 652e 0a20 2020 2020 2020 2046 6f72  ble..        For
-00003a10: 2064 656c 6574 6564 2061 6e64 2069 6e61   deleted and ina
-00003a20: 6363 6573 7369 626c 6520 6665 6174 7572  ccessible featur
-00003a30: 6520 6772 6f75 7073 2c20 6f6e 6c79 2061  e groups, only a
-00003a40: 206d 696e 696d 616c 2069 6e66 6f72 6d61   minimal informa
-00003a50: 7469 6f6e 2069 730a 2020 2020 2020 2020  tion is.        
-00003a60: 7265 7475 726e 6564 2e0a 0a20 2020 2020  returned...     
-00003a70: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
-00003a80: 2020 2020 2020 2020 2060 5072 6f76 656e           `Proven
-00003a90: 616e 6365 4c69 6e6b 7360 3a20 4f62 6a65  anceLinks`: Obje
-00003aa0: 6374 2063 6f6e 7461 696e 696e 6720 7468  ct containing th
-00003ab0: 6520 7365 6374 696f 6e20 6f66 2070 726f  e section of pro
-00003ac0: 7665 6e61 6e63 6520 6772 6170 6820 7265  venance graph re
-00003ad0: 7175 6573 7465 642e 0a0a 2020 2020 2020  quested...      
-00003ae0: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
-00003af0: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-00003b00: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
-00003b10: 6573 7441 5049 4572 726f 7260 2e0a 2020  estAPIError`..  
-00003b20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00003b30: 2020 7265 7475 726e 2073 656c 662e 5f66    return self._f
-00003b40: 6561 7475 7265 5f67 726f 7570 5f65 6e67  eature_group_eng
-00003b50: 696e 652e 6765 745f 7061 7265 6e74 5f66  ine.get_parent_f
-00003b60: 6561 7475 7265 5f67 726f 7570 7328 7365  eature_groups(se
-00003b70: 6c66 290a 0a20 2020 2064 6566 2067 6574  lf)..    def get
-00003b80: 5f67 656e 6572 6174 6564 5f66 6561 7475  _generated_featu
-00003b90: 7265 5f76 6965 7773 2873 656c 6629 3a0a  re_views(self):.
-00003ba0: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
-00003bb0: 6865 2067 656e 6572 6174 6564 2066 6561  he generated fea
-00003bc0: 7475 7265 2076 6965 7720 7573 696e 6720  ture view using 
-00003bd0: 7468 6973 2066 6561 7475 7265 2067 726f  this feature gro
-00003be0: 7570 2c20 6261 7365 6420 6f6e 2065 7870  up, based on exp
-00003bf0: 6c69 6369 740a 2020 2020 2020 2020 7072  licit.        pr
-00003c00: 6f76 656e 616e 6365 2e20 5468 6573 6520  ovenance. These 
-00003c10: 6665 6174 7572 6520 7669 6577 7320 6361  feature views ca
-00003c20: 6e20 6265 2061 6363 6573 7369 626c 6520  n be accessible 
-00003c30: 6f72 2069 6e61 6363 6573 7369 626c 652e  or inaccessible.
-00003c40: 2045 7870 6c69 6369 740a 2020 2020 2020   Explicit.      
-00003c50: 2020 7072 6f76 656e 616e 6365 2064 6f65    provenance doe
-00003c60: 7320 6e6f 7420 7472 6163 6b20 6465 6c65  s not track dele
-00003c70: 7465 6420 6765 6e65 7261 7465 6420 6665  ted generated fe
-00003c80: 6174 7572 6520 7669 6577 206c 696e 6b73  ature view links
-00003c90: 2c20 736f 2064 656c 6574 6564 0a20 2020  , so deleted.   
-00003ca0: 2020 2020 2077 696c 6c20 616c 7761 7973       will always
-00003cb0: 2062 6520 656d 7074 792e 0a20 2020 2020   be empty..     
-00003cc0: 2020 2046 6f72 2069 6e61 6363 6573 7369     For inaccessi
-00003cd0: 626c 6520 6665 6174 7572 6520 7669 6577  ble feature view
-00003ce0: 732c 206f 6e6c 7920 6120 6d69 6e69 6d61  s, only a minima
-00003cf0: 6c20 696e 666f 726d 6174 696f 6e20 6973  l information is
-00003d00: 2072 6574 7572 6e65 642e 0a0a 2020 2020   returned...    
-00003d10: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-00003d20: 2020 2020 2020 2020 2020 6050 726f 7665            `Prove
-00003d30: 6e61 6e63 654c 696e 6b73 603a 204f 626a  nanceLinks`: Obj
-00003d40: 6563 7420 636f 6e74 6169 6e69 6e67 2074  ect containing t
-00003d50: 6865 2073 6563 7469 6f6e 206f 6620 7072  he section of pr
-00003d60: 6f76 656e 616e 6365 2067 7261 7068 2072  ovenance graph r
-00003d70: 6571 7565 7374 6564 2e0a 0a20 2020 2020  equested...     
-00003d80: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
-00003d90: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-00003da0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-00003db0: 5265 7374 4150 4945 7272 6f72 602e 0a20  RestAPIError`.. 
-00003dc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00003dd0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00003de0: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
-00003df0: 6769 6e65 2e67 6574 5f67 656e 6572 6174  gine.get_generat
-00003e00: 6564 5f66 6561 7475 7265 5f76 6965 7773  ed_feature_views
-00003e10: 2873 656c 6629 0a0a 2020 2020 6465 6620  (self)..    def 
-00003e20: 6765 745f 6765 6e65 7261 7465 645f 6665  get_generated_fe
-00003e30: 6174 7572 655f 6772 6f75 7073 2873 656c  ature_groups(sel
-00003e40: 6629 3a0a 2020 2020 2020 2020 2222 2247  f):.        """G
-00003e50: 6574 2074 6865 2067 656e 6572 6174 6564  et the generated
-00003e60: 2066 6561 7475 7265 2067 726f 7570 7320   feature groups 
-00003e70: 7573 696e 6720 7468 6973 2066 6561 7475  using this featu
-00003e80: 7265 2067 726f 7570 2c20 6261 7365 6420  re group, based 
-00003e90: 6f6e 2065 7870 6c69 6369 740a 2020 2020  on explicit.    
-00003ea0: 2020 2020 7072 6f76 656e 616e 6365 2e20      provenance. 
-00003eb0: 5468 6573 6520 6665 6174 7572 6520 6772  These feature gr
-00003ec0: 6f75 7073 2063 616e 2062 6520 6163 6365  oups can be acce
-00003ed0: 7373 6962 6c65 206f 7220 696e 6163 6365  ssible or inacce
-00003ee0: 7373 6962 6c65 2e20 4578 706c 6963 6974  ssible. Explicit
-00003ef0: 0a20 2020 2020 2020 2070 726f 7665 6e61  .        provena
-00003f00: 6e63 6520 646f 6573 206e 6f74 2074 7261  nce does not tra
-00003f10: 636b 2064 656c 6574 6564 2067 656e 6572  ck deleted gener
-00003f20: 6174 6564 2066 6561 7475 7265 2067 726f  ated feature gro
-00003f30: 7570 206c 696e 6b73 2c20 736f 2064 656c  up links, so del
-00003f40: 6574 6564 0a20 2020 2020 2020 2077 696c  eted.        wil
-00003f50: 6c20 616c 7761 7973 2062 6520 656d 7074  l always be empt
-00003f60: 792e 0a20 2020 2020 2020 2046 6f72 2069  y..        For i
-00003f70: 6e61 6363 6573 7369 626c 6520 6665 6174  naccessible feat
-00003f80: 7572 6520 6772 6f75 7073 2c20 6f6e 6c79  ure groups, only
-00003f90: 2061 206d 696e 696d 616c 2069 6e66 6f72   a minimal infor
-00003fa0: 6d61 7469 6f6e 2069 7320 7265 7475 726e  mation is return
-00003fb0: 6564 2e0a 0a20 2020 2020 2020 2023 2052  ed...        # R
-00003fc0: 6574 7572 6e73 0a20 2020 2020 2020 2020  eturns.         
-00003fd0: 2020 2060 5072 6f76 656e 616e 6365 4c69     `ProvenanceLi
-00003fe0: 6e6b 7360 3a20 4f62 6a65 6374 2063 6f6e  nks`: Object con
-00003ff0: 7461 696e 696e 6720 7468 6520 7365 6374  taining the sect
-00004000: 696f 6e20 6f66 2070 726f 7665 6e61 6e63  ion of provenanc
-00004010: 6520 6772 6170 6820 7265 7175 6573 7465  e graph requeste
-00004020: 642e 0a0a 2020 2020 2020 2020 2320 5261  d...        # Ra
-00004030: 6973 6573 0a20 2020 2020 2020 2020 2020  ises.           
-00004040: 2060 6873 6673 2e63 6c69 656e 742e 6578   `hsfs.client.ex
-00004050: 6365 7074 696f 6e73 2e52 6573 7441 5049  ceptions.RestAPI
-00004060: 4572 726f 7260 2e0a 2020 2020 2020 2020  Error`..        
-00004070: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00004080: 726e 2073 656c 662e 5f66 6561 7475 7265  rn self._feature
-00004090: 5f67 726f 7570 5f65 6e67 696e 652e 6765  _group_engine.ge
-000040a0: 745f 6765 6e65 7261 7465 645f 6665 6174  t_generated_feat
-000040b0: 7572 655f 6772 6f75 7073 2873 656c 6629  ure_groups(self)
-000040c0: 0a0a 2020 2020 6465 6620 6765 745f 6665  ..    def get_fe
-000040d0: 6174 7572 6528 7365 6c66 2c20 6e61 6d65  ature(self, name
-000040e0: 3a20 7374 7229 3a0a 2020 2020 2020 2020  : str):.        
-000040f0: 2222 2252 6574 7269 6576 6520 6120 6046  """Retrieve a `F
-00004100: 6561 7475 7265 6020 6f62 6a65 6374 2066  eature` object f
-00004110: 726f 6d20 7468 6520 7363 6865 6d61 206f  rom the schema o
-00004120: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
-00004130: 6f75 702e 0a0a 2020 2020 2020 2020 5468  oup...        Th
-00004140: 6572 6520 6172 6520 7365 7665 7261 6c20  ere are several 
-00004150: 7761 7973 2074 6f20 6163 6365 7373 2066  ways to access f
-00004160: 6561 7475 7265 7320 6f66 2061 2066 6561  eatures of a fea
-00004170: 7475 7265 2067 726f 7570 3a0a 0a20 2020  ture group:..   
-00004180: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
-00004190: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-000041a0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-000041b0: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
-000041c0: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
-000041d0: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
-000041e0: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
-000041f0: 2020 2020 2320 6765 7420 7468 6520 4665      # get the Fe
-00004200: 6174 7572 6520 4772 6f75 7020 696e 7374  ature Group inst
-00004210: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
-00004220: 2066 6720 3d20 6673 2e67 6574 5f6f 725f   fg = fs.get_or_
-00004230: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-00004240: 726f 7570 282e 2e2e 290a 0a20 2020 2020  roup(...)..     
-00004250: 2020 2020 2020 2023 2067 6574 2046 6561         # get Fea
-00004260: 7475 7265 2069 6e73 7461 6e73 650a 2020  ture instanse.  
-00004270: 2020 2020 2020 2020 2020 6667 2e66 6561            fg.fea
-00004280: 7475 7265 310a 2020 2020 2020 2020 2020  ture1.          
-00004290: 2020 6667 5b22 6665 6174 7572 6531 225d    fg["feature1"]
-000042a0: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
-000042b0: 6765 745f 6665 6174 7572 6528 2266 6561  get_feature("fea
-000042c0: 7475 7265 3122 290a 2020 2020 2020 2020  ture1").        
-000042d0: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-000042e0: 2021 2121 206e 6f74 650a 2020 2020 2020   !!! note.      
-000042f0: 2020 2020 2020 4174 7472 6962 7574 6520        Attribute 
-00004300: 6163 6365 7373 2074 6f20 6665 6174 7572  access to featur
-00004310: 6573 2077 6f72 6b73 206f 6e6c 7920 666f  es works only fo
-00004320: 7220 6e6f 6e2d 7265 7365 7276 6564 206e  r non-reserved n
-00004330: 616d 6573 2e20 466f 7220 6578 616d 706c  ames. For exampl
-00004340: 650a 2020 2020 2020 2020 2020 2020 6665  e.            fe
-00004350: 6174 7572 6573 206e 616d 6564 2060 6964  atures named `id
-00004360: 6020 6f72 2060 6e61 6d65 6020 7769 6c6c  ` or `name` will
-00004370: 206e 6f74 2062 6520 6163 6365 7373 6962   not be accessib
-00004380: 6c65 2076 6961 2060 6667 2e6e 616d 6560  le via `fg.name`
-00004390: 2c20 696e 7374 6561 640a 2020 2020 2020  , instead.      
-000043a0: 2020 2020 2020 7468 6973 2077 696c 6c20        this will 
-000043b0: 7265 7475 726e 2074 6865 206e 616d 6520  return the name 
-000043c0: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-000043d0: 726f 7570 2069 7473 656c 662e 2046 616c  roup itself. Fal
-000043e0: 6c20 6261 636b 206f 6e20 7573 696e 670a  l back on using.
-000043f0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00004400: 6067 6574 5f66 6561 7475 7265 6020 6d65  `get_feature` me
-00004410: 7468 6f64 2e0a 0a20 2020 2020 2020 2023  thod...        #
-00004420: 2041 7267 756d 656e 7473 3a0a 2020 2020   Arguments:.    
-00004430: 2020 2020 2020 2020 6e61 6d65 3a20 5468          name: Th
-00004440: 6520 6e61 6d65 206f 6620 7468 6520 6665  e name of the fe
-00004450: 6174 7572 6520 746f 2072 6574 7269 6576  ature to retriev
-00004460: 650a 0a20 2020 2020 2020 2023 2052 6574  e..        # Ret
-00004470: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00004480: 2020 4665 6174 7572 653a 2054 6865 2066    Feature: The f
-00004490: 6561 7475 7265 206f 626a 6563 740a 0a20  eature object.. 
-000044a0: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
-000044b0: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-000044c0: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-000044d0: 6f6e 732e 4665 6174 7572 6553 746f 7265  ons.FeatureStore
-000044e0: 4578 6365 7074 696f 6e60 2e0a 2020 2020  Exception`..    
-000044f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004500: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00004510: 2072 6574 7572 6e20 7365 6c66 2e5f 5f67   return self.__g
-00004520: 6574 6974 656d 5f5f 286e 616d 6529 0a20  etitem__(name). 
-00004530: 2020 2020 2020 2065 7863 6570 7420 4b65         except Ke
-00004540: 7945 7272 6f72 3a0a 2020 2020 2020 2020  yError:.        
-00004550: 2020 2020 7261 6973 6520 4665 6174 7572      raise Featur
-00004560: 6553 746f 7265 4578 6365 7074 696f 6e28  eStoreException(
-00004570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004580: 2066 2227 4665 6174 7572 6547 726f 7570   f"'FeatureGroup
-00004590: 2720 6f62 6a65 6374 2068 6173 206e 6f20  ' object has no 
-000045a0: 6665 6174 7572 6520 6361 6c6c 6564 2027  feature called '
-000045b0: 7b6e 616d 657d 272e 220a 2020 2020 2020  {name}'.".      
-000045c0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000045d0: 2075 7064 6174 655f 7374 6174 6973 7469   update_statisti
-000045e0: 6373 5f63 6f6e 6669 6728 7365 6c66 293a  cs_config(self):
-000045f0: 0a20 2020 2020 2020 2022 2222 5570 6461  .        """Upda
-00004600: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
-00004610: 7320 636f 6e66 6967 7572 6174 696f 6e20  s configuration 
-00004620: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-00004630: 726f 7570 2e0a 0a20 2020 2020 2020 2043  roup...        C
-00004640: 6861 6e67 6520 7468 6520 6073 7461 7469  hange the `stati
-00004650: 7374 6963 735f 636f 6e66 6967 6020 6f62  stics_config` ob
-00004660: 6a65 6374 2061 6e64 2070 6572 7369 7374  ject and persist
-00004670: 2074 6865 2063 6861 6e67 6573 2062 7920   the changes by 
-00004680: 6361 6c6c 696e 670a 2020 2020 2020 2020  calling.        
-00004690: 7468 6973 206d 6574 686f 642e 0a0a 2020  this method...  
-000046a0: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
-000046b0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
-000046c0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-000046d0: 2020 2020 2320 636f 6e6e 6563 7420 746f      # connect to
-000046e0: 2074 6865 2046 6561 7475 7265 2053 746f   the Feature Sto
-000046f0: 7265 0a20 2020 2020 2020 2020 2020 2066  re.            f
-00004700: 7320 3d20 2e2e 2e0a 0a20 2020 2020 2020  s = .....       
-00004710: 2020 2020 2023 2067 6574 2074 6865 2046       # get the F
-00004720: 6561 7475 7265 2047 726f 7570 2069 6e73  eature Group ins
-00004730: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
-00004740: 2020 6667 203d 2066 732e 6765 745f 6f72    fg = fs.get_or
-00004750: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
-00004760: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
-00004770: 2020 2020 2020 2020 6667 2e75 7064 6174          fg.updat
-00004780: 655f 7374 6174 6973 7469 6373 5f63 6f6e  e_statistics_con
-00004790: 6669 6728 290a 2020 2020 2020 2020 2020  fig().          
-000047a0: 2020 6060 600a 0a20 2020 2020 2020 2023    ```..        #
-000047b0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-000047c0: 2020 2020 2060 4665 6174 7572 6547 726f       `FeatureGro
-000047d0: 7570 602e 2054 6865 2075 7064 6174 6564  up`. The updated
-000047e0: 206d 6574 6164 6174 6120 6f62 6a65 6374   metadata object
-000047f0: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00004800: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
-00004810: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
-00004820: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
-00004830: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
-00004840: 7441 5049 4572 726f 7260 2e0a 2020 2020  tAPIError`..    
-00004850: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004860: 7365 6c66 2e5f 6665 6174 7572 655f 6772  self._feature_gr
-00004870: 6f75 705f 656e 6769 6e65 2e75 7064 6174  oup_engine.updat
-00004880: 655f 7374 6174 6973 7469 6373 5f63 6f6e  e_statistics_con
-00004890: 6669 6728 7365 6c66 290a 2020 2020 2020  fig(self).      
-000048a0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-000048b0: 2020 2064 6566 2075 7064 6174 655f 6465     def update_de
-000048c0: 7363 7269 7074 696f 6e28 7365 6c66 2c20  scription(self, 
-000048d0: 6465 7363 7269 7074 696f 6e3a 2073 7472  description: str
-000048e0: 293a 0a20 2020 2020 2020 2022 2222 5570  ):.        """Up
-000048f0: 6461 7465 2074 6865 2064 6573 6372 6970  date the descrip
-00004900: 7469 6f6e 206f 6620 7468 6520 6665 6174  tion of the feat
-00004910: 7572 6520 6772 6f75 702e 0a0a 2020 2020  ure group...    
-00004920: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
-00004930: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-00004940: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-00004950: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
-00004960: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
-00004970: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
-00004980: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
-00004990: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
-000049a0: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
-000049b0: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
-000049c0: 6667 203d 2066 732e 6765 745f 6f72 5f63  fg = fs.get_or_c
-000049d0: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
-000049e0: 6f75 7028 2e2e 2e29 0a0a 2020 2020 2020  oup(...)..      
-000049f0: 2020 2020 2020 6667 2e75 7064 6174 655f        fg.update_
-00004a00: 6465 7363 7269 7074 696f 6e28 6465 7363  description(desc
-00004a10: 7269 7074 696f 6e3d 224d 7563 6820 6265  ription="Much be
-00004a20: 7474 6572 2064 6573 6372 6970 7469 6f6e  tter description
-00004a30: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-00004a40: 6060 600a 0a20 2020 2020 2020 2021 2121  ```..        !!!
-00004a50: 2069 6e66 6f20 2253 6166 6520 7570 6461   info "Safe upda
-00004a60: 7465 220a 2020 2020 2020 2020 2020 2020  te".            
-00004a70: 5468 6973 206d 6574 686f 6420 7570 6461  This method upda
-00004a80: 7465 7320 7468 6520 6665 6174 7572 6520  tes the feature 
-00004a90: 6772 6f75 7020 6465 7363 7269 7074 696f  group descriptio
-00004aa0: 6e20 7361 6665 6c79 2e20 496e 2063 6173  n safely. In cas
-00004ab0: 6520 6f66 2066 6169 6c75 7265 0a20 2020  e of failure.   
-00004ac0: 2020 2020 2020 2020 2079 6f75 7220 6c6f           your lo
-00004ad0: 6361 6c20 6d65 7461 6461 7461 206f 626a  cal metadata obj
-00004ae0: 6563 7420 7769 6c6c 206b 6565 7020 7468  ect will keep th
-00004af0: 6520 6f6c 6420 6465 7363 7269 7074 696f  e old descriptio
-00004b00: 6e2e 0a0a 2020 2020 2020 2020 2320 4172  n...        # Ar
-00004b10: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-00004b20: 2020 2020 6465 7363 7269 7074 696f 6e3a      description:
-00004b30: 204e 6577 2064 6573 6372 6970 7469 6f6e   New description
-00004b40: 2073 7472 696e 672e 0a0a 2020 2020 2020   string...      
-00004b50: 2020 2320 5265 7475 726e 730a 2020 2020    # Returns.    
-00004b60: 2020 2020 2020 2020 6046 6561 7475 7265          `Feature
-00004b70: 4772 6f75 7060 2e20 5468 6520 7570 6461  Group`. The upda
-00004b80: 7465 6420 6665 6174 7572 6520 6772 6f75  ted feature grou
-00004b90: 7020 6f62 6a65 6374 2e0a 2020 2020 2020  p object..      
-00004ba0: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-00004bb0: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
-00004bc0: 705f 656e 6769 6e65 2e75 7064 6174 655f  p_engine.update_
-00004bd0: 6465 7363 7269 7074 696f 6e28 7365 6c66  description(self
-00004be0: 2c20 6465 7363 7269 7074 696f 6e29 0a20  , description). 
-00004bf0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00004c00: 6c66 0a0a 2020 2020 6465 6620 7570 6461  lf..    def upda
-00004c10: 7465 5f66 6561 7475 7265 7328 7365 6c66  te_features(self
-00004c20: 2c20 6665 6174 7572 6573 3a20 556e 696f  , features: Unio
-00004c30: 6e5b 6665 6174 7572 652e 4665 6174 7572  n[feature.Featur
-00004c40: 652c 204c 6973 745b 6665 6174 7572 652e  e, List[feature.
-00004c50: 4665 6174 7572 655d 5d29 3a0a 2020 2020  Feature]]):.    
-00004c60: 2020 2020 2222 2255 7064 6174 6520 6d65      """Update me
-00004c70: 7461 6461 7461 206f 6620 6665 6174 7572  tadata of featur
-00004c80: 6573 2069 6e20 7468 6973 2066 6561 7475  es in this featu
-00004c90: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
-00004ca0: 2020 2043 7572 7265 6e74 6c79 2069 7427     Currently it'
-00004cb0: 7320 6f6e 6c79 2073 7570 706f 7274 6564  s only supported
-00004cc0: 2074 6f20 7570 6461 7465 2074 6865 2064   to update the d
-00004cd0: 6573 6372 6970 7469 6f6e 206f 6620 6120  escription of a 
-00004ce0: 6665 6174 7572 652e 0a0a 2020 2020 2020  feature...      
-00004cf0: 2020 2121 2120 6461 6e67 6572 2022 556e    !!! danger "Un
-00004d00: 7361 6665 2075 7064 6174 6522 0a20 2020  safe update".   
-00004d10: 2020 2020 2020 2020 204e 6f74 6520 7468           Note th
-00004d20: 6174 2069 6620 796f 7520 7573 6520 616e  at if you use an
-00004d30: 2065 7869 7374 696e 6720 6046 6561 7475   existing `Featu
-00004d40: 7265 6020 6f62 6a65 6374 206f 6620 7468  re` object of th
-00004d50: 6520 7363 6865 6d61 2069 6e20 7468 650a  e schema in the.
-00004d60: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00004d70: 7572 6520 6772 6f75 7020 6d65 7461 6461  ure group metada
-00004d80: 7461 206f 626a 6563 742c 2074 6869 7320  ta object, this 
-00004d90: 6d69 6768 7420 6c65 6176 6520 796f 7572  might leave your
-00004da0: 206d 6574 6164 6174 6120 6f62 6a65 6374   metadata object
-00004db0: 2069 6e20 610a 2020 2020 2020 2020 2020   in a.          
-00004dc0: 2020 636f 7272 7570 7465 6420 7374 6174    corrupted stat
-00004dd0: 6520 6966 2074 6865 2075 7064 6174 6520  e if the update 
-00004de0: 6661 696c 732e 0a0a 2020 2020 2020 2020  fails...        
-00004df0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
-00004e00: 2020 2020 2020 2020 6665 6174 7572 6573          features
-00004e10: 3a20 6046 6561 7475 7265 6020 6f72 206c  : `Feature` or l
-00004e20: 6973 7420 6f66 2066 6561 7475 7265 732e  ist of features.
-00004e30: 2041 2066 6561 7475 7265 206f 626a 6563   A feature objec
-00004e40: 7420 6f72 206c 6973 7420 7468 6572 656f  t or list thereo
-00004e50: 6620 746f 0a20 2020 2020 2020 2020 2020  f to.           
-00004e60: 2020 2020 2062 6520 7570 6461 7465 642e       be updated.
-00004e70: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
-00004e80: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
-00004e90: 6046 6561 7475 7265 4772 6f75 7060 2e20  `FeatureGroup`. 
-00004ea0: 5468 6520 7570 6461 7465 6420 6665 6174  The updated feat
-00004eb0: 7572 6520 6772 6f75 7020 6f62 6a65 6374  ure group object
-00004ec0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00004ed0: 2020 2020 2020 6e65 775f 6665 6174 7572        new_featur
-00004ee0: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
-00004ef0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-00004f00: 6174 7572 6573 2c20 6665 6174 7572 652e  atures, feature.
-00004f10: 4665 6174 7572 6529 3a0a 2020 2020 2020  Feature):.      
-00004f20: 2020 2020 2020 6e65 775f 6665 6174 7572        new_featur
-00004f30: 6573 2e61 7070 656e 6428 6665 6174 7572  es.append(featur
-00004f40: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
-00004f50: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
-00004f60: 7572 6573 2c20 6c69 7374 293a 0a20 2020  ures, list):.   
-00004f70: 2020 2020 2020 2020 2066 6f72 2066 6561           for fea
-00004f80: 7420 696e 2066 6561 7475 7265 733a 0a20  t in features:. 
-00004f90: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00004fa0: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-00004fb0: 742c 2066 6561 7475 7265 2e46 6561 7475  t, feature.Featu
-00004fc0: 7265 293a 0a20 2020 2020 2020 2020 2020  re):.           
-00004fd0: 2020 2020 2020 2020 206e 6577 5f66 6561           new_fea
-00004fe0: 7475 7265 732e 6170 7065 6e64 2866 6561  tures.append(fea
-00004ff0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-00005000: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00005010: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00005020: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
-00005030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005040: 2020 2020 2020 2254 6865 2061 7267 756d        "The argum
-00005050: 656e 7420 6066 6561 7475 7265 7360 2068  ent `features` h
-00005060: 6173 2074 6f20 6265 206f 6620 7479 7065  as to be of type
-00005070: 2060 4665 6174 7572 6560 206f 7220 220a   `Feature` or ".
-00005080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005090: 2020 2020 2020 2020 2261 206c 6973 7420          "a list 
-000050a0: 7468 6572 656f 662c 2062 7574 2061 6e20  thereof, but an 
-000050b0: 656c 656d 656e 7420 6973 206f 6620 7479  element is of ty
-000050c0: 7065 3a20 607b 7d60 222e 666f 726d 6174  pe: `{}`".format
-000050d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000050e0: 2020 2020 2020 2020 2020 2020 2020 7479                ty
-000050f0: 7065 2866 6561 7475 7265 7329 0a20 2020  pe(features).   
-00005100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005110: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00005120: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00005130: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00005140: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00005150: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00005160: 2020 2020 2020 2020 2254 6865 2061 7267          "The arg
-00005170: 756d 656e 7420 6066 6561 7475 7265 7360  ument `features`
-00005180: 2068 6173 2074 6f20 6265 206f 6620 7479   has to be of ty
-00005190: 7065 2060 4665 6174 7572 6560 206f 7220  pe `Feature` or 
-000051a0: 6120 6c69 7374 2022 0a20 2020 2020 2020  a list ".       
-000051b0: 2020 2020 2020 2020 2022 7468 6572 656f           "thereo
-000051c0: 662c 2062 7574 2069 7320 6f66 2074 7970  f, but is of typ
-000051d0: 653a 2060 7b7d 6022 2e66 6f72 6d61 7428  e: `{}`".format(
-000051e0: 7479 7065 2866 6561 7475 7265 7329 290a  type(features)).
-000051f0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00005200: 2020 2020 2020 7365 6c66 2e5f 6665 6174        self._feat
-00005210: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
-00005220: 2e75 7064 6174 655f 6665 6174 7572 6573  .update_features
-00005230: 2873 656c 662c 206e 6577 5f66 6561 7475  (self, new_featu
-00005240: 7265 7329 0a20 2020 2020 2020 2072 6574  res).        ret
-00005250: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
-00005260: 6620 7570 6461 7465 5f66 6561 7475 7265  f update_feature
-00005270: 5f64 6573 6372 6970 7469 6f6e 2873 656c  _description(sel
-00005280: 662c 2066 6561 7475 7265 5f6e 616d 653a  f, feature_name:
-00005290: 2073 7472 2c20 6465 7363 7269 7074 696f   str, descriptio
-000052a0: 6e3a 2073 7472 293a 0a20 2020 2020 2020  n: str):.       
-000052b0: 2022 2222 5570 6461 7465 2074 6865 2064   """Update the d
-000052c0: 6573 6372 6970 7469 6f6e 206f 6620 6120  escription of a 
-000052d0: 7369 6e67 6c65 2066 6561 7475 7265 2069  single feature i
-000052e0: 6e20 7468 6973 2066 6561 7475 7265 2067  n this feature g
-000052f0: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
-00005300: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
-00005310: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-00005320: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00005330: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-00005340: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-00005350: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-00005360: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00005370: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
-00005380: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
-00005390: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
-000053a0: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
-000053b0: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
-000053c0: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
-000053d0: 2066 672e 7570 6461 7465 5f66 6561 7475   fg.update_featu
-000053e0: 7265 5f64 6573 6372 6970 7469 6f6e 2866  re_description(f
-000053f0: 6561 7475 7265 5f6e 616d 653d 226d 696e  eature_name="min
-00005400: 5f74 656d 7022 2c0a 2020 2020 2020 2020  _temp",.        
-00005410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002690: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+000026a0: 2020 2020 2020 2020 7072 696d 6172 795f          primary_
+000026b0: 6b65 793d 5b22 6964 225d 2c0a 2020 2020  key=["id"],.    
+000026c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026d0: 6576 656e 745f 7469 6d65 3d22 7473 2229  event_time="ts")
+000026e0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000026f0: 636f 6e73 7472 7563 7420 7175 6572 790a  construct query.
+00002700: 2020 2020 2020 2020 2020 2020 7175 6572              quer
+00002710: 7920 3d20 6667 2e73 656c 6563 745f 6578  y = fg.select_ex
+00002720: 6365 7074 285b 2274 7322 2c20 2266 3122  cept(["ts", "f1"
+00002730: 5d29 0a20 2020 2020 2020 2020 2020 2071  ]).            q
+00002740: 7565 7279 2e66 6561 7475 7265 730a 2020  uery.features.  
+00002750: 2020 2020 2020 2020 2020 2320 5b46 6561            # [Fea
+00002760: 7475 7265 2827 6964 272c 202e 2e2e 292c  ture('id', ...),
+00002770: 2046 6561 7475 7265 2827 6631 272c 202e   Feature('f1', .
+00002780: 2e2e 295d 0a20 2020 2020 2020 2020 2020  ..)].           
+00002790: 2060 6060 0a0a 2020 2020 2020 2020 2320   ```..        # 
+000027a0: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
+000027b0: 2020 2020 2020 6665 6174 7572 6573 3a20        features: 
+000027c0: 4120 6c69 7374 206f 6620 6046 6561 7475  A list of `Featu
+000027d0: 7265 6020 6f62 6a65 6374 7320 6f72 2066  re` objects or f
+000027e0: 6561 7475 7265 206e 616d 6573 2061 730a  eature names as.
+000027f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002800: 7374 7269 6e67 7320 746f 2062 6520 6578  strings to be ex
+00002810: 636c 7564 6564 2066 726f 6d20 7468 6520  cluded from the 
+00002820: 7365 6c65 6374 696f 6e2e 2044 6566 6175  selection. Defau
+00002830: 6c74 7320 746f 205b 5d2c 0a20 2020 2020  lts to [],.     
+00002840: 2020 2020 2020 2020 2020 2073 656c 6563             selec
+00002850: 7469 6e67 2061 6c6c 2066 6561 7475 7265  ting all feature
+00002860: 732e 0a0a 2020 2020 2020 2020 2320 5265  s...        # Re
+00002870: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
+00002880: 2020 6051 7565 7279 603a 2041 2071 7565    `Query`: A que
+00002890: 7279 206f 626a 6563 7420 7769 7468 2074  ry object with t
+000028a0: 6865 2073 656c 6563 7465 6420 6665 6174  he selected feat
+000028b0: 7572 6573 206f 6620 7468 6520 6665 6174  ures of the feat
+000028c0: 7572 6520 6772 6f75 702e 0a20 2020 2020  ure group..     
+000028d0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+000028e0: 6620 6665 6174 7572 6573 3a0a 2020 2020  f features:.    
+000028f0: 2020 2020 2020 2020 6578 6365 7074 5f66          except_f
+00002900: 6561 7475 7265 7320 3d20 5b0a 2020 2020  eatures = [.    
+00002910: 2020 2020 2020 2020 2020 2020 662e 6e61              f.na
+00002920: 6d65 2069 6620 6973 696e 7374 616e 6365  me if isinstance
+00002930: 2866 2c20 6665 6174 7572 652e 4665 6174  (f, feature.Feat
+00002940: 7572 6529 2065 6c73 6520 6620 666f 7220  ure) else f for 
+00002950: 6620 696e 2066 6561 7475 7265 730a 2020  f in features.  
+00002960: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+00002970: 2020 2020 2020 2020 7265 7475 726e 2071          return q
+00002980: 7565 7279 2e51 7565 7279 280a 2020 2020  uery.Query(.    
+00002990: 2020 2020 2020 2020 2020 2020 6c65 6674              left
+000029a0: 5f66 6561 7475 7265 5f67 726f 7570 3d73  _feature_group=s
+000029b0: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+000029c0: 2020 2020 206c 6566 745f 6665 6174 7572       left_featur
+000029d0: 6573 3d5b 0a20 2020 2020 2020 2020 2020  es=[.           
+000029e0: 2020 2020 2020 2020 2066 2066 6f72 2066           f for f
+000029f0: 2069 6e20 7365 6c66 2e5f 6665 6174 7572   in self._featur
+00002a00: 6573 2069 6620 662e 6e61 6d65 206e 6f74  es if f.name not
+00002a10: 2069 6e20 6578 6365 7074 5f66 6561 7475   in except_featu
+00002a20: 7265 730a 2020 2020 2020 2020 2020 2020  res.            
+00002a30: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
+00002a40: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00002a50: 746f 7265 5f6e 616d 653d 7365 6c66 2e5f  tore_name=self._
+00002a60: 6665 6174 7572 655f 7374 6f72 655f 6e61  feature_store_na
+00002a70: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00002a80: 2020 2020 6665 6174 7572 655f 7374 6f72      feature_stor
+00002a90: 655f 6964 3d73 656c 662e 5f66 6561 7475  e_id=self._featu
+00002aa0: 7265 5f73 746f 7265 5f69 642c 0a20 2020  re_store_id,.   
+00002ab0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00002ac0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00002ad0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00002ae0: 2e73 656c 6563 745f 616c 6c28 290a 0a20  .select_all().. 
+00002af0: 2020 2064 6566 2066 696c 7465 7228 7365     def filter(se
+00002b00: 6c66 2c20 663a 2055 6e69 6f6e 5b66 696c  lf, f: Union[fil
+00002b10: 7465 722e 4669 6c74 6572 2c20 6669 6c74  ter.Filter, filt
+00002b20: 6572 2e4c 6f67 6963 5d29 3a0a 2020 2020  er.Logic]):.    
+00002b30: 2020 2020 2222 2241 7070 6c79 2066 696c      """Apply fil
+00002b40: 7465 7220 746f 2074 6865 2066 6561 7475  ter to the featu
+00002b50: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
+00002b60: 2020 2053 656c 6563 7473 2061 6c6c 2066     Selects all f
+00002b70: 6561 7475 7265 7320 616e 6420 7265 7475  eatures and retu
+00002b80: 726e 7320 7468 6520 7265 7375 6c74 696e  rns the resultin
+00002b90: 6720 6051 7565 7279 6020 7769 7468 2074  g `Query` with t
+00002ba0: 6865 2061 7070 6c69 6564 2066 696c 7465  he applied filte
+00002bb0: 722e 0a20 2020 2020 2020 2021 2121 2065  r..        !!! e
+00002bc0: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+00002bd0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+00002be0: 2020 2020 2020 2020 2066 726f 6d20 6873           from hs
+00002bf0: 6673 2e66 6561 7475 7265 2069 6d70 6f72  fs.feature impor
+00002c00: 7420 4665 6174 7572 650a 0a20 2020 2020  t Feature..     
+00002c10: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+00002c20: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+00002c30: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+00002c40: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+00002c50: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+00002c60: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+00002c70: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+00002c80: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+00002c90: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+00002ca0: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
+00002cb0: 2020 2020 2020 2020 2020 2066 672e 6669             fg.fi
+00002cc0: 6c74 6572 2846 6561 7475 7265 2822 7765  lter(Feature("we
+00002cd0: 656b 6c79 5f73 616c 6573 2229 203e 2031  ekly_sales") > 1
+00002ce0: 3030 3029 0a20 2020 2020 2020 2020 2020  000).           
+00002cf0: 2060 6060 0a0a 2020 2020 2020 2020 4966   ```..        If
+00002d00: 2079 6f75 2061 7265 2070 6c61 6e6e 696e   you are plannin
+00002d10: 6720 746f 206a 6f69 6e20 7468 6520 6669  g to join the fi
+00002d20: 6c74 6572 6564 2066 6561 7475 7265 2067  ltered feature g
+00002d30: 726f 7570 206c 6174 6572 206f 6e20 7769  roup later on wi
+00002d40: 7468 2061 6e6f 7468 6572 0a20 2020 2020  th another.     
+00002d50: 2020 2066 6561 7475 7265 2067 726f 7570     feature group
+00002d60: 2c20 6d61 6b65 2073 7572 6520 746f 2073  , make sure to s
+00002d70: 656c 6563 7420 7468 6520 6669 6c74 6572  elect the filter
+00002d80: 6564 2066 6561 7475 7265 2065 7870 6c69  ed feature expli
+00002d90: 6369 746c 7920 6672 6f6d 2074 6865 0a20  citly from the. 
+00002da0: 2020 2020 2020 2072 6573 7065 6374 6976         respectiv
+00002db0: 6520 6665 6174 7572 6520 6772 6f75 703a  e feature group:
+00002dc0: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+00002dd0: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+00002de0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00002df0: 2020 2020 2020 2066 672e 6669 6c74 6572         fg.filter
+00002e00: 2866 672e 6665 6174 7572 6531 203d 3d20  (fg.feature1 == 
+00002e10: 3129 2e73 686f 7728 3130 290a 2020 2020  1).show(10).    
+00002e20: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+00002e30: 2020 2020 2043 6f6d 706f 7369 7465 2066       Composite f
+00002e40: 696c 7465 7273 2072 6571 7569 7265 2070  ilters require p
+00002e50: 6172 656e 7468 6573 6973 3a0a 2020 2020  arenthesis:.    
+00002e60: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
+00002e70: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+00002e80: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
+00002e90: 2020 6667 2e66 696c 7465 7228 2866 672e    fg.filter((fg.
+00002ea0: 6665 6174 7572 6531 203d 3d20 3129 207c  feature1 == 1) |
+00002eb0: 2028 6667 2e66 6561 7475 7265 3220 3e3d   (fg.feature2 >=
+00002ec0: 2032 2929 0a20 2020 2020 2020 2020 2020   2)).           
+00002ed0: 2060 6060 0a0a 2020 2020 2020 2020 2320   ```..        # 
+00002ee0: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
+00002ef0: 2020 2020 2020 663a 2046 696c 7465 7220        f: Filter 
+00002f00: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
+00002f10: 2023 2052 6574 7572 6e73 0a20 2020 2020   # Returns.     
+00002f20: 2020 2020 2020 2060 5175 6572 7960 2e20         `Query`. 
+00002f30: 5468 6520 7175 6572 7920 6f62 6a65 6374  The query object
+00002f40: 2077 6974 6820 7468 6520 6170 706c 6965   with the applie
+00002f50: 6420 6669 6c74 6572 2e0a 2020 2020 2020  d filter..      
+00002f60: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00002f70: 7475 726e 2073 656c 662e 7365 6c65 6374  turn self.select
+00002f80: 5f61 6c6c 2829 2e66 696c 7465 7228 6629  _all().filter(f)
+00002f90: 0a0a 2020 2020 6465 6620 6164 645f 7461  ..    def add_ta
+00002fa0: 6728 7365 6c66 2c20 6e61 6d65 3a20 7374  g(self, name: st
+00002fb0: 722c 2076 616c 7565 293a 0a20 2020 2020  r, value):.     
+00002fc0: 2020 2022 2222 4174 7461 6368 2061 2074     """Attach a t
+00002fd0: 6167 2074 6f20 6120 6665 6174 7572 6520  ag to a feature 
+00002fe0: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+00002ff0: 4120 7461 6720 636f 6e73 6973 7473 206f  A tag consists o
+00003000: 6620 6120 3c6e 616d 652c 7661 6c75 653e  f a <name,value>
+00003010: 2070 6169 722e 2054 6167 206e 616d 6573   pair. Tag names
+00003020: 2061 7265 2075 6e69 7175 6520 6964 656e   are unique iden
+00003030: 7469 6669 6572 7320 6163 726f 7373 2074  tifiers across t
+00003040: 6865 2077 686f 6c65 2063 6c75 7374 6572  he whole cluster
+00003050: 2e0a 2020 2020 2020 2020 5468 6520 7661  ..        The va
+00003060: 6c75 6520 6f66 2061 2074 6167 2063 616e  lue of a tag can
+00003070: 2062 6520 616e 7920 7661 6c69 6420 6a73   be any valid js
+00003080: 6f6e 202d 2070 7269 6d69 7469 7665 732c  on - primitives,
+00003090: 2061 7272 6179 7320 6f72 206a 736f 6e20   arrays or json 
+000030a0: 6f62 6a65 6374 732e 0a0a 2020 2020 2020  objects...      
+000030b0: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
+000030c0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+000030d0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+000030e0: 2320 636f 6e6e 6563 7420 746f 2074 6865  # connect to the
+000030f0: 2046 6561 7475 7265 2053 746f 7265 0a20   Feature Store. 
+00003100: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
+00003110: 2e2e 2e0a 0a20 2020 2020 2020 2020 2020  .....           
+00003120: 2023 2067 6574 2074 6865 2046 6561 7475   # get the Featu
+00003130: 7265 2047 726f 7570 2069 6e73 7461 6e63  re Group instanc
+00003140: 650a 2020 2020 2020 2020 2020 2020 6667  e.            fg
+00003150: 203d 2066 732e 6765 745f 6f72 5f63 7265   = fs.get_or_cre
+00003160: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
+00003170: 7028 2e2e 2e29 0a0a 2020 2020 2020 2020  p(...)..        
+00003180: 2020 2020 6667 2e61 6464 5f74 6167 286e      fg.add_tag(n
+00003190: 616d 653d 2265 7861 6d70 6c65 5f74 6167  ame="example_tag
+000031a0: 222c 2076 616c 7565 3d22 3432 2229 0a20  ", value="42"). 
+000031b0: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+000031c0: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+000031d0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+000031e0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
+000031f0: 6520 7461 6720 746f 2062 6520 6164 6465  e tag to be adde
+00003200: 642e 0a20 2020 2020 2020 2020 2020 2076  d..            v
+00003210: 616c 7565 3a20 5661 6c75 6520 6f66 2074  alue: Value of t
+00003220: 6865 2074 6167 2074 6f20 6265 2061 6464  he tag to be add
+00003230: 6564 2e0a 0a20 2020 2020 2020 2023 2052  ed...        # R
+00003240: 6169 7365 730a 2020 2020 2020 2020 2020  aises.          
+00003250: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
+00003260: 7863 6570 7469 6f6e 732e 5265 7374 4150  xceptions.RestAP
+00003270: 4945 7272 6f72 6020 696e 2063 6173 6520  IError` in case 
+00003280: 7468 6520 6261 636b 656e 6420 6661 696c  the backend fail
+00003290: 7320 746f 2061 6464 2074 6865 2074 6167  s to add the tag
+000032a0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+000032b0: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
+000032c0: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
+000032d0: 652e 6164 645f 7461 6728 7365 6c66 2c20  e.add_tag(self, 
+000032e0: 6e61 6d65 2c20 7661 6c75 6529 0a0a 2020  name, value)..  
+000032f0: 2020 6465 6620 6465 6c65 7465 5f74 6167    def delete_tag
+00003300: 2873 656c 662c 206e 616d 653a 2073 7472  (self, name: str
+00003310: 293a 0a20 2020 2020 2020 2022 2222 4465  ):.        """De
+00003320: 6c65 7465 2061 2074 6167 2061 7474 6163  lete a tag attac
+00003330: 6865 6420 746f 2061 2066 6561 7475 7265  hed to a feature
+00003340: 2067 726f 7570 2e0a 0a20 2020 2020 2020   group...       
+00003350: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+00003360: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00003370: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
+00003380: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
+00003390: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
+000033a0: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
+000033b0: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
+000033c0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
+000033d0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
+000033e0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+000033f0: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
+00003400: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+00003410: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
+00003420: 2020 2066 672e 6465 6c65 7465 5f74 6167     fg.delete_tag
+00003430: 2822 6578 616d 706c 655f 7461 6722 290a  ("example_tag").
+00003440: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+00003450: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
+00003460: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+00003470: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
+00003480: 6865 2074 6167 2074 6f20 6265 2072 656d  he tag to be rem
+00003490: 6f76 6564 2e0a 0a20 2020 2020 2020 2023  oved...        #
+000034a0: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
+000034b0: 2020 2020 6068 7366 732e 636c 6965 6e74      `hsfs.client
+000034c0: 2e65 7863 6570 7469 6f6e 732e 5265 7374  .exceptions.Rest
+000034d0: 4150 4945 7272 6f72 6020 696e 2063 6173  APIError` in cas
+000034e0: 6520 7468 6520 6261 636b 656e 6420 6661  e the backend fa
+000034f0: 696c 7320 746f 2064 656c 6574 6520 7468  ils to delete th
+00003500: 6520 7461 672e 0a20 2020 2020 2020 2022  e tag..        "
+00003510: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00003520: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
+00003530: 6e67 696e 652e 6465 6c65 7465 5f74 6167  ngine.delete_tag
+00003540: 2873 656c 662c 206e 616d 6529 0a0a 2020  (self, name)..  
+00003550: 2020 6465 6620 6765 745f 7461 6728 7365    def get_tag(se
+00003560: 6c66 2c20 6e61 6d65 3a20 7374 7229 3a0a  lf, name: str):.
+00003570: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+00003580: 6865 2074 6167 7320 6f66 2061 2066 6561  he tags of a fea
+00003590: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
+000035a0: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
+000035b0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+000035c0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+000035d0: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
+000035e0: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
+000035f0: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
+00003600: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
+00003610: 2020 2020 2320 6765 7420 7468 6520 4665      # get the Fe
+00003620: 6174 7572 6520 4772 6f75 7020 696e 7374  ature Group inst
+00003630: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
+00003640: 2066 6720 3d20 6673 2e67 6574 5f6f 725f   fg = fs.get_or_
+00003650: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
+00003660: 726f 7570 282e 2e2e 290a 0a20 2020 2020  roup(...)..     
+00003670: 2020 2020 2020 2066 675f 7461 675f 7661         fg_tag_va
+00003680: 6c75 6520 3d20 6667 2e67 6574 5f74 6167  lue = fg.get_tag
+00003690: 2822 6578 616d 706c 655f 7461 6722 290a  ("example_tag").
+000036a0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+000036b0: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
+000036c0: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+000036d0: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
+000036e0: 6865 2074 6167 2074 6f20 6765 742e 0a0a  he tag to get...
+000036f0: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
+00003700: 730a 2020 2020 2020 2020 2020 2020 7461  s.            ta
+00003710: 6720 7661 6c75 650a 0a20 2020 2020 2020  g value..       
+00003720: 2023 2052 6169 7365 730a 2020 2020 2020   # Raises.      
+00003730: 2020 2020 2020 6068 7366 732e 636c 6965        `hsfs.clie
+00003740: 6e74 2e65 7863 6570 7469 6f6e 732e 5265  nt.exceptions.Re
+00003750: 7374 4150 4945 7272 6f72 6020 696e 2063  stAPIError` in c
+00003760: 6173 6520 7468 6520 6261 636b 656e 6420  ase the backend 
+00003770: 6661 696c 7320 746f 2072 6574 7269 6576  fails to retriev
+00003780: 6520 7468 6520 7461 672e 0a20 2020 2020  e the tag..     
+00003790: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+000037a0: 6574 7572 6e20 7365 6c66 2e5f 6665 6174  eturn self._feat
+000037b0: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
+000037c0: 2e67 6574 5f74 6167 2873 656c 662c 206e  .get_tag(self, n
+000037d0: 616d 6529 0a0a 2020 2020 6465 6620 6765  ame)..    def ge
+000037e0: 745f 7461 6773 2873 656c 6629 3a0a 2020  t_tags(self):.  
+000037f0: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+00003800: 6573 2061 6c6c 2074 6167 7320 6174 7461  es all tags atta
+00003810: 6368 6564 2074 6f20 6120 6665 6174 7572  ched to a featur
+00003820: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
+00003830: 2020 2320 5265 7475 726e 730a 2020 2020    # Returns.    
+00003840: 2020 2020 2020 2020 6044 6963 745b 7374          `Dict[st
+00003850: 722c 206f 626a 5d60 206f 6620 7461 6773  r, obj]` of tags
+00003860: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
+00003870: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+00003880: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+00003890: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+000038a0: 7272 6f72 6020 696e 2063 6173 6520 7468  rror` in case th
+000038b0: 6520 6261 636b 656e 6420 6661 696c 7320  e backend fails 
+000038c0: 746f 2072 6574 7269 6576 6520 7468 6520  to retrieve the 
+000038d0: 7461 6773 2e0a 2020 2020 2020 2020 2222  tags..        ""
+000038e0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+000038f0: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+00003900: 726f 7570 5f65 6e67 696e 652e 6765 745f  roup_engine.get_
+00003910: 7461 6773 2873 656c 6629 0a0a 2020 2020  tags(self)..    
+00003920: 6465 6620 6765 745f 7061 7265 6e74 5f66  def get_parent_f
+00003930: 6561 7475 7265 5f67 726f 7570 7328 7365  eature_groups(se
+00003940: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00003950: 4765 7420 7468 6520 7061 7265 6e74 7320  Get the parents 
+00003960: 6f66 2074 6869 7320 6665 6174 7572 6520  of this feature 
+00003970: 6772 6f75 702c 2062 6173 6564 206f 6e20  group, based on 
+00003980: 6578 706c 6963 6974 2070 726f 7665 6e61  explicit provena
+00003990: 6e63 652e 0a20 2020 2020 2020 2050 6172  nce..        Par
+000039a0: 656e 7473 2061 7265 2066 6561 7475 7265  ents are feature
+000039b0: 2067 726f 7570 7320 6f72 2065 7874 6572   groups or exter
+000039c0: 6e61 6c20 6665 6174 7572 6520 6772 6f75  nal feature grou
+000039d0: 7073 2e20 5468 6573 6520 6665 6174 7572  ps. These featur
+000039e0: 650a 2020 2020 2020 2020 6772 6f75 7073  e.        groups
+000039f0: 2063 616e 2062 6520 6163 6365 7373 6962   can be accessib
+00003a00: 6c65 2c20 6465 6c65 7465 6420 6f72 2069  le, deleted or i
+00003a10: 6e61 6363 6573 7369 626c 652e 0a20 2020  naccessible..   
+00003a20: 2020 2020 2046 6f72 2064 656c 6574 6564       For deleted
+00003a30: 2061 6e64 2069 6e61 6363 6573 7369 626c   and inaccessibl
+00003a40: 6520 6665 6174 7572 6520 6772 6f75 7073  e feature groups
+00003a50: 2c20 6f6e 6c79 2061 206d 696e 696d 616c  , only a minimal
+00003a60: 2069 6e66 6f72 6d61 7469 6f6e 2069 730a   information is.
+00003a70: 2020 2020 2020 2020 7265 7475 726e 6564          returned
+00003a80: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
+00003a90: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
+00003aa0: 2060 5072 6f76 656e 616e 6365 4c69 6e6b   `ProvenanceLink
+00003ab0: 7360 3a20 4f62 6a65 6374 2063 6f6e 7461  s`: Object conta
+00003ac0: 696e 696e 6720 7468 6520 7365 6374 696f  ining the sectio
+00003ad0: 6e20 6f66 2070 726f 7665 6e61 6e63 6520  n of provenance 
+00003ae0: 6772 6170 6820 7265 7175 6573 7465 642e  graph requested.
+00003af0: 0a0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
+00003b00: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
+00003b10: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
+00003b20: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
+00003b30: 726f 7260 2e0a 2020 2020 2020 2020 2222  ror`..        ""
+00003b40: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00003b50: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+00003b60: 726f 7570 5f65 6e67 696e 652e 6765 745f  roup_engine.get_
+00003b70: 7061 7265 6e74 5f66 6561 7475 7265 5f67  parent_feature_g
+00003b80: 726f 7570 7328 7365 6c66 290a 0a20 2020  roups(self)..   
+00003b90: 2064 6566 2067 6574 5f67 656e 6572 6174   def get_generat
+00003ba0: 6564 5f66 6561 7475 7265 5f76 6965 7773  ed_feature_views
+00003bb0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00003bc0: 2222 2247 6574 2074 6865 2067 656e 6572  """Get the gener
+00003bd0: 6174 6564 2066 6561 7475 7265 2076 6965  ated feature vie
+00003be0: 7720 7573 696e 6720 7468 6973 2066 6561  w using this fea
+00003bf0: 7475 7265 2067 726f 7570 2c20 6261 7365  ture group, base
+00003c00: 6420 6f6e 2065 7870 6c69 6369 740a 2020  d on explicit.  
+00003c10: 2020 2020 2020 7072 6f76 656e 616e 6365        provenance
+00003c20: 2e20 5468 6573 6520 6665 6174 7572 6520  . These feature 
+00003c30: 7669 6577 7320 6361 6e20 6265 2061 6363  views can be acc
+00003c40: 6573 7369 626c 6520 6f72 2069 6e61 6363  essible or inacc
+00003c50: 6573 7369 626c 652e 2045 7870 6c69 6369  essible. Explici
+00003c60: 740a 2020 2020 2020 2020 7072 6f76 656e  t.        proven
+00003c70: 616e 6365 2064 6f65 7320 6e6f 7420 7472  ance does not tr
+00003c80: 6163 6b20 6465 6c65 7465 6420 6765 6e65  ack deleted gene
+00003c90: 7261 7465 6420 6665 6174 7572 6520 7669  rated feature vi
+00003ca0: 6577 206c 696e 6b73 2c20 736f 2064 656c  ew links, so del
+00003cb0: 6574 6564 0a20 2020 2020 2020 2077 696c  eted.        wil
+00003cc0: 6c20 616c 7761 7973 2062 6520 656d 7074  l always be empt
+00003cd0: 792e 0a20 2020 2020 2020 2046 6f72 2069  y..        For i
+00003ce0: 6e61 6363 6573 7369 626c 6520 6665 6174  naccessible feat
+00003cf0: 7572 6520 7669 6577 732c 206f 6e6c 7920  ure views, only 
+00003d00: 6120 6d69 6e69 6d61 6c20 696e 666f 726d  a minimal inform
+00003d10: 6174 696f 6e20 6973 2072 6574 7572 6e65  ation is returne
+00003d20: 642e 0a0a 2020 2020 2020 2020 2320 5265  d...        # Re
+00003d30: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
+00003d40: 2020 6050 726f 7665 6e61 6e63 654c 696e    `ProvenanceLin
+00003d50: 6b73 603a 204f 626a 6563 7420 636f 6e74  ks`: Object cont
+00003d60: 6169 6e69 6e67 2074 6865 2073 6563 7469  aining the secti
+00003d70: 6f6e 206f 6620 7072 6f76 656e 616e 6365  on of provenance
+00003d80: 2067 7261 7068 2072 6571 7565 7374 6564   graph requested
+00003d90: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
+00003da0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+00003db0: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+00003dc0: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+00003dd0: 7272 6f72 602e 0a20 2020 2020 2020 2022  rror`..        "
+00003de0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00003df0: 6e20 7365 6c66 2e5f 6665 6174 7572 655f  n self._feature_
+00003e00: 6772 6f75 705f 656e 6769 6e65 2e67 6574  group_engine.get
+00003e10: 5f67 656e 6572 6174 6564 5f66 6561 7475  _generated_featu
+00003e20: 7265 5f76 6965 7773 2873 656c 6629 0a0a  re_views(self)..
+00003e30: 2020 2020 6465 6620 6765 745f 6765 6e65      def get_gene
+00003e40: 7261 7465 645f 6665 6174 7572 655f 6772  rated_feature_gr
+00003e50: 6f75 7073 2873 656c 6629 3a0a 2020 2020  oups(self):.    
+00003e60: 2020 2020 2222 2247 6574 2074 6865 2067      """Get the g
+00003e70: 656e 6572 6174 6564 2066 6561 7475 7265  enerated feature
+00003e80: 2067 726f 7570 7320 7573 696e 6720 7468   groups using th
+00003e90: 6973 2066 6561 7475 7265 2067 726f 7570  is feature group
+00003ea0: 2c20 6261 7365 6420 6f6e 2065 7870 6c69  , based on expli
+00003eb0: 6369 740a 2020 2020 2020 2020 7072 6f76  cit.        prov
+00003ec0: 656e 616e 6365 2e20 5468 6573 6520 6665  enance. These fe
+00003ed0: 6174 7572 6520 6772 6f75 7073 2063 616e  ature groups can
+00003ee0: 2062 6520 6163 6365 7373 6962 6c65 206f   be accessible o
+00003ef0: 7220 696e 6163 6365 7373 6962 6c65 2e20  r inaccessible. 
+00003f00: 4578 706c 6963 6974 0a20 2020 2020 2020  Explicit.       
+00003f10: 2070 726f 7665 6e61 6e63 6520 646f 6573   provenance does
+00003f20: 206e 6f74 2074 7261 636b 2064 656c 6574   not track delet
+00003f30: 6564 2067 656e 6572 6174 6564 2066 6561  ed generated fea
+00003f40: 7475 7265 2067 726f 7570 206c 696e 6b73  ture group links
+00003f50: 2c20 736f 2064 656c 6574 6564 0a20 2020  , so deleted.   
+00003f60: 2020 2020 2077 696c 6c20 616c 7761 7973       will always
+00003f70: 2062 6520 656d 7074 792e 0a20 2020 2020   be empty..     
+00003f80: 2020 2046 6f72 2069 6e61 6363 6573 7369     For inaccessi
+00003f90: 626c 6520 6665 6174 7572 6520 6772 6f75  ble feature grou
+00003fa0: 7073 2c20 6f6e 6c79 2061 206d 696e 696d  ps, only a minim
+00003fb0: 616c 2069 6e66 6f72 6d61 7469 6f6e 2069  al information i
+00003fc0: 7320 7265 7475 726e 6564 2e0a 0a20 2020  s returned...   
+00003fd0: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
+00003fe0: 2020 2020 2020 2020 2020 2060 5072 6f76             `Prov
+00003ff0: 656e 616e 6365 4c69 6e6b 7360 3a20 4f62  enanceLinks`: Ob
+00004000: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
+00004010: 7468 6520 7365 6374 696f 6e20 6f66 2070  the section of p
+00004020: 726f 7665 6e61 6e63 6520 6772 6170 6820  rovenance graph 
+00004030: 7265 7175 6573 7465 642e 0a0a 2020 2020  requested...    
+00004040: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+00004050: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+00004060: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+00004070: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
+00004080: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00004090: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000040a0: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
+000040b0: 6e67 696e 652e 6765 745f 6765 6e65 7261  ngine.get_genera
+000040c0: 7465 645f 6665 6174 7572 655f 6772 6f75  ted_feature_grou
+000040d0: 7073 2873 656c 6629 0a0a 2020 2020 6465  ps(self)..    de
+000040e0: 6620 6765 745f 6665 6174 7572 6528 7365  f get_feature(se
+000040f0: 6c66 2c20 6e61 6d65 3a20 7374 7229 3a0a  lf, name: str):.
+00004100: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+00004110: 6576 6520 6120 6046 6561 7475 7265 6020  eve a `Feature` 
+00004120: 6f62 6a65 6374 2066 726f 6d20 7468 6520  object from the 
+00004130: 7363 6865 6d61 206f 6620 7468 6520 6665  schema of the fe
+00004140: 6174 7572 6520 6772 6f75 702e 0a0a 2020  ature group...  
+00004150: 2020 2020 2020 5468 6572 6520 6172 6520        There are 
+00004160: 7365 7665 7261 6c20 7761 7973 2074 6f20  several ways to 
+00004170: 6163 6365 7373 2066 6561 7475 7265 7320  access features 
+00004180: 6f66 2061 2066 6561 7475 7265 2067 726f  of a feature gro
+00004190: 7570 3a0a 0a20 2020 2020 2020 2021 2121  up:..        !!!
+000041a0: 2065 7861 6d70 6c65 0a20 2020 2020 2020   example.       
+000041b0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+000041c0: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
+000041d0: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
+000041e0: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
+000041f0: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
+00004200: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
+00004210: 7420 7468 6520 4665 6174 7572 6520 4772  t the Feature Gr
+00004220: 6f75 7020 696e 7374 616e 6365 0a20 2020  oup instance.   
+00004230: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
+00004240: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
+00004250: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
+00004260: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00004270: 2067 6574 2046 6561 7475 7265 2069 6e73   get Feature ins
+00004280: 7461 6e73 650a 2020 2020 2020 2020 2020  tanse.          
+00004290: 2020 6667 2e66 6561 7475 7265 310a 2020    fg.feature1.  
+000042a0: 2020 2020 2020 2020 2020 6667 5b22 6665            fg["fe
+000042b0: 6174 7572 6531 225d 0a20 2020 2020 2020  ature1"].       
+000042c0: 2020 2020 2066 672e 6765 745f 6665 6174       fg.get_feat
+000042d0: 7572 6528 2266 6561 7475 7265 3122 290a  ure("feature1").
+000042e0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+000042f0: 0a20 2020 2020 2020 2021 2121 206e 6f74  .        !!! not
+00004300: 650a 2020 2020 2020 2020 2020 2020 4174  e.            At
+00004310: 7472 6962 7574 6520 6163 6365 7373 2074  tribute access t
+00004320: 6f20 6665 6174 7572 6573 2077 6f72 6b73  o features works
+00004330: 206f 6e6c 7920 666f 7220 6e6f 6e2d 7265   only for non-re
+00004340: 7365 7276 6564 206e 616d 6573 2e20 466f  served names. Fo
+00004350: 7220 6578 616d 706c 650a 2020 2020 2020  r example.      
+00004360: 2020 2020 2020 6665 6174 7572 6573 206e        features n
+00004370: 616d 6564 2060 6964 6020 6f72 2060 6e61  amed `id` or `na
+00004380: 6d65 6020 7769 6c6c 206e 6f74 2062 6520  me` will not be 
+00004390: 6163 6365 7373 6962 6c65 2076 6961 2060  accessible via `
+000043a0: 6667 2e6e 616d 6560 2c20 696e 7374 6561  fg.name`, instea
+000043b0: 640a 2020 2020 2020 2020 2020 2020 7468  d.            th
+000043c0: 6973 2077 696c 6c20 7265 7475 726e 2074  is will return t
+000043d0: 6865 206e 616d 6520 6f66 2074 6865 2066  he name of the f
+000043e0: 6561 7475 7265 2067 726f 7570 2069 7473  eature group its
+000043f0: 656c 662e 2046 616c 6c20 6261 636b 206f  elf. Fall back o
+00004400: 6e20 7573 696e 670a 2020 2020 2020 2020  n using.        
+00004410: 2020 2020 7468 6520 6067 6574 5f66 6561      the `get_fea
+00004420: 7475 7265 6020 6d65 7468 6f64 2e0a 0a20  ture` method... 
+00004430: 2020 2020 2020 2023 2041 7267 756d 656e         # Argumen
+00004440: 7473 3a0a 2020 2020 2020 2020 2020 2020  ts:.            
+00004450: 6e61 6d65 3a20 5468 6520 6e61 6d65 206f  name: The name o
+00004460: 6620 7468 6520 6665 6174 7572 6520 746f  f the feature to
+00004470: 2072 6574 7269 6576 650a 0a20 2020 2020   retrieve..     
+00004480: 2020 2023 2052 6574 7572 6e73 3a0a 2020     # Returns:.  
+00004490: 2020 2020 2020 2020 2020 4665 6174 7572            Featur
+000044a0: 653a 2054 6865 2066 6561 7475 7265 206f  e: The feature o
+000044b0: 626a 6563 740a 0a20 2020 2020 2020 2023  bject..        #
+000044c0: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
+000044d0: 2020 2020 6068 7366 732e 636c 6965 6e74      `hsfs.client
+000044e0: 2e65 7863 6570 7469 6f6e 732e 4665 6174  .exceptions.Feat
+000044f0: 7572 6553 746f 7265 4578 6365 7074 696f  ureStoreExceptio
+00004500: 6e60 2e0a 2020 2020 2020 2020 2222 220a  n`..        """.
+00004510: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00004520: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00004530: 7365 6c66 2e5f 5f67 6574 6974 656d 5f5f  self.__getitem__
+00004540: 286e 616d 6529 0a20 2020 2020 2020 2065  (name).        e
+00004550: 7863 6570 7420 4b65 7945 7272 6f72 3a0a  xcept KeyError:.
+00004560: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00004570: 6520 4665 6174 7572 6553 746f 7265 4578  e FeatureStoreEx
+00004580: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+00004590: 2020 2020 2020 2020 2066 2227 4665 6174           f"'Feat
+000045a0: 7572 6547 726f 7570 2720 6f62 6a65 6374  ureGroup' object
+000045b0: 2068 6173 206e 6f20 6665 6174 7572 6520   has no feature 
+000045c0: 6361 6c6c 6564 2027 7b6e 616d 657d 272e  called '{name}'.
+000045d0: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+000045e0: 0a20 2020 2064 6566 2075 7064 6174 655f  .    def update_
+000045f0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+00004600: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
+00004610: 2022 2222 5570 6461 7465 2074 6865 2073   """Update the s
+00004620: 7461 7469 7374 6963 7320 636f 6e66 6967  tatistics config
+00004630: 7572 6174 696f 6e20 6f66 2074 6865 2066  uration of the f
+00004640: 6561 7475 7265 2067 726f 7570 2e0a 0a20  eature group... 
+00004650: 2020 2020 2020 2043 6861 6e67 6520 7468         Change th
+00004660: 6520 6073 7461 7469 7374 6963 735f 636f  e `statistics_co
+00004670: 6e66 6967 6020 6f62 6a65 6374 2061 6e64  nfig` object and
+00004680: 2070 6572 7369 7374 2074 6865 2063 6861   persist the cha
+00004690: 6e67 6573 2062 7920 6361 6c6c 696e 670a  nges by calling.
+000046a0: 2020 2020 2020 2020 7468 6973 206d 6574          this met
+000046b0: 686f 642e 0a0a 2020 2020 2020 2020 2121  hod...        !!
+000046c0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+000046d0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+000046e0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+000046f0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+00004700: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+00004710: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+00004720: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+00004730: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+00004740: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+00004750: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+00004760: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+00004770: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+00004780: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+00004790: 6667 2e75 7064 6174 655f 7374 6174 6973  fg.update_statis
+000047a0: 7469 6373 5f63 6f6e 6669 6728 290a 2020  tics_config().  
+000047b0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
+000047c0: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
+000047d0: 0a20 2020 2020 2020 2020 2020 2060 4665  .            `Fe
+000047e0: 6174 7572 6547 726f 7570 602e 2054 6865  atureGroup`. The
+000047f0: 2075 7064 6174 6564 206d 6574 6164 6174   updated metadat
+00004800: 6120 6f62 6a65 6374 206f 6620 7468 6520  a object of the 
+00004810: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
+00004820: 2020 2020 2020 2020 2320 5261 6973 6573          # Raises
+00004830: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
+00004840: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
+00004850: 696f 6e73 2e52 6573 7441 5049 4572 726f  ions.RestAPIErro
+00004860: 7260 2e0a 2020 2020 2020 2020 2222 220a  r`..        """.
+00004870: 2020 2020 2020 2020 7365 6c66 2e5f 6665          self._fe
+00004880: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
+00004890: 6e65 2e75 7064 6174 655f 7374 6174 6973  ne.update_statis
+000048a0: 7469 6373 5f63 6f6e 6669 6728 7365 6c66  tics_config(self
+000048b0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000048c0: 2073 656c 660a 0a20 2020 2064 6566 2075   self..    def u
+000048d0: 7064 6174 655f 6465 7363 7269 7074 696f  pdate_descriptio
+000048e0: 6e28 7365 6c66 2c20 6465 7363 7269 7074  n(self, descript
+000048f0: 696f 6e3a 2073 7472 293a 0a20 2020 2020  ion: str):.     
+00004900: 2020 2022 2222 5570 6461 7465 2074 6865     """Update the
+00004910: 2064 6573 6372 6970 7469 6f6e 206f 6620   description of 
+00004920: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+00004930: 702e 0a0a 2020 2020 2020 2020 2121 2120  p...        !!! 
+00004940: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
+00004950: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+00004960: 2020 2020 2020 2020 2020 2320 636f 6e6e            # conn
+00004970: 6563 7420 746f 2074 6865 2046 6561 7475  ect to the Featu
+00004980: 7265 2053 746f 7265 0a20 2020 2020 2020  re Store.       
+00004990: 2020 2020 2066 7320 3d20 2e2e 2e0a 0a20       fs = ..... 
+000049a0: 2020 2020 2020 2020 2020 2023 2067 6574             # get
+000049b0: 2074 6865 2046 6561 7475 7265 2047 726f   the Feature Gro
+000049c0: 7570 2069 6e73 7461 6e63 650a 2020 2020  up instance.    
+000049d0: 2020 2020 2020 2020 6667 203d 2066 732e          fg = fs.
+000049e0: 6765 745f 6f72 5f63 7265 6174 655f 6665  get_or_create_fe
+000049f0: 6174 7572 655f 6772 6f75 7028 2e2e 2e29  ature_group(...)
+00004a00: 0a0a 2020 2020 2020 2020 2020 2020 6667  ..            fg
+00004a10: 2e75 7064 6174 655f 6465 7363 7269 7074  .update_descript
+00004a20: 696f 6e28 6465 7363 7269 7074 696f 6e3d  ion(description=
+00004a30: 224d 7563 6820 6265 7474 6572 2064 6573  "Much better des
+00004a40: 6372 6970 7469 6f6e 2e22 290a 2020 2020  cription.").    
+00004a50: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+00004a60: 2020 2020 2021 2121 2069 6e66 6f20 2253       !!! info "S
+00004a70: 6166 6520 7570 6461 7465 220a 2020 2020  afe update".    
+00004a80: 2020 2020 2020 2020 5468 6973 206d 6574          This met
+00004a90: 686f 6420 7570 6461 7465 7320 7468 6520  hod updates the 
+00004aa0: 6665 6174 7572 6520 6772 6f75 7020 6465  feature group de
+00004ab0: 7363 7269 7074 696f 6e20 7361 6665 6c79  scription safely
+00004ac0: 2e20 496e 2063 6173 6520 6f66 2066 6169  . In case of fai
+00004ad0: 6c75 7265 0a20 2020 2020 2020 2020 2020  lure.           
+00004ae0: 2079 6f75 7220 6c6f 6361 6c20 6d65 7461   your local meta
+00004af0: 6461 7461 206f 626a 6563 7420 7769 6c6c  data object will
+00004b00: 206b 6565 7020 7468 6520 6f6c 6420 6465   keep the old de
+00004b10: 7363 7269 7074 696f 6e2e 0a0a 2020 2020  scription...    
+00004b20: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
+00004b30: 2020 2020 2020 2020 2020 2020 6465 7363              desc
+00004b40: 7269 7074 696f 6e3a 204e 6577 2064 6573  ription: New des
+00004b50: 6372 6970 7469 6f6e 2073 7472 696e 672e  cription string.
+00004b60: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
+00004b70: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
+00004b80: 6046 6561 7475 7265 4772 6f75 7060 2e20  `FeatureGroup`. 
+00004b90: 5468 6520 7570 6461 7465 6420 6665 6174  The updated feat
+00004ba0: 7572 6520 6772 6f75 7020 6f62 6a65 6374  ure group object
+00004bb0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00004bc0: 2020 2020 2020 7365 6c66 2e5f 6665 6174        self._feat
+00004bd0: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
+00004be0: 2e75 7064 6174 655f 6465 7363 7269 7074  .update_descript
+00004bf0: 696f 6e28 7365 6c66 2c20 6465 7363 7269  ion(self, descri
+00004c00: 7074 696f 6e29 0a20 2020 2020 2020 2072  ption).        r
+00004c10: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
+00004c20: 6465 6620 7570 6461 7465 5f66 6561 7475  def update_featu
+00004c30: 7265 7328 7365 6c66 2c20 6665 6174 7572  res(self, featur
+00004c40: 6573 3a20 556e 696f 6e5b 6665 6174 7572  es: Union[featur
+00004c50: 652e 4665 6174 7572 652c 204c 6973 745b  e.Feature, List[
+00004c60: 6665 6174 7572 652e 4665 6174 7572 655d  feature.Feature]
+00004c70: 5d29 3a0a 2020 2020 2020 2020 2222 2255  ]):.        """U
+00004c80: 7064 6174 6520 6d65 7461 6461 7461 206f  pdate metadata o
+00004c90: 6620 6665 6174 7572 6573 2069 6e20 7468  f features in th
+00004ca0: 6973 2066 6561 7475 7265 2067 726f 7570  is feature group
+00004cb0: 2e0a 0a20 2020 2020 2020 2043 7572 7265  ...        Curre
+00004cc0: 6e74 6c79 2069 7427 7320 6f6e 6c79 2073  ntly it's only s
+00004cd0: 7570 706f 7274 6564 2074 6f20 7570 6461  upported to upda
+00004ce0: 7465 2074 6865 2064 6573 6372 6970 7469  te the descripti
+00004cf0: 6f6e 206f 6620 6120 6665 6174 7572 652e  on of a feature.
+00004d00: 0a0a 2020 2020 2020 2020 2121 2120 6461  ..        !!! da
+00004d10: 6e67 6572 2022 556e 7361 6665 2075 7064  nger "Unsafe upd
+00004d20: 6174 6522 0a20 2020 2020 2020 2020 2020  ate".           
+00004d30: 204e 6f74 6520 7468 6174 2069 6620 796f   Note that if yo
+00004d40: 7520 7573 6520 616e 2065 7869 7374 696e  u use an existin
+00004d50: 6720 6046 6561 7475 7265 6020 6f62 6a65  g `Feature` obje
+00004d60: 6374 206f 6620 7468 6520 7363 6865 6d61  ct of the schema
+00004d70: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+00004d80: 2020 2020 6665 6174 7572 6520 6772 6f75      feature grou
+00004d90: 7020 6d65 7461 6461 7461 206f 626a 6563  p metadata objec
+00004da0: 742c 2074 6869 7320 6d69 6768 7420 6c65  t, this might le
+00004db0: 6176 6520 796f 7572 206d 6574 6164 6174  ave your metadat
+00004dc0: 6120 6f62 6a65 6374 2069 6e20 610a 2020  a object in a.  
+00004dd0: 2020 2020 2020 2020 2020 636f 7272 7570            corrup
+00004de0: 7465 6420 7374 6174 6520 6966 2074 6865  ted state if the
+00004df0: 2075 7064 6174 6520 6661 696c 732e 0a0a   update fails...
+00004e00: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+00004e10: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+00004e20: 6665 6174 7572 6573 3a20 6046 6561 7475  features: `Featu
+00004e30: 7265 6020 6f72 206c 6973 7420 6f66 2066  re` or list of f
+00004e40: 6561 7475 7265 732e 2041 2066 6561 7475  eatures. A featu
+00004e50: 7265 206f 626a 6563 7420 6f72 206c 6973  re object or lis
+00004e60: 7420 7468 6572 656f 6620 746f 0a20 2020  t thereof to.   
+00004e70: 2020 2020 2020 2020 2020 2020 2062 6520               be 
+00004e80: 7570 6461 7465 642e 0a0a 2020 2020 2020  updated...      
+00004e90: 2020 2320 5265 7475 726e 730a 2020 2020    # Returns.    
+00004ea0: 2020 2020 2020 2020 6046 6561 7475 7265          `Feature
+00004eb0: 4772 6f75 7060 2e20 5468 6520 7570 6461  Group`. The upda
+00004ec0: 7465 6420 6665 6174 7572 6520 6772 6f75  ted feature grou
+00004ed0: 7020 6f62 6a65 6374 2e0a 2020 2020 2020  p object..      
+00004ee0: 2020 2222 220a 2020 2020 2020 2020 6e65    """.        ne
+00004ef0: 775f 6665 6174 7572 6573 203d 205b 5d0a  w_features = [].
+00004f00: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00004f10: 7461 6e63 6528 6665 6174 7572 6573 2c20  tance(features, 
+00004f20: 6665 6174 7572 652e 4665 6174 7572 6529  feature.Feature)
+00004f30: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
+00004f40: 775f 6665 6174 7572 6573 2e61 7070 656e  w_features.appen
+00004f50: 6428 6665 6174 7572 6573 290a 2020 2020  d(features).    
+00004f60: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00004f70: 6e63 6528 6665 6174 7572 6573 2c20 6c69  nce(features, li
+00004f80: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+00004f90: 2066 6f72 2066 6561 7420 696e 2066 6561   for feat in fea
+00004fa0: 7475 7265 733a 0a20 2020 2020 2020 2020  tures:.         
+00004fb0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00004fc0: 616e 6365 2866 6561 742c 2066 6561 7475  ance(feat, featu
+00004fd0: 7265 2e46 6561 7475 7265 293a 0a20 2020  re.Feature):.   
+00004fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004ff0: 206e 6577 5f66 6561 7475 7265 732e 6170   new_features.ap
+00005000: 7065 6e64 2866 6561 7429 0a20 2020 2020  pend(feat).     
+00005010: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00005020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005030: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00005040: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00005050: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+00005060: 6865 2061 7267 756d 656e 7420 6066 6561  he argument `fea
+00005070: 7475 7265 7360 2068 6173 2074 6f20 6265  tures` has to be
+00005080: 206f 6620 7479 7065 2060 4665 6174 7572   of type `Featur
+00005090: 6560 206f 7220 220a 2020 2020 2020 2020  e` or ".        
+000050a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000050b0: 2261 206c 6973 7420 7468 6572 656f 662c  "a list thereof,
+000050c0: 2062 7574 2061 6e20 656c 656d 656e 7420   but an element 
+000050d0: 6973 206f 6620 7479 7065 3a20 607b 7d60  is of type: `{}`
+000050e0: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
+000050f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005100: 2020 2020 2020 7479 7065 2866 6561 7475        type(featu
+00005110: 7265 7329 0a20 2020 2020 2020 2020 2020  res).           
+00005120: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00005130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005140: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+00005150: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00005160: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+00005170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005180: 2254 6865 2061 7267 756d 656e 7420 6066  "The argument `f
+00005190: 6561 7475 7265 7360 2068 6173 2074 6f20  eatures` has to 
+000051a0: 6265 206f 6620 7479 7065 2060 4665 6174  be of type `Feat
+000051b0: 7572 6560 206f 7220 6120 6c69 7374 2022  ure` or a list "
+000051c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000051d0: 2022 7468 6572 656f 662c 2062 7574 2069   "thereof, but i
+000051e0: 7320 6f66 2074 7970 653a 2060 7b7d 6022  s of type: `{}`"
+000051f0: 2e66 6f72 6d61 7428 7479 7065 2866 6561  .format(type(fea
+00005200: 7475 7265 7329 290a 2020 2020 2020 2020  tures)).        
+00005210: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00005220: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
+00005230: 705f 656e 6769 6e65 2e75 7064 6174 655f  p_engine.update_
+00005240: 6665 6174 7572 6573 2873 656c 662c 206e  features(self, n
+00005250: 6577 5f66 6561 7475 7265 7329 0a20 2020  ew_features).   
+00005260: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00005270: 0a0a 2020 2020 6465 6620 7570 6461 7465  ..    def update
+00005280: 5f66 6561 7475 7265 5f64 6573 6372 6970  _feature_descrip
+00005290: 7469 6f6e 2873 656c 662c 2066 6561 7475  tion(self, featu
+000052a0: 7265 5f6e 616d 653a 2073 7472 2c20 6465  re_name: str, de
+000052b0: 7363 7269 7074 696f 6e3a 2073 7472 293a  scription: str):
+000052c0: 0a20 2020 2020 2020 2022 2222 5570 6461  .        """Upda
+000052d0: 7465 2074 6865 2064 6573 6372 6970 7469  te the descripti
+000052e0: 6f6e 206f 6620 6120 7369 6e67 6c65 2066  on of a single f
+000052f0: 6561 7475 7265 2069 6e20 7468 6973 2066  eature in this f
+00005300: 6561 7475 7265 2067 726f 7570 2e0a 0a20  eature group... 
+00005310: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00005320: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
+00005330: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+00005340: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
+00005350: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
+00005360: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+00005370: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
+00005380: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
+00005390: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
+000053a0: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+000053b0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
+000053c0: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+000053d0: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
+000053e0: 2020 2020 2020 2020 2066 672e 7570 6461           fg.upda
+000053f0: 7465 5f66 6561 7475 7265 5f64 6573 6372  te_feature_descr
+00005400: 6970 7469 6f6e 2866 6561 7475 7265 5f6e  iption(feature_n
+00005410: 616d 653d 226d 696e 5f74 656d 7022 2c0a  ame="min_temp",.
 00005420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005430: 2020 6465 7363 7269 7074 696f 6e3d 224d    description="M
-00005440: 7563 6820 6265 7474 6572 2066 6561 7475  uch better featu
-00005450: 7265 2064 6573 6372 6970 7469 6f6e 2e22  re description."
-00005460: 290a 2020 2020 2020 2020 2020 2020 6060  ).            ``
-00005470: 600a 0a20 2020 2020 2020 2021 2121 2069  `..        !!! i
-00005480: 6e66 6f20 2253 6166 6520 7570 6461 7465  nfo "Safe update
-00005490: 220a 2020 2020 2020 2020 2020 2020 5468  ".            Th
-000054a0: 6973 206d 6574 686f 6420 7570 6461 7465  is method update
-000054b0: 7320 7468 6520 6665 6174 7572 6520 6465  s the feature de
-000054c0: 7363 7269 7074 696f 6e20 7361 6665 6c79  scription safely
-000054d0: 2e20 496e 2063 6173 6520 6f66 2066 6169  . In case of fai
-000054e0: 6c75 7265 0a20 2020 2020 2020 2020 2020  lure.           
-000054f0: 2079 6f75 7220 6c6f 6361 6c20 6d65 7461   your local meta
-00005500: 6461 7461 206f 626a 6563 7420 7769 6c6c  data object will
-00005510: 206b 6565 7020 7468 6520 6f6c 6420 6465   keep the old de
-00005520: 7363 7269 7074 696f 6e2e 0a0a 2020 2020  scription...    
-00005530: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-00005540: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00005550: 7572 655f 6e61 6d65 3a20 4e61 6d65 206f  ure_name: Name o
-00005560: 6620 7468 6520 6665 6174 7572 6520 746f  f the feature to
-00005570: 2062 6520 7570 6461 7465 642e 0a20 2020   be updated..   
-00005580: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
-00005590: 7469 6f6e 3a20 4e65 7720 6465 7363 7269  tion: New descri
-000055a0: 7074 696f 6e20 7374 7269 6e67 2e0a 0a20  ption string... 
-000055b0: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
-000055c0: 0a20 2020 2020 2020 2020 2020 2060 4665  .            `Fe
-000055d0: 6174 7572 6547 726f 7570 602e 2054 6865  atureGroup`. The
-000055e0: 2075 7064 6174 6564 2066 6561 7475 7265   updated feature
-000055f0: 2067 726f 7570 206f 626a 6563 742e 0a20   group object.. 
-00005600: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00005610: 2020 2066 5f63 6f70 7920 3d20 636f 7079     f_copy = copy
-00005620: 2e64 6565 7063 6f70 7928 7365 6c66 5b66  .deepcopy(self[f
-00005630: 6561 7475 7265 5f6e 616d 655d 290a 2020  eature_name]).  
-00005640: 2020 2020 2020 665f 636f 7079 2e64 6573        f_copy.des
-00005650: 6372 6970 7469 6f6e 203d 2064 6573 6372  cription = descr
-00005660: 6970 7469 6f6e 0a20 2020 2020 2020 2073  iption.        s
-00005670: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
-00005680: 7570 5f65 6e67 696e 652e 7570 6461 7465  up_engine.update
-00005690: 5f66 6561 7475 7265 7328 7365 6c66 2c20  _features(self, 
-000056a0: 5b66 5f63 6f70 795d 290a 2020 2020 2020  [f_copy]).      
-000056b0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-000056c0: 2020 2064 6566 2061 7070 656e 645f 6665     def append_fe
-000056d0: 6174 7572 6573 2873 656c 662c 2066 6561  atures(self, fea
-000056e0: 7475 7265 733a 2055 6e69 6f6e 5b66 6561  tures: Union[fea
-000056f0: 7475 7265 2e46 6561 7475 7265 2c20 4c69  ture.Feature, Li
-00005700: 7374 5b66 6561 7475 7265 2e46 6561 7475  st[feature.Featu
-00005710: 7265 5d5d 293a 0a20 2020 2020 2020 2022  re]]):.        "
-00005720: 2222 4170 7065 6e64 2066 6561 7475 7265  ""Append feature
-00005730: 7320 746f 2074 6865 2073 6368 656d 6120  s to the schema 
-00005740: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-00005750: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
-00005760: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
-00005770: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-00005780: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00005790: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-000057a0: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-000057b0: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-000057c0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000057d0: 6465 6669 6e65 2066 6561 7475 7265 7320  define features 
-000057e0: 746f 2062 6520 696e 7365 7274 6564 2069  to be inserted i
-000057f0: 6e20 7468 6520 6665 6174 7572 6520 6772  n the feature gr
-00005800: 6f75 700a 2020 2020 2020 2020 2020 2020  oup.            
-00005810: 6665 6174 7572 6573 203d 205b 0a20 2020  features = [.   
-00005820: 2020 2020 2020 2020 2020 2020 2046 6561               Fea
-00005830: 7475 7265 286e 616d 653d 2269 6422 2c74  ture(name="id",t
-00005840: 7970 653d 2269 6e74 222c 6f6e 6c69 6e65  ype="int",online
-00005850: 5f74 7970 653d 2269 6e74 2229 2c0a 2020  _type="int"),.  
-00005860: 2020 2020 2020 2020 2020 2020 2020 4665                Fe
-00005870: 6174 7572 6528 6e61 6d65 3d22 6e61 6d65  ature(name="name
-00005880: 222c 7479 7065 3d22 7374 7269 6e67 222c  ",type="string",
-00005890: 6f6e 6c69 6e65 5f74 7970 653d 2276 6172  online_type="var
-000058a0: 6368 6172 2832 3029 2229 0a20 2020 2020  char(20)").     
-000058b0: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
-000058c0: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
-000058d0: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
-000058e0: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
-000058f0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
-00005900: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
-00005910: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
-00005920: 2020 2020 2020 2020 2066 672e 6170 7065           fg.appe
-00005930: 6e64 5f66 6561 7475 7265 7328 6665 6174  nd_features(feat
-00005940: 7572 6573 290a 2020 2020 2020 2020 2020  ures).          
-00005950: 2020 6060 600a 0a20 2020 2020 2020 2021    ```..        !
-00005960: 2121 2069 6e66 6f20 2253 6166 6520 6170  !! info "Safe ap
-00005970: 7065 6e64 220a 2020 2020 2020 2020 2020  pend".          
-00005980: 2020 5468 6973 206d 6574 686f 6420 6170    This method ap
-00005990: 7065 6e64 7320 7468 6520 6665 6174 7572  pends the featur
-000059a0: 6573 2074 6f20 7468 6520 6665 6174 7572  es to the featur
-000059b0: 6520 6772 6f75 7020 6465 7363 7269 7074  e group descript
-000059c0: 696f 6e20 7361 6665 6c79 2e0a 2020 2020  ion safely..    
-000059d0: 2020 2020 2020 2020 496e 2063 6173 6520          In case 
-000059e0: 6f66 2066 6169 6c75 7265 2079 6f75 7220  of failure your 
-000059f0: 6c6f 6361 6c20 6d65 7461 6461 7461 206f  local metadata o
-00005a00: 626a 6563 7420 7769 6c6c 2063 6f6e 7461  bject will conta
-00005a10: 696e 2074 6865 2063 6f72 7265 6374 0a20  in the correct. 
-00005a20: 2020 2020 2020 2020 2020 2073 6368 656d             schem
-00005a30: 612e 0a0a 2020 2020 2020 2020 4974 2069  a...        It i
-00005a40: 7320 6f6e 6c79 2070 6f73 7369 626c 6520  s only possible 
-00005a50: 746f 2061 7070 656e 6420 6665 6174 7572  to append featur
-00005a60: 6573 2074 6f20 6120 6665 6174 7572 6520  es to a feature 
-00005a70: 6772 6f75 702e 2052 656d 6f76 696e 670a  group. Removing.
-00005a80: 2020 2020 2020 2020 6665 6174 7572 6573          features
-00005a90: 2069 7320 636f 6e73 6964 6572 6564 2061   is considered a
-00005aa0: 2062 7265 616b 696e 6720 6368 616e 6765   breaking change
-00005ab0: 2e0a 0a20 2020 2020 2020 2023 2041 7267  ...        # Arg
-00005ac0: 756d 656e 7473 0a20 2020 2020 2020 2020  uments.         
-00005ad0: 2020 2066 6561 7475 7265 733a 2046 6561     features: Fea
-00005ae0: 7475 7265 206f 7220 6c69 7374 2e20 4120  ture or list. A 
-00005af0: 6665 6174 7572 6520 6f62 6a65 6374 206f  feature object o
-00005b00: 7220 6c69 7374 2074 6865 7265 6f66 2074  r list thereof t
-00005b10: 6f20 6170 7065 6e64 2074 6f0a 2020 2020  o append to.    
-00005b20: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00005b30: 7363 6865 6d61 206f 6620 7468 6520 6665  schema of the fe
-00005b40: 6174 7572 6520 6772 6f75 702e 0a0a 2020  ature group...  
-00005b50: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-00005b60: 2020 2020 2020 2020 2020 2020 6046 6561              `Fea
-00005b70: 7475 7265 4772 6f75 7060 2e20 5468 6520  tureGroup`. The 
-00005b80: 7570 6461 7465 6420 6665 6174 7572 6520  updated feature 
-00005b90: 6772 6f75 7020 6f62 6a65 6374 2e0a 2020  group object..  
-00005ba0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00005bb0: 2020 6e65 775f 6665 6174 7572 6573 203d    new_features =
-00005bc0: 205b 5d0a 2020 2020 2020 2020 6966 2069   [].        if i
-00005bd0: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00005be0: 6573 2c20 6665 6174 7572 652e 4665 6174  es, feature.Feat
-00005bf0: 7572 6529 3a0a 2020 2020 2020 2020 2020  ure):.          
-00005c00: 2020 6e65 775f 6665 6174 7572 6573 2e61    new_features.a
-00005c10: 7070 656e 6428 6665 6174 7572 6573 290a  ppend(features).
-00005c20: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00005c30: 6e73 7461 6e63 6528 6665 6174 7572 6573  nstance(features
-00005c40: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
-00005c50: 2020 2020 2066 6f72 2066 6561 7420 696e       for feat in
-00005c60: 2066 6561 7475 7265 733a 0a20 2020 2020   features:.     
-00005c70: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-00005c80: 696e 7374 616e 6365 2866 6561 742c 2066  instance(feat, f
-00005c90: 6561 7475 7265 2e46 6561 7475 7265 293a  eature.Feature):
-00005ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005cb0: 2020 2020 206e 6577 5f66 6561 7475 7265       new_feature
-00005cc0: 732e 6170 7065 6e64 2866 6561 7429 0a20  s.append(feat). 
-00005cd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00005ce0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00005cf0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00005d00: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-00005d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d20: 2020 2254 6865 2061 7267 756d 656e 7420    "The argument 
-00005d30: 6066 6561 7475 7265 7360 2068 6173 2074  `features` has t
-00005d40: 6f20 6265 206f 6620 7479 7065 2060 4665  o be of type `Fe
-00005d50: 6174 7572 6560 206f 7220 220a 2020 2020  ature` or ".    
-00005d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d70: 2020 2020 2261 206c 6973 7420 7468 6572      "a list ther
-00005d80: 656f 662c 2062 7574 2061 6e20 656c 656d  eof, but an elem
-00005d90: 656e 7420 6973 206f 6620 7479 7065 3a20  ent is of type: 
-00005da0: 607b 7d60 222e 666f 726d 6174 280a 2020  `{}`".format(.  
-00005db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005dc0: 2020 2020 2020 2020 2020 7479 7065 2866            type(f
-00005dd0: 6561 7475 7265 7329 0a20 2020 2020 2020  eatures).       
-00005de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005df0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00005e00: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005e10: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00005e20: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00005e30: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00005e40: 2020 2020 2254 6865 2061 7267 756d 656e      "The argumen
-00005e50: 7420 6066 6561 7475 7265 7360 2068 6173  t `features` has
-00005e60: 2074 6f20 6265 206f 6620 7479 7065 2060   to be of type `
-00005e70: 4665 6174 7572 6560 206f 7220 6120 6c69  Feature` or a li
-00005e80: 7374 2022 0a20 2020 2020 2020 2020 2020  st ".           
-00005e90: 2020 2020 2022 7468 6572 656f 662c 2062       "thereof, b
-00005ea0: 7574 2069 7320 6f66 2074 7970 653a 2060  ut is of type: `
-00005eb0: 7b7d 6022 2e66 6f72 6d61 7428 7479 7065  {}`".format(type
-00005ec0: 2866 6561 7475 7265 7329 290a 2020 2020  (features)).    
-00005ed0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00005ee0: 2020 7365 6c66 2e5f 6665 6174 7572 655f    self._feature_
-00005ef0: 6772 6f75 705f 656e 6769 6e65 2e61 7070  group_engine.app
-00005f00: 656e 645f 6665 6174 7572 6573 2873 656c  end_features(sel
-00005f10: 662c 206e 6577 5f66 6561 7475 7265 7329  f, new_features)
-00005f20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005f30: 7365 6c66 0a0a 2020 2020 6465 6620 6765  self..    def ge
-00005f40: 745f 6578 7065 6374 6174 696f 6e5f 7375  t_expectation_su
-00005f50: 6974 6528 0a20 2020 2020 2020 2073 656c  ite(.        sel
-00005f60: 662c 2067 655f 7479 7065 3a20 626f 6f6c  f, ge_type: bool
-00005f70: 203d 2054 7275 650a 2020 2020 2920 2d3e   = True.    ) ->
-00005f80: 2055 6e69 6f6e 5b45 7870 6563 7461 7469   Union[Expectati
-00005f90: 6f6e 5375 6974 652c 2067 652e 636f 7265  onSuite, ge.core
-00005fa0: 2e45 7870 6563 7461 7469 6f6e 5375 6974  .ExpectationSuit
-00005fb0: 652c 204e 6f6e 655d 3a0a 2020 2020 2020  e, None]:.      
-00005fc0: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
-00005fd0: 6578 7065 6374 6174 696f 6e20 7375 6974  expectation suit
-00005fe0: 6520 6174 7461 6368 6564 2074 6f20 7468  e attached to th
-00005ff0: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
-00006000: 6966 2069 7420 6578 6973 7473 2e0a 0a20  if it exists... 
-00006010: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
-00006020: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
-00006030: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00006040: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
-00006050: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
-00006060: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
-00006070: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
-00006080: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
-00006090: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
-000060a0: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
-000060b0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
-000060c0: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
-000060d0: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
-000060e0: 2020 2020 2020 2020 2065 7870 5f73 7569           exp_sui
-000060f0: 7465 203d 2066 672e 6765 745f 6578 7065  te = fg.get_expe
-00006100: 6374 6174 696f 6e5f 7375 6974 6528 290a  ctation_suite().
-00006110: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00006120: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
-00006130: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-00006140: 2067 655f 7479 7065 3a20 4966 2060 5472   ge_type: If `Tr
-00006150: 7565 6020 7265 7475 726e 7320 6120 6e61  ue` returns a na
-00006160: 7469 7665 2047 7265 6174 2045 7870 6563  tive Great Expec
-00006170: 7461 7469 6f6e 2074 7970 652c 2048 6f70  tation type, Hop
-00006180: 7377 6f72 6b73 0a20 2020 2020 2020 2020  sworks.         
-00006190: 2020 2020 2020 2063 7573 746f 6d20 7479         custom ty
-000061a0: 7065 206f 7468 6572 7769 7365 2e20 436f  pe otherwise. Co
-000061b0: 6e76 6572 7369 6f6e 2063 616e 2062 6520  nversion can be 
-000061c0: 7065 7266 6f72 6d65 6420 7669 6120 7468  performed via th
-000061d0: 6520 6074 6f5f 6765 5f74 7970 6528 2960  e `to_ge_type()`
-000061e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000061f0: 206d 6574 686f 6420 6f6e 2068 6f70 7377   method on hopsw
-00006200: 6f72 6b73 2074 7970 652e 2044 6566 6175  orks type. Defau
-00006210: 6c74 7320 746f 2060 5472 7565 602e 0a0a  lts to `True`...
-00006220: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-00006230: 730a 2020 2020 2020 2020 2020 2020 6045  s.            `E
-00006240: 7870 6563 7461 7469 6f6e 5375 6974 6560  xpectationSuite`
-00006250: 2e20 5468 6520 6578 7065 6374 6174 696f  . The expectatio
-00006260: 6e20 7375 6974 6520 6174 7461 6368 6564  n suite attached
-00006270: 2074 6f20 7468 6520 6665 6174 7572 6520   to the feature 
-00006280: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
-00006290: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
-000062a0: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
-000062b0: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
-000062c0: 7441 5049 4572 726f 7260 2e0a 2020 2020  tAPIError`..    
-000062d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000062e0: 2320 4176 6f69 6420 7468 726f 7769 6e67  # Avoid throwing
-000062f0: 2061 6e20 6572 726f 7220 6966 2046 6561   an error if Fea
-00006300: 7475 7265 2047 726f 7570 206e 6f74 2069  ture Group not i
-00006310: 6e69 7469 616c 6973 6564 2e0a 2020 2020  nitialised..    
-00006320: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
-00006330: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006340: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
-00006350: 7569 7465 203d 2073 656c 662e 5f65 7870  uite = self._exp
-00006360: 6563 7461 7469 6f6e 5f73 7569 7465 5f65  ectation_suite_e
-00006370: 6e67 696e 652e 6765 7428 290a 0a20 2020  ngine.get()..   
-00006380: 2020 2020 2069 6620 7365 6c66 2e5f 6578       if self._ex
-00006390: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
-000063a0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-000063b0: 6765 5f74 7970 6520 6973 2054 7275 653a  ge_type is True:
-000063c0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000063d0: 7572 6e20 7365 6c66 2e5f 6578 7065 6374  urn self._expect
-000063e0: 6174 696f 6e5f 7375 6974 652e 746f 5f67  ation_suite.to_g
-000063f0: 655f 7479 7065 2829 0a20 2020 2020 2020  e_type().       
-00006400: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00006410: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00006420: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00006430: 650a 0a20 2020 2064 6566 2073 6176 655f  e..    def save_
-00006440: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00006450: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00006460: 0a20 2020 2020 2020 2065 7870 6563 7461  .        expecta
-00006470: 7469 6f6e 5f73 7569 7465 3a20 556e 696f  tion_suite: Unio
-00006480: 6e5b 4578 7065 6374 6174 696f 6e53 7569  n[ExpectationSui
-00006490: 7465 2c20 6765 2e63 6f72 652e 4578 7065  te, ge.core.Expe
-000064a0: 6374 6174 696f 6e53 7569 7465 5d2c 0a20  ctationSuite],. 
-000064b0: 2020 2020 2020 2072 756e 5f76 616c 6964         run_valid
-000064c0: 6174 696f 6e3a 2062 6f6f 6c20 3d20 5472  ation: bool = Tr
-000064d0: 7565 2c0a 2020 2020 2020 2020 7661 6c69  ue,.        vali
-000064e0: 6461 7469 6f6e 5f69 6e67 6573 7469 6f6e  dation_ingestion
-000064f0: 5f70 6f6c 6963 793a 2073 7472 203d 2022  _policy: str = "
-00006500: 414c 5741 5953 222c 0a20 2020 2020 2020  ALWAYS",.       
-00006510: 206f 7665 7277 7269 7465 3a20 626f 6f6c   overwrite: bool
-00006520: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
-00006530: 2d3e 2055 6e69 6f6e 5b45 7870 6563 7461  -> Union[Expecta
-00006540: 7469 6f6e 5375 6974 652c 2067 652e 636f  tionSuite, ge.co
-00006550: 7265 2e45 7870 6563 7461 7469 6f6e 5375  re.ExpectationSu
-00006560: 6974 655d 3a0a 2020 2020 2020 2020 2222  ite]:.        ""
-00006570: 2241 7474 6163 6820 616e 2065 7870 6563  "Attach an expec
-00006580: 7461 7469 6f6e 2073 7569 7465 2074 6f20  tation suite to 
-00006590: 6120 6665 6174 7572 6520 6772 6f75 7020  a feature group 
-000065a0: 616e 6420 7361 7665 7320 6974 2066 6f72  and saves it for
-000065b0: 2066 7574 7572 6520 7573 652e 2049 6620   future use. If 
-000065c0: 616e 2065 7870 6563 7461 7469 6f6e 0a20  an expectation. 
-000065d0: 2020 2020 2020 2073 7569 7465 2069 7320         suite is 
-000065e0: 616c 7265 6164 7920 6174 7461 6368 6564  already attached
-000065f0: 2c20 6974 2069 7320 7265 706c 6163 6564  , it is replaced
-00006600: 2e20 4e6f 7465 2074 6861 7420 7468 6520  . Note that the 
-00006610: 7072 6f76 6964 6564 2065 7870 6563 7461  provided expecta
-00006620: 7469 6f6e 2073 7569 7465 2069 7320 6d6f  tion suite is mo
-00006630: 6469 6669 6564 0a20 2020 2020 2020 2069  dified.        i
-00006640: 6e70 6c61 6365 2074 6f20 696e 636c 7564  nplace to includ
-00006650: 6520 6578 7065 6374 6174 696f 6e49 6420  e expectationId 
-00006660: 6669 656c 6473 2e0a 0a20 2020 2020 2020  fields...       
-00006670: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-00006680: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00006690: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-000066a0: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-000066b0: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-000066c0: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-000066d0: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-000066e0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-000066f0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-00006700: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
-00006710: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
-00006720: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
-00006730: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
-00006740: 2020 2066 672e 7361 7665 5f65 7870 6563     fg.save_expec
-00006750: 7461 7469 6f6e 5f73 7569 7465 2865 7870  tation_suite(exp
-00006760: 6563 7461 7469 6f6e 5f73 7569 7465 2c20  ectation_suite, 
-00006770: 7275 6e5f 7661 6c69 6461 7469 6f6e 3d54  run_validation=T
-00006780: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
-00006790: 2060 6060 0a0a 2020 2020 2020 2020 2320   ```..        # 
-000067a0: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
-000067b0: 2020 2020 2020 6578 7065 6374 6174 696f        expectatio
-000067c0: 6e5f 7375 6974 653a 2054 6865 2065 7870  n_suite: The exp
-000067d0: 6563 7461 7469 6f6e 2073 7569 7465 2074  ectation suite t
-000067e0: 6f20 6174 7461 6368 2074 6f20 7468 6520  o attach to the 
-000067f0: 4665 6174 7572 6520 4772 6f75 702e 0a20  Feature Group.. 
-00006800: 2020 2020 2020 2020 2020 206f 7665 7277             overw
-00006810: 7269 7465 3a20 4966 2061 6e20 4578 7065  rite: If an Expe
-00006820: 6374 6174 696f 6e20 5375 6974 6520 6973  ctation Suite is
-00006830: 2061 6c72 6561 6479 2061 7474 6163 6865   already attache
-00006840: 642c 206f 7665 7277 7269 7465 2069 742e  d, overwrite it.
-00006850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006860: 2054 6865 206e 6577 2073 7569 7465 2077   The new suite w
-00006870: 696c 6c20 6861 7665 2069 7473 206f 776e  ill have its own
-00006880: 2076 616c 6964 6174 696f 6e20 6869 7374   validation hist
-00006890: 6f72 792c 2062 7574 2066 6f72 6d65 7220  ory, but former 
-000068a0: 7265 706f 7274 7320 6172 6520 7072 6573  reports are pres
-000068b0: 6572 7665 642e 0a20 2020 2020 2020 2020  erved..         
-000068c0: 2020 2072 756e 5f76 616c 6964 6174 696f     run_validatio
-000068d0: 6e3a 2053 6574 2077 6865 7468 6572 2074  n: Set whether t
-000068e0: 6865 2065 7870 6563 7461 7469 6f6e 5f73  he expectation_s
-000068f0: 7569 7465 2077 696c 6c20 7275 6e20 6f6e  uite will run on
-00006900: 2069 6e67 6573 7469 6f6e 0a20 2020 2020   ingestion.     
-00006910: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
-00006920: 6e5f 696e 6765 7374 696f 6e5f 706f 6c69  n_ingestion_poli
-00006930: 6379 3a20 5365 7420 7468 6520 706f 6c69  cy: Set the poli
-00006940: 6379 2066 6f72 2069 6e67 6573 7469 6f6e  cy for ingestion
-00006950: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
-00006960: 4772 6f75 702e 0a20 2020 2020 2020 2020  Group..         
-00006970: 2020 2020 2020 202d 2022 5354 5249 4354         - "STRICT
-00006980: 2220 6f6e 6c79 2061 6c6c 6f77 7320 4461  " only allows Da
-00006990: 7461 4672 616d 6520 7061 7373 696e 6720  taFrame passing 
-000069a0: 7661 6c69 6461 7469 6f6e 2074 6f20 6265  validation to be
-000069b0: 2069 6e73 6572 7465 6420 696e 746f 2046   inserted into F
-000069c0: 6561 7475 7265 2047 726f 7570 2e0a 2020  eature Group..  
-000069d0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-000069e0: 2241 4c57 4159 5322 2061 6c77 6179 7320  "ALWAYS" always 
-000069f0: 696e 7365 7274 2074 6865 2044 6174 6146  insert the DataF
-00006a00: 7261 6d65 2074 6f20 7468 6520 4665 6174  rame to the Feat
-00006a10: 7572 6520 4772 6f75 702c 2069 7272 6573  ure Group, irres
-00006a20: 7065 6374 6976 6520 6f66 206f 7665 7261  pective of overa
-00006a30: 6c6c 2076 616c 6964 6174 696f 6e20 7265  ll validation re
-00006a40: 7375 6c74 2e0a 0a20 2020 2020 2020 2023  sult...        #
-00006a50: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
-00006a60: 2020 2020 6068 7366 732e 636c 6965 6e74      `hsfs.client
-00006a70: 2e65 7863 6570 7469 6f6e 732e 5265 7374  .exceptions.Rest
-00006a80: 4150 4945 7272 6f72 602e 0a20 2020 2020  APIError`..     
-00006a90: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00006aa0: 6620 6973 696e 7374 616e 6365 2865 7870  f isinstance(exp
-00006ab0: 6563 7461 7469 6f6e 5f73 7569 7465 2c20  ectation_suite, 
-00006ac0: 6765 2e63 6f72 652e 4578 7065 6374 6174  ge.core.Expectat
-00006ad0: 696f 6e53 7569 7465 293a 0a20 2020 2020  ionSuite):.     
-00006ae0: 2020 2020 2020 2074 6d70 5f65 7870 6563         tmp_expec
-00006af0: 7461 7469 6f6e 5f73 7569 7465 203d 2045  tation_suite = E
-00006b00: 7870 6563 7461 7469 6f6e 5375 6974 652e  xpectationSuite.
-00006b10: 6672 6f6d 5f67 655f 7479 7065 280a 2020  from_ge_type(.  
-00006b20: 2020 2020 2020 2020 2020 2020 2020 6765                ge
-00006b30: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
-00006b40: 7465 3d65 7870 6563 7461 7469 6f6e 5f73  te=expectation_s
-00006b50: 7569 7465 2c0a 2020 2020 2020 2020 2020  uite,.          
-00006b60: 2020 2020 2020 7275 6e5f 7661 6c69 6461        run_valida
-00006b70: 7469 6f6e 3d72 756e 5f76 616c 6964 6174  tion=run_validat
-00006b80: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00006b90: 2020 2020 2076 616c 6964 6174 696f 6e5f       validation_
-00006ba0: 696e 6765 7374 696f 6e5f 706f 6c69 6379  ingestion_policy
-00006bb0: 3d76 616c 6964 6174 696f 6e5f 696e 6765  =validation_inge
-00006bc0: 7374 696f 6e5f 706f 6c69 6379 2c0a 2020  stion_policy,.  
-00006bd0: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-00006be0: 6174 7572 655f 7374 6f72 655f 6964 3d73  ature_store_id=s
-00006bf0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-00006c00: 7265 5f69 642c 0a20 2020 2020 2020 2020  re_id,.         
-00006c10: 2020 2020 2020 2066 6561 7475 7265 5f67         feature_g
-00006c20: 726f 7570 5f69 643d 7365 6c66 2e5f 6964  roup_id=self._id
-00006c30: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00006c40: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-00006c50: 6e73 7461 6e63 6528 6578 7065 6374 6174  nstance(expectat
-00006c60: 696f 6e5f 7375 6974 652c 2045 7870 6563  ion_suite, Expec
-00006c70: 7461 7469 6f6e 5375 6974 6529 3a0a 2020  tationSuite):.  
-00006c80: 2020 2020 2020 2020 2020 746d 705f 6578            tmp_ex
-00006c90: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
-00006ca0: 3d20 6578 7065 6374 6174 696f 6e5f 7375  = expectation_su
-00006cb0: 6974 652e 746f 5f6a 736f 6e5f 6469 6374  ite.to_json_dict
-00006cc0: 2864 6563 616d 656c 697a 653d 5472 7565  (decamelize=True
-00006cd0: 290a 2020 2020 2020 2020 2020 2020 746d  ).            tm
-00006ce0: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
-00006cf0: 6974 655b 2266 6561 7475 7265 5f67 726f  ite["feature_gro
-00006d00: 7570 5f69 6422 5d20 3d20 7365 6c66 2e5f  up_id"] = self._
-00006d10: 6964 0a20 2020 2020 2020 2020 2020 2074  id.            t
-00006d20: 6d70 5f65 7870 6563 7461 7469 6f6e 5f73  mp_expectation_s
-00006d30: 7569 7465 5b22 6665 6174 7572 655f 7374  uite["feature_st
-00006d40: 6f72 655f 6964 225d 203d 2073 656c 662e  ore_id"] = self.
-00006d50: 5f66 6561 7475 7265 5f73 746f 7265 5f69  _feature_store_i
-00006d60: 640a 2020 2020 2020 2020 2020 2020 746d  d.            tm
-00006d70: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
-00006d80: 6974 6520 3d20 4578 7065 6374 6174 696f  ite = Expectatio
-00006d90: 6e53 7569 7465 282a 2a74 6d70 5f65 7870  nSuite(**tmp_exp
-00006da0: 6563 7461 7469 6f6e 5f73 7569 7465 290a  ectation_suite).
-00006db0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00006dc0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00006dd0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
-00006de0: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-00006df0: 7072 6f76 6964 6564 2065 7870 6563 7461  provided expecta
-00006e00: 7469 6f6e 2073 7569 7465 2074 7970 6520  tion suite type 
-00006e10: 607b 7d60 2069 7320 6e6f 7420 7375 7070  `{}` is not supp
-00006e20: 6f72 7465 642e 2055 7365 2047 7265 6174  orted. Use Great
-00006e30: 2045 7870 6563 7461 7469 6f6e 2060 4578   Expectation `Ex
-00006e40: 7065 6374 6174 696f 6e53 7569 7465 6020  pectationSuite` 
-00006e50: 6f72 2048 5346 5327 206f 776e 2060 4578  or HSFS' own `Ex
-00006e60: 7065 6374 6174 696f 6e53 7569 7465 6020  pectationSuite` 
-00006e70: 6f62 6a65 6374 2e22 2e66 6f72 6d61 7428  object.".format(
-00006e80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006e90: 2020 2020 2074 7970 6528 6578 7065 6374       type(expect
-00006ea0: 6174 696f 6e5f 7375 6974 6529 0a20 2020  ation_suite).   
-00006eb0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00006ec0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00006ed0: 2020 2020 2020 6966 206f 7665 7277 7269        if overwri
-00006ee0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
-00006ef0: 7365 6c66 2e64 656c 6574 655f 6578 7065  self.delete_expe
-00006f00: 6374 6174 696f 6e5f 7375 6974 6528 290a  ctation_suite().
-00006f10: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00006f20: 2e5f 6964 3a0a 2020 2020 2020 2020 2020  ._id:.          
-00006f30: 2020 7365 6c66 2e5f 6578 7065 6374 6174    self._expectat
-00006f40: 696f 6e5f 7375 6974 6520 3d20 7365 6c66  ion_suite = self
-00006f50: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
-00006f60: 6974 655f 656e 6769 6e65 2e73 6176 6528  ite_engine.save(
-00006f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006f80: 2074 6d70 5f65 7870 6563 7461 7469 6f6e   tmp_expectation
-00006f90: 5f73 7569 7465 0a20 2020 2020 2020 2020  _suite.         
-00006fa0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00006fb0: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
-00006fc0: 7465 203d 2073 656c 662e 5f65 7870 6563  te = self._expec
-00006fd0: 7461 7469 6f6e 5f73 7569 7465 2e74 6f5f  tation_suite.to_
-00006fe0: 6765 5f74 7970 6528 290a 2020 2020 2020  ge_type().      
-00006ff0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00007000: 2020 2020 2320 4164 6465 6420 746f 2061      # Added to a
-00007010: 766f 6964 2074 6872 6f77 696e 6720 616e  void throwing an
-00007020: 2065 7272 6f72 2069 6620 4665 6174 7572   error if Featur
-00007030: 6520 4772 6f75 7020 6973 206e 6f74 2069  e Group is not i
-00007040: 6e69 7469 616c 6973 6564 2077 6974 6820  nitialised with 
-00007050: 7468 6520 6261 636b 656e 640a 2020 2020  the backend.    
-00007060: 2020 2020 2020 2020 7365 6c66 2e5f 6578          self._ex
-00007070: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
-00007080: 3d20 746d 705f 6578 7065 6374 6174 696f  = tmp_expectatio
-00007090: 6e5f 7375 6974 650a 0a20 2020 2064 6566  n_suite..    def
-000070a0: 2064 656c 6574 655f 6578 7065 6374 6174   delete_expectat
-000070b0: 696f 6e5f 7375 6974 6528 7365 6c66 2920  ion_suite(self) 
-000070c0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-000070d0: 2022 2222 4465 6c65 7465 2074 6865 2065   """Delete the e
-000070e0: 7870 6563 7461 7469 6f6e 2073 7569 7465  xpectation suite
-000070f0: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
-00007100: 2046 6561 7475 7265 2047 726f 7570 2e0a   Feature Group..
-00007110: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
-00007120: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
-00007130: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-00007140: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
-00007150: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
-00007160: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
-00007170: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
-00007180: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-00007190: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
-000071a0: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
-000071b0: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
-000071c0: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
-000071d0: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
-000071e0: 2020 2020 2020 2020 2020 2066 672e 6465             fg.de
-000071f0: 6c65 7465 5f65 7870 6563 7461 7469 6f6e  lete_expectation
-00007200: 5f73 7569 7465 2829 0a20 2020 2020 2020  _suite().       
-00007210: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-00007220: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
-00007230: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-00007240: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
-00007250: 6573 7441 5049 4572 726f 7260 2e0a 2020  estAPIError`..  
-00007260: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007270: 2020 6966 2073 656c 662e 6765 745f 6578    if self.get_ex
-00007280: 7065 6374 6174 696f 6e5f 7375 6974 6528  pectation_suite(
-00007290: 2920 6973 206e 6f74 204e 6f6e 653a 0a20  ) is not None:. 
-000072a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000072b0: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
-000072c0: 7465 5f65 6e67 696e 652e 6465 6c65 7465  te_engine.delete
-000072d0: 2873 656c 662e 5f65 7870 6563 7461 7469  (self._expectati
-000072e0: 6f6e 5f73 7569 7465 2e69 6429 0a20 2020  on_suite.id).   
-000072f0: 2020 2020 2073 656c 662e 5f65 7870 6563       self._expec
-00007300: 7461 7469 6f6e 5f73 7569 7465 203d 204e  tation_suite = N
-00007310: 6f6e 650a 0a20 2020 2064 6566 2067 6574  one..    def get
-00007320: 5f6c 6174 6573 745f 7661 6c69 6461 7469  _latest_validati
-00007330: 6f6e 5f72 6570 6f72 7428 0a20 2020 2020  on_report(.     
-00007340: 2020 2073 656c 662c 2067 655f 7479 7065     self, ge_type
-00007350: 3a20 626f 6f6c 203d 2054 7275 650a 2020  : bool = True.  
-00007360: 2020 2920 2d3e 2055 6e69 6f6e 5b56 616c    ) -> Union[Val
-00007370: 6964 6174 696f 6e52 6570 6f72 742c 2067  idationReport, g
-00007380: 652e 636f 7265 2e45 7870 6563 7461 7469  e.core.Expectati
-00007390: 6f6e 5375 6974 6556 616c 6964 6174 696f  onSuiteValidatio
-000073a0: 6e52 6573 756c 742c 204e 6f6e 655d 3a0a  nResult, None]:.
-000073b0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-000073c0: 6e20 7468 6520 6c61 7465 7374 2076 616c  n the latest val
-000073d0: 6964 6174 696f 6e20 7265 706f 7274 2061  idation report a
-000073e0: 7474 6163 6865 6420 746f 2074 6865 2046  ttached to the F
-000073f0: 6561 7475 7265 2047 726f 7570 2069 6620  eature Group if 
-00007400: 6974 2065 7869 7374 732e 0a0a 2020 2020  it exists...    
-00007410: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
-00007420: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-00007430: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-00007440: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
-00007450: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
-00007460: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
-00007470: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
-00007480: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
-00007490: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
-000074a0: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
-000074b0: 6667 203d 2066 732e 6765 745f 6f72 5f63  fg = fs.get_or_c
-000074c0: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
-000074d0: 6f75 7028 2e2e 2e29 0a0a 2020 2020 2020  oup(...)..      
-000074e0: 2020 2020 2020 6c61 7465 7374 5f76 616c        latest_val
-000074f0: 5f72 6570 6f72 7420 3d20 6667 2e67 6574  _report = fg.get
-00007500: 5f6c 6174 6573 745f 7661 6c69 6461 7469  _latest_validati
-00007510: 6f6e 5f72 6570 6f72 7428 290a 2020 2020  on_report().    
-00007520: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
-00007530: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
-00007540: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
-00007550: 7479 7065 3a20 4966 2060 5472 7565 6020  type: If `True` 
-00007560: 7265 7475 726e 7320 6120 6e61 7469 7665  returns a native
-00007570: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
-00007580: 6f6e 2074 7970 652c 2048 6f70 7377 6f72  on type, Hopswor
-00007590: 6b73 0a20 2020 2020 2020 2020 2020 2020  ks.             
-000075a0: 2020 2063 7573 746f 6d20 7479 7065 206f     custom type o
-000075b0: 7468 6572 7769 7365 2e20 436f 6e76 6572  therwise. Conver
-000075c0: 7369 6f6e 2063 616e 2062 6520 7065 7266  sion can be perf
-000075d0: 6f72 6d65 6420 7669 6120 7468 6520 6074  ormed via the `t
-000075e0: 6f5f 6765 5f74 7970 6528 2960 0a20 2020  o_ge_type()`.   
-000075f0: 2020 2020 2020 2020 2020 2020 206d 6574               met
-00007600: 686f 6420 6f6e 2068 6f70 7377 6f72 6b73  hod on hopsworks
-00007610: 2074 7970 652e 2044 6566 6175 6c74 7320   type. Defaults 
-00007620: 746f 2060 5472 7565 602e 0a0a 2020 2020  to `True`...    
-00007630: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-00007640: 2020 2020 2020 2020 2020 6056 616c 6964            `Valid
-00007650: 6174 696f 6e52 6570 6f72 7460 2e20 5468  ationReport`. Th
-00007660: 6520 6c61 7465 7374 2076 616c 6964 6174  e latest validat
-00007670: 696f 6e20 7265 706f 7274 2061 7474 6163  ion report attac
-00007680: 6865 6420 746f 2074 6865 2046 6561 7475  hed to the Featu
-00007690: 7265 2047 726f 7570 2e0a 0a20 2020 2020  re Group...     
-000076a0: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
-000076b0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-000076c0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-000076d0: 5265 7374 4150 4945 7272 6f72 602e 0a20  RestAPIError`.. 
-000076e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000076f0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00007700: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
-00007710: 745f 656e 6769 6e65 2e67 6574 5f6c 6173  t_engine.get_las
-00007720: 7428 6765 5f74 7970 653d 6765 5f74 7970  t(ge_type=ge_typ
-00007730: 6529 0a0a 2020 2020 6465 6620 6765 745f  e)..    def get_
-00007740: 616c 6c5f 7661 6c69 6461 7469 6f6e 5f72  all_validation_r
-00007750: 6570 6f72 7473 280a 2020 2020 2020 2020  eports(.        
-00007760: 7365 6c66 2c20 6765 5f74 7970 653a 2062  self, ge_type: b
-00007770: 6f6f 6c20 3d20 5472 7565 0a20 2020 2029  ool = True.    )
-00007780: 202d 3e20 4c69 7374 5b55 6e69 6f6e 5b56   -> List[Union[V
-00007790: 616c 6964 6174 696f 6e52 6570 6f72 742c  alidationReport,
-000077a0: 2067 652e 636f 7265 2e45 7870 6563 7461   ge.core.Expecta
-000077b0: 7469 6f6e 5375 6974 6556 616c 6964 6174  tionSuiteValidat
-000077c0: 696f 6e52 6573 756c 745d 5d3a 0a20 2020  ionResult]]:.   
-000077d0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
-000077e0: 6865 206c 6174 6573 7420 7661 6c69 6461  he latest valida
-000077f0: 7469 6f6e 2072 6570 6f72 7420 6174 7461  tion report atta
-00007800: 6368 6564 2074 6f20 7468 6520 6665 6174  ched to the feat
-00007810: 7572 6520 6772 6f75 7020 6966 2069 7420  ure group if it 
-00007820: 6578 6973 7473 2e0a 0a20 2020 2020 2020  exists...       
-00007830: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-00007840: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00007850: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-00007860: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-00007870: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-00007880: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-00007890: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-000078a0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-000078b0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-000078c0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
-000078d0: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
-000078e0: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
-000078f0: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
-00007900: 2020 2076 616c 5f72 6570 6f72 7473 203d     val_reports =
-00007910: 2066 672e 6765 745f 616c 6c5f 7661 6c69   fg.get_all_vali
-00007920: 6461 7469 6f6e 5f72 6570 6f72 7473 2829  dation_reports()
-00007930: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-00007940: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-00007950: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00007960: 2020 6765 5f74 7970 653a 2049 6620 6054    ge_type: If `T
-00007970: 7275 6560 2072 6574 7572 6e73 2061 206e  rue` returns a n
-00007980: 6174 6976 6520 4772 6561 7420 4578 7065  ative Great Expe
-00007990: 6374 6174 696f 6e20 7479 7065 2c20 486f  ctation type, Ho
-000079a0: 7073 776f 726b 730a 2020 2020 2020 2020  psworks.        
-000079b0: 2020 2020 2020 2020 6375 7374 6f6d 2074          custom t
-000079c0: 7970 6520 6f74 6865 7277 6973 652e 2043  ype otherwise. C
-000079d0: 6f6e 7665 7273 696f 6e20 6361 6e20 6265  onversion can be
-000079e0: 2070 6572 666f 726d 6564 2076 6961 2074   performed via t
-000079f0: 6865 2060 746f 5f67 655f 7479 7065 2829  he `to_ge_type()
-00007a00: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-00007a10: 2020 6d65 7468 6f64 206f 6e20 686f 7073    method on hops
-00007a20: 776f 726b 7320 7479 7065 2e20 4465 6661  works type. Defa
-00007a30: 756c 7473 2074 6f20 6054 7275 6560 2e0a  ults to `True`..
-00007a40: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-00007a50: 6e73 0a20 2020 2020 2020 2020 2020 2055  ns.            U
-00007a60: 6e69 6f6e 5b4c 6973 745b 6056 616c 6964  nion[List[`Valid
-00007a70: 6174 696f 6e52 6570 6f72 7460 5d2c 2060  ationReport`], `
-00007a80: 5661 6c69 6461 7469 6f6e 5265 706f 7274  ValidationReport
-00007a90: 605d 2e20 416c 6c20 7661 6c69 6461 7469  `]. All validati
-00007aa0: 6f6e 2072 6570 6f72 7473 2061 7474 6163  on reports attac
-00007ab0: 6865 6420 746f 2074 6865 2066 6561 7475  hed to the featu
-00007ac0: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
-00007ad0: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
-00007ae0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-00007af0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-00007b00: 5265 7374 4150 4945 7272 6f72 602e 0a20  RestAPIError`.. 
-00007b10: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
-00007b20: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-00007b30: 6e73 2e46 6561 7475 7265 5374 6f72 6545  ns.FeatureStoreE
-00007b40: 7863 6570 7469 6f6e 602e 0a20 2020 2020  xception`..     
-00007b50: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00007b60: 6620 7365 6c66 2e5f 6964 3a0a 2020 2020  f self._id:.    
-00007b70: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00007b80: 656c 662e 5f76 616c 6964 6174 696f 6e5f  elf._validation_
-00007b90: 7265 706f 7274 5f65 6e67 696e 652e 6765  report_engine.ge
-00007ba0: 745f 616c 6c28 6765 5f74 7970 653d 6765  t_all(ge_type=ge
-00007bb0: 5f74 7970 6529 0a20 2020 2020 2020 2065  _type).        e
-00007bc0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00007bd0: 2072 6169 7365 2046 6561 7475 7265 5374   raise FeatureSt
-00007be0: 6f72 6545 7863 6570 7469 6f6e 280a 2020  oreException(.  
-00007bf0: 2020 2020 2020 2020 2020 2020 2020 224f                "O
-00007c00: 6e6c 7920 4665 6174 7572 6520 4772 6f75  nly Feature Grou
-00007c10: 7020 7265 6769 7374 6572 6564 2077 6974  p registered wit
-00007c20: 6820 486f 7073 776f 726b 7320 6361 6e20  h Hopsworks can 
-00007c30: 6665 7463 6820 7661 6c69 6461 7469 6f6e  fetch validation
-00007c40: 2072 6570 6f72 7473 2e22 0a20 2020 2020   reports.".     
-00007c50: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00007c60: 6620 7361 7665 5f76 616c 6964 6174 696f  f save_validatio
-00007c70: 6e5f 7265 706f 7274 280a 2020 2020 2020  n_report(.      
-00007c80: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00007c90: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
-00007ca0: 743a 2055 6e69 6f6e 5b0a 2020 2020 2020  t: Union[.      
-00007cb0: 2020 2020 2020 6469 6374 2c0a 2020 2020        dict,.    
-00007cc0: 2020 2020 2020 2020 5661 6c69 6461 7469          Validati
-00007cd0: 6f6e 5265 706f 7274 2c0a 2020 2020 2020  onReport,.      
-00007ce0: 2020 2020 2020 6765 2e63 6f72 652e 6578        ge.core.ex
-00007cf0: 7065 6374 6174 696f 6e5f 7661 6c69 6461  pectation_valida
-00007d00: 7469 6f6e 5f72 6573 756c 742e 4578 7065  tion_result.Expe
-00007d10: 6374 6174 696f 6e53 7569 7465 5661 6c69  ctationSuiteVali
-00007d20: 6461 7469 6f6e 5265 7375 6c74 2c0a 2020  dationResult,.  
-00007d30: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-00007d40: 2069 6e67 6573 7469 6f6e 5f72 6573 756c   ingestion_resul
-00007d50: 743a 2073 7472 203d 2022 554e 4b4e 4f57  t: str = "UNKNOW
-00007d60: 4e22 2c0a 2020 2020 2020 2020 6765 5f74  N",.        ge_t
-00007d70: 7970 653a 2062 6f6f 6c20 3d20 5472 7565  ype: bool = True
-00007d80: 2c0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ,.    ) -> Union
-00007d90: 5b56 616c 6964 6174 696f 6e52 6570 6f72  [ValidationRepor
-00007da0: 742c 2067 652e 636f 7265 2e45 7870 6563  t, ge.core.Expec
-00007db0: 7461 7469 6f6e 5375 6974 6556 616c 6964  tationSuiteValid
-00007dc0: 6174 696f 6e52 6573 756c 745d 3a0a 2020  ationResult]:.  
-00007dd0: 2020 2020 2020 2222 2253 6176 6520 7661        """Save va
-00007de0: 6c69 6461 7469 6f6e 2072 6570 6f72 7420  lidation report 
-00007df0: 746f 2068 6f70 7377 6f72 6b73 2070 6c61  to hopsworks pla
-00007e00: 7466 6f72 6d20 616c 6f6e 6720 7072 6576  tform along prev
-00007e10: 696f 7573 2072 6570 6f72 7473 206f 6620  ious reports of 
-00007e20: 7468 6520 7361 6d65 2046 6561 7475 7265  the same Feature
-00007e30: 2047 726f 7570 2e0a 0a20 2020 2020 2020   Group...       
-00007e40: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-00007e50: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00007e60: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-00007e70: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-00007e80: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-00007e90: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-00007ea0: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-00007eb0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-00007ec0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-00007ed0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
-00007ee0: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
-00007ef0: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
-00007f00: 282e 2e2e 2c20 6578 7065 6374 6174 696f  (..., expectatio
-00007f10: 6e5f 7375 6974 653d 6578 7065 6374 6174  n_suite=expectat
-00007f20: 696f 6e5f 7375 6974 6529 0a0a 2020 2020  ion_suite)..    
-00007f30: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
-00007f40: 6f6e 5f72 6570 6f72 7420 3d20 6772 6561  on_report = grea
-00007f50: 745f 6578 7065 6374 6174 696f 6e73 2e66  t_expectations.f
-00007f60: 726f 6d5f 7061 6e64 6173 280a 2020 2020  rom_pandas(.    
-00007f70: 2020 2020 2020 2020 2020 2020 6d79 5f65              my_e
-00007f80: 7870 6572 696d 656e 7461 6c5f 6665 6174  xperimental_feat
-00007f90: 7572 6573 5f64 662c 0a20 2020 2020 2020  ures_df,.       
-00007fa0: 2020 2020 2020 2020 2066 672e 6765 745f           fg.get_
-00007fb0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00007fc0: 6528 2929 2e76 616c 6964 6174 6528 290a  e()).validate().
-00007fd0: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
-00007fe0: 7361 7665 5f76 616c 6964 6174 696f 6e5f  save_validation_
-00007ff0: 7265 706f 7274 2876 616c 6964 6174 696f  report(validatio
-00008000: 6e5f 7265 706f 7274 2c20 696e 6765 7374  n_report, ingest
-00008010: 696f 6e5f 7265 7375 6c74 3d22 4558 5045  ion_result="EXPE
-00008020: 5249 4d45 4e54 2229 0a20 2020 2020 2020  RIMENT").       
-00008030: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-00008040: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-00008050: 2020 2020 2020 2020 2020 7661 6c69 6461            valida
-00008060: 7469 6f6e 5f72 6570 6f72 743a 2054 6865  tion_report: The
-00008070: 2076 616c 6964 6174 696f 6e20 7265 706f   validation repo
-00008080: 7274 2074 6f20 6174 7461 6368 2074 6f20  rt to attach to 
-00008090: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
-000080a0: 702e 0a20 2020 2020 2020 2020 2020 2069  p..            i
-000080b0: 6e67 6573 7469 6f6e 5f72 6573 756c 743a  ngestion_result:
-000080c0: 2053 7065 6369 6679 2074 6865 2066 6174   Specify the fat
-000080d0: 6520 6f66 2074 6865 2061 7373 6f63 6961  e of the associa
-000080e0: 7465 6420 6461 7461 2c20 6465 6661 756c  ted data, defaul
-000080f0: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
-00008100: 2020 2074 6f20 2255 4e4b 4e4f 574e 222e     to "UNKNOWN".
-00008110: 2053 7570 706f 7274 6564 206f 7074 696f   Supported optio
-00008120: 6e73 2061 7265 2020 2255 4e4b 4e4f 574e  ns are  "UNKNOWN
-00008130: 222c 2022 494e 4745 5354 4544 222c 2022  ", "INGESTED", "
-00008140: 5245 4a45 4354 4544 222c 0a20 2020 2020  REJECTED",.     
-00008150: 2020 2020 2020 2020 2020 2022 4558 5045             "EXPE
-00008160: 5249 4d45 4e54 222c 2022 4647 5f44 4154  RIMENT", "FG_DAT
-00008170: 4122 2e20 5573 6520 2249 4e47 4553 5445  A". Use "INGESTE
-00008180: 4422 206f 7220 2252 454a 4543 5445 4422  D" or "REJECTED"
-00008190: 2066 6f72 2076 616c 6964 6174 696f 6e0a   for validation.
-000081a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000081b0: 6f66 2044 6174 6146 7261 6d65 7320 746f  of DataFrames to
-000081c0: 2062 6520 696e 7365 7274 6564 2069 6e20   be inserted in 
-000081d0: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
-000081e0: 702e 2055 7365 2022 4558 5045 5249 4d45  p. Use "EXPERIME
-000081f0: 4e54 220a 2020 2020 2020 2020 2020 2020  NT".            
-00008200: 2020 2020 666f 7220 7465 7374 696e 6720      for testing 
-00008210: 616e 6420 6465 7665 6c6f 706d 656e 7420  and development 
-00008220: 616e 6420 2246 475f 4441 5441 2220 7768  and "FG_DATA" wh
-00008230: 656e 2076 616c 6964 6174 696e 6720 6461  en validating da
-00008240: 7461 0a20 2020 2020 2020 2020 2020 2020  ta.             
-00008250: 2020 2061 6c72 6561 6479 2069 6e20 7468     already in th
-00008260: 6520 4665 6174 7572 6520 4772 6f75 702e  e Feature Group.
-00008270: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
-00008280: 7479 7065 3a20 4966 2060 5472 7565 6020  type: If `True` 
-00008290: 7265 7475 726e 7320 6120 6e61 7469 7665  returns a native
-000082a0: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
-000082b0: 6f6e 2074 7970 652c 2048 6f70 7377 6f72  on type, Hopswor
-000082c0: 6b73 0a20 2020 2020 2020 2020 2020 2020  ks.             
-000082d0: 2020 2063 7573 746f 6d20 7479 7065 206f     custom type o
-000082e0: 7468 6572 7769 7365 2e20 436f 6e76 6572  therwise. Conver
-000082f0: 7369 6f6e 2063 616e 2062 6520 7065 7266  sion can be perf
-00008300: 6f72 6d65 6420 7669 6120 7468 6520 6074  ormed via the `t
-00008310: 6f5f 6765 5f74 7970 6528 2960 0a20 2020  o_ge_type()`.   
-00008320: 2020 2020 2020 2020 2020 2020 206d 6574               met
-00008330: 686f 6420 6f6e 2068 6f70 7377 6f72 6b73  hod on hopsworks
-00008340: 2074 7970 652e 2044 6566 6175 6c74 7320   type. Defaults 
-00008350: 746f 2060 5472 7565 602e 0a0a 2020 2020  to `True`...    
-00008360: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
-00008370: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
-00008380: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-00008390: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
-000083a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000083b0: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
-000083c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000083d0: 6973 696e 7374 616e 6365 280a 2020 2020  isinstance(.    
-000083e0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-000083f0: 6461 7469 6f6e 5f72 6570 6f72 742c 0a20  dation_report,. 
-00008400: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00008410: 652e 636f 7265 2e65 7870 6563 7461 7469  e.core.expectati
-00008420: 6f6e 5f76 616c 6964 6174 696f 6e5f 7265  on_validation_re
-00008430: 7375 6c74 2e45 7870 6563 7461 7469 6f6e  sult.Expectation
-00008440: 5375 6974 6556 616c 6964 6174 696f 6e52  SuiteValidationR
-00008450: 6573 756c 742c 0a20 2020 2020 2020 2020  esult,.         
-00008460: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00008470: 2020 2020 2020 7265 706f 7274 203d 2056        report = V
-00008480: 616c 6964 6174 696f 6e52 6570 6f72 7428  alidationReport(
-00008490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000084a0: 2020 2020 202a 2a76 616c 6964 6174 696f       **validatio
-000084b0: 6e5f 7265 706f 7274 2e74 6f5f 6a73 6f6e  n_report.to_json
-000084c0: 5f64 6963 7428 292c 0a20 2020 2020 2020  _dict(),.       
-000084d0: 2020 2020 2020 2020 2020 2020 2069 6e67               ing
-000084e0: 6573 7469 6f6e 5f72 6573 756c 743d 696e  estion_result=in
-000084f0: 6765 7374 696f 6e5f 7265 7375 6c74 2c0a  gestion_result,.
-00008500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008510: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00008520: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-00008530: 6c69 6461 7469 6f6e 5f72 6570 6f72 742c  lidation_report,
-00008540: 2064 6963 7429 3a0a 2020 2020 2020 2020   dict):.        
-00008550: 2020 2020 2020 2020 7265 706f 7274 203d          report =
-00008560: 2056 616c 6964 6174 696f 6e52 6570 6f72   ValidationRepor
-00008570: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00008580: 2020 2020 2020 202a 2a76 616c 6964 6174         **validat
-00008590: 696f 6e5f 7265 706f 7274 2c20 696e 6765  ion_report, inge
-000085a0: 7374 696f 6e5f 7265 7375 6c74 3d69 6e67  stion_result=ing
-000085b0: 6573 7469 6f6e 5f72 6573 756c 740a 2020  estion_result.  
-000085c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000085d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000085e0: 2069 7369 6e73 7461 6e63 6528 7661 6c69   isinstance(vali
-000085f0: 6461 7469 6f6e 5f72 6570 6f72 742c 2056  dation_report, V
-00008600: 616c 6964 6174 696f 6e52 6570 6f72 7429  alidationReport)
-00008610: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00008620: 2020 7265 706f 7274 203d 2076 616c 6964    report = valid
-00008630: 6174 696f 6e5f 7265 706f 7274 0a20 2020  ation_report.   
-00008640: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00008650: 696e 6765 7374 696f 6e5f 7265 7375 6c74  ingestion_result
-00008660: 2021 3d20 2255 4e4b 4e4f 574e 223a 0a20   != "UNKNOWN":. 
-00008670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008680: 2020 2072 6570 6f72 742e 696e 6765 7374     report.ingest
-00008690: 696f 6e5f 7265 7375 6c74 203d 2069 6e67  ion_result = ing
-000086a0: 6573 7469 6f6e 5f72 6573 756c 740a 0a20  estion_result.. 
-000086b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000086c0: 6e20 7365 6c66 2e5f 7661 6c69 6461 7469  n self._validati
-000086d0: 6f6e 5f72 6570 6f72 745f 656e 6769 6e65  on_report_engine
-000086e0: 2e73 6176 6528 0a20 2020 2020 2020 2020  .save(.         
-000086f0: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
-00008700: 6e5f 7265 706f 7274 3d72 6570 6f72 742c  n_report=report,
-00008710: 2067 655f 7479 7065 3d67 655f 7479 7065   ge_type=ge_type
-00008720: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00008730: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00008740: 2020 2020 2020 2020 2072 6169 7365 2046           raise F
-00008750: 6561 7475 7265 5374 6f72 6545 7863 6570  eatureStoreExcep
-00008760: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00008770: 2020 2020 2020 224f 6e6c 7920 4665 6174        "Only Feat
-00008780: 7572 6520 4772 6f75 7020 7265 6769 7374  ure Group regist
-00008790: 6572 6564 2077 6974 6820 486f 7073 776f  ered with Hopswo
-000087a0: 726b 7320 6361 6e20 7570 6c6f 6164 2076  rks can upload v
-000087b0: 616c 6964 6174 696f 6e20 7265 706f 7274  alidation report
-000087c0: 732e 220a 2020 2020 2020 2020 2020 2020  s.".            
-000087d0: 290a 0a20 2020 2064 6566 2067 6574 5f76  )..    def get_v
-000087e0: 616c 6964 6174 696f 6e5f 6869 7374 6f72  alidation_histor
-000087f0: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
-00008800: 0a20 2020 2020 2020 2065 7870 6563 7461  .        expecta
-00008810: 7469 6f6e 5f69 643a 2069 6e74 2c0a 2020  tion_id: int,.  
-00008820: 2020 2020 2020 7374 6172 745f 7661 6c69        start_vali
-00008830: 6461 7469 6f6e 5f74 696d 653a 2055 6e69  dation_time: Uni
-00008840: 6f6e 5b73 7472 2c20 696e 742c 2064 6174  on[str, int, dat
-00008850: 6574 696d 652c 2064 6174 652c 204e 6f6e  etime, date, Non
-00008860: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
-00008870: 2020 2065 6e64 5f76 616c 6964 6174 696f     end_validatio
-00008880: 6e5f 7469 6d65 3a20 556e 696f 6e5b 7374  n_time: Union[st
-00008890: 722c 2069 6e74 2c20 6461 7465 7469 6d65  r, int, datetime
-000088a0: 2c20 6461 7465 2c20 4e6f 6e65 5d20 3d20  , date, None] = 
-000088b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6669  None,.        fi
-000088c0: 6c74 6572 5f62 793a 204c 6973 745b 7374  lter_by: List[st
-000088d0: 725d 203d 205b 5d2c 0a20 2020 2020 2020  r] = [],.       
-000088e0: 2067 655f 7479 7065 3a20 626f 6f6c 203d   ge_type: bool =
-000088f0: 2054 7275 652c 0a20 2020 2029 202d 3e20   True,.    ) -> 
-00008900: 556e 696f 6e5b 4c69 7374 5b56 616c 6964  Union[List[Valid
-00008910: 6174 696f 6e52 6573 756c 745d 2c20 4c69  ationResult], Li
-00008920: 7374 5b67 652e 636f 7265 2e45 7870 6563  st[ge.core.Expec
-00008930: 7461 7469 6f6e 5661 6c69 6461 7469 6f6e  tationValidation
-00008940: 5265 7375 6c74 5d5d 3a0a 2020 2020 2020  Result]]:.      
-00008950: 2020 2222 2246 6574 6368 2076 616c 6964    """Fetch valid
-00008960: 6174 696f 6e20 6869 7374 6f72 7920 6f66  ation history of
-00008970: 2061 6e20 4578 7065 6374 6174 696f 6e20   an Expectation 
-00008980: 7370 6563 6966 6965 6420 6279 2069 7473  specified by its
-00008990: 2069 642e 0a0a 2020 2020 2020 2020 2121   id...        !!
-000089a0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-000089b0: 2020 6060 6070 7974 686f 6e33 0a20 2020    ```python3.   
-000089c0: 2020 2020 2076 616c 6964 6174 696f 6e5f       validation_
-000089d0: 6869 7374 6f72 7920 3d20 6667 2e67 6574  history = fg.get
-000089e0: 5f76 616c 6964 6174 696f 6e5f 6869 7374  _validation_hist
-000089f0: 6f72 7928 0a20 2020 2020 2020 2020 2020  ory(.           
-00008a00: 2065 7870 6563 7461 7469 6f6e 5f69 643d   expectation_id=
-00008a10: 312c 0a20 2020 2020 2020 2020 2020 2066  1,.            f
-00008a20: 696c 7465 725f 6279 3d5b 2252 454a 4543  ilter_by=["REJEC
-00008a30: 5445 4422 2c20 2255 4e4b 4e4f 574e 225d  TED", "UNKNOWN"]
-00008a40: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
-00008a50: 6172 745f 7661 6c69 6461 7469 6f6e 5f74  art_validation_t
-00008a60: 696d 653d 2232 3032 322d 3031 2d30 3120  ime="2022-01-01 
-00008a70: 3030 3a30 303a 3030 222c 0a20 2020 2020  00:00:00",.     
-00008a80: 2020 2020 2020 2065 6e64 5f76 616c 6964         end_valid
-00008a90: 6174 696f 6e5f 7469 6d65 3d64 6174 6574  ation_time=datet
-00008aa0: 696d 652e 6461 7465 7469 6d65 2e6e 6f77  ime.datetime.now
-00008ab0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
-00008ac0: 6765 5f74 7970 653d 4661 6c73 650a 2020  ge_type=False.  
-00008ad0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00008ae0: 6060 600a 0a20 2020 2020 2020 2023 2041  ```..        # A
-00008af0: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
-00008b00: 2020 2020 2065 7870 6563 7461 7469 6f6e       expectation
-00008b10: 5f69 643a 2069 6420 6f66 2074 6865 2045  _id: id of the E
-00008b20: 7870 6563 7461 7469 6f6e 2066 6f72 2077  xpectation for w
-00008b30: 6869 6368 2074 6f20 6665 7463 6820 7468  hich to fetch th
-00008b40: 6520 7661 6c69 6461 7469 6f6e 2068 6973  e validation his
-00008b50: 746f 7279 0a20 2020 2020 2020 2020 2020  tory.           
-00008b60: 2066 696c 7465 725f 6279 3a20 6c69 7374   filter_by: list
-00008b70: 206f 6620 696e 6765 7374 696f 6e5f 7265   of ingestion_re
-00008b80: 7375 6c74 2063 6174 6567 6f72 7920 746f  sult category to
-00008b90: 206b 6565 702e 204f 6f70 7469 6f6e 7320   keep. Ooptions 
-00008ba0: 6172 6520 2249 4e47 4553 5445 4422 2c20  are "INGESTED", 
-00008bb0: 2252 454a 4543 5445 4422 2c20 2246 475f  "REJECTED", "FG_
-00008bc0: 4441 5441 222c 2022 4558 5045 5249 4d45  DATA", "EXPERIME
-00008bd0: 4e54 222c 2022 554e 4b4e 4f57 4e22 2e0a  NT", "UNKNOWN"..
-00008be0: 2020 2020 2020 2020 2020 2020 7374 6172              star
-00008bf0: 745f 7661 6c69 6461 7469 6f6e 5f74 696d  t_validation_tim
-00008c00: 653a 2066 6574 6368 206f 6e6c 7920 7661  e: fetch only va
-00008c10: 6c69 6461 7469 6f6e 2072 6573 756c 7420  lidation result 
-00008c20: 706f 7374 6572 696f 7220 746f 2074 6865  posterior to the
-00008c30: 2070 726f 7669 6465 6420 7469 6d65 2c20   provided time, 
-00008c40: 696e 636c 7573 6976 652e 0a20 2020 2020  inclusive..     
-00008c50: 2020 2020 2020 2053 7570 706f 7274 6564         Supported
-00008c60: 2066 6f72 6d61 7420 696e 636c 7564 6520   format include 
-00008c70: 7469 6d65 7374 616d 7073 2869 6e74 292c  timestamps(int),
-00008c80: 2064 6174 6574 696d 652c 2064 6174 6520   datetime, date 
-00008c90: 6f72 2073 7472 696e 6720 666f 726d 6174  or string format
-00008ca0: 7465 6420 746f 2062 6520 6461 7475 7469  ted to be datuti
-00008cb0: 6c73 2070 6172 7361 626c 652e 2053 6565  ls parsable. See
-00008cc0: 2065 7861 6d70 6c65 7320 6162 6f76 652e   examples above.
-00008cd0: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
-00008ce0: 5f76 616c 6964 6174 696f 6e5f 7469 6d65  _validation_time
-00008cf0: 3a20 6665 7463 6820 6f6e 6c79 2076 616c  : fetch only val
-00008d00: 6964 6174 696f 6e20 7265 7375 6c74 2070  idation result p
-00008d10: 7269 6f72 2074 6f20 7468 6520 7072 6f76  rior to the prov
-00008d20: 6964 6564 2074 696d 652c 2069 6e63 6c75  ided time, inclu
-00008d30: 7369 7665 2e0a 2020 2020 2020 2020 2020  sive..          
-00008d40: 2020 5375 7070 6f72 7465 6420 666f 726d    Supported form
-00008d50: 6174 2069 6e63 6c75 6465 2074 696d 6573  at include times
-00008d60: 7461 6d70 7328 696e 7429 2c20 6461 7465  tamps(int), date
-00008d70: 7469 6d65 2c20 6461 7465 206f 7220 7374  time, date or st
-00008d80: 7269 6e67 2066 6f72 6d61 7474 6564 2074  ring formatted t
-00008d90: 6f20 6265 2064 6174 7574 696c 7320 7061  o be datutils pa
-00008da0: 7273 6162 6c65 2e20 5365 6520 6578 616d  rsable. See exam
-00008db0: 706c 6573 2061 626f 7665 2e0a 0a20 2020  ples above...   
-00008dc0: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
-00008dd0: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-00008de0: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-00008df0: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
-00008e00: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
-00008e10: 726e 0a20 2020 2020 2020 2020 2020 2055  rn.            U
-00008e20: 6e69 6f6e 5b4c 6973 745b 6056 616c 6964  nion[List[`Valid
-00008e30: 6174 696f 6e52 6573 756c 7460 5d2c 204c  ationResult`], L
-00008e40: 6973 745b 6045 7870 6563 7461 7469 6f6e  ist[`Expectation
-00008e50: 5661 6c69 6461 7469 6f6e 5265 7375 6c74  ValidationResult
-00008e60: 605d 5d20 4120 6c69 7374 206f 6620 7661  `]] A list of va
-00008e70: 6c69 6461 7469 6f6e 2072 6573 756c 7420  lidation result 
-00008e80: 636f 6e6e 6563 7465 6420 746f 2074 6865  connected to the
-00008e90: 2065 7870 6563 7461 7469 6f6e 5f69 640a   expectation_id.
-00008ea0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00008eb0: 2020 2020 6d61 6a6f 722c 206d 696e 6f72      major, minor
-00008ec0: 203d 2073 656c 662e 5f76 6172 6961 626c   = self._variabl
-00008ed0: 655f 6170 692e 7061 7273 655f 6d61 6a6f  e_api.parse_majo
-00008ee0: 725f 616e 645f 6d69 6e6f 7228 0a20 2020  r_and_minor(.   
-00008ef0: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
-00008f00: 6172 6961 626c 655f 6170 692e 6765 745f  ariable_api.get_
-00008f10: 7665 7273 696f 6e28 2268 6f70 7377 6f72  version("hopswor
-00008f20: 6b73 2229 0a20 2020 2020 2020 2029 0a20  ks").        ). 
-00008f30: 2020 2020 2020 2069 6620 6d61 6a6f 7220         if major 
-00008f40: 3d3d 2022 3322 2061 6e64 206d 696e 6f72  == "3" and minor
-00008f50: 203d 3d20 2230 223a 0a20 2020 2020 2020   == "0":.       
-00008f60: 2020 2020 2072 6169 7365 2046 6561 7475       raise Featu
-00008f70: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
-00008f80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00008f90: 2020 2254 6865 2068 6f70 7377 6f72 6b73    "The hopsworks
-00008fa0: 2073 6572 7665 7220 646f 6573 206e 6f74   server does not
-00008fb0: 2073 7570 706f 7274 2074 6869 7320 6f70   support this op
-00008fc0: 6572 6174 696f 6e2e 2055 7064 6174 6520  eration. Update 
-00008fd0: 7365 7276 6572 2074 6f20 686f 7073 776f  server to hopswo
-00008fe0: 726b 7320 3e33 2e31 2074 6f20 656e 6162  rks >3.1 to enab
-00008ff0: 6c65 2073 7570 706f 7274 2e22 0a20 2020  le support.".   
-00009000: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00009010: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
-00009020: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00009030: 7572 6e20 7365 6c66 2e5f 7661 6c69 6461  urn self._valida
-00009040: 7469 6f6e 5f72 6573 756c 745f 656e 6769  tion_result_engi
-00009050: 6e65 2e67 6574 5f76 616c 6964 6174 696f  ne.get_validatio
-00009060: 6e5f 6869 7374 6f72 7928 0a20 2020 2020  n_history(.     
-00009070: 2020 2020 2020 2020 2020 2065 7870 6563             expec
-00009080: 7461 7469 6f6e 5f69 643d 6578 7065 6374  tation_id=expect
-00009090: 6174 696f 6e5f 6964 2c0a 2020 2020 2020  ation_id,.      
-000090a0: 2020 2020 2020 2020 2020 7374 6172 745f            start_
-000090b0: 7661 6c69 6461 7469 6f6e 5f74 696d 653d  validation_time=
-000090c0: 7374 6172 745f 7661 6c69 6461 7469 6f6e  start_validation
-000090d0: 5f74 696d 652c 0a20 2020 2020 2020 2020  _time,.         
-000090e0: 2020 2020 2020 2065 6e64 5f76 616c 6964         end_valid
-000090f0: 6174 696f 6e5f 7469 6d65 3d65 6e64 5f76  ation_time=end_v
-00009100: 616c 6964 6174 696f 6e5f 7469 6d65 2c0a  alidation_time,.
-00009110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009120: 6669 6c74 6572 5f62 793d 6669 6c74 6572  filter_by=filter
-00009130: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-00009140: 2020 2020 2067 655f 7479 7065 3d67 655f       ge_type=ge_
-00009150: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-00009160: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-00009170: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00009180: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
-00009190: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
-000091a0: 2020 2020 2020 2020 2020 2022 4f6e 6c79             "Only
-000091b0: 2046 6561 7475 7265 2047 726f 7570 2072   Feature Group r
-000091c0: 6567 6973 7465 7265 6420 7769 7468 2048  egistered with H
-000091d0: 6f70 7377 6f72 6b73 2063 616e 2066 6574  opsworks can fet
-000091e0: 6368 2076 616c 6964 6174 696f 6e20 6869  ch validation hi
-000091f0: 7374 6f72 792e 220a 2020 2020 2020 2020  story.".        
-00009200: 2020 2020 290a 0a20 2020 2064 6566 2076      )..    def v
-00009210: 616c 6964 6174 6528 0a20 2020 2020 2020  alidate(.       
-00009220: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
-00009230: 6174 6166 7261 6d65 3a20 4f70 7469 6f6e  ataframe: Option
-00009240: 616c 5b0a 2020 2020 2020 2020 2020 2020  al[.            
-00009250: 556e 696f 6e5b 7064 2e44 6174 6146 7261  Union[pd.DataFra
-00009260: 6d65 2c20 5479 7065 5661 7228 2270 7973  me, TypeVar("pys
-00009270: 7061 726b 2e73 716c 2e44 6174 6146 7261  park.sql.DataFra
-00009280: 6d65 2229 5d20 2023 206e 6f71 613a 2046  me")]  # noqa: F
-00009290: 3832 310a 2020 2020 2020 2020 5d20 3d20  821.        ] = 
-000092a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
-000092b0: 7065 6374 6174 696f 6e5f 7375 6974 653a  pectation_suite:
-000092c0: 204f 7074 696f 6e61 6c5b 4578 7065 6374   Optional[Expect
-000092d0: 6174 696f 6e53 7569 7465 5d20 3d20 4e6f  ationSuite] = No
-000092e0: 6e65 2c0a 2020 2020 2020 2020 7361 7665  ne,.        save
-000092f0: 5f72 6570 6f72 743a 204f 7074 696f 6e61  _report: Optiona
-00009300: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
-00009310: 0a20 2020 2020 2020 2076 616c 6964 6174  .        validat
-00009320: 696f 6e5f 6f70 7469 6f6e 733a 204f 7074  ion_options: Opt
-00009330: 696f 6e61 6c5b 4469 6374 5b41 6e79 2c20  ional[Dict[Any, 
-00009340: 416e 795d 5d20 3d20 7b7d 2c0a 2020 2020  Any]] = {},.    
-00009350: 2020 2020 696e 6765 7374 696f 6e5f 7265      ingestion_re
-00009360: 7375 6c74 3a20 7374 7220 3d20 2255 4e4b  sult: str = "UNK
-00009370: 4e4f 574e 222c 0a20 2020 2020 2020 2067  NOWN",.        g
-00009380: 655f 7479 7065 3a20 626f 6f6c 203d 2054  e_type: bool = T
-00009390: 7275 652c 0a20 2020 2029 202d 3e20 556e  rue,.    ) -> Un
-000093a0: 696f 6e5b 6765 2e63 6f72 652e 4578 7065  ion[ge.core.Expe
-000093b0: 6374 6174 696f 6e53 7569 7465 5661 6c69  ctationSuiteVali
-000093c0: 6461 7469 6f6e 5265 7375 6c74 2c20 5661  dationResult, Va
-000093d0: 6c69 6461 7469 6f6e 5265 706f 7274 2c20  lidationReport, 
-000093e0: 4e6f 6e65 5d3a 0a20 2020 2020 2020 2022  None]:.        "
-000093f0: 2222 5275 6e20 7661 6c69 6461 7469 6f6e  ""Run validation
-00009400: 2062 6173 6564 206f 6e20 7468 6520 6174   based on the at
-00009410: 7461 6368 6564 2065 7870 6563 7461 7469  tached expectati
-00009420: 6f6e 732e 0a0a 2020 2020 2020 2020 5275  ons...        Ru
-00009430: 6e73 2061 6e79 2065 7870 6563 7461 7469  ns any expectati
-00009440: 6f6e 2061 7474 6163 6865 6420 7769 7468  on attached with
-00009450: 2044 6565 7175 2e20 4275 7420 616c 736f   Deequ. But also
-00009460: 2072 756e 7320 6174 7461 6368 6564 2047   runs attached G
-00009470: 7265 6174 2045 7870 6563 7461 7469 6f6e  reat Expectation
-00009480: 0a20 2020 2020 2020 2053 7569 7465 732e  .        Suites.
-00009490: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
-000094a0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-000094b0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-000094c0: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-000094d0: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-000094e0: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-000094f0: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-00009500: 2020 2020 2020 2020 2023 2067 6574 2066           # get f
-00009510: 6561 7475 7265 2067 726f 7570 2069 6e73  eature group ins
-00009520: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
-00009530: 2020 6667 203d 2066 732e 6765 745f 6f72    fg = fs.get_or
-00009540: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
-00009550: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
-00009560: 2020 2020 2020 2020 6765 5f72 6570 6f72          ge_repor
-00009570: 7420 3d20 6667 2e76 616c 6964 6174 6528  t = fg.validate(
-00009580: 6466 2c20 7361 7665 5f72 6570 6f72 743d  df, save_report=
-00009590: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-000095a0: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-000095b0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
-000095c0: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
-000095d0: 653a 2054 6865 2064 6174 6166 7261 6d65  e: The dataframe
-000095e0: 2074 6f20 7275 6e20 7468 6520 6461 7461   to run the data
-000095f0: 2076 616c 6964 6174 696f 6e20 6578 7065   validation expe
-00009600: 6374 6174 696f 6e73 2061 6761 696e 7374  ctations against
-00009610: 2e0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-00009620: 7065 6374 6174 696f 6e5f 7375 6974 653a  pectation_suite:
-00009630: 204f 7074 696f 6e61 6c6c 7920 7072 6f76   Optionally prov
-00009640: 6964 6520 616e 2045 7870 6563 7461 7469  ide an Expectati
-00009650: 6f6e 2053 7569 7465 2074 6f20 6f76 6572  on Suite to over
-00009660: 7269 6465 2074 6865 0a20 2020 2020 2020  ride the.       
-00009670: 2020 2020 2020 2020 206f 6e65 2074 6861           one tha
-00009680: 7420 6973 2070 6f73 7369 626c 7920 6174  t is possibly at
-00009690: 7461 6368 6564 2074 6f20 7468 6520 6665  tached to the fe
-000096a0: 6174 7572 6520 6772 6f75 702e 2054 6869  ature group. Thi
-000096b0: 7320 6973 2075 7365 6675 6c20 666f 720a  s is useful for.
-000096c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000096d0: 7465 7374 696e 6720 6e65 7720 4578 7065  testing new Expe
-000096e0: 6374 6174 696f 6e20 7375 6974 6573 2e20  ctation suites. 
-000096f0: 5768 656e 2061 6e20 6578 7472 6120 7375  When an extra su
-00009700: 6974 6520 6973 2070 726f 7669 6465 642c  ite is provided,
-00009710: 2074 6865 2072 6573 756c 7473 0a20 2020   the results.   
-00009720: 2020 2020 2020 2020 2020 2020 2077 696c               wil
-00009730: 6c20 6e65 7665 7220 6265 2070 6572 7369  l never be persi
-00009740: 7374 6564 2e20 4465 6661 756c 7473 2074  sted. Defaults t
-00009750: 6f20 604e 6f6e 6560 2e0a 2020 2020 2020  o `None`..      
-00009760: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
-00009770: 5f6f 7074 696f 6e73 3a20 4164 6469 7469  _options: Additi
-00009780: 6f6e 616c 2076 616c 6964 6174 696f 6e20  onal validation 
-00009790: 6f70 7469 6f6e 7320 6173 206b 6579 2d76  options as key-v
-000097a0: 616c 7565 2070 6169 7273 2c20 6465 6661  alue pairs, defa
-000097b0: 756c 7473 2074 6f20 607b 7d60 2e0a 2020  ults to `{}`..  
-000097c0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-000097d0: 6b65 7920 6072 756e 5f76 616c 6964 6174  key `run_validat
-000097e0: 696f 6e60 2062 6f6f 6c65 616e 2076 616c  ion` boolean val
-000097f0: 7565 2c20 7365 7420 746f 2060 4661 6c73  ue, set to `Fals
-00009800: 6560 2074 6f20 736b 6970 2076 616c 6964  e` to skip valid
-00009810: 6174 696f 6e20 7465 6d70 6f72 6172 696c  ation temporaril
-00009820: 7920 6f6e 2069 6e67 6573 7469 6f6e 2e0a  y on ingestion..
-00009830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009840: 2a20 6b65 7920 6067 655f 7661 6c69 6461  * key `ge_valida
-00009850: 7465 5f6b 7761 7267 7360 2061 2064 6963  te_kwargs` a dic
-00009860: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00009870: 6e67 206b 7761 7267 7320 666f 7220 7468  ng kwargs for th
-00009880: 6520 7661 6c69 6461 7465 206d 6574 686f  e validate metho
-00009890: 6420 6f66 2047 7265 6174 2045 7870 6563  d of Great Expec
-000098a0: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
-000098b0: 2020 2020 2069 6e67 6573 7469 6f6e 5f72       ingestion_r
-000098c0: 6573 756c 743a 2053 7065 6369 6679 2074  esult: Specify t
-000098d0: 6865 2066 6174 6520 6f66 2074 6865 2061  he fate of the a
-000098e0: 7373 6f63 6961 7465 6420 6461 7461 2c20  ssociated data, 
-000098f0: 6465 6661 756c 7473 0a20 2020 2020 2020  defaults.       
-00009900: 2020 2020 2020 2020 2074 6f20 2255 4e4b           to "UNK
-00009910: 4e4f 574e 222e 2053 7570 706f 7274 6564  NOWN". Supported
-00009920: 206f 7074 696f 6e73 2061 7265 2020 2255   options are  "U
-00009930: 4e4b 4e4f 574e 222c 2022 494e 4745 5354  NKNOWN", "INGEST
-00009940: 4544 222c 2022 5245 4a45 4354 4544 222c  ED", "REJECTED",
-00009950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009960: 2022 4558 5045 5249 4d45 4e54 222c 2022   "EXPERIMENT", "
-00009970: 4647 5f44 4154 4122 2e20 5573 6520 2249  FG_DATA". Use "I
-00009980: 4e47 4553 5445 4422 206f 7220 2252 454a  NGESTED" or "REJ
-00009990: 4543 5445 4422 2066 6f72 2076 616c 6964  ECTED" for valid
-000099a0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-000099b0: 2020 2020 2020 6f66 2044 6174 6146 7261        of DataFra
-000099c0: 6d65 7320 746f 2062 6520 696e 7365 7274  mes to be insert
-000099d0: 6564 2069 6e20 7468 6520 4665 6174 7572  ed in the Featur
-000099e0: 6520 4772 6f75 702e 2055 7365 2022 4558  e Group. Use "EX
-000099f0: 5045 5249 4d45 4e54 220a 2020 2020 2020  PERIMENT".      
-00009a00: 2020 2020 2020 2020 2020 666f 7220 7465            for te
-00009a10: 7374 696e 6720 616e 6420 6465 7665 6c6f  sting and develo
-00009a20: 706d 656e 7420 616e 6420 2246 475f 4441  pment and "FG_DA
-00009a30: 5441 2220 7768 656e 2076 616c 6964 6174  TA" when validat
-00009a40: 696e 6720 6461 7461 0a20 2020 2020 2020  ing data.       
-00009a50: 2020 2020 2020 2020 2061 6c72 6561 6479           already
-00009a60: 2069 6e20 7468 6520 4665 6174 7572 6520   in the Feature 
-00009a70: 4772 6f75 702e 0a20 2020 2020 2020 2020  Group..         
-00009a80: 2020 2073 6176 655f 7265 706f 7274 3a20     save_report: 
-00009a90: 5768 6574 6865 7220 746f 2073 6176 6520  Whether to save 
-00009aa0: 7468 6520 7265 706f 7274 2074 6f20 7468  the report to th
-00009ab0: 6520 6261 636b 656e 642e 2054 6869 7320  e backend. This 
-00009ac0: 6973 206f 6e6c 7920 706f 7373 6962 6c65  is only possible
-00009ad0: 2069 6620 7468 6520 4578 7065 6374 6174   if the Expectat
-00009ae0: 696f 6e20 7375 6974 650a 2020 2020 2020  ion suite.      
-00009af0: 2020 2020 2020 2020 2020 6973 2069 6e69            is ini
-00009b00: 7469 616c 6973 6564 2061 6e64 2061 7474  tialised and att
-00009b10: 6163 6865 6420 746f 2074 6865 2046 6561  ached to the Fea
-00009b20: 7475 7265 2047 726f 7570 2e20 4465 6661  ture Group. Defa
-00009b30: 756c 7473 2074 6f20 4661 6c73 652e 0a20  ults to False.. 
-00009b40: 2020 2020 2020 2020 2020 2067 655f 7479             ge_ty
-00009b50: 7065 3a20 5768 6574 6865 7220 746f 2072  pe: Whether to r
-00009b60: 6574 7572 6e20 6120 4772 6561 7420 4578  eturn a Great Ex
-00009b70: 7065 6374 6174 696f 6e73 206f 626a 6563  pectations objec
-00009b80: 7420 6f72 2048 6f70 7377 6f72 6b73 206f  t or Hopsworks o
-00009b90: 776e 2061 6273 7472 6163 7469 6f6e 2e20  wn abstraction. 
-00009ba0: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
-00009bb0: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
-00009bc0: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
-00009bd0: 2041 2056 616c 6964 6174 696f 6e20 5265   A Validation Re
-00009be0: 706f 7274 2070 726f 6475 6365 6420 6279  port produced by
-00009bf0: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
-00009c00: 6f6e 732e 0a20 2020 2020 2020 2022 2222  ons..        """
-00009c10: 0a20 2020 2020 2020 2023 2041 6374 6976  .        # Activ
-00009c20: 6974 7920 6973 206c 6f67 6765 6420 6f6e  ity is logged on
-00009c30: 6c79 2069 6620 6120 7468 6520 7661 6c69  ly if a the vali
-00009c40: 6461 7469 6f6e 2063 6f6e 6365 726e 7320  dation concerns 
-00009c50: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00009c60: 7020 616e 6420 6e6f 7420 6120 7370 6563  p and not a spec
-00009c70: 6966 6963 2064 6174 6166 7261 6d65 0a20  ific dataframe. 
-00009c80: 2020 2020 2020 2069 6620 6461 7461 6672         if datafr
-00009c90: 616d 6520 6973 204e 6f6e 653a 0a20 2020  ame is None:.   
-00009ca0: 2020 2020 2020 2020 2064 6174 6166 7261           datafra
-00009cb0: 6d65 203d 2073 656c 662e 7265 6164 2829  me = self.read()
-00009cc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00009cd0: 696e 6765 7374 696f 6e5f 7265 7375 6c74  ingestion_result
-00009ce0: 203d 3d20 2255 4e4b 4e4f 574e 223a 0a20   == "UNKNOWN":. 
-00009cf0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00009d00: 6e67 6573 7469 6f6e 5f72 6573 756c 7420  ngestion_result 
-00009d10: 3d20 2246 475f 4441 5441 220a 0a20 2020  = "FG_DATA"..   
-00009d20: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00009d30: 2e5f 6772 6561 745f 6578 7065 6374 6174  ._great_expectat
-00009d40: 696f 6e5f 656e 6769 6e65 2e76 616c 6964  ion_engine.valid
-00009d50: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
-00009d60: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-00009d70: 2020 2064 6174 6166 7261 6d65 3d65 6e67     dataframe=eng
-00009d80: 696e 652e 6765 745f 696e 7374 616e 6365  ine.get_instance
-00009d90: 2829 2e63 6f6e 7665 7274 5f74 6f5f 6465  ().convert_to_de
-00009da0: 6661 756c 745f 6461 7461 6672 616d 6528  fault_dataframe(
-00009db0: 6461 7461 6672 616d 6529 2c0a 2020 2020  dataframe),.    
-00009dc0: 2020 2020 2020 2020 6578 7065 6374 6174          expectat
-00009dd0: 696f 6e5f 7375 6974 653d 6578 7065 6374  ion_suite=expect
-00009de0: 6174 696f 6e5f 7375 6974 652c 0a20 2020  ation_suite,.   
-00009df0: 2020 2020 2020 2020 2073 6176 655f 7265           save_re
-00009e00: 706f 7274 3d73 6176 655f 7265 706f 7274  port=save_report
-00009e10: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
-00009e20: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
-00009e30: 3d76 616c 6964 6174 696f 6e5f 6f70 7469  =validation_opti
-00009e40: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-00009e50: 2069 6e67 6573 7469 6f6e 5f72 6573 756c   ingestion_resul
-00009e60: 743d 696e 6765 7374 696f 6e5f 7265 7375  t=ingestion_resu
-00009e70: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
-00009e80: 6765 5f74 7970 653d 6765 5f74 7970 652c  ge_type=ge_type,
-00009e90: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00009ea0: 6465 6620 5f5f 6765 7461 7474 725f 5f28  def __getattr__(
-00009eb0: 7365 6c66 2c20 6e61 6d65 293a 0a20 2020  self, name):.   
-00009ec0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00009ed0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00009ee0: 662e 5f5f 6765 7469 7465 6d5f 5f28 6e61  f.__getitem__(na
-00009ef0: 6d65 290a 2020 2020 2020 2020 6578 6365  me).        exce
-00009f00: 7074 204b 6579 4572 726f 723a 0a20 2020  pt KeyError:.   
-00009f10: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
-00009f20: 7474 7269 6275 7465 4572 726f 7228 0a20  ttributeError(. 
-00009f30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00009f40: 2227 4665 6174 7572 6547 726f 7570 2720  "'FeatureGroup' 
-00009f50: 6f62 6a65 6374 2068 6173 206e 6f20 6174  object has no at
-00009f60: 7472 6962 7574 6520 277b 6e61 6d65 7d27  tribute '{name}'
-00009f70: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00009f80: 2020 2020 2249 6620 796f 7520 6172 6520      "If you are 
-00009f90: 7472 7969 6e67 2074 6f20 6163 6365 7373  trying to access
-00009fa0: 2061 2066 6561 7475 7265 2c20 6661 6c6c   a feature, fall
-00009fb0: 2062 6163 6b20 6f6e 2022 0a20 2020 2020   back on ".     
-00009fc0: 2020 2020 2020 2020 2020 2022 7573 696e             "usin
-00009fd0: 6720 7468 6520 6067 6574 5f66 6561 7475  g the `get_featu
-00009fe0: 7265 6020 6d65 7468 6f64 2e22 0a20 2020  re` method.".   
-00009ff0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000a000: 6465 6620 5f5f 6765 7469 7465 6d5f 5f28  def __getitem__(
-0000a010: 7365 6c66 2c20 6e61 6d65 293a 0a20 2020  self, name):.   
-0000a020: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0000a030: 7374 616e 6365 286e 616d 652c 2073 7472  stance(name, str
-0000a040: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000a050: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-0000a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a070: 6622 4578 7065 6374 6564 2074 7970 6520  f"Expected type 
-0000a080: 6073 7472 602c 2067 6f74 2060 7b74 7970  `str`, got `{typ
-0000a090: 6528 6e61 6d65 297d 602e 2022 0a20 2020  e(name)}`. ".   
-0000a0a0: 2020 2020 2020 2020 2020 2020 2022 4665               "Fe
-0000a0b0: 6174 7572 6573 2061 7265 2061 6363 6573  atures are acces
-0000a0c0: 7369 626c 6520 6279 206e 616d 652e 220a  sible by name.".
-0000a0d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000a0e0: 2020 2020 2020 6665 6174 7572 6520 3d20        feature = 
-0000a0f0: 5b66 2066 6f72 2066 2069 6e20 7365 6c66  [f for f in self
-0000a100: 2e5f 5f67 6574 6174 7472 6962 7574 655f  .__getattribute_
-0000a110: 5f28 225f 6665 6174 7572 6573 2229 2069  _("_features") i
-0000a120: 6620 662e 6e61 6d65 203d 3d20 6e61 6d65  f f.name == name
-0000a130: 5d0a 2020 2020 2020 2020 6966 206c 656e  ].        if len
-0000a140: 2866 6561 7475 7265 2920 3d3d 2031 3a0a  (feature) == 1:.
-0000a150: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000a160: 726e 2066 6561 7475 7265 5b30 5d0a 2020  rn feature[0].  
-0000a170: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000a180: 2020 2020 2020 2020 7261 6973 6520 4b65          raise Ke
-0000a190: 7945 7272 6f72 2866 2227 4665 6174 7572  yError(f"'Featur
-0000a1a0: 6547 726f 7570 2720 6f62 6a65 6374 2068  eGroup' object h
-0000a1b0: 6173 206e 6f20 6665 6174 7572 6520 6361  as no feature ca
-0000a1c0: 6c6c 6564 2027 7b6e 616d 657d 272e 2229  lled '{name}'.")
-0000a1d0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000a1e0: 2020 2020 6465 6620 7374 6174 6973 7469      def statisti
-0000a1f0: 6373 5f63 6f6e 6669 6728 7365 6c66 293a  cs_config(self):
-0000a200: 0a20 2020 2020 2020 2022 2222 5374 6174  .        """Stat
-0000a210: 6973 7469 6373 2063 6f6e 6669 6775 7261  istics configura
-0000a220: 7469 6f6e 206f 626a 6563 7420 6465 6669  tion object defi
-0000a230: 6e69 6e67 2074 6865 2073 6574 7469 6e67  ning the setting
-0000a240: 7320 666f 7220 7374 6174 6973 7469 6373  s for statistics
-0000a250: 0a20 2020 2020 2020 2063 6f6d 7075 7461  .        computa
-0000a260: 7469 6f6e 206f 6620 7468 6520 6665 6174  tion of the feat
-0000a270: 7572 6520 6772 6f75 702e 2222 220a 2020  ure group.""".  
-0000a280: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000a290: 662e 5f73 7461 7469 7374 6963 735f 636f  f._statistics_co
-0000a2a0: 6e66 6967 0a0a 2020 2020 4073 7461 7469  nfig..    @stati
-0000a2b0: 7374 6963 735f 636f 6e66 6967 2e73 6574  stics_config.set
-0000a2c0: 7465 720a 2020 2020 6465 6620 7374 6174  ter.    def stat
-0000a2d0: 6973 7469 6373 5f63 6f6e 6669 6728 7365  istics_config(se
-0000a2e0: 6c66 2c20 7374 6174 6973 7469 6373 5f63  lf, statistics_c
-0000a2f0: 6f6e 6669 6729 3a0a 2020 2020 2020 2020  onfig):.        
-0000a300: 6966 2069 7369 6e73 7461 6e63 6528 7374  if isinstance(st
-0000a310: 6174 6973 7469 6373 5f63 6f6e 6669 672c  atistics_config,
-0000a320: 2053 7461 7469 7374 6963 7343 6f6e 6669   StatisticsConfi
-0000a330: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
-0000a340: 7365 6c66 2e5f 7374 6174 6973 7469 6373  self._statistics
-0000a350: 5f63 6f6e 6669 6720 3d20 7374 6174 6973  _config = statis
-0000a360: 7469 6373 5f63 6f6e 6669 670a 2020 2020  tics_config.    
-0000a370: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0000a380: 6e63 6528 7374 6174 6973 7469 6373 5f63  nce(statistics_c
-0000a390: 6f6e 6669 672c 2064 6963 7429 3a0a 2020  onfig, dict):.  
-0000a3a0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000a3b0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-0000a3c0: 6720 3d20 5374 6174 6973 7469 6373 436f  g = StatisticsCo
-0000a3d0: 6e66 6967 282a 2a73 7461 7469 7374 6963  nfig(**statistic
-0000a3e0: 735f 636f 6e66 6967 290a 2020 2020 2020  s_config).      
-0000a3f0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0000a400: 6528 7374 6174 6973 7469 6373 5f63 6f6e  e(statistics_con
-0000a410: 6669 672c 2062 6f6f 6c29 3a0a 2020 2020  fig, bool):.    
-0000a420: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-0000a430: 6174 6973 7469 6373 5f63 6f6e 6669 6720  atistics_config 
-0000a440: 3d20 5374 6174 6973 7469 6373 436f 6e66  = StatisticsConf
-0000a450: 6967 2873 7461 7469 7374 6963 735f 636f  ig(statistics_co
-0000a460: 6e66 6967 290a 2020 2020 2020 2020 656c  nfig).        el
-0000a470: 6966 2073 7461 7469 7374 6963 735f 636f  if statistics_co
-0000a480: 6e66 6967 2069 7320 4e6f 6e65 3a0a 2020  nfig is None:.  
-0000a490: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000a4a0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-0000a4b0: 6720 3d20 5374 6174 6973 7469 6373 436f  g = StatisticsCo
-0000a4c0: 6e66 6967 2829 0a20 2020 2020 2020 2065  nfig().        e
-0000a4d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000a4e0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0000a4f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000a500: 2020 2254 6865 2061 7267 756d 656e 7420    "The argument 
-0000a510: 6073 7461 7469 7374 6963 735f 636f 6e66  `statistics_conf
-0000a520: 6967 6020 6861 7320 746f 2062 6520 604e  ig` has to be `N
-0000a530: 6f6e 6560 206f 6620 7479 7065 2060 5374  one` of type `St
-0000a540: 6174 6973 7469 6373 436f 6e66 6967 2c20  atisticsConfig, 
-0000a550: 6062 6f6f 6c60 206f 7220 6064 6963 7460  `bool` or `dict`
-0000a560: 2c20 6275 7420 6973 206f 6620 7479 7065  , but is of type
-0000a570: 3a20 607b 7d60 222e 666f 726d 6174 280a  : `{}`".format(.
-0000a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a590: 2020 2020 7479 7065 2873 7461 7469 7374      type(statist
-0000a5a0: 6963 735f 636f 6e66 6967 290a 2020 2020  ics_config).    
-0000a5b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000a5c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000a5d0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000a5e0: 6566 2073 7461 7469 7374 6963 7328 7365  ef statistics(se
-0000a5f0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000a600: 4765 7420 7468 6520 6c61 7465 7374 2063  Get the latest c
-0000a610: 6f6d 7075 7465 6420 7374 6174 6973 7469  omputed statisti
-0000a620: 6373 2066 6f72 2074 6865 2066 6561 7475  cs for the featu
-0000a630: 7265 2067 726f 7570 2e22 2222 0a20 2020  re group.""".   
-0000a640: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000a650: 2e5f 7374 6174 6973 7469 6373 5f65 6e67  ._statistics_eng
-0000a660: 696e 652e 6765 745f 6c61 7374 2873 656c  ine.get_last(sel
-0000a670: 6629 0a0a 2020 2020 4070 726f 7065 7274  f)..    @propert
-0000a680: 790a 2020 2020 6465 6620 7072 696d 6172  y.    def primar
-0000a690: 795f 6b65 7928 7365 6c66 293a 0a20 2020  y_key(self):.   
-0000a6a0: 2020 2020 2022 2222 4c69 7374 206f 6620       """List of 
-0000a6b0: 6665 6174 7572 6573 2062 7569 6c64 696e  features buildin
-0000a6c0: 6720 7468 6520 7072 696d 6172 7920 6b65  g the primary ke
-0000a6d0: 792e 2222 220a 2020 2020 2020 2020 7265  y.""".        re
-0000a6e0: 7475 726e 2073 656c 662e 5f70 7269 6d61  turn self._prima
-0000a6f0: 7279 5f6b 6579 0a0a 2020 2020 4070 7269  ry_key..    @pri
-0000a700: 6d61 7279 5f6b 6579 2e73 6574 7465 720a  mary_key.setter.
-0000a710: 2020 2020 6465 6620 7072 696d 6172 795f      def primary_
-0000a720: 6b65 7928 7365 6c66 2c20 6e65 775f 7072  key(self, new_pr
-0000a730: 696d 6172 795f 6b65 7929 3a0a 2020 2020  imary_key):.    
-0000a740: 2020 2020 7365 6c66 2e5f 7072 696d 6172      self._primar
-0000a750: 795f 6b65 7920 3d20 5b70 6b2e 6c6f 7765  y_key = [pk.lowe
-0000a760: 7228 2920 666f 7220 706b 2069 6e20 6e65  r() for pk in ne
-0000a770: 775f 7072 696d 6172 795f 6b65 795d 0a0a  w_primary_key]..
-0000a780: 2020 2020 6465 6620 6765 745f 7374 6174      def get_stat
-0000a790: 6973 7469 6373 280a 2020 2020 2020 2020  istics(.        
-0000a7a0: 7365 6c66 2c20 636f 6d6d 6974 5f74 696d  self, commit_tim
-0000a7b0: 653a 204f 7074 696f 6e61 6c5b 556e 696f  e: Optional[Unio
-0000a7c0: 6e5b 7374 722c 2069 6e74 2c20 6461 7465  n[str, int, date
-0000a7d0: 7469 6d65 2c20 6461 7465 5d5d 203d 204e  time, date]] = N
-0000a7e0: 6f6e 650a 2020 2020 293a 0a20 2020 2020  one.    ):.     
-0000a7f0: 2020 2022 2222 5265 7475 726e 7320 7468     """Returns th
-0000a800: 6520 7374 6174 6973 7469 6373 2066 6f72  e statistics for
-0000a810: 2074 6869 7320 6665 6174 7572 6520 6772   this feature gr
-0000a820: 6f75 7020 6174 2061 2073 7065 6369 6669  oup at a specifi
-0000a830: 6320 7469 6d65 2e0a 0a20 2020 2020 2020  c time...       
-0000a840: 2049 6620 6063 6f6d 6d69 745f 7469 6d65   If `commit_time
-0000a850: 6020 6973 2060 4e6f 6e65 602c 2074 6865  ` is `None`, the
-0000a860: 206d 6f73 7420 7265 6365 6e74 2073 7461   most recent sta
-0000a870: 7469 7374 6963 7320 6172 6520 7265 7475  tistics are retu
-0000a880: 726e 6564 2e0a 0a20 2020 2020 2020 2021  rned...        !
-0000a890: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
-0000a8a0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-0000a8b0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-0000a8c0: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-0000a8d0: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-0000a8e0: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-0000a8f0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0000a900: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
-0000a910: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
-0000a920: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
-0000a930: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
-0000a940: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
-0000a950: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
-0000a960: 2066 675f 7374 6174 6973 7469 6373 203d   fg_statistics =
-0000a970: 2066 672e 6765 745f 7374 6174 6973 7469   fg.get_statisti
-0000a980: 6373 2863 6f6d 6d69 745f 7469 6d65 3d4e  cs(commit_time=N
-0000a990: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
-0000a9a0: 2060 6060 0a0a 2020 2020 2020 2020 2320   ```..        # 
-0000a9b0: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
-0000a9c0: 2020 2020 2020 636f 6d6d 6974 5f74 696d        commit_tim
-0000a9d0: 653a 2044 6174 6520 616e 6420 7469 6d65  e: Date and time
-0000a9e0: 206f 6620 7468 6520 636f 6d6d 6974 2e20   of the commit. 
-0000a9f0: 4465 6661 756c 7473 2074 6f20 604e 6f6e  Defaults to `Non
-0000aa00: 6560 2e20 5374 7269 6e67 7320 7368 6f75  e`. Strings shou
-0000aa10: 6c64 0a20 2020 2020 2020 2020 2020 2020  ld.             
-0000aa20: 2020 2062 6520 666f 726d 6174 7465 6420     be formatted 
-0000aa30: 696e 206f 6e65 206f 6620 7468 6520 666f  in one of the fo
-0000aa40: 6c6c 6f77 696e 6720 666f 726d 6174 7320  llowing formats 
-0000aa50: 6025 592d 256d 2d25 6460 2c20 6025 592d  `%Y-%m-%d`, `%Y-
-0000aa60: 256d 2d25 6420 2548 602c 2060 2559 2d25  %m-%d %H`, `%Y-%
-0000aa70: 6d2d 2564 2025 483a 254d 602c 2060 2559  m-%d %H:%M`, `%Y
-0000aa80: 2d25 6d2d 2564 2025 483a 254d 3a25 5360  -%m-%d %H:%M:%S`
-0000aa90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000aaa0: 2020 6f72 2060 2559 2d25 6d2d 2564 2025    or `%Y-%m-%d %
-0000aab0: 483a 254d 3a25 532e 2566 602e 0a0a 2020  H:%M:%S.%f`...  
-0000aac0: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-0000aad0: 2020 2020 2020 2020 2020 2020 6053 7461              `Sta
-0000aae0: 7469 7374 6963 7360 2e20 5374 6174 6973  tistics`. Statis
-0000aaf0: 7469 6373 206f 626a 6563 742e 0a0a 2020  tics object...  
-0000ab00: 2020 2020 2020 2320 5261 6973 6573 0a20        # Raises. 
-0000ab10: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
-0000ab20: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-0000ab30: 6e73 2e52 6573 7441 5049 4572 726f 7260  ns.RestAPIError`
-0000ab40: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000ab50: 2020 2020 2020 6966 2063 6f6d 6d69 745f        if commit_
-0000ab60: 7469 6d65 2069 7320 4e6f 6e65 3a0a 2020  time is None:.  
-0000ab70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ab80: 2073 656c 662e 7374 6174 6973 7469 6373   self.statistics
-0000ab90: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0000aba0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000abb0: 6e20 7365 6c66 2e5f 7374 6174 6973 7469  n self._statisti
-0000abc0: 6373 5f65 6e67 696e 652e 6765 7428 7365  cs_engine.get(se
-0000abd0: 6c66 2c20 636f 6d6d 6974 5f74 696d 6529  lf, commit_time)
-0000abe0: 0a0a 2020 2020 6465 6620 636f 6d70 7574  ..    def comput
-0000abf0: 655f 7374 6174 6973 7469 6373 2873 656c  e_statistics(sel
-0000ac00: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-0000ac10: 6563 6f6d 7075 7465 2074 6865 2073 7461  ecompute the sta
-0000ac20: 7469 7374 6963 7320 666f 7220 7468 6520  tistics for the 
-0000ac30: 6665 6174 7572 6520 6772 6f75 7020 616e  feature group an
-0000ac40: 6420 7361 7665 2074 6865 6d20 746f 2074  d save them to t
-0000ac50: 6865 0a20 2020 2020 2020 2066 6561 7475  he.        featu
-0000ac60: 7265 2073 746f 7265 2e0a 2020 2020 2020  re store..      
-0000ac70: 2020 5374 6174 6973 7469 6373 2061 7265    Statistics are
-0000ac80: 206f 6e6c 7920 636f 6d70 7574 6564 2066   only computed f
-0000ac90: 6f72 2064 6174 6120 696e 2074 6865 206f  or data in the o
-0000aca0: 6666 6c69 6e65 2073 746f 7261 6765 206f  ffline storage o
-0000acb0: 6620 7468 6520 6665 6174 7572 650a 2020  f the feature.  
-0000acc0: 2020 2020 2020 6772 6f75 702e 0a0a 2020        group...  
-0000acd0: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
-0000ace0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
-0000acf0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-0000ad00: 2020 2020 2320 636f 6e6e 6563 7420 746f      # connect to
-0000ad10: 2074 6865 2046 6561 7475 7265 2053 746f   the Feature Sto
-0000ad20: 7265 0a20 2020 2020 2020 2020 2020 2066  re.            f
-0000ad30: 7320 3d20 2e2e 2e0a 0a20 2020 2020 2020  s = .....       
-0000ad40: 2020 2020 2023 2067 6574 2074 6865 2046       # get the F
-0000ad50: 6561 7475 7265 2047 726f 7570 2069 6e73  eature Group ins
-0000ad60: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
-0000ad70: 2020 6667 203d 2066 732e 6765 745f 6f72    fg = fs.get_or
-0000ad80: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
-0000ad90: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
-0000ada0: 2020 2020 2020 2020 7374 6174 6973 7469          statisti
-0000adb0: 6373 5f6d 6574 6164 6174 6120 3d20 6667  cs_metadata = fg
-0000adc0: 2e63 6f6d 7075 7465 5f73 7461 7469 7374  .compute_statist
-0000add0: 6963 7328 290a 2020 2020 2020 2020 2020  ics().          
-0000ade0: 2020 6060 600a 0a20 2020 2020 2020 2023    ```..        #
-0000adf0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-0000ae00: 2020 2020 2060 5374 6174 6973 7469 6373       `Statistics
-0000ae10: 602e 2054 6865 2073 7461 7469 7374 6963  `. The statistic
-0000ae20: 7320 6d65 7461 6461 7461 206f 626a 6563  s metadata objec
-0000ae30: 742e 0a0a 2020 2020 2020 2020 2320 5261  t...        # Ra
-0000ae40: 6973 6573 0a20 2020 2020 2020 2020 2020  ises.           
-0000ae50: 2060 6873 6673 2e63 6c69 656e 742e 6578   `hsfs.client.ex
-0000ae60: 6365 7074 696f 6e73 2e52 6573 7441 5049  ceptions.RestAPI
-0000ae70: 4572 726f 7260 2e20 556e 6162 6c65 2074  Error`. Unable t
-0000ae80: 6f20 7065 7273 6973 7420 7468 6520 7374  o persist the st
-0000ae90: 6174 6973 7469 6373 2e0a 2020 2020 2020  atistics..      
-0000aea0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0000aeb0: 2073 656c 662e 7374 6174 6973 7469 6373   self.statistics
-0000aec0: 5f63 6f6e 6669 672e 656e 6162 6c65 643a  _config.enabled:
-0000aed0: 0a20 2020 2020 2020 2020 2020 2023 2044  .            # D
-0000aee0: 6f6e 2774 2072 6561 6420 7468 6520 6461  on't read the da
-0000aef0: 7461 6672 616d 6520 6865 7265 2c20 746f  taframe here, to
-0000af00: 2061 766f 6964 2074 7269 6767 6572 696e   avoid triggerin
-0000af10: 6720 6120 7265 6164 206f 7065 7261 7469  g a read operati
-0000af20: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-0000af30: 2066 6f72 2074 6865 2050 7974 686f 6e20   for the Python 
-0000af40: 656e 6769 6e65 2e20 5468 6520 5079 7468  engine. The Pyth
-0000af50: 6f6e 2065 6e67 696e 6520 6973 2067 6f69  on engine is goi
-0000af60: 6e67 2074 6f20 7365 7475 7020 6120 5370  ng to setup a Sp
-0000af70: 6172 6b20 4a6f 620a 2020 2020 2020 2020  ark Job.        
-0000af80: 2020 2020 2320 746f 2075 7064 6174 6520      # to update 
-0000af90: 7468 6520 7374 6174 6973 7469 6373 2e0a  the statistics..
-0000afa0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000afb0: 726e 2073 656c 662e 5f73 7461 7469 7374  rn self._statist
-0000afc0: 6963 735f 656e 6769 6e65 2e63 6f6d 7075  ics_engine.compu
-0000afd0: 7465 5f73 7461 7469 7374 6963 7328 7365  te_statistics(se
-0000afe0: 6c66 290a 2020 2020 2020 2020 656c 7365  lf).        else
-0000aff0: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-0000b000: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-0000b010: 2020 2020 2020 2020 2020 2020 2028 0a20               (. 
-0000b020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b030: 2020 2022 5468 6520 7374 6174 6973 7469     "The statisti
-0000b040: 6373 2061 7265 206e 6f74 2065 6e61 626c  cs are not enabl
-0000b050: 6564 206f 6620 6665 6174 7572 6520 6772  ed of feature gr
-0000b060: 6f75 7020 607b 7d60 2c20 7769 7468 2076  oup `{}`, with v
-0000b070: 6572 7369 6f6e 220a 2020 2020 2020 2020  ersion".        
-0000b080: 2020 2020 2020 2020 2020 2020 2220 607b              " `{
-0000b090: 7d60 2e20 4e6f 2073 7461 7469 7374 6963  }`. No statistic
-0000b0a0: 7320 636f 6d70 7574 6564 2e22 0a20 2020  s computed.".   
-0000b0b0: 2020 2020 2020 2020 2020 2020 2029 2e66               ).f
-0000b0c0: 6f72 6d61 7428 7365 6c66 2e5f 6e61 6d65  ormat(self._name
-0000b0d0: 2c20 7365 6c66 2e5f 7665 7273 696f 6e29  , self._version)
-0000b0e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b0f0: 2020 7574 696c 2e53 746f 7261 6765 5761    util.StorageWa
-0000b100: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-0000b110: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
-0000b120: 7274 790a 2020 2020 6465 6620 6576 656e  rty.    def even
-0000b130: 745f 7469 6d65 2873 656c 6629 3a0a 2020  t_time(self):.  
-0000b140: 2020 2020 2020 2222 2245 7665 6e74 2074        """Event t
-0000b150: 696d 6520 6665 6174 7572 6520 696e 2074  ime feature in t
-0000b160: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-0000b170: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-0000b180: 7572 6e20 7365 6c66 2e5f 6576 656e 745f  urn self._event_
-0000b190: 7469 6d65 0a0a 2020 2020 4065 7665 6e74  time..    @event
-0000b1a0: 5f74 696d 652e 7365 7474 6572 0a20 2020  _time.setter.   
-0000b1b0: 2064 6566 2065 7665 6e74 5f74 696d 6528   def event_time(
-0000b1c0: 7365 6c66 2c20 6665 6174 7572 655f 6e61  self, feature_na
-0000b1d0: 6d65 3a20 4f70 7469 6f6e 616c 5b73 7472  me: Optional[str
-0000b1e0: 5d29 3a0a 2020 2020 2020 2020 6966 2066  ]):.        if f
-0000b1f0: 6561 7475 7265 5f6e 616d 6520 6973 204e  eature_name is N
-0000b200: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000b210: 2073 656c 662e 5f65 7665 6e74 5f74 696d   self._event_tim
-0000b220: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
-0000b230: 2020 2020 2072 6574 7572 6e0a 2020 2020       return.    
-0000b240: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0000b250: 6e63 6528 6665 6174 7572 655f 6e61 6d65  nce(feature_name
-0000b260: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
-0000b270: 2020 2020 7365 6c66 2e5f 6576 656e 745f      self._event_
-0000b280: 7469 6d65 203d 2066 6561 7475 7265 5f6e  time = feature_n
-0000b290: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
-0000b2a0: 7265 7475 726e 0a20 2020 2020 2020 2065  return.        e
-0000b2b0: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
-0000b2c0: 6561 7475 7265 5f6e 616d 652c 206c 6973  eature_name, lis
-0000b2d0: 7429 2061 6e64 206c 656e 2866 6561 7475  t) and len(featu
-0000b2e0: 7265 5f6e 616d 6529 203d 3d20 313a 0a20  re_name) == 1:. 
-0000b2f0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0000b300: 696e 7374 616e 6365 2866 6561 7475 7265  instance(feature
-0000b310: 5f6e 616d 655b 305d 2c20 7374 7229 3a0a  _name[0], str):.
-0000b320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b330: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-0000b340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b350: 2020 2022 5072 6f76 6964 696e 6720 6576     "Providing ev
-0000b360: 656e 745f 7469 6d65 2061 7320 6120 7369  ent_time as a si
-0000b370: 6e67 6c65 2d65 6c65 6d65 6e74 206c 6973  ngle-element lis
-0000b380: 7420 6973 2064 6570 7265 6361 7465 6422  t is deprecated"
-0000b390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b3a0: 2020 2020 202b 2022 2061 6e64 2077 696c       + " and wil
-0000b3b0: 6c20 6265 2064 726f 7070 6564 2069 6e20  l be dropped in 
-0000b3c0: 6675 7475 7265 2076 6572 7369 6f6e 732e  future versions.
-0000b3d0: 2050 726f 7669 6465 2074 6865 2066 6561   Provide the fea
-0000b3e0: 7475 7265 5f6e 616d 6520 7374 7269 6e67  ture_name string
-0000b3f0: 2069 6e73 7465 6164 2e22 2c0a 2020 2020   instead.",.    
-0000b400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b410: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
-0000b420: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
-0000b430: 2020 2020 2020 2020 7374 6163 6b6c 6576          stacklev
-0000b440: 656c 3d32 2c0a 2020 2020 2020 2020 2020  el=2,.          
-0000b450: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000b460: 2020 2020 2020 2020 7365 6c66 2e5f 6576          self._ev
-0000b470: 656e 745f 7469 6d65 203d 2066 6561 7475  ent_time = featu
-0000b480: 7265 5f6e 616d 655b 305d 0a20 2020 2020  re_name[0].     
-0000b490: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000b4a0: 6e0a 0a20 2020 2020 2020 2072 6169 7365  n..        raise
-0000b4b0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-0000b4c0: 2020 2020 2020 2020 2022 6576 656e 745f           "event_
-0000b4d0: 7469 6d65 206d 7573 7420 6265 2061 2073  time must be a s
-0000b4e0: 7472 696e 6720 636f 7272 6573 706f 6e64  tring correspond
-0000b4f0: 696e 6720 746f 2061 6e20 6578 6973 7469  ing to an existi
-0000b500: 6e67 2066 6561 7475 7265 206e 616d 6520  ng feature name 
-0000b510: 6f66 2074 6865 2046 6561 7475 7265 2047  of the Feature G
-0000b520: 726f 7570 2e22 0a20 2020 2020 2020 2029  roup.".        )
-0000b530: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000b540: 2020 2020 6465 6620 6c6f 6361 7469 6f6e      def location
-0000b550: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000b560: 7265 7475 726e 2073 656c 662e 5f6c 6f63  return self._loc
-0000b570: 6174 696f 6e0a 0a20 2020 2040 7072 6f70  ation..    @prop
-0000b580: 6572 7479 0a20 2020 2064 6566 2065 7870  erty.    def exp
-0000b590: 6563 7461 7469 6f6e 5f73 7569 7465 280a  ectation_suite(.
-0000b5a0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000b5b0: 2020 2920 2d3e 204f 7074 696f 6e61 6c5b    ) -> Optional[
-0000b5c0: 4578 7065 6374 6174 696f 6e53 7569 7465  ExpectationSuite
-0000b5d0: 5d3a 0a20 2020 2020 2020 2022 2222 4578  ]:.        """Ex
-0000b5e0: 7065 6374 6174 696f 6e20 5375 6974 6520  pectation Suite 
-0000b5f0: 636f 6e66 6967 7572 6174 696f 6e20 6f62  configuration ob
-0000b600: 6a65 6374 2064 6566 696e 696e 6720 7468  ject defining th
-0000b610: 6520 7365 7474 696e 6773 2066 6f72 0a20  e settings for. 
-0000b620: 2020 2020 2020 2064 6174 6120 7661 6c69         data vali
-0000b630: 6461 7469 6f6e 206f 6620 7468 6520 6665  dation of the fe
-0000b640: 6174 7572 6520 6772 6f75 702e 2222 220a  ature group.""".
-0000b650: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000b660: 656c 662e 5f65 7870 6563 7461 7469 6f6e  elf._expectation
-0000b670: 5f73 7569 7465 0a0a 2020 2020 4065 7870  _suite..    @exp
-0000b680: 6563 7461 7469 6f6e 5f73 7569 7465 2e73  ectation_suite.s
-0000b690: 6574 7465 720a 2020 2020 6465 6620 6578  etter.    def ex
-0000b6a0: 7065 6374 6174 696f 6e5f 7375 6974 6528  pectation_suite(
-0000b6b0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0000b6c0: 2020 2020 2020 2065 7870 6563 7461 7469         expectati
-0000b6d0: 6f6e 5f73 7569 7465 3a20 556e 696f 6e5b  on_suite: Union[
-0000b6e0: 0a20 2020 2020 2020 2020 2020 2045 7870  .            Exp
-0000b6f0: 6563 7461 7469 6f6e 5375 6974 652c 2067  ectationSuite, g
-0000b700: 652e 636f 7265 2e45 7870 6563 7461 7469  e.core.Expectati
-0000b710: 6f6e 5375 6974 652c 2064 6963 742c 204e  onSuite, dict, N
-0000b720: 6f6e 650a 2020 2020 2020 2020 5d2c 0a20  one.        ],. 
-0000b730: 2020 2029 3a0a 2020 2020 2020 2020 6966     ):.        if
-0000b740: 2069 7369 6e73 7461 6e63 6528 6578 7065   isinstance(expe
-0000b750: 6374 6174 696f 6e5f 7375 6974 652c 2045  ctation_suite, E
-0000b760: 7870 6563 7461 7469 6f6e 5375 6974 6529  xpectationSuite)
-0000b770: 3a0a 2020 2020 2020 2020 2020 2020 746d  :.            tm
-0000b780: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
-0000b790: 6974 6520 3d20 6578 7065 6374 6174 696f  ite = expectatio
-0000b7a0: 6e5f 7375 6974 652e 746f 5f6a 736f 6e5f  n_suite.to_json_
-0000b7b0: 6469 6374 2829 0a20 2020 2020 2020 2020  dict().         
-0000b7c0: 2020 2074 6d70 5f65 7870 6563 7461 7469     tmp_expectati
-0000b7d0: 6f6e 5f73 7569 7465 5b22 6665 6174 7572  on_suite["featur
-0000b7e0: 6567 726f 7570 5f69 6422 5d20 3d20 7365  egroup_id"] = se
-0000b7f0: 6c66 2e5f 6964 0a20 2020 2020 2020 2020  lf._id.         
-0000b800: 2020 2074 6d70 5f65 7870 6563 7461 7469     tmp_expectati
-0000b810: 6f6e 5f73 7569 7465 5b22 6665 6174 7572  on_suite["featur
-0000b820: 6573 746f 7265 5f69 6422 5d20 3d20 7365  estore_id"] = se
-0000b830: 6c66 2e5f 6665 6174 7572 655f 7374 6f72  lf._feature_stor
-0000b840: 655f 6964 0a20 2020 2020 2020 2020 2020  e_id.           
-0000b850: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
-0000b860: 6f6e 5f73 7569 7465 203d 2045 7870 6563  on_suite = Expec
-0000b870: 7461 7469 6f6e 5375 6974 6528 2a2a 746d  tationSuite(**tm
-0000b880: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
-0000b890: 6974 6529 0a20 2020 2020 2020 2065 6c69  ite).        eli
-0000b8a0: 6620 6973 696e 7374 616e 6365 2865 7870  f isinstance(exp
-0000b8b0: 6563 7461 7469 6f6e 5f73 7569 7465 2c20  ectation_suite, 
-0000b8c0: 6765 2e63 6f72 652e 6578 7065 6374 6174  ge.core.expectat
-0000b8d0: 696f 6e5f 7375 6974 652e 4578 7065 6374  ion_suite.Expect
-0000b8e0: 6174 696f 6e53 7569 7465 293a 0a20 2020  ationSuite):.   
-0000b8f0: 2020 2020 2020 2020 2073 656c 662e 5f65           self._e
-0000b900: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-0000b910: 203d 2045 7870 6563 7461 7469 6f6e 5375   = ExpectationSu
-0000b920: 6974 6528 0a20 2020 2020 2020 2020 2020  ite(.           
-0000b930: 2020 2020 202a 2a65 7870 6563 7461 7469       **expectati
-0000b940: 6f6e 5f73 7569 7465 2e74 6f5f 6a73 6f6e  on_suite.to_json
-0000b950: 5f64 6963 7428 292c 0a20 2020 2020 2020  _dict(),.       
-0000b960: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0000b970: 5f73 746f 7265 5f69 643d 7365 6c66 2e5f  _store_id=self._
-0000b980: 6665 6174 7572 655f 7374 6f72 655f 6964  feature_store_id
-0000b990: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b9a0: 2020 6665 6174 7572 655f 6772 6f75 705f    feature_group_
-0000b9b0: 6964 3d73 656c 662e 5f69 642c 0a20 2020  id=self._id,.   
-0000b9c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0000b9d0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-0000b9e0: 6365 2865 7870 6563 7461 7469 6f6e 5f73  ce(expectation_s
-0000b9f0: 7569 7465 2c20 6469 6374 293a 0a20 2020  uite, dict):.   
-0000ba00: 2020 2020 2020 2020 2074 6d70 5f65 7870           tmp_exp
-0000ba10: 6563 7461 7469 6f6e 5f73 7569 7465 203d  ectation_suite =
-0000ba20: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
-0000ba30: 7465 2e63 6f70 7928 290a 2020 2020 2020  te.copy().      
-0000ba40: 2020 2020 2020 746d 705f 6578 7065 6374        tmp_expect
-0000ba50: 6174 696f 6e5f 7375 6974 655b 2266 6561  ation_suite["fea
-0000ba60: 7475 7265 5f73 746f 7265 5f69 6422 5d20  ture_store_id"] 
-0000ba70: 3d20 7365 6c66 2e5f 6665 6174 7572 655f  = self._feature_
-0000ba80: 7374 6f72 655f 6964 0a20 2020 2020 2020  store_id.       
-0000ba90: 2020 2020 2074 6d70 5f65 7870 6563 7461       tmp_expecta
-0000baa0: 7469 6f6e 5f73 7569 7465 5b22 6665 6174  tion_suite["feat
-0000bab0: 7572 655f 6772 6f75 705f 6964 225d 203d  ure_group_id"] =
-0000bac0: 2073 656c 662e 5f69 640a 2020 2020 2020   self._id.      
-0000bad0: 2020 2020 2020 7365 6c66 2e5f 6578 7065        self._expe
-0000bae0: 6374 6174 696f 6e5f 7375 6974 6520 3d20  ctation_suite = 
-0000baf0: 4578 7065 6374 6174 696f 6e53 7569 7465  ExpectationSuite
-0000bb00: 282a 2a74 6d70 5f65 7870 6563 7461 7469  (**tmp_expectati
-0000bb10: 6f6e 5f73 7569 7465 290a 2020 2020 2020  on_suite).      
-0000bb20: 2020 656c 6966 2065 7870 6563 7461 7469    elif expectati
-0000bb30: 6f6e 5f73 7569 7465 2069 7320 4e6f 6e65  on_suite is None
-0000bb40: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000bb50: 6c66 2e5f 6578 7065 6374 6174 696f 6e5f  lf._expectation_
-0000bb60: 7375 6974 6520 3d20 4e6f 6e65 0a20 2020  suite = None.   
-0000bb70: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000bb80: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-0000bb90: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0000bba0: 2020 2020 2020 2020 2254 6865 2061 7267          "The arg
-0000bbb0: 756d 656e 7420 6065 7870 6563 7461 7469  ument `expectati
-0000bbc0: 6f6e 5f73 7569 7465 6020 6861 7320 746f  on_suite` has to
-0000bbd0: 2062 6520 604e 6f6e 6560 206f 6620 7479   be `None` of ty
-0000bbe0: 7065 2060 4578 7065 6374 6174 696f 6e53  pe `ExpectationS
-0000bbf0: 7569 7465 6020 6f72 2060 6469 6374 602c  uite` or `dict`,
-0000bc00: 2062 7574 2069 7320 6f66 2074 7970 653a   but is of type:
-0000bc10: 2060 7b7d 6022 2e66 6f72 6d61 7428 0a20   `{}`".format(. 
-0000bc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bc30: 2020 2074 7970 6528 6578 7065 6374 6174     type(expectat
-0000bc40: 696f 6e5f 7375 6974 6529 0a20 2020 2020  ion_suite).     
-0000bc50: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000bc60: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000bc70: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000bc80: 6620 6f6e 6c69 6e65 5f65 6e61 626c 6564  f online_enabled
-0000bc90: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000bca0: 2222 2253 6574 7469 6e67 2069 6620 7468  """Setting if th
-0000bcb0: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
-0000bcc0: 6973 2061 7661 696c 6162 6c65 2069 6e20  is available in 
-0000bcd0: 6f6e 6c69 6e65 2073 746f 7261 6765 2e22  online storage."
-0000bce0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0000bcf0: 6e20 7365 6c66 2e5f 6f6e 6c69 6e65 5f65  n self._online_e
-0000bd00: 6e61 626c 6564 0a0a 2020 2020 406f 6e6c  nabled..    @onl
-0000bd10: 696e 655f 656e 6162 6c65 642e 7365 7474  ine_enabled.sett
-0000bd20: 6572 0a20 2020 2064 6566 206f 6e6c 696e  er.    def onlin
-0000bd30: 655f 656e 6162 6c65 6428 7365 6c66 2c20  e_enabled(self, 
-0000bd40: 6f6e 6c69 6e65 5f65 6e61 626c 6564 293a  online_enabled):
-0000bd50: 0a20 2020 2020 2020 2073 656c 662e 5f6f  .        self._o
-0000bd60: 6e6c 696e 655f 656e 6162 6c65 6420 3d20  nline_enabled = 
-0000bd70: 6f6e 6c69 6e65 5f65 6e61 626c 6564 0a0a  online_enabled..
-0000bd80: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000bd90: 2020 6465 6620 7375 626a 6563 7428 7365    def subject(se
-0000bda0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-0000bdb0: 5375 626a 6563 7420 6f66 2074 6865 2066  Subject of the f
-0000bdc0: 6561 7475 7265 2067 726f 7570 2e22 2222  eature group."""
-0000bdd0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000bde0: 2e5f 7375 626a 6563 7420 6973 204e 6f6e  ._subject is Non
-0000bdf0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-0000be00: 2063 6163 6865 2074 6865 2073 6368 656d   cache the schem
-0000be10: 610a 2020 2020 2020 2020 2020 2020 7365  a.            se
-0000be20: 6c66 2e5f 7375 626a 6563 7420 3d20 7365  lf._subject = se
-0000be30: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
-0000be40: 705f 656e 6769 6e65 2e67 6574 5f73 7562  p_engine.get_sub
-0000be50: 6a65 6374 2873 656c 6629 0a20 2020 2020  ject(self).     
-0000be60: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000be70: 7375 626a 6563 740a 0a20 2020 2040 7072  subject..    @pr
-0000be80: 6f70 6572 7479 0a20 2020 2064 6566 2061  operty.    def a
-0000be90: 7672 6f5f 7363 6865 6d61 2873 656c 6629  vro_schema(self)
-0000bea0: 3a0a 2020 2020 2020 2020 2222 2241 7672  :.        """Avr
-0000beb0: 6f20 7363 6865 6d61 2072 6570 7265 7365  o schema represe
-0000bec0: 6e74 6174 696f 6e20 6f66 2074 6865 2066  ntation of the f
-0000bed0: 6561 7475 7265 2067 726f 7570 2e22 2222  eature group."""
-0000bee0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000bef0: 7365 6c66 2e73 7562 6a65 6374 5b22 7363  self.subject["sc
-0000bf00: 6865 6d61 225d 0a0a 2020 2020 6465 6620  hema"]..    def 
-0000bf10: 6765 745f 636f 6d70 6c65 785f 6665 6174  get_complex_feat
-0000bf20: 7572 6573 2873 656c 6629 3a0a 2020 2020  ures(self):.    
-0000bf30: 2020 2020 2222 2252 6574 7572 6e73 2074      """Returns t
-0000bf40: 6865 206e 616d 6573 206f 6620 616c 6c20  he names of all 
-0000bf50: 6665 6174 7572 6573 2077 6974 6820 6120  features with a 
-0000bf60: 636f 6d70 6c65 7820 6461 7461 2074 7970  complex data typ
-0000bf70: 6520 696e 2074 6869 730a 2020 2020 2020  e in this.      
-0000bf80: 2020 6665 6174 7572 6520 6772 6f75 702e    feature group.
-0000bf90: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
-0000bfa0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-0000bfb0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-0000bfc0: 2020 2020 2020 2020 636f 6d70 6c65 785f          complex_
-0000bfd0: 6474 7970 655f 6665 6174 7572 6573 203d  dtype_features =
-0000bfe0: 2066 672e 6765 745f 636f 6d70 6c65 785f   fg.get_complex_
-0000bff0: 6665 6174 7572 6573 2829 0a20 2020 2020  features().     
-0000c000: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-0000c010: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-0000c020: 6574 7572 6e20 5b66 2e6e 616d 6520 666f  eturn [f.name fo
-0000c030: 7220 6620 696e 2073 656c 662e 6665 6174  r f in self.feat
-0000c040: 7572 6573 2069 6620 662e 6973 5f63 6f6d  ures if f.is_com
-0000c050: 706c 6578 2829 5d0a 0a20 2020 2064 6566  plex()]..    def
-0000c060: 205f 6765 745f 656e 636f 6465 645f 6176   _get_encoded_av
-0000c070: 726f 5f73 6368 656d 6128 7365 6c66 293a  ro_schema(self):
-0000c080: 0a20 2020 2020 2020 2063 6f6d 706c 6578  .        complex
-0000c090: 5f66 6561 7475 7265 7320 3d20 7365 6c66  _features = self
-0000c0a0: 2e67 6574 5f63 6f6d 706c 6578 5f66 6561  .get_complex_fea
-0000c0b0: 7475 7265 7328 290a 2020 2020 2020 2020  tures().        
-0000c0c0: 7363 6865 6d61 203d 206a 736f 6e2e 6c6f  schema = json.lo
-0000c0d0: 6164 7328 7365 6c66 2e61 7672 6f5f 7363  ads(self.avro_sc
-0000c0e0: 6865 6d61 290a 0a20 2020 2020 2020 2066  hema)..        f
-0000c0f0: 6f72 2066 6965 6c64 2069 6e20 7363 6865  or field in sche
-0000c100: 6d61 5b22 6669 656c 6473 225d 3a0a 2020  ma["fields"]:.  
-0000c110: 2020 2020 2020 2020 2020 6966 2066 6965            if fie
-0000c120: 6c64 5b22 6e61 6d65 225d 2069 6e20 636f  ld["name"] in co
-0000c130: 6d70 6c65 785f 6665 6174 7572 6573 3a0a  mplex_features:.
-0000c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c150: 6669 656c 645b 2274 7970 6522 5d20 3d20  field["type"] = 
-0000c160: 5b22 6e75 6c6c 222c 2022 6279 7465 7322  ["null", "bytes"
-0000c170: 5d0a 0a20 2020 2020 2020 2073 6368 656d  ]..        schem
-0000c180: 615f 7320 3d20 6a73 6f6e 2e64 756d 7073  a_s = json.dumps
-0000c190: 2873 6368 656d 6129 0a20 2020 2020 2020  (schema).       
-0000c1a0: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-0000c1b0: 2020 6176 726f 2e73 6368 656d 612e 7061    avro.schema.pa
-0000c1c0: 7273 6528 7363 6865 6d61 5f73 290a 2020  rse(schema_s).  
-0000c1d0: 2020 2020 2020 6578 6365 7074 2061 7672        except avr
-0000c1e0: 6f2e 7363 6865 6d61 2e53 6368 656d 6150  o.schema.SchemaP
-0000c1f0: 6172 7365 4578 6365 7074 696f 6e20 6173  arseException as
-0000c200: 2065 3a0a 2020 2020 2020 2020 2020 2020   e:.            
-0000c210: 7261 6973 6520 4665 6174 7572 6553 746f  raise FeatureSto
-0000c220: 7265 4578 6365 7074 696f 6e28 2246 6169  reException("Fai
-0000c230: 6c65 6420 746f 2063 6f6e 7374 7275 6374  led to construct
-0000c240: 2041 7672 6f20 5363 6865 6d61 3a20 7b7d   Avro Schema: {}
-0000c250: 222e 666f 726d 6174 2865 2929 0a20 2020  ".format(e)).   
-0000c260: 2020 2020 2072 6574 7572 6e20 7363 6865       return sche
-0000c270: 6d61 5f73 0a0a 2020 2020 6465 6620 5f67  ma_s..    def _g
-0000c280: 6574 5f66 6561 7475 7265 5f61 7672 6f5f  et_feature_avro_
-0000c290: 7363 6865 6d61 2873 656c 662c 2066 6561  schema(self, fea
-0000c2a0: 7475 7265 5f6e 616d 6529 3a0a 2020 2020  ture_name):.    
-0000c2b0: 2020 2020 666f 7220 6669 656c 6420 696e      for field in
-0000c2c0: 206a 736f 6e2e 6c6f 6164 7328 7365 6c66   json.loads(self
-0000c2d0: 2e61 7672 6f5f 7363 6865 6d61 295b 2266  .avro_schema)["f
-0000c2e0: 6965 6c64 7322 5d3a 0a20 2020 2020 2020  ields"]:.       
-0000c2f0: 2020 2020 2069 6620 6669 656c 645b 226e       if field["n
-0000c300: 616d 6522 5d20 3d3d 2066 6561 7475 7265  ame"] == feature
-0000c310: 5f6e 616d 653a 0a20 2020 2020 2020 2020  _name:.         
-0000c320: 2020 2020 2020 2072 6574 7572 6e20 6a73         return js
-0000c330: 6f6e 2e64 756d 7073 2866 6965 6c64 5b22  on.dumps(field["
-0000c340: 7479 7065 225d 290a 0a0a 636c 6173 7320  type"])...class 
-0000c350: 4665 6174 7572 6547 726f 7570 2846 6561  FeatureGroup(Fea
-0000c360: 7475 7265 4772 6f75 7042 6173 6529 3a0a  tureGroupBase):.
-0000c370: 2020 2020 4341 4348 4544 5f46 4541 5455      CACHED_FEATU
-0000c380: 5245 5f47 524f 5550 203d 2022 4341 4348  RE_GROUP = "CACH
-0000c390: 4544 5f46 4541 5455 5245 5f47 524f 5550  ED_FEATURE_GROUP
-0000c3a0: 220a 2020 2020 5354 5245 414d 5f46 4541  ".    STREAM_FEA
-0000c3b0: 5455 5245 5f47 524f 5550 203d 2022 5354  TURE_GROUP = "ST
-0000c3c0: 5245 414d 5f46 4541 5455 5245 5f47 524f  REAM_FEATURE_GRO
-0000c3d0: 5550 220a 2020 2020 454e 5449 5459 5f54  UP".    ENTITY_T
-0000c3e0: 5950 4520 3d20 2266 6561 7475 7265 6772  YPE = "featuregr
-0000c3f0: 6f75 7073 220a 0a20 2020 2064 6566 205f  oups"..    def _
-0000c400: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-0000c410: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
-0000c420: 616d 652c 0a20 2020 2020 2020 2076 6572  ame,.        ver
-0000c430: 7369 6f6e 2c0a 2020 2020 2020 2020 6665  sion,.        fe
-0000c440: 6174 7572 6573 746f 7265 5f69 642c 0a20  aturestore_id,. 
-0000c450: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
-0000c460: 6f6e 3d22 222c 0a20 2020 2020 2020 2070  on="",.        p
-0000c470: 6172 7469 7469 6f6e 5f6b 6579 3d4e 6f6e  artition_key=Non
-0000c480: 652c 0a20 2020 2020 2020 2070 7269 6d61  e,.        prima
-0000c490: 7279 5f6b 6579 3d4e 6f6e 652c 0a20 2020  ry_key=None,.   
-0000c4a0: 2020 2020 2068 7564 695f 7072 6563 6f6d       hudi_precom
-0000c4b0: 6269 6e65 5f6b 6579 3d4e 6f6e 652c 0a20  bine_key=None,. 
-0000c4c0: 2020 2020 2020 2066 6561 7475 7265 7374         featurest
-0000c4d0: 6f72 655f 6e61 6d65 3d4e 6f6e 652c 0a20  ore_name=None,. 
-0000c4e0: 2020 2020 2020 2063 7265 6174 6564 3d4e         created=N
-0000c4f0: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
-0000c500: 6174 6f72 3d4e 6f6e 652c 0a20 2020 2020  ator=None,.     
-0000c510: 2020 2069 643d 4e6f 6e65 2c0a 2020 2020     id=None,.    
-0000c520: 2020 2020 6665 6174 7572 6573 3d4e 6f6e      features=Non
-0000c530: 652c 0a20 2020 2020 2020 206c 6f63 6174  e,.        locat
-0000c540: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  ion=None,.      
-0000c550: 2020 6f6e 6c69 6e65 5f65 6e61 626c 6564    online_enabled
-0000c560: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0000c570: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
-0000c580: 6174 3d4e 6f6e 652c 0a20 2020 2020 2020  at=None,.       
-0000c590: 2073 7461 7469 7374 6963 735f 636f 6e66   statistics_conf
-0000c5a0: 6967 3d4e 6f6e 652c 0a20 2020 2020 2020  ig=None,.       
-0000c5b0: 206f 6e6c 696e 655f 746f 7069 635f 6e61   online_topic_na
-0000c5c0: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-0000c5d0: 2065 7665 6e74 5f74 696d 653d 4e6f 6e65   event_time=None
-0000c5e0: 2c0a 2020 2020 2020 2020 7374 7265 616d  ,.        stream
-0000c5f0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-0000c600: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-0000c610: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-0000c620: 7061 7265 6e74 733d 4e6f 6e65 2c0a 2020  parents=None,.  
-0000c630: 2020 2020 2020 6872 6566 3d4e 6f6e 652c        href=None,
-0000c640: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000c650: 7375 7065 7228 292e 5f5f 696e 6974 5f5f  super().__init__
-0000c660: 280a 2020 2020 2020 2020 2020 2020 6665  (.            fe
-0000c670: 6174 7572 6573 746f 7265 5f69 642c 0a20  aturestore_id,. 
-0000c680: 2020 2020 2020 2020 2020 206c 6f63 6174             locat
-0000c690: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0000c6a0: 2065 7665 6e74 5f74 696d 653d 6576 656e   event_time=even
-0000c6b0: 745f 7469 6d65 2c0a 2020 2020 2020 2020  t_time,.        
-0000c6c0: 2020 2020 6f6e 6c69 6e65 5f65 6e61 626c      online_enabl
-0000c6d0: 6564 3d6f 6e6c 696e 655f 656e 6162 6c65  ed=online_enable
-0000c6e0: 642c 0a20 2020 2020 2020 2020 2020 2069  d,.            i
-0000c6f0: 643d 6964 2c0a 2020 2020 2020 2020 2020  d=id,.          
-0000c700: 2020 6578 7065 6374 6174 696f 6e5f 7375    expectation_su
-0000c710: 6974 653d 6578 7065 6374 6174 696f 6e5f  ite=expectation_
-0000c720: 7375 6974 652c 0a20 2020 2020 2020 2020  suite,.         
-0000c730: 2020 206f 6e6c 696e 655f 746f 7069 635f     online_topic_
-0000c740: 6e61 6d65 3d6f 6e6c 696e 655f 746f 7069  name=online_topi
-0000c750: 635f 6e61 6d65 2c0a 2020 2020 2020 2020  c_name,.        
-0000c760: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000c770: 5f66 6561 7475 7265 5f73 746f 7265 5f6e  _feature_store_n
-0000c780: 616d 6520 3d20 6665 6174 7572 6573 746f  ame = featuresto
-0000c790: 7265 5f6e 616d 650a 2020 2020 2020 2020  re_name.        
-0000c7a0: 7365 6c66 2e5f 6465 7363 7269 7074 696f  self._descriptio
-0000c7b0: 6e20 3d20 6465 7363 7269 7074 696f 6e0a  n = description.
-0000c7c0: 2020 2020 2020 2020 7365 6c66 2e5f 6372          self._cr
-0000c7d0: 6561 7465 6420 3d20 6372 6561 7465 640a  eated = created.
-0000c7e0: 2020 2020 2020 2020 7365 6c66 2e5f 6372          self._cr
-0000c7f0: 6561 746f 7220 3d20 7573 6572 2e55 7365  eator = user.Use
-0000c800: 722e 6672 6f6d 5f72 6573 706f 6e73 655f  r.from_response_
-0000c810: 6a73 6f6e 2863 7265 6174 6f72 290a 2020  json(creator).  
-0000c820: 2020 2020 2020 7365 6c66 2e5f 7665 7273        self._vers
-0000c830: 696f 6e20 3d20 7665 7273 696f 6e0a 2020  ion = version.  
-0000c840: 2020 2020 2020 7365 6c66 2e5f 6e61 6d65        self._name
-0000c850: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
-0000c860: 7365 6c66 2e5f 6665 6174 7572 6573 203d  self._features =
-0000c870: 205b 0a20 2020 2020 2020 2020 2020 2066   [.            f
-0000c880: 6561 7475 7265 2e46 6561 7475 7265 2e66  eature.Feature.f
-0000c890: 726f 6d5f 7265 7370 6f6e 7365 5f6a 736f  rom_response_jso
-0000c8a0: 6e28 6665 6174 2920 6966 2069 7369 6e73  n(feat) if isins
-0000c8b0: 7461 6e63 6528 6665 6174 2c20 6469 6374  tance(feat, dict
-0000c8c0: 2920 656c 7365 2066 6561 740a 2020 2020  ) else feat.    
-0000c8d0: 2020 2020 2020 2020 666f 7220 6665 6174          for feat
-0000c8e0: 2069 6e20 2866 6561 7475 7265 7320 6f72   in (features or
-0000c8f0: 205b 5d29 0a20 2020 2020 2020 205d 0a0a   []).        ]..
-0000c900: 2020 2020 2020 2020 7365 6c66 2e5f 7469          self._ti
-0000c910: 6d65 5f74 7261 7665 6c5f 666f 726d 6174  me_travel_format
-0000c920: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000c930: 2074 696d 655f 7472 6176 656c 5f66 6f72   time_travel_for
-0000c940: 6d61 742e 7570 7065 7228 2920 6966 2074  mat.upper() if t
-0000c950: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
-0000c960: 7420 6973 206e 6f74 204e 6f6e 6520 656c  t is not None el
-0000c970: 7365 204e 6f6e 650a 2020 2020 2020 2020  se None.        
-0000c980: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000c990: 5f73 7472 6561 6d20 3d20 7374 7265 616d  _stream = stream
-0000c9a0: 0a20 2020 2020 2020 2073 656c 662e 5f70  .        self._p
-0000c9b0: 6172 656e 7473 203d 2070 6172 656e 7473  arents = parents
-0000c9c0: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-0000c9d0: 656c 7461 7374 7265 616d 6572 5f6a 6f62  eltastreamer_job
-0000c9e0: 636f 6e66 203d 204e 6f6e 650a 0a20 2020  conf = None..   
-0000c9f0: 2020 2020 2073 656c 662e 5f62 6163 6b66       self._backf
-0000ca00: 696c 6c5f 6a6f 6220 3d20 4e6f 6e65 0a0a  ill_job = None..
-0000ca10: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000ca20: 5f69 643a 0a20 2020 2020 2020 2020 2020  _id:.           
-0000ca30: 2023 2069 6e69 7469 616c 697a 6564 2062   # initialized b
-0000ca40: 7920 6261 636b 656e 640a 2020 2020 2020  y backend.      
-0000ca50: 2020 2020 2020 7365 6c66 2e70 7269 6d61        self.prima
-0000ca60: 7279 5f6b 6579 203d 205b 0a20 2020 2020  ry_key = [.     
-0000ca70: 2020 2020 2020 2020 2020 2066 6561 742e             feat.
-0000ca80: 6e61 6d65 2066 6f72 2066 6561 7420 696e  name for feat in
-0000ca90: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
-0000caa0: 6966 2066 6561 742e 7072 696d 6172 7920  if feat.primary 
-0000cab0: 6973 2054 7275 650a 2020 2020 2020 2020  is True.        
-0000cac0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
-0000cad0: 2020 7365 6c66 2e5f 7061 7274 6974 696f    self._partitio
-0000cae0: 6e5f 6b65 7920 3d20 5b0a 2020 2020 2020  n_key = [.      
-0000caf0: 2020 2020 2020 2020 2020 6665 6174 2e6e            feat.n
-0000cb00: 616d 6520 666f 7220 6665 6174 2069 6e20  ame for feat in 
-0000cb10: 7365 6c66 2e5f 6665 6174 7572 6573 2069  self._features i
-0000cb20: 6620 6665 6174 2e70 6172 7469 7469 6f6e  f feat.partition
-0000cb30: 2069 7320 5472 7565 0a20 2020 2020 2020   is True.       
-0000cb40: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-0000cb50: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-0000cb60: 2020 2020 2020 2020 7469 6d65 5f74 7261          time_tra
-0000cb70: 7665 6c5f 666f 726d 6174 2069 7320 6e6f  vel_format is no
-0000cb80: 7420 4e6f 6e65 0a20 2020 2020 2020 2020  t None.         
-0000cb90: 2020 2020 2020 2061 6e64 2074 696d 655f         and time_
-0000cba0: 7472 6176 656c 5f66 6f72 6d61 742e 7570  travel_format.up
-0000cbb0: 7065 7228 2920 3d3d 2022 4855 4449 220a  per() == "HUDI".
-0000cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbd0: 616e 6420 7365 6c66 2e5f 6665 6174 7572  and self._featur
-0000cbe0: 6573 0a20 2020 2020 2020 2020 2020 2029  es.            )
-0000cbf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000cc00: 2020 2320 6875 6469 2070 7265 636f 6d62    # hudi precomb
-0000cc10: 696e 6520 6b65 7920 6973 2061 6c77 6179  ine key is alway
-0000cc20: 7320 6120 7369 6e67 6c65 2066 6561 7475  s a single featu
-0000cc30: 7265 0a20 2020 2020 2020 2020 2020 2020  re.             
-0000cc40: 2020 2073 656c 662e 5f68 7564 695f 7072     self._hudi_pr
-0000cc50: 6563 6f6d 6269 6e65 5f6b 6579 203d 205b  ecombine_key = [
-0000cc60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cc70: 2020 2020 2066 6561 742e 6e61 6d65 0a20       feat.name. 
-0000cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc90: 2020 2066 6f72 2066 6561 7420 696e 2073     for feat in s
-0000cca0: 656c 662e 5f66 6561 7475 7265 730a 2020  elf._features.  
-0000ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ccc0: 2020 6966 2066 6561 742e 6875 6469 5f70    if feat.hudi_p
-0000ccd0: 7265 636f 6d62 696e 655f 6b65 7920 6973  recombine_key is
-0000cce0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-0000ccf0: 2020 2020 2020 5d5b 305d 0a20 2020 2020        ][0].     
-0000cd00: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000cd10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0000cd20: 662e 5f68 7564 695f 7072 6563 6f6d 6269  f._hudi_precombi
-0000cd30: 6e65 5f6b 6579 203d 204e 6f6e 650a 0a20  ne_key = None.. 
-0000cd40: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000cd50: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-0000cd60: 6720 3d20 7374 6174 6973 7469 6373 5f63  g = statistics_c
-0000cd70: 6f6e 6669 670a 0a20 2020 2020 2020 2065  onfig..        e
-0000cd80: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000cd90: 2023 2069 6e69 7469 616c 697a 6564 2062   # initialized b
-0000cda0: 7920 7573 6572 0a20 2020 2020 2020 2020  y user.         
-0000cdb0: 2020 2023 2066 6f72 2070 7974 686f 6e20     # for python 
-0000cdc0: 656e 6769 6e65 2077 6520 616c 7761 7973  engine we always
-0000cdd0: 2075 7365 2073 7472 6561 6d20 6665 6174   use stream feat
-0000cde0: 7572 6520 6772 6f75 700a 2020 2020 2020  ure group.      
-0000cdf0: 2020 2020 2020 6966 2065 6e67 696e 652e        if engine.
-0000ce00: 6765 745f 7479 7065 2829 203d 3d20 2270  get_type() == "p
-0000ce10: 7974 686f 6e22 3a0a 2020 2020 2020 2020  ython":.        
-0000ce20: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-0000ce30: 7265 616d 203d 2054 7275 650a 2020 2020  ream = True.    
-0000ce40: 2020 2020 2020 2020 2320 666f 7220 7374          # for st
-0000ce50: 7265 616d 2066 6561 7475 7265 2067 726f  ream feature gro
-0000ce60: 7570 2074 696d 6520 7472 6176 656c 2066  up time travel f
-0000ce70: 6f72 6d61 7420 6973 2061 6c77 6179 7320  ormat is always 
-0000ce80: 4855 4449 0a20 2020 2020 2020 2020 2020  HUDI.           
-0000ce90: 2069 6620 7365 6c66 2e5f 7374 7265 616d   if self._stream
-0000cea0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000ceb0: 2020 6578 7065 6374 6564 5f66 6f72 6d61    expected_forma
-0000cec0: 7420 3d20 2248 5544 4922 0a20 2020 2020  t = "HUDI".     
-0000ced0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0000cee0: 6c66 2e5f 7469 6d65 5f74 7261 7665 6c5f  lf._time_travel_
-0000cef0: 666f 726d 6174 2021 3d20 6578 7065 6374  format != expect
-0000cf00: 6564 5f66 6f72 6d61 743a 0a20 2020 2020  ed_format:.     
-0000cf10: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000cf20: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-0000cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf40: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-0000cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cf60: 2020 2020 2254 6865 2070 726f 7669 6465      "The provide
-0000cf70: 6420 7469 6d65 2074 7261 7665 6c20 666f  d time travel fo
-0000cf80: 726d 6174 2060 7b7d 6020 6861 7320 6265  rmat `{}` has be
-0000cf90: 656e 206f 7665 7277 7269 7474 656e 2022  en overwritten "
-0000cfa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cfb0: 2020 2020 2020 2020 2020 2020 2022 6265               "be
-0000cfc0: 6361 7573 6520 5374 7265 616d 2065 6e61  cause Stream ena
-0000cfd0: 626c 6564 2066 6561 7475 7265 2067 726f  bled feature gro
-0000cfe0: 7570 7320 6f6e 6c79 2073 7570 706f 7274  ups only support
-0000cff0: 2060 7b7d 6022 0a20 2020 2020 2020 2020   `{}`".         
-0000d000: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000d010: 2e66 6f72 6d61 7428 7365 6c66 2e5f 7469  .format(self._ti
-0000d020: 6d65 5f74 7261 7665 6c5f 666f 726d 6174  me_travel_format
-0000d030: 2c20 6578 7065 6374 6564 5f66 6f72 6d61  , expected_forma
-0000d040: 7429 2c0a 2020 2020 2020 2020 2020 2020  t),.            
-0000d050: 2020 2020 2020 2020 2020 2020 7574 696c              util
-0000d060: 2e46 6561 7475 7265 4772 6f75 7057 6172  .FeatureGroupWar
-0000d070: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-0000d080: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0a0: 7365 6c66 2e5f 7469 6d65 5f74 7261 7665  self._time_trave
-0000d0b0: 6c5f 666f 726d 6174 203d 2065 7870 6563  l_format = expec
-0000d0c0: 7465 645f 666f 726d 6174 0a0a 2020 2020  ted_format..    
-0000d0d0: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
-0000d0e0: 6d61 7279 5f6b 6579 203d 2070 7269 6d61  mary_key = prima
-0000d0f0: 7279 5f6b 6579 0a20 2020 2020 2020 2020  ry_key.         
-0000d100: 2020 2073 656c 662e 7061 7274 6974 696f     self.partitio
-0000d110: 6e5f 6b65 7920 3d20 7061 7274 6974 696f  n_key = partitio
-0000d120: 6e5f 6b65 790a 2020 2020 2020 2020 2020  n_key.          
-0000d130: 2020 7365 6c66 2e5f 6875 6469 5f70 7265    self._hudi_pre
-0000d140: 636f 6d62 696e 655f 6b65 7920 3d20 280a  combine_key = (.
-0000d150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d160: 6875 6469 5f70 7265 636f 6d62 696e 655f  hudi_precombine_
-0000d170: 6b65 792e 6c6f 7765 7228 290a 2020 2020  key.lower().    
-0000d180: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-0000d190: 7564 695f 7072 6563 6f6d 6269 6e65 5f6b  udi_precombine_k
-0000d1a0: 6579 2069 7320 6e6f 7420 4e6f 6e65 0a20  ey is not None. 
-0000d1b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000d1c0: 6e64 2073 656c 662e 5f74 696d 655f 7472  nd self._time_tr
-0000d1d0: 6176 656c 5f66 6f72 6d61 7420 6973 206e  avel_format is n
-0000d1e0: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
-0000d1f0: 2020 2020 2020 2020 616e 6420 7365 6c66          and self
-0000d200: 2e5f 7469 6d65 5f74 7261 7665 6c5f 666f  ._time_travel_fo
-0000d210: 726d 6174 203d 3d20 2248 5544 4922 0a20  rmat == "HUDI". 
-0000d220: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000d230: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
-0000d240: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000d250: 2020 2073 656c 662e 7374 6174 6973 7469     self.statisti
-0000d260: 6373 5f63 6f6e 6669 6720 3d20 7374 6174  cs_config = stat
-0000d270: 6973 7469 6373 5f63 6f6e 6669 670a 0a20  istics_config.. 
-0000d280: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
-0000d290: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
-0000d2a0: 6520 3d20 6665 6174 7572 655f 6772 6f75  e = feature_grou
-0000d2b0: 705f 656e 6769 6e65 2e46 6561 7475 7265  p_engine.Feature
-0000d2c0: 4772 6f75 7045 6e67 696e 6528 0a20 2020  GroupEngine(.   
-0000d2d0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0000d2e0: 7374 6f72 655f 6964 0a20 2020 2020 2020  store_id.       
-0000d2f0: 2029 0a20 2020 2020 2020 2073 656c 662e   ).        self.
-0000d300: 5f68 7265 6620 3d20 6872 6566 0a0a 2020  _href = href..  
-0000d310: 2020 2020 2020 2320 6361 6368 6520 666f        # cache fo
-0000d320: 7220 6f70 7469 6d69 7a65 6420 7772 6974  r optimized writ
-0000d330: 6573 0a20 2020 2020 2020 2073 656c 662e  es.        self.
-0000d340: 5f6b 6166 6b61 5f70 726f 6475 6365 7220  _kafka_producer 
-0000d350: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-0000d360: 656c 662e 5f66 6561 7475 7265 5f77 7269  elf._feature_wri
-0000d370: 7465 7273 203d 204e 6f6e 650a 2020 2020  ters = None.    
-0000d380: 2020 2020 7365 6c66 2e5f 7772 6974 6572      self._writer
-0000d390: 203d 204e 6f6e 650a 0a20 2020 2064 6566   = None..    def
-0000d3a0: 2072 6561 6428 0a20 2020 2020 2020 2073   read(.        s
-0000d3b0: 656c 662c 0a20 2020 2020 2020 2077 616c  elf,.        wal
-0000d3c0: 6c63 6c6f 636b 5f74 696d 653a 204f 7074  lclock_time: Opt
-0000d3d0: 696f 6e61 6c5b 556e 696f 6e5b 7374 722c  ional[Union[str,
-0000d3e0: 2069 6e74 2c20 6461 7465 7469 6d65 2c20   int, datetime, 
-0000d3f0: 6461 7465 5d5d 203d 204e 6f6e 652c 0a20  date]] = None,. 
-0000d400: 2020 2020 2020 206f 6e6c 696e 653a 204f         online: O
-0000d410: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
-0000d420: 4661 6c73 652c 0a20 2020 2020 2020 2064  False,.        d
-0000d430: 6174 6166 7261 6d65 5f74 7970 653a 204f  ataframe_type: O
-0000d440: 7074 696f 6e61 6c5b 7374 725d 203d 2022  ptional[str] = "
-0000d450: 6465 6661 756c 7422 2c0a 2020 2020 2020  default",.      
-0000d460: 2020 7265 6164 5f6f 7074 696f 6e73 3a20    read_options: 
-0000d470: 4f70 7469 6f6e 616c 5b64 6963 745d 203d  Optional[dict] =
-0000d480: 207b 7d2c 0a20 2020 2029 3a0a 2020 2020   {},.    ):.    
-0000d490: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d4a0: 5265 6164 2074 6865 2066 6561 7475 7265  Read the feature
-0000d4b0: 2067 726f 7570 2069 6e74 6f20 6120 6461   group into a da
-0000d4c0: 7461 6672 616d 652e 0a0a 2020 2020 2020  taframe...      
-0000d4d0: 2020 5265 6164 7320 7468 6520 6665 6174    Reads the feat
-0000d4e0: 7572 6520 6772 6f75 7020 6279 2064 6566  ure group by def
-0000d4f0: 6175 6c74 2066 726f 6d20 7468 6520 6f66  ault from the of
-0000d500: 666c 696e 6520 7374 6f72 6167 6520 6173  fline storage as
-0000d510: 2053 7061 726b 2044 6174 6146 7261 6d65   Spark DataFrame
-0000d520: 0a20 2020 2020 2020 206f 6e20 486f 7073  .        on Hops
-0000d530: 776f 726b 7320 616e 6420 4461 7461 6272  works and Databr
-0000d540: 6963 6b73 2c20 616e 6420 6173 2050 616e  icks, and as Pan
-0000d550: 6461 7320 6461 7461 6672 616d 6520 6f6e  das dataframe on
-0000d560: 2041 5753 2053 6167 656d 616b 6572 2061   AWS Sagemaker a
-0000d570: 6e64 2070 7572 650a 2020 2020 2020 2020  nd pure.        
-0000d580: 5079 7468 6f6e 2065 6e76 6972 6f6e 6d65  Python environme
-0000d590: 6e74 732e 0a0a 2020 2020 2020 2020 5365  nts...        Se
-0000d5a0: 7420 606f 6e6c 696e 6560 2074 6f20 6054  t `online` to `T
-0000d5b0: 7275 6560 2074 6f20 7265 6164 2066 726f  rue` to read fro
-0000d5c0: 6d20 7468 6520 6f6e 6c69 6e65 2073 746f  m the online sto
-0000d5d0: 7261 6765 2c20 6f72 2063 6861 6e67 650a  rage, or change.
-0000d5e0: 2020 2020 2020 2020 6064 6174 6166 7261          `datafra
-0000d5f0: 6d65 5f74 7970 6560 2074 6f20 7265 6164  me_type` to read
-0000d600: 2061 7320 6120 6469 6666 6572 656e 7420   as a different 
-0000d610: 666f 726d 6174 2e0a 0a20 2020 2020 2020  format...       
-0000d620: 2021 2121 2065 7861 6d70 6c65 2022 5265   !!! example "Re
-0000d630: 6164 2066 6561 7475 7265 2067 726f 7570  ad feature group
-0000d640: 2061 7320 6f66 206c 6174 6573 7420 7374   as of latest st
-0000d650: 6174 653a 220a 2020 2020 2020 2020 2020  ate:".          
-0000d660: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-0000d670: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-0000d680: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-0000d690: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-0000d6a0: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-0000d6b0: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-0000d6c0: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-0000d6d0: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-0000d6e0: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
-0000d6f0: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
-0000d700: 7572 655f 6772 6f75 7028 2e2e 2e29 0a20  ure_group(...). 
-0000d710: 2020 2020 2020 2020 2020 2066 672e 7265             fg.re
-0000d720: 6164 2829 0a20 2020 2020 2020 2020 2020  ad().           
-0000d730: 2060 6060 0a0a 2020 2020 2020 2020 2121   ```..        !!
-0000d740: 2120 6578 616d 706c 6520 2252 6561 6420  ! example "Read 
-0000d750: 6665 6174 7572 6520 6772 6f75 7020 6173  feature group as
-0000d760: 206f 6620 7370 6563 6966 6963 2070 6f69   of specific poi
-0000d770: 6e74 2069 6e20 7469 6d65 3a22 0a20 2020  nt in time:".   
-0000d780: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-0000d790: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
-0000d7a0: 6720 3d20 6673 2e67 6574 5f6f 725f 6372  g = fs.get_or_cr
-0000d7b0: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-0000d7c0: 7570 282e 2e2e 290a 2020 2020 2020 2020  up(...).        
-0000d7d0: 2020 2020 6667 2e72 6561 6428 2232 3032      fg.read("202
-0000d7e0: 302d 3130 2d32 3020 3037 3a33 343a 3131  0-10-20 07:34:11
-0000d7f0: 2229 0a20 2020 2020 2020 2020 2020 2060  ").            `
-0000d800: 6060 0a0a 2020 2020 2020 2020 2320 4172  ``..        # Ar
-0000d810: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-0000d820: 2020 2020 7761 6c6c 636c 6f63 6b5f 7469      wallclock_ti
-0000d830: 6d65 3a20 4966 2073 7065 6369 6669 6564  me: If specified
-0000d840: 2077 696c 6c20 7265 7472 6965 7665 2066   will retrieve f
-0000d850: 6561 7475 7265 2067 726f 7570 2061 7320  eature group as 
-0000d860: 6f66 2073 7065 6369 6669 6320 706f 696e  of specific poin
-0000d870: 7420 696e 2074 696d 652e 2044 6566 6175  t in time. Defau
-0000d880: 6c74 7320 746f 2060 4e6f 6e65 602e 0a20  lts to `None`.. 
-0000d890: 2020 2020 2020 2020 2020 2020 2020 2049                 I
-0000d8a0: 6620 6e6f 7420 7370 6563 6966 6965 642c  f not specified,
-0000d8b0: 2077 696c 6c20 7265 7475 726e 2061 7320   will return as 
-0000d8c0: 6f66 206d 6f73 7420 7265 6365 6e74 2074  of most recent t
-0000d8d0: 696d 652e 0a20 2020 2020 2020 2020 2020  ime..           
-0000d8e0: 2020 2020 2053 7472 696e 6773 2073 686f       Strings sho
-0000d8f0: 756c 6420 6265 2066 6f72 6d61 7474 6564  uld be formatted
-0000d900: 2069 6e20 6f6e 6520 6f66 2074 6865 2066   in one of the f
-0000d910: 6f6c 6c6f 7769 6e67 2066 6f72 6d61 7473  ollowing formats
-0000d920: 2060 2559 2d25 6d2d 2564 602c 2060 2559   `%Y-%m-%d`, `%Y
-0000d930: 2d25 6d2d 2564 2025 4860 2c20 6025 592d  -%m-%d %H`, `%Y-
-0000d940: 256d 2d25 6420 2548 3a25 4d60 2c20 6025  %m-%d %H:%M`, `%
-0000d950: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-0000d960: 602c 0a20 2020 2020 2020 2020 2020 2020  `,.             
-0000d970: 2020 206f 7220 6025 592d 256d 2d25 6420     or `%Y-%m-%d 
-0000d980: 2548 3a25 4d3a 2553 2e25 6660 2e0a 2020  %H:%M:%S.%f`..  
-0000d990: 2020 2020 2020 2020 2020 6f6e 6c69 6e65            online
-0000d9a0: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-0000d9b0: 2e20 4966 2060 5472 7565 6020 7265 6164  . If `True` read
-0000d9c0: 2066 726f 6d20 6f6e 6c69 6e65 2066 6561   from online fea
-0000d9d0: 7475 7265 2073 746f 7265 2c20 6465 6661  ture store, defa
-0000d9e0: 756c 7473 0a20 2020 2020 2020 2020 2020  ults.           
-0000d9f0: 2020 2020 2074 6f20 6046 616c 7365 602e       to `False`.
-0000da00: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0000da10: 6166 7261 6d65 5f74 7970 653a 2073 7472  aframe_type: str
-0000da20: 2c20 6f70 7469 6f6e 616c 2e20 506f 7373  , optional. Poss
-0000da30: 6962 6c65 2076 616c 7565 7320 6172 6520  ible values are 
-0000da40: 6022 6465 6661 756c 7422 602c 2060 2273  `"default"`, `"s
-0000da50: 7061 726b 2260 2c0a 2020 2020 2020 2020  park"`,.        
-0000da60: 2020 2020 2020 2020 6022 7061 6e64 6173          `"pandas
-0000da70: 2260 2c20 6022 6e75 6d70 7922 6020 6f72  "`, `"numpy"` or
-0000da80: 2060 2270 7974 686f 6e22 602c 2064 6566   `"python"`, def
-0000da90: 6175 6c74 7320 746f 2060 2264 6566 6175  aults to `"defau
-0000daa0: 6c74 2260 2e0a 2020 2020 2020 2020 2020  lt"`..          
-0000dab0: 2020 7265 6164 5f6f 7074 696f 6e73 3a20    read_options: 
-0000dac0: 4164 6469 7469 6f6e 616c 206f 7074 696f  Additional optio
-0000dad0: 6e73 2061 7320 6b65 792f 7661 6c75 6520  ns as key/value 
-0000dae0: 7061 6972 7320 746f 2070 6173 7320 746f  pairs to pass to
-0000daf0: 2074 6865 2065 7865 6375 7469 6f6e 2065   the execution e
-0000db00: 6e67 696e 652e 0a20 2020 2020 2020 2020  ngine..         
-0000db10: 2020 2020 2020 2046 6f72 2073 7061 726b         For spark
-0000db20: 2065 6e67 696e 653a 2044 6963 7469 6f6e   engine: Diction
-0000db30: 6172 7920 6f66 2072 6561 6420 6f70 7469  ary of read opti
-0000db40: 6f6e 7320 666f 7220 5370 6172 6b2e 0a20  ons for Spark.. 
-0000db50: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-0000db60: 6f72 2070 7974 686f 6e20 656e 6769 6e65  or python engine
-0000db70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000db80: 2020 2a20 6b65 7920 6022 6869 7665 5f63    * key `"hive_c
-0000db90: 6f6e 6669 6722 6020 746f 2070 6173 7320  onfig"` to pass 
-0000dba0: 6120 6469 6374 696f 6e61 7279 206f 6620  a dictionary of 
-0000dbb0: 6869 7665 206f 7220 7465 7a20 636f 6e66  hive or tez conf
-0000dbc0: 6967 7572 6174 696f 6e73 2e0a 2020 2020  igurations..    
-0000dbd0: 2020 2020 2020 2020 2020 2020 2020 466f                Fo
-0000dbe0: 7220 6578 616d 706c 653a 2060 7b22 6869  r example: `{"hi
-0000dbf0: 7665 5f63 6f6e 6669 6722 3a20 7b22 6869  ve_config": {"hi
-0000dc00: 7665 2e74 657a 2e63 7075 2e76 636f 7265  ve.tez.cpu.vcore
-0000dc10: 7322 3a20 322c 2022 7465 7a2e 6772 6f75  s": 2, "tez.grou
-0000dc20: 7069 6e67 2e73 706c 6974 2d63 6f75 6e74  ping.split-count
-0000dc30: 223a 2022 3322 7d7d 600a 2020 2020 2020  ": "3"}}`.      
-0000dc40: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
-0000dc50: 6022 7061 6e64 6173 5f74 7970 6573 2260  `"pandas_types"`
-0000dc60: 2061 6e64 2076 616c 7565 2060 5472 7565   and value `True
-0000dc70: 6020 746f 2072 6574 7269 6576 6520 636f  ` to retrieve co
-0000dc80: 6c75 6d6e 7320 6173 2050 616e 6461 7320  lumns as Pandas 
-0000dc90: 6e75 6c6c 6162 6c65 2074 7970 6573 0a20  nullable types. 
-0000dca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dcb0: 2072 6174 6865 7220 7468 616e 206e 756d   rather than num
-0000dcc0: 7079 2f6f 626a 6563 7428 7374 7269 6e67  py/object(string
-0000dcd0: 2920 7479 7065 7320 2865 7870 6572 696d  ) types (experim
-0000dce0: 656e 7461 6c29 2e0a 2020 2020 2020 2020  ental)..        
-0000dcf0: 2020 2020 2020 2020 2020 2873 6565 2068            (see h
-0000dd00: 7474 7073 3a2f 2f70 616e 6461 732e 7079  ttps://pandas.py
-0000dd10: 6461 7461 2e6f 7267 2f64 6f63 732f 7573  data.org/docs/us
-0000dd20: 6572 5f67 7569 6465 2f69 6e74 6567 6572  er_guide/integer
-0000dd30: 5f6e 612e 6874 6d6c 292e 0a20 2020 2020  _na.html)..     
-0000dd40: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-0000dd50: 6c74 7320 746f 2060 7b7d 602e 0a0a 2020  lts to `{}`...  
-0000dd60: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-0000dd70: 2020 2020 2020 2020 2020 2020 6044 6174              `Dat
-0000dd80: 6146 7261 6d65 603a 2054 6865 2073 7061  aFrame`: The spa
-0000dd90: 726b 2064 6174 6166 7261 6d65 2063 6f6e  rk dataframe con
-0000dda0: 7461 696e 696e 6720 7468 6520 6665 6174  taining the feat
-0000ddb0: 7572 6520 6461 7461 2e0a 2020 2020 2020  ure data..      
-0000ddc0: 2020 2020 2020 6070 7973 7061 726b 2e44        `pyspark.D
-0000ddd0: 6174 6146 7261 6d65 602e 2041 2053 7061  ataFrame`. A Spa
-0000dde0: 726b 2044 6174 6146 7261 6d65 2e0a 2020  rk DataFrame..  
-0000ddf0: 2020 2020 2020 2020 2020 6070 616e 6461            `panda
-0000de00: 732e 4461 7461 4672 616d 6560 2e20 4120  s.DataFrame`. A 
-0000de10: 5061 6e64 6173 2044 6174 6146 7261 6d65  Pandas DataFrame
-0000de20: 2e0a 2020 2020 2020 2020 2020 2020 606e  ..            `n
-0000de30: 756d 7079 2e6e 6461 7272 6179 602e 2041  umpy.ndarray`. A
-0000de40: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
-0000de50: 204e 756d 7079 2061 7272 6179 2e0a 2020   Numpy array..  
-0000de60: 2020 2020 2020 2020 2020 606c 6973 7460            `list`
-0000de70: 2e20 4120 7477 6f2d 6469 6d65 6e73 696f  . A two-dimensio
-0000de80: 6e61 6c20 5079 7468 6f6e 206c 6973 742e  nal Python list.
-0000de90: 0a0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
-0000dea0: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
-0000deb0: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
-0000dec0: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
-0000ded0: 726f 7260 2e20 4e6f 2064 6174 6120 6973  ror`. No data is
-0000dee0: 2061 7661 696c 6162 6c65 2066 6f72 2066   available for f
-0000def0: 6561 7475 7265 2067 726f 7570 2077 6974  eature group wit
-0000df00: 6820 7468 6973 2063 6f6d 6d69 7420 6461  h this commit da
-0000df10: 7465 2c20 4966 2074 696d 6520 7472 6176  te, If time trav
-0000df20: 656c 2065 6e61 626c 6564 2e0a 2020 2020  el enabled..    
-0000df30: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000df40: 656e 6769 6e65 2e67 6574 5f69 6e73 7461  engine.get_insta
-0000df50: 6e63 6528 292e 7365 745f 6a6f 625f 6772  nce().set_job_gr
-0000df60: 6f75 7028 0a20 2020 2020 2020 2020 2020  oup(.           
-0000df70: 2022 4665 7463 6869 6e67 2046 6561 7475   "Fetching Featu
-0000df80: 7265 2067 726f 7570 222c 0a20 2020 2020  re group",.     
-0000df90: 2020 2020 2020 2022 4765 7474 696e 6720         "Getting 
-0000dfa0: 6665 6174 7572 6520 6772 6f75 703a 207b  feature group: {
-0000dfb0: 7d20 6672 6f6d 2074 6865 2066 6561 7475  } from the featu
-0000dfc0: 7265 7374 6f72 6520 7b7d 222e 666f 726d  restore {}".form
-0000dfd0: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-0000dfe0: 2020 2020 7365 6c66 2e5f 6e61 6d65 2c20      self._name, 
-0000dff0: 7365 6c66 2e5f 6665 6174 7572 655f 7374  self._feature_st
-0000e000: 6f72 655f 6e61 6d65 0a20 2020 2020 2020  ore_name.       
-0000e010: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0000e020: 290a 2020 2020 2020 2020 6966 2077 616c  ).        if wal
-0000e030: 6c63 6c6f 636b 5f74 696d 653a 0a20 2020  lclock_time:.   
-0000e040: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000e050: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000e060: 2020 7365 6c66 2e73 656c 6563 745f 616c    self.select_al
-0000e070: 6c28 290a 2020 2020 2020 2020 2020 2020  l().            
-0000e080: 2020 2020 2e61 735f 6f66 2877 616c 6c63      .as_of(wallc
-0000e090: 6c6f 636b 5f74 696d 6529 0a20 2020 2020  lock_time).     
-0000e0a0: 2020 2020 2020 2020 2020 202e 7265 6164             .read
-0000e0b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000e0c0: 2020 2020 2020 6f6e 6c69 6e65 2c0a 2020        online,.  
-0000e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0e0: 2020 6461 7461 6672 616d 655f 7479 7065    dataframe_type
-0000e0f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e100: 2020 2020 2020 7265 6164 5f6f 7074 696f        read_optio
-0000e110: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
-0000e120: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000e130: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
-0000e140: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0000e150: 7475 726e 2073 656c 662e 7365 6c65 6374  turn self.select
-0000e160: 5f61 6c6c 2829 2e72 6561 6428 0a20 2020  _all().read(.   
-0000e170: 2020 2020 2020 2020 2020 2020 206f 6e6c               onl
-0000e180: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
-0000e190: 2020 2020 2064 6174 6166 7261 6d65 5f74       dataframe_t
-0000e1a0: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
-0000e1b0: 2020 2020 2072 6561 645f 6f70 7469 6f6e       read_option
-0000e1c0: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-0000e1d0: 0a0a 2020 2020 6465 6620 7265 6164 5f63  ..    def read_c
-0000e1e0: 6861 6e67 6573 280a 2020 2020 2020 2020  hanges(.        
-0000e1f0: 7365 6c66 2c0a 2020 2020 2020 2020 7374  self,.        st
-0000e200: 6172 745f 7761 6c6c 636c 6f63 6b5f 7469  art_wallclock_ti
-0000e210: 6d65 3a20 556e 696f 6e5b 7374 722c 2069  me: Union[str, i
-0000e220: 6e74 2c20 6461 7465 7469 6d65 2c20 6461  nt, datetime, da
-0000e230: 7465 5d2c 0a20 2020 2020 2020 2065 6e64  te],.        end
-0000e240: 5f77 616c 6c63 6c6f 636b 5f74 696d 653a  _wallclock_time:
-0000e250: 2055 6e69 6f6e 5b73 7472 2c20 696e 742c   Union[str, int,
-0000e260: 2064 6174 6574 696d 652c 2064 6174 655d   datetime, date]
-0000e270: 2c0a 2020 2020 2020 2020 7265 6164 5f6f  ,.        read_o
-0000e280: 7074 696f 6e73 3a20 4f70 7469 6f6e 616c  ptions: Optional
-0000e290: 5b64 6963 745d 203d 207b 7d2c 0a20 2020  [dict] = {},.   
-0000e2a0: 2029 3a0a 2020 2020 2020 2020 2222 2252   ):.        """R
-0000e2b0: 6561 6473 2075 7064 6174 6573 206f 6620  eads updates of 
-0000e2c0: 7468 6973 2066 6561 7475 7265 2074 6861  this feature tha
-0000e2d0: 7420 6f63 6375 7272 6564 2062 6574 7765  t occurred betwe
-0000e2e0: 656e 2073 7065 6369 6669 6564 2070 6f69  en specified poi
-0000e2f0: 6e74 7320 696e 2074 696d 652e 0a0a 2020  nts in time...  
-0000e300: 2020 2020 2020 2121 2120 7761 726e 696e        !!! warnin
-0000e310: 6720 2244 6570 7265 6361 7465 6422 0a20  g "Deprecated". 
-0000e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e330: 2020 2060 7265 6164 5f63 6861 6e67 6573     `read_changes
-0000e340: 6020 6d65 7468 6f64 2069 7320 6465 7072  ` method is depr
-0000e350: 6563 6174 6564 2e20 5573 650a 2020 2020  ecated. Use.    
-0000e360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e370: 6061 735f 6f66 2865 6e64 5f77 616c 6c63  `as_of(end_wallc
-0000e380: 6c6f 636b 5f74 696d 652c 2065 7863 6c75  lock_time, exclu
-0000e390: 6465 5f75 6e74 696c 3d73 7461 7274 5f77  de_until=start_w
-0000e3a0: 616c 6c63 6c6f 636b 5f74 696d 6529 2e72  allclock_time).r
-0000e3b0: 6561 6428 7265 6164 5f6f 7074 696f 6e73  ead(read_options
-0000e3c0: 3d72 6561 645f 6f70 7469 6f6e 7329 600a  =read_options)`.
-0000e3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3e0: 2020 2020 696e 7374 6561 642e 0a0a 2020      instead...  
-0000e3f0: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
-0000e400: 696f 6e20 6f6e 6c79 2077 6f72 6b73 206f  ion only works o
-0000e410: 6e20 6665 6174 7572 6520 6772 6f75 7073  n feature groups
-0000e420: 2077 6974 6820 6048 5544 4960 2074 696d   with `HUDI` tim
-0000e430: 6520 7472 6176 656c 2066 6f72 6d61 742e  e travel format.
-0000e440: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-0000e450: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-0000e460: 2020 7374 6172 745f 7761 6c6c 636c 6f63    start_wallcloc
-0000e470: 6b5f 7469 6d65 3a20 5374 6172 7420 7469  k_time: Start ti
-0000e480: 6d65 206f 6620 7468 6520 7469 6d65 2074  me of the time t
-0000e490: 7261 7665 6c20 7175 6572 792e 2053 7472  ravel query. Str
-0000e4a0: 696e 6773 2073 686f 756c 6420 6265 2066  ings should be f
-0000e4b0: 6f72 6d61 7474 6564 2069 6e20 6f6e 6520  ormatted in one 
-0000e4c0: 6f66 2074 6865 2066 6f6c 6c6f 7769 6e67  of the following
-0000e4d0: 2066 6f72 6d61 7473 2060 2559 2d25 6d2d   formats `%Y-%m-
-0000e4e0: 2564 602c 2060 2559 2d25 6d2d 2564 2025  %d`, `%Y-%m-%d %
-0000e4f0: 4860 2c20 6025 592d 256d 2d25 6420 2548  H`, `%Y-%m-%d %H
-0000e500: 3a25 4d60 2c0a 2020 2020 2020 2020 2020  :%M`,.          
-0000e510: 2020 2020 2020 6025 592d 256d 2d25 6420        `%Y-%m-%d 
-0000e520: 2548 3a25 4d3a 2553 602c 206f 7220 6025  %H:%M:%S`, or `%
-0000e530: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-0000e540: 2e25 6660 2e0a 2020 2020 2020 2020 2020  .%f`..          
-0000e550: 2020 656e 645f 7761 6c6c 636c 6f63 6b5f    end_wallclock_
-0000e560: 7469 6d65 3a20 456e 6420 7469 6d65 206f  time: End time o
-0000e570: 6620 7468 6520 7469 6d65 2074 7261 7665  f the time trave
-0000e580: 6c20 7175 6572 792e 2053 7472 696e 6773  l query. Strings
-0000e590: 2073 686f 756c 6420 6265 2066 6f72 6d61   should be forma
-0000e5a0: 7474 6564 2069 6e20 6f6e 6520 6f66 2074  tted in one of t
-0000e5b0: 6865 2066 6f6c 6c6f 7769 6e67 2066 6f72  he following for
-0000e5c0: 6d61 7473 2060 2559 2d25 6d2d 2564 602c  mats `%Y-%m-%d`,
-0000e5d0: 2060 2559 2d25 6d2d 2564 2025 4860 2c20   `%Y-%m-%d %H`, 
-0000e5e0: 6025 592d 256d 2d25 6420 2548 3a25 4d60  `%Y-%m-%d %H:%M`
-0000e5f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000e600: 2020 6025 592d 256d 2d25 6420 2548 3a25    `%Y-%m-%d %H:%
-0000e610: 4d3a 2553 602c 206f 7220 6025 592d 256d  M:%S`, or `%Y-%m
-0000e620: 2d25 6420 2548 3a25 4d3a 2553 2e25 6660  -%d %H:%M:%S.%f`
-0000e630: 2e0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-0000e640: 6164 5f6f 7074 696f 6e73 3a20 4164 6469  ad_options: Addi
-0000e650: 7469 6f6e 616c 206f 7074 696f 6e73 2061  tional options a
-0000e660: 7320 6b65 792f 7661 6c75 6520 7061 6972  s key/value pair
-0000e670: 7320 746f 2070 6173 7320 746f 2074 6865  s to pass to the
-0000e680: 2065 7865 6375 7469 6f6e 2065 6e67 696e   execution engin
-0000e690: 652e 0a20 2020 2020 2020 2020 2020 2020  e..             
-0000e6a0: 2020 2046 6f72 2073 7061 726b 2065 6e67     For spark eng
-0000e6b0: 696e 653a 2044 6963 7469 6f6e 6172 7920  ine: Dictionary 
-0000e6c0: 6f66 2072 6561 6420 6f70 7469 6f6e 7320  of read options 
-0000e6d0: 666f 7220 5370 6172 6b2e 0a20 2020 2020  for Spark..     
-0000e6e0: 2020 2020 2020 2020 2020 2046 6f72 2070             For p
-0000e6f0: 7974 686f 6e20 656e 6769 6e65 3a0a 2020  ython engine:.  
-0000e700: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-0000e710: 6b65 7920 6022 6869 7665 5f63 6f6e 6669  key `"hive_confi
-0000e720: 6722 6020 746f 2070 6173 7320 6120 6469  g"` to pass a di
-0000e730: 6374 696f 6e61 7279 206f 6620 6869 7665  ctionary of hive
-0000e740: 206f 7220 7465 7a20 636f 6e66 6967 7572   or tez configur
-0000e750: 6174 696f 6e73 2e0a 2020 2020 2020 2020  ations..        
-0000e760: 2020 2020 2020 2020 2020 466f 7220 6578            For ex
-0000e770: 616d 706c 653a 2060 7b22 6869 7665 5f63  ample: `{"hive_c
-0000e780: 6f6e 6669 6722 3a20 7b22 6869 7665 2e74  onfig": {"hive.t
-0000e790: 657a 2e63 7075 2e76 636f 7265 7322 3a20  ez.cpu.vcores": 
-0000e7a0: 322c 2022 7465 7a2e 6772 6f75 7069 6e67  2, "tez.grouping
-0000e7b0: 2e73 706c 6974 2d63 6f75 6e74 223a 2022  .split-count": "
-0000e7c0: 3322 7d7d 600a 2020 2020 2020 2020 2020  3"}}`.          
-0000e7d0: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
-0000e7e0: 6f20 607b 7d60 2e0a 0a20 2020 2020 2020  o `{}`...       
-0000e7f0: 2023 2052 6574 7572 6e73 0a20 2020 2020   # Returns.     
-0000e800: 2020 2020 2020 2060 4461 7461 4672 616d         `DataFram
-0000e810: 6560 2e20 5468 6520 7370 6172 6b20 6461  e`. The spark da
-0000e820: 7461 6672 616d 6520 636f 6e74 6169 6e69  taframe containi
-0000e830: 6e67 2074 6865 2069 6e63 7265 6d65 6e74  ng the increment
-0000e840: 616c 2063 6861 6e67 6573 206f 660a 2020  al changes of.  
-0000e850: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-0000e860: 6520 6461 7461 2e0a 0a20 2020 2020 2020  e data...       
-0000e870: 2023 2052 6169 7365 730a 2020 2020 2020   # Raises.      
-0000e880: 2020 2020 2020 6068 7366 732e 636c 6965        `hsfs.clie
-0000e890: 6e74 2e65 7863 6570 7469 6f6e 732e 5265  nt.exceptions.Re
-0000e8a0: 7374 4150 4945 7272 6f72 602e 2020 4e6f  stAPIError`.  No
-0000e8b0: 2064 6174 6120 6973 2061 7661 696c 6162   data is availab
-0000e8c0: 6c65 2066 6f72 2066 6561 7475 7265 2067  le for feature g
-0000e8d0: 726f 7570 2077 6974 6820 7468 6973 2063  roup with this c
-0000e8e0: 6f6d 6d69 7420 6461 7465 2e0a 2020 2020  ommit date..    
-0000e8f0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-0000e900: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-0000e910: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
-0000e920: 7074 696f 6e60 2e20 4966 2074 6865 2066  ption`. If the f
-0000e930: 6561 7475 7265 2067 726f 7570 2064 6f65  eature group doe
-0000e940: 7320 6e6f 7420 6861 7665 2060 4855 4449  s not have `HUDI
-0000e950: 6020 7469 6d65 2074 7261 7665 6c20 666f  ` time travel fo
-0000e960: 726d 6174 0a20 2020 2020 2020 2022 2222  rmat.        """
-0000e970: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000e980: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0000e990: 6c66 2e73 656c 6563 745f 616c 6c28 290a  lf.select_all().
-0000e9a0: 2020 2020 2020 2020 2020 2020 2e70 756c              .pul
-0000e9b0: 6c5f 6368 616e 6765 7328 7374 6172 745f  l_changes(start_
-0000e9c0: 7761 6c6c 636c 6f63 6b5f 7469 6d65 2c20  wallclock_time, 
-0000e9d0: 656e 645f 7761 6c6c 636c 6f63 6b5f 7469  end_wallclock_ti
-0000e9e0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
-0000e9f0: 2e72 6561 6428 4661 6c73 652c 2022 6465  .read(False, "de
-0000ea00: 6661 756c 7422 2c20 7265 6164 5f6f 7074  fault", read_opt
-0000ea10: 696f 6e73 290a 2020 2020 2020 2020 290a  ions).        ).
-0000ea20: 0a20 2020 2064 6566 2073 686f 7728 7365  .    def show(se
-0000ea30: 6c66 2c20 6e3a 2069 6e74 2c20 6f6e 6c69  lf, n: int, onli
-0000ea40: 6e65 3a20 4f70 7469 6f6e 616c 5b62 6f6f  ne: Optional[boo
-0000ea50: 6c5d 203d 2046 616c 7365 293a 0a20 2020  l] = False):.   
-0000ea60: 2020 2020 2022 2222 5368 6f77 2074 6865       """Show the
-0000ea70: 2066 6972 7374 2060 6e60 2072 6f77 7320   first `n` rows 
-0000ea80: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-0000ea90: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
-0000eaa0: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
-0000eab0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-0000eac0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-0000ead0: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-0000eae0: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-0000eaf0: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-0000eb00: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0000eb10: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
-0000eb20: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
-0000eb30: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
-0000eb40: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
-0000eb50: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
-0000eb60: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
-0000eb70: 2023 206d 616b 6520 6120 7175 6572 7920   # make a query 
-0000eb80: 616e 6420 7368 6f77 2074 6f70 2035 2072  and show top 5 r
-0000eb90: 6f77 730a 2020 2020 2020 2020 2020 2020  ows.            
-0000eba0: 6667 2e73 656c 6563 7428 5b27 6461 7465  fg.select(['date
-0000ebb0: 272c 2777 6565 6b6c 795f 7361 6c65 7327  ','weekly_sales'
-0000ebc0: 2c27 6973 5f68 6f6c 6964 6179 275d 292e  ,'is_holiday']).
-0000ebd0: 7368 6f77 2835 290a 2020 2020 2020 2020  show(5).        
-0000ebe0: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-0000ebf0: 2023 2041 7267 756d 656e 7473 0a20 2020   # Arguments.   
-0000ec00: 2020 2020 2020 2020 206e 3a20 696e 742e           n: int.
-0000ec10: 204e 756d 6265 7220 6f66 2072 6f77 7320   Number of rows 
-0000ec20: 746f 2073 686f 772e 0a20 2020 2020 2020  to show..       
-0000ec30: 2020 2020 206f 6e6c 696e 653a 2062 6f6f       online: boo
-0000ec40: 6c2c 206f 7074 696f 6e61 6c2e 2049 6620  l, optional. If 
-0000ec50: 6054 7275 6560 2072 6561 6420 6672 6f6d  `True` read from
-0000ec60: 206f 6e6c 696e 6520 6665 6174 7572 6520   online feature 
-0000ec70: 7374 6f72 652c 2064 6566 6175 6c74 730a  store, defaults.
-0000ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec90: 746f 2060 4661 6c73 6560 2e0a 2020 2020  to `False`..    
-0000eca0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000ecb0: 656e 6769 6e65 2e67 6574 5f69 6e73 7461  engine.get_insta
-0000ecc0: 6e63 6528 292e 7365 745f 6a6f 625f 6772  nce().set_job_gr
-0000ecd0: 6f75 7028 0a20 2020 2020 2020 2020 2020  oup(.           
-0000ece0: 2022 4665 7463 6869 6e67 2046 6561 7475   "Fetching Featu
-0000ecf0: 7265 2067 726f 7570 222c 0a20 2020 2020  re group",.     
-0000ed00: 2020 2020 2020 2022 4765 7474 696e 6720         "Getting 
-0000ed10: 6665 6174 7572 6520 6772 6f75 703a 207b  feature group: {
-0000ed20: 7d20 6672 6f6d 2074 6865 2066 6561 7475  } from the featu
-0000ed30: 7265 7374 6f72 6520 7b7d 222e 666f 726d  restore {}".form
-0000ed40: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-0000ed50: 2020 2020 7365 6c66 2e5f 6e61 6d65 2c20      self._name, 
-0000ed60: 7365 6c66 2e5f 6665 6174 7572 655f 7374  self._feature_st
-0000ed70: 6f72 655f 6e61 6d65 0a20 2020 2020 2020  ore_name.       
-0000ed80: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
-0000ed90: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0000eda0: 2073 656c 662e 7365 6c65 6374 5f61 6c6c   self.select_all
-0000edb0: 2829 2e73 686f 7728 6e2c 206f 6e6c 696e  ().show(n, onlin
-0000edc0: 6529 0a0a 2020 2020 6465 6620 7361 7665  e)..    def save
-0000edd0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000ede0: 2020 2020 2020 2020 6665 6174 7572 6573          features
-0000edf0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
-0000ee00: 2020 2020 2070 642e 4461 7461 4672 616d       pd.DataFram
-0000ee10: 652c 0a20 2020 2020 2020 2020 2020 2054  e,.            T
-0000ee20: 7970 6556 6172 2822 7079 7370 6172 6b2e  ypeVar("pyspark.
-0000ee30: 7371 6c2e 4461 7461 4672 616d 6522 292c  sql.DataFrame"),
-0000ee40: 2020 2320 6e6f 7161 3a20 4638 3231 0a20    # noqa: F821. 
-0000ee50: 2020 2020 2020 2020 2020 2054 7970 6556             TypeV
-0000ee60: 6172 2822 7079 7370 6172 6b2e 5244 4422  ar("pyspark.RDD"
-0000ee70: 292c 2020 2320 6e6f 7161 3a20 4638 3231  ),  # noqa: F821
-0000ee80: 0a20 2020 2020 2020 2020 2020 206e 702e  .            np.
-0000ee90: 6e64 6172 7261 792c 0a20 2020 2020 2020  ndarray,.       
-0000eea0: 2020 2020 204c 6973 745b 6c69 7374 5d2c       List[list],
-0000eeb0: 0a20 2020 2020 2020 205d 2c0a 2020 2020  .        ],.    
-0000eec0: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
-0000eed0: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
-0000eee0: 5b41 6e79 2c20 416e 795d 5d20 3d20 7b7d  [Any, Any]] = {}
-0000eef0: 2c0a 2020 2020 2020 2020 7661 6c69 6461  ,.        valida
-0000ef00: 7469 6f6e 5f6f 7074 696f 6e73 3a20 4f70  tion_options: Op
-0000ef10: 7469 6f6e 616c 5b44 6963 745b 416e 792c  tional[Dict[Any,
-0000ef20: 2041 6e79 5d5d 203d 207b 7d2c 0a20 2020   Any]] = {},.   
-0000ef30: 2029 3a0a 2020 2020 2020 2020 2222 2250   ):.        """P
-0000ef40: 6572 7369 7374 2074 6865 206d 6574 6164  ersist the metad
-0000ef50: 6174 6120 616e 6420 6d61 7465 7269 616c  ata and material
-0000ef60: 697a 6520 7468 6520 6665 6174 7572 6520  ize the feature 
-0000ef70: 6772 6f75 7020 746f 2074 6865 2066 6561  group to the fea
-0000ef80: 7475 7265 2073 746f 7265 2e0a 0a20 2020  ture store...   
-0000ef90: 2020 2020 2021 2121 2077 6172 6e69 6e67       !!! warning
-0000efa0: 2022 4465 7072 6563 6174 6564 220a 2020   "Deprecated".  
-0000efb0: 2020 2020 2020 2020 2020 6073 6176 6560            `save`
-0000efc0: 206d 6574 686f 6420 6973 2064 6570 7265   method is depre
-0000efd0: 6361 7465 642e 2055 7365 2074 6865 2060  cated. Use the `
-0000efe0: 696e 7365 7274 6020 6d65 7468 6f64 2069  insert` method i
-0000eff0: 6e73 7465 6164 2e0a 0a20 2020 2020 2020  nstead...       
-0000f000: 2043 616c 6c69 6e67 2060 7361 7665 6020   Calling `save` 
-0000f010: 6372 6561 7465 7320 7468 6520 6d65 7461  creates the meta
-0000f020: 6461 7461 2066 6f72 2074 6865 2066 6561  data for the fea
-0000f030: 7475 7265 2067 726f 7570 2069 6e20 7468  ture group in th
-0000f040: 6520 6665 6174 7572 6520 7374 6f72 650a  e feature store.
-0000f050: 2020 2020 2020 2020 616e 6420 7772 6974          and writ
-0000f060: 6573 2074 6865 2073 7065 6369 6669 6564  es the specified
-0000f070: 2060 6665 6174 7572 6573 6020 6461 7461   `features` data
-0000f080: 6672 616d 6520 6173 2066 6561 7475 7265  frame as feature
-0000f090: 2067 726f 7570 2074 6f20 7468 650a 2020   group to the.  
-0000f0a0: 2020 2020 2020 6f6e 6c69 6e65 2f6f 6666        online/off
-0000f0b0: 6c69 6e65 2066 6561 7475 7265 2073 746f  line feature sto
-0000f0c0: 7265 2061 7320 7370 6563 6966 6965 642e  re as specified.
-0000f0d0: 0a20 2020 2020 2020 2042 7920 6465 6661  .        By defa
-0000f0e0: 756c 742c 2074 6869 7320 7772 6974 6573  ult, this writes
-0000f0f0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
-0000f100: 7570 2074 6f20 7468 6520 6f66 666c 696e  up to the offlin
-0000f110: 6520 7374 6f72 6167 652c 2061 6e64 2069  e storage, and i
-0000f120: 660a 2020 2020 2020 2020 606f 6e6c 696e  f.        `onlin
-0000f130: 655f 656e 6162 6c65 6460 2066 6f72 2074  e_enabled` for t
-0000f140: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-0000f150: 2c20 616c 736f 2074 6f20 7468 6520 6f6e  , also to the on
-0000f160: 6c69 6e65 2066 6561 7475 7265 2073 746f  line feature sto
-0000f170: 7265 2e0a 2020 2020 2020 2020 5468 6520  re..        The 
-0000f180: 6066 6561 7475 7265 7360 2064 6174 6166  `features` dataf
-0000f190: 7261 6d65 2063 616e 2062 6520 6120 5370  rame can be a Sp
-0000f1a0: 6172 6b20 4461 7461 4672 616d 6520 6f72  ark DataFrame or
-0000f1b0: 2052 4444 2c20 6120 5061 6e64 6173 2044   RDD, a Pandas D
-0000f1c0: 6174 6146 7261 6d65 2c0a 2020 2020 2020  ataFrame,.      
-0000f1d0: 2020 6f72 2061 2074 776f 2d64 696d 656e    or a two-dimen
-0000f1e0: 7369 6f6e 616c 204e 756d 7079 2061 7272  sional Numpy arr
-0000f1f0: 6179 206f 7220 6120 7477 6f2d 6469 6d65  ay or a two-dime
-0000f200: 6e73 696f 6e61 6c20 5079 7468 6f6e 206e  nsional Python n
-0000f210: 6573 7465 6420 6c69 7374 2e0a 2020 2020  ested list..    
-0000f220: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-0000f230: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-0000f240: 7572 6573 3a20 5175 6572 792c 2044 6174  ures: Query, Dat
-0000f250: 6146 7261 6d65 2c20 5244 442c 204e 6461  aFrame, RDD, Nda
-0000f260: 7272 6179 2c20 6c69 7374 2e20 4665 6174  rray, list. Feat
-0000f270: 7572 6573 2074 6f20 6265 2073 6176 6564  ures to be saved
-0000f280: 2e0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
-0000f290: 6974 655f 6f70 7469 6f6e 733a 2041 6464  ite_options: Add
-0000f2a0: 6974 696f 6e61 6c20 7772 6974 6520 6f70  itional write op
-0000f2b0: 7469 6f6e 7320 6173 206b 6579 2d76 616c  tions as key-val
-0000f2c0: 7565 2070 6169 7273 2c20 6465 6661 756c  ue pairs, defaul
-0000f2d0: 7473 2074 6f20 607b 7d60 2e0a 2020 2020  ts to `{}`..    
-0000f2e0: 2020 2020 2020 2020 2020 2020 5768 656e              When
-0000f2f0: 2075 7369 6e67 2074 6865 2060 7079 7468   using the `pyth
-0000f300: 6f6e 6020 656e 6769 6e65 2c20 7772 6974  on` engine, writ
-0000f310: 655f 6f70 7469 6f6e 7320 6361 6e20 636f  e_options can co
-0000f320: 6e74 6169 6e20 7468 650a 2020 2020 2020  ntain the.      
-0000f330: 2020 2020 2020 2020 2020 666f 6c6c 6f77            follow
-0000f340: 696e 6720 656e 7472 6965 733a 0a20 2020  ing entries:.   
-0000f350: 2020 2020 2020 2020 2020 2020 202a 206b               * k
-0000f360: 6579 2060 7370 6172 6b60 2061 6e64 2076  ey `spark` and v
-0000f370: 616c 7565 2061 6e20 6f62 6a65 6374 206f  alue an object o
-0000f380: 6620 7479 7065 0a20 2020 2020 2020 2020  f type.         
-0000f390: 2020 2020 2020 205b 6873 6673 2e63 6f72         [hsfs.cor
-0000f3a0: 652e 6a6f 625f 636f 6e66 6967 7572 6174  e.job_configurat
-0000f3b0: 696f 6e2e 4a6f 6243 6f6e 6669 6775 7261  ion.JobConfigura
-0000f3c0: 7469 6f6e 5d28 2e2e 2f6a 6f62 5f63 6f6e  tion](../job_con
-0000f3d0: 6669 6775 7261 7469 6f6e 290a 2020 2020  figuration).    
-0000f3e0: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0000f3f0: 2063 6f6e 6669 6775 7265 2074 6865 2048   configure the H
-0000f400: 6f70 7377 6f72 6b73 204a 6f62 2075 7365  opsworks Job use
-0000f410: 6420 746f 2077 7269 7465 2064 6174 6120  d to write data 
-0000f420: 696e 746f 2074 6865 0a20 2020 2020 2020  into the.       
-0000f430: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-0000f440: 7265 2067 726f 7570 2e0a 2020 2020 2020  re group..      
-0000f450: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
-0000f460: 6077 6169 745f 666f 725f 6a6f 6260 2061  `wait_for_job` a
-0000f470: 6e64 2076 616c 7565 2060 5472 7565 6020  nd value `True` 
-0000f480: 6f72 2060 4661 6c73 6560 2074 6f20 636f  or `False` to co
-0000f490: 6e66 6967 7572 650a 2020 2020 2020 2020  nfigure.        
-0000f4a0: 2020 2020 2020 2020 2020 7768 6574 6865            whethe
-0000f4b0: 7220 6f72 206e 6f74 2074 6f20 7468 6520  r or not to the 
-0000f4c0: 7361 7665 2063 616c 6c20 7368 6f75 6c64  save call should
-0000f4d0: 2072 6574 7572 6e20 6f6e 6c79 0a20 2020   return only.   
-0000f4e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000f4f0: 6674 6572 2074 6865 2048 6f70 7377 6f72  fter the Hopswor
-0000f500: 6b73 204a 6f62 2068 6173 2066 696e 6973  ks Job has finis
-0000f510: 6865 642e 2042 7920 6465 6661 756c 7420  hed. By default 
-0000f520: 6974 2077 6169 7473 2e0a 2020 2020 2020  it waits..      
-0000f530: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
-0000f540: 6073 7461 7274 5f6f 6666 6c69 6e65 5f62  `start_offline_b
-0000f550: 6163 6b66 696c 6c60 2061 6e64 2076 616c  ackfill` and val
-0000f560: 7565 2060 5472 7565 6020 6f72 2060 4661  ue `True` or `Fa
-0000f570: 6c73 6560 2074 6f20 636f 6e66 6967 7572  lse` to configur
-0000f580: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0000f590: 2020 2020 7768 6574 6865 7220 6f72 206e      whether or n
-0000f5a0: 6f74 2074 6f20 7374 6172 7420 7468 6520  ot to start the 
-0000f5b0: 6261 636b 6669 6c6c 206a 6f62 2074 6f20  backfill job to 
-0000f5c0: 7772 6974 6520 6461 7461 2074 6f20 7468  write data to th
-0000f5d0: 6520 6f66 666c 696e 650a 2020 2020 2020  e offline.      
-0000f5e0: 2020 2020 2020 2020 2020 2020 7374 6f72              stor
-0000f5f0: 6167 652e 2042 7920 6465 6661 756c 7420  age. By default 
-0000f600: 7468 6520 6261 636b 6669 6c6c 206a 6f62  the backfill job
-0000f610: 2067 6574 7320 7374 6172 7465 6420 696d   gets started im
-0000f620: 6d65 6469 6174 656c 792e 0a20 2020 2020  mediately..     
-0000f630: 2020 2020 2020 2020 2020 202a 206b 6579             * key
-0000f640: 2060 696e 7465 726e 616c 5f6b 6166 6b61   `internal_kafka
-0000f650: 6020 616e 6420 7661 6c75 6520 6054 7275  ` and value `Tru
-0000f660: 6560 206f 7220 6046 616c 7365 6020 696e  e` or `False` in
-0000f670: 2063 6173 6520 796f 7520 6573 7461 626c   case you establ
-0000f680: 6973 6865 640a 2020 2020 2020 2020 2020  ished.          
-0000f690: 2020 2020 2020 2020 636f 6e6e 6563 7469          connecti
-0000f6a0: 7669 7479 2066 726f 6d20 796f 7520 5079  vity from you Py
-0000f6b0: 7468 6f6e 2065 6e76 6972 6f6e 6d65 6e74  thon environment
-0000f6c0: 2074 6f20 7468 6520 696e 7465 726e 616c   to the internal
-0000f6d0: 2061 6476 6572 7469 7365 640a 2020 2020   advertised.    
-0000f6e0: 2020 2020 2020 2020 2020 2020 2020 6c69                li
-0000f6f0: 7374 656e 6572 7320 6f66 2074 6865 2048  steners of the H
-0000f700: 6f70 7377 6f72 6b73 204b 6166 6b61 2043  opsworks Kafka C
-0000f710: 6c75 7374 6572 2e20 4465 6661 756c 7473  luster. Defaults
-0000f720: 2074 6f20 6046 616c 7365 6020 616e 640a   to `False` and.
-0000f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f740: 2020 7769 6c6c 2075 7365 2065 7874 6572    will use exter
-0000f750: 6e61 6c20 6c69 7374 656e 6572 7320 7768  nal listeners wh
-0000f760: 656e 2063 6f6e 6e65 6374 696e 6720 6672  en connecting fr
-0000f770: 6f6d 206f 7574 7369 6465 206f 6620 486f  om outside of Ho
-0000f780: 7073 776f 726b 732e 0a20 2020 2020 2020  psworks..       
-0000f790: 2020 2020 2076 616c 6964 6174 696f 6e5f       validation_
-0000f7a0: 6f70 7469 6f6e 733a 2041 6464 6974 696f  options: Additio
-0000f7b0: 6e61 6c20 7661 6c69 6461 7469 6f6e 206f  nal validation o
-0000f7c0: 7074 696f 6e73 2061 7320 6b65 792d 7661  ptions as key-va
-0000f7d0: 6c75 6520 7061 6972 732c 2064 6566 6175  lue pairs, defau
-0000f7e0: 6c74 7320 746f 2060 7b7d 602e 0a20 2020  lts to `{}`..   
-0000f7f0: 2020 2020 2020 2020 2020 2020 202a 206b               * k
-0000f800: 6579 2060 7275 6e5f 7661 6c69 6461 7469  ey `run_validati
-0000f810: 6f6e 6020 626f 6f6c 6561 6e20 7661 6c75  on` boolean valu
-0000f820: 652c 2073 6574 2074 6f20 6046 616c 7365  e, set to `False
-0000f830: 6020 746f 2073 6b69 7020 7661 6c69 6461  ` to skip valida
-0000f840: 7469 6f6e 2074 656d 706f 7261 7269 6c79  tion temporarily
-0000f850: 206f 6e20 696e 6765 7374 696f 6e2e 0a20   on ingestion.. 
-0000f860: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0000f870: 206b 6579 2060 7361 7665 5f72 6570 6f72   key `save_repor
-0000f880: 7460 2062 6f6f 6c65 616e 2076 616c 7565  t` boolean value
-0000f890: 2c20 7365 7420 746f 2060 4661 6c73 6560  , set to `False`
-0000f8a0: 2074 6f20 736b 6970 2075 706c 6f61 6420   to skip upload 
-0000f8b0: 6f66 2074 6865 2076 616c 6964 6174 696f  of the validatio
-0000f8c0: 6e20 7265 706f 7274 2074 6f20 486f 7073  n report to Hops
-0000f8d0: 776f 726b 732e 0a20 2020 2020 2020 2020  works..         
-0000f8e0: 2020 2020 2020 202a 206b 6579 2060 6765         * key `ge
-0000f8f0: 5f76 616c 6964 6174 655f 6b77 6172 6773  _validate_kwargs
-0000f900: 6020 6120 6469 6374 696f 6e61 7279 2063  ` a dictionary c
-0000f910: 6f6e 7461 696e 696e 6720 6b77 6172 6773  ontaining kwargs
-0000f920: 2066 6f72 2074 6865 2076 616c 6964 6174   for the validat
-0000f930: 6520 6d65 7468 6f64 206f 6620 4772 6561  e method of Grea
-0000f940: 7420 4578 7065 6374 6174 696f 6e73 2e0a  t Expectations..
-0000f950: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-0000f960: 6e73 0a20 2020 2020 2020 2020 2020 2060  ns.            `
-0000f970: 4a6f 6260 3a20 5768 656e 2075 7369 6e67  Job`: When using
-0000f980: 2074 6865 2060 7079 7468 6f6e 6020 656e   the `python` en
-0000f990: 6769 6e65 2c20 6974 2072 6574 7572 6e73  gine, it returns
-0000f9a0: 2074 6865 2048 6f70 7377 6f72 6b73 204a   the Hopsworks J
-0000f9b0: 6f62 0a20 2020 2020 2020 2020 2020 2020  ob.             
-0000f9c0: 2020 2074 6861 7420 7761 7320 6c61 756e     that was laun
-0000f9d0: 6368 6564 2074 6f20 696e 6765 7374 2074  ched to ingest t
-0000f9e0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-0000f9f0: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
-0000fa00: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
-0000fa10: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
-0000fa20: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
-0000fa30: 7441 5049 4572 726f 7260 2e20 556e 6162  tAPIError`. Unab
-0000fa40: 6c65 2074 6f20 6372 6561 7465 2066 6561  le to create fea
-0000fa50: 7475 7265 2067 726f 7570 2e0a 2020 2020  ture group..    
-0000fa60: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000fa70: 6665 6174 7572 655f 6461 7461 6672 616d  feature_datafram
-0000fa80: 6520 3d20 656e 6769 6e65 2e67 6574 5f69  e = engine.get_i
-0000fa90: 6e73 7461 6e63 6528 292e 636f 6e76 6572  nstance().conver
-0000faa0: 745f 746f 5f64 6566 6175 6c74 5f64 6174  t_to_default_dat
-0000fab0: 6166 7261 6d65 2866 6561 7475 7265 7329  aframe(features)
-0000fac0: 0a0a 2020 2020 2020 2020 7573 6572 5f76  ..        user_v
-0000fad0: 6572 7369 6f6e 203d 2073 656c 662e 5f76  ersion = self._v
-0000fae0: 6572 7369 6f6e 0a0a 2020 2020 2020 2020  ersion..        
-0000faf0: 2320 6667 5f6a 6f62 2069 7320 7573 6564  # fg_job is used
-0000fb00: 206f 6e6c 7920 6966 2074 6865 2070 7974   only if the pyt
-0000fb10: 686f 6e20 656e 6769 6e65 2069 7320 7573  hon engine is us
-0000fb20: 6564 0a20 2020 2020 2020 2066 675f 6a6f  ed.        fg_jo
-0000fb30: 622c 2067 655f 7265 706f 7274 203d 2073  b, ge_report = s
-0000fb40: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
-0000fb50: 7570 5f65 6e67 696e 652e 7361 7665 280a  up_engine.save(.
-0000fb60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000fb70: 2c20 6665 6174 7572 655f 6461 7461 6672  , feature_datafr
-0000fb80: 616d 652c 2077 7269 7465 5f6f 7074 696f  ame, write_optio
-0000fb90: 6e73 2c20 7661 6c69 6461 7469 6f6e 5f6f  ns, validation_o
-0000fba0: 7074 696f 6e73 0a20 2020 2020 2020 2029  ptions.        )
-0000fbb0: 0a20 2020 2020 2020 2069 6620 6765 5f72  .        if ge_r
-0000fbc0: 6570 6f72 7420 6973 204e 6f6e 6520 6f72  eport is None or
-0000fbd0: 2067 655f 7265 706f 7274 2e69 6e67 6573   ge_report.inges
-0000fbe0: 7469 6f6e 5f72 6573 756c 7420 3d3d 2022  tion_result == "
-0000fbf0: 494e 4745 5354 4544 223a 0a20 2020 2020  INGESTED":.     
-0000fc00: 2020 2020 2020 2073 656c 662e 5f63 6f64         self._cod
-0000fc10: 655f 656e 6769 6e65 2e73 6176 655f 636f  e_engine.save_co
-0000fc20: 6465 2873 656c 6629 0a0a 2020 2020 2020  de(self)..      
-0000fc30: 2020 6966 2073 656c 662e 7374 6174 6973    if self.statis
-0000fc40: 7469 6373 5f63 6f6e 6669 672e 656e 6162  tics_config.enab
-0000fc50: 6c65 6420 616e 6420 656e 6769 6e65 2e67  led and engine.g
-0000fc60: 6574 5f74 7970 6528 2920 3d3d 2022 7370  et_type() == "sp
-0000fc70: 6172 6b22 3a0a 2020 2020 2020 2020 2020  ark":.          
-0000fc80: 2020 2320 4f6e 6c79 2063 6f6d 7075 7465    # Only compute
-0000fc90: 2073 7461 7469 7374 6963 7320 6966 2074   statistics if t
-0000fca0: 6865 2065 6e67 696e 6520 6973 2053 7061  he engine is Spa
-0000fcb0: 726b 2e0a 2020 2020 2020 2020 2020 2020  rk..            
-0000fcc0: 2320 466f 7220 5079 7468 6f6e 2065 6e67  # For Python eng
-0000fcd0: 696e 652c 2074 6865 2063 6f6d 7075 7461  ine, the computa
-0000fce0: 7469 6f6e 2068 6170 7065 6e73 2069 6e20  tion happens in 
-0000fcf0: 7468 6520 486f 7073 776f 726b 7320 6170  the Hopsworks ap
-0000fd00: 706c 6963 6174 696f 6e0a 2020 2020 2020  plication.      
-0000fd10: 2020 2020 2020 7365 6c66 2e5f 7374 6174        self._stat
-0000fd20: 6973 7469 6373 5f65 6e67 696e 652e 636f  istics_engine.co
-0000fd30: 6d70 7574 655f 7374 6174 6973 7469 6373  mpute_statistics
-0000fd40: 2873 656c 662c 2066 6561 7475 7265 5f64  (self, feature_d
-0000fd50: 6174 6166 7261 6d65 290a 2020 2020 2020  ataframe).      
-0000fd60: 2020 6966 2075 7365 725f 7665 7273 696f    if user_versio
-0000fd70: 6e20 6973 204e 6f6e 653a 0a20 2020 2020  n is None:.     
-0000fd80: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-0000fd90: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-0000fda0: 2020 2020 2020 224e 6f20 7665 7273 696f        "No versio
-0000fdb0: 6e20 7072 6f76 6964 6564 2066 6f72 2063  n provided for c
-0000fdc0: 7265 6174 696e 6720 6665 6174 7572 6520  reating feature 
-0000fdd0: 6772 6f75 7020 607b 7d60 2c20 696e 6372  group `{}`, incr
-0000fde0: 656d 656e 7465 6420 7665 7273 696f 6e20  emented version 
-0000fdf0: 746f 2060 7b7d 602e 222e 666f 726d 6174  to `{}`.".format
-0000fe00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000fe10: 2020 2020 2020 7365 6c66 2e5f 6e61 6d65        self._name
-0000fe20: 2c20 7365 6c66 2e5f 7665 7273 696f 6e0a  , self._version.
-0000fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fe40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000fe50: 2020 2075 7469 6c2e 5665 7273 696f 6e57     util.VersionW
-0000fe60: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-0000fe70: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000fe80: 7475 726e 2028 0a20 2020 2020 2020 2020  turn (.         
-0000fe90: 2020 2066 675f 6a6f 622c 0a20 2020 2020     fg_job,.     
-0000fea0: 2020 2020 2020 2067 655f 7265 706f 7274         ge_report
-0000feb0: 2e74 6f5f 6765 5f74 7970 6528 2920 6966  .to_ge_type() if
-0000fec0: 2067 655f 7265 706f 7274 2069 7320 6e6f   ge_report is no
-0000fed0: 7420 4e6f 6e65 2065 6c73 6520 4e6f 6e65  t None else None
-0000fee0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0000fef0: 2064 6566 2069 6e73 6572 7428 0a20 2020   def insert(.   
-0000ff00: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000ff10: 2020 2066 6561 7475 7265 733a 2055 6e69     features: Uni
-0000ff20: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
-0000ff30: 7064 2e44 6174 6146 7261 6d65 2c0a 2020  pd.DataFrame,.  
-0000ff40: 2020 2020 2020 2020 2020 5479 7065 5661            TypeVa
-0000ff50: 7228 2270 7973 7061 726b 2e73 716c 2e44  r("pyspark.sql.D
-0000ff60: 6174 6146 7261 6d65 2229 2c20 2023 206e  ataFrame"),  # n
-0000ff70: 6f71 613a 2046 3832 310a 2020 2020 2020  oqa: F821.      
-0000ff80: 2020 2020 2020 5479 7065 5661 7228 2270        TypeVar("p
-0000ff90: 7973 7061 726b 2e52 4444 2229 2c20 2023  yspark.RDD"),  #
-0000ffa0: 206e 6f71 613a 2046 3832 310a 2020 2020   noqa: F821.    
-0000ffb0: 2020 2020 2020 2020 6e70 2e6e 6461 7272          np.ndarr
-0000ffc0: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-0000ffd0: 4c69 7374 5b6c 6973 745d 2c0a 2020 2020  List[list],.    
-0000ffe0: 2020 2020 5d2c 0a20 2020 2020 2020 206f      ],.        o
-0000fff0: 7665 7277 7269 7465 3a20 4f70 7469 6f6e  verwrite: Option
-00010000: 616c 5b62 6f6f 6c5d 203d 2046 616c 7365  al[bool] = False
-00010010: 2c0a 2020 2020 2020 2020 6f70 6572 6174  ,.        operat
-00010020: 696f 6e3a 204f 7074 696f 6e61 6c5b 7374  ion: Optional[st
-00010030: 725d 203d 2022 7570 7365 7274 222c 0a20  r] = "upsert",. 
-00010040: 2020 2020 2020 2073 746f 7261 6765 3a20         storage: 
-00010050: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-00010060: 4e6f 6e65 2c0a 2020 2020 2020 2020 7772  None,.        wr
-00010070: 6974 655f 6f70 7469 6f6e 733a 204f 7074  ite_options: Opt
-00010080: 696f 6e61 6c5b 4469 6374 5b73 7472 2c20  ional[Dict[str, 
-00010090: 416e 795d 5d20 3d20 7b7d 2c0a 2020 2020  Any]] = {},.    
-000100a0: 2020 2020 7661 6c69 6461 7469 6f6e 5f6f      validation_o
-000100b0: 7074 696f 6e73 3a20 4f70 7469 6f6e 616c  ptions: Optional
-000100c0: 5b44 6963 745b 7374 722c 2041 6e79 5d5d  [Dict[str, Any]]
-000100d0: 203d 207b 7d2c 0a20 2020 2020 2020 2073   = {},.        s
-000100e0: 6176 655f 636f 6465 3a20 4f70 7469 6f6e  ave_code: Option
-000100f0: 616c 5b62 6f6f 6c5d 203d 2054 7275 652c  al[bool] = True,
-00010100: 0a20 2020 2029 202d 3e20 5475 706c 655b  .    ) -> Tuple[
-00010110: 4f70 7469 6f6e 616c 5b4a 6f62 5d2c 204f  Optional[Job], O
-00010120: 7074 696f 6e61 6c5b 5661 6c69 6461 7469  ptional[Validati
-00010130: 6f6e 5265 706f 7274 5d5d 3a0a 2020 2020  onReport]]:.    
-00010140: 2020 2020 2222 2250 6572 7369 7374 2074      """Persist t
-00010150: 6865 206d 6574 6164 6174 6120 616e 6420  he metadata and 
-00010160: 6d61 7465 7269 616c 697a 6520 7468 6520  materialize the 
-00010170: 6665 6174 7572 6520 6772 6f75 7020 746f  feature group to
-00010180: 2074 6865 2066 6561 7475 7265 2073 746f   the feature sto
-00010190: 7265 0a20 2020 2020 2020 206f 7220 696e  re.        or in
-000101a0: 7365 7274 2064 6174 6120 6672 6f6d 2061  sert data from a
-000101b0: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
-000101c0: 7468 6520 6578 6973 7469 6e67 2066 6561  the existing fea
-000101d0: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
-000101e0: 2020 2020 2049 6e63 7265 6d65 6e74 616c       Incremental
-000101f0: 6c79 2069 6e73 6572 7420 6461 7461 2074  ly insert data t
-00010200: 6f20 6120 6665 6174 7572 6520 6772 6f75  o a feature grou
-00010210: 7020 6f72 206f 7665 7277 7269 7465 2061  p or overwrite a
-00010220: 6c6c 2020 6461 7461 2063 6f6e 7461 696e  ll  data contain
-00010230: 6564 2069 6e20 7468 6520 6665 6174 7572  ed in the featur
-00010240: 6520 6772 6f75 702e 2042 790a 2020 2020  e group. By.    
-00010250: 2020 2020 6465 6661 756c 742c 2074 6865      default, the
-00010260: 2064 6174 6120 6973 2069 6e73 6572 7465   data is inserte
-00010270: 6420 696e 746f 2074 6865 206f 6666 6c69  d into the offli
-00010280: 6e65 2073 746f 7261 6765 2061 7320 7765  ne storage as we
-00010290: 6c6c 2061 7320 7468 6520 6f6e 6c69 6e65  ll as the online
-000102a0: 2073 746f 7261 6765 2069 6620 7468 6520   storage if the 
-000102b0: 6665 6174 7572 6520 6772 6f75 7020 6973  feature group is
-000102c0: 0a20 2020 2020 2020 2060 6f6e 6c69 6e65  .        `online
-000102d0: 5f65 6e61 626c 6564 3d54 7275 6560 2e20  _enabled=True`. 
-000102e0: 546f 2069 6e73 6572 7420 6f6e 6c79 2069  To insert only i
-000102f0: 6e74 6f20 7468 6520 6f6e 6c69 6e65 206f  nto the online o
-00010300: 7220 6f66 666c 696e 6520 7374 6f72 6167  r offline storag
-00010310: 6520 7365 7420 6073 746f 7261 6765 3d22  e set `storage="
-00010320: 6f6e 6c69 6e65 2260 206f 720a 2020 2020  online"` or.    
-00010330: 2020 2020 6073 746f 7261 6765 3d22 6f66      `storage="of
-00010340: 666c 696e 6522 6020 7265 7370 6563 7469  fline"` respecti
-00010350: 7665 6c79 2e0a 0a20 2020 2020 2020 2054  vely...        T
-00010360: 6865 2060 6665 6174 7572 6573 6020 6461  he `features` da
-00010370: 7461 6672 616d 6520 6361 6e20 6265 2061  taframe can be a
-00010380: 2053 7061 726b 2044 6174 6146 7261 6d65   Spark DataFrame
-00010390: 206f 7220 5244 442c 2061 2050 616e 6461   or RDD, a Panda
-000103a0: 7320 4461 7461 4672 616d 652c 0a20 2020  s DataFrame,.   
-000103b0: 2020 2020 206f 7220 6120 7477 6f2d 6469       or a two-di
-000103c0: 6d65 6e73 696f 6e61 6c20 4e75 6d70 7920  mensional Numpy 
-000103d0: 6172 7261 7920 6f72 2061 2074 776f 2d64  array or a two-d
-000103e0: 696d 656e 7369 6f6e 616c 2050 7974 686f  imensional Pytho
-000103f0: 6e20 6e65 7374 6564 206c 6973 742e 0a20  n nested list.. 
-00010400: 2020 2020 2020 2049 6620 7374 6174 6973         If statis
-00010410: 7469 6373 2061 7265 2065 6e61 626c 6564  tics are enabled
-00010420: 2c20 7374 6174 6973 7469 6373 2061 7265  , statistics are
-00010430: 2072 6563 6f6d 7075 7465 6420 666f 7220   recomputed for 
-00010440: 7468 6520 656e 7469 7265 2066 6561 7475  the entire featu
-00010450: 7265 0a20 2020 2020 2020 2067 726f 7570  re.        group
-00010460: 2e0a 2020 2020 2020 2020 4966 2066 6561  ..        If fea
-00010470: 7475 7265 2067 726f 7570 2773 2074 696d  ture group's tim
-00010480: 6520 7472 6176 656c 2066 6f72 6d61 7420  e travel format 
-00010490: 6973 2060 4855 4449 6020 7468 656e 2060  is `HUDI` then `
-000104a0: 6f70 6572 6174 696f 6e60 2061 7267 756d  operation` argum
-000104b0: 656e 7420 6361 6e20 6265 0a20 2020 2020  ent can be.     
-000104c0: 2020 2065 6974 6865 7220 6069 6e73 6572     either `inser
-000104d0: 7460 206f 7220 6075 7073 6572 7460 2e0a  t` or `upsert`..
-000104e0: 0a20 2020 2020 2020 2049 6620 6665 6174  .        If feat
-000104f0: 7572 6520 6772 6f75 7020 646f 6573 6e27  ure group doesn'
-00010500: 7420 6578 6973 7473 2020 7468 6520 696e  t exists  the in
-00010510: 7365 7274 206d 6574 686f 6420 7769 6c6c  sert method will
-00010520: 2063 7265 6174 6520 7468 6520 6e65 6365   create the nece
-00010530: 7373 6172 7920 6d65 7461 6461 7461 2074  ssary metadata t
-00010540: 6865 2066 6972 7374 2074 696d 6520 6974  he first time it
-00010550: 2069 730a 2020 2020 2020 2020 696e 766f   is.        invo
-00010560: 6b65 6420 616e 6420 7772 6974 6573 2074  ked and writes t
-00010570: 6865 2073 7065 6369 6669 6564 2060 6665  he specified `fe
-00010580: 6174 7572 6573 6020 6461 7461 6672 616d  atures` datafram
-00010590: 6520 6173 2066 6561 7475 7265 2067 726f  e as feature gro
-000105a0: 7570 2074 6f20 7468 6520 6f6e 6c69 6e65  up to the online
-000105b0: 2f6f 6666 6c69 6e65 2066 6561 7475 7265  /offline feature
-000105c0: 2073 746f 7265 2e0a 0a20 2020 2020 2020   store...       
-000105d0: 2021 2121 2065 7861 6d70 6c65 2022 5570   !!! example "Up
-000105e0: 7365 7274 206e 6577 2066 6561 7475 7265  sert new feature
-000105f0: 2064 6174 6120 7769 7468 2074 696d 6520   data with time 
-00010600: 7472 6176 656c 2066 6f72 6d61 7420 6048  travel format `H
-00010610: 5544 4960 220a 2020 2020 2020 2020 2020  UDI`".          
-00010620: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-00010630: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-00010640: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-00010650: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-00010660: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-00010670: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
-00010680: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
-00010690: 6561 7475 7265 5f67 726f 7570 280a 2020  eature_group(.  
-000106a0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-000106b0: 6d65 3d27 6269 7463 6f69 6e5f 7072 6963  me='bitcoin_pric
-000106c0: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-000106d0: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
-000106e0: 2742 6974 636f 696e 2070 7269 6365 2061  'Bitcoin price a
-000106f0: 6767 7265 6761 7465 6420 666f 7220 6461  ggregated for da
-00010700: 7973 272c 0a20 2020 2020 2020 2020 2020  ys',.           
-00010710: 2020 2020 2076 6572 7369 6f6e 3d31 2c0a       version=1,.
-00010720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010730: 7072 696d 6172 795f 6b65 793d 5b27 756e  primary_key=['un
-00010740: 6978 275d 2c0a 2020 2020 2020 2020 2020  ix'],.          
-00010750: 2020 2020 2020 6f6e 6c69 6e65 5f65 6e61        online_ena
-00010760: 626c 6564 3d54 7275 652c 0a20 2020 2020  bled=True,.     
-00010770: 2020 2020 2020 2020 2020 2065 7665 6e74             event
-00010780: 5f74 696d 653d 2775 6e69 7827 0a20 2020  _time='unix'.   
-00010790: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000107a0: 2020 2020 2020 2020 6667 2e69 6e73 6572          fg.inser
-000107b0: 7428 6466 5f62 6974 636f 696e 5f70 726f  t(df_bitcoin_pro
-000107c0: 6365 7373 6564 290a 2020 2020 2020 2020  cessed).        
-000107d0: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-000107e0: 2021 2121 2065 7861 6d70 6c65 2022 4173   !!! example "As
-000107f0: 796e 6320 696e 7365 7274 220a 2020 2020  ync insert".    
-00010800: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-00010810: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
-00010820: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
-00010830: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
-00010840: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
-00010850: 2e0a 0a20 2020 2020 2020 2020 2020 2066  ...            f
-00010860: 6731 203d 2066 732e 6765 745f 6f72 5f63  g1 = fs.get_or_c
-00010870: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
-00010880: 6f75 7028 0a20 2020 2020 2020 2020 2020  oup(.           
-00010890: 2020 2020 206e 616d 653d 2766 6561 7475       name='featu
-000108a0: 7265 5f67 726f 7570 5f6e 616d 6531 272c  re_group_name1',
-000108b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000108c0: 2064 6573 6372 6970 7469 6f6e 3d27 4465   description='De
-000108d0: 7363 7269 7074 696f 6e20 6f66 2074 6865  scription of the
-000108e0: 2066 6972 7374 2046 4727 2c0a 2020 2020   first FG',.    
-000108f0: 2020 2020 2020 2020 2020 2020 7665 7273              vers
-00010900: 696f 6e3d 312c 0a20 2020 2020 2020 2020  ion=1,.         
-00010910: 2020 2020 2020 2070 7269 6d61 7279 5f6b         primary_k
-00010920: 6579 3d5b 2775 6e69 7827 5d2c 0a20 2020  ey=['unix'],.   
-00010930: 2020 2020 2020 2020 2020 2020 206f 6e6c               onl
-00010940: 696e 655f 656e 6162 6c65 643d 5472 7565  ine_enabled=True
-00010950: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010960: 2020 6576 656e 745f 7469 6d65 3d27 756e    event_time='un
-00010970: 6978 270a 2020 2020 2020 2020 2020 2020  ix'.            
-00010980: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-00010990: 6173 796e 6320 696e 7365 7274 696f 6e20  async insertion 
-000109a0: 696e 206f 7264 6572 206e 6f74 2074 6f20  in order not to 
-000109b0: 7761 6974 2074 696c 6c20 6669 6e69 7368  wait till finish
-000109c0: 206f 6620 7468 6520 6a6f 620a 2020 2020   of the job.    
-000109d0: 2020 2020 2020 2020 6667 2e69 6e73 6572          fg.inser
-000109e0: 7428 6466 5f66 6f72 5f66 6731 2c20 7772  t(df_for_fg1, wr
-000109f0: 6974 655f 6f70 7469 6f6e 733d 7b22 7761  ite_options={"wa
-00010a00: 6974 5f66 6f72 5f6a 6f62 2220 3a20 4661  it_for_job" : Fa
-00010a10: 6c73 657d 290a 0a20 2020 2020 2020 2020  lse})..         
-00010a20: 2020 2066 6732 203d 2066 732e 6765 745f     fg2 = fs.get_
-00010a30: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
-00010a40: 655f 6772 6f75 7028 0a20 2020 2020 2020  e_group(.       
-00010a50: 2020 2020 2020 2020 206e 616d 653d 2766           name='f
-00010a60: 6561 7475 7265 5f67 726f 7570 5f6e 616d  eature_group_nam
-00010a70: 6532 272c 0a20 2020 2020 2020 2020 2020  e2',.           
-00010a80: 2020 2020 2064 6573 6372 6970 7469 6f6e       description
-00010a90: 3d27 4465 7363 7269 7074 696f 6e20 6f66  ='Description of
-00010aa0: 2074 6865 2073 6563 6f6e 6420 4647 272c   the second FG',
-00010ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010ac0: 2076 6572 7369 6f6e 3d31 2c0a 2020 2020   version=1,.    
-00010ad0: 2020 2020 2020 2020 2020 2020 7072 696d              prim
-00010ae0: 6172 795f 6b65 793d 5b27 756e 6978 275d  ary_key=['unix']
-00010af0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010b00: 2020 6f6e 6c69 6e65 5f65 6e61 626c 6564    online_enabled
-00010b10: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
-00010b20: 2020 2020 2020 2065 7665 6e74 5f74 696d         event_tim
-00010b30: 653d 2775 6e69 7827 0a20 2020 2020 2020  e='unix'.       
-00010b40: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00010b50: 2020 2066 672e 696e 7365 7274 2864 665f     fg.insert(df_
-00010b60: 666f 725f 6667 3229 0a20 2020 2020 2020  for_fg2).       
-00010b70: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-00010b80: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-00010b90: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00010ba0: 6573 3a20 4461 7461 4672 616d 652c 2052  es: DataFrame, R
-00010bb0: 4444 2c20 4e64 6172 7261 792c 206c 6973  DD, Ndarray, lis
-00010bc0: 742e 2046 6561 7475 7265 7320 746f 2062  t. Features to b
-00010bd0: 6520 7361 7665 642e 0a20 2020 2020 2020  e saved..       
-00010be0: 2020 2020 206f 7665 7277 7269 7465 3a20       overwrite: 
-00010bf0: 4472 6f70 2061 6c6c 2064 6174 6120 696e  Drop all data in
-00010c00: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
-00010c10: 7570 2062 6566 6f72 650a 2020 2020 2020  up before.      
-00010c20: 2020 2020 2020 2020 2020 696e 7365 7274            insert
-00010c30: 696e 6720 6e65 7720 6461 7461 2e20 5468  ing new data. Th
-00010c40: 6973 2064 6f65 7320 6e6f 7420 6166 6665  is does not affe
-00010c50: 6374 206d 6574 6164 6174 612c 2064 6566  ct metadata, def
-00010c60: 6175 6c74 7320 746f 2046 616c 7365 2e0a  aults to False..
-00010c70: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-00010c80: 6174 696f 6e3a 2041 7061 6368 6520 4875  ation: Apache Hu
-00010c90: 6469 206f 7065 7261 7469 6f6e 2074 7970  di operation typ
-00010ca0: 6520 6022 696e 7365 7274 2260 206f 7220  e `"insert"` or 
-00010cb0: 6022 7570 7365 7274 2260 2e0a 2020 2020  `"upsert"`..    
-00010cc0: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-00010cd0: 756c 7473 2074 6f20 6022 7570 7365 7274  ults to `"upsert
-00010ce0: 2260 2e0a 2020 2020 2020 2020 2020 2020  "`..            
-00010cf0: 7374 6f72 6167 653a 204f 7665 7277 7269  storage: Overwri
-00010d00: 7465 2064 6566 6175 6c74 2062 6568 6176  te default behav
-00010d10: 696f 7572 2c20 7772 6974 6520 746f 206f  iour, write to o
-00010d20: 6666 6c69 6e65 0a20 2020 2020 2020 2020  ffline.         
-00010d30: 2020 2020 2020 2073 746f 7261 6765 206f         storage o
-00010d40: 6e6c 7920 7769 7468 2060 226f 6666 6c69  nly with `"offli
-00010d50: 6e65 2260 206f 7220 6f6e 6c69 6e65 206f  ne"` or online o
-00010d60: 6e6c 7920 7769 7468 2060 226f 6e6c 696e  nly with `"onlin
-00010d70: 6522 602c 2064 6566 6175 6c74 730a 2020  e"`, defaults.  
-00010d80: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00010d90: 2060 4e6f 6e65 602e 0a20 2020 2020 2020   `None`..       
-00010da0: 2020 2020 2077 7269 7465 5f6f 7074 696f       write_optio
-00010db0: 6e73 3a20 4164 6469 7469 6f6e 616c 2077  ns: Additional w
-00010dc0: 7269 7465 206f 7074 696f 6e73 2061 7320  rite options as 
-00010dd0: 6b65 792d 7661 6c75 6520 7061 6972 732c  key-value pairs,
-00010de0: 2064 6566 6175 6c74 7320 746f 2060 7b7d   defaults to `{}
-00010df0: 602e 0a20 2020 2020 2020 2020 2020 2020  `..             
-00010e00: 2020 2057 6865 6e20 7573 696e 6720 7468     When using th
-00010e10: 6520 6070 7974 686f 6e60 2065 6e67 696e  e `python` engin
-00010e20: 652c 2077 7269 7465 5f6f 7074 696f 6e73  e, write_options
-00010e30: 2063 616e 2063 6f6e 7461 696e 2074 6865   can contain the
-00010e40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010e50: 2066 6f6c 6c6f 7769 6e67 2065 6e74 7269   following entri
-00010e60: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00010e70: 2020 2020 2a20 6b65 7920 6073 7061 726b      * key `spark
-00010e80: 6020 616e 6420 7661 6c75 6520 616e 206f  ` and value an o
-00010e90: 626a 6563 7420 6f66 2074 7970 650a 2020  bject of type.  
-00010ea0: 2020 2020 2020 2020 2020 2020 2020 5b68                [h
-00010eb0: 7366 732e 636f 7265 2e6a 6f62 5f63 6f6e  sfs.core.job_con
-00010ec0: 6669 6775 7261 7469 6f6e 2e4a 6f62 436f  figuration.JobCo
-00010ed0: 6e66 6967 7572 6174 696f 6e5d 282e 2e2f  nfiguration](../
-00010ee0: 6a6f 625f 636f 6e66 6967 7572 6174 696f  job_configuratio
-00010ef0: 6e29 0a20 2020 2020 2020 2020 2020 2020  n).             
-00010f00: 2020 2020 2074 6f20 636f 6e66 6967 7572       to configur
-00010f10: 6520 7468 6520 486f 7073 776f 726b 7320  e the Hopsworks 
-00010f20: 4a6f 6220 7573 6564 2074 6f20 7772 6974  Job used to writ
-00010f30: 6520 6461 7461 2069 6e74 6f20 7468 650a  e data into the.
-00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f50: 2020 6665 6174 7572 6520 6772 6f75 702e    feature group.
-00010f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010f70: 202a 206b 6579 2060 7761 6974 5f66 6f72   * key `wait_for
-00010f80: 5f6a 6f62 6020 616e 6420 7661 6c75 6520  _job` and value 
-00010f90: 6054 7275 6560 206f 7220 6046 616c 7365  `True` or `False
-00010fa0: 6020 746f 2063 6f6e 6669 6775 7265 0a20  ` to configure. 
-00010fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010fc0: 2077 6865 7468 6572 206f 7220 6e6f 7420   whether or not 
-00010fd0: 746f 2074 6865 2069 6e73 6572 7420 6361  to the insert ca
-00010fe0: 6c6c 2073 686f 756c 6420 7265 7475 726e  ll should return
-00010ff0: 206f 6e6c 790a 2020 2020 2020 2020 2020   only.          
-00011000: 2020 2020 2020 2020 6166 7465 7220 7468          after th
-00011010: 6520 486f 7073 776f 726b 7320 4a6f 6220  e Hopsworks Job 
-00011020: 6861 7320 6669 6e69 7368 6564 2e20 4279  has finished. By
-00011030: 2064 6566 6175 6c74 2069 7420 7761 6974   default it wait
-00011040: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-00011050: 2020 202a 206b 6579 2060 7374 6172 745f     * key `start_
-00011060: 6f66 666c 696e 655f 6261 636b 6669 6c6c  offline_backfill
-00011070: 6020 616e 6420 7661 6c75 6520 6054 7275  ` and value `Tru
-00011080: 6560 206f 7220 6046 616c 7365 6020 746f  e` or `False` to
-00011090: 2063 6f6e 6669 6775 7265 0a20 2020 2020   configure.     
-000110a0: 2020 2020 2020 2020 2020 2020 2077 6865               whe
-000110b0: 7468 6572 206f 7220 6e6f 7420 746f 2073  ther or not to s
-000110c0: 7461 7274 2074 6865 2062 6163 6b66 696c  tart the backfil
-000110d0: 6c20 6a6f 6220 746f 2077 7269 7465 2064  l job to write d
-000110e0: 6174 6120 746f 2074 6865 206f 6666 6c69  ata to the offli
-000110f0: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
-00011100: 2020 2020 2073 746f 7261 6765 2e20 4279       storage. By
-00011110: 2064 6566 6175 6c74 2074 6865 2062 6163   default the bac
-00011120: 6b66 696c 6c20 6a6f 6220 6765 7473 2073  kfill job gets s
-00011130: 7461 7274 6564 2069 6d6d 6564 6961 7465  tarted immediate
-00011140: 6c79 2e0a 2020 2020 2020 2020 2020 2020  ly..            
-00011150: 2020 2020 2a20 6b65 7920 6069 6e74 6572      * key `inter
-00011160: 6e61 6c5f 6b61 666b 6160 2061 6e64 2076  nal_kafka` and v
-00011170: 616c 7565 2060 5472 7565 6020 6f72 2060  alue `True` or `
-00011180: 4661 6c73 6560 2069 6e20 6361 7365 2079  False` in case y
-00011190: 6f75 2065 7374 6162 6c69 7368 6564 0a20  ou established. 
-000111a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000111b0: 2063 6f6e 6e65 6374 6976 6974 7920 6672   connectivity fr
-000111c0: 6f6d 2079 6f75 2050 7974 686f 6e20 656e  om you Python en
-000111d0: 7669 726f 6e6d 656e 7420 746f 2074 6865  vironment to the
-000111e0: 2069 6e74 6572 6e61 6c20 6164 7665 7274   internal advert
-000111f0: 6973 6564 0a20 2020 2020 2020 2020 2020  ised.           
-00011200: 2020 2020 2020 206c 6973 7465 6e65 7273         listeners
-00011210: 206f 6620 7468 6520 486f 7073 776f 726b   of the Hopswork
-00011220: 7320 4b61 666b 6120 436c 7573 7465 722e  s Kafka Cluster.
-00011230: 2044 6566 6175 6c74 7320 746f 2060 4661   Defaults to `Fa
-00011240: 6c73 6560 2061 6e64 0a20 2020 2020 2020  lse` and.       
-00011250: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
-00011260: 7573 6520 6578 7465 726e 616c 206c 6973  use external lis
-00011270: 7465 6e65 7273 2077 6865 6e20 636f 6e6e  teners when conn
-00011280: 6563 7469 6e67 2066 726f 6d20 6f75 7473  ecting from outs
-00011290: 6964 6520 6f66 2048 6f70 7377 6f72 6b73  ide of Hopsworks
-000112a0: 2e0a 2020 2020 2020 2020 2020 2020 7661  ..            va
-000112b0: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
-000112c0: 3a20 4164 6469 7469 6f6e 616c 2076 616c  : Additional val
-000112d0: 6964 6174 696f 6e20 6f70 7469 6f6e 7320  idation options 
-000112e0: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
-000112f0: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
-00011300: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
-00011310: 2020 2020 2020 2a20 6b65 7920 6072 756e        * key `run
-00011320: 5f76 616c 6964 6174 696f 6e60 2062 6f6f  _validation` boo
-00011330: 6c65 616e 2076 616c 7565 2c20 7365 7420  lean value, set 
-00011340: 746f 2060 4661 6c73 6560 2074 6f20 736b  to `False` to sk
-00011350: 6970 2076 616c 6964 6174 696f 6e20 7465  ip validation te
-00011360: 6d70 6f72 6172 696c 7920 6f6e 2069 6e67  mporarily on ing
-00011370: 6573 7469 6f6e 2e0a 2020 2020 2020 2020  estion..        
-00011380: 2020 2020 2020 2020 2a20 6b65 7920 6073          * key `s
-00011390: 6176 655f 7265 706f 7274 6020 626f 6f6c  ave_report` bool
-000113a0: 6561 6e20 7661 6c75 652c 2073 6574 2074  ean value, set t
-000113b0: 6f20 6046 616c 7365 6020 746f 2073 6b69  o `False` to ski
-000113c0: 7020 7570 6c6f 6164 206f 6620 7468 6520  p upload of the 
-000113d0: 7661 6c69 6461 7469 6f6e 2072 6570 6f72  validation repor
-000113e0: 7420 746f 2048 6f70 7377 6f72 6b73 2e0a  t to Hopsworks..
-000113f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011400: 2a20 6b65 7920 6067 655f 7661 6c69 6461  * key `ge_valida
-00011410: 7465 5f6b 7761 7267 7360 2061 2064 6963  te_kwargs` a dic
-00011420: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00011430: 6e67 206b 7761 7267 7320 666f 7220 7468  ng kwargs for th
-00011440: 6520 7661 6c69 6461 7465 206d 6574 686f  e validate metho
-00011450: 6420 6f66 2047 7265 6174 2045 7870 6563  d of Great Expec
-00011460: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
-00011470: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
-00011480: 6665 7463 685f 6578 7065 6374 6174 696f  fetch_expectatio
-00011490: 6e5f 7375 6974 6560 2061 2062 6f6f 6c65  n_suite` a boole
-000114a0: 616e 2076 616c 7565 2c20 6279 2064 6566  an value, by def
-000114b0: 6175 6c74 2060 5472 7565 602c 2074 6f20  ault `True`, to 
-000114c0: 636f 6e74 726f 6c20 7768 6574 6865 7220  control whether 
-000114d0: 7468 6520 6578 7065 6374 6174 696f 6e0a  the expectation.
-000114e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114f0: 2020 2073 7569 7465 206f 6620 7468 6520     suite of the 
-00011500: 6665 6174 7572 6520 6772 6f75 7020 7368  feature group sh
-00011510: 6f75 6c64 2062 6520 6665 7463 6865 6420  ould be fetched 
-00011520: 6265 666f 7265 2065 7665 7279 2069 6e73  before every ins
-00011530: 6572 742e 0a20 2020 2020 2020 2020 2020  ert..           
-00011540: 2073 6176 655f 636f 6465 3a20 5768 656e   save_code: When
-00011550: 2072 756e 6e69 6e67 2048 5346 5320 6f6e   running HSFS on
-00011560: 2048 6f70 7377 6f72 6b73 206f 7220 4461   Hopsworks or Da
-00011570: 7461 6272 6963 6b73 2c20 4853 4653 2063  tabricks, HSFS c
-00011580: 616e 2073 6176 6520 7468 6520 636f 6465  an save the code
-00011590: 2f6e 6f74 6562 6f6f 6b20 7573 6564 2074  /notebook used t
-000115a0: 6f20 6372 6561 7465 0a20 2020 2020 2020  o create.       
-000115b0: 2020 2020 2020 2020 2074 6865 2066 6561           the fea
-000115c0: 7475 7265 2067 726f 7570 206f 7220 7573  ture group or us
-000115d0: 6564 2074 6f20 696e 7365 7274 2064 6174  ed to insert dat
-000115e0: 6120 746f 2069 742e 2057 6865 6e20 6361  a to it. When ca
-000115f0: 6c6c 696e 6720 7468 6520 6069 6e73 6572  lling the `inser
-00011600: 7460 206d 6574 686f 6420 7265 7065 6174  t` method repeat
-00011610: 6564 6c79 0a20 2020 2020 2020 2020 2020  edly.           
-00011620: 2020 2020 2077 6974 6820 736d 616c 6c20       with small 
-00011630: 6261 7463 6865 7320 6f66 2064 6174 612c  batches of data,
-00011640: 2074 6869 7320 6361 6e20 736c 6f77 2064   this can slow d
-00011650: 6f77 6e20 7468 6520 7772 6974 6573 2e20  own the writes. 
-00011660: 5573 6520 7468 6973 206f 7074 696f 6e20  Use this option 
-00011670: 746f 2074 7572 6e20 6f66 6620 7361 7669  to turn off savi
-00011680: 6e67 0a20 2020 2020 2020 2020 2020 2020  ng.             
-00011690: 2020 2063 6f64 652e 2044 6566 6175 6c74     code. Default
-000116a0: 7320 746f 2060 5472 7565 602e 0a0a 2020  s to `True`...  
-000116b0: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-000116c0: 2020 2020 2020 2020 2020 2020 2860 4a6f              (`Jo
-000116d0: 6260 2c20 6056 616c 6964 6174 696f 6e52  b`, `ValidationR
-000116e0: 6570 6f72 7460 2920 4120 7475 706c 6520  eport`) A tuple 
-000116f0: 7769 7468 206a 6f62 2069 6e66 6f72 6d61  with job informa
-00011700: 7469 6f6e 2069 6620 7079 7468 6f6e 2065  tion if python e
-00011710: 6e67 696e 6520 6973 2075 7365 6420 616e  ngine is used an
-00011720: 6420 7468 6520 7661 6c69 6461 7469 6f6e  d the validation
-00011730: 2072 6570 6f72 7420 6966 2076 616c 6964   report if valid
-00011740: 6174 696f 6e20 6973 2065 6e61 626c 6564  ation is enabled
-00011750: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00011760: 2020 2020 2020 6665 6174 7572 655f 6461        feature_da
-00011770: 7461 6672 616d 6520 3d20 656e 6769 6e65  taframe = engine
-00011780: 2e67 6574 5f69 6e73 7461 6e63 6528 292e  .get_instance().
-00011790: 636f 6e76 6572 745f 746f 5f64 6566 6175  convert_to_defau
-000117a0: 6c74 5f64 6174 6166 7261 6d65 2866 6561  lt_dataframe(fea
-000117b0: 7475 7265 7329 0a0a 2020 2020 2020 2020  tures)..        
-000117c0: 6a6f 622c 2067 655f 7265 706f 7274 203d  job, ge_report =
-000117d0: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
-000117e0: 726f 7570 5f65 6e67 696e 652e 696e 7365  roup_engine.inse
-000117f0: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
-00011800: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00011810: 2020 6665 6174 7572 655f 6461 7461 6672    feature_datafr
-00011820: 616d 653d 6665 6174 7572 655f 6461 7461  ame=feature_data
-00011830: 6672 616d 652c 0a20 2020 2020 2020 2020  frame,.         
-00011840: 2020 206f 7665 7277 7269 7465 3d6f 7665     overwrite=ove
-00011850: 7277 7269 7465 2c0a 2020 2020 2020 2020  rwrite,.        
-00011860: 2020 2020 6f70 6572 6174 696f 6e3d 6f70      operation=op
-00011870: 6572 6174 696f 6e2c 0a20 2020 2020 2020  eration,.       
-00011880: 2020 2020 2073 746f 7261 6765 3d73 746f       storage=sto
-00011890: 7261 6765 2e6c 6f77 6572 2829 2069 6620  rage.lower() if 
-000118a0: 7374 6f72 6167 6520 6973 206e 6f74 204e  storage is not N
-000118b0: 6f6e 6520 656c 7365 204e 6f6e 652c 0a20  one else None,. 
-000118c0: 2020 2020 2020 2020 2020 2077 7269 7465             write
-000118d0: 5f6f 7074 696f 6e73 3d77 7269 7465 5f6f  _options=write_o
-000118e0: 7074 696f 6e73 2c0a 2020 2020 2020 2020  ptions,.        
-000118f0: 2020 2020 7661 6c69 6461 7469 6f6e 5f6f      validation_o
-00011900: 7074 696f 6e73 3d7b 2273 6176 655f 7265  ptions={"save_re
-00011910: 706f 7274 223a 2054 7275 652c 202a 2a76  port": True, **v
-00011920: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
-00011930: 737d 2c0a 2020 2020 2020 2020 290a 2020  s},.        ).  
-00011940: 2020 2020 2020 6966 2073 6176 655f 636f        if save_co
-00011950: 6465 2061 6e64 2028 0a20 2020 2020 2020  de and (.       
-00011960: 2020 2020 2067 655f 7265 706f 7274 2069       ge_report i
-00011970: 7320 4e6f 6e65 206f 7220 6765 5f72 6570  s None or ge_rep
-00011980: 6f72 742e 696e 6765 7374 696f 6e5f 7265  ort.ingestion_re
-00011990: 7375 6c74 203d 3d20 2249 4e47 4553 5445  sult == "INGESTE
-000119a0: 4422 0a20 2020 2020 2020 2029 3a0a 2020  D".        ):.  
-000119b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000119c0: 636f 6465 5f65 6e67 696e 652e 7361 7665  code_engine.save
-000119d0: 5f63 6f64 6528 7365 6c66 290a 0a20 2020  _code(self)..   
-000119e0: 2020 2020 2069 6620 656e 6769 6e65 2e67       if engine.g
-000119f0: 6574 5f74 7970 6528 2920 3d3d 2022 7370  et_type() == "sp
-00011a00: 6172 6b22 3a0a 2020 2020 2020 2020 2020  ark":.          
-00011a10: 2020 2320 4f6e 6c79 2063 6f6d 7075 7465    # Only compute
-00011a20: 2073 7461 7469 7374 6963 7320 6966 2074   statistics if t
-00011a30: 6865 2065 6e67 696e 6520 6973 2053 7061  he engine is Spa
-00011a40: 726b 2c0a 2020 2020 2020 2020 2020 2020  rk,.            
-00011a50: 2320 6966 2050 7974 686f 6e2c 2074 6865  # if Python, the
-00011a60: 2073 7461 7469 7374 6963 7320 6172 6520   statistics are 
-00011a70: 636f 6d70 7574 6564 2062 7920 7468 6520  computed by the 
-00011a80: 6170 706c 6963 6174 696f 6e20 646f 696e  application doin
-00011a90: 6720 7468 6520 696e 7365 7274 0a20 2020  g the insert.   
-00011aa0: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-00011ab0: 6d70 7574 655f 7374 6174 6973 7469 6373  mpute_statistics
-00011ac0: 2829 0a0a 2020 2020 2020 2020 7265 7475  ()..        retu
-00011ad0: 726e 2028 0a20 2020 2020 2020 2020 2020  rn (.           
-00011ae0: 206a 6f62 2c0a 2020 2020 2020 2020 2020   job,.          
-00011af0: 2020 6765 5f72 6570 6f72 742e 746f 5f67    ge_report.to_g
-00011b00: 655f 7479 7065 2829 2069 6620 6765 5f72  e_type() if ge_r
-00011b10: 6570 6f72 7420 6973 206e 6f74 204e 6f6e  eport is not Non
-00011b20: 6520 656c 7365 204e 6f6e 652c 0a20 2020  e else None,.   
-00011b30: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-00011b40: 6d75 6c74 695f 7061 7274 5f69 6e73 6572  multi_part_inser
-00011b50: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
-00011b60: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00011b70: 733a 2055 6e69 6f6e 5b0a 2020 2020 2020  s: Union[.      
-00011b80: 2020 2020 2020 7064 2e44 6174 6146 7261        pd.DataFra
-00011b90: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00011ba0: 5479 7065 5661 7228 2270 7973 7061 726b  TypeVar("pyspark
-00011bb0: 2e73 716c 2e44 6174 6146 7261 6d65 2229  .sql.DataFrame")
-00011bc0: 2c20 2023 206e 6f71 613a 2046 3832 310a  ,  # noqa: F821.
-00011bd0: 2020 2020 2020 2020 2020 2020 5479 7065              Type
-00011be0: 5661 7228 2270 7973 7061 726b 2e52 4444  Var("pyspark.RDD
-00011bf0: 2229 2c20 2023 206e 6f71 613a 2046 3832  "),  # noqa: F82
-00011c00: 310a 2020 2020 2020 2020 2020 2020 6e70  1.            np
-00011c10: 2e6e 6461 7272 6179 2c0a 2020 2020 2020  .ndarray,.      
-00011c20: 2020 2020 2020 4c69 7374 5b6c 6973 745d        List[list]
-00011c30: 2c0a 2020 2020 2020 2020 5d20 3d20 4e6f  ,.        ] = No
-00011c40: 6e65 2c0a 2020 2020 2020 2020 6f76 6572  ne,.        over
-00011c50: 7772 6974 653a 204f 7074 696f 6e61 6c5b  write: Optional[
-00011c60: 626f 6f6c 5d20 3d20 4661 6c73 652c 0a20  bool] = False,. 
-00011c70: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
-00011c80: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00011c90: 3d20 2275 7073 6572 7422 2c0a 2020 2020  = "upsert",.    
-00011ca0: 2020 2020 7374 6f72 6167 653a 204f 7074      storage: Opt
-00011cb0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00011cc0: 652c 0a20 2020 2020 2020 2077 7269 7465  e,.        write
-00011cd0: 5f6f 7074 696f 6e73 3a20 4f70 7469 6f6e  _options: Option
-00011ce0: 616c 5b44 6963 745b 7374 722c 2041 6e79  al[Dict[str, Any
-00011cf0: 5d5d 203d 207b 7d2c 0a20 2020 2020 2020  ]] = {},.       
-00011d00: 2076 616c 6964 6174 696f 6e5f 6f70 7469   validation_opti
-00011d10: 6f6e 733a 204f 7074 696f 6e61 6c5b 4469  ons: Optional[Di
-00011d20: 6374 5b73 7472 2c20 416e 795d 5d20 3d20  ct[str, Any]] = 
-00011d30: 7b7d 2c0a 2020 2020 2920 2d3e 2055 6e69  {},.    ) -> Uni
-00011d40: 6f6e 5b0a 2020 2020 2020 2020 5475 706c  on[.        Tupl
-00011d50: 655b 4f70 7469 6f6e 616c 5b4a 6f62 5d2c  e[Optional[Job],
-00011d60: 204f 7074 696f 6e61 6c5b 5661 6c69 6461   Optional[Valida
-00011d70: 7469 6f6e 5265 706f 7274 5d5d 2c0a 2020  tionReport]],.  
-00011d80: 2020 2020 2020 6665 6174 7572 655f 6772        feature_gr
-00011d90: 6f75 705f 7772 6974 6572 2e46 6561 7475  oup_writer.Featu
-00011da0: 7265 4772 6f75 7057 7269 7465 722c 0a20  reGroupWriter,. 
-00011db0: 2020 205d 3a0a 2020 2020 2020 2020 2222     ]:.        ""
-00011dc0: 2247 6574 2046 6561 7475 7265 4772 6f75  "Get FeatureGrou
-00011dd0: 7057 7269 7465 7220 666f 7220 6f70 7469  pWriter for opti
-00011de0: 6d69 7a65 6420 6d75 6c74 6920 7061 7274  mized multi part
-00011df0: 2069 6e73 6572 7473 206f 7220 6361 6c6c   inserts or call
-00011e00: 2074 6869 7320 6d65 7468 6f64 0a20 2020   this method.   
-00011e10: 2020 2020 2074 6f20 7374 6172 7420 6d61       to start ma
-00011e20: 6e75 616c 206d 756c 7469 2070 6172 7420  nual multi part 
-00011e30: 6f70 7469 6d69 7a65 6420 696e 7365 7274  optimized insert
-00011e40: 732e 0a0a 2020 2020 2020 2020 496e 2075  s...        In u
-00011e50: 7365 2063 6173 6573 2077 6865 7265 2076  se cases where v
-00011e60: 6572 7920 736d 616c 6c20 6261 7463 6865  ery small batche
-00011e70: 7320 2831 2074 6f20 3130 3030 2920 726f  s (1 to 1000) ro
-00011e80: 7773 2070 6572 2044 6174 6166 7261 6d65  ws per Dataframe
-00011e90: 206e 6565 640a 2020 2020 2020 2020 746f   need.        to
-00011ea0: 2062 6520 7772 6974 7465 6e20 746f 2074   be written to t
-00011eb0: 6865 2066 6561 7475 7265 2073 746f 7265  he feature store
-00011ec0: 2072 6570 6561 7465 646c 792c 2069 7420   repeatedly, it 
-00011ed0: 6d69 6768 7420 6265 2069 6e65 6666 6963  might be ineffic
-00011ee0: 6965 6e74 2074 6f20 7573 650a 2020 2020  ient to use.    
-00011ef0: 2020 2020 7468 6520 7374 616e 6461 7264      the standard
-00011f00: 2060 6665 6174 7572 655f 6772 6f75 702e   `feature_group.
-00011f10: 696e 7365 7274 2829 6020 6d65 7468 6f64  insert()` method
-00011f20: 2061 7320 6974 2070 6572 666f 726d 7320   as it performs 
-00011f30: 736f 6d65 2062 6163 6b67 726f 756e 640a  some background.
-00011f40: 2020 2020 2020 2020 6163 7469 6f6e 7320          actions 
-00011f50: 746f 2075 7064 6174 6520 7468 6520 6d65  to update the me
-00011f60: 7461 6461 7461 206f 6620 7468 6520 6665  tadata of the fe
-00011f70: 6174 7572 6520 6772 6f75 7020 6f62 6a65  ature group obje
-00011f80: 6374 2066 6972 7374 2e0a 0a20 2020 2020  ct first...     
-00011f90: 2020 2046 6f72 2074 6865 7365 2063 6173     For these cas
-00011fa0: 6573 2c20 7468 6520 6665 6174 7572 6520  es, the feature 
-00011fb0: 6772 6f75 7020 7072 6f76 6964 6573 2074  group provides t
-00011fc0: 6865 2060 6d75 6c74 695f 7061 7274 5f69  he `multi_part_i
-00011fd0: 6e73 6572 7460 2041 5049 2c0a 2020 2020  nsert` API,.    
-00011fe0: 2020 2020 7768 6963 6820 6973 206f 7074      which is opt
-00011ff0: 696d 697a 6564 2066 6f72 2077 7269 7469  imized for writi
-00012000: 6e67 206d 616e 7920 736d 616c 6c20 4461  ng many small Da
-00012010: 7461 6672 616d 6573 2061 6674 6572 2061  taframes after a
-00012020: 6e6f 7468 6572 2e0a 0a20 2020 2020 2020  nother...       
-00012030: 2054 6865 7265 2061 7265 2074 776f 2077   There are two w
-00012040: 6179 7320 746f 2075 7365 2074 6869 7320  ays to use this 
-00012050: 4150 493a 0a20 2020 2020 2020 2021 2121  API:.        !!!
-00012060: 2065 7861 6d70 6c65 2022 5079 7468 6f6e   example "Python
-00012070: 2043 6f6e 7465 7874 204d 616e 6167 6572   Context Manager
-00012080: 220a 2020 2020 2020 2020 2020 2020 5573  ".            Us
-00012090: 696e 6720 7468 6520 5079 7468 6f6e 2060  ing the Python `
-000120a0: 7769 7468 6020 7379 6e74 6178 2079 6f75  with` syntax you
-000120b0: 2063 616e 2061 6371 7569 7265 2061 2046   can acquire a F
-000120c0: 6561 7475 7265 4772 6f75 7057 7269 7465  eatureGroupWrite
-000120d0: 720a 2020 2020 2020 2020 2020 2020 6f62  r.            ob
-000120e0: 6a65 6374 2074 6861 7420 696d 706c 656d  ject that implem
-000120f0: 656e 7473 2074 6865 2073 616d 6520 606d  ents the same `m
-00012100: 756c 7469 5f70 6172 745f 696e 7365 7274  ulti_part_insert
-00012110: 6020 4150 492e 0a20 2020 2020 2020 2020  ` API..         
-00012120: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-00012130: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00012140: 5f67 726f 7570 203d 2066 732e 6765 745f  _group = fs.get_
-00012150: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
-00012160: 655f 6772 6f75 7028 2266 675f 6e61 6d65  e_group("fg_name
-00012170: 222c 2076 6572 7369 6f6e 3d31 290a 0a20  ", version=1).. 
-00012180: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00012190: 6665 6174 7572 655f 6772 6f75 702e 6d75  feature_group.mu
-000121a0: 6c74 695f 7061 7274 5f69 6e73 6572 7428  lti_part_insert(
-000121b0: 2920 6173 2077 7269 7465 723a 0a20 2020  ) as writer:.   
-000121c0: 2020 2020 2020 2020 2020 2020 2023 2072               # r
-000121d0: 756e 2069 6e73 6572 7473 2069 6e20 6120  un inserts in a 
-000121e0: 6c6f 6f70 3a0a 2020 2020 2020 2020 2020  loop:.          
-000121f0: 2020 2020 2020 7768 696c 6520 6c6f 6f70        while loop
-00012200: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00012210: 2020 2020 2020 736d 616c 6c5f 6261 7463        small_batc
-00012220: 685f 6466 203d 202e 2e2e 0a20 2020 2020  h_df = ....     
-00012230: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00012240: 7269 7465 722e 696e 7365 7274 2873 6d61  riter.insert(sma
-00012250: 6c6c 5f62 6174 6368 5f64 6629 0a20 2020  ll_batch_df).   
-00012260: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-00012270: 2020 2020 2020 2020 2054 6865 2077 7269           The wri
-00012280: 7465 7220 6261 7463 6865 7320 7468 6520  ter batches the 
-00012290: 736d 616c 6c20 4461 7461 6672 616d 6573  small Dataframes
-000122a0: 2061 6e64 2074 7261 6e73 6d69 7473 2074   and transmits t
-000122b0: 6865 6d20 746f 2048 6f70 7377 6f72 6b73  hem to Hopsworks
-000122c0: 0a20 2020 2020 2020 2020 2020 2065 6666  .            eff
-000122d0: 6963 6965 6e74 6c79 2e0a 2020 2020 2020  iciently..      
-000122e0: 2020 2020 2020 5768 656e 2065 7869 7469        When exiti
-000122f0: 6e67 2074 6865 2063 6f6e 7465 7874 2c20  ng the context, 
-00012300: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00012310: 7020 7772 6974 6572 2069 7320 7375 7265  p writer is sure
-00012320: 2074 6f20 6578 6974 0a20 2020 2020 2020   to exit.       
-00012330: 2020 2020 206f 6e6c 7920 6f6e 6365 2061       only once a
-00012340: 6c6c 2074 6865 2072 6f77 7320 6861 7665  ll the rows have
-00012350: 2062 6565 6e20 7472 616e 736d 6974 7465   been transmitte
-00012360: 642e 0a0a 2020 2020 2020 2020 2121 2120  d...        !!! 
-00012370: 6578 616d 706c 6520 224d 756c 7469 2070  example "Multi p
-00012380: 6172 7420 696e 7365 7274 2077 6974 6820  art insert with 
-00012390: 6d61 6e75 616c 2063 6f6e 7465 7874 206d  manual context m
-000123a0: 616e 6167 656d 656e 7422 0a20 2020 2020  anagement".     
-000123b0: 2020 2020 2020 2049 6e73 7465 6164 206f         Instead o
-000123c0: 6620 6c65 7474 696e 6720 5079 7468 6f6e  f letting Python
-000123d0: 2068 616e 646c 6520 7468 6520 656e 7465   handle the ente
-000123e0: 7269 6e67 2061 6e64 2065 7869 7469 6e67  ring and exiting
-000123f0: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-00012400: 2020 2020 6d75 6c74 6920 7061 7274 2069      multi part i
-00012410: 6e73 6572 7420 636f 6e74 6578 742c 2079  nsert context, y
-00012420: 6f75 2063 616e 2073 7461 7274 2061 6e64  ou can start and
-00012430: 2066 696e 616c 697a 6520 7468 6520 636f   finalize the co
-00012440: 6e74 6578 740a 2020 2020 2020 2020 2020  ntext.          
-00012450: 2020 6d61 6e75 616c 6c79 2e0a 2020 2020    manually..    
-00012460: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-00012470: 6e0a 2020 2020 2020 2020 2020 2020 6665  n.            fe
-00012480: 6174 7572 655f 6772 6f75 7020 3d20 6673  ature_group = fs
-00012490: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
-000124a0: 6561 7475 7265 5f67 726f 7570 2822 6667  eature_group("fg
-000124b0: 5f6e 616d 6522 2c20 7665 7273 696f 6e3d  _name", version=
-000124c0: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
-000124d0: 7768 696c 6520 6c6f 6f70 3a0a 2020 2020  while loop:.    
-000124e0: 2020 2020 2020 2020 2020 2020 736d 616c              smal
-000124f0: 6c5f 6261 7463 685f 6466 203d 202e 2e2e  l_batch_df = ...
-00012500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012510: 2066 6561 7475 7265 5f67 726f 7570 2e6d   feature_group.m
-00012520: 756c 7469 5f70 6172 745f 696e 7365 7274  ulti_part_insert
-00012530: 2873 6d61 6c6c 5f62 6174 6368 5f64 6629  (small_batch_df)
-00012540: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00012550: 494d 504f 5254 414e 543a 2066 696e 616c  IMPORTANT: final
-00012560: 697a 6520 7468 6520 6d75 6c74 6920 7061  ize the multi pa
-00012570: 7274 2069 6e73 6572 7420 746f 206d 616b  rt insert to mak
-00012580: 6520 7375 7265 2061 6c6c 2072 6f77 730a  e sure all rows.
-00012590: 2020 2020 2020 2020 2020 2020 2320 6861              # ha
-000125a0: 7665 2062 6565 6e20 7472 616e 736d 6974  ve been transmit
-000125b0: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
-000125c0: 6665 6174 7572 655f 6772 6f75 702e 6669  feature_group.fi
-000125d0: 6e61 6c69 7a65 5f6d 756c 7469 5f70 6172  nalize_multi_par
-000125e0: 745f 696e 7365 7274 2829 0a20 2020 2020  t_insert().     
-000125f0: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
-00012600: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
-00012610: 2074 6865 2066 6972 7374 2063 616c 6c20   the first call 
-00012620: 746f 2060 6d75 6c74 695f 7061 7274 5f69  to `multi_part_i
-00012630: 6e73 6572 7460 2069 6e69 7469 6174 6573  nsert` initiates
-00012640: 2074 6865 2063 6f6e 7465 7874 0a20 2020   the context.   
-00012650: 2020 2020 2020 2020 2061 6e64 2062 6520           and be 
-00012660: 7375 7265 2074 6f20 6669 6e61 6c69 7a65  sure to finalize
-00012670: 2069 742e 2054 6865 2060 6669 6e61 6c69   it. The `finali
-00012680: 7a65 5f6d 756c 7469 5f70 6172 745f 696e  ze_multi_part_in
-00012690: 7365 7274 6020 6973 2061 0a20 2020 2020  sert` is a.     
-000126a0: 2020 2020 2020 2062 6c6f 636b 696e 6720         blocking 
-000126b0: 6361 6c6c 2074 6861 7420 7265 7475 726e  call that return
-000126c0: 7320 6f6e 6365 2061 6c6c 2072 6f77 7320  s once all rows 
-000126d0: 6861 7665 2062 6565 6e20 7472 616e 736d  have been transm
-000126e0: 6974 7465 642e 0a0a 2020 2020 2020 2020  itted...        
-000126f0: 2020 2020 4f6e 6365 2079 6f75 2061 7265      Once you are
-00012700: 2064 6f6e 6520 7769 7468 2074 6865 206d   done with the m
-00012710: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
-00012720: 2c20 6974 2069 7320 676f 6f64 2070 7261  , it is good pra
-00012730: 6374 6963 6520 746f 0a20 2020 2020 2020  ctice to.       
-00012740: 2020 2020 2073 7461 7274 2074 6865 2062       start the b
-00012750: 6163 6b66 696c 6c20 6a6f 6220 696e 206f  ackfill job in o
-00012760: 7264 6572 2074 6f20 7772 6974 6520 7468  rder to write th
-00012770: 6520 6461 7461 2074 6f20 7468 6520 6f66  e data to the of
-00012780: 666c 696e 650a 2020 2020 2020 2020 2020  fline.          
-00012790: 2020 7374 6f72 6167 653a 0a20 2020 2020    storage:.     
-000127a0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-000127b0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
-000127c0: 7475 7265 5f67 726f 7570 2e62 6163 6b66  ture_group.backf
-000127d0: 696c 6c5f 6a6f 622e 7275 6e28 6177 6169  ill_job.run(awai
-000127e0: 745f 7465 726d 696e 6174 696f 6e3d 5472  t_termination=Tr
-000127f0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00012800: 6060 600a 0a20 2020 2020 2020 2023 2041  ```..        # A
-00012810: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
-00012820: 2020 2020 2066 6561 7475 7265 733a 2044       features: D
-00012830: 6174 6146 7261 6d65 2c20 5244 442c 204e  ataFrame, RDD, N
-00012840: 6461 7272 6179 2c20 6c69 7374 2e20 4665  darray, list. Fe
-00012850: 6174 7572 6573 2074 6f20 6265 2073 6176  atures to be sav
-00012860: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-00012870: 6f76 6572 7772 6974 653a 2044 726f 7020  overwrite: Drop 
-00012880: 616c 6c20 6461 7461 2069 6e20 7468 6520  all data in the 
-00012890: 6665 6174 7572 6520 6772 6f75 7020 6265  feature group be
-000128a0: 666f 7265 0a20 2020 2020 2020 2020 2020  fore.           
-000128b0: 2020 2020 2069 6e73 6572 7469 6e67 206e       inserting n
-000128c0: 6577 2064 6174 612e 2054 6869 7320 646f  ew data. This do
-000128d0: 6573 206e 6f74 2061 6666 6563 7420 6d65  es not affect me
-000128e0: 7461 6461 7461 2c20 6465 6661 756c 7473  tadata, defaults
-000128f0: 2074 6f20 4661 6c73 652e 0a20 2020 2020   to False..     
-00012900: 2020 2020 2020 206f 7065 7261 7469 6f6e         operation
-00012910: 3a20 4170 6163 6865 2048 7564 6920 6f70  : Apache Hudi op
-00012920: 6572 6174 696f 6e20 7479 7065 2060 2269  eration type `"i
-00012930: 6e73 6572 7422 6020 6f72 2060 2275 7073  nsert"` or `"ups
-00012940: 6572 7422 602e 0a20 2020 2020 2020 2020  ert"`..         
-00012950: 2020 2020 2020 2044 6566 6175 6c74 7320         Defaults 
-00012960: 746f 2060 2275 7073 6572 7422 602e 0a20  to `"upsert"`.. 
-00012970: 2020 2020 2020 2020 2020 2073 746f 7261             stora
-00012980: 6765 3a20 4f76 6572 7772 6974 6520 6465  ge: Overwrite de
-00012990: 6661 756c 7420 6265 6861 7669 6f75 722c  fault behaviour,
-000129a0: 2077 7269 7465 2074 6f20 6f66 666c 696e   write to offlin
-000129b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000129c0: 2020 7374 6f72 6167 6520 6f6e 6c79 2077    storage only w
-000129d0: 6974 6820 6022 6f66 666c 696e 6522 6020  ith `"offline"` 
-000129e0: 6f72 206f 6e6c 696e 6520 6f6e 6c79 2077  or online only w
-000129f0: 6974 6820 6022 6f6e 6c69 6e65 2260 2c20  ith `"online"`, 
-00012a00: 6465 6661 756c 7473 0a20 2020 2020 2020  defaults.       
-00012a10: 2020 2020 2020 2020 2074 6f20 604e 6f6e           to `Non
-00012a20: 6560 2e0a 2020 2020 2020 2020 2020 2020  e`..            
-00012a30: 7772 6974 655f 6f70 7469 6f6e 733a 2041  write_options: A
-00012a40: 6464 6974 696f 6e61 6c20 7772 6974 6520  dditional write 
-00012a50: 6f70 7469 6f6e 7320 6173 206b 6579 2d76  options as key-v
-00012a60: 616c 7565 2070 6169 7273 2c20 6465 6661  alue pairs, defa
-00012a70: 756c 7473 2074 6f20 607b 7d60 2e0a 2020  ults to `{}`..  
-00012a80: 2020 2020 2020 2020 2020 2020 2020 5768                Wh
-00012a90: 656e 2075 7369 6e67 2074 6865 2060 7079  en using the `py
-00012aa0: 7468 6f6e 6020 656e 6769 6e65 2c20 7772  thon` engine, wr
-00012ab0: 6974 655f 6f70 7469 6f6e 7320 6361 6e20  ite_options can 
-00012ac0: 636f 6e74 6169 6e20 7468 650a 2020 2020  contain the.    
-00012ad0: 2020 2020 2020 2020 2020 2020 666f 6c6c              foll
-00012ae0: 6f77 696e 6720 656e 7472 6965 733a 0a20  owing entries:. 
-00012af0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-00012b00: 206b 6579 2060 7370 6172 6b60 2061 6e64   key `spark` and
-00012b10: 2076 616c 7565 2061 6e20 6f62 6a65 6374   value an object
-00012b20: 206f 6620 7479 7065 0a20 2020 2020 2020   of type.       
-00012b30: 2020 2020 2020 2020 205b 6873 6673 2e63           [hsfs.c
-00012b40: 6f72 652e 6a6f 625f 636f 6e66 6967 7572  ore.job_configur
-00012b50: 6174 696f 6e2e 4a6f 6243 6f6e 6669 6775  ation.JobConfigu
-00012b60: 7261 7469 6f6e 5d28 2e2e 2f6a 6f62 5f63  ration](../job_c
-00012b70: 6f6e 6669 6775 7261 7469 6f6e 290a 2020  onfiguration).  
-00012b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b90: 746f 2063 6f6e 6669 6775 7265 2074 6865  to configure the
-00012ba0: 2048 6f70 7377 6f72 6b73 204a 6f62 2075   Hopsworks Job u
-00012bb0: 7365 6420 746f 2077 7269 7465 2064 6174  sed to write dat
-00012bc0: 6120 696e 746f 2074 6865 0a20 2020 2020  a into the.     
-00012bd0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00012be0: 7475 7265 2067 726f 7570 2e0a 2020 2020  ture group..    
-00012bf0: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
-00012c00: 7920 6077 6169 745f 666f 725f 6a6f 6260  y `wait_for_job`
-00012c10: 2061 6e64 2076 616c 7565 2060 5472 7565   and value `True
-00012c20: 6020 6f72 2060 4661 6c73 6560 2074 6f20  ` or `False` to 
-00012c30: 636f 6e66 6967 7572 650a 2020 2020 2020  configure.      
-00012c40: 2020 2020 2020 2020 2020 2020 7768 6574              whet
-00012c50: 6865 7220 6f72 206e 6f74 2074 6f20 7468  her or not to th
-00012c60: 6520 696e 7365 7274 2063 616c 6c20 7368  e insert call sh
-00012c70: 6f75 6c64 2072 6574 7572 6e20 6f6e 6c79  ould return only
-00012c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012c90: 2020 2061 6674 6572 2074 6865 2048 6f70     after the Hop
-00012ca0: 7377 6f72 6b73 204a 6f62 2068 6173 2066  sworks Job has f
-00012cb0: 696e 6973 6865 642e 2042 7920 6465 6661  inished. By defa
-00012cc0: 756c 7420 6974 2077 6169 7473 2e0a 2020  ult it waits..  
-00012cd0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-00012ce0: 6b65 7920 6073 7461 7274 5f6f 6666 6c69  key `start_offli
-00012cf0: 6e65 5f62 6163 6b66 696c 6c60 2061 6e64  ne_backfill` and
-00012d00: 2076 616c 7565 2060 5472 7565 6020 6f72   value `True` or
-00012d10: 2060 4661 6c73 6560 2074 6f20 636f 6e66   `False` to conf
-00012d20: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
-00012d30: 2020 2020 2020 2020 7768 6574 6865 7220          whether 
-00012d40: 6f72 206e 6f74 2074 6f20 7374 6172 7420  or not to start 
-00012d50: 7468 6520 6261 636b 6669 6c6c 206a 6f62  the backfill job
-00012d60: 2074 6f20 7772 6974 6520 6461 7461 2074   to write data t
-00012d70: 6f20 7468 6520 6f66 666c 696e 650a 2020  o the offline.  
-00012d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012d90: 7374 6f72 6167 652e 2042 7920 6465 6661  storage. By defa
-00012da0: 756c 7420 7468 6520 6261 636b 6669 6c6c  ult the backfill
-00012db0: 206a 6f62 2064 6f65 7320 6e6f 7420 6765   job does not ge
-00012dc0: 7420 7374 6172 7465 6420 6175 746f 6d61  t started automa
-00012dd0: 7469 6361 6c6c 790a 2020 2020 2020 2020  tically.        
-00012de0: 2020 2020 2020 2020 2020 666f 7220 6d75            for mu
-00012df0: 6c74 6920 7061 7274 2069 6e73 6572 7473  lti part inserts
-00012e00: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012e10: 2020 2a20 6b65 7920 6069 6e74 6572 6e61    * key `interna
-00012e20: 6c5f 6b61 666b 6160 2061 6e64 2076 616c  l_kafka` and val
-00012e30: 7565 2060 5472 7565 6020 6f72 2060 4661  ue `True` or `Fa
-00012e40: 6c73 6560 2069 6e20 6361 7365 2079 6f75  lse` in case you
-00012e50: 2065 7374 6162 6c69 7368 6564 0a20 2020   established.   
-00012e60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00012e70: 6f6e 6e65 6374 6976 6974 7920 6672 6f6d  onnectivity from
-00012e80: 2079 6f75 2050 7974 686f 6e20 656e 7669   you Python envi
-00012e90: 726f 6e6d 656e 7420 746f 2074 6865 2069  ronment to the i
-00012ea0: 6e74 6572 6e61 6c20 6164 7665 7274 6973  nternal advertis
-00012eb0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-00012ec0: 2020 2020 206c 6973 7465 6e65 7273 206f       listeners o
-00012ed0: 6620 7468 6520 486f 7073 776f 726b 7320  f the Hopsworks 
-00012ee0: 4b61 666b 6120 436c 7573 7465 722e 2044  Kafka Cluster. D
-00012ef0: 6566 6175 6c74 7320 746f 2060 4661 6c73  efaults to `Fals
-00012f00: 6560 2061 6e64 0a20 2020 2020 2020 2020  e` and.         
-00012f10: 2020 2020 2020 2020 2077 696c 6c20 7573           will us
-00012f20: 6520 6578 7465 726e 616c 206c 6973 7465  e external liste
-00012f30: 6e65 7273 2077 6865 6e20 636f 6e6e 6563  ners when connec
-00012f40: 7469 6e67 2066 726f 6d20 6f75 7473 6964  ting from outsid
-00012f50: 6520 6f66 2048 6f70 7377 6f72 6b73 2e0a  e of Hopsworks..
-00012f60: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-00012f70: 6461 7469 6f6e 5f6f 7074 696f 6e73 3a20  dation_options: 
-00012f80: 4164 6469 7469 6f6e 616c 2076 616c 6964  Additional valid
-00012f90: 6174 696f 6e20 6f70 7469 6f6e 7320 6173  ation options as
-00012fa0: 206b 6579 2d76 616c 7565 2070 6169 7273   key-value pairs
-00012fb0: 2c20 6465 6661 756c 7473 2074 6f20 607b  , defaults to `{
-00012fc0: 7d60 2e0a 2020 2020 2020 2020 2020 2020  }`..            
-00012fd0: 2020 2020 2a20 6b65 7920 6072 756e 5f76      * key `run_v
-00012fe0: 616c 6964 6174 696f 6e60 2062 6f6f 6c65  alidation` boole
-00012ff0: 616e 2076 616c 7565 2c20 7365 7420 746f  an value, set to
-00013000: 2060 4661 6c73 6560 2074 6f20 736b 6970   `False` to skip
-00013010: 2076 616c 6964 6174 696f 6e20 7465 6d70   validation temp
-00013020: 6f72 6172 696c 7920 6f6e 2069 6e67 6573  orarily on inges
-00013030: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-00013040: 2020 2020 2020 2a20 6b65 7920 6073 6176        * key `sav
-00013050: 655f 7265 706f 7274 6020 626f 6f6c 6561  e_report` boolea
-00013060: 6e20 7661 6c75 652c 2073 6574 2074 6f20  n value, set to 
-00013070: 6046 616c 7365 6020 746f 2073 6b69 7020  `False` to skip 
-00013080: 7570 6c6f 6164 206f 6620 7468 6520 7661  upload of the va
-00013090: 6c69 6461 7469 6f6e 2072 6570 6f72 7420  lidation report 
-000130a0: 746f 2048 6f70 7377 6f72 6b73 2e0a 2020  to Hopsworks..  
-000130b0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
-000130c0: 6b65 7920 6067 655f 7661 6c69 6461 7465  key `ge_validate
-000130d0: 5f6b 7761 7267 7360 2061 2064 6963 7469  _kwargs` a dicti
-000130e0: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-000130f0: 206b 7761 7267 7320 666f 7220 7468 6520   kwargs for the 
-00013100: 7661 6c69 6461 7465 206d 6574 686f 6420  validate method 
-00013110: 6f66 2047 7265 6174 2045 7870 6563 7461  of Great Expecta
-00013120: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
-00013130: 2020 2020 2020 202a 206b 6579 2060 6665         * key `fe
-00013140: 7463 685f 6578 7065 6374 6174 696f 6e5f  tch_expectation_
-00013150: 7375 6974 6560 2061 2062 6f6f 6c65 616e  suite` a boolean
-00013160: 2076 616c 7565 2c20 6279 2064 6566 6175   value, by defau
-00013170: 6c74 2060 4661 6c73 6560 2066 6f72 206d  lt `False` for m
-00013180: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
-00013190: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-000131a0: 2020 2020 2020 746f 2063 6f6e 7472 6f6c        to control
-000131b0: 2077 6865 7468 6572 2074 6865 2065 7870   whether the exp
-000131c0: 6563 7461 7469 6f6e 2073 7569 7465 206f  ectation suite o
-000131d0: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
-000131e0: 6f75 7020 7368 6f75 6c64 2062 6520 6665  oup should be fe
-000131f0: 7463 6865 6420 6265 666f 7265 2065 7665  tched before eve
-00013200: 7279 2069 6e73 6572 742e 0a0a 2020 2020  ry insert...    
-00013210: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-00013220: 2020 2020 2020 2020 2020 2860 4a6f 6260            (`Job`
-00013230: 2c20 6056 616c 6964 6174 696f 6e52 6570  , `ValidationRep
-00013240: 6f72 7460 2920 4120 7475 706c 6520 7769  ort`) A tuple wi
-00013250: 7468 206a 6f62 2069 6e66 6f72 6d61 7469  th job informati
-00013260: 6f6e 2069 6620 7079 7468 6f6e 2065 6e67  on if python eng
-00013270: 696e 6520 6973 2075 7365 6420 616e 6420  ine is used and 
-00013280: 7468 6520 7661 6c69 6461 7469 6f6e 2072  the validation r
-00013290: 6570 6f72 7420 6966 2076 616c 6964 6174  eport if validat
-000132a0: 696f 6e20 6973 2065 6e61 626c 6564 2e0a  ion is enabled..
-000132b0: 2020 2020 2020 2020 2020 2020 6046 6561              `Fea
-000132c0: 7475 7265 4772 6f75 7057 7269 7465 7260  tureGroupWriter`
-000132d0: 2057 6865 6e20 7573 6564 2061 7320 6120   When used as a 
-000132e0: 636f 6e74 6578 7420 6d61 6e61 6765 7220  context manager 
-000132f0: 7769 7468 2050 7974 686f 6e20 6077 6974  with Python `wit
-00013300: 6860 2073 7461 7465 6d65 6e74 2e0a 2020  h` statement..  
-00013310: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00013320: 2020 7365 6c66 2e5f 6d75 6c74 695f 7061    self._multi_pa
-00013330: 7274 5f69 6e73 6572 7420 3d20 5472 7565  rt_insert = True
-00013340: 0a20 2020 2020 2020 206d 756c 7469 5f70  .        multi_p
-00013350: 6172 745f 7772 6974 6572 203d 2066 6561  art_writer = fea
-00013360: 7475 7265 5f67 726f 7570 5f77 7269 7465  ture_group_write
-00013370: 722e 4665 6174 7572 6547 726f 7570 5772  r.FeatureGroupWr
-00013380: 6974 6572 2873 656c 6629 0a20 2020 2020  iter(self).     
-00013390: 2020 2069 6620 6665 6174 7572 6573 2069     if features i
-000133a0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-000133b0: 2020 2020 7265 7475 726e 206d 756c 7469      return multi
-000133c0: 5f70 6172 745f 7772 6974 6572 0a20 2020  _part_writer.   
-000133d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000133e0: 2020 2020 2020 2023 2067 6f20 7468 726f         # go thro
-000133f0: 7567 6820 7772 6974 6572 2074 6f20 6176  ugh writer to av
-00013400: 6f69 6420 7365 7474 696e 6720 6d75 6c74  oid setting mult
-00013410: 6920 696e 7365 7274 2064 6566 6175 6c74  i insert default
-00013420: 7320 6167 6169 6e0a 2020 2020 2020 2020  s again.        
-00013430: 2020 2020 7265 7475 726e 206d 756c 7469      return multi
-00013440: 5f70 6172 745f 7772 6974 6572 2e69 6e73  _part_writer.ins
-00013450: 6572 7428 0a20 2020 2020 2020 2020 2020  ert(.           
-00013460: 2020 2020 2066 6561 7475 7265 732c 0a20       features,. 
-00013470: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00013480: 7665 7277 7269 7465 2c0a 2020 2020 2020  verwrite,.      
-00013490: 2020 2020 2020 2020 2020 6f70 6572 6174            operat
-000134a0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-000134b0: 2020 2020 2073 746f 7261 6765 2c0a 2020       storage,.  
-000134c0: 2020 2020 2020 2020 2020 2020 2020 7772                wr
-000134d0: 6974 655f 6f70 7469 6f6e 732c 0a20 2020  ite_options,.   
-000134e0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000134f0: 6964 6174 696f 6e5f 6f70 7469 6f6e 732c  idation_options,
-00013500: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00013510: 2020 2020 6465 6620 6669 6e61 6c69 7a65      def finalize
-00013520: 5f6d 756c 7469 5f70 6172 745f 696e 7365  _multi_part_inse
-00013530: 7274 2873 656c 6629 3a0a 2020 2020 2020  rt(self):.      
-00013540: 2020 2222 2246 696e 616c 697a 6573 2061    """Finalizes a
-00013550: 6e64 2065 7869 7473 2074 6865 206d 756c  nd exits the mul
-00013560: 7469 2070 6172 7420 696e 7365 7274 2063  ti part insert c
-00013570: 6f6e 7465 7874 206f 7065 6e65 6420 6279  ontext opened by
-00013580: 2060 6d75 6c74 695f 7061 7274 5f69 6e73   `multi_part_ins
-00013590: 6572 7460 0a20 2020 2020 2020 2069 6e20  ert`.        in 
-000135a0: 6120 626c 6f63 6b69 6e67 2066 6173 6869  a blocking fashi
-000135b0: 6f6e 206f 6e63 6520 616c 6c20 726f 7773  on once all rows
-000135c0: 2068 6176 6520 6265 656e 2074 7261 6e73   have been trans
-000135d0: 6d69 7474 6564 2e0a 0a20 2020 2020 2020  mitted...       
-000135e0: 2021 2121 2065 7861 6d70 6c65 2022 4d75   !!! example "Mu
-000135f0: 6c74 6920 7061 7274 2069 6e73 6572 7420  lti part insert 
-00013600: 7769 7468 206d 616e 7561 6c20 636f 6e74  with manual cont
-00013610: 6578 7420 6d61 6e61 6765 6d65 6e74 220a  ext management".
-00013620: 2020 2020 2020 2020 2020 2020 496e 7374              Inst
-00013630: 6561 6420 6f66 206c 6574 7469 6e67 2050  ead of letting P
-00013640: 7974 686f 6e20 6861 6e64 6c65 2074 6865  ython handle the
-00013650: 2065 6e74 6572 696e 6720 616e 6420 6578   entering and ex
-00013660: 6974 696e 6720 6f66 2074 6865 0a20 2020  iting of the.   
-00013670: 2020 2020 2020 2020 206d 756c 7469 2070           multi p
-00013680: 6172 7420 696e 7365 7274 2063 6f6e 7465  art insert conte
-00013690: 7874 2c20 796f 7520 6361 6e20 7374 6172  xt, you can star
-000136a0: 7420 616e 6420 6669 6e61 6c69 7a65 2074  t and finalize t
-000136b0: 6865 2063 6f6e 7465 7874 0a20 2020 2020  he context.     
-000136c0: 2020 2020 2020 206d 616e 7561 6c6c 792e         manually.
-000136d0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-000136e0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-000136f0: 2020 2066 6561 7475 7265 5f67 726f 7570     feature_group
-00013700: 203d 2066 732e 6765 745f 6f72 5f63 7265   = fs.get_or_cre
-00013710: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
-00013720: 7028 2266 675f 6e61 6d65 222c 2076 6572  p("fg_name", ver
-00013730: 7369 6f6e 3d31 290a 0a20 2020 2020 2020  sion=1)..       
-00013740: 2020 2020 2077 6869 6c65 206c 6f6f 703a       while loop:
-00013750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013760: 2073 6d61 6c6c 5f62 6174 6368 5f64 6620   small_batch_df 
-00013770: 3d20 2e2e 2e0a 2020 2020 2020 2020 2020  = ....          
-00013780: 2020 2020 2020 6665 6174 7572 655f 6772        feature_gr
-00013790: 6f75 702e 6d75 6c74 695f 7061 7274 5f69  oup.multi_part_i
-000137a0: 6e73 6572 7428 736d 616c 6c5f 6261 7463  nsert(small_batc
-000137b0: 685f 6466 290a 0a20 2020 2020 2020 2020  h_df)..         
-000137c0: 2020 2023 2049 4d50 4f52 5441 4e54 3a20     # IMPORTANT: 
-000137d0: 6669 6e61 6c69 7a65 2074 6865 206d 756c  finalize the mul
-000137e0: 7469 2070 6172 7420 696e 7365 7274 2074  ti part insert t
-000137f0: 6f20 6d61 6b65 2073 7572 6520 616c 6c20  o make sure all 
-00013800: 726f 7773 0a20 2020 2020 2020 2020 2020  rows.           
-00013810: 2023 2068 6176 6520 6265 656e 2074 7261   # have been tra
-00013820: 6e73 6d69 7474 6564 0a20 2020 2020 2020  nsmitted.       
-00013830: 2020 2020 2066 6561 7475 7265 5f67 726f       feature_gro
-00013840: 7570 2e66 696e 616c 697a 655f 6d75 6c74  up.finalize_mult
-00013850: 695f 7061 7274 5f69 6e73 6572 7428 290a  i_part_insert().
-00013860: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00013870: 2020 2020 2020 2020 2020 2020 4e6f 7465              Note
-00013880: 2074 6861 7420 7468 6520 6669 7273 7420   that the first 
-00013890: 6361 6c6c 2074 6f20 606d 756c 7469 5f70  call to `multi_p
-000138a0: 6172 745f 696e 7365 7274 6020 696e 6974  art_insert` init
-000138b0: 6961 7465 7320 7468 6520 636f 6e74 6578  iates the contex
-000138c0: 740a 2020 2020 2020 2020 2020 2020 616e  t.            an
-000138d0: 6420 6265 2073 7572 6520 746f 2066 696e  d be sure to fin
-000138e0: 616c 697a 6520 6974 2e20 5468 6520 6066  alize it. The `f
-000138f0: 696e 616c 697a 655f 6d75 6c74 695f 7061  inalize_multi_pa
-00013900: 7274 5f69 6e73 6572 7460 2069 7320 610a  rt_insert` is a.
-00013910: 2020 2020 2020 2020 2020 2020 626c 6f63              bloc
-00013920: 6b69 6e67 2063 616c 6c20 7468 6174 2072  king call that r
-00013930: 6574 7572 6e73 206f 6e63 6520 616c 6c20  eturns once all 
-00013940: 726f 7773 2068 6176 6520 6265 656e 2074  rows have been t
-00013950: 7261 6e73 6d69 7474 6564 2e0a 2020 2020  ransmitted..    
-00013960: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00013970: 6966 2073 656c 662e 5f6b 6166 6b61 5f70  if self._kafka_p
-00013980: 726f 6475 6365 7220 6973 206e 6f74 204e  roducer is not N
-00013990: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000139a0: 2073 656c 662e 5f6b 6166 6b61 5f70 726f   self._kafka_pro
-000139b0: 6475 6365 722e 666c 7573 6828 290a 2020  ducer.flush().  
-000139c0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-000139d0: 6b61 666b 615f 7072 6f64 7563 6572 203d  kafka_producer =
-000139e0: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-000139f0: 6c66 2e5f 6665 6174 7572 655f 7772 6974  lf._feature_writ
-00013a00: 6572 7320 3d20 4e6f 6e65 0a20 2020 2020  ers = None.     
-00013a10: 2020 2073 656c 662e 5f77 7269 7465 7220     self._writer 
-00013a20: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
-00013a30: 656c 662e 5f6d 756c 7469 5f70 6172 745f  elf._multi_part_
-00013a40: 696e 7365 7274 203d 2046 616c 7365 0a0a  insert = False..
-00013a50: 2020 2020 6465 6620 696e 7365 7274 5f73      def insert_s
-00013a60: 7472 6561 6d28 0a20 2020 2020 2020 2073  tream(.        s
-00013a70: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
-00013a80: 7475 7265 733a 2054 7970 6556 6172 2822  tures: TypeVar("
-00013a90: 7079 7370 6172 6b2e 7371 6c2e 4461 7461  pyspark.sql.Data
-00013aa0: 4672 616d 6522 292c 2020 2320 6e6f 7161  Frame"),  # noqa
-00013ab0: 3a20 4638 3231 0a20 2020 2020 2020 2071  : F821.        q
-00013ac0: 7565 7279 5f6e 616d 653a 204f 7074 696f  uery_name: Optio
-00013ad0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00013ae0: 0a20 2020 2020 2020 206f 7574 7075 745f  .        output_
-00013af0: 6d6f 6465 3a20 4f70 7469 6f6e 616c 5b73  mode: Optional[s
-00013b00: 7472 5d20 3d20 2261 7070 656e 6422 2c0a  tr] = "append",.
-00013b10: 2020 2020 2020 2020 6177 6169 745f 7465          await_te
-00013b20: 726d 696e 6174 696f 6e3a 204f 7074 696f  rmination: Optio
-00013b30: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
-00013b40: 652c 0a20 2020 2020 2020 2074 696d 656f  e,.        timeo
-00013b50: 7574 3a20 4f70 7469 6f6e 616c 5b69 6e74  ut: Optional[int
-00013b60: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00013b70: 2020 6368 6563 6b70 6f69 6e74 5f64 6972    checkpoint_dir
-00013b80: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00013b90: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00013ba0: 7772 6974 655f 6f70 7469 6f6e 733a 204f  write_options: O
-00013bb0: 7074 696f 6e61 6c5b 4469 6374 5b41 6e79  ptional[Dict[Any
-00013bc0: 2c20 416e 795d 5d20 3d20 7b7d 2c0a 2020  , Any]] = {},.  
-00013bd0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00013be0: 496e 6765 7374 2061 2053 7061 726b 2053  Ingest a Spark S
-00013bf0: 7472 7563 7475 7265 6420 5374 7265 616d  tructured Stream
-00013c00: 696e 6720 4461 7461 6672 616d 6520 746f  ing Dataframe to
-00013c10: 2074 6865 206f 6e6c 696e 6520 6665 6174   the online feat
-00013c20: 7572 6520 7374 6f72 652e 0a0a 2020 2020  ure store...    
-00013c30: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
-00013c40: 6372 6561 7465 7320 6120 6c6f 6e67 2072  creates a long r
-00013c50: 756e 6e69 6e67 2053 7061 726b 2053 7472  unning Spark Str
-00013c60: 6561 6d69 6e67 2051 7565 7279 2c20 796f  eaming Query, yo
-00013c70: 7520 6361 6e20 636f 6e74 726f 6c20 7468  u can control th
-00013c80: 650a 2020 2020 2020 2020 7465 726d 696e  e.        termin
-00013c90: 6174 696f 6e20 6f66 2074 6865 2071 7565  ation of the que
-00013ca0: 7279 2074 6872 6f75 6768 2074 6865 2061  ry through the a
-00013cb0: 7267 756d 656e 7473 2e0a 0a20 2020 2020  rguments...     
-00013cc0: 2020 2049 7420 6973 2070 6f73 7369 626c     It is possibl
-00013cd0: 6520 746f 2073 746f 7020 7468 6520 7265  e to stop the re
-00013ce0: 7475 726e 6564 2071 7565 7279 2077 6974  turned query wit
-00013cf0: 6820 7468 6520 602e 7374 6f70 2829 6020  h the `.stop()` 
-00013d00: 616e 6420 6368 6563 6b20 6974 730a 2020  and check its.  
-00013d10: 2020 2020 2020 7374 6174 7573 2077 6974        status wit
-00013d20: 6820 602e 6973 4163 7469 7665 602e 0a0a  h `.isActive`...
-00013d30: 2020 2020 2020 2020 546f 2067 6574 2061          To get a
-00013d40: 206c 6973 7420 6f66 2061 6c6c 2061 6374   list of all act
-00013d50: 6976 6520 7175 6572 6965 732c 2075 7365  ive queries, use
-00013d60: 3a0a 0a20 2020 2020 2020 2060 6060 7079  :..        ```py
-00013d70: 7468 6f6e 0a20 2020 2020 2020 2073 716d  thon.        sqm
-00013d80: 203d 2073 7061 726b 2e73 7472 6561 6d73   = spark.streams
-00013d90: 0a0a 2020 2020 2020 2020 2320 6765 7420  ..        # get 
-00013da0: 7468 6520 6c69 7374 206f 6620 6163 7469  the list of acti
-00013db0: 7665 2073 7472 6561 6d69 6e67 2071 7565  ve streaming que
-00013dc0: 7269 6573 0a20 2020 2020 2020 205b 712e  ries.        [q.
-00013dd0: 6e61 6d65 2066 6f72 2071 2069 6e20 7371  name for q in sq
-00013de0: 6d2e 6163 7469 7665 5d0a 2020 2020 2020  m.active].      
-00013df0: 2020 6060 600a 0a20 2020 2020 2020 2021    ```..        !
-00013e00: 2121 2077 6172 6e69 6e67 2022 456e 6769  !! warning "Engi
-00013e10: 6e65 2053 7570 706f 7274 220a 2020 2020  ne Support".    
-00013e20: 2020 2020 2020 2020 2a2a 5370 6172 6b20          **Spark 
-00013e30: 6f6e 6c79 2a2a 0a0a 2020 2020 2020 2020  only**..        
-00013e40: 2020 2020 5374 7265 616d 2069 6e67 6573      Stream inges
-00013e50: 7469 6f6e 2075 7369 6e67 2050 616e 6461  tion using Panda
-00013e60: 732f 5079 7468 6f6e 2061 7320 656e 6769  s/Python as engi
-00013e70: 6e65 2069 7320 6375 7272 656e 746c 7920  ne is currently 
-00013e80: 6e6f 7420 7375 7070 6f72 7465 642e 0a20  not supported.. 
-00013e90: 2020 2020 2020 2020 2020 2050 7974 686f             Pytho
-00013ea0: 6e2f 5061 6e64 6173 2068 6173 206e 6f20  n/Pandas has no 
-00013eb0: 6e6f 7469 6f6e 206f 6620 7374 7265 616d  notion of stream
-00013ec0: 696e 672e 0a0a 2020 2020 2020 2020 2121  ing...        !!
-00013ed0: 2120 7761 726e 696e 6720 2244 6174 6120  ! warning "Data 
-00013ee0: 5661 6c69 6461 7469 6f6e 2053 7570 706f  Validation Suppo
-00013ef0: 7274 220a 2020 2020 2020 2020 2020 2020  rt".            
-00013f00: 6069 6e73 6572 745f 7374 7265 616d 6020  `insert_stream` 
-00013f10: 646f 6573 206e 6f74 2070 6572 666f 726d  does not perform
-00013f20: 2061 6e79 2064 6174 6120 7661 6c69 6461   any data valida
-00013f30: 7469 6f6e 2075 7369 6e67 2047 7265 6174  tion using Great
-00013f40: 2045 7870 6563 7461 7469 6f6e 730a 2020   Expectations.  
-00013f50: 2020 2020 2020 2020 2020 6576 656e 2077            even w
-00013f60: 6865 6e20 6120 6578 7065 6374 6174 696f  hen a expectatio
-00013f70: 6e20 7375 6974 6520 6973 2061 7474 6163  n suite is attac
-00013f80: 6865 642e 0a0a 2020 2020 2020 2020 2320  hed...        # 
-00013f90: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
-00013fa0: 2020 2020 2020 6665 6174 7572 6573 3a20        features: 
-00013fb0: 4665 6174 7572 6573 2069 6e20 5374 7265  Features in Stre
-00013fc0: 616d 696e 6720 4461 7461 6672 616d 6520  aming Dataframe 
-00013fd0: 746f 2062 6520 7361 7665 642e 0a20 2020  to be saved..   
-00013fe0: 2020 2020 2020 2020 2071 7565 7279 5f6e           query_n
-00013ff0: 616d 653a 2049 7420 6973 2070 6f73 7369  ame: It is possi
-00014000: 626c 6520 746f 206f 7074 696f 6e61 6c6c  ble to optionall
-00014010: 7920 7370 6563 6966 7920 6120 6e61 6d65  y specify a name
-00014020: 2066 6f72 2074 6865 2071 7565 7279 2074   for the query t
-00014030: 6f0a 2020 2020 2020 2020 2020 2020 2020  o.              
-00014040: 2020 6d61 6b65 2069 7420 6561 7369 6572    make it easier
-00014050: 2074 6f20 7265 636f 676e 6973 6520 696e   to recognise in
-00014060: 2074 6865 2053 7061 726b 2055 492e 2044   the Spark UI. D
-00014070: 6566 6175 6c74 7320 746f 2060 4e6f 6e65  efaults to `None
-00014080: 602e 0a20 2020 2020 2020 2020 2020 206f  `..            o
-00014090: 7574 7075 745f 6d6f 6465 3a20 5370 6563  utput_mode: Spec
-000140a0: 6966 6965 7320 686f 7720 6461 7461 206f  ifies how data o
-000140b0: 6620 6120 7374 7265 616d 696e 6720 4461  f a streaming Da
-000140c0: 7461 4672 616d 652f 4461 7461 7365 7420  taFrame/Dataset 
-000140d0: 6973 0a20 2020 2020 2020 2020 2020 2020  is.             
-000140e0: 2020 2077 7269 7474 656e 2074 6f20 6120     written to a 
-000140f0: 7374 7265 616d 696e 6720 7369 6e6b 2e20  streaming sink. 
-00014100: 2831 2920 6022 6170 7065 6e64 2260 3a20  (1) `"append"`: 
-00014110: 4f6e 6c79 2074 6865 206e 6577 2072 6f77  Only the new row
-00014120: 7320 696e 2074 6865 0a20 2020 2020 2020  s in the.       
-00014130: 2020 2020 2020 2020 2073 7472 6561 6d69           streami
-00014140: 6e67 2044 6174 6146 7261 6d65 2f44 6174  ng DataFrame/Dat
-00014150: 6173 6574 2077 696c 6c20 6265 2077 7269  aset will be wri
-00014160: 7474 656e 2074 6f20 7468 6520 7369 6e6b  tten to the sink
-00014170: 2e20 2832 290a 2020 2020 2020 2020 2020  . (2).          
-00014180: 2020 2020 2020 6022 636f 6d70 6c65 7465        `"complete
-00014190: 2260 3a20 416c 6c20 7468 6520 726f 7773  "`: All the rows
-000141a0: 2069 6e20 7468 6520 7374 7265 616d 696e   in the streamin
-000141b0: 6720 4461 7461 4672 616d 652f 4461 7461  g DataFrame/Data
-000141c0: 7365 7420 7769 6c6c 2062 650a 2020 2020  set will be.    
-000141d0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-000141e0: 7465 6e20 746f 2074 6865 2073 696e 6b20  ten to the sink 
-000141f0: 6576 6572 7920 7469 6d65 2074 6865 7265  every time there
-00014200: 2069 7320 736f 6d65 2075 7064 6174 652e   is some update.
-00014210: 2028 3329 2060 2275 7064 6174 6522 603a   (3) `"update"`:
-00014220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014230: 206f 6e6c 7920 7468 6520 726f 7773 2074   only the rows t
-00014240: 6861 7420 7765 7265 2075 7064 6174 6564  hat were updated
-00014250: 2069 6e20 7468 6520 7374 7265 616d 696e   in the streamin
-00014260: 6720 4461 7461 4672 616d 652f 4461 7461  g DataFrame/Data
-00014270: 7365 7420 7769 6c6c 0a20 2020 2020 2020  set will.       
-00014280: 2020 2020 2020 2020 2062 6520 7772 6974           be writ
-00014290: 7465 6e20 746f 2074 6865 2073 696e 6b20  ten to the sink 
-000142a0: 6576 6572 7920 7469 6d65 2074 6865 7265  every time there
-000142b0: 2061 7265 2073 6f6d 6520 7570 6461 7465   are some update
-000142c0: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-000142d0: 2020 2049 6620 7468 6520 7175 6572 7920     If the query 
-000142e0: 646f 6573 6ee2 8099 7420 636f 6e74 6169  doesn...t contai
-000142f0: 6e20 6167 6772 6567 6174 696f 6e73 2c20  n aggregations, 
-00014300: 6974 2077 696c 6c20 6265 2065 7175 6976  it will be equiv
-00014310: 616c 656e 7420 746f 0a20 2020 2020 2020  alent to.       
-00014320: 2020 2020 2020 2020 2061 7070 656e 6420           append 
-00014330: 6d6f 6465 2e20 4465 6661 756c 7473 2074  mode. Defaults t
-00014340: 6f20 6022 6170 7065 6e64 2260 2e0a 2020  o `"append"`..  
-00014350: 2020 2020 2020 2020 2020 6177 6169 745f            await_
-00014360: 7465 726d 696e 6174 696f 6e3a 2057 6169  termination: Wai
-00014370: 7473 2066 6f72 2074 6865 2074 6572 6d69  ts for the termi
-00014380: 6e61 7469 6f6e 206f 6620 7468 6973 2071  nation of this q
-00014390: 7565 7279 2c20 6569 7468 6572 2062 790a  uery, either by.
-000143a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143b0: 7175 6572 792e 7374 6f70 2829 206f 7220  query.stop() or 
-000143c0: 6279 2061 6e20 6578 6365 7074 696f 6e2e  by an exception.
-000143d0: 2049 6620 7468 6520 7175 6572 7920 6861   If the query ha
-000143e0: 7320 7465 726d 696e 6174 6564 2077 6974  s terminated wit
-000143f0: 6820 616e 0a20 2020 2020 2020 2020 2020  h an.           
-00014400: 2020 2020 2065 7863 6570 7469 6f6e 2c20       exception, 
-00014410: 7468 656e 2074 6865 2065 7863 6570 7469  then the excepti
-00014420: 6f6e 2077 696c 6c20 6265 2074 6872 6f77  on will be throw
-00014430: 6e2e 2049 6620 7469 6d65 6f75 7420 6973  n. If timeout is
-00014440: 2073 6574 2c20 6974 0a20 2020 2020 2020   set, it.       
-00014450: 2020 2020 2020 2020 2072 6574 7572 6e73           returns
-00014460: 2077 6865 7468 6572 2074 6865 2071 7565   whether the que
-00014470: 7279 2068 6173 2074 6572 6d69 6e61 7465  ry has terminate
-00014480: 6420 6f72 206e 6f74 2077 6974 6869 6e20  d or not within 
-00014490: 7468 6520 7469 6d65 6f75 740a 2020 2020  the timeout.    
-000144a0: 2020 2020 2020 2020 2020 2020 7365 636f              seco
-000144b0: 6e64 732e 2044 6566 6175 6c74 7320 746f  nds. Defaults to
-000144c0: 2060 4661 6c73 6560 2e0a 2020 2020 2020   `False`..      
-000144d0: 2020 2020 2020 7469 6d65 6f75 743a 204f        timeout: O
-000144e0: 6e6c 7920 7265 6c65 7661 6e74 2069 6e20  nly relevant in 
-000144f0: 636f 6d62 696e 6174 696f 6e20 7769 7468  combination with
-00014500: 2060 6177 6169 745f 7465 726d 696e 6174   `await_terminat
-00014510: 696f 6e3d 5472 7565 602e 0a20 2020 2020  ion=True`..     
-00014520: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00014530: 6c74 7320 746f 2060 4e6f 6e65 602e 0a20  lts to `None`.. 
-00014540: 2020 2020 2020 2020 2020 2063 6865 636b             check
-00014550: 706f 696e 745f 6469 723a 2043 6865 636b  point_dir: Check
-00014560: 706f 696e 7420 6469 7265 6374 6f72 7920  point directory 
-00014570: 6c6f 6361 7469 6f6e 2e20 5468 6973 2077  location. This w
-00014580: 696c 6c20 6265 2075 7365 6420 746f 2061  ill be used to a
-00014590: 7320 6120 7265 6665 7265 6e63 6520 746f  s a reference to
-000145a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000145b0: 2066 726f 6d20 7768 6572 6520 746f 2072   from where to r
-000145c0: 6573 756d 6520 7468 6520 7374 7265 616d  esume the stream
-000145d0: 696e 6720 6a6f 622e 2049 6620 604e 6f6e  ing job. If `Non
-000145e0: 6560 2074 6865 6e20 6873 6673 2077 696c  e` then hsfs wil
-000145f0: 6c20 636f 6e73 7472 7563 7420 6173 0a20  l construct as. 
-00014600: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00014610: 696e 7365 7274 5f73 7472 6561 6d5f 2220  insert_stream_" 
-00014620: 2b20 6f6e 6c69 6e65 5f74 6f70 6963 5f6e  + online_topic_n
-00014630: 616d 652e 2044 6566 6175 6c74 7320 746f  ame. Defaults to
-00014640: 2060 4e6f 6e65 602e 0a20 2020 2020 2020   `None`..       
-00014650: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
-00014660: 7074 696f 6e73 3a20 4164 6469 7469 6f6e  ptions: Addition
-00014670: 616c 2077 7269 7465 206f 7074 696f 6e73  al write options
-00014680: 2066 6f72 2053 7061 726b 2061 7320 6b65   for Spark as ke
-00014690: 792d 7661 6c75 6520 7061 6972 732e 0a20  y-value pairs.. 
-000146a0: 2020 2020 2020 2020 2020 2020 2020 2044                 D
-000146b0: 6566 6175 6c74 7320 746f 2060 7b7d 602e  efaults to `{}`.
-000146c0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
-000146d0: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
-000146e0: 6053 7472 6561 6d69 6e67 5175 6572 7960  `StreamingQuery`
-000146f0: 3a20 5370 6172 6b20 5374 7275 6374 7572  : Spark Structur
-00014700: 6564 2053 7472 6561 6d69 6e67 2051 7565  ed Streaming Que
-00014710: 7279 206f 626a 6563 742e 0a20 2020 2020  ry object..     
-00014720: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00014730: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00014740: 6e6f 7420 656e 6769 6e65 2e67 6574 5f69  not engine.get_i
-00014750: 6e73 7461 6e63 6528 292e 6973 5f73 7061  nstance().is_spa
-00014760: 726b 5f64 6174 6166 7261 6d65 2866 6561  rk_dataframe(fea
-00014770: 7475 7265 7329 0a20 2020 2020 2020 2020  tures).         
-00014780: 2020 206f 7220 6e6f 7420 6665 6174 7572     or not featur
-00014790: 6573 2e69 7353 7472 6561 6d69 6e67 0a20  es.isStreaming. 
-000147a0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-000147b0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000147c0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000147d0: 2020 2020 2020 2022 4665 6174 7572 6573         "Features
-000147e0: 2068 6176 6520 746f 2062 6520 6120 7374   have to be a st
-000147f0: 7265 616d 696e 6720 7479 7065 2073 7061  reaming type spa
-00014800: 726b 2064 6174 6166 7261 6d65 2e20 5573  rk dataframe. Us
-00014810: 6520 6069 6e73 6572 7428 2960 206d 6574  e `insert()` met
-00014820: 686f 6420 696e 7374 6561 642e 220a 2020  hod instead.".  
-00014830: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00014840: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00014850: 2020 2020 2020 2320 6c6f 7765 7220 6361        # lower ca
-00014860: 7369 6e67 2066 6561 7475 7265 206e 616d  sing feature nam
-00014870: 6573 0a20 2020 2020 2020 2020 2020 2066  es.            f
-00014880: 6561 7475 7265 5f64 6174 6166 7261 6d65  eature_dataframe
-00014890: 203d 2065 6e67 696e 652e 6765 745f 696e   = engine.get_in
-000148a0: 7374 616e 6365 2829 2e63 6f6e 7665 7274  stance().convert
-000148b0: 5f74 6f5f 6465 6661 756c 745f 6461 7461  _to_default_data
-000148c0: 6672 616d 6528 0a20 2020 2020 2020 2020  frame(.         
-000148d0: 2020 2020 2020 2066 6561 7475 7265 730a         features.
-000148e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000148f0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-00014900: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-00014910: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
-00014920: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00014930: 5374 7265 616d 2069 6e67 6573 7469 6f6e  Stream ingestion
-00014940: 2066 6f72 2066 6561 7475 7265 2067 726f   for feature gro
-00014950: 7570 2060 7b7d 602c 2077 6974 6820 7665  up `{}`, with ve
-00014960: 7273 696f 6e22 0a20 2020 2020 2020 2020  rsion".         
-00014970: 2020 2020 2020 2020 2020 2022 2060 7b7d             " `{}
-00014980: 6020 7769 6c6c 206e 6f74 2063 6f6d 7075  ` will not compu
-00014990: 7465 2073 7461 7469 7374 6963 732e 220a  te statistics.".
-000149a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000149b0: 292e 666f 726d 6174 2873 656c 662e 5f6e  ).format(self._n
-000149c0: 616d 652c 2073 656c 662e 5f76 6572 7369  ame, self._versi
-000149d0: 6f6e 292c 0a20 2020 2020 2020 2020 2020  on),.           
-000149e0: 2020 2020 2075 7469 6c2e 5374 6174 6973       util.Statis
-000149f0: 7469 6373 5761 726e 696e 672c 0a20 2020  ticsWarning,.   
-00014a00: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00014a10: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00014a20: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
-00014a30: 7570 5f65 6e67 696e 652e 696e 7365 7274  up_engine.insert
-00014a40: 5f73 7472 6561 6d28 0a20 2020 2020 2020  _stream(.       
-00014a50: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-00014a60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00014a70: 6561 7475 7265 5f64 6174 6166 7261 6d65  eature_dataframe
-00014a80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014a90: 2020 7175 6572 795f 6e61 6d65 2c0a 2020    query_name,.  
-00014aa0: 2020 2020 2020 2020 2020 2020 2020 6f75                ou
-00014ab0: 7470 7574 5f6d 6f64 652c 0a20 2020 2020  tput_mode,.     
-00014ac0: 2020 2020 2020 2020 2020 2061 7761 6974             await
-00014ad0: 5f74 6572 6d69 6e61 7469 6f6e 2c0a 2020  _termination,.  
-00014ae0: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-00014af0: 6d65 6f75 742c 0a20 2020 2020 2020 2020  meout,.         
-00014b00: 2020 2020 2020 2063 6865 636b 706f 696e         checkpoin
-00014b10: 745f 6469 722c 0a20 2020 2020 2020 2020  t_dir,.         
-00014b20: 2020 2020 2020 2077 7269 7465 5f6f 7074         write_opt
-00014b30: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-00014b40: 2020 290a 0a20 2020 2064 6566 2063 6f6d    )..    def com
-00014b50: 6d69 745f 6465 7461 696c 7328 0a20 2020  mit_details(.   
-00014b60: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00014b70: 2020 2077 616c 6c63 6c6f 636b 5f74 696d     wallclock_tim
-00014b80: 653a 204f 7074 696f 6e61 6c5b 556e 696f  e: Optional[Unio
-00014b90: 6e5b 7374 722c 2069 6e74 2c20 6461 7465  n[str, int, date
-00014ba0: 7469 6d65 2c20 6461 7465 5d5d 203d 204e  time, date]] = N
-00014bb0: 6f6e 652c 0a20 2020 2020 2020 206c 696d  one,.        lim
-00014bc0: 6974 3a20 4f70 7469 6f6e 616c 5b69 6e74  it: Optional[int
-00014bd0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 293a  ] = None,.    ):
-00014be0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
-00014bf0: 6965 7665 7320 636f 6d6d 6974 2074 696d  ieves commit tim
-00014c00: 656c 696e 6520 666f 7220 7468 6973 2066  eline for this f
-00014c10: 6561 7475 7265 2067 726f 7570 2e20 5468  eature group. Th
-00014c20: 6973 206d 6574 686f 6420 6361 6e20 6f6e  is method can on
-00014c30: 6c79 2062 6520 7573 6564 0a20 2020 2020  ly be used.     
-00014c40: 2020 206f 6e20 7469 6d65 2074 7261 7665     on time trave
-00014c50: 6c20 656e 6162 6c65 6420 6665 6174 7572  l enabled featur
-00014c60: 6520 6772 6f75 7073 0a0a 2020 2020 2020  e groups..      
-00014c70: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
-00014c80: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-00014c90: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-00014ca0: 2320 636f 6e6e 6563 7420 746f 2074 6865  # connect to the
-00014cb0: 2046 6561 7475 7265 2053 746f 7265 0a20   Feature Store. 
-00014cc0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
-00014cd0: 2e2e 2e0a 0a20 2020 2020 2020 2020 2020  .....           
-00014ce0: 2023 2067 6574 2074 6865 2046 6561 7475   # get the Featu
-00014cf0: 7265 2047 726f 7570 2069 6e73 7461 6e63  re Group instanc
-00014d00: 650a 2020 2020 2020 2020 2020 2020 6667  e.            fg
-00014d10: 203d 2066 732e 6765 745f 6f72 5f63 7265   = fs.get_or_cre
-00014d20: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
-00014d30: 7028 2e2e 2e29 0a0a 2020 2020 2020 2020  p(...)..        
-00014d40: 2020 2020 636f 6d6d 6974 5f64 6574 6169      commit_detai
-00014d50: 6c73 203d 2066 672e 636f 6d6d 6974 5f64  ls = fg.commit_d
-00014d60: 6574 6169 6c73 2829 0a20 2020 2020 2020  etails().       
-00014d70: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-00014d80: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-00014d90: 2020 2020 2020 2020 2020 7761 6c6c 636c            wallcl
-00014da0: 6f63 6b5f 7469 6d65 3a20 436f 6d6d 6974  ock_time: Commit
-00014db0: 2064 6574 6169 6c73 2061 7320 6f66 2073   details as of s
-00014dc0: 7065 6369 6669 6320 706f 696e 7420 696e  pecific point in
-00014dd0: 2074 696d 652e 2044 6566 6175 6c74 7320   time. Defaults 
-00014de0: 746f 2060 4e6f 6e65 602e 0a20 2020 2020  to `None`..     
-00014df0: 2020 2020 2020 2020 2020 2020 5374 7269              Stri
-00014e00: 6e67 7320 7368 6f75 6c64 2062 6520 666f  ngs should be fo
-00014e10: 726d 6174 7465 6420 696e 206f 6e65 206f  rmatted in one o
-00014e20: 6620 7468 6520 666f 6c6c 6f77 696e 6720  f the following 
-00014e30: 666f 726d 6174 7320 6025 592d 256d 2d25  formats `%Y-%m-%
-00014e40: 6460 2c20 6025 592d 256d 2d25 6420 2548  d`, `%Y-%m-%d %H
-00014e50: 602c 2060 2559 2d25 6d2d 2564 2025 483a  `, `%Y-%m-%d %H:
-00014e60: 254d 602c 0a20 2020 2020 2020 2020 2020  %M`,.           
-00014e70: 2020 2020 2060 2559 2d25 6d2d 2564 2025       `%Y-%m-%d %
-00014e80: 483a 254d 3a25 5360 2c20 6f72 2060 2559  H:%M:%S`, or `%Y
-00014e90: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
-00014ea0: 2566 602e 0a20 2020 2020 2020 2020 2020  %f`..           
-00014eb0: 206c 696d 6974 3a20 4e75 6d62 6572 206f   limit: Number o
-00014ec0: 6620 636f 6d6d 6974 7320 746f 2072 6574  f commits to ret
-00014ed0: 7269 6576 652e 2044 6566 6175 6c74 7320  rieve. Defaults 
-00014ee0: 746f 2060 4e6f 6e65 602e 0a0a 2020 2020  to `None`...    
-00014ef0: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-00014f00: 2020 2020 2020 2020 2020 6044 6963 745b            `Dict[
-00014f10: 7374 722c 2044 6963 745b 7374 722c 2073  str, Dict[str, s
-00014f20: 7472 5d5d 602e 2044 6963 7469 6f6e 6172  tr]]`. Dictionar
-00014f30: 7920 6f62 6a65 6374 206f 6620 636f 6d6d  y object of comm
-00014f40: 6974 206d 6574 6164 6174 6120 7469 6d65  it metadata time
-00014f50: 6c69 6e65 2c20 7768 6572 6520 4b65 7920  line, where Key 
-00014f60: 6973 2063 6f6d 6d69 7420 6964 2061 6e64  is commit id and
-00014f70: 2076 616c 7565 0a20 2020 2020 2020 2020   value.         
-00014f80: 2020 2069 7320 6044 6963 745b 7374 722c     is `Dict[str,
-00014f90: 2073 7472 5d60 2077 6974 6820 6b65 7920   str]` with key 
-00014fa0: 7661 6c75 6520 7061 6972 7320 6f66 2064  value pairs of d
-00014fb0: 6174 6520 636f 6d6d 6974 7465 6420 6f6e  ate committed on
-00014fc0: 2c20 6e75 6d62 6572 206f 6620 726f 7773  , number of rows
-00014fd0: 2075 7064 6174 6564 2c20 696e 7365 7274   updated, insert
-00014fe0: 6564 2061 6e64 2064 656c 6574 6564 2e0a  ed and deleted..
-00014ff0: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
-00015000: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
-00015010: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
-00015020: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
-00015030: 6f72 602e 0a20 2020 2020 2020 2020 2020  or`..           
-00015040: 2060 6873 6673 2e63 6c69 656e 742e 6578   `hsfs.client.ex
-00015050: 6365 7074 696f 6e73 2e46 6561 7475 7265  ceptions.Feature
-00015060: 5374 6f72 6545 7863 6570 7469 6f6e 602e  StoreException`.
-00015070: 2049 6620 7468 6520 6665 6174 7572 6520   If the feature 
-00015080: 6772 6f75 7020 646f 6573 206e 6f74 2068  group does not h
-00015090: 6176 6520 6048 5544 4960 2074 696d 6520  ave `HUDI` time 
-000150a0: 7472 6176 656c 2066 6f72 6d61 740a 2020  travel format.  
-000150b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000150c0: 2020 7265 7475 726e 2073 656c 662e 5f66    return self._f
-000150d0: 6561 7475 7265 5f67 726f 7570 5f65 6e67  eature_group_eng
-000150e0: 696e 652e 636f 6d6d 6974 5f64 6574 6169  ine.commit_detai
-000150f0: 6c73 2873 656c 662c 2077 616c 6c63 6c6f  ls(self, wallclo
-00015100: 636b 5f74 696d 652c 206c 696d 6974 290a  ck_time, limit).
-00015110: 0a20 2020 2064 6566 2063 6f6d 6d69 745f  .    def commit_
-00015120: 6465 6c65 7465 5f72 6563 6f72 6428 0a20  delete_record(. 
-00015130: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00015140: 2020 2020 2064 656c 6574 655f 6466 3a20       delete_df: 
-00015150: 5479 7065 5661 7228 2270 7973 7061 726b  TypeVar("pyspark
-00015160: 2e73 716c 2e44 6174 6146 7261 6d65 2229  .sql.DataFrame")
-00015170: 2c20 2023 206e 6f71 613a 2046 3832 310a  ,  # noqa: F821.
-00015180: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
-00015190: 7469 6f6e 733a 204f 7074 696f 6e61 6c5b  tions: Optional[
-000151a0: 4469 6374 5b41 6e79 2c20 416e 795d 5d20  Dict[Any, Any]] 
-000151b0: 3d20 7b7d 2c0a 2020 2020 293a 0a20 2020  = {},.    ):.   
-000151c0: 2020 2020 2022 2222 4472 6f70 7320 7265       """Drops re
-000151d0: 636f 7264 7320 7072 6573 656e 7420 696e  cords present in
-000151e0: 2074 6865 2070 726f 7669 6465 6420 4461   the provided Da
-000151f0: 7461 4672 616d 6520 616e 6420 636f 6d6d  taFrame and comm
-00015200: 6974 7320 6974 2061 7320 7570 6461 7465  its it as update
-00015210: 2074 6f20 7468 6973 0a20 2020 2020 2020   to this.       
-00015220: 2046 6561 7475 7265 2067 726f 7570 2e20   Feature group. 
-00015230: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
-00015240: 6f6e 6c79 2062 6520 7573 6564 206f 6e20  only be used on 
-00015250: 7469 6d65 2074 7261 7665 6c20 656e 6162  time travel enab
-00015260: 6c65 6420 6665 6174 7572 6520 6772 6f75  led feature grou
-00015270: 7073 2e0a 0a20 2020 2020 2020 2023 2041  ps...        # A
-00015280: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
-00015290: 2020 2020 2064 656c 6574 655f 6466 3a20       delete_df: 
-000152a0: 6461 7461 4672 616d 6520 636f 6e74 6169  dataFrame contai
-000152b0: 6e69 6e67 2072 6563 6f72 6473 2074 6f20  ning records to 
-000152c0: 6265 2064 656c 6574 6564 2e0a 2020 2020  be deleted..    
-000152d0: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
-000152e0: 7469 6f6e 733a 2055 7365 7220 7072 6f76  tions: User prov
-000152f0: 6964 6564 2077 7269 7465 206f 7074 696f  ided write optio
-00015300: 6e73 2e20 4465 6661 756c 7473 2074 6f20  ns. Defaults to 
-00015310: 607b 7d60 2e0a 0a20 2020 2020 2020 2023  `{}`...        #
-00015320: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
-00015330: 2020 2020 6068 7366 732e 636c 6965 6e74      `hsfs.client
-00015340: 2e65 7863 6570 7469 6f6e 732e 5265 7374  .exceptions.Rest
-00015350: 4150 4945 7272 6f72 602e 0a20 2020 2020  APIError`..     
-00015360: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
-00015370: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
-00015380: 7570 5f65 6e67 696e 652e 636f 6d6d 6974  up_engine.commit
-00015390: 5f64 656c 6574 6528 7365 6c66 2c20 6465  _delete(self, de
-000153a0: 6c65 7465 5f64 662c 2077 7269 7465 5f6f  lete_df, write_o
-000153b0: 7074 696f 6e73 290a 0a20 2020 2064 6566  ptions)..    def
-000153c0: 2061 735f 6f66 280a 2020 2020 2020 2020   as_of(.        
-000153d0: 7365 6c66 2c0a 2020 2020 2020 2020 7761  self,.        wa
-000153e0: 6c6c 636c 6f63 6b5f 7469 6d65 3a20 4f70  llclock_time: Op
-000153f0: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
-00015400: 2c20 696e 742c 2064 6174 6574 696d 652c  , int, datetime,
-00015410: 2064 6174 655d 5d20 3d20 4e6f 6e65 2c0a   date]] = None,.
-00015420: 2020 2020 2020 2020 6578 636c 7564 655f          exclude_
-00015430: 756e 7469 6c3a 204f 7074 696f 6e61 6c5b  until: Optional[
-00015440: 556e 696f 6e5b 7374 722c 2069 6e74 2c20  Union[str, int, 
-00015450: 6461 7465 7469 6d65 2c20 6461 7465 5d5d  datetime, date]]
-00015460: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-00015470: 2020 2020 2020 2020 2222 2247 6574 2051          """Get Q
-00015480: 7565 7279 206f 626a 6563 7420 746f 2072  uery object to r
-00015490: 6574 7269 6576 6520 616c 6c20 6665 6174  etrieve all feat
-000154a0: 7572 6573 206f 6620 7468 6520 6772 6f75  ures of the grou
-000154b0: 7020 6174 2061 2070 6f69 6e74 2069 6e20  p at a point in 
-000154c0: 7468 6520 7061 7374 2e0a 0a20 2020 2020  the past...     
-000154d0: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
-000154e0: 656c 6563 7473 2061 6c6c 2066 6561 7475  elects all featu
-000154f0: 7265 7320 696e 2074 6865 2066 6561 7475  res in the featu
-00015500: 7265 2067 726f 7570 2061 6e64 2072 6574  re group and ret
-00015510: 7572 6e73 2061 2051 7565 7279 206f 626a  urns a Query obj
-00015520: 6563 740a 2020 2020 2020 2020 6174 2074  ect.        at t
-00015530: 6865 2073 7065 6369 6669 6564 2070 6f69  he specified poi
-00015540: 6e74 2069 6e20 7469 6d65 2e20 4f70 7469  nt in time. Opti
-00015550: 6f6e 616c 6c79 2c20 636f 6d6d 6974 7320  onally, commits 
-00015560: 6265 666f 7265 2061 2073 7065 6369 6669  before a specifi
-00015570: 6564 2070 6f69 6e74 2069 6e20 7469 6d65  ed point in time
-00015580: 2063 616e 2062 650a 2020 2020 2020 2020   can be.        
-00015590: 6578 636c 7564 6564 2066 726f 6d20 7468  excluded from th
-000155a0: 6520 7175 6572 792e 2054 6865 2051 7565  e query. The Que
-000155b0: 7279 2063 616e 2074 6865 6e20 6569 7468  ry can then eith
-000155c0: 6572 2062 6520 7265 6164 2069 6e74 6f20  er be read into 
-000155d0: 6120 4461 7461 6672 616d 650a 2020 2020  a Dataframe.    
-000155e0: 2020 2020 6f72 2075 7365 6420 6675 7274      or used furt
-000155f0: 6865 7220 746f 2070 6572 666f 726d 206a  her to perform j
-00015600: 6f69 6e73 206f 7220 636f 6e73 7472 7563  oins or construc
-00015610: 7420 6120 7472 6169 6e69 6e67 2064 6174  t a training dat
-00015620: 6173 6574 2e0a 0a20 2020 2020 2020 2021  aset...        !
-00015630: 2121 2065 7861 6d70 6c65 2022 5265 6164  !! example "Read
-00015640: 696e 6720 6665 6174 7572 6573 2061 7420  ing features at 
-00015650: 6120 7370 6563 6966 6963 2070 6f69 6e74  a specific point
-00015660: 2069 6e20 7469 6d65 3a22 0a20 2020 2020   in time:".     
-00015670: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-00015680: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00015690: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-000156a0: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-000156b0: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-000156c0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000156d0: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
-000156e0: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
-000156f0: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
-00015700: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
-00015710: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
-00015720: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
-00015730: 2023 2067 6574 2064 6174 6120 6174 2061   # get data at a
-00015740: 2073 7065 6369 6669 6320 706f 696e 7420   specific point 
-00015750: 696e 2074 696d 6520 616e 6420 7368 6f77  in time and show
-00015760: 2069 740a 2020 2020 2020 2020 2020 2020   it.            
-00015770: 6667 2e61 735f 6f66 2822 3230 3230 2d31  fg.as_of("2020-1
-00015780: 302d 3230 2030 373a 3334 3a31 3122 292e  0-20 07:34:11").
-00015790: 7265 6164 2829 2e73 686f 7728 290a 2020  read().show().  
-000157a0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
-000157b0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
-000157c0: 6c65 2022 5265 6164 696e 6720 636f 6d6d  le "Reading comm
-000157d0: 6974 7320 696e 6372 656d 656e 7461 6c6c  its incrementall
-000157e0: 7920 6265 7477 6565 6e20 7370 6563 6966  y between specif
-000157f0: 6965 6420 706f 696e 7473 2069 6e20 7469  ied points in ti
-00015800: 6d65 3a22 0a20 2020 2020 2020 2020 2020  me:".           
-00015810: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-00015820: 2020 2020 2020 2066 672e 6173 5f6f 6628         fg.as_of(
-00015830: 2232 3032 302d 3130 2d32 3020 3037 3a33  "2020-10-20 07:3
-00015840: 343a 3131 222c 2065 7863 6c75 6465 5f75  4:11", exclude_u
-00015850: 6e74 696c 3d22 3230 3230 2d31 302d 3139  ntil="2020-10-19
-00015860: 2030 373a 3334 3a31 3122 292e 7265 6164   07:34:11").read
-00015870: 2829 2e73 686f 7728 290a 2020 2020 2020  ().show().      
-00015880: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
-00015890: 2020 2054 6865 2066 6972 7374 2070 6172     The first par
-000158a0: 616d 6574 6572 2069 7320 696e 636c 7573  ameter is inclus
-000158b0: 6976 6520 7768 696c 6520 7468 6520 6c61  ive while the la
-000158c0: 7474 6572 2069 7320 6578 636c 7573 6976  tter is exclusiv
-000158d0: 652e 0a20 2020 2020 2020 2054 6861 7420  e..        That 
-000158e0: 6d65 616e 732c 2069 6e20 6f72 6465 7220  means, in order 
-000158f0: 746f 2071 7565 7279 2061 2073 696e 676c  to query a singl
-00015900: 6520 636f 6d6d 6974 2c20 796f 7520 6e65  e commit, you ne
-00015910: 6564 2074 6f20 7175 6572 7920 7468 6174  ed to query that
-00015920: 2063 6f6d 6d69 7420 7469 6d65 0a20 2020   commit time.   
-00015930: 2020 2020 2061 6e64 2065 7863 6c75 6465       and exclude
-00015940: 2065 7665 7279 7468 696e 6720 6a75 7374   everything just
-00015950: 2062 6566 6f72 6520 7468 6520 636f 6d6d   before the comm
-00015960: 6974 2e0a 0a20 2020 2020 2020 2021 2121  it...        !!!
-00015970: 2065 7861 6d70 6c65 2022 5265 6164 696e   example "Readin
-00015980: 6720 6f6e 6c79 2074 6865 2063 6861 6e67  g only the chang
-00015990: 6573 2066 726f 6d20 6120 7369 6e67 6c65  es from a single
-000159a0: 2063 6f6d 6d69 7422 0a20 2020 2020 2020   commit".       
-000159b0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
-000159c0: 2020 2020 2020 2020 2020 2066 672e 6173             fg.as
-000159d0: 5f6f 6628 2232 3032 302d 3130 2d32 3020  _of("2020-10-20 
-000159e0: 3037 3a33 313a 3338 222c 2065 7863 6c75  07:31:38", exclu
-000159f0: 6465 5f75 6e74 696c 3d22 3230 3230 2d31  de_until="2020-1
-00015a00: 302d 3230 2030 373a 3331 3a33 3722 292e  0-20 07:31:37").
-00015a10: 7265 6164 2829 2e73 686f 7728 290a 2020  read().show().  
-00015a20: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
-00015a30: 2020 2020 2020 2057 6865 6e20 6e6f 2077         When no w
-00015a40: 616c 6c63 6c6f 636b 5f74 696d 6520 6973  allclock_time is
-00015a50: 2067 6976 656e 2c20 7468 6520 6c61 7465   given, the late
-00015a60: 7374 2073 7461 7465 206f 6620 6665 6174  st state of feat
-00015a70: 7572 6573 2069 7320 7265 7475 726e 6564  ures is returned
-00015a80: 2e20 4f70 7469 6f6e 616c 6c79 2c20 636f  . Optionally, co
-00015a90: 6d6d 6974 7320 6265 666f 7265 0a20 2020  mmits before.   
-00015aa0: 2020 2020 2061 2073 7065 6369 6669 6564       a specified
-00015ab0: 2070 6f69 6e74 2069 6e20 7469 6d65 2063   point in time c
-00015ac0: 616e 2073 7469 6c6c 2062 6520 6578 636c  an still be excl
-00015ad0: 7564 6564 2e0a 0a20 2020 2020 2020 2021  uded...        !
-00015ae0: 2121 2065 7861 6d70 6c65 2022 5265 6164  !! example "Read
-00015af0: 696e 6720 7468 6520 6c61 7465 7374 2073  ing the latest s
-00015b00: 7461 7465 206f 6620 6665 6174 7572 6573  tate of features
-00015b10: 2c20 6578 636c 7564 696e 6720 636f 6d6d  , excluding comm
-00015b20: 6974 7320 6265 666f 7265 2061 2073 7065  its before a spe
-00015b30: 6369 6669 6564 2070 6f69 6e74 2069 6e20  cified point in 
-00015b40: 7469 6d65 3a22 0a20 2020 2020 2020 2020  time:".         
-00015b50: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-00015b60: 2020 2020 2020 2020 2066 672e 6173 5f6f           fg.as_o
-00015b70: 6628 4e6f 6e65 2c20 6578 636c 7564 655f  f(None, exclude_
-00015b80: 756e 7469 6c3d 2232 3032 302d 3130 2d32  until="2020-10-2
-00015b90: 3020 3037 3a33 313a 3338 2229 2e72 6561  0 07:31:38").rea
-00015ba0: 6428 292e 7368 6f77 2829 0a20 2020 2020  d().show().     
-00015bb0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-00015bc0: 2020 2020 4e6f 7465 2074 6861 7420 7468      Note that th
-00015bd0: 6520 696e 7465 7276 616c 2077 696c 6c20  e interval will 
-00015be0: 6265 2061 7070 6c69 6564 2074 6f20 616c  be applied to al
-00015bf0: 6c20 6a6f 696e 7320 696e 2074 6865 2071  l joins in the q
-00015c00: 7565 7279 2e0a 2020 2020 2020 2020 4966  uery..        If
-00015c10: 2079 6f75 2077 616e 7420 746f 2071 7565   you want to que
-00015c20: 7279 2064 6966 6665 7265 6e74 2069 6e74  ry different int
-00015c30: 6572 7661 6c73 2066 6f72 2064 6966 6665  ervals for diffe
-00015c40: 7265 6e74 2066 6561 7475 7265 2067 726f  rent feature gro
-00015c50: 7570 7320 696e 0a20 2020 2020 2020 2074  ups in.        t
-00015c60: 6865 2071 7565 7279 2c20 796f 7520 6861  he query, you ha
-00015c70: 7665 2074 6f20 6170 706c 7920 7468 656d  ve to apply them
-00015c80: 2069 6e20 6120 6e65 7374 6564 2066 6173   in a nested fas
-00015c90: 6869 6f6e 3a0a 2020 2020 2020 2020 2121  hion:.        !!
-00015ca0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-00015cb0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-00015cc0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-00015cd0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
-00015ce0: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
-00015cf0: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
-00015d00: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
-00015d10: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
-00015d20: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
-00015d30: 2020 2020 2020 2020 2020 6667 3120 3d20            fg1 = 
-00015d40: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
-00015d50: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
-00015d60: 2e2e 290a 2020 2020 2020 2020 2020 2020  ..).            
-00015d70: 6667 3220 3d20 6673 2e67 6574 5f6f 725f  fg2 = fs.get_or_
-00015d80: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-00015d90: 726f 7570 282e 2e2e 290a 0a20 2020 2020  roup(...)..     
-00015da0: 2020 2020 2020 2066 6731 2e73 656c 6563         fg1.selec
-00015db0: 745f 616c 6c28 292e 6173 5f6f 6628 2232  t_all().as_of("2
-00015dc0: 3032 302d 3130 2d32 3022 2c20 6578 636c  020-10-20", excl
-00015dd0: 7564 655f 756e 7469 6c3d 2232 3032 302d  ude_until="2020-
-00015de0: 3130 2d31 3922 290a 2020 2020 2020 2020  10-19").        
-00015df0: 2020 2020 2020 2020 2e6a 6f69 6e28 6667          .join(fg
-00015e00: 322e 7365 6c65 6374 5f61 6c6c 2829 2e61  2.select_all().a
-00015e10: 735f 6f66 2822 3230 3230 2d31 302d 3230  s_of("2020-10-20
-00015e20: 222c 2065 7863 6c75 6465 5f75 6e74 696c  ", exclude_until
-00015e30: 3d22 3230 3230 2d31 302d 3139 2229 290a  ="2020-10-19")).
-00015e40: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00015e50: 0a20 2020 2020 2020 2049 6620 696e 7374  .        If inst
-00015e60: 6561 6420 796f 7520 6170 706c 7920 616e  ead you apply an
-00015e70: 6f74 6865 7220 6061 735f 6f66 6020 7365  other `as_of` se
-00015e80: 6c65 6374 696f 6e20 6166 7465 7220 7468  lection after th
-00015e90: 6520 6a6f 696e 2c20 616c 6c0a 2020 2020  e join, all.    
-00015ea0: 2020 2020 6a6f 696e 6564 2066 6561 7475      joined featu
-00015eb0: 7265 2067 726f 7570 7320 7769 6c6c 2062  re groups will b
-00015ec0: 6520 7175 6572 6965 6420 7769 7468 2074  e queried with t
-00015ed0: 6869 7320 696e 7465 7276 616c 3a0a 2020  his interval:.  
-00015ee0: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
-00015ef0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
-00015f00: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-00015f10: 2020 2020 6667 312e 7365 6c65 6374 5f61      fg1.select_a
-00015f20: 6c6c 2829 2e61 735f 6f66 2822 3230 3230  ll().as_of("2020
-00015f30: 2d31 302d 3230 222c 2065 7863 6c75 6465  -10-20", exclude
-00015f40: 5f75 6e74 696c 3d22 3230 3230 2d31 302d  _until="2020-10-
-00015f50: 3139 2229 2020 2320 6173 5f6f 6620 6973  19")  # as_of is
-00015f60: 206e 6f74 2061 7070 6c69 6564 0a20 2020   not applied.   
-00015f70: 2020 2020 2020 2020 2020 2020 202e 6a6f               .jo
-00015f80: 696e 2866 6732 2e73 656c 6563 745f 616c  in(fg2.select_al
-00015f90: 6c28 292e 6173 5f6f 6628 2232 3032 302d  l().as_of("2020-
-00015fa0: 3130 2d32 3022 2c20 6578 636c 7564 655f  10-20", exclude_
-00015fb0: 756e 7469 6c3d 2232 3032 302d 3130 2d31  until="2020-10-1
-00015fc0: 3522 2929 2020 2320 6173 5f6f 6620 6973  5"))  # as_of is
-00015fd0: 206e 6f74 2061 7070 6c69 6564 0a20 2020   not applied.   
-00015fe0: 2020 2020 2020 2020 2020 2020 202e 6173               .as
-00015ff0: 5f6f 6628 2232 3032 302d 3130 2d32 3022  _of("2020-10-20"
-00016000: 2c20 6578 636c 7564 655f 756e 7469 6c3d  , exclude_until=
-00016010: 2232 3032 302d 3130 2d31 3922 290a 2020  "2020-10-19").  
-00016020: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
-00016030: 2020 2020 2020 2021 2121 2077 6172 6e69         !!! warni
-00016040: 6e67 0a20 2020 2020 2020 2020 2020 2054  ng.            T
-00016050: 6869 7320 6675 6e63 7469 6f6e 206f 6e6c  his function onl
-00016060: 7920 776f 726b 7320 666f 7220 6665 6174  y works for feat
-00016070: 7572 6520 6772 6f75 7073 2077 6974 6820  ure groups with 
-00016080: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
-00016090: 6174 3d27 4855 4449 272e 0a0a 2020 2020  at='HUDI'...    
-000160a0: 2020 2020 2121 2120 7761 726e 696e 670a      !!! warning.
-000160b0: 2020 2020 2020 2020 2020 2020 4578 636c              Excl
-000160c0: 7564 696e 6720 636f 6d6d 6974 7320 7669  uding commits vi
-000160d0: 6120 6578 636c 7564 655f 756e 7469 6c20  a exclude_until 
-000160e0: 6973 206f 6e6c 7920 706f 7373 6962 6c65  is only possible
-000160f0: 2077 6974 6869 6e20 7468 6520 7261 6e67   within the rang
-00016100: 6520 6f66 2074 6865 2048 7564 6920 6163  e of the Hudi ac
-00016110: 7469 7665 2074 696d 656c 696e 652e 0a20  tive timeline.. 
-00016120: 2020 2020 2020 2020 2020 2042 7920 6465             By de
-00016130: 6661 756c 742c 2048 7564 6920 6b65 6570  fault, Hudi keep
-00016140: 7320 7468 6520 6c61 7374 2032 3020 746f  s the last 20 to
-00016150: 2033 3020 636f 6d6d 6974 7320 696e 2074   30 commits in t
-00016160: 6865 2061 6374 6976 6520 7469 6d65 6c69  he active timeli
-00016170: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
-00016180: 4966 2079 6f75 206e 6565 6420 746f 206b  If you need to k
-00016190: 6565 7020 6120 6c6f 6e67 6572 2061 6374  eep a longer act
-000161a0: 6976 6520 7469 6d65 6c69 6e65 2c20 796f  ive timeline, yo
-000161b0: 7520 6361 6e20 6f76 6572 7772 6974 6520  u can overwrite 
-000161c0: 7468 6520 6f70 7469 6f6e 733a 0a20 2020  the options:.   
-000161d0: 2020 2020 2020 2020 2060 686f 6f64 6965           `hoodie
-000161e0: 2e6b 6565 702e 6d69 6e2e 636f 6d6d 6974  .keep.min.commit
-000161f0: 7360 2061 6e64 2060 686f 6f64 6965 2e6b  s` and `hoodie.k
-00016200: 6565 702e 6d61 782e 636f 6d6d 6974 7360  eep.max.commits`
-00016210: 0a20 2020 2020 2020 2020 2020 2077 6865  .            whe
-00016220: 6e20 6361 6c6c 696e 6720 7468 6520 6069  n calling the `i
-00016230: 6e73 6572 7428 2960 206d 6574 686f 642e  nsert()` method.
-00016240: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-00016250: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00016260: 2020 7761 6c6c 636c 6f63 6b5f 7469 6d65    wallclock_time
-00016270: 3a20 5265 6164 2064 6174 6120 6173 206f  : Read data as o
-00016280: 6620 7468 6973 2070 6f69 6e74 2069 6e20  f this point in 
-00016290: 7469 6d65 2e20 5374 7269 6e67 7320 7368  time. Strings sh
-000162a0: 6f75 6c64 2062 6520 666f 726d 6174 7465  ould be formatte
-000162b0: 6420 696e 206f 6e65 206f 6620 7468 650a  d in one of the.
-000162c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162d0: 666f 6c6c 6f77 696e 6720 666f 726d 6174  following format
-000162e0: 7320 6025 592d 256d 2d25 6460 2c20 6025  s `%Y-%m-%d`, `%
-000162f0: 592d 256d 2d25 6420 2548 602c 2060 2559  Y-%m-%d %H`, `%Y
-00016300: 2d25 6d2d 2564 2025 483a 254d 602c 206f  -%m-%d %H:%M`, o
-00016310: 7220 6025 592d 256d 2d25 6420 2548 3a25  r `%Y-%m-%d %H:%
-00016320: 4d3a 2553 602e 0a20 2020 2020 2020 2020  M:%S`..         
-00016330: 2020 2065 7863 6c75 6465 5f75 6e74 696c     exclude_until
-00016340: 3a20 4578 636c 7564 6520 636f 6d6d 6974  : Exclude commit
-00016350: 7320 756e 7469 6c20 7468 6973 2070 6f69  s until this poi
-00016360: 6e74 2069 6e20 7469 6d65 2e20 5374 7269  nt in time. Stri
-00016370: 6e67 2073 686f 756c 6420 6265 2066 6f72  ng should be for
-00016380: 6d61 7474 6564 2069 6e20 6f6e 6520 6f66  matted in one of
-00016390: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-000163a0: 2020 2020 2066 6f6c 6c6f 7769 6e67 2066       following f
-000163b0: 6f72 6d61 7473 2060 2559 2d25 6d2d 2564  ormats `%Y-%m-%d
-000163c0: 602c 2060 2559 2d25 6d2d 2564 2025 4860  `, `%Y-%m-%d %H`
-000163d0: 2c20 6025 592d 256d 2d25 6420 2548 3a25  , `%Y-%m-%d %H:%
-000163e0: 4d60 2c20 6f72 2060 2559 2d25 6d2d 2564  M`, or `%Y-%m-%d
-000163f0: 2025 483a 254d 3a25 5360 2e0a 0a20 2020   %H:%M:%S`...   
-00016400: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
-00016410: 2020 2020 2020 2020 2020 2060 5175 6572             `Quer
-00016420: 7960 2e20 5468 6520 7175 6572 7920 6f62  y`. The query ob
-00016430: 6a65 6374 2077 6974 6820 7468 6520 6170  ject with the ap
-00016440: 706c 6965 6420 7469 6d65 2074 7261 7665  plied time trave
-00016450: 6c20 636f 6e64 6974 696f 6e2e 0a20 2020  l condition..   
-00016460: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00016470: 2072 6574 7572 6e20 7365 6c66 2e73 656c   return self.sel
-00016480: 6563 745f 616c 6c28 292e 6173 5f6f 6628  ect_all().as_of(
-00016490: 7761 6c6c 636c 6f63 6b5f 7469 6d65 2c20  wallclock_time, 
-000164a0: 6578 636c 7564 655f 756e 7469 6c29 0a0a  exclude_until)..
-000164b0: 2020 2020 6465 6620 636f 6d70 7574 655f      def compute_
-000164c0: 7374 6174 6973 7469 6373 280a 2020 2020  statistics(.    
-000164d0: 2020 2020 7365 6c66 2c20 7761 6c6c 636c      self, wallcl
-000164e0: 6f63 6b5f 7469 6d65 3a20 4f70 7469 6f6e  ock_time: Option
-000164f0: 616c 5b55 6e69 6f6e 5b73 7472 2c20 696e  al[Union[str, in
-00016500: 742c 2064 6174 6574 696d 652c 2064 6174  t, datetime, dat
-00016510: 655d 5d20 3d20 4e6f 6e65 0a20 2020 2029  e]] = None.    )
-00016520: 3a0a 2020 2020 2020 2020 2222 2252 6563  :.        """Rec
-00016530: 6f6d 7075 7465 2074 6865 2073 7461 7469  ompute the stati
-00016540: 7374 6963 7320 666f 7220 7468 6520 6665  stics for the fe
-00016550: 6174 7572 6520 6772 6f75 7020 616e 6420  ature group and 
-00016560: 7361 7665 2074 6865 6d20 746f 2074 6865  save them to the
-00016570: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00016580: 2073 746f 7265 2e0a 0a20 2020 2020 2020   store...       
-00016590: 2053 7461 7469 7374 6963 7320 6172 6520   Statistics are 
-000165a0: 6f6e 6c79 2063 6f6d 7075 7465 6420 666f  only computed fo
-000165b0: 7220 6461 7461 2069 6e20 7468 6520 6f66  r data in the of
-000165c0: 666c 696e 6520 7374 6f72 6167 6520 6f66  fline storage of
-000165d0: 2074 6865 2066 6561 7475 7265 0a20 2020   the feature.   
-000165e0: 2020 2020 2067 726f 7570 2e0a 0a20 2020       group...   
-000165f0: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
-00016600: 0a20 2020 2020 2020 2020 2020 2077 616c  .            wal
-00016610: 6c63 6c6f 636b 5f74 696d 653a 2049 6620  lclock_time: If 
-00016620: 7370 6563 6966 6965 6420 7769 6c6c 2072  specified will r
-00016630: 6563 6f6d 7075 7465 2073 7461 7469 7374  ecompute statist
-00016640: 6963 7320 6f6e 0a20 2020 2020 2020 2020  ics on.         
-00016650: 2020 2020 2020 2066 6561 7475 7265 2067         feature g
-00016660: 726f 7570 2061 7320 6f66 2073 7065 6369  roup as of speci
-00016670: 6669 6320 706f 696e 7420 696e 2074 696d  fic point in tim
-00016680: 652e 2049 6620 6e6f 7420 7370 6563 6966  e. If not specif
-00016690: 6965 6420 7468 656e 2077 696c 6c20 636f  ied then will co
-000166a0: 6d70 7574 6520 7374 6174 6973 7469 6373  mpute statistics
-000166b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000166c0: 2061 7320 6f66 206d 6f73 7420 7265 6365   as of most rece
-000166d0: 6e74 2074 696d 6520 6f66 2074 6869 7320  nt time of this 
-000166e0: 6665 6174 7572 6520 6772 6f75 702e 2044  feature group. D
-000166f0: 6566 6175 6c74 7320 746f 2060 4e6f 6e65  efaults to `None
-00016700: 602e 2053 7472 696e 6773 2073 686f 756c  `. Strings shoul
-00016710: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00016720: 2020 6265 2066 6f72 6d61 7474 6564 2069    be formatted i
-00016730: 6e20 6f6e 6520 6f66 2074 6865 2066 6f6c  n one of the fol
-00016740: 6c6f 7769 6e67 2066 6f72 6d61 7473 2060  lowing formats `
-00016750: 2559 2d25 6d2d 2564 602c 2060 2559 2d25  %Y-%m-%d`, `%Y-%
-00016760: 6d2d 2564 2025 4860 2c20 6025 592d 256d  m-%d %H`, `%Y-%m
-00016770: 2d25 6420 2548 3a25 4d60 2c20 6025 592d  -%d %H:%M`, `%Y-
-00016780: 256d 2d25 6420 2548 3a25 4d3a 2553 602c  %m-%d %H:%M:%S`,
-00016790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000167a0: 206f 7220 6025 592d 256d 2d25 6420 2548   or `%Y-%m-%d %H
-000167b0: 3a25 4d3a 2553 2e25 6660 2e0a 0a20 2020  :%M:%S.%f`...   
-000167c0: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
-000167d0: 2020 2020 2020 2020 2020 2060 5374 6174             `Stat
-000167e0: 6973 7469 6373 602e 2054 6865 2073 7461  istics`. The sta
-000167f0: 7469 7374 6963 7320 6d65 7461 6461 7461  tistics metadata
-00016800: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
-00016810: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
-00016820: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-00016830: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
-00016840: 6573 7441 5049 4572 726f 7260 2e20 556e  estAPIError`. Un
-00016850: 6162 6c65 2074 6f20 7065 7273 6973 7420  able to persist 
-00016860: 7468 6520 7374 6174 6973 7469 6373 2e0a  the statistics..
-00016870: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00016880: 2020 2020 6966 2073 656c 662e 7374 6174      if self.stat
-00016890: 6973 7469 6373 5f63 6f6e 6669 672e 656e  istics_config.en
-000168a0: 6162 6c65 643a 0a20 2020 2020 2020 2020  abled:.         
-000168b0: 2020 2023 2044 6f6e 2774 2072 6561 6420     # Don't read 
-000168c0: 7468 6520 6461 7461 6672 616d 6520 6865  the dataframe he
-000168d0: 7265 2c20 746f 2061 766f 6964 2074 7269  re, to avoid tri
-000168e0: 6767 6572 696e 6720 6120 7265 6164 206f  ggering a read o
-000168f0: 7065 7261 7469 6f6e 0a20 2020 2020 2020  peration.       
-00016900: 2020 2020 2023 2066 6f72 2074 6865 2050       # for the P
-00016910: 7974 686f 6e20 656e 6769 6e65 2e20 5468  ython engine. Th
-00016920: 6520 5079 7468 6f6e 2065 6e67 696e 6520  e Python engine 
-00016930: 6973 2067 6f69 6e67 2074 6f20 7365 7475  is going to setu
-00016940: 7020 6120 5370 6172 6b20 4a6f 620a 2020  p a Spark Job.  
-00016950: 2020 2020 2020 2020 2020 2320 746f 2075            # to u
-00016960: 7064 6174 6520 7468 6520 7374 6174 6973  pdate the statis
-00016970: 7469 6373 2e0a 0a20 2020 2020 2020 2020  tics...         
-00016980: 2020 2066 675f 636f 6d6d 6974 5f69 6420     fg_commit_id 
-00016990: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-000169a0: 2020 2069 6620 7761 6c6c 636c 6f63 6b5f     if wallclock_
-000169b0: 7469 6d65 2069 7320 6e6f 7420 4e6f 6e65  time is not None
-000169c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000169d0: 2020 2320 5265 7472 6965 7665 2066 6720    # Retrieve fg 
-000169e0: 636f 6d6d 6974 2069 6420 7265 6c61 7465  commit id relate
-000169f0: 6420 746f 2074 6869 7320 7761 6c6c 2063  d to this wall c
-00016a00: 6c6f 636b 2074 696d 6520 616e 6420 7265  lock time and re
-00016a10: 636f 6d70 7574 6520 7374 6174 6973 7469  compute statisti
-00016a20: 6373 2e20 4974 2077 696c 6c20 7468 726f  cs. It will thro
-00016a30: 770a 2020 2020 2020 2020 2020 2020 2020  w.              
-00016a40: 2020 2320 6578 6365 7074 696f 6e20 6966    # exception if
-00016a50: 2069 7473 206e 6f74 2074 696d 6520 7472   its not time tr
-00016a60: 6176 656c 2065 6e61 626c 6564 2066 6561  avel enabled fea
-00016a70: 7475 7265 2067 726f 7570 2e0a 2020 2020  ture group..    
-00016a80: 2020 2020 2020 2020 2020 2020 6667 5f63              fg_c
-00016a90: 6f6d 6d69 745f 6964 203d 205b 0a20 2020  ommit_id = [.   
-00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ab0: 2063 6f6d 6d69 745f 6964 0a20 2020 2020   commit_id.     
-00016ac0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00016ad0: 6f72 2063 6f6d 6d69 745f 6964 2069 6e20  or commit_id in 
-00016ae0: 7365 6c66 2e5f 6665 6174 7572 655f 6772  self._feature_gr
-00016af0: 6f75 705f 656e 6769 6e65 2e63 6f6d 6d69  oup_engine.commi
-00016b00: 745f 6465 7461 696c 7328 0a20 2020 2020  t_details(.     
-00016b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b20: 2020 2073 656c 662c 2077 616c 6c63 6c6f     self, wallclo
-00016b30: 636b 5f74 696d 652c 2031 0a20 2020 2020  ck_time, 1.     
-00016b40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00016b50: 2e6b 6579 7328 290a 2020 2020 2020 2020  .keys().        
-00016b60: 2020 2020 2020 2020 5d5b 305d 0a0a 2020          ][0]..  
-00016b70: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00016b80: 2073 656c 662e 5f73 7461 7469 7374 6963   self._statistic
-00016b90: 735f 656e 6769 6e65 2e63 6f6d 7075 7465  s_engine.compute
-00016ba0: 5f73 7461 7469 7374 6963 7328 0a20 2020  _statistics(.   
-00016bb0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00016bc0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
-00016bd0: 2020 2066 6561 7475 7265 5f67 726f 7570     feature_group
-00016be0: 5f63 6f6d 6d69 745f 6964 3d66 675f 636f  _commit_id=fg_co
-00016bf0: 6d6d 6974 5f69 640a 2020 2020 2020 2020  mmit_id.        
-00016c00: 2020 2020 2020 2020 6966 2066 675f 636f          if fg_co
-00016c10: 6d6d 6974 5f69 6420 6973 206e 6f74 204e  mmit_id is not N
-00016c20: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00016c30: 2020 2020 656c 7365 204e 6f6e 652c 0a20      else None,. 
-00016c40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00016c50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00016c60: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
-00016c70: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-00016c80: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00016c90: 2020 2020 2020 2020 2020 2020 2254 6865              "The
-00016ca0: 2073 7461 7469 7374 6963 7320 6172 6520   statistics are 
-00016cb0: 6e6f 7420 656e 6162 6c65 6420 6f66 2066  not enabled of f
-00016cc0: 6561 7475 7265 2067 726f 7570 2060 7b7d  eature group `{}
-00016cd0: 602c 2077 6974 6820 7665 7273 696f 6e22  `, with version"
-00016ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016cf0: 2020 2020 2022 2060 7b7d 602e 204e 6f20       " `{}`. No 
-00016d00: 7374 6174 6973 7469 6373 2063 6f6d 7075  statistics compu
-00016d10: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
-00016d20: 2020 2020 2020 292e 666f 726d 6174 2873        ).format(s
-00016d30: 656c 662e 5f6e 616d 652c 2073 656c 662e  elf._name, self.
-00016d40: 5f76 6572 7369 6f6e 292c 0a20 2020 2020  _version),.     
-00016d50: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
-00016d60: 5374 6f72 6167 6557 6172 6e69 6e67 2c0a  StorageWarning,.
-00016d70: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00016d80: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-00016d90: 2020 2020 6465 6620 6672 6f6d 5f72 6573      def from_res
-00016da0: 706f 6e73 655f 6a73 6f6e 2863 6c73 2c20  ponse_json(cls, 
-00016db0: 6a73 6f6e 5f64 6963 7429 3a0a 2020 2020  json_dict):.    
-00016dc0: 2020 2020 6a73 6f6e 5f64 6563 616d 656c      json_decamel
-00016dd0: 697a 6564 203d 2068 756d 7073 2e64 6563  ized = humps.dec
-00016de0: 616d 656c 697a 6528 6a73 6f6e 5f64 6963  amelize(json_dic
-00016df0: 7429 0a20 2020 2020 2020 2069 6620 6973  t).        if is
-00016e00: 696e 7374 616e 6365 286a 736f 6e5f 6465  instance(json_de
-00016e10: 6361 6d65 6c69 7a65 642c 2064 6963 7429  camelized, dict)
-00016e20: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00016e30: 2022 7479 7065 2220 696e 206a 736f 6e5f   "type" in json_
-00016e40: 6465 6361 6d65 6c69 7a65 643a 0a20 2020  decamelized:.   
-00016e50: 2020 2020 2020 2020 2020 2020 206a 736f               jso
-00016e60: 6e5f 6465 6361 6d65 6c69 7a65 645b 2273  n_decamelized["s
-00016e70: 7472 6561 6d22 5d20 3d20 280a 2020 2020  tream"] = (.    
-00016e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e90: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-00016ea0: 5b22 7479 7065 225d 203d 3d20 2273 7472  ["type"] == "str
-00016eb0: 6561 6d46 6561 7475 7265 4772 6f75 7044  eamFeatureGroupD
-00016ec0: 544f 220a 2020 2020 2020 2020 2020 2020  TO".            
-00016ed0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00016ee0: 2020 5f20 3d20 6a73 6f6e 5f64 6563 616d    _ = json_decam
-00016ef0: 656c 697a 6564 2e70 6f70 2822 7479 7065  elized.pop("type
-00016f00: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
-00016f10: 2020 2020 206a 736f 6e5f 6465 6361 6d65       json_decame
-00016f20: 6c69 7a65 642e 706f 7028 2276 616c 6964  lized.pop("valid
-00016f30: 6174 696f 6e5f 7479 7065 222c 204e 6f6e  ation_type", Non
-00016f40: 6529 0a20 2020 2020 2020 2020 2020 2072  e).            r
-00016f50: 6574 7572 6e20 636c 7328 2a2a 6a73 6f6e  eturn cls(**json
-00016f60: 5f64 6563 616d 656c 697a 6564 290a 2020  _decamelized).  
-00016f70: 2020 2020 2020 666f 7220 6667 2069 6e20        for fg in 
-00016f80: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-00016f90: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00016fa0: 2022 7479 7065 2220 696e 2066 673a 0a20   "type" in fg:. 
-00016fb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00016fc0: 675b 2273 7472 6561 6d22 5d20 3d20 6667  g["stream"] = fg
-00016fd0: 5b22 7479 7065 225d 203d 3d20 2273 7472  ["type"] == "str
-00016fe0: 6561 6d46 6561 7475 7265 4772 6f75 7044  eamFeatureGroupD
-00016ff0: 544f 220a 2020 2020 2020 2020 2020 2020  TO".            
-00017000: 5f20 3d20 6667 2e70 6f70 2822 7479 7065  _ = fg.pop("type
-00017010: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
-00017020: 2020 2020 2066 672e 706f 7028 2276 616c       fg.pop("val
-00017030: 6964 6174 696f 6e5f 7479 7065 222c 204e  idation_type", N
-00017040: 6f6e 6529 0a20 2020 2020 2020 2072 6574  one).        ret
-00017050: 7572 6e20 5b63 6c73 282a 2a66 6729 2066  urn [cls(**fg) f
-00017060: 6f72 2066 6720 696e 206a 736f 6e5f 6465  or fg in json_de
-00017070: 6361 6d65 6c69 7a65 645d 0a0a 2020 2020  camelized]..    
-00017080: 6465 6620 7570 6461 7465 5f66 726f 6d5f  def update_from_
-00017090: 7265 7370 6f6e 7365 5f6a 736f 6e28 7365  response_json(se
-000170a0: 6c66 2c20 6a73 6f6e 5f64 6963 7429 3a0a  lf, json_dict):.
-000170b0: 2020 2020 2020 2020 6a73 6f6e 5f64 6563          json_dec
-000170c0: 616d 656c 697a 6564 203d 2068 756d 7073  amelized = humps
-000170d0: 2e64 6563 616d 656c 697a 6528 6a73 6f6e  .decamelize(json
-000170e0: 5f64 6963 7429 0a20 2020 2020 2020 206a  _dict).        j
-000170f0: 736f 6e5f 6465 6361 6d65 6c69 7a65 645b  son_decamelized[
-00017100: 2273 7472 6561 6d22 5d20 3d20 6a73 6f6e  "stream"] = json
-00017110: 5f64 6563 616d 656c 697a 6564 5b22 7479  _decamelized["ty
-00017120: 7065 225d 203d 3d20 2273 7472 6561 6d46  pe"] == "streamF
-00017130: 6561 7475 7265 4772 6f75 7044 544f 220a  eatureGroupDTO".
-00017140: 2020 2020 2020 2020 5f20 3d20 6a73 6f6e          _ = json
-00017150: 5f64 6563 616d 656c 697a 6564 2e70 6f70  _decamelized.pop
-00017160: 2822 7479 7065 2229 0a20 2020 2020 2020  ("type").       
-00017170: 2073 656c 662e 5f5f 696e 6974 5f5f 282a   self.__init__(*
-00017180: 2a6a 736f 6e5f 6465 6361 6d65 6c69 7a65  *json_decamelize
-00017190: 6429 0a20 2020 2020 2020 2072 6574 7572  d).        retur
-000171a0: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
-000171b0: 6a73 6f6e 2873 656c 6629 3a0a 2020 2020  json(self):.    
-000171c0: 2020 2020 2222 2247 6574 2073 7065 6369      """Get speci
-000171d0: 6669 6320 4665 6174 7572 6520 4772 6f75  fic Feature Grou
-000171e0: 7020 6d65 7461 6461 7461 2069 6e20 6a73  p metadata in js
-000171f0: 6f6e 2066 6f72 6d61 742e 0a0a 2020 2020  on format...    
-00017200: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
-00017210: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-00017220: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-00017230: 2020 6667 2e6a 736f 6e28 290a 2020 2020    fg.json().    
-00017240: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-00017250: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00017260: 7265 7475 726e 206a 736f 6e2e 6475 6d70  return json.dump
-00017270: 7328 7365 6c66 2c20 636c 733d 7574 696c  s(self, cls=util
-00017280: 2e46 6561 7475 7265 5374 6f72 6545 6e63  .FeatureStoreEnc
-00017290: 6f64 6572 290a 0a20 2020 2064 6566 2074  oder)..    def t
-000172a0: 6f5f 6469 6374 2873 656c 6629 3a0a 2020  o_dict(self):.  
-000172b0: 2020 2020 2020 2222 2247 6574 2073 7472        """Get str
-000172c0: 7563 7475 7265 6420 696e 666f 2061 626f  uctured info abo
-000172d0: 7574 2073 7065 6369 6669 6320 4665 6174  ut specific Feat
-000172e0: 7572 6520 4772 6f75 7020 696e 2070 7974  ure Group in pyt
-000172f0: 686f 6e20 6469 6374 696f 6e61 7279 2066  hon dictionary f
-00017300: 6f72 6d61 742e 0a0a 2020 2020 2020 2020  ormat...        
-00017310: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
-00017320: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-00017330: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
-00017340: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
-00017350: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
-00017360: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
-00017370: 2e0a 0a20 2020 2020 2020 2020 2020 2023  ...            #
-00017380: 2067 6574 2074 6865 2046 6561 7475 7265   get the Feature
-00017390: 2047 726f 7570 2069 6e73 7461 6e63 650a   Group instance.
-000173a0: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
-000173b0: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
-000173c0: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
-000173d0: 2e2e 2e29 0a0a 2020 2020 2020 2020 2020  ...)..          
-000173e0: 2020 6667 2e74 6f5f 6469 6374 2829 0a20    fg.to_dict(). 
-000173f0: 2020 2020 2020 2020 2020 2060 6060 0a20             ```. 
-00017400: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00017410: 2020 2066 675f 6d65 7461 5f64 6963 7420     fg_meta_dict 
-00017420: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00017430: 2269 6422 3a20 7365 6c66 2e5f 6964 2c0a  "id": self._id,.
-00017440: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00017450: 6522 3a20 7365 6c66 2e5f 6e61 6d65 2c0a  e": self._name,.
-00017460: 2020 2020 2020 2020 2020 2020 2276 6572              "ver
-00017470: 7369 6f6e 223a 2073 656c 662e 5f76 6572  sion": self._ver
-00017480: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
-00017490: 2020 2264 6573 6372 6970 7469 6f6e 223a    "description":
-000174a0: 2073 656c 662e 5f64 6573 6372 6970 7469   self._descripti
-000174b0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000174c0: 226f 6e6c 696e 6545 6e61 626c 6564 223a  "onlineEnabled":
-000174d0: 2073 656c 662e 5f6f 6e6c 696e 655f 656e   self._online_en
-000174e0: 6162 6c65 642c 0a20 2020 2020 2020 2020  abled,.         
-000174f0: 2020 2022 7469 6d65 5472 6176 656c 466f     "timeTravelFo
-00017500: 726d 6174 223a 2073 656c 662e 5f74 696d  rmat": self._tim
-00017510: 655f 7472 6176 656c 5f66 6f72 6d61 742c  e_travel_format,
-00017520: 0a20 2020 2020 2020 2020 2020 2022 6665  .            "fe
-00017530: 6174 7572 6573 223a 2073 656c 662e 5f66  atures": self._f
-00017540: 6561 7475 7265 732c 0a20 2020 2020 2020  eatures,.       
-00017550: 2020 2020 2022 6665 6174 7572 6573 746f       "featuresto
-00017560: 7265 4964 223a 2073 656c 662e 5f66 6561  reId": self._fea
-00017570: 7475 7265 5f73 746f 7265 5f69 642c 0a20  ture_store_id,. 
-00017580: 2020 2020 2020 2020 2020 2022 7479 7065             "type
-00017590: 223a 2022 6361 6368 6564 4665 6174 7572  ": "cachedFeatur
-000175a0: 6567 726f 7570 4454 4f22 0a20 2020 2020  egroupDTO".     
-000175b0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-000175c0: 6c66 2e5f 7374 7265 616d 0a20 2020 2020  lf._stream.     
-000175d0: 2020 2020 2020 2065 6c73 6520 2273 7472         else "str
-000175e0: 6561 6d46 6561 7475 7265 4772 6f75 7044  eamFeatureGroupD
-000175f0: 544f 222c 0a20 2020 2020 2020 2020 2020  TO",.           
-00017600: 2022 7374 6174 6973 7469 6373 436f 6e66   "statisticsConf
-00017610: 6967 223a 2073 656c 662e 5f73 7461 7469  ig": self._stati
-00017620: 7374 6963 735f 636f 6e66 6967 2c0a 2020  stics_config,.  
-00017630: 2020 2020 2020 2020 2020 2265 7665 6e74            "event
-00017640: 5469 6d65 223a 2073 656c 662e 6576 656e  Time": self.even
-00017650: 745f 7469 6d65 2c0a 2020 2020 2020 2020  t_time,.        
-00017660: 2020 2020 2265 7870 6563 7461 7469 6f6e      "expectation
-00017670: 5375 6974 6522 3a20 7365 6c66 2e5f 6578  Suite": self._ex
-00017680: 7065 6374 6174 696f 6e5f 7375 6974 652c  pectation_suite,
-00017690: 0a20 2020 2020 2020 2020 2020 2022 7061  .            "pa
-000176a0: 7265 6e74 7322 3a20 7365 6c66 2e5f 7061  rents": self._pa
-000176b0: 7265 6e74 732c 0a20 2020 2020 2020 207d  rents,.        }
-000176c0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000176d0: 2e5f 7374 7265 616d 3a0a 2020 2020 2020  ._stream:.      
-000176e0: 2020 2020 2020 6667 5f6d 6574 615f 6469        fg_meta_di
-000176f0: 6374 5b22 6465 6c74 6153 7472 6561 6d65  ct["deltaStreame
-00017700: 724a 6f62 436f 6e66 225d 203d 2073 656c  rJobConf"] = sel
-00017710: 662e 5f64 656c 7461 7374 7265 616d 6572  f._deltastreamer
-00017720: 5f6a 6f62 636f 6e66 0a20 2020 2020 2020  _jobconf.       
-00017730: 2072 6574 7572 6e20 6667 5f6d 6574 615f   return fg_meta_
-00017740: 6469 6374 0a0a 2020 2020 6465 6620 5f67  dict..    def _g
-00017750: 6574 5f74 6162 6c65 5f6e 616d 6528 7365  et_table_name(se
-00017760: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00017770: 7572 6e20 7365 6c66 2e66 6561 7475 7265  urn self.feature
-00017780: 5f73 746f 7265 5f6e 616d 6520 2b20 222e  _store_name + ".
-00017790: 2220 2b20 7365 6c66 2e6e 616d 6520 2b20  " + self.name + 
-000177a0: 225f 2220 2b20 7374 7228 7365 6c66 2e76  "_" + str(self.v
-000177b0: 6572 7369 6f6e 290a 0a20 2020 2064 6566  ersion)..    def
-000177c0: 205f 6765 745f 6f6e 6c69 6e65 5f74 6162   _get_online_tab
-000177d0: 6c65 5f6e 616d 6528 7365 6c66 293a 0a20  le_name(self):. 
-000177e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000177f0: 6c66 2e6e 616d 6520 2b20 225f 2220 2b20  lf.name + "_" + 
-00017800: 7374 7228 7365 6c66 2e76 6572 7369 6f6e  str(self.version
-00017810: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00017820: 0a20 2020 2064 6566 2069 6428 7365 6c66  .    def id(self
-00017830: 293a 0a20 2020 2020 2020 2022 2222 4665  ):.        """Fe
-00017840: 6174 7572 6520 6772 6f75 7020 6964 2e22  ature group id."
-00017850: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00017860: 6e20 7365 6c66 2e5f 6964 0a0a 2020 2020  n self._id..    
-00017870: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00017880: 6620 6e61 6d65 2873 656c 6629 3a0a 2020  f name(self):.  
-00017890: 2020 2020 2020 2222 224e 616d 6520 6f66        """Name of
-000178a0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
-000178b0: 7570 2e22 2222 0a20 2020 2020 2020 2072  up.""".        r
-000178c0: 6574 7572 6e20 7365 6c66 2e5f 6e61 6d65  eturn self._name
-000178d0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-000178e0: 2020 2020 6465 6620 7665 7273 696f 6e28      def version(
-000178f0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00017900: 2222 5665 7273 696f 6e20 6e75 6d62 6572  ""Version number
-00017910: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00017920: 6772 6f75 702e 2222 220a 2020 2020 2020  group.""".      
-00017930: 2020 7265 7475 726e 2073 656c 662e 5f76    return self._v
-00017940: 6572 7369 6f6e 0a0a 2020 2020 4070 726f  ersion..    @pro
-00017950: 7065 7274 790a 2020 2020 6465 6620 6465  perty.    def de
-00017960: 7363 7269 7074 696f 6e28 7365 6c66 293a  scription(self):
-00017970: 0a20 2020 2020 2020 2022 2222 4465 7363  .        """Desc
-00017980: 7269 7074 696f 6e20 6f66 2074 6865 2066  ription of the f
-00017990: 6561 7475 7265 2067 726f 7570 2063 6f6e  eature group con
-000179a0: 7465 6e74 732e 2222 220a 2020 2020 2020  tents.""".      
-000179b0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-000179c0: 6573 6372 6970 7469 6f6e 0a0a 2020 2020  escription..    
-000179d0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000179e0: 6620 6665 6174 7572 6573 2873 656c 6629  f features(self)
-000179f0: 3a0a 2020 2020 2020 2020 2222 2253 6368  :.        """Sch
-00017a00: 656d 6120 696e 666f 726d 6174 696f 6e2e  ema information.
-00017a10: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00017a20: 726e 2073 656c 662e 5f66 6561 7475 7265  rn self._feature
-00017a30: 730a 0a20 2020 2040 7072 6f70 6572 7479  s..    @property
-00017a40: 0a20 2020 2064 6566 2074 696d 655f 7472  .    def time_tr
-00017a50: 6176 656c 5f66 6f72 6d61 7428 7365 6c66  avel_format(self
-00017a60: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
-00017a70: 7474 696e 6720 6f66 2074 6865 2066 6561  tting of the fea
-00017a80: 7475 7265 2067 726f 7570 2074 696d 6520  ture group time 
-00017a90: 7472 6176 656c 2066 6f72 6d61 742e 2222  travel format.""
-00017aa0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00017ab0: 2073 656c 662e 5f74 696d 655f 7472 6176   self._time_trav
-00017ac0: 656c 5f66 6f72 6d61 740a 0a20 2020 2040  el_format..    @
-00017ad0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00017ae0: 2070 6172 7469 7469 6f6e 5f6b 6579 2873   partition_key(s
-00017af0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00017b00: 224c 6973 7420 6f66 2066 6561 7475 7265  "List of feature
-00017b10: 7320 6275 696c 6469 6e67 2074 6865 2070  s building the p
-00017b20: 6172 7469 7469 6f6e 206b 6579 2e22 2222  artition key."""
-00017b30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00017b40: 7365 6c66 2e5f 7061 7274 6974 696f 6e5f  self._partition_
-00017b50: 6b65 790a 0a20 2020 2040 7072 6f70 6572  key..    @proper
-00017b60: 7479 0a20 2020 2064 6566 2068 7564 695f  ty.    def hudi_
-00017b70: 7072 6563 6f6d 6269 6e65 5f6b 6579 2873  precombine_key(s
-00017b80: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00017b90: 2246 6561 7475 7265 206e 616d 6520 7468  "Feature name th
-00017ba0: 6174 2069 7320 7468 6520 6875 6469 2070  at is the hudi p
-00017bb0: 7265 636f 6d62 696e 6520 6b65 792e 2222  recombine key.""
-00017bc0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00017bd0: 2073 656c 662e 5f68 7564 695f 7072 6563   self._hudi_prec
-00017be0: 6f6d 6269 6e65 5f6b 6579 0a0a 2020 2020  ombine_key..    
-00017bf0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00017c00: 6620 6665 6174 7572 655f 7374 6f72 655f  f feature_store_
-00017c10: 6964 2873 656c 6629 3a0a 2020 2020 2020  id(self):.      
-00017c20: 2020 7265 7475 726e 2073 656c 662e 5f66    return self._f
-00017c30: 6561 7475 7265 5f73 746f 7265 5f69 640a  eature_store_id.
-00017c40: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00017c50: 2020 2064 6566 2066 6561 7475 7265 5f73     def feature_s
-00017c60: 746f 7265 5f6e 616d 6528 7365 6c66 293a  tore_name(self):
-00017c70: 0a20 2020 2020 2020 2022 2222 4e61 6d65  .        """Name
-00017c80: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00017c90: 7374 6f72 6520 696e 2077 6869 6368 2074  store in which t
-00017ca0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-00017cb0: 2069 7320 6c6f 6361 7465 642e 2222 220a   is located.""".
-00017cc0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00017cd0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-00017ce0: 7265 5f6e 616d 650a 0a20 2020 2040 7072  re_name..    @pr
-00017cf0: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
-00017d00: 7265 6174 6f72 2873 656c 6629 3a0a 2020  reator(self):.  
-00017d10: 2020 2020 2020 2222 2255 7365 726e 616d        """Usernam
-00017d20: 6520 6f66 2074 6865 2063 7265 6174 6f72  e of the creator
-00017d30: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
-00017d40: 7572 6e20 7365 6c66 2e5f 6372 6561 746f  urn self._creato
-00017d50: 720a 0a20 2020 2040 7072 6f70 6572 7479  r..    @property
-00017d60: 0a20 2020 2064 6566 2063 7265 6174 6564  .    def created
-00017d70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00017d80: 2222 2254 696d 6573 7461 6d70 2077 6865  """Timestamp whe
-00017d90: 6e20 7468 6520 6665 6174 7572 6520 6772  n the feature gr
-00017da0: 6f75 7020 7761 7320 6372 6561 7465 642e  oup was created.
-00017db0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00017dc0: 726e 2073 656c 662e 5f63 7265 6174 6564  rn self._created
-00017dd0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00017de0: 2020 2020 6465 6620 7374 7265 616d 2873      def stream(s
-00017df0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00017e00: 2257 6865 7468 6572 2074 6f20 656e 6162  "Whether to enab
-00017e10: 6c65 2072 6561 6c20 7469 6d65 2073 7472  le real time str
-00017e20: 6561 6d20 7772 6974 696e 6720 6361 7061  eam writing capa
-00017e30: 6269 6c69 7469 6573 2e22 2222 0a20 2020  bilities.""".   
-00017e40: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00017e50: 2e5f 7374 7265 616d 0a0a 2020 2020 4070  ._stream..    @p
-00017e60: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00017e70: 7061 7265 6e74 7328 7365 6c66 293a 0a20  parents(self):. 
-00017e80: 2020 2020 2020 2022 2222 5061 7265 6e74         """Parent
-00017e90: 2066 6561 7475 7265 2067 726f 7570 7320   feature groups 
-00017ea0: 6173 206f 7269 6769 6e20 6f66 2074 6865  as origin of the
-00017eb0: 2064 6174 6120 696e 2074 6865 2063 7572   data in the cur
-00017ec0: 7265 6e74 2066 6561 7475 7265 2067 726f  rent feature gro
-00017ed0: 7570 2e0a 2020 2020 2020 2020 5468 6973  up..        This
-00017ee0: 2069 7320 7061 7274 206f 6620 6578 706c   is part of expl
-00017ef0: 6963 6974 2070 726f 7665 6e61 6e63 6522  icit provenance"
-00017f00: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00017f10: 6e20 7365 6c66 2e5f 7061 7265 6e74 730a  n self._parents.
-00017f20: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00017f30: 2020 2064 6566 2062 6163 6b66 696c 6c5f     def backfill_
-00017f40: 6a6f 6228 7365 6c66 293a 0a20 2020 2020  job(self):.     
-00017f50: 2020 2022 2222 4765 7420 7468 6520 4a6f     """Get the Jo
-00017f60: 6220 6f62 6a65 6374 2072 6566 6572 656e  b object referen
-00017f70: 6365 2066 6f72 2074 6865 2062 6163 6b66  ce for the backf
-00017f80: 696c 6c20 6a6f 6220 666f 7220 7468 6973  ill job for this
-00017f90: 0a20 2020 2020 2020 2046 6561 7475 7265  .        Feature
-00017fa0: 2047 726f 7570 2e22 2222 0a20 2020 2020   Group.""".     
-00017fb0: 2020 2069 6620 7365 6c66 2e5f 6261 636b     if self._back
-00017fc0: 6669 6c6c 5f6a 6f62 2069 7320 4e6f 6e65  fill_job is None
-00017fd0: 3a0a 2020 2020 2020 2020 2020 2020 6a6f  :.            jo
-00017fe0: 625f 6e61 6d65 203d 2022 7b66 675f 6e61  b_name = "{fg_na
-00017ff0: 6d65 7d5f 7b76 6572 7369 6f6e 7d5f 6f66  me}_{version}_of
-00018000: 666c 696e 655f 6667 5f62 6163 6b66 696c  fline_fg_backfil
-00018010: 6c22 2e66 6f72 6d61 7428 0a20 2020 2020  l".format(.     
-00018020: 2020 2020 2020 2020 2020 2066 675f 6e61             fg_na
-00018030: 6d65 3d73 656c 662e 5f6e 616d 652c 2076  me=self._name, v
-00018040: 6572 7369 6f6e 3d73 656c 662e 5f76 6572  ersion=self._ver
-00018050: 7369 6f6e 0a20 2020 2020 2020 2020 2020  sion.           
-00018060: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
-00018070: 656c 662e 5f62 6163 6b66 696c 6c5f 6a6f  elf._backfill_jo
-00018080: 6220 3d20 6a6f 625f 6170 692e 4a6f 6241  b = job_api.JobA
-00018090: 7069 2829 2e67 6574 286a 6f62 5f6e 616d  pi().get(job_nam
-000180a0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-000180b0: 6e20 7365 6c66 2e5f 6261 636b 6669 6c6c  n self._backfill
-000180c0: 5f6a 6f62 0a0a 2020 2020 4076 6572 7369  _job..    @versi
-000180d0: 6f6e 2e73 6574 7465 720a 2020 2020 6465  on.setter.    de
-000180e0: 6620 7665 7273 696f 6e28 7365 6c66 2c20  f version(self, 
-000180f0: 7665 7273 696f 6e29 3a0a 2020 2020 2020  version):.      
-00018100: 2020 7365 6c66 2e5f 7665 7273 696f 6e20    self._version 
-00018110: 3d20 7665 7273 696f 6e0a 0a20 2020 2040  = version..    @
-00018120: 6465 7363 7269 7074 696f 6e2e 7365 7474  description.sett
-00018130: 6572 0a20 2020 2064 6566 2064 6573 6372  er.    def descr
-00018140: 6970 7469 6f6e 2873 656c 662c 206e 6577  iption(self, new
-00018150: 5f64 6573 6372 6970 7469 6f6e 293a 0a20  _description):. 
-00018160: 2020 2020 2020 2073 656c 662e 5f64 6573         self._des
-00018170: 6372 6970 7469 6f6e 203d 206e 6577 5f64  cription = new_d
-00018180: 6573 6372 6970 7469 6f6e 0a0a 2020 2020  escription..    
-00018190: 4066 6561 7475 7265 732e 7365 7474 6572  @features.setter
-000181a0: 0a20 2020 2064 6566 2066 6561 7475 7265  .    def feature
-000181b0: 7328 7365 6c66 2c20 6e65 775f 6665 6174  s(self, new_feat
-000181c0: 7572 6573 293a 0a20 2020 2020 2020 2073  ures):.        s
-000181d0: 656c 662e 5f66 6561 7475 7265 7320 3d20  elf._features = 
-000181e0: 6e65 775f 6665 6174 7572 6573 0a0a 2020  new_features..  
-000181f0: 2020 4074 696d 655f 7472 6176 656c 5f66    @time_travel_f
-00018200: 6f72 6d61 742e 7365 7474 6572 0a20 2020  ormat.setter.   
-00018210: 2064 6566 2074 696d 655f 7472 6176 656c   def time_travel
-00018220: 5f66 6f72 6d61 7428 7365 6c66 2c20 6e65  _format(self, ne
-00018230: 775f 7469 6d65 5f74 7261 7665 6c5f 666f  w_time_travel_fo
-00018240: 726d 6174 293a 0a20 2020 2020 2020 2073  rmat):.        s
-00018250: 656c 662e 5f74 696d 655f 7472 6176 656c  elf._time_travel
-00018260: 5f66 6f72 6d61 7420 3d20 6e65 775f 7469  _format = new_ti
-00018270: 6d65 5f74 7261 7665 6c5f 666f 726d 6174  me_travel_format
-00018280: 0a0a 2020 2020 4070 6172 7469 7469 6f6e  ..    @partition
-00018290: 5f6b 6579 2e73 6574 7465 720a 2020 2020  _key.setter.    
-000182a0: 6465 6620 7061 7274 6974 696f 6e5f 6b65  def partition_ke
-000182b0: 7928 7365 6c66 2c20 6e65 775f 7061 7274  y(self, new_part
-000182c0: 6974 696f 6e5f 6b65 7929 3a0a 2020 2020  ition_key):.    
-000182d0: 2020 2020 7365 6c66 2e5f 7061 7274 6974      self._partit
-000182e0: 696f 6e5f 6b65 7920 3d20 5b70 6b2e 6c6f  ion_key = [pk.lo
-000182f0: 7765 7228 2920 666f 7220 706b 2069 6e20  wer() for pk in 
-00018300: 6e65 775f 7061 7274 6974 696f 6e5f 6b65  new_partition_ke
-00018310: 795d 0a0a 2020 2020 4068 7564 695f 7072  y]..    @hudi_pr
-00018320: 6563 6f6d 6269 6e65 5f6b 6579 2e73 6574  ecombine_key.set
-00018330: 7465 720a 2020 2020 6465 6620 6875 6469  ter.    def hudi
-00018340: 5f70 7265 636f 6d62 696e 655f 6b65 7928  _precombine_key(
-00018350: 7365 6c66 2c20 6875 6469 5f70 7265 636f  self, hudi_preco
-00018360: 6d62 696e 655f 6b65 7929 3a0a 2020 2020  mbine_key):.    
-00018370: 2020 2020 7365 6c66 2e5f 6875 6469 5f70      self._hudi_p
-00018380: 7265 636f 6d62 696e 655f 6b65 7920 3d20  recombine_key = 
-00018390: 6875 6469 5f70 7265 636f 6d62 696e 655f  hudi_precombine_
-000183a0: 6b65 792e 6c6f 7765 7228 290a 0a20 2020  key.lower()..   
-000183b0: 2040 7374 7265 616d 2e73 6574 7465 720a   @stream.setter.
-000183c0: 2020 2020 6465 6620 7374 7265 616d 2873      def stream(s
-000183d0: 656c 662c 2073 7472 6561 6d29 3a0a 2020  elf, stream):.  
-000183e0: 2020 2020 2020 7365 6c66 2e5f 7374 7265        self._stre
-000183f0: 616d 203d 2073 7472 6561 6d0a 0a20 2020  am = stream..   
-00018400: 2040 7061 7265 6e74 732e 7365 7474 6572   @parents.setter
-00018410: 0a20 2020 2064 6566 2070 6172 656e 7473  .    def parents
-00018420: 2873 656c 662c 206e 6577 5f70 6172 656e  (self, new_paren
-00018430: 7473 293a 0a20 2020 2020 2020 2073 656c  ts):.        sel
-00018440: 662e 5f70 6172 656e 7473 203d 206e 6577  f._parents = new
-00018450: 5f70 6172 656e 7473 0a0a 0a63 6c61 7373  _parents...class
-00018460: 2045 7874 6572 6e61 6c46 6561 7475 7265   ExternalFeature
-00018470: 4772 6f75 7028 4665 6174 7572 6547 726f  Group(FeatureGro
-00018480: 7570 4261 7365 293a 0a20 2020 2045 5854  upBase):.    EXT
-00018490: 4552 4e41 4c5f 4645 4154 5552 455f 4752  ERNAL_FEATURE_GR
-000184a0: 4f55 5020 3d20 224f 4e5f 4445 4d41 4e44  OUP = "ON_DEMAND
-000184b0: 5f46 4541 5455 5245 5f47 524f 5550 220a  _FEATURE_GROUP".
-000184c0: 2020 2020 454e 5449 5459 5f54 5950 4520      ENTITY_TYPE 
-000184d0: 3d20 2266 6561 7475 7265 6772 6f75 7073  = "featuregroups
-000184e0: 220a 0a20 2020 2064 6566 205f 5f69 6e69  "..    def __ini
-000184f0: 745f 5f28 0a20 2020 2020 2020 2073 656c  t__(.        sel
-00018500: 662c 0a20 2020 2020 2020 2073 746f 7261  f,.        stora
-00018510: 6765 5f63 6f6e 6e65 6374 6f72 2c0a 2020  ge_connector,.  
-00018520: 2020 2020 2020 7175 6572 793d 4e6f 6e65        query=None
-00018530: 2c0a 2020 2020 2020 2020 6461 7461 5f66  ,.        data_f
-00018540: 6f72 6d61 743d 4e6f 6e65 2c0a 2020 2020  ormat=None,.    
-00018550: 2020 2020 7061 7468 3d4e 6f6e 652c 0a20      path=None,. 
-00018560: 2020 2020 2020 206f 7074 696f 6e73 3d7b         options={
-00018570: 7d2c 0a20 2020 2020 2020 206e 616d 653d  },.        name=
-00018580: 4e6f 6e65 2c0a 2020 2020 2020 2020 7665  None,.        ve
-00018590: 7273 696f 6e3d 4e6f 6e65 2c0a 2020 2020  rsion=None,.    
-000185a0: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
-000185b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
-000185c0: 696d 6172 795f 6b65 793d 4e6f 6e65 2c0a  imary_key=None,.
-000185d0: 2020 2020 2020 2020 6665 6174 7572 6573          features
-000185e0: 746f 7265 5f69 643d 4e6f 6e65 2c0a 2020  tore_id=None,.  
-000185f0: 2020 2020 2020 6665 6174 7572 6573 746f        featuresto
-00018600: 7265 5f6e 616d 653d 4e6f 6e65 2c0a 2020  re_name=None,.  
-00018610: 2020 2020 2020 6372 6561 7465 643d 4e6f        created=No
-00018620: 6e65 2c0a 2020 2020 2020 2020 6372 6561  ne,.        crea
-00018630: 746f 723d 4e6f 6e65 2c0a 2020 2020 2020  tor=None,.      
-00018640: 2020 6964 3d4e 6f6e 652c 0a20 2020 2020    id=None,.     
-00018650: 2020 2066 6561 7475 7265 733d 4e6f 6e65     features=None
-00018660: 2c0a 2020 2020 2020 2020 6c6f 6361 7469  ,.        locati
-00018670: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
-00018680: 2073 7461 7469 7374 6963 735f 636f 6e66   statistics_conf
-00018690: 6967 3d4e 6f6e 652c 0a20 2020 2020 2020  ig=None,.       
-000186a0: 2065 7665 6e74 5f74 696d 653d 4e6f 6e65   event_time=None
-000186b0: 2c0a 2020 2020 2020 2020 6578 7065 6374  ,.        expect
-000186c0: 6174 696f 6e5f 7375 6974 653d 4e6f 6e65  ation_suite=None
-000186d0: 2c0a 2020 2020 2020 2020 6f6e 6c69 6e65  ,.        online
-000186e0: 5f65 6e61 626c 6564 3d46 616c 7365 2c0a  _enabled=False,.
-000186f0: 2020 2020 2020 2020 6872 6566 3d4e 6f6e          href=Non
-00018700: 652c 0a20 2020 2020 2020 206f 6e6c 696e  e,.        onlin
-00018710: 655f 746f 7069 635f 6e61 6d65 3d4e 6f6e  e_topic_name=Non
-00018720: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00018730: 2020 7375 7065 7228 292e 5f5f 696e 6974    super().__init
-00018740: 5f5f 280a 2020 2020 2020 2020 2020 2020  __(.            
-00018750: 6665 6174 7572 6573 746f 7265 5f69 642c  featurestore_id,
-00018760: 0a20 2020 2020 2020 2020 2020 206c 6f63  .            loc
-00018770: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-00018780: 2020 2065 7665 6e74 5f74 696d 653d 6576     event_time=ev
-00018790: 656e 745f 7469 6d65 2c0a 2020 2020 2020  ent_time,.      
-000187a0: 2020 2020 2020 6f6e 6c69 6e65 5f65 6e61        online_ena
-000187b0: 626c 6564 3d6f 6e6c 696e 655f 656e 6162  bled=online_enab
-000187c0: 6c65 642c 0a20 2020 2020 2020 2020 2020  led,.           
-000187d0: 2069 643d 6964 2c0a 2020 2020 2020 2020   id=id,.        
-000187e0: 2020 2020 6578 7065 6374 6174 696f 6e5f      expectation_
-000187f0: 7375 6974 653d 6578 7065 6374 6174 696f  suite=expectatio
-00018800: 6e5f 7375 6974 652c 0a20 2020 2020 2020  n_suite,.       
-00018810: 2020 2020 206f 6e6c 696e 655f 746f 7069       online_topi
-00018820: 635f 6e61 6d65 3d6f 6e6c 696e 655f 746f  c_name=online_to
-00018830: 7069 635f 6e61 6d65 2c0a 2020 2020 2020  pic_name,.      
-00018840: 2020 290a 0a20 2020 2020 2020 2073 656c    )..        sel
-00018850: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-00018860: 5f6e 616d 6520 3d20 6665 6174 7572 6573  _name = features
-00018870: 746f 7265 5f6e 616d 650a 2020 2020 2020  tore_name.      
-00018880: 2020 7365 6c66 2e5f 6465 7363 7269 7074    self._descript
-00018890: 696f 6e20 3d20 6465 7363 7269 7074 696f  ion = descriptio
-000188a0: 6e0a 2020 2020 2020 2020 7365 6c66 2e5f  n.        self._
-000188b0: 6372 6561 7465 6420 3d20 6372 6561 7465  created = create
-000188c0: 640a 2020 2020 2020 2020 7365 6c66 2e5f  d.        self._
-000188d0: 6372 6561 746f 7220 3d20 7573 6572 2e55  creator = user.U
-000188e0: 7365 722e 6672 6f6d 5f72 6573 706f 6e73  ser.from_respons
-000188f0: 655f 6a73 6f6e 2863 7265 6174 6f72 290a  e_json(creator).
-00018900: 2020 2020 2020 2020 7365 6c66 2e5f 7665          self._ve
-00018910: 7273 696f 6e20 3d20 7665 7273 696f 6e0a  rsion = version.
-00018920: 2020 2020 2020 2020 7365 6c66 2e5f 6e61          self._na
-00018930: 6d65 203d 206e 616d 650a 2020 2020 2020  me = name.      
-00018940: 2020 7365 6c66 2e5f 7175 6572 7920 3d20    self._query = 
-00018950: 7175 6572 790a 2020 2020 2020 2020 7365  query.        se
-00018960: 6c66 2e5f 6461 7461 5f66 6f72 6d61 7420  lf._data_format 
-00018970: 3d20 6461 7461 5f66 6f72 6d61 742e 7570  = data_format.up
-00018980: 7065 7228 2920 6966 2064 6174 615f 666f  per() if data_fo
-00018990: 726d 6174 2065 6c73 6520 4e6f 6e65 0a20  rmat else None. 
-000189a0: 2020 2020 2020 2073 656c 662e 5f70 6174         self._pat
-000189b0: 6820 3d20 7061 7468 0a0a 2020 2020 2020  h = path..      
-000189c0: 2020 7365 6c66 2e5f 6665 6174 7572 6573    self._features
-000189d0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-000189e0: 2066 6561 7475 7265 2e46 6561 7475 7265   feature.Feature
-000189f0: 2e66 726f 6d5f 7265 7370 6f6e 7365 5f6a  .from_response_j
-00018a00: 736f 6e28 6665 6174 2920 6966 2069 7369  son(feat) if isi
-00018a10: 6e73 7461 6e63 6528 6665 6174 2c20 6469  nstance(feat, di
-00018a20: 6374 2920 656c 7365 2066 6561 740a 2020  ct) else feat.  
-00018a30: 2020 2020 2020 2020 2020 666f 7220 6665            for fe
-00018a40: 6174 2069 6e20 2866 6561 7475 7265 7320  at in (features 
-00018a50: 6f72 205b 5d29 0a20 2020 2020 2020 205d  or []).        ]
-00018a60: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00018a70: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
-00018a80: 6769 6e65 203d 2028 0a20 2020 2020 2020  gine = (.       
-00018a90: 2020 2020 2065 7874 6572 6e61 6c5f 6665       external_fe
-00018aa0: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
-00018ab0: 6e65 2e45 7874 6572 6e61 6c46 6561 7475  ne.ExternalFeatu
-00018ac0: 7265 4772 6f75 7045 6e67 696e 6528 6665  reGroupEngine(fe
-00018ad0: 6174 7572 6573 746f 7265 5f69 6429 0a20  aturestore_id). 
-00018ae0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00018af0: 2020 6966 2073 656c 662e 5f69 643a 0a20    if self._id:. 
-00018b00: 2020 2020 2020 2020 2020 2023 2047 6f74             # Got
-00018b10: 2066 726f 6d20 486f 7073 776f 726b 732c   from Hopsworks,
-00018b20: 2064 6573 6572 6961 6c69 7a65 2066 6561   deserialize fea
-00018b30: 7475 7265 7320 616e 6420 7374 6f72 6167  tures and storag
-00018b40: 6520 636f 6e6e 6563 746f 720a 2020 2020  e connector.    
-00018b50: 2020 2020 2020 2020 7365 6c66 2e5f 6665          self._fe
-00018b60: 6174 7572 6573 203d 2028 0a20 2020 2020  atures = (.     
-00018b70: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
-00018b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b90: 2066 6561 7475 7265 2e46 6561 7475 7265   feature.Feature
-00018ba0: 2e66 726f 6d5f 7265 7370 6f6e 7365 5f6a  .from_response_j
-00018bb0: 736f 6e28 6665 6174 290a 2020 2020 2020  son(feat).      
-00018bc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00018bd0: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
-00018be0: 2c20 6469 6374 290a 2020 2020 2020 2020  , dict).        
-00018bf0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00018c00: 2066 6561 740a 2020 2020 2020 2020 2020   feat.          
-00018c10: 2020 2020 2020 2020 2020 666f 7220 6665            for fe
-00018c20: 6174 2069 6e20 6665 6174 7572 6573 0a20  at in features. 
-00018c30: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00018c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018c50: 2069 6620 6665 6174 7572 6573 0a20 2020   if features.   
-00018c60: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00018c70: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
-00018c80: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00018c90: 2073 656c 662e 7072 696d 6172 795f 6b65   self.primary_ke
-00018ca0: 7920 3d20 280a 2020 2020 2020 2020 2020  y = (.          
-00018cb0: 2020 2020 2020 5b66 6561 742e 6e61 6d65        [feat.name
-00018cc0: 2066 6f72 2066 6561 7420 696e 2073 656c   for feat in sel
-00018cd0: 662e 5f66 6561 7475 7265 7320 6966 2066  f._features if f
-00018ce0: 6561 742e 7072 696d 6172 7920 6973 2054  eat.primary is T
-00018cf0: 7275 655d 0a20 2020 2020 2020 2020 2020  rue].           
-00018d00: 2020 2020 2069 6620 7365 6c66 2e5f 6665       if self._fe
-00018d10: 6174 7572 6573 0a20 2020 2020 2020 2020  atures.         
-00018d20: 2020 2020 2020 2065 6c73 6520 5b5d 0a20         else []. 
-00018d30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00018d40: 2020 2020 2020 2020 2073 656c 662e 7374           self.st
-00018d50: 6174 6973 7469 6373 5f63 6f6e 6669 6720  atistics_config 
-00018d60: 3d20 7374 6174 6973 7469 6373 5f63 6f6e  = statistics_con
-00018d70: 6669 670a 0a20 2020 2020 2020 2020 2020  fig..           
-00018d80: 2073 656c 662e 5f6f 7074 696f 6e73 203d   self._options =
-00018d90: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00018da0: 2020 207b 6f70 7469 6f6e 5b22 6e61 6d65     {option["name
-00018db0: 225d 3a20 6f70 7469 6f6e 5b22 7661 6c75  "]: option["valu
-00018dc0: 6522 5d20 666f 7220 6f70 7469 6f6e 2069  e"] for option i
-00018dd0: 6e20 6f70 7469 6f6e 737d 0a20 2020 2020  n options}.     
-00018de0: 2020 2020 2020 2020 2020 2069 6620 6f70             if op
-00018df0: 7469 6f6e 730a 2020 2020 2020 2020 2020  tions.          
-00018e00: 2020 2020 2020 656c 7365 204e 6f6e 650a        else None.
-00018e10: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00018e20: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00018e30: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
-00018e40: 6d61 7279 5f6b 6579 203d 2070 7269 6d61  mary_key = prima
-00018e50: 7279 5f6b 6579 0a20 2020 2020 2020 2020  ry_key.         
-00018e60: 2020 2073 656c 662e 7374 6174 6973 7469     self.statisti
-00018e70: 6373 5f63 6f6e 6669 6720 3d20 7374 6174  cs_config = stat
-00018e80: 6973 7469 6373 5f63 6f6e 6669 670a 2020  istics_config.  
-00018e90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00018ea0: 6665 6174 7572 6573 203d 2066 6561 7475  features = featu
-00018eb0: 7265 730a 2020 2020 2020 2020 2020 2020  res.            
-00018ec0: 7365 6c66 2e5f 6f70 7469 6f6e 7320 3d20  self._options = 
-00018ed0: 6f70 7469 6f6e 730a 0a20 2020 2020 2020  options..       
-00018ee0: 2069 6620 7374 6f72 6167 655f 636f 6e6e   if storage_conn
-00018ef0: 6563 746f 7220 6973 206e 6f74 204e 6f6e  ector is not Non
-00018f00: 6520 616e 6420 6973 696e 7374 616e 6365  e and isinstance
-00018f10: 2873 746f 7261 6765 5f63 6f6e 6e65 6374  (storage_connect
-00018f20: 6f72 2c20 6469 6374 293a 0a20 2020 2020  or, dict):.     
-00018f30: 2020 2020 2020 2073 656c 662e 5f73 746f         self._sto
-00018f40: 7261 6765 5f63 6f6e 6e65 6374 6f72 203d  rage_connector =
-00018f50: 2073 632e 5374 6f72 6167 6543 6f6e 6e65   sc.StorageConne
-00018f60: 6374 6f72 2e66 726f 6d5f 7265 7370 6f6e  ctor.from_respon
-00018f70: 7365 5f6a 736f 6e28 0a20 2020 2020 2020  se_json(.       
-00018f80: 2020 2020 2020 2020 2073 746f 7261 6765           storage
-00018f90: 5f63 6f6e 6e65 6374 6f72 0a20 2020 2020  _connector.     
-00018fa0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00018fb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00018fc0: 2020 2073 656c 662e 5f73 746f 7261 6765     self._storage
-00018fd0: 5f63 6f6e 6e65 6374 6f72 203d 2073 746f  _connector = sto
-00018fe0: 7261 6765 5f63 6f6e 6e65 6374 6f72 0a0a  rage_connector..
-00018ff0: 2020 2020 2020 2020 7365 6c66 2e5f 6872          self._hr
-00019000: 6566 203d 2068 7265 660a 0a20 2020 2064  ef = href..    d
-00019010: 6566 2073 6176 6528 7365 6c66 293a 0a20  ef save(self):. 
-00019020: 2020 2020 2020 2022 2222 5065 7273 6973         """Persis
-00019030: 7420 7468 6520 6d65 7461 6461 7461 2066  t the metadata f
-00019040: 6f72 2074 6869 7320 6578 7465 726e 616c  or this external
-00019050: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
-00019060: 0a20 2020 2020 2020 2057 6974 686f 7574  .        Without
-00019070: 2063 616c 6c69 6e67 2074 6869 7320 6d65   calling this me
-00019080: 7468 6f64 2c20 796f 7572 2066 6561 7475  thod, your featu
-00019090: 7265 2067 726f 7570 2077 696c 6c20 6f6e  re group will on
-000190a0: 6c79 2065 7869 7374 0a20 2020 2020 2020  ly exist.       
-000190b0: 2069 6e20 796f 7572 2050 7974 686f 6e20   in your Python 
-000190c0: 4b65 726e 656c 2c20 6275 7420 6e6f 7420  Kernel, but not 
-000190d0: 696e 2048 6f70 7377 6f72 6b73 2e0a 0a20  in Hopsworks... 
-000190e0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-000190f0: 0a20 2020 2020 2020 2071 7565 7279 203d  .        query =
-00019100: 2022 5345 4c45 4354 202a 2046 524f 4d20   "SELECT * FROM 
-00019110: 7361 6c65 7322 0a0a 2020 2020 2020 2020  sales"..        
-00019120: 6667 203d 2066 6561 7475 7265 5f73 746f  fg = feature_sto
-00019130: 7265 2e63 7265 6174 655f 6578 7465 726e  re.create_extern
-00019140: 616c 5f66 6561 7475 7265 5f67 726f 7570  al_feature_group
-00019150: 286e 616d 653d 2273 616c 6573 222c 0a20  (name="sales",. 
-00019160: 2020 2020 2020 2020 2020 2076 6572 7369             versi
-00019170: 6f6e 3d31 2c0a 2020 2020 2020 2020 2020  on=1,.          
-00019180: 2020 6465 7363 7269 7074 696f 6e3d 2250    description="P
-00019190: 6879 7369 6361 6c20 7368 6f70 2073 616c  hysical shop sal
-000191a0: 6573 2066 6561 7475 7265 7322 2c0a 2020  es features",.  
-000191b0: 2020 2020 2020 2020 2020 7175 6572 793d            query=
-000191c0: 7175 6572 792c 0a20 2020 2020 2020 2020  query,.         
-000191d0: 2020 2073 746f 7261 6765 5f63 6f6e 6e65     storage_conne
-000191e0: 6374 6f72 3d63 6f6e 6e65 6374 6f72 2c0a  ctor=connector,.
-000191f0: 2020 2020 2020 2020 2020 2020 7072 696d              prim
-00019200: 6172 795f 6b65 793d 5b27 7373 5f73 746f  ary_key=['ss_sto
-00019210: 7265 5f73 6b27 5d2c 0a20 2020 2020 2020  re_sk'],.       
-00019220: 2020 2020 2065 7665 6e74 5f74 696d 653d       event_time=
-00019230: 2773 616c 655f 6461 7465 270a 2020 2020  'sale_date'.    
-00019240: 2020 2020 290a 0a20 2020 2020 2020 2066      )..        f
-00019250: 672e 7361 7665 2829 0a20 2020 2020 2020  g.save().       
-00019260: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-00019270: 662e 5f66 6561 7475 7265 5f67 726f 7570  f._feature_group
-00019280: 5f65 6e67 696e 652e 7361 7665 2873 656c  _engine.save(sel
-00019290: 6629 0a20 2020 2020 2020 2073 656c 662e  f).        self.
-000192a0: 5f63 6f64 655f 656e 6769 6e65 2e73 6176  _code_engine.sav
-000192b0: 655f 636f 6465 2873 656c 6629 0a0a 2020  e_code(self)..  
-000192c0: 2020 2020 2020 6966 2073 656c 662e 7374        if self.st
-000192d0: 6174 6973 7469 6373 5f63 6f6e 6669 672e  atistics_config.
-000192e0: 656e 6162 6c65 643a 0a20 2020 2020 2020  enabled:.       
-000192f0: 2020 2020 2073 656c 662e 5f73 7461 7469       self._stati
-00019300: 7374 6963 735f 656e 6769 6e65 2e63 6f6d  stics_engine.com
-00019310: 7075 7465 5f73 7461 7469 7374 6963 7328  pute_statistics(
-00019320: 7365 6c66 290a 0a20 2020 2064 6566 2069  self)..    def i
-00019330: 6e73 6572 7428 0a20 2020 2020 2020 2073  nsert(.        s
-00019340: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
-00019350: 7475 7265 733a 2055 6e69 6f6e 5b0a 2020  tures: Union[.  
-00019360: 2020 2020 2020 2020 2020 7064 2e44 6174            pd.Dat
-00019370: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
-00019380: 2020 2020 5479 7065 5661 7228 2270 7973      TypeVar("pys
-00019390: 7061 726b 2e73 716c 2e44 6174 6146 7261  park.sql.DataFra
-000193a0: 6d65 2229 2c20 2023 206e 6f71 613a 2046  me"),  # noqa: F
-000193b0: 3832 310a 2020 2020 2020 2020 2020 2020  821.            
-000193c0: 5479 7065 5661 7228 2270 7973 7061 726b  TypeVar("pyspark
-000193d0: 2e52 4444 2229 2c20 2023 206e 6f71 613a  .RDD"),  # noqa:
-000193e0: 2046 3832 310a 2020 2020 2020 2020 2020   F821.          
-000193f0: 2020 6e70 2e6e 6461 7272 6179 2c0a 2020    np.ndarray,.  
-00019400: 2020 2020 2020 2020 2020 4c69 7374 5b6c            List[l
-00019410: 6973 745d 2c0a 2020 2020 2020 2020 5d2c  ist],.        ],
-00019420: 0a20 2020 2020 2020 2077 7269 7465 5f6f  .        write_o
-00019430: 7074 696f 6e73 3a20 4f70 7469 6f6e 616c  ptions: Optional
-00019440: 5b44 6963 745b 7374 722c 2041 6e79 5d5d  [Dict[str, Any]]
-00019450: 203d 207b 7d2c 0a20 2020 2020 2020 2076   = {},.        v
-00019460: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
-00019470: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
-00019480: 5b73 7472 2c20 416e 795d 5d20 3d20 7b7d  [str, Any]] = {}
-00019490: 2c0a 2020 2020 2020 2020 7361 7665 5f63  ,.        save_c
-000194a0: 6f64 653a 204f 7074 696f 6e61 6c5b 626f  ode: Optional[bo
-000194b0: 6f6c 5d20 3d20 5472 7565 2c0a 2020 2020  ol] = True,.    
-000194c0: 2920 2d3e 2054 7570 6c65 5b4f 7074 696f  ) -> Tuple[Optio
-000194d0: 6e61 6c5b 4a6f 625d 2c20 4f70 7469 6f6e  nal[Job], Option
-000194e0: 616c 5b56 616c 6964 6174 696f 6e52 6570  al[ValidationRep
-000194f0: 6f72 745d 5d3a 0a20 2020 2020 2020 2066  ort]]:.        f
-00019500: 6561 7475 7265 5f64 6174 6166 7261 6d65  eature_dataframe
-00019510: 203d 2065 6e67 696e 652e 6765 745f 696e   = engine.get_in
-00019520: 7374 616e 6365 2829 2e63 6f6e 7665 7274  stance().convert
-00019530: 5f74 6f5f 6465 6661 756c 745f 6461 7461  _to_default_data
-00019540: 6672 616d 6528 6665 6174 7572 6573 290a  frame(features).
-00019550: 0a20 2020 2020 2020 206a 6f62 2c20 6765  .        job, ge
-00019560: 5f72 6570 6f72 7420 3d20 7365 6c66 2e5f  _report = self._
-00019570: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
-00019580: 6769 6e65 2e69 6e73 6572 7428 0a20 2020  gine.insert(.   
-00019590: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-000195a0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-000195b0: 7265 5f64 6174 6166 7261 6d65 3d66 6561  re_dataframe=fea
-000195c0: 7475 7265 5f64 6174 6166 7261 6d65 2c0a  ture_dataframe,.
-000195d0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-000195e0: 655f 6f70 7469 6f6e 733d 7772 6974 655f  e_options=write_
-000195f0: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
-00019600: 2020 2020 2076 616c 6964 6174 696f 6e5f       validation_
-00019610: 6f70 7469 6f6e 733d 7b22 7361 7665 5f72  options={"save_r
-00019620: 6570 6f72 7422 3a20 5472 7565 2c20 2a2a  eport": True, **
-00019630: 7661 6c69 6461 7469 6f6e 5f6f 7074 696f  validation_optio
-00019640: 6e73 7d2c 0a20 2020 2020 2020 2029 0a0a  ns},.        )..
-00019650: 2020 2020 2020 2020 6966 2073 6176 655f          if save_
-00019660: 636f 6465 2061 6e64 2028 0a20 2020 2020  code and (.     
-00019670: 2020 2020 2020 2067 655f 7265 706f 7274         ge_report
-00019680: 2069 7320 4e6f 6e65 206f 7220 6765 5f72   is None or ge_r
-00019690: 6570 6f72 742e 696e 6765 7374 696f 6e5f  eport.ingestion_
-000196a0: 7265 7375 6c74 203d 3d20 2249 4e47 4553  result == "INGES
-000196b0: 5445 4422 0a20 2020 2020 2020 2029 3a0a  TED".        ):.
-000196c0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000196d0: 2e5f 636f 6465 5f65 6e67 696e 652e 7361  ._code_engine.sa
-000196e0: 7665 5f63 6f64 6528 7365 6c66 290a 0a20  ve_code(self).. 
-000196f0: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
-00019700: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
-00019710: 2e65 6e61 626c 6564 3a0a 2020 2020 2020  .enabled:.      
-00019720: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00019730: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00019740: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
-00019750: 2020 2020 2020 2020 2020 2022 5374 6174             "Stat
-00019760: 6973 7469 6373 2061 7265 206e 6f74 2063  istics are not c
-00019770: 6f6d 7075 7465 6420 666f 7220 696e 7365  omputed for inse
-00019780: 7274 696f 6e20 746f 206f 6e6c 696e 6520  rtion to online 
-00019790: 656e 6162 6c65 6420 6578 7465 726e 616c  enabled external
-000197a0: 2066 6561 7475 7265 2067 726f 7570 2060   feature group `
-000197b0: 7b7d 602c 2077 6974 6820 7665 7273 696f  {}`, with versio
-000197c0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
-000197d0: 2020 2020 2020 2022 2060 7b7d 602e 2043         " `{}`. C
-000197e0: 616c 6c20 6063 6f6d 7075 7465 5f73 7461  all `compute_sta
-000197f0: 7469 7374 6963 7360 2065 7870 6c69 6369  tistics` explici
-00019800: 746c 7920 746f 2063 6f6d 7075 7465 2073  tly to compute s
-00019810: 7461 7469 7374 6963 7320 6f76 6572 2074  tatistics over t
-00019820: 6865 2064 6174 6120 696e 2074 6865 2065  he data in the e
-00019830: 7874 6572 6e61 6c20 7374 6f72 6167 6520  xternal storage 
-00019840: 7379 7374 656d 2e22 0a20 2020 2020 2020  system.".       
-00019850: 2020 2020 2020 2020 2029 2e66 6f72 6d61           ).forma
-00019860: 7428 7365 6c66 2e5f 6e61 6d65 2c20 7365  t(self._name, se
-00019870: 6c66 2e5f 7665 7273 696f 6e29 2c0a 2020  lf._version),.  
-00019880: 2020 2020 2020 2020 2020 2020 2020 7574                ut
-00019890: 696c 2e53 746f 7261 6765 5761 726e 696e  il.StorageWarnin
-000198a0: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
-000198b0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000198c0: 2028 0a20 2020 2020 2020 2020 2020 206a   (.            j
-000198d0: 6f62 2c0a 2020 2020 2020 2020 2020 2020  ob,.            
-000198e0: 6765 5f72 6570 6f72 742e 746f 5f67 655f  ge_report.to_ge_
-000198f0: 7479 7065 2829 2069 6620 6765 5f72 6570  type() if ge_rep
-00019900: 6f72 7420 6973 206e 6f74 204e 6f6e 6520  ort is not None 
-00019910: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
-00019920: 2020 2029 0a0a 2020 2020 6465 6620 7265     )..    def re
-00019930: 6164 280a 2020 2020 2020 2020 7365 6c66  ad(.        self
-00019940: 2c20 6461 7461 6672 616d 655f 7479 7065  , dataframe_type
-00019950: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00019960: 3d20 2264 6566 6175 6c74 222c 206f 6e6c  = "default", onl
-00019970: 696e 653a 204f 7074 696f 6e61 6c5b 626f  ine: Optional[bo
-00019980: 6f6c 5d20 3d20 4661 6c73 650a 2020 2020  ol] = False.    
-00019990: 293a 0a20 2020 2020 2020 2022 2222 4765  ):.        """Ge
-000199a0: 7420 7468 6520 6665 6174 7572 6520 6772  t the feature gr
-000199b0: 6f75 7020 6173 2061 2044 6174 6146 7261  oup as a DataFra
-000199c0: 6d65 2e0a 0a20 2020 2020 2020 2021 2121  me...        !!!
-000199d0: 2065 7861 6d70 6c65 0a20 2020 2020 2020   example.       
-000199e0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
-000199f0: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
-00019a00: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
-00019a10: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
-00019a20: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
-00019a30: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
-00019a40: 7420 7468 6520 4665 6174 7572 6520 4772  t the Feature Gr
-00019a50: 6f75 7020 696e 7374 616e 6365 0a20 2020  oup instance.   
-00019a60: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
-00019a70: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
-00019a80: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
-00019a90: 290a 0a20 2020 2020 2020 2020 2020 2064  )..            d
-00019aa0: 6620 3d20 6667 2e72 6561 6428 290a 2020  f = fg.read().  
-00019ab0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
-00019ac0: 2020 2020 2020 2021 2121 2077 6172 6e69         !!! warni
-00019ad0: 6e67 2022 456e 6769 6e65 2053 7570 706f  ng "Engine Suppo
-00019ae0: 7274 220a 2020 2020 2020 2020 2020 2020  rt".            
-00019af0: 2a2a 5370 6172 6b20 6f6e 6c79 2a2a 0a0a  **Spark only**..
-00019b00: 2020 2020 2020 2020 2020 2020 5265 6164              Read
-00019b10: 696e 6720 616e 2045 7874 6572 6e61 6c20  ing an External 
-00019b20: 4665 6174 7572 6520 4772 6f75 7020 6469  Feature Group di
-00019b30: 7265 6374 6c79 2069 6e74 6f20 6120 5061  rectly into a Pa
-00019b40: 6e64 6173 2044 6174 6166 7261 6d65 2075  ndas Dataframe u
-00019b50: 7369 6e67 0a20 2020 2020 2020 2020 2020  sing.           
-00019b60: 2050 7974 686f 6e2f 5061 6e64 6173 2061   Python/Pandas a
-00019b70: 7320 456e 6769 6e65 2069 7320 6e6f 7420  s Engine is not 
-00019b80: 7375 7070 6f72 7465 642c 2068 6f77 6576  supported, howev
-00019b90: 6572 2c20 796f 7520 6361 6e20 7573 6520  er, you can use 
-00019ba0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00019bb0: 5175 6572 7920 4150 4920 746f 2063 7265  Query API to cre
-00019bc0: 6174 6520 4665 6174 7572 6520 5669 6577  ate Feature View
-00019bd0: 732f 5472 6169 6e69 6e67 2044 6174 6120  s/Training Data 
-00019be0: 636f 6e74 6169 6e69 6e67 2045 7874 6572  containing Exter
-00019bf0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00019c00: 4665 6174 7572 6520 4772 6f75 7073 2e0a  Feature Groups..
-00019c10: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
-00019c20: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-00019c30: 2064 6174 6166 7261 6d65 5f74 7970 653a   dataframe_type:
-00019c40: 2073 7472 2c20 6f70 7469 6f6e 616c 2e20   str, optional. 
-00019c50: 506f 7373 6962 6c65 2076 616c 7565 7320  Possible values 
-00019c60: 6172 6520 6022 6465 6661 756c 7422 602c  are `"default"`,
-00019c70: 2060 2273 7061 726b 2260 2c0a 2020 2020   `"spark"`,.    
-00019c80: 2020 2020 2020 2020 2020 2020 6022 7061              `"pa
-00019c90: 6e64 6173 2260 2c20 6022 6e75 6d70 7922  ndas"`, `"numpy"
-00019ca0: 6020 6f72 2060 2270 7974 686f 6e22 602c  ` or `"python"`,
-00019cb0: 2064 6566 6175 6c74 7320 746f 2060 2264   defaults to `"d
-00019cc0: 6566 6175 6c74 2260 2e0a 2020 2020 2020  efault"`..      
-00019cd0: 2020 2020 2020 6f6e 6c69 6e65 3a20 626f        online: bo
-00019ce0: 6f6c 2c20 6f70 7469 6f6e 616c 2e20 4966  ol, optional. If
-00019cf0: 2060 5472 7565 6020 7265 6164 2066 726f   `True` read fro
-00019d00: 6d20 6f6e 6c69 6e65 2066 6561 7475 7265  m online feature
-00019d10: 2073 746f 7265 2c20 6465 6661 756c 7473   store, defaults
-00019d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019d30: 2074 6f20 6046 616c 7365 602e 0a0a 2020   to `False`...  
-00019d40: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-00019d50: 2020 2020 2020 2020 2020 2020 6044 6174              `Dat
-00019d60: 6146 7261 6d65 603a 2054 6865 2073 7061  aFrame`: The spa
-00019d70: 726b 2064 6174 6166 7261 6d65 2063 6f6e  rk dataframe con
-00019d80: 7461 696e 696e 6720 7468 6520 6665 6174  taining the feat
-00019d90: 7572 6520 6461 7461 2e0a 2020 2020 2020  ure data..      
-00019da0: 2020 2020 2020 6070 7973 7061 726b 2e44        `pyspark.D
-00019db0: 6174 6146 7261 6d65 602e 2041 2053 7061  ataFrame`. A Spa
-00019dc0: 726b 2044 6174 6146 7261 6d65 2e0a 2020  rk DataFrame..  
-00019dd0: 2020 2020 2020 2020 2020 6070 616e 6461            `panda
-00019de0: 732e 4461 7461 4672 616d 6560 2e20 4120  s.DataFrame`. A 
-00019df0: 5061 6e64 6173 2044 6174 6146 7261 6d65  Pandas DataFrame
-00019e00: 2e0a 2020 2020 2020 2020 2020 2020 606e  ..            `n
-00019e10: 756d 7079 2e6e 6461 7272 6179 602e 2041  umpy.ndarray`. A
-00019e20: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
-00019e30: 204e 756d 7079 2061 7272 6179 2e0a 2020   Numpy array..  
-00019e40: 2020 2020 2020 2020 2020 606c 6973 7460            `list`
-00019e50: 2e20 4120 7477 6f2d 6469 6d65 6e73 696f  . A two-dimensio
-00019e60: 6e61 6c20 5079 7468 6f6e 206c 6973 742e  nal Python list.
-00019e70: 0a0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
-00019e80: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
-00019e90: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
-00019ea0: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
-00019eb0: 726f 7260 2e0a 2020 2020 2020 2020 2222  ror`..        ""
-00019ec0: 220a 2020 2020 2020 2020 6966 2065 6e67  ".        if eng
-00019ed0: 696e 652e 6765 745f 7479 7065 2829 203d  ine.get_type() =
-00019ee0: 3d20 2270 7974 686f 6e22 2061 6e64 206e  = "python" and n
-00019ef0: 6f74 206f 6e6c 696e 653a 0a20 2020 2020  ot online:.     
-00019f00: 2020 2020 2020 2072 6169 7365 2046 6561         raise Fea
-00019f10: 7475 7265 5374 6f72 6545 7863 6570 7469  tureStoreExcepti
-00019f20: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00019f30: 2020 2020 2252 6561 6469 6e67 2061 6e20      "Reading an 
-00019f40: 4578 7465 726e 616c 2046 6561 7475 7265  External Feature
-00019f50: 2047 726f 7570 2064 6972 6563 746c 7920   Group directly 
-00019f60: 696e 746f 2061 2050 616e 6461 7320 4461  into a Pandas Da
-00019f70: 7461 6672 616d 6520 7573 696e 6720 220a  taframe using ".
-00019f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019f90: 2b20 2250 7974 686f 6e2f 5061 6e64 6173  + "Python/Pandas
-00019fa0: 2061 7320 456e 6769 6e65 2066 726f 6d20   as Engine from 
-00019fb0: 7468 6520 6578 7465 726e 616c 2073 746f  the external sto
-00019fc0: 7261 6765 2073 7973 7465 6d20 220a 2020  rage system ".  
-00019fd0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-00019fe0: 2269 7320 6e6f 7420 7375 7070 6f72 7465  "is not supporte
-00019ff0: 642c 2068 6f77 6576 6572 2c20 6966 2074  d, however, if t
-0001a000: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-0001a010: 2069 7320 6f6e 6c69 6e65 2065 6e61 626c   is online enabl
-0001a020: 6564 2c20 796f 7520 6361 6e20 7265 6164  ed, you can read
-0001a030: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0001a040: 2020 202b 2022 6672 6f6d 206f 6e6c 696e     + "from onlin
-0001a050: 6520 7374 6f72 6167 6520 6f72 2079 6f75  e storage or you
-0001a060: 2063 616e 2075 7365 2074 6865 2022 0a20   can use the ". 
-0001a070: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0001a080: 2022 5175 6572 7920 4150 4920 746f 2063   "Query API to c
-0001a090: 7265 6174 6520 4665 6174 7572 6520 5669  reate Feature Vi
-0001a0a0: 6577 732f 5472 6169 6e69 6e67 2044 6174  ews/Training Dat
-0001a0b0: 6120 636f 6e74 6169 6e69 6e67 2045 7874  a containing Ext
-0001a0c0: 6572 6e61 6c20 220a 2020 2020 2020 2020  ernal ".        
-0001a0d0: 2020 2020 2020 2020 2b20 2246 6561 7475          + "Featu
-0001a0e0: 7265 2047 726f 7570 732e 220a 2020 2020  re Groups.".    
-0001a0f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001a100: 2020 656e 6769 6e65 2e67 6574 5f69 6e73    engine.get_ins
-0001a110: 7461 6e63 6528 292e 7365 745f 6a6f 625f  tance().set_job_
-0001a120: 6772 6f75 7028 0a20 2020 2020 2020 2020  group(.         
-0001a130: 2020 2022 4665 7463 6869 6e67 2046 6561     "Fetching Fea
-0001a140: 7475 7265 2067 726f 7570 222c 0a20 2020  ture group",.   
-0001a150: 2020 2020 2020 2020 2022 4765 7474 696e           "Gettin
-0001a160: 6720 6665 6174 7572 6520 6772 6f75 703a  g feature group:
-0001a170: 207b 7d20 6672 6f6d 2074 6865 2066 6561   {} from the fea
-0001a180: 7475 7265 7374 6f72 6520 7b7d 222e 666f  turestore {}".fo
-0001a190: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-0001a1a0: 2020 2020 2020 7365 6c66 2e5f 6e61 6d65        self._name
-0001a1b0: 2c20 7365 6c66 2e5f 6665 6174 7572 655f  , self._feature_
-0001a1c0: 7374 6f72 655f 6e61 6d65 0a20 2020 2020  store_name.     
-0001a1d0: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0001a1e0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0001a1f0: 726e 2073 656c 662e 7365 6c65 6374 5f61  rn self.select_a
-0001a200: 6c6c 2829 2e72 6561 6428 6461 7461 6672  ll().read(datafr
-0001a210: 616d 655f 7479 7065 3d64 6174 6166 7261  ame_type=datafra
-0001a220: 6d65 5f74 7970 652c 206f 6e6c 696e 653d  me_type, online=
-0001a230: 6f6e 6c69 6e65 290a 0a20 2020 2064 6566  online)..    def
-0001a240: 2073 686f 7728 7365 6c66 2c20 6e29 3a0a   show(self, n):.
-0001a250: 2020 2020 2020 2020 2222 2253 686f 7720          """Show 
-0001a260: 7468 6520 6669 7273 7420 6e20 726f 7773  the first n rows
-0001a270: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-0001a280: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
-0001a290: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
-0001a2a0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-0001a2b0: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
-0001a2c0: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
-0001a2d0: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
-0001a2e0: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
-0001a2f0: 2e0a 0a20 2020 2020 2020 2020 2020 2023  ...            #
-0001a300: 2067 6574 2074 6865 2046 6561 7475 7265   get the Feature
-0001a310: 2047 726f 7570 2069 6e73 7461 6e63 650a   Group instance.
-0001a320: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
-0001a330: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
-0001a340: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
-0001a350: 2e2e 2e29 0a0a 2020 2020 2020 2020 2020  ...)..          
-0001a360: 2020 6667 2e73 686f 7728 3529 0a20 2020    fg.show(5).   
-0001a370: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-0001a380: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001a390: 2065 6e67 696e 652e 6765 745f 696e 7374   engine.get_inst
-0001a3a0: 616e 6365 2829 2e73 6574 5f6a 6f62 5f67  ance().set_job_g
-0001a3b0: 726f 7570 280a 2020 2020 2020 2020 2020  roup(.          
-0001a3c0: 2020 2246 6574 6368 696e 6720 4665 6174    "Fetching Feat
-0001a3d0: 7572 6520 6772 6f75 7022 2c0a 2020 2020  ure group",.    
-0001a3e0: 2020 2020 2020 2020 2247 6574 7469 6e67          "Getting
-0001a3f0: 2066 6561 7475 7265 2067 726f 7570 3a20   feature group: 
-0001a400: 7b7d 2066 726f 6d20 7468 6520 6665 6174  {} from the feat
-0001a410: 7572 6573 746f 7265 207b 7d22 2e66 6f72  urestore {}".for
-0001a420: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-0001a430: 2020 2020 2073 656c 662e 5f6e 616d 652c       self._name,
-0001a440: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
-0001a450: 746f 7265 5f6e 616d 650a 2020 2020 2020  tore_name.      
-0001a460: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-0001a470: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
-0001a480: 6e20 7365 6c66 2e73 656c 6563 745f 616c  n self.select_al
-0001a490: 6c28 292e 7368 6f77 286e 290a 0a20 2020  l().show(n)..   
-0001a4a0: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-0001a4b0: 2020 6465 6620 6672 6f6d 5f72 6573 706f    def from_respo
-0001a4c0: 6e73 655f 6a73 6f6e 2863 6c73 2c20 6a73  nse_json(cls, js
-0001a4d0: 6f6e 5f64 6963 7429 3a0a 2020 2020 2020  on_dict):.      
-0001a4e0: 2020 6a73 6f6e 5f64 6563 616d 656c 697a    json_decameliz
-0001a4f0: 6564 203d 2068 756d 7073 2e64 6563 616d  ed = humps.decam
-0001a500: 656c 697a 6528 6a73 6f6e 5f64 6963 7429  elize(json_dict)
-0001a510: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-0001a520: 7374 616e 6365 286a 736f 6e5f 6465 6361  stance(json_deca
-0001a530: 6d65 6c69 7a65 642c 2064 6963 7429 3a0a  melized, dict):.
-0001a540: 2020 2020 2020 2020 2020 2020 5f20 3d20              _ = 
-0001a550: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-0001a560: 2e70 6f70 2822 7479 7065 222c 204e 6f6e  .pop("type", Non
-0001a570: 6529 0a20 2020 2020 2020 2020 2020 2072  e).            r
-0001a580: 6574 7572 6e20 636c 7328 2a2a 6a73 6f6e  eturn cls(**json
-0001a590: 5f64 6563 616d 656c 697a 6564 290a 2020  _decamelized).  
-0001a5a0: 2020 2020 2020 666f 7220 6667 2069 6e20        for fg in 
-0001a5b0: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-0001a5c0: 3a0a 2020 2020 2020 2020 2020 2020 5f20  :.            _ 
-0001a5d0: 3d20 6667 2e70 6f70 2822 7479 7065 222c  = fg.pop("type",
-0001a5e0: 204e 6f6e 6529 0a20 2020 2020 2020 2072   None).        r
-0001a5f0: 6574 7572 6e20 5b63 6c73 282a 2a66 6729  eturn [cls(**fg)
-0001a600: 2066 6f72 2066 6720 696e 206a 736f 6e5f   for fg in json_
-0001a610: 6465 6361 6d65 6c69 7a65 645d 0a0a 2020  decamelized]..  
-0001a620: 2020 6465 6620 7570 6461 7465 5f66 726f    def update_fro
-0001a630: 6d5f 7265 7370 6f6e 7365 5f6a 736f 6e28  m_response_json(
-0001a640: 7365 6c66 2c20 6a73 6f6e 5f64 6963 7429  self, json_dict)
-0001a650: 3a0a 2020 2020 2020 2020 6a73 6f6e 5f64  :.        json_d
-0001a660: 6563 616d 656c 697a 6564 203d 2068 756d  ecamelized = hum
-0001a670: 7073 2e64 6563 616d 656c 697a 6528 6a73  ps.decamelize(js
-0001a680: 6f6e 5f64 6963 7429 0a20 2020 2020 2020  on_dict).       
-0001a690: 2069 6620 2274 7970 6522 2069 6e20 6a73   if "type" in js
-0001a6a0: 6f6e 5f64 6563 616d 656c 697a 6564 3a0a  on_decamelized:.
-0001a6b0: 2020 2020 2020 2020 2020 2020 5f20 3d20              _ = 
-0001a6c0: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-0001a6d0: 2e70 6f70 2822 7479 7065 2229 0a20 2020  .pop("type").   
-0001a6e0: 2020 2020 2073 656c 662e 5f5f 696e 6974       self.__init
-0001a6f0: 5f5f 282a 2a6a 736f 6e5f 6465 6361 6d65  __(**json_decame
-0001a700: 6c69 7a65 6429 0a20 2020 2020 2020 2072  lized).        r
-0001a710: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
-0001a720: 6465 6620 6a73 6f6e 2873 656c 6629 3a0a  def json(self):.
-0001a730: 2020 2020 2020 2020 7265 7475 726e 206a          return j
-0001a740: 736f 6e2e 6475 6d70 7328 7365 6c66 2c20  son.dumps(self, 
-0001a750: 636c 733d 7574 696c 2e46 6561 7475 7265  cls=util.Feature
-0001a760: 5374 6f72 6545 6e63 6f64 6572 290a 0a20  StoreEncoder).. 
-0001a770: 2020 2064 6566 2074 6f5f 6469 6374 2873     def to_dict(s
-0001a780: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-0001a790: 7475 726e 207b 0a20 2020 2020 2020 2020  turn {.         
-0001a7a0: 2020 2022 6964 223a 2073 656c 662e 5f69     "id": self._i
-0001a7b0: 642c 0a20 2020 2020 2020 2020 2020 2022  d,.            "
-0001a7c0: 6e61 6d65 223a 2073 656c 662e 5f6e 616d  name": self._nam
-0001a7d0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
-0001a7e0: 6465 7363 7269 7074 696f 6e22 3a20 7365  description": se
-0001a7f0: 6c66 2e5f 6465 7363 7269 7074 696f 6e2c  lf._description,
-0001a800: 0a20 2020 2020 2020 2020 2020 2022 7665  .            "ve
-0001a810: 7273 696f 6e22 3a20 7365 6c66 2e5f 7665  rsion": self._ve
-0001a820: 7273 696f 6e2c 0a20 2020 2020 2020 2020  rsion,.         
-0001a830: 2020 2022 6665 6174 7572 6573 223a 2073     "features": s
-0001a840: 656c 662e 5f66 6561 7475 7265 732c 0a20  elf._features,. 
-0001a850: 2020 2020 2020 2020 2020 2022 6665 6174             "feat
-0001a860: 7572 6573 746f 7265 4964 223a 2073 656c  urestoreId": sel
-0001a870: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-0001a880: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-0001a890: 2022 7175 6572 7922 3a20 7365 6c66 2e5f   "query": self._
-0001a8a0: 7175 6572 792c 0a20 2020 2020 2020 2020  query,.         
-0001a8b0: 2020 2022 6461 7461 466f 726d 6174 223a     "dataFormat":
-0001a8c0: 2073 656c 662e 5f64 6174 615f 666f 726d   self._data_form
-0001a8d0: 6174 2c0a 2020 2020 2020 2020 2020 2020  at,.            
-0001a8e0: 2270 6174 6822 3a20 7365 6c66 2e5f 7061  "path": self._pa
-0001a8f0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-0001a900: 226f 7074 696f 6e73 223a 205b 7b22 6e61  "options": [{"na
-0001a910: 6d65 223a 206b 2c20 2276 616c 7565 223a  me": k, "value":
-0001a920: 2076 7d20 666f 7220 6b2c 2076 2069 6e20   v} for k, v in 
-0001a930: 7365 6c66 2e5f 6f70 7469 6f6e 732e 6974  self._options.it
-0001a940: 656d 7328 295d 0a20 2020 2020 2020 2020  ems()].         
-0001a950: 2020 2069 6620 7365 6c66 2e5f 6f70 7469     if self._opti
-0001a960: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-0001a970: 656c 7365 204e 6f6e 652c 0a20 2020 2020  else None,.     
-0001a980: 2020 2020 2020 2022 7374 6f72 6167 6543         "storageC
-0001a990: 6f6e 6e65 6374 6f72 223a 2073 656c 662e  onnector": self.
-0001a9a0: 5f73 746f 7261 6765 5f63 6f6e 6e65 6374  _storage_connect
-0001a9b0: 6f72 2e74 6f5f 6469 6374 2829 2c0a 2020  or.to_dict(),.  
-0001a9c0: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
-0001a9d0: 3a20 226f 6e44 656d 616e 6446 6561 7475  : "onDemandFeatu
-0001a9e0: 7265 6772 6f75 7044 544f 222c 0a20 2020  regroupDTO",.   
-0001a9f0: 2020 2020 2020 2020 2022 7374 6174 6973           "statis
-0001aa00: 7469 6373 436f 6e66 6967 223a 2073 656c  ticsConfig": sel
-0001aa10: 662e 5f73 7461 7469 7374 6963 735f 636f  f._statistics_co
-0001aa20: 6e66 6967 2c0a 2020 2020 2020 2020 2020  nfig,.          
-0001aa30: 2020 2265 7665 6e74 5469 6d65 223a 2073    "eventTime": s
-0001aa40: 656c 662e 5f65 7665 6e74 5f74 696d 652c  elf._event_time,
-0001aa50: 0a20 2020 2020 2020 2020 2020 2022 6578  .            "ex
-0001aa60: 7065 6374 6174 696f 6e53 7569 7465 223a  pectationSuite":
-0001aa70: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
-0001aa80: 6f6e 5f73 7569 7465 2c0a 2020 2020 2020  on_suite,.      
-0001aa90: 2020 2020 2020 226f 6e6c 696e 6545 6e61        "onlineEna
-0001aaa0: 626c 6564 223a 2073 656c 662e 5f6f 6e6c  bled": self._onl
-0001aab0: 696e 655f 656e 6162 6c65 642c 0a20 2020  ine_enabled,.   
-0001aac0: 2020 2020 207d 0a0a 2020 2020 4070 726f       }..    @pro
-0001aad0: 7065 7274 790a 2020 2020 6465 6620 6964  perty.    def id
-0001aae0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0001aaf0: 7265 7475 726e 2073 656c 662e 5f69 640a  return self._id.
-0001ab00: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0001ab10: 2020 2064 6566 206e 616d 6528 7365 6c66     def name(self
-0001ab20: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0001ab30: 6e20 7365 6c66 2e5f 6e61 6d65 0a0a 2020  n self._name..  
-0001ab40: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0001ab50: 6465 6620 7665 7273 696f 6e28 7365 6c66  def version(self
-0001ab60: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-0001ab70: 6e20 7365 6c66 2e5f 7665 7273 696f 6e0a  n self._version.
-0001ab80: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0001ab90: 2020 2064 6566 2064 6573 6372 6970 7469     def descripti
-0001aba0: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-0001abb0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
-0001abc0: 6573 6372 6970 7469 6f6e 0a0a 2020 2020  escription..    
-0001abd0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0001abe0: 6620 6665 6174 7572 6573 2873 656c 6629  f features(self)
-0001abf0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-0001ac00: 2073 656c 662e 5f66 6561 7475 7265 730a   self._features.
-0001ac10: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-0001ac20: 2020 2064 6566 2071 7565 7279 2873 656c     def query(sel
-0001ac30: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-0001ac40: 726e 2073 656c 662e 5f71 7565 7279 0a0a  rn self._query..
-0001ac50: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0001ac60: 2020 6465 6620 6461 7461 5f66 6f72 6d61    def data_forma
-0001ac70: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-0001ac80: 2072 6574 7572 6e20 7365 6c66 2e5f 6461   return self._da
-0001ac90: 7461 5f66 6f72 6d61 740a 0a20 2020 2040  ta_format..    @
-0001aca0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0001acb0: 2070 6174 6828 7365 6c66 293a 0a20 2020   path(self):.   
-0001acc0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001acd0: 2e5f 7061 7468 0a0a 2020 2020 4070 726f  ._path..    @pro
-0001ace0: 7065 7274 790a 2020 2020 6465 6620 6f70  perty.    def op
-0001acf0: 7469 6f6e 7328 7365 6c66 293a 0a20 2020  tions(self):.   
-0001ad00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001ad10: 2e5f 6f70 7469 6f6e 730a 0a20 2020 2040  ._options..    @
-0001ad20: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0001ad30: 2073 746f 7261 6765 5f63 6f6e 6e65 6374   storage_connect
-0001ad40: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
-0001ad50: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
-0001ad60: 746f 7261 6765 5f63 6f6e 6e65 6374 6f72  torage_connector
-0001ad70: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0001ad80: 2020 2020 6465 6620 6372 6561 746f 7228      def creator(
-0001ad90: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-0001ada0: 6574 7572 6e20 7365 6c66 2e5f 6372 6561  eturn self._crea
-0001adb0: 746f 720a 0a20 2020 2040 7072 6f70 6572  tor..    @proper
-0001adc0: 7479 0a20 2020 2064 6566 2063 7265 6174  ty.    def creat
-0001add0: 6564 2873 656c 6629 3a0a 2020 2020 2020  ed(self):.      
-0001ade0: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
-0001adf0: 7265 6174 6564 0a0a 2020 2020 4076 6572  reated..    @ver
-0001ae00: 7369 6f6e 2e73 6574 7465 720a 2020 2020  sion.setter.    
-0001ae10: 6465 6620 7665 7273 696f 6e28 7365 6c66  def version(self
-0001ae20: 2c20 7665 7273 696f 6e29 3a0a 2020 2020  , version):.    
-0001ae30: 2020 2020 7365 6c66 2e5f 7665 7273 696f      self._versio
-0001ae40: 6e20 3d20 7665 7273 696f 6e0a 0a20 2020  n = version..   
-0001ae50: 2040 6465 7363 7269 7074 696f 6e2e 7365   @description.se
-0001ae60: 7474 6572 0a20 2020 2064 6566 2064 6573  tter.    def des
-0001ae70: 6372 6970 7469 6f6e 2873 656c 662c 206e  cription(self, n
-0001ae80: 6577 5f64 6573 6372 6970 7469 6f6e 293a  ew_description):
-0001ae90: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-0001aea0: 6573 6372 6970 7469 6f6e 203d 206e 6577  escription = new
-0001aeb0: 5f64 6573 6372 6970 7469 6f6e 0a0a 2020  _description..  
-0001aec0: 2020 4066 6561 7475 7265 732e 7365 7474    @features.sett
-0001aed0: 6572 0a20 2020 2064 6566 2066 6561 7475  er.    def featu
-0001aee0: 7265 7328 7365 6c66 2c20 6e65 775f 6665  res(self, new_fe
-0001aef0: 6174 7572 6573 293a 0a20 2020 2020 2020  atures):.       
-0001af00: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
-0001af10: 3d20 6e65 775f 6665 6174 7572 6573 0a0a  = new_features..
-0001af20: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0001af30: 2020 6465 6620 6665 6174 7572 655f 7374    def feature_st
-0001af40: 6f72 655f 6e61 6d65 2873 656c 6629 3a0a  ore_name(self):.
-0001af50: 2020 2020 2020 2020 2222 224e 616d 6520          """Name 
-0001af60: 6f66 2074 6865 2066 6561 7475 7265 2073  of the feature s
-0001af70: 746f 7265 2069 6e20 7768 6963 6820 7468  tore in which th
-0001af80: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
-0001af90: 6973 206c 6f63 6174 6564 2e22 2222 0a20  is located.""". 
-0001afa0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001afb0: 6c66 2e5f 6665 6174 7572 655f 7374 6f72  lf._feature_stor
-0001afc0: 655f 6e61 6d65 0a0a 2020 2020 4070 726f  e_name..    @pro
-0001afd0: 7065 7274 790a 2020 2020 6465 6620 6665  perty.    def fe
-0001afe0: 6174 7572 655f 7374 6f72 655f 6964 2873  ature_store_id(s
-0001aff0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0001b000: 2249 6420 6f66 2074 6865 2066 6561 7475  "Id of the featu
-0001b010: 7265 2073 746f 7265 2069 6e20 7768 6963  re store in whic
-0001b020: 6820 7468 6520 6665 6174 7572 6520 6772  h the feature gr
-0001b030: 6f75 7020 6973 206c 6f63 6174 6564 2e22  oup is located."
-0001b040: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0001b050: 6e20 7365 6c66 2e5f 6665 6174 7572 655f  n self._feature_
-0001b060: 7374 6f72 655f 6964 0a                   store_id.
+00005430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005440: 2020 2020 2020 2020 2020 6465 7363 7269            descri
+00005450: 7074 696f 6e3d 224d 7563 6820 6265 7474  ption="Much bett
+00005460: 6572 2066 6561 7475 7265 2064 6573 6372  er feature descr
+00005470: 6970 7469 6f6e 2e22 290a 2020 2020 2020  iption.").      
+00005480: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
+00005490: 2020 2021 2121 2069 6e66 6f20 2253 6166     !!! info "Saf
+000054a0: 6520 7570 6461 7465 220a 2020 2020 2020  e update".      
+000054b0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+000054c0: 6420 7570 6461 7465 7320 7468 6520 6665  d updates the fe
+000054d0: 6174 7572 6520 6465 7363 7269 7074 696f  ature descriptio
+000054e0: 6e20 7361 6665 6c79 2e20 496e 2063 6173  n safely. In cas
+000054f0: 6520 6f66 2066 6169 6c75 7265 0a20 2020  e of failure.   
+00005500: 2020 2020 2020 2020 2079 6f75 7220 6c6f           your lo
+00005510: 6361 6c20 6d65 7461 6461 7461 206f 626a  cal metadata obj
+00005520: 6563 7420 7769 6c6c 206b 6565 7020 7468  ect will keep th
+00005530: 6520 6f6c 6420 6465 7363 7269 7074 696f  e old descriptio
+00005540: 6e2e 0a0a 2020 2020 2020 2020 2320 4172  n...        # Ar
+00005550: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
+00005560: 2020 2020 6665 6174 7572 655f 6e61 6d65      feature_name
+00005570: 3a20 4e61 6d65 206f 6620 7468 6520 6665  : Name of the fe
+00005580: 6174 7572 6520 746f 2062 6520 7570 6461  ature to be upda
+00005590: 7465 642e 0a20 2020 2020 2020 2020 2020  ted..           
+000055a0: 2064 6573 6372 6970 7469 6f6e 3a20 4e65   description: Ne
+000055b0: 7720 6465 7363 7269 7074 696f 6e20 7374  w description st
+000055c0: 7269 6e67 2e0a 0a20 2020 2020 2020 2023  ring...        #
+000055d0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000055e0: 2020 2020 2060 4665 6174 7572 6547 726f       `FeatureGro
+000055f0: 7570 602e 2054 6865 2075 7064 6174 6564  up`. The updated
+00005600: 2066 6561 7475 7265 2067 726f 7570 206f   feature group o
+00005610: 626a 6563 742e 0a20 2020 2020 2020 2022  bject..        "
+00005620: 2222 0a20 2020 2020 2020 2066 5f63 6f70  "".        f_cop
+00005630: 7920 3d20 636f 7079 2e64 6565 7063 6f70  y = copy.deepcop
+00005640: 7928 7365 6c66 5b66 6561 7475 7265 5f6e  y(self[feature_n
+00005650: 616d 655d 290a 2020 2020 2020 2020 665f  ame]).        f_
+00005660: 636f 7079 2e64 6573 6372 6970 7469 6f6e  copy.description
+00005670: 203d 2064 6573 6372 6970 7469 6f6e 0a20   = description. 
+00005680: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
+00005690: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
+000056a0: 652e 7570 6461 7465 5f66 6561 7475 7265  e.update_feature
+000056b0: 7328 7365 6c66 2c20 5b66 5f63 6f70 795d  s(self, [f_copy]
+000056c0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000056d0: 2073 656c 660a 0a20 2020 2064 6566 2061   self..    def a
+000056e0: 7070 656e 645f 6665 6174 7572 6573 2873  ppend_features(s
+000056f0: 656c 662c 2066 6561 7475 7265 733a 2055  elf, features: U
+00005700: 6e69 6f6e 5b66 6561 7475 7265 2e46 6561  nion[feature.Fea
+00005710: 7475 7265 2c20 4c69 7374 5b66 6561 7475  ture, List[featu
+00005720: 7265 2e46 6561 7475 7265 5d5d 293a 0a20  re.Feature]]):. 
+00005730: 2020 2020 2020 2022 2222 4170 7065 6e64         """Append
+00005740: 2066 6561 7475 7265 7320 746f 2074 6865   features to the
+00005750: 2073 6368 656d 6120 6f66 2074 6865 2066   schema of the f
+00005760: 6561 7475 7265 2067 726f 7570 2e0a 0a20  eature group... 
+00005770: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00005780: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
+00005790: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+000057a0: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
+000057b0: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
+000057c0: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+000057d0: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
+000057e0: 2020 2020 2020 2320 6465 6669 6e65 2066        # define f
+000057f0: 6561 7475 7265 7320 746f 2062 6520 696e  eatures to be in
+00005800: 7365 7274 6564 2069 6e20 7468 6520 6665  serted in the fe
+00005810: 6174 7572 6520 6772 6f75 700a 2020 2020  ature group.    
+00005820: 2020 2020 2020 2020 6665 6174 7572 6573          features
+00005830: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+00005840: 2020 2020 2046 6561 7475 7265 286e 616d       Feature(nam
+00005850: 653d 2269 6422 2c74 7970 653d 2269 6e74  e="id",type="int
+00005860: 222c 6f6e 6c69 6e65 5f74 7970 653d 2269  ",online_type="i
+00005870: 6e74 2229 2c0a 2020 2020 2020 2020 2020  nt"),.          
+00005880: 2020 2020 2020 4665 6174 7572 6528 6e61        Feature(na
+00005890: 6d65 3d22 6e61 6d65 222c 7479 7065 3d22  me="name",type="
+000058a0: 7374 7269 6e67 222c 6f6e 6c69 6e65 5f74  string",online_t
+000058b0: 7970 653d 2276 6172 6368 6172 2832 3029  ype="varchar(20)
+000058c0: 2229 0a20 2020 2020 2020 2020 2020 205d  ").            ]
+000058d0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000058e0: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
+000058f0: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
+00005900: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
+00005910: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
+00005920: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
+00005930: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
+00005940: 2066 672e 6170 7065 6e64 5f66 6561 7475   fg.append_featu
+00005950: 7265 7328 6665 6174 7572 6573 290a 2020  res(features).  
+00005960: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
+00005970: 2020 2020 2020 2021 2121 2069 6e66 6f20         !!! info 
+00005980: 2253 6166 6520 6170 7065 6e64 220a 2020  "Safe append".  
+00005990: 2020 2020 2020 2020 2020 5468 6973 206d            This m
+000059a0: 6574 686f 6420 6170 7065 6e64 7320 7468  ethod appends th
+000059b0: 6520 6665 6174 7572 6573 2074 6f20 7468  e features to th
+000059c0: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
+000059d0: 6465 7363 7269 7074 696f 6e20 7361 6665  description safe
+000059e0: 6c79 2e0a 2020 2020 2020 2020 2020 2020  ly..            
+000059f0: 496e 2063 6173 6520 6f66 2066 6169 6c75  In case of failu
+00005a00: 7265 2079 6f75 7220 6c6f 6361 6c20 6d65  re your local me
+00005a10: 7461 6461 7461 206f 626a 6563 7420 7769  tadata object wi
+00005a20: 6c6c 2063 6f6e 7461 696e 2074 6865 2063  ll contain the c
+00005a30: 6f72 7265 6374 0a20 2020 2020 2020 2020  orrect.         
+00005a40: 2020 2073 6368 656d 612e 0a0a 2020 2020     schema...    
+00005a50: 2020 2020 4974 2069 7320 6f6e 6c79 2070      It is only p
+00005a60: 6f73 7369 626c 6520 746f 2061 7070 656e  ossible to appen
+00005a70: 6420 6665 6174 7572 6573 2074 6f20 6120  d features to a 
+00005a80: 6665 6174 7572 6520 6772 6f75 702e 2052  feature group. R
+00005a90: 656d 6f76 696e 670a 2020 2020 2020 2020  emoving.        
+00005aa0: 6665 6174 7572 6573 2069 7320 636f 6e73  features is cons
+00005ab0: 6964 6572 6564 2061 2062 7265 616b 696e  idered a breakin
+00005ac0: 6720 6368 616e 6765 2e0a 0a20 2020 2020  g change...     
+00005ad0: 2020 2023 2041 7267 756d 656e 7473 0a20     # Arguments. 
+00005ae0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00005af0: 7265 733a 2046 6561 7475 7265 206f 7220  res: Feature or 
+00005b00: 6c69 7374 2e20 4120 6665 6174 7572 6520  list. A feature 
+00005b10: 6f62 6a65 6374 206f 7220 6c69 7374 2074  object or list t
+00005b20: 6865 7265 6f66 2074 6f20 6170 7065 6e64  hereof to append
+00005b30: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+00005b40: 2020 2020 7468 6520 7363 6865 6d61 206f      the schema o
+00005b50: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
+00005b60: 6f75 702e 0a0a 2020 2020 2020 2020 2320  oup...        # 
+00005b70: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00005b80: 2020 2020 6046 6561 7475 7265 4772 6f75      `FeatureGrou
+00005b90: 7060 2e20 5468 6520 7570 6461 7465 6420  p`. The updated 
+00005ba0: 6665 6174 7572 6520 6772 6f75 7020 6f62  feature group ob
+00005bb0: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
+00005bc0: 220a 2020 2020 2020 2020 6e65 775f 6665  ".        new_fe
+00005bd0: 6174 7572 6573 203d 205b 5d0a 2020 2020  atures = [].    
+00005be0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00005bf0: 6528 6665 6174 7572 6573 2c20 6665 6174  e(features, feat
+00005c00: 7572 652e 4665 6174 7572 6529 3a0a 2020  ure.Feature):.  
+00005c10: 2020 2020 2020 2020 2020 6e65 775f 6665            new_fe
+00005c20: 6174 7572 6573 2e61 7070 656e 6428 6665  atures.append(fe
+00005c30: 6174 7572 6573 290a 2020 2020 2020 2020  atures).        
+00005c40: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00005c50: 6665 6174 7572 6573 2c20 6c69 7374 293a  features, list):
+00005c60: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00005c70: 2066 6561 7420 696e 2066 6561 7475 7265   feat in feature
+00005c80: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00005c90: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00005ca0: 2866 6561 742c 2066 6561 7475 7265 2e46  (feat, feature.F
+00005cb0: 6561 7475 7265 293a 0a20 2020 2020 2020  eature):.       
+00005cc0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00005cd0: 5f66 6561 7475 7265 732e 6170 7065 6e64  _features.append
+00005ce0: 2866 6561 7429 0a20 2020 2020 2020 2020  (feat).         
+00005cf0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00005d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d10: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00005d20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00005d30: 2020 2020 2020 2020 2020 2254 6865 2061            "The a
+00005d40: 7267 756d 656e 7420 6066 6561 7475 7265  rgument `feature
+00005d50: 7360 2068 6173 2074 6f20 6265 206f 6620  s` has to be of 
+00005d60: 7479 7065 2060 4665 6174 7572 6560 206f  type `Feature` o
+00005d70: 7220 220a 2020 2020 2020 2020 2020 2020  r ".            
+00005d80: 2020 2020 2020 2020 2020 2020 2261 206c              "a l
+00005d90: 6973 7420 7468 6572 656f 662c 2062 7574  ist thereof, but
+00005da0: 2061 6e20 656c 656d 656e 7420 6973 206f   an element is o
+00005db0: 6620 7479 7065 3a20 607b 7d60 222e 666f  f type: `{}`".fo
+00005dc0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
+00005dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005de0: 2020 7479 7065 2866 6561 7475 7265 7329    type(features)
+00005df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005e00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00005e10: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00005e20: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00005e30: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00005e40: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
+00005e50: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+00005e60: 2061 7267 756d 656e 7420 6066 6561 7475   argument `featu
+00005e70: 7265 7360 2068 6173 2074 6f20 6265 206f  res` has to be o
+00005e80: 6620 7479 7065 2060 4665 6174 7572 6560  f type `Feature`
+00005e90: 206f 7220 6120 6c69 7374 2022 0a20 2020   or a list ".   
+00005ea0: 2020 2020 2020 2020 2020 2020 2022 7468               "th
+00005eb0: 6572 656f 662c 2062 7574 2069 7320 6f66  ereof, but is of
+00005ec0: 2074 7970 653a 2060 7b7d 6022 2e66 6f72   type: `{}`".for
+00005ed0: 6d61 7428 7479 7065 2866 6561 7475 7265  mat(type(feature
+00005ee0: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+00005ef0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00005f00: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
+00005f10: 6769 6e65 2e61 7070 656e 645f 6665 6174  gine.append_feat
+00005f20: 7572 6573 2873 656c 662c 206e 6577 5f66  ures(self, new_f
+00005f30: 6561 7475 7265 7329 0a20 2020 2020 2020  eatures).       
+00005f40: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+00005f50: 2020 6465 6620 6765 745f 6578 7065 6374    def get_expect
+00005f60: 6174 696f 6e5f 7375 6974 6528 0a20 2020  ation_suite(.   
+00005f70: 2020 2020 2073 656c 662c 2067 655f 7479       self, ge_ty
+00005f80: 7065 3a20 626f 6f6c 203d 2054 7275 650a  pe: bool = True.
+00005f90: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b45      ) -> Union[E
+00005fa0: 7870 6563 7461 7469 6f6e 5375 6974 652c  xpectationSuite,
+00005fb0: 2067 652e 636f 7265 2e45 7870 6563 7461   ge.core.Expecta
+00005fc0: 7469 6f6e 5375 6974 652c 204e 6f6e 655d  tionSuite, None]
+00005fd0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
+00005fe0: 7572 6e20 7468 6520 6578 7065 6374 6174  urn the expectat
+00005ff0: 696f 6e20 7375 6974 6520 6174 7461 6368  ion suite attach
+00006000: 6564 2074 6f20 7468 6520 6665 6174 7572  ed to the featur
+00006010: 6520 6772 6f75 7020 6966 2069 7420 6578  e group if it ex
+00006020: 6973 7473 2e0a 0a20 2020 2020 2020 2021  ists...        !
+00006030: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
+00006040: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00006050: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+00006060: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
+00006070: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
+00006080: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
+00006090: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000060a0: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
+000060b0: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
+000060c0: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
+000060d0: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
+000060e0: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
+000060f0: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
+00006100: 2065 7870 5f73 7569 7465 203d 2066 672e   exp_suite = fg.
+00006110: 6765 745f 6578 7065 6374 6174 696f 6e5f  get_expectation_
+00006120: 7375 6974 6528 290a 2020 2020 2020 2020  suite().        
+00006130: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
+00006140: 2023 2041 7267 756d 656e 7473 0a20 2020   # Arguments.   
+00006150: 2020 2020 2020 2020 2067 655f 7479 7065           ge_type
+00006160: 3a20 4966 2060 5472 7565 6020 7265 7475  : If `True` retu
+00006170: 726e 7320 6120 6e61 7469 7665 2047 7265  rns a native Gre
+00006180: 6174 2045 7870 6563 7461 7469 6f6e 2074  at Expectation t
+00006190: 7970 652c 2048 6f70 7377 6f72 6b73 0a20  ype, Hopsworks. 
+000061a0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000061b0: 7573 746f 6d20 7479 7065 206f 7468 6572  ustom type other
+000061c0: 7769 7365 2e20 436f 6e76 6572 7369 6f6e  wise. Conversion
+000061d0: 2063 616e 2062 6520 7065 7266 6f72 6d65   can be performe
+000061e0: 6420 7669 6120 7468 6520 6074 6f5f 6765  d via the `to_ge
+000061f0: 5f74 7970 6528 2960 0a20 2020 2020 2020  _type()`.       
+00006200: 2020 2020 2020 2020 206d 6574 686f 6420           method 
+00006210: 6f6e 2068 6f70 7377 6f72 6b73 2074 7970  on hopsworks typ
+00006220: 652e 2044 6566 6175 6c74 7320 746f 2060  e. Defaults to `
+00006230: 5472 7565 602e 0a0a 2020 2020 2020 2020  True`...        
+00006240: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
+00006250: 2020 2020 2020 6045 7870 6563 7461 7469        `Expectati
+00006260: 6f6e 5375 6974 6560 2e20 5468 6520 6578  onSuite`. The ex
+00006270: 7065 6374 6174 696f 6e20 7375 6974 6520  pectation suite 
+00006280: 6174 7461 6368 6564 2074 6f20 7468 6520  attached to the 
+00006290: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
+000062a0: 2020 2020 2020 2020 2320 5261 6973 6573          # Raises
+000062b0: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
+000062c0: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
+000062d0: 696f 6e73 2e52 6573 7441 5049 4572 726f  ions.RestAPIErro
+000062e0: 7260 2e0a 2020 2020 2020 2020 2222 220a  r`..        """.
+000062f0: 2020 2020 2020 2020 2320 4176 6f69 6420          # Avoid 
+00006300: 7468 726f 7769 6e67 2061 6e20 6572 726f  throwing an erro
+00006310: 7220 6966 2046 6561 7475 7265 2047 726f  r if Feature Gro
+00006320: 7570 206e 6f74 2069 6e69 7469 616c 6973  up not initialis
+00006330: 6564 2e0a 2020 2020 2020 2020 6966 2073  ed..        if s
+00006340: 656c 662e 5f69 643a 0a20 2020 2020 2020  elf._id:.       
+00006350: 2020 2020 2073 656c 662e 5f65 7870 6563       self._expec
+00006360: 7461 7469 6f6e 5f73 7569 7465 203d 2073  tation_suite = s
+00006370: 656c 662e 5f65 7870 6563 7461 7469 6f6e  elf._expectation
+00006380: 5f73 7569 7465 5f65 6e67 696e 652e 6765  _suite_engine.ge
+00006390: 7428 290a 0a20 2020 2020 2020 2069 6620  t()..        if 
+000063a0: 7365 6c66 2e5f 6578 7065 6374 6174 696f  self._expectatio
+000063b0: 6e5f 7375 6974 6520 6973 206e 6f74 204e  n_suite is not N
+000063c0: 6f6e 6520 616e 6420 6765 5f74 7970 6520  one and ge_type 
+000063d0: 6973 2054 7275 653a 0a20 2020 2020 2020  is True:.       
+000063e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000063f0: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
+00006400: 6974 652e 746f 5f67 655f 7479 7065 2829  ite.to_ge_type()
+00006410: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00006420: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00006430: 6e20 7365 6c66 2e5f 6578 7065 6374 6174  n self._expectat
+00006440: 696f 6e5f 7375 6974 650a 0a20 2020 2064  ion_suite..    d
+00006450: 6566 2073 6176 655f 6578 7065 6374 6174  ef save_expectat
+00006460: 696f 6e5f 7375 6974 6528 0a20 2020 2020  ion_suite(.     
+00006470: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00006480: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
+00006490: 7465 3a20 556e 696f 6e5b 4578 7065 6374  te: Union[Expect
+000064a0: 6174 696f 6e53 7569 7465 2c20 6765 2e63  ationSuite, ge.c
+000064b0: 6f72 652e 4578 7065 6374 6174 696f 6e53  ore.ExpectationS
+000064c0: 7569 7465 5d2c 0a20 2020 2020 2020 2072  uite],.        r
+000064d0: 756e 5f76 616c 6964 6174 696f 6e3a 2062  un_validation: b
+000064e0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
+000064f0: 2020 2020 7661 6c69 6461 7469 6f6e 5f69      validation_i
+00006500: 6e67 6573 7469 6f6e 5f70 6f6c 6963 793a  ngestion_policy:
+00006510: 2073 7472 203d 2022 414c 5741 5953 222c   str = "ALWAYS",
+00006520: 0a20 2020 2020 2020 206f 7665 7277 7269  .        overwri
+00006530: 7465 3a20 626f 6f6c 203d 2046 616c 7365  te: bool = False
+00006540: 2c0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ,.    ) -> Union
+00006550: 5b45 7870 6563 7461 7469 6f6e 5375 6974  [ExpectationSuit
+00006560: 652c 2067 652e 636f 7265 2e45 7870 6563  e, ge.core.Expec
+00006570: 7461 7469 6f6e 5375 6974 655d 3a0a 2020  tationSuite]:.  
+00006580: 2020 2020 2020 2222 2241 7474 6163 6820        """Attach 
+00006590: 616e 2065 7870 6563 7461 7469 6f6e 2073  an expectation s
+000065a0: 7569 7465 2074 6f20 6120 6665 6174 7572  uite to a featur
+000065b0: 6520 6772 6f75 7020 616e 6420 7361 7665  e group and save
+000065c0: 7320 6974 2066 6f72 2066 7574 7572 6520  s it for future 
+000065d0: 7573 652e 2049 6620 616e 2065 7870 6563  use. If an expec
+000065e0: 7461 7469 6f6e 0a20 2020 2020 2020 2073  tation.        s
+000065f0: 7569 7465 2069 7320 616c 7265 6164 7920  uite is already 
+00006600: 6174 7461 6368 6564 2c20 6974 2069 7320  attached, it is 
+00006610: 7265 706c 6163 6564 2e20 4e6f 7465 2074  replaced. Note t
+00006620: 6861 7420 7468 6520 7072 6f76 6964 6564  hat the provided
+00006630: 2065 7870 6563 7461 7469 6f6e 2073 7569   expectation sui
+00006640: 7465 2069 7320 6d6f 6469 6669 6564 0a20  te is modified. 
+00006650: 2020 2020 2020 2069 6e70 6c61 6365 2074         inplace t
+00006660: 6f20 696e 636c 7564 6520 6578 7065 6374  o include expect
+00006670: 6174 696f 6e49 6420 6669 656c 6473 2e0a  ationId fields..
+00006680: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+00006690: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+000066a0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+000066b0: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+000066c0: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+000066d0: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+000066e0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+000066f0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+00006700: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+00006710: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+00006720: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+00006730: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+00006740: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
+00006750: 2020 2020 2020 2020 2020 2066 672e 7361             fg.sa
+00006760: 7665 5f65 7870 6563 7461 7469 6f6e 5f73  ve_expectation_s
+00006770: 7569 7465 2865 7870 6563 7461 7469 6f6e  uite(expectation
+00006780: 5f73 7569 7465 2c20 7275 6e5f 7661 6c69  _suite, run_vali
+00006790: 6461 7469 6f6e 3d54 7275 6529 0a20 2020  dation=True).   
+000067a0: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
+000067b0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+000067c0: 730a 2020 2020 2020 2020 2020 2020 6578  s.            ex
+000067d0: 7065 6374 6174 696f 6e5f 7375 6974 653a  pectation_suite:
+000067e0: 2054 6865 2065 7870 6563 7461 7469 6f6e   The expectation
+000067f0: 2073 7569 7465 2074 6f20 6174 7461 6368   suite to attach
+00006800: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+00006810: 4772 6f75 702e 0a20 2020 2020 2020 2020  Group..         
+00006820: 2020 206f 7665 7277 7269 7465 3a20 4966     overwrite: If
+00006830: 2061 6e20 4578 7065 6374 6174 696f 6e20   an Expectation 
+00006840: 5375 6974 6520 6973 2061 6c72 6561 6479  Suite is already
+00006850: 2061 7474 6163 6865 642c 206f 7665 7277   attached, overw
+00006860: 7269 7465 2069 742e 0a20 2020 2020 2020  rite it..       
+00006870: 2020 2020 2020 2020 2054 6865 206e 6577           The new
+00006880: 2073 7569 7465 2077 696c 6c20 6861 7665   suite will have
+00006890: 2069 7473 206f 776e 2076 616c 6964 6174   its own validat
+000068a0: 696f 6e20 6869 7374 6f72 792c 2062 7574  ion history, but
+000068b0: 2066 6f72 6d65 7220 7265 706f 7274 7320   former reports 
+000068c0: 6172 6520 7072 6573 6572 7665 642e 0a20  are preserved.. 
+000068d0: 2020 2020 2020 2020 2020 2072 756e 5f76             run_v
+000068e0: 616c 6964 6174 696f 6e3a 2053 6574 2077  alidation: Set w
+000068f0: 6865 7468 6572 2074 6865 2065 7870 6563  hether the expec
+00006900: 7461 7469 6f6e 5f73 7569 7465 2077 696c  tation_suite wil
+00006910: 6c20 7275 6e20 6f6e 2069 6e67 6573 7469  l run on ingesti
+00006920: 6f6e 0a20 2020 2020 2020 2020 2020 2076  on.            v
+00006930: 616c 6964 6174 696f 6e5f 696e 6765 7374  alidation_ingest
+00006940: 696f 6e5f 706f 6c69 6379 3a20 5365 7420  ion_policy: Set 
+00006950: 7468 6520 706f 6c69 6379 2066 6f72 2069  the policy for i
+00006960: 6e67 6573 7469 6f6e 2074 6f20 7468 6520  ngestion to the 
+00006970: 4665 6174 7572 6520 4772 6f75 702e 0a20  Feature Group.. 
+00006980: 2020 2020 2020 2020 2020 2020 2020 202d                 -
+00006990: 2022 5354 5249 4354 2220 6f6e 6c79 2061   "STRICT" only a
+000069a0: 6c6c 6f77 7320 4461 7461 4672 616d 6520  llows DataFrame 
+000069b0: 7061 7373 696e 6720 7661 6c69 6461 7469  passing validati
+000069c0: 6f6e 2074 6f20 6265 2069 6e73 6572 7465  on to be inserte
+000069d0: 6420 696e 746f 2046 6561 7475 7265 2047  d into Feature G
+000069e0: 726f 7570 2e0a 2020 2020 2020 2020 2020  roup..          
+000069f0: 2020 2020 2020 2d20 2241 4c57 4159 5322        - "ALWAYS"
+00006a00: 2061 6c77 6179 7320 696e 7365 7274 2074   always insert t
+00006a10: 6865 2044 6174 6146 7261 6d65 2074 6f20  he DataFrame to 
+00006a20: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+00006a30: 702c 2069 7272 6573 7065 6374 6976 6520  p, irrespective 
+00006a40: 6f66 206f 7665 7261 6c6c 2076 616c 6964  of overall valid
+00006a50: 6174 696f 6e20 7265 7375 6c74 2e0a 0a20  ation result... 
+00006a60: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
+00006a70: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
+00006a80: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
+00006a90: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
+00006aa0: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
+00006ab0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00006ac0: 616e 6365 2865 7870 6563 7461 7469 6f6e  ance(expectation
+00006ad0: 5f73 7569 7465 2c20 6765 2e63 6f72 652e  _suite, ge.core.
+00006ae0: 4578 7065 6374 6174 696f 6e53 7569 7465  ExpectationSuite
+00006af0: 293a 0a20 2020 2020 2020 2020 2020 2074  ):.            t
+00006b00: 6d70 5f65 7870 6563 7461 7469 6f6e 5f73  mp_expectation_s
+00006b10: 7569 7465 203d 2045 7870 6563 7461 7469  uite = Expectati
+00006b20: 6f6e 5375 6974 652e 6672 6f6d 5f67 655f  onSuite.from_ge_
+00006b30: 7479 7065 280a 2020 2020 2020 2020 2020  type(.          
+00006b40: 2020 2020 2020 6765 5f65 7870 6563 7461        ge_expecta
+00006b50: 7469 6f6e 5f73 7569 7465 3d65 7870 6563  tion_suite=expec
+00006b60: 7461 7469 6f6e 5f73 7569 7465 2c0a 2020  tation_suite,.  
+00006b70: 2020 2020 2020 2020 2020 2020 2020 7275                ru
+00006b80: 6e5f 7661 6c69 6461 7469 6f6e 3d72 756e  n_validation=run
+00006b90: 5f76 616c 6964 6174 696f 6e2c 0a20 2020  _validation,.   
+00006ba0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00006bb0: 6964 6174 696f 6e5f 696e 6765 7374 696f  idation_ingestio
+00006bc0: 6e5f 706f 6c69 6379 3d76 616c 6964 6174  n_policy=validat
+00006bd0: 696f 6e5f 696e 6765 7374 696f 6e5f 706f  ion_ingestion_po
+00006be0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+00006bf0: 2020 2020 2020 6665 6174 7572 655f 7374        feature_st
+00006c00: 6f72 655f 6964 3d73 656c 662e 5f66 6561  ore_id=self._fea
+00006c10: 7475 7265 5f73 746f 7265 5f69 642c 0a20  ture_store_id,. 
+00006c20: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00006c30: 6561 7475 7265 5f67 726f 7570 5f69 643d  eature_group_id=
+00006c40: 7365 6c66 2e5f 6964 2c0a 2020 2020 2020  self._id,.      
+00006c50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00006c60: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00006c70: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00006c80: 652c 2045 7870 6563 7461 7469 6f6e 5375  e, ExpectationSu
+00006c90: 6974 6529 3a0a 2020 2020 2020 2020 2020  ite):.          
+00006ca0: 2020 746d 705f 6578 7065 6374 6174 696f    tmp_expectatio
+00006cb0: 6e5f 7375 6974 6520 3d20 6578 7065 6374  n_suite = expect
+00006cc0: 6174 696f 6e5f 7375 6974 652e 746f 5f6a  ation_suite.to_j
+00006cd0: 736f 6e5f 6469 6374 2864 6563 616d 656c  son_dict(decamel
+00006ce0: 697a 653d 5472 7565 290a 2020 2020 2020  ize=True).      
+00006cf0: 2020 2020 2020 746d 705f 6578 7065 6374        tmp_expect
+00006d00: 6174 696f 6e5f 7375 6974 655b 2266 6561  ation_suite["fea
+00006d10: 7475 7265 5f67 726f 7570 5f69 6422 5d20  ture_group_id"] 
+00006d20: 3d20 7365 6c66 2e5f 6964 0a20 2020 2020  = self._id.     
+00006d30: 2020 2020 2020 2074 6d70 5f65 7870 6563         tmp_expec
+00006d40: 7461 7469 6f6e 5f73 7569 7465 5b22 6665  tation_suite["fe
+00006d50: 6174 7572 655f 7374 6f72 655f 6964 225d  ature_store_id"]
+00006d60: 203d 2073 656c 662e 5f66 6561 7475 7265   = self._feature
+00006d70: 5f73 746f 7265 5f69 640a 2020 2020 2020  _store_id.      
+00006d80: 2020 2020 2020 746d 705f 6578 7065 6374        tmp_expect
+00006d90: 6174 696f 6e5f 7375 6974 6520 3d20 4578  ation_suite = Ex
+00006da0: 7065 6374 6174 696f 6e53 7569 7465 282a  pectationSuite(*
+00006db0: 2a74 6d70 5f65 7870 6563 7461 7469 6f6e  *tmp_expectation
+00006dc0: 5f73 7569 7465 290a 2020 2020 2020 2020  _suite).        
+00006dd0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00006de0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00006df0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00006e00: 2020 2022 5468 6520 7072 6f76 6964 6564     "The provided
+00006e10: 2065 7870 6563 7461 7469 6f6e 2073 7569   expectation sui
+00006e20: 7465 2074 7970 6520 607b 7d60 2069 7320  te type `{}` is 
+00006e30: 6e6f 7420 7375 7070 6f72 7465 642e 2055  not supported. U
+00006e40: 7365 2047 7265 6174 2045 7870 6563 7461  se Great Expecta
+00006e50: 7469 6f6e 2060 4578 7065 6374 6174 696f  tion `Expectatio
+00006e60: 6e53 7569 7465 6020 6f72 2048 5346 5327  nSuite` or HSFS'
+00006e70: 206f 776e 2060 4578 7065 6374 6174 696f   own `Expectatio
+00006e80: 6e53 7569 7465 6020 6f62 6a65 6374 2e22  nSuite` object."
+00006e90: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
+00006ea0: 2020 2020 2020 2020 2020 2020 2074 7970               typ
+00006eb0: 6528 6578 7065 6374 6174 696f 6e5f 7375  e(expectation_su
+00006ec0: 6974 6529 0a20 2020 2020 2020 2020 2020  ite).           
+00006ed0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00006ee0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00006ef0: 206f 7665 7277 7269 7465 3a0a 2020 2020   overwrite:.    
+00006f00: 2020 2020 2020 2020 7365 6c66 2e64 656c          self.del
+00006f10: 6574 655f 6578 7065 6374 6174 696f 6e5f  ete_expectation_
+00006f20: 7375 6974 6528 290a 0a20 2020 2020 2020  suite()..       
+00006f30: 2069 6620 7365 6c66 2e5f 6964 3a0a 2020   if self._id:.  
+00006f40: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00006f50: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00006f60: 6520 3d20 7365 6c66 2e5f 6578 7065 6374  e = self._expect
+00006f70: 6174 696f 6e5f 7375 6974 655f 656e 6769  ation_suite_engi
+00006f80: 6e65 2e73 6176 6528 0a20 2020 2020 2020  ne.save(.       
+00006f90: 2020 2020 2020 2020 2074 6d70 5f65 7870           tmp_exp
+00006fa0: 6563 7461 7469 6f6e 5f73 7569 7465 0a20  ectation_suite. 
+00006fb0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00006fc0: 2020 2020 2020 2020 2065 7870 6563 7461           expecta
+00006fd0: 7469 6f6e 5f73 7569 7465 203d 2073 656c  tion_suite = sel
+00006fe0: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
+00006ff0: 7569 7465 2e74 6f5f 6765 5f74 7970 6528  uite.to_ge_type(
+00007000: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00007010: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
+00007020: 6465 6420 746f 2061 766f 6964 2074 6872  ded to avoid thr
+00007030: 6f77 696e 6720 616e 2065 7272 6f72 2069  owing an error i
+00007040: 6620 4665 6174 7572 6520 4772 6f75 7020  f Feature Group 
+00007050: 6973 206e 6f74 2069 6e69 7469 616c 6973  is not initialis
+00007060: 6564 2077 6974 6820 7468 6520 6261 636b  ed with the back
+00007070: 656e 640a 2020 2020 2020 2020 2020 2020  end.            
+00007080: 7365 6c66 2e5f 6578 7065 6374 6174 696f  self._expectatio
+00007090: 6e5f 7375 6974 6520 3d20 746d 705f 6578  n_suite = tmp_ex
+000070a0: 7065 6374 6174 696f 6e5f 7375 6974 650a  pectation_suite.
+000070b0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
+000070c0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+000070d0: 6528 7365 6c66 2920 2d3e 204e 6f6e 653a  e(self) -> None:
+000070e0: 0a20 2020 2020 2020 2022 2222 4465 6c65  .        """Dele
+000070f0: 7465 2074 6865 2065 7870 6563 7461 7469  te the expectati
+00007100: 6f6e 2073 7569 7465 2061 7474 6163 6865  on suite attache
+00007110: 6420 746f 2074 6865 2046 6561 7475 7265  d to the Feature
+00007120: 2047 726f 7570 2e0a 0a20 2020 2020 2020   Group...       
+00007130: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+00007140: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00007150: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
+00007160: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
+00007170: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
+00007180: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
+00007190: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
+000071a0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
+000071b0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
+000071c0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+000071d0: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
+000071e0: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+000071f0: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
+00007200: 2020 2066 672e 6465 6c65 7465 5f65 7870     fg.delete_exp
+00007210: 6563 7461 7469 6f6e 5f73 7569 7465 2829  ectation_suite()
+00007220: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00007230: 0a0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
+00007240: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
+00007250: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
+00007260: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
+00007270: 726f 7260 2e0a 2020 2020 2020 2020 2222  ror`..        ""
+00007280: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
+00007290: 662e 6765 745f 6578 7065 6374 6174 696f  f.get_expectatio
+000072a0: 6e5f 7375 6974 6528 2920 6973 206e 6f74  n_suite() is not
+000072b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000072c0: 2020 2073 656c 662e 5f65 7870 6563 7461     self._expecta
+000072d0: 7469 6f6e 5f73 7569 7465 5f65 6e67 696e  tion_suite_engin
+000072e0: 652e 6465 6c65 7465 2873 656c 662e 5f65  e.delete(self._e
+000072f0: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+00007300: 2e69 6429 0a20 2020 2020 2020 2073 656c  .id).        sel
+00007310: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
+00007320: 7569 7465 203d 204e 6f6e 650a 0a20 2020  uite = None..   
+00007330: 2064 6566 2067 6574 5f6c 6174 6573 745f   def get_latest_
+00007340: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
+00007350: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00007360: 2067 655f 7479 7065 3a20 626f 6f6c 203d   ge_type: bool =
+00007370: 2054 7275 650a 2020 2020 2920 2d3e 2055   True.    ) -> U
+00007380: 6e69 6f6e 5b56 616c 6964 6174 696f 6e52  nion[ValidationR
+00007390: 6570 6f72 742c 2067 652e 636f 7265 2e45  eport, ge.core.E
+000073a0: 7870 6563 7461 7469 6f6e 5375 6974 6556  xpectationSuiteV
+000073b0: 616c 6964 6174 696f 6e52 6573 756c 742c  alidationResult,
+000073c0: 204e 6f6e 655d 3a0a 2020 2020 2020 2020   None]:.        
+000073d0: 2222 2252 6574 7572 6e20 7468 6520 6c61  """Return the la
+000073e0: 7465 7374 2076 616c 6964 6174 696f 6e20  test validation 
+000073f0: 7265 706f 7274 2061 7474 6163 6865 6420  report attached 
+00007400: 746f 2074 6865 2046 6561 7475 7265 2047  to the Feature G
+00007410: 726f 7570 2069 6620 6974 2065 7869 7374  roup if it exist
+00007420: 732e 0a0a 2020 2020 2020 2020 2121 2120  s...        !!! 
+00007430: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
+00007440: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+00007450: 2020 2020 2020 2020 2020 2320 636f 6e6e            # conn
+00007460: 6563 7420 746f 2074 6865 2046 6561 7475  ect to the Featu
+00007470: 7265 2053 746f 7265 0a20 2020 2020 2020  re Store.       
+00007480: 2020 2020 2066 7320 3d20 2e2e 2e0a 0a20       fs = ..... 
+00007490: 2020 2020 2020 2020 2020 2023 2067 6574             # get
+000074a0: 2074 6865 2046 6561 7475 7265 2047 726f   the Feature Gro
+000074b0: 7570 2069 6e73 7461 6e63 650a 2020 2020  up instance.    
+000074c0: 2020 2020 2020 2020 6667 203d 2066 732e          fg = fs.
+000074d0: 6765 745f 6f72 5f63 7265 6174 655f 6665  get_or_create_fe
+000074e0: 6174 7572 655f 6772 6f75 7028 2e2e 2e29  ature_group(...)
+000074f0: 0a0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
+00007500: 7465 7374 5f76 616c 5f72 6570 6f72 7420  test_val_report 
+00007510: 3d20 6667 2e67 6574 5f6c 6174 6573 745f  = fg.get_latest_
+00007520: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
+00007530: 7428 290a 2020 2020 2020 2020 2020 2020  t().            
+00007540: 6060 600a 0a20 2020 2020 2020 2023 2041  ```..        # A
+00007550: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00007560: 2020 2020 2067 655f 7479 7065 3a20 4966       ge_type: If
+00007570: 2060 5472 7565 6020 7265 7475 726e 7320   `True` returns 
+00007580: 6120 6e61 7469 7665 2047 7265 6174 2045  a native Great E
+00007590: 7870 6563 7461 7469 6f6e 2074 7970 652c  xpectation type,
+000075a0: 2048 6f70 7377 6f72 6b73 0a20 2020 2020   Hopsworks.     
+000075b0: 2020 2020 2020 2020 2020 2063 7573 746f             custo
+000075c0: 6d20 7479 7065 206f 7468 6572 7769 7365  m type otherwise
+000075d0: 2e20 436f 6e76 6572 7369 6f6e 2063 616e  . Conversion can
+000075e0: 2062 6520 7065 7266 6f72 6d65 6420 7669   be performed vi
+000075f0: 6120 7468 6520 6074 6f5f 6765 5f74 7970  a the `to_ge_typ
+00007600: 6528 2960 0a20 2020 2020 2020 2020 2020  e()`.           
+00007610: 2020 2020 206d 6574 686f 6420 6f6e 2068       method on h
+00007620: 6f70 7377 6f72 6b73 2074 7970 652e 2044  opsworks type. D
+00007630: 6566 6175 6c74 7320 746f 2060 5472 7565  efaults to `True
+00007640: 602e 0a0a 2020 2020 2020 2020 2320 5265  `...        # Re
+00007650: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
+00007660: 2020 6056 616c 6964 6174 696f 6e52 6570    `ValidationRep
+00007670: 6f72 7460 2e20 5468 6520 6c61 7465 7374  ort`. The latest
+00007680: 2076 616c 6964 6174 696f 6e20 7265 706f   validation repo
+00007690: 7274 2061 7474 6163 6865 6420 746f 2074  rt attached to t
+000076a0: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
+000076b0: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
+000076c0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+000076d0: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+000076e0: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+000076f0: 7272 6f72 602e 0a20 2020 2020 2020 2022  rror`..        "
+00007700: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00007710: 6e20 7365 6c66 2e5f 7661 6c69 6461 7469  n self._validati
+00007720: 6f6e 5f72 6570 6f72 745f 656e 6769 6e65  on_report_engine
+00007730: 2e67 6574 5f6c 6173 7428 6765 5f74 7970  .get_last(ge_typ
+00007740: 653d 6765 5f74 7970 6529 0a0a 2020 2020  e=ge_type)..    
+00007750: 6465 6620 6765 745f 616c 6c5f 7661 6c69  def get_all_vali
+00007760: 6461 7469 6f6e 5f72 6570 6f72 7473 280a  dation_reports(.
+00007770: 2020 2020 2020 2020 7365 6c66 2c20 6765          self, ge
+00007780: 5f74 7970 653a 2062 6f6f 6c20 3d20 5472  _type: bool = Tr
+00007790: 7565 0a20 2020 2029 202d 3e20 4c69 7374  ue.    ) -> List
+000077a0: 5b55 6e69 6f6e 5b56 616c 6964 6174 696f  [Union[Validatio
+000077b0: 6e52 6570 6f72 742c 2067 652e 636f 7265  nReport, ge.core
+000077c0: 2e45 7870 6563 7461 7469 6f6e 5375 6974  .ExpectationSuit
+000077d0: 6556 616c 6964 6174 696f 6e52 6573 756c  eValidationResul
+000077e0: 745d 5d3a 0a20 2020 2020 2020 2022 2222  t]]:.        """
+000077f0: 5265 7475 726e 2074 6865 206c 6174 6573  Return the lates
+00007800: 7420 7661 6c69 6461 7469 6f6e 2072 6570  t validation rep
+00007810: 6f72 7420 6174 7461 6368 6564 2074 6f20  ort attached to 
+00007820: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+00007830: 7020 6966 2069 7420 6578 6973 7473 2e0a  p if it exists..
+00007840: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+00007850: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+00007860: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00007870: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+00007880: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+00007890: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+000078a0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+000078b0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+000078c0: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+000078d0: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+000078e0: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+000078f0: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+00007900: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
+00007910: 2020 2020 2020 2020 2020 2076 616c 5f72             val_r
+00007920: 6570 6f72 7473 203d 2066 672e 6765 745f  eports = fg.get_
+00007930: 616c 6c5f 7661 6c69 6461 7469 6f6e 5f72  all_validation_r
+00007940: 6570 6f72 7473 2829 0a20 2020 2020 2020  eports().       
+00007950: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00007960: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
+00007970: 2020 2020 2020 2020 2020 6765 5f74 7970            ge_typ
+00007980: 653a 2049 6620 6054 7275 6560 2072 6574  e: If `True` ret
+00007990: 7572 6e73 2061 206e 6174 6976 6520 4772  urns a native Gr
+000079a0: 6561 7420 4578 7065 6374 6174 696f 6e20  eat Expectation 
+000079b0: 7479 7065 2c20 486f 7073 776f 726b 730a  type, Hopsworks.
+000079c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079d0: 6375 7374 6f6d 2074 7970 6520 6f74 6865  custom type othe
+000079e0: 7277 6973 652e 2043 6f6e 7665 7273 696f  rwise. Conversio
+000079f0: 6e20 6361 6e20 6265 2070 6572 666f 726d  n can be perform
+00007a00: 6564 2076 6961 2074 6865 2060 746f 5f67  ed via the `to_g
+00007a10: 655f 7479 7065 2829 600a 2020 2020 2020  e_type()`.      
+00007a20: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00007a30: 206f 6e20 686f 7073 776f 726b 7320 7479   on hopsworks ty
+00007a40: 7065 2e20 4465 6661 756c 7473 2074 6f20  pe. Defaults to 
+00007a50: 6054 7275 6560 2e0a 0a20 2020 2020 2020  `True`...       
+00007a60: 2023 2052 6574 7572 6e73 0a20 2020 2020   # Returns.     
+00007a70: 2020 2020 2020 2055 6e69 6f6e 5b4c 6973         Union[Lis
+00007a80: 745b 6056 616c 6964 6174 696f 6e52 6570  t[`ValidationRep
+00007a90: 6f72 7460 5d2c 2060 5661 6c69 6461 7469  ort`], `Validati
+00007aa0: 6f6e 5265 706f 7274 605d 2e20 416c 6c20  onReport`]. All 
+00007ab0: 7661 6c69 6461 7469 6f6e 2072 6570 6f72  validation repor
+00007ac0: 7473 2061 7474 6163 6865 6420 746f 2074  ts attached to t
+00007ad0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00007ae0: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
+00007af0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+00007b00: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+00007b10: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+00007b20: 7272 6f72 602e 0a20 2020 2020 2020 2020  rror`..         
+00007b30: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
+00007b40: 6578 6365 7074 696f 6e73 2e46 6561 7475  exceptions.Featu
+00007b50: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
+00007b60: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
+00007b70: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00007b80: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
+00007b90: 7265 7475 726e 2073 656c 662e 5f76 616c  return self._val
+00007ba0: 6964 6174 696f 6e5f 7265 706f 7274 5f65  idation_report_e
+00007bb0: 6e67 696e 652e 6765 745f 616c 6c28 6765  ngine.get_all(ge
+00007bc0: 5f74 7970 653d 6765 5f74 7970 6529 0a20  _type=ge_type). 
+00007bd0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00007be0: 2020 2020 2020 2020 2072 6169 7365 2046           raise F
+00007bf0: 6561 7475 7265 5374 6f72 6545 7863 6570  eatureStoreExcep
+00007c00: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00007c10: 2020 2020 2020 224f 6e6c 7920 4665 6174        "Only Feat
+00007c20: 7572 6520 4772 6f75 7020 7265 6769 7374  ure Group regist
+00007c30: 6572 6564 2077 6974 6820 486f 7073 776f  ered with Hopswo
+00007c40: 726b 7320 6361 6e20 6665 7463 6820 7661  rks can fetch va
+00007c50: 6c69 6461 7469 6f6e 2072 6570 6f72 7473  lidation reports
+00007c60: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+00007c70: 0a0a 2020 2020 6465 6620 7361 7665 5f76  ..    def save_v
+00007c80: 616c 6964 6174 696f 6e5f 7265 706f 7274  alidation_report
+00007c90: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00007ca0: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
+00007cb0: 6f6e 5f72 6570 6f72 743a 2055 6e69 6f6e  on_report: Union
+00007cc0: 5b0a 2020 2020 2020 2020 2020 2020 6469  [.            di
+00007cd0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+00007ce0: 5661 6c69 6461 7469 6f6e 5265 706f 7274  ValidationReport
+00007cf0: 2c0a 2020 2020 2020 2020 2020 2020 6765  ,.            ge
+00007d00: 2e63 6f72 652e 6578 7065 6374 6174 696f  .core.expectatio
+00007d10: 6e5f 7661 6c69 6461 7469 6f6e 5f72 6573  n_validation_res
+00007d20: 756c 742e 4578 7065 6374 6174 696f 6e53  ult.ExpectationS
+00007d30: 7569 7465 5661 6c69 6461 7469 6f6e 5265  uiteValidationRe
+00007d40: 7375 6c74 2c0a 2020 2020 2020 2020 5d2c  sult,.        ],
+00007d50: 0a20 2020 2020 2020 2069 6e67 6573 7469  .        ingesti
+00007d60: 6f6e 5f72 6573 756c 743a 2073 7472 203d  on_result: str =
+00007d70: 2022 554e 4b4e 4f57 4e22 2c0a 2020 2020   "UNKNOWN",.    
+00007d80: 2020 2020 6765 5f74 7970 653a 2062 6f6f      ge_type: boo
+00007d90: 6c20 3d20 5472 7565 2c0a 2020 2020 2920  l = True,.    ) 
+00007da0: 2d3e 2055 6e69 6f6e 5b56 616c 6964 6174  -> Union[Validat
+00007db0: 696f 6e52 6570 6f72 742c 2067 652e 636f  ionReport, ge.co
+00007dc0: 7265 2e45 7870 6563 7461 7469 6f6e 5375  re.ExpectationSu
+00007dd0: 6974 6556 616c 6964 6174 696f 6e52 6573  iteValidationRes
+00007de0: 756c 745d 3a0a 2020 2020 2020 2020 2222  ult]:.        ""
+00007df0: 2253 6176 6520 7661 6c69 6461 7469 6f6e  "Save validation
+00007e00: 2072 6570 6f72 7420 746f 2068 6f70 7377   report to hopsw
+00007e10: 6f72 6b73 2070 6c61 7466 6f72 6d20 616c  orks platform al
+00007e20: 6f6e 6720 7072 6576 696f 7573 2072 6570  ong previous rep
+00007e30: 6f72 7473 206f 6620 7468 6520 7361 6d65  orts of the same
+00007e40: 2046 6561 7475 7265 2047 726f 7570 2e0a   Feature Group..
+00007e50: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+00007e60: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+00007e70: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00007e80: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+00007e90: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+00007ea0: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+00007eb0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+00007ec0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+00007ed0: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+00007ee0: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+00007ef0: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+00007f00: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+00007f10: 7265 5f67 726f 7570 282e 2e2e 2c20 6578  re_group(..., ex
+00007f20: 7065 6374 6174 696f 6e5f 7375 6974 653d  pectation_suite=
+00007f30: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00007f40: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
+00007f50: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
+00007f60: 7420 3d20 6772 6561 745f 6578 7065 6374  t = great_expect
+00007f70: 6174 696f 6e73 2e66 726f 6d5f 7061 6e64  ations.from_pand
+00007f80: 6173 280a 2020 2020 2020 2020 2020 2020  as(.            
+00007f90: 2020 2020 6d79 5f65 7870 6572 696d 656e      my_experimen
+00007fa0: 7461 6c5f 6665 6174 7572 6573 5f64 662c  tal_features_df,
+00007fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007fc0: 2066 672e 6765 745f 6578 7065 6374 6174   fg.get_expectat
+00007fd0: 696f 6e5f 7375 6974 6528 2929 2e76 616c  ion_suite()).val
+00007fe0: 6964 6174 6528 290a 0a20 2020 2020 2020  idate()..       
+00007ff0: 2020 2020 2066 672e 7361 7665 5f76 616c       fg.save_val
+00008000: 6964 6174 696f 6e5f 7265 706f 7274 2876  idation_report(v
+00008010: 616c 6964 6174 696f 6e5f 7265 706f 7274  alidation_report
+00008020: 2c20 696e 6765 7374 696f 6e5f 7265 7375  , ingestion_resu
+00008030: 6c74 3d22 4558 5045 5249 4d45 4e54 2229  lt="EXPERIMENT")
+00008040: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00008050: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
+00008060: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
+00008070: 2020 7661 6c69 6461 7469 6f6e 5f72 6570    validation_rep
+00008080: 6f72 743a 2054 6865 2076 616c 6964 6174  ort: The validat
+00008090: 696f 6e20 7265 706f 7274 2074 6f20 6174  ion report to at
+000080a0: 7461 6368 2074 6f20 7468 6520 4665 6174  tach to the Feat
+000080b0: 7572 6520 4772 6f75 702e 0a20 2020 2020  ure Group..     
+000080c0: 2020 2020 2020 2069 6e67 6573 7469 6f6e         ingestion
+000080d0: 5f72 6573 756c 743a 2053 7065 6369 6679  _result: Specify
+000080e0: 2074 6865 2066 6174 6520 6f66 2074 6865   the fate of the
+000080f0: 2061 7373 6f63 6961 7465 6420 6461 7461   associated data
+00008100: 2c20 6465 6661 756c 7473 0a20 2020 2020  , defaults.     
+00008110: 2020 2020 2020 2020 2020 2074 6f20 2255             to "U
+00008120: 4e4b 4e4f 574e 222e 2053 7570 706f 7274  NKNOWN". Support
+00008130: 6564 206f 7074 696f 6e73 2061 7265 2020  ed options are  
+00008140: 2255 4e4b 4e4f 574e 222c 2022 494e 4745  "UNKNOWN", "INGE
+00008150: 5354 4544 222c 2022 5245 4a45 4354 4544  STED", "REJECTED
+00008160: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00008170: 2020 2022 4558 5045 5249 4d45 4e54 222c     "EXPERIMENT",
+00008180: 2022 4647 5f44 4154 4122 2e20 5573 6520   "FG_DATA". Use 
+00008190: 2249 4e47 4553 5445 4422 206f 7220 2252  "INGESTED" or "R
+000081a0: 454a 4543 5445 4422 2066 6f72 2076 616c  EJECTED" for val
+000081b0: 6964 6174 696f 6e0a 2020 2020 2020 2020  idation.        
+000081c0: 2020 2020 2020 2020 6f66 2044 6174 6146          of DataF
+000081d0: 7261 6d65 7320 746f 2062 6520 696e 7365  rames to be inse
+000081e0: 7274 6564 2069 6e20 7468 6520 4665 6174  rted in the Feat
+000081f0: 7572 6520 4772 6f75 702e 2055 7365 2022  ure Group. Use "
+00008200: 4558 5045 5249 4d45 4e54 220a 2020 2020  EXPERIMENT".    
+00008210: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00008220: 7465 7374 696e 6720 616e 6420 6465 7665  testing and deve
+00008230: 6c6f 706d 656e 7420 616e 6420 2246 475f  lopment and "FG_
+00008240: 4441 5441 2220 7768 656e 2076 616c 6964  DATA" when valid
+00008250: 6174 696e 6720 6461 7461 0a20 2020 2020  ating data.     
+00008260: 2020 2020 2020 2020 2020 2061 6c72 6561             alrea
+00008270: 6479 2069 6e20 7468 6520 4665 6174 7572  dy in the Featur
+00008280: 6520 4772 6f75 702e 0a20 2020 2020 2020  e Group..       
+00008290: 2020 2020 2067 655f 7479 7065 3a20 4966       ge_type: If
+000082a0: 2060 5472 7565 6020 7265 7475 726e 7320   `True` returns 
+000082b0: 6120 6e61 7469 7665 2047 7265 6174 2045  a native Great E
+000082c0: 7870 6563 7461 7469 6f6e 2074 7970 652c  xpectation type,
+000082d0: 2048 6f70 7377 6f72 6b73 0a20 2020 2020   Hopsworks.     
+000082e0: 2020 2020 2020 2020 2020 2063 7573 746f             custo
+000082f0: 6d20 7479 7065 206f 7468 6572 7769 7365  m type otherwise
+00008300: 2e20 436f 6e76 6572 7369 6f6e 2063 616e  . Conversion can
+00008310: 2062 6520 7065 7266 6f72 6d65 6420 7669   be performed vi
+00008320: 6120 7468 6520 6074 6f5f 6765 5f74 7970  a the `to_ge_typ
+00008330: 6528 2960 0a20 2020 2020 2020 2020 2020  e()`.           
+00008340: 2020 2020 206d 6574 686f 6420 6f6e 2068       method on h
+00008350: 6f70 7377 6f72 6b73 2074 7970 652e 2044  opsworks type. D
+00008360: 6566 6175 6c74 7320 746f 2060 5472 7565  efaults to `True
+00008370: 602e 0a0a 2020 2020 2020 2020 2320 5261  `...        # Ra
+00008380: 6973 6573 0a20 2020 2020 2020 2020 2020  ises.           
+00008390: 2060 6873 6673 2e63 6c69 656e 742e 6578   `hsfs.client.ex
+000083a0: 6365 7074 696f 6e73 2e52 6573 7441 5049  ceptions.RestAPI
+000083b0: 4572 726f 7260 2e0a 2020 2020 2020 2020  Error`..        
+000083c0: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+000083d0: 656c 662e 5f69 643a 0a20 2020 2020 2020  elf._id:.       
+000083e0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+000083f0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+00008400: 2020 2020 7661 6c69 6461 7469 6f6e 5f72      validation_r
+00008410: 6570 6f72 742c 0a20 2020 2020 2020 2020  eport,.         
+00008420: 2020 2020 2020 2067 652e 636f 7265 2e65         ge.core.e
+00008430: 7870 6563 7461 7469 6f6e 5f76 616c 6964  xpectation_valid
+00008440: 6174 696f 6e5f 7265 7375 6c74 2e45 7870  ation_result.Exp
+00008450: 6563 7461 7469 6f6e 5375 6974 6556 616c  ectationSuiteVal
+00008460: 6964 6174 696f 6e52 6573 756c 742c 0a20  idationResult,. 
+00008470: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+00008480: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00008490: 706f 7274 203d 2056 616c 6964 6174 696f  port = Validatio
+000084a0: 6e52 6570 6f72 7428 0a20 2020 2020 2020  nReport(.       
+000084b0: 2020 2020 2020 2020 2020 2020 202a 2a76               **v
+000084c0: 616c 6964 6174 696f 6e5f 7265 706f 7274  alidation_report
+000084d0: 2e74 6f5f 6a73 6f6e 5f64 6963 7428 292c  .to_json_dict(),
+000084e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000084f0: 2020 2020 2069 6e67 6573 7469 6f6e 5f72       ingestion_r
+00008500: 6573 756c 743d 696e 6765 7374 696f 6e5f  esult=ingestion_
+00008510: 7265 7375 6c74 2c0a 2020 2020 2020 2020  result,.        
+00008520: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00008530: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00008540: 7461 6e63 6528 7661 6c69 6461 7469 6f6e  tance(validation
+00008550: 5f72 6570 6f72 742c 2064 6963 7429 3a0a  _report, dict):.
+00008560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008570: 7265 706f 7274 203d 2056 616c 6964 6174  report = Validat
+00008580: 696f 6e52 6570 6f72 7428 0a20 2020 2020  ionReport(.     
+00008590: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+000085a0: 2a76 616c 6964 6174 696f 6e5f 7265 706f  *validation_repo
+000085b0: 7274 2c20 696e 6765 7374 696f 6e5f 7265  rt, ingestion_re
+000085c0: 7375 6c74 3d69 6e67 6573 7469 6f6e 5f72  sult=ingestion_r
+000085d0: 6573 756c 740a 2020 2020 2020 2020 2020  esult.          
+000085e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000085f0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00008600: 6e63 6528 7661 6c69 6461 7469 6f6e 5f72  nce(validation_r
+00008610: 6570 6f72 742c 2056 616c 6964 6174 696f  eport, Validatio
+00008620: 6e52 6570 6f72 7429 3a0a 2020 2020 2020  nReport):.      
+00008630: 2020 2020 2020 2020 2020 7265 706f 7274            report
+00008640: 203d 2076 616c 6964 6174 696f 6e5f 7265   = validation_re
+00008650: 706f 7274 0a20 2020 2020 2020 2020 2020  port.           
+00008660: 2020 2020 2069 6620 696e 6765 7374 696f       if ingestio
+00008670: 6e5f 7265 7375 6c74 2021 3d20 2255 4e4b  n_result != "UNK
+00008680: 4e4f 574e 223a 0a20 2020 2020 2020 2020  NOWN":.         
+00008690: 2020 2020 2020 2020 2020 2072 6570 6f72             repor
+000086a0: 742e 696e 6765 7374 696f 6e5f 7265 7375  t.ingestion_resu
+000086b0: 6c74 203d 2069 6e67 6573 7469 6f6e 5f72  lt = ingestion_r
+000086c0: 6573 756c 740a 0a20 2020 2020 2020 2020  esult..         
+000086d0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000086e0: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
+000086f0: 745f 656e 6769 6e65 2e73 6176 6528 0a20  t_engine.save(. 
+00008700: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00008710: 616c 6964 6174 696f 6e5f 7265 706f 7274  alidation_report
+00008720: 3d72 6570 6f72 742c 2067 655f 7479 7065  =report, ge_type
+00008730: 3d67 655f 7479 7065 0a20 2020 2020 2020  =ge_type.       
+00008740: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00008750: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00008760: 2072 6169 7365 2046 6561 7475 7265 5374   raise FeatureSt
+00008770: 6f72 6545 7863 6570 7469 6f6e 280a 2020  oreException(.  
+00008780: 2020 2020 2020 2020 2020 2020 2020 224f                "O
+00008790: 6e6c 7920 4665 6174 7572 6520 4772 6f75  nly Feature Grou
+000087a0: 7020 7265 6769 7374 6572 6564 2077 6974  p registered wit
+000087b0: 6820 486f 7073 776f 726b 7320 6361 6e20  h Hopsworks can 
+000087c0: 7570 6c6f 6164 2076 616c 6964 6174 696f  upload validatio
+000087d0: 6e20 7265 706f 7274 732e 220a 2020 2020  n reports.".    
+000087e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+000087f0: 6566 2067 6574 5f76 616c 6964 6174 696f  ef get_validatio
+00008800: 6e5f 6869 7374 6f72 7928 0a20 2020 2020  n_history(.     
+00008810: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00008820: 2065 7870 6563 7461 7469 6f6e 5f69 643a   expectation_id:
+00008830: 2069 6e74 2c0a 2020 2020 2020 2020 7374   int,.        st
+00008840: 6172 745f 7661 6c69 6461 7469 6f6e 5f74  art_validation_t
+00008850: 696d 653a 2055 6e69 6f6e 5b73 7472 2c20  ime: Union[str, 
+00008860: 696e 742c 2064 6174 6574 696d 652c 2064  int, datetime, d
+00008870: 6174 652c 204e 6f6e 655d 203d 204e 6f6e  ate, None] = Non
+00008880: 652c 0a20 2020 2020 2020 2065 6e64 5f76  e,.        end_v
+00008890: 616c 6964 6174 696f 6e5f 7469 6d65 3a20  alidation_time: 
+000088a0: 556e 696f 6e5b 7374 722c 2069 6e74 2c20  Union[str, int, 
+000088b0: 6461 7465 7469 6d65 2c20 6461 7465 2c20  datetime, date, 
+000088c0: 4e6f 6e65 5d20 3d20 4e6f 6e65 2c0a 2020  None] = None,.  
+000088d0: 2020 2020 2020 6669 6c74 6572 5f62 793a        filter_by:
+000088e0: 204c 6973 745b 7374 725d 203d 205b 5d2c   List[str] = [],
+000088f0: 0a20 2020 2020 2020 2067 655f 7479 7065  .        ge_type
+00008900: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+00008910: 2020 2029 202d 3e20 556e 696f 6e5b 4c69     ) -> Union[Li
+00008920: 7374 5b56 616c 6964 6174 696f 6e52 6573  st[ValidationRes
+00008930: 756c 745d 2c20 4c69 7374 5b67 652e 636f  ult], List[ge.co
+00008940: 7265 2e45 7870 6563 7461 7469 6f6e 5661  re.ExpectationVa
+00008950: 6c69 6461 7469 6f6e 5265 7375 6c74 5d5d  lidationResult]]
+00008960: 3a0a 2020 2020 2020 2020 2222 2246 6574  :.        """Fet
+00008970: 6368 2076 616c 6964 6174 696f 6e20 6869  ch validation hi
+00008980: 7374 6f72 7920 6f66 2061 6e20 4578 7065  story of an Expe
+00008990: 6374 6174 696f 6e20 7370 6563 6966 6965  ctation specifie
+000089a0: 6420 6279 2069 7473 2069 642e 0a0a 2020  d by its id...  
+000089b0: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
+000089c0: 650a 2020 2020 2020 2020 6060 6070 7974  e.        ```pyt
+000089d0: 686f 6e33 0a20 2020 2020 2020 2076 616c  hon3.        val
+000089e0: 6964 6174 696f 6e5f 6869 7374 6f72 7920  idation_history 
+000089f0: 3d20 6667 2e67 6574 5f76 616c 6964 6174  = fg.get_validat
+00008a00: 696f 6e5f 6869 7374 6f72 7928 0a20 2020  ion_history(.   
+00008a10: 2020 2020 2020 2020 2065 7870 6563 7461           expecta
+00008a20: 7469 6f6e 5f69 643d 312c 0a20 2020 2020  tion_id=1,.     
+00008a30: 2020 2020 2020 2066 696c 7465 725f 6279         filter_by
+00008a40: 3d5b 2252 454a 4543 5445 4422 2c20 2255  =["REJECTED", "U
+00008a50: 4e4b 4e4f 574e 225d 2c0a 2020 2020 2020  NKNOWN"],.      
+00008a60: 2020 2020 2020 7374 6172 745f 7661 6c69        start_vali
+00008a70: 6461 7469 6f6e 5f74 696d 653d 2232 3032  dation_time="202
+00008a80: 322d 3031 2d30 3120 3030 3a30 303a 3030  2-01-01 00:00:00
+00008a90: 222c 0a20 2020 2020 2020 2020 2020 2065  ",.            e
+00008aa0: 6e64 5f76 616c 6964 6174 696f 6e5f 7469  nd_validation_ti
+00008ab0: 6d65 3d64 6174 6574 696d 652e 6461 7465  me=datetime.date
+00008ac0: 7469 6d65 2e6e 6f77 2829 2c0a 2020 2020  time.now(),.    
+00008ad0: 2020 2020 2020 2020 6765 5f74 7970 653d          ge_type=
+00008ae0: 4661 6c73 650a 2020 2020 2020 2020 290a  False.        ).
+00008af0: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+00008b00: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+00008b10: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
+00008b20: 6563 7461 7469 6f6e 5f69 643a 2069 6420  ectation_id: id 
+00008b30: 6f66 2074 6865 2045 7870 6563 7461 7469  of the Expectati
+00008b40: 6f6e 2066 6f72 2077 6869 6368 2074 6f20  on for which to 
+00008b50: 6665 7463 6820 7468 6520 7661 6c69 6461  fetch the valida
+00008b60: 7469 6f6e 2068 6973 746f 7279 0a20 2020  tion history.   
+00008b70: 2020 2020 2020 2020 2066 696c 7465 725f           filter_
+00008b80: 6279 3a20 6c69 7374 206f 6620 696e 6765  by: list of inge
+00008b90: 7374 696f 6e5f 7265 7375 6c74 2063 6174  stion_result cat
+00008ba0: 6567 6f72 7920 746f 206b 6565 702e 204f  egory to keep. O
+00008bb0: 6f70 7469 6f6e 7320 6172 6520 2249 4e47  options are "ING
+00008bc0: 4553 5445 4422 2c20 2252 454a 4543 5445  ESTED", "REJECTE
+00008bd0: 4422 2c20 2246 475f 4441 5441 222c 2022  D", "FG_DATA", "
+00008be0: 4558 5045 5249 4d45 4e54 222c 2022 554e  EXPERIMENT", "UN
+00008bf0: 4b4e 4f57 4e22 2e0a 2020 2020 2020 2020  KNOWN"..        
+00008c00: 2020 2020 7374 6172 745f 7661 6c69 6461      start_valida
+00008c10: 7469 6f6e 5f74 696d 653a 2066 6574 6368  tion_time: fetch
+00008c20: 206f 6e6c 7920 7661 6c69 6461 7469 6f6e   only validation
+00008c30: 2072 6573 756c 7420 706f 7374 6572 696f   result posterio
+00008c40: 7220 746f 2074 6865 2070 726f 7669 6465  r to the provide
+00008c50: 6420 7469 6d65 2c20 696e 636c 7573 6976  d time, inclusiv
+00008c60: 652e 0a20 2020 2020 2020 2020 2020 2053  e..            S
+00008c70: 7570 706f 7274 6564 2066 6f72 6d61 7420  upported format 
+00008c80: 696e 636c 7564 6520 7469 6d65 7374 616d  include timestam
+00008c90: 7073 2869 6e74 292c 2064 6174 6574 696d  ps(int), datetim
+00008ca0: 652c 2064 6174 6520 6f72 2073 7472 696e  e, date or strin
+00008cb0: 6720 666f 726d 6174 7465 6420 746f 2062  g formatted to b
+00008cc0: 6520 6461 7475 7469 6c73 2070 6172 7361  e datutils parsa
+00008cd0: 626c 652e 2053 6565 2065 7861 6d70 6c65  ble. See example
+00008ce0: 7320 6162 6f76 652e 0a20 2020 2020 2020  s above..       
+00008cf0: 2020 2020 2065 6e64 5f76 616c 6964 6174       end_validat
+00008d00: 696f 6e5f 7469 6d65 3a20 6665 7463 6820  ion_time: fetch 
+00008d10: 6f6e 6c79 2076 616c 6964 6174 696f 6e20  only validation 
+00008d20: 7265 7375 6c74 2070 7269 6f72 2074 6f20  result prior to 
+00008d30: 7468 6520 7072 6f76 6964 6564 2074 696d  the provided tim
+00008d40: 652c 2069 6e63 6c75 7369 7665 2e0a 2020  e, inclusive..  
+00008d50: 2020 2020 2020 2020 2020 5375 7070 6f72            Suppor
+00008d60: 7465 6420 666f 726d 6174 2069 6e63 6c75  ted format inclu
+00008d70: 6465 2074 696d 6573 7461 6d70 7328 696e  de timestamps(in
+00008d80: 7429 2c20 6461 7465 7469 6d65 2c20 6461  t), datetime, da
+00008d90: 7465 206f 7220 7374 7269 6e67 2066 6f72  te or string for
+00008da0: 6d61 7474 6564 2074 6f20 6265 2064 6174  matted to be dat
+00008db0: 7574 696c 7320 7061 7273 6162 6c65 2e20  utils parsable. 
+00008dc0: 5365 6520 6578 616d 706c 6573 2061 626f  See examples abo
+00008dd0: 7665 2e0a 0a20 2020 2020 2020 2023 2052  ve...        # R
+00008de0: 6169 7365 730a 2020 2020 2020 2020 2020  aises.          
+00008df0: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
+00008e00: 7863 6570 7469 6f6e 732e 5265 7374 4150  xceptions.RestAP
+00008e10: 4945 7272 6f72 602e 0a0a 2020 2020 2020  IError`...      
+00008e20: 2020 2320 5265 7475 726e 0a20 2020 2020    # Return.     
+00008e30: 2020 2020 2020 2055 6e69 6f6e 5b4c 6973         Union[Lis
+00008e40: 745b 6056 616c 6964 6174 696f 6e52 6573  t[`ValidationRes
+00008e50: 756c 7460 5d2c 204c 6973 745b 6045 7870  ult`], List[`Exp
+00008e60: 6563 7461 7469 6f6e 5661 6c69 6461 7469  ectationValidati
+00008e70: 6f6e 5265 7375 6c74 605d 5d20 4120 6c69  onResult`]] A li
+00008e80: 7374 206f 6620 7661 6c69 6461 7469 6f6e  st of validation
+00008e90: 2072 6573 756c 7420 636f 6e6e 6563 7465   result connecte
+00008ea0: 6420 746f 2074 6865 2065 7870 6563 7461  d to the expecta
+00008eb0: 7469 6f6e 5f69 640a 2020 2020 2020 2020  tion_id.        
+00008ec0: 2222 220a 2020 2020 2020 2020 6d61 6a6f  """.        majo
+00008ed0: 722c 206d 696e 6f72 203d 2073 656c 662e  r, minor = self.
+00008ee0: 5f76 6172 6961 626c 655f 6170 692e 7061  _variable_api.pa
+00008ef0: 7273 655f 6d61 6a6f 725f 616e 645f 6d69  rse_major_and_mi
+00008f00: 6e6f 7228 0a20 2020 2020 2020 2020 2020  nor(.           
+00008f10: 2073 656c 662e 5f76 6172 6961 626c 655f   self._variable_
+00008f20: 6170 692e 6765 745f 7665 7273 696f 6e28  api.get_version(
+00008f30: 2268 6f70 7377 6f72 6b73 2229 0a20 2020  "hopsworks").   
+00008f40: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+00008f50: 6620 6d61 6a6f 7220 3d3d 2022 3322 2061  f major == "3" a
+00008f60: 6e64 206d 696e 6f72 203d 3d20 2230 223a  nd minor == "0":
+00008f70: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00008f80: 7365 2046 6561 7475 7265 5374 6f72 6545  se FeatureStoreE
+00008f90: 7863 6570 7469 6f6e 280a 2020 2020 2020  xception(.      
+00008fa0: 2020 2020 2020 2020 2020 2254 6865 2068            "The h
+00008fb0: 6f70 7377 6f72 6b73 2073 6572 7665 7220  opsworks server 
+00008fc0: 646f 6573 206e 6f74 2073 7570 706f 7274  does not support
+00008fd0: 2074 6869 7320 6f70 6572 6174 696f 6e2e   this operation.
+00008fe0: 2055 7064 6174 6520 7365 7276 6572 2074   Update server t
+00008ff0: 6f20 686f 7073 776f 726b 7320 3e33 2e31  o hopsworks >3.1
+00009000: 2074 6f20 656e 6162 6c65 2073 7570 706f   to enable suppo
+00009010: 7274 2e22 0a20 2020 2020 2020 2020 2020  rt.".           
+00009020: 2029 0a0a 2020 2020 2020 2020 6966 2073   )..        if s
+00009030: 656c 662e 5f69 643a 0a20 2020 2020 2020  elf._id:.       
+00009040: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00009050: 2e5f 7661 6c69 6461 7469 6f6e 5f72 6573  ._validation_res
+00009060: 756c 745f 656e 6769 6e65 2e67 6574 5f76  ult_engine.get_v
+00009070: 616c 6964 6174 696f 6e5f 6869 7374 6f72  alidation_histor
+00009080: 7928 0a20 2020 2020 2020 2020 2020 2020  y(.             
+00009090: 2020 2065 7870 6563 7461 7469 6f6e 5f69     expectation_i
+000090a0: 643d 6578 7065 6374 6174 696f 6e5f 6964  d=expectation_id
+000090b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000090c0: 2020 7374 6172 745f 7661 6c69 6461 7469    start_validati
+000090d0: 6f6e 5f74 696d 653d 7374 6172 745f 7661  on_time=start_va
+000090e0: 6c69 6461 7469 6f6e 5f74 696d 652c 0a20  lidation_time,. 
+000090f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00009100: 6e64 5f76 616c 6964 6174 696f 6e5f 7469  nd_validation_ti
+00009110: 6d65 3d65 6e64 5f76 616c 6964 6174 696f  me=end_validatio
+00009120: 6e5f 7469 6d65 2c0a 2020 2020 2020 2020  n_time,.        
+00009130: 2020 2020 2020 2020 6669 6c74 6572 5f62          filter_b
+00009140: 793d 6669 6c74 6572 5f62 792c 0a20 2020  y=filter_by,.   
+00009150: 2020 2020 2020 2020 2020 2020 2067 655f               ge_
+00009160: 7479 7065 3d67 655f 7479 7065 2c0a 2020  type=ge_type,.  
+00009170: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00009180: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00009190: 2020 2020 2020 7261 6973 6520 4665 6174        raise Feat
+000091a0: 7572 6553 746f 7265 4578 6365 7074 696f  ureStoreExceptio
+000091b0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000091c0: 2020 2022 4f6e 6c79 2046 6561 7475 7265     "Only Feature
+000091d0: 2047 726f 7570 2072 6567 6973 7465 7265   Group registere
+000091e0: 6420 7769 7468 2048 6f70 7377 6f72 6b73  d with Hopsworks
+000091f0: 2063 616e 2066 6574 6368 2076 616c 6964   can fetch valid
+00009200: 6174 696f 6e20 6869 7374 6f72 792e 220a  ation history.".
+00009210: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00009220: 2020 2064 6566 2076 616c 6964 6174 6528     def validate(
+00009230: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00009240: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
+00009250: 3a20 4f70 7469 6f6e 616c 5b0a 2020 2020  : Optional[.    
+00009260: 2020 2020 2020 2020 556e 696f 6e5b 7064          Union[pd
+00009270: 2e44 6174 6146 7261 6d65 2c20 5479 7065  .DataFrame, Type
+00009280: 5661 7228 2270 7973 7061 726b 2e73 716c  Var("pyspark.sql
+00009290: 2e44 6174 6146 7261 6d65 2229 5d20 2023  .DataFrame")]  #
+000092a0: 206e 6f71 613a 2046 3832 310a 2020 2020   noqa: F821.    
+000092b0: 2020 2020 5d20 3d20 4e6f 6e65 2c0a 2020      ] = None,.  
+000092c0: 2020 2020 2020 6578 7065 6374 6174 696f        expectatio
+000092d0: 6e5f 7375 6974 653a 204f 7074 696f 6e61  n_suite: Optiona
+000092e0: 6c5b 4578 7065 6374 6174 696f 6e53 7569  l[ExpectationSui
+000092f0: 7465 5d20 3d20 4e6f 6e65 2c0a 2020 2020  te] = None,.    
+00009300: 2020 2020 7361 7665 5f72 6570 6f72 743a      save_report:
+00009310: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00009320: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+00009330: 2076 616c 6964 6174 696f 6e5f 6f70 7469   validation_opti
+00009340: 6f6e 733a 204f 7074 696f 6e61 6c5b 4469  ons: Optional[Di
+00009350: 6374 5b41 6e79 2c20 416e 795d 5d20 3d20  ct[Any, Any]] = 
+00009360: 7b7d 2c0a 2020 2020 2020 2020 696e 6765  {},.        inge
+00009370: 7374 696f 6e5f 7265 7375 6c74 3a20 7374  stion_result: st
+00009380: 7220 3d20 2255 4e4b 4e4f 574e 222c 0a20  r = "UNKNOWN",. 
+00009390: 2020 2020 2020 2067 655f 7479 7065 3a20         ge_type: 
+000093a0: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+000093b0: 2029 202d 3e20 556e 696f 6e5b 6765 2e63   ) -> Union[ge.c
+000093c0: 6f72 652e 4578 7065 6374 6174 696f 6e53  ore.ExpectationS
+000093d0: 7569 7465 5661 6c69 6461 7469 6f6e 5265  uiteValidationRe
+000093e0: 7375 6c74 2c20 5661 6c69 6461 7469 6f6e  sult, Validation
+000093f0: 5265 706f 7274 2c20 4e6f 6e65 5d3a 0a20  Report, None]:. 
+00009400: 2020 2020 2020 2022 2222 5275 6e20 7661         """Run va
+00009410: 6c69 6461 7469 6f6e 2062 6173 6564 206f  lidation based o
+00009420: 6e20 7468 6520 6174 7461 6368 6564 2065  n the attached e
+00009430: 7870 6563 7461 7469 6f6e 732e 0a0a 2020  xpectations...  
+00009440: 2020 2020 2020 5275 6e73 2061 6e79 2065        Runs any e
+00009450: 7870 6563 7461 7469 6f6e 2061 7474 6163  xpectation attac
+00009460: 6865 6420 7769 7468 2044 6565 7175 2e20  hed with Deequ. 
+00009470: 4275 7420 616c 736f 2072 756e 7320 6174  But also runs at
+00009480: 7461 6368 6564 2047 7265 6174 2045 7870  tached Great Exp
+00009490: 6563 7461 7469 6f6e 0a20 2020 2020 2020  ectation.       
+000094a0: 2053 7569 7465 732e 0a0a 2020 2020 2020   Suites...      
+000094b0: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
+000094c0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+000094d0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+000094e0: 2320 636f 6e6e 6563 7420 746f 2074 6865  # connect to the
+000094f0: 2046 6561 7475 7265 2053 746f 7265 0a20   Feature Store. 
+00009500: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
+00009510: 2e2e 2e0a 0a20 2020 2020 2020 2020 2020  .....           
+00009520: 2023 2067 6574 2066 6561 7475 7265 2067   # get feature g
+00009530: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+00009540: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+00009550: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+00009560: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+00009570: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+00009580: 6765 5f72 6570 6f72 7420 3d20 6667 2e76  ge_report = fg.v
+00009590: 616c 6964 6174 6528 6466 2c20 7361 7665  alidate(df, save
+000095a0: 5f72 6570 6f72 743d 4661 6c73 6529 0a20  _report=False). 
+000095b0: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+000095c0: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+000095d0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+000095e0: 6461 7461 6672 616d 653a 2054 6865 2064  dataframe: The d
+000095f0: 6174 6166 7261 6d65 2074 6f20 7275 6e20  ataframe to run 
+00009600: 7468 6520 6461 7461 2076 616c 6964 6174  the data validat
+00009610: 696f 6e20 6578 7065 6374 6174 696f 6e73  ion expectations
+00009620: 2061 6761 696e 7374 2e0a 2020 2020 2020   against..      
+00009630: 2020 2020 2020 6578 7065 6374 6174 696f        expectatio
+00009640: 6e5f 7375 6974 653a 204f 7074 696f 6e61  n_suite: Optiona
+00009650: 6c6c 7920 7072 6f76 6964 6520 616e 2045  lly provide an E
+00009660: 7870 6563 7461 7469 6f6e 2053 7569 7465  xpectation Suite
+00009670: 2074 6f20 6f76 6572 7269 6465 2074 6865   to override the
+00009680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009690: 206f 6e65 2074 6861 7420 6973 2070 6f73   one that is pos
+000096a0: 7369 626c 7920 6174 7461 6368 6564 2074  sibly attached t
+000096b0: 6f20 7468 6520 6665 6174 7572 6520 6772  o the feature gr
+000096c0: 6f75 702e 2054 6869 7320 6973 2075 7365  oup. This is use
+000096d0: 6675 6c20 666f 720a 2020 2020 2020 2020  ful for.        
+000096e0: 2020 2020 2020 2020 7465 7374 696e 6720          testing 
+000096f0: 6e65 7720 4578 7065 6374 6174 696f 6e20  new Expectation 
+00009700: 7375 6974 6573 2e20 5768 656e 2061 6e20  suites. When an 
+00009710: 6578 7472 6120 7375 6974 6520 6973 2070  extra suite is p
+00009720: 726f 7669 6465 642c 2074 6865 2072 6573  rovided, the res
+00009730: 756c 7473 0a20 2020 2020 2020 2020 2020  ults.           
+00009740: 2020 2020 2077 696c 6c20 6e65 7665 7220       will never 
+00009750: 6265 2070 6572 7369 7374 6564 2e20 4465  be persisted. De
+00009760: 6661 756c 7473 2074 6f20 604e 6f6e 6560  faults to `None`
+00009770: 2e0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+00009780: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
+00009790: 3a20 4164 6469 7469 6f6e 616c 2076 616c  : Additional val
+000097a0: 6964 6174 696f 6e20 6f70 7469 6f6e 7320  idation options 
+000097b0: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
+000097c0: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
+000097d0: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
+000097e0: 2020 2020 2020 2a20 6b65 7920 6072 756e        * key `run
+000097f0: 5f76 616c 6964 6174 696f 6e60 2062 6f6f  _validation` boo
+00009800: 6c65 616e 2076 616c 7565 2c20 7365 7420  lean value, set 
+00009810: 746f 2060 4661 6c73 6560 2074 6f20 736b  to `False` to sk
+00009820: 6970 2076 616c 6964 6174 696f 6e20 7465  ip validation te
+00009830: 6d70 6f72 6172 696c 7920 6f6e 2069 6e67  mporarily on ing
+00009840: 6573 7469 6f6e 2e0a 2020 2020 2020 2020  estion..        
+00009850: 2020 2020 2020 2020 2a20 6b65 7920 6067          * key `g
+00009860: 655f 7661 6c69 6461 7465 5f6b 7761 7267  e_validate_kwarg
+00009870: 7360 2061 2064 6963 7469 6f6e 6172 7920  s` a dictionary 
+00009880: 636f 6e74 6169 6e69 6e67 206b 7761 7267  containing kwarg
+00009890: 7320 666f 7220 7468 6520 7661 6c69 6461  s for the valida
+000098a0: 7465 206d 6574 686f 6420 6f66 2047 7265  te method of Gre
+000098b0: 6174 2045 7870 6563 7461 7469 6f6e 732e  at Expectations.
+000098c0: 0a20 2020 2020 2020 2020 2020 2069 6e67  .            ing
+000098d0: 6573 7469 6f6e 5f72 6573 756c 743a 2053  estion_result: S
+000098e0: 7065 6369 6679 2074 6865 2066 6174 6520  pecify the fate 
+000098f0: 6f66 2074 6865 2061 7373 6f63 6961 7465  of the associate
+00009900: 6420 6461 7461 2c20 6465 6661 756c 7473  d data, defaults
+00009910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009920: 2074 6f20 2255 4e4b 4e4f 574e 222e 2053   to "UNKNOWN". S
+00009930: 7570 706f 7274 6564 206f 7074 696f 6e73  upported options
+00009940: 2061 7265 2020 2255 4e4b 4e4f 574e 222c   are  "UNKNOWN",
+00009950: 2022 494e 4745 5354 4544 222c 2022 5245   "INGESTED", "RE
+00009960: 4a45 4354 4544 222c 0a20 2020 2020 2020  JECTED",.       
+00009970: 2020 2020 2020 2020 2022 4558 5045 5249           "EXPERI
+00009980: 4d45 4e54 222c 2022 4647 5f44 4154 4122  MENT", "FG_DATA"
+00009990: 2e20 5573 6520 2249 4e47 4553 5445 4422  . Use "INGESTED"
+000099a0: 206f 7220 2252 454a 4543 5445 4422 2066   or "REJECTED" f
+000099b0: 6f72 2076 616c 6964 6174 696f 6e0a 2020  or validation.  
+000099c0: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+000099d0: 2044 6174 6146 7261 6d65 7320 746f 2062   DataFrames to b
+000099e0: 6520 696e 7365 7274 6564 2069 6e20 7468  e inserted in th
+000099f0: 6520 4665 6174 7572 6520 4772 6f75 702e  e Feature Group.
+00009a00: 2055 7365 2022 4558 5045 5249 4d45 4e54   Use "EXPERIMENT
+00009a10: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00009a20: 2020 666f 7220 7465 7374 696e 6720 616e    for testing an
+00009a30: 6420 6465 7665 6c6f 706d 656e 7420 616e  d development an
+00009a40: 6420 2246 475f 4441 5441 2220 7768 656e  d "FG_DATA" when
+00009a50: 2076 616c 6964 6174 696e 6720 6461 7461   validating data
+00009a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009a70: 2061 6c72 6561 6479 2069 6e20 7468 6520   already in the 
+00009a80: 4665 6174 7572 6520 4772 6f75 702e 0a20  Feature Group.. 
+00009a90: 2020 2020 2020 2020 2020 2073 6176 655f             save_
+00009aa0: 7265 706f 7274 3a20 5768 6574 6865 7220  report: Whether 
+00009ab0: 746f 2073 6176 6520 7468 6520 7265 706f  to save the repo
+00009ac0: 7274 2074 6f20 7468 6520 6261 636b 656e  rt to the backen
+00009ad0: 642e 2054 6869 7320 6973 206f 6e6c 7920  d. This is only 
+00009ae0: 706f 7373 6962 6c65 2069 6620 7468 6520  possible if the 
+00009af0: 4578 7065 6374 6174 696f 6e20 7375 6974  Expectation suit
+00009b00: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00009b10: 2020 6973 2069 6e69 7469 616c 6973 6564    is initialised
+00009b20: 2061 6e64 2061 7474 6163 6865 6420 746f   and attached to
+00009b30: 2074 6865 2046 6561 7475 7265 2047 726f   the Feature Gro
+00009b40: 7570 2e20 4465 6661 756c 7473 2074 6f20  up. Defaults to 
+00009b50: 4661 6c73 652e 0a20 2020 2020 2020 2020  False..         
+00009b60: 2020 2067 655f 7479 7065 3a20 5768 6574     ge_type: Whet
+00009b70: 6865 7220 746f 2072 6574 7572 6e20 6120  her to return a 
+00009b80: 4772 6561 7420 4578 7065 6374 6174 696f  Great Expectatio
+00009b90: 6e73 206f 626a 6563 7420 6f72 2048 6f70  ns object or Hop
+00009ba0: 7377 6f72 6b73 206f 776e 2061 6273 7472  sworks own abstr
+00009bb0: 6163 7469 6f6e 2e20 4465 6661 756c 7473  action. Defaults
+00009bc0: 2074 6f20 5472 7565 2e0a 0a20 2020 2020   to True...     
+00009bd0: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
+00009be0: 2020 2020 2020 2020 2041 2056 616c 6964           A Valid
+00009bf0: 6174 696f 6e20 5265 706f 7274 2070 726f  ation Report pro
+00009c00: 6475 6365 6420 6279 2047 7265 6174 2045  duced by Great E
+00009c10: 7870 6563 7461 7469 6f6e 732e 0a20 2020  xpectations..   
+00009c20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00009c30: 2023 2041 6374 6976 6974 7920 6973 206c   # Activity is l
+00009c40: 6f67 6765 6420 6f6e 6c79 2069 6620 6120  ogged only if a 
+00009c50: 7468 6520 7661 6c69 6461 7469 6f6e 2063  the validation c
+00009c60: 6f6e 6365 726e 7320 7468 6520 6665 6174  oncerns the feat
+00009c70: 7572 6520 6772 6f75 7020 616e 6420 6e6f  ure group and no
+00009c80: 7420 6120 7370 6563 6966 6963 2064 6174  t a specific dat
+00009c90: 6166 7261 6d65 0a20 2020 2020 2020 2069  aframe.        i
+00009ca0: 6620 6461 7461 6672 616d 6520 6973 204e  f dataframe is N
+00009cb0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00009cc0: 2064 6174 6166 7261 6d65 203d 2073 656c   dataframe = sel
+00009cd0: 662e 7265 6164 2829 0a20 2020 2020 2020  f.read().       
+00009ce0: 2020 2020 2069 6620 696e 6765 7374 696f       if ingestio
+00009cf0: 6e5f 7265 7375 6c74 203d 3d20 2255 4e4b  n_result == "UNK
+00009d00: 4e4f 574e 223a 0a20 2020 2020 2020 2020  NOWN":.         
+00009d10: 2020 2020 2020 2069 6e67 6573 7469 6f6e         ingestion
+00009d20: 5f72 6573 756c 7420 3d20 2246 475f 4441  _result = "FG_DA
+00009d30: 5441 220a 0a20 2020 2020 2020 2072 6574  TA"..        ret
+00009d40: 7572 6e20 7365 6c66 2e5f 6772 6561 745f  urn self._great_
+00009d50: 6578 7065 6374 6174 696f 6e5f 656e 6769  expectation_engi
+00009d60: 6e65 2e76 616c 6964 6174 6528 0a20 2020  ne.validate(.   
+00009d70: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
+00009d80: 2020 2020 2020 2020 2020 2064 6174 6166             dataf
+00009d90: 7261 6d65 3d65 6e67 696e 652e 6765 745f  rame=engine.get_
+00009da0: 696e 7374 616e 6365 2829 2e63 6f6e 7665  instance().conve
+00009db0: 7274 5f74 6f5f 6465 6661 756c 745f 6461  rt_to_default_da
+00009dc0: 7461 6672 616d 6528 6461 7461 6672 616d  taframe(datafram
+00009dd0: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00009de0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00009df0: 653d 6578 7065 6374 6174 696f 6e5f 7375  e=expectation_su
+00009e00: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
+00009e10: 2073 6176 655f 7265 706f 7274 3d73 6176   save_report=sav
+00009e20: 655f 7265 706f 7274 2c0a 2020 2020 2020  e_report,.      
+00009e30: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
+00009e40: 5f6f 7074 696f 6e73 3d76 616c 6964 6174  _options=validat
+00009e50: 696f 6e5f 6f70 7469 6f6e 732c 0a20 2020  ion_options,.   
+00009e60: 2020 2020 2020 2020 2069 6e67 6573 7469           ingesti
+00009e70: 6f6e 5f72 6573 756c 743d 696e 6765 7374  on_result=ingest
+00009e80: 696f 6e5f 7265 7375 6c74 2c0a 2020 2020  ion_result,.    
+00009e90: 2020 2020 2020 2020 6765 5f74 7970 653d          ge_type=
+00009ea0: 6765 5f74 7970 652c 0a20 2020 2020 2020  ge_type,.       
+00009eb0: 2029 0a0a 2020 2020 6465 6620 5f5f 6765   )..    def __ge
+00009ec0: 7461 7474 725f 5f28 7365 6c66 2c20 6e61  tattr__(self, na
+00009ed0: 6d65 293a 0a20 2020 2020 2020 2074 7279  me):.        try
+00009ee0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00009ef0: 7475 726e 2073 656c 662e 5f5f 6765 7469  turn self.__geti
+00009f00: 7465 6d5f 5f28 6e61 6d65 290a 2020 2020  tem__(name).    
+00009f10: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
+00009f20: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+00009f30: 2072 6169 7365 2041 7474 7269 6275 7465   raise Attribute
+00009f40: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00009f50: 2020 2020 2020 2066 2227 4665 6174 7572         f"'Featur
+00009f60: 6547 726f 7570 2720 6f62 6a65 6374 2068  eGroup' object h
+00009f70: 6173 206e 6f20 6174 7472 6962 7574 6520  as no attribute 
+00009f80: 277b 6e61 6d65 7d27 2e20 220a 2020 2020  '{name}'. ".    
+00009f90: 2020 2020 2020 2020 2020 2020 2249 6620              "If 
+00009fa0: 796f 7520 6172 6520 7472 7969 6e67 2074  you are trying t
+00009fb0: 6f20 6163 6365 7373 2061 2066 6561 7475  o access a featu
+00009fc0: 7265 2c20 6661 6c6c 2062 6163 6b20 6f6e  re, fall back on
+00009fd0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00009fe0: 2020 2022 7573 696e 6720 7468 6520 6067     "using the `g
+00009ff0: 6574 5f66 6561 7475 7265 6020 6d65 7468  et_feature` meth
+0000a000: 6f64 2e22 0a20 2020 2020 2020 2020 2020  od.".           
+0000a010: 2029 0a0a 2020 2020 6465 6620 5f5f 6765   )..    def __ge
+0000a020: 7469 7465 6d5f 5f28 7365 6c66 2c20 6e61  titem__(self, na
+0000a030: 6d65 293a 0a20 2020 2020 2020 2069 6620  me):.        if 
+0000a040: 6e6f 7420 6973 696e 7374 616e 6365 286e  not isinstance(n
+0000a050: 616d 652c 2073 7472 293a 0a20 2020 2020  ame, str):.     
+0000a060: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+0000a070: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0000a080: 2020 2020 2020 2020 6622 4578 7065 6374          f"Expect
+0000a090: 6564 2074 7970 6520 6073 7472 602c 2067  ed type `str`, g
+0000a0a0: 6f74 2060 7b74 7970 6528 6e61 6d65 297d  ot `{type(name)}
+0000a0b0: 602e 2022 0a20 2020 2020 2020 2020 2020  `. ".           
+0000a0c0: 2020 2020 2022 4665 6174 7572 6573 2061       "Features a
+0000a0d0: 7265 2061 6363 6573 7369 626c 6520 6279  re accessible by
+0000a0e0: 206e 616d 652e 220a 2020 2020 2020 2020   name.".        
+0000a0f0: 2020 2020 290a 2020 2020 2020 2020 6665      ).        fe
+0000a100: 6174 7572 6520 3d20 5b66 2066 6f72 2066  ature = [f for f
+0000a110: 2069 6e20 7365 6c66 2e5f 5f67 6574 6174   in self.__getat
+0000a120: 7472 6962 7574 655f 5f28 225f 6665 6174  tribute__("_feat
+0000a130: 7572 6573 2229 2069 6620 662e 6e61 6d65  ures") if f.name
+0000a140: 203d 3d20 6e61 6d65 5d0a 2020 2020 2020   == name].      
+0000a150: 2020 6966 206c 656e 2866 6561 7475 7265    if len(feature
+0000a160: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+0000a170: 2020 2020 7265 7475 726e 2066 6561 7475      return featu
+0000a180: 7265 5b30 5d0a 2020 2020 2020 2020 656c  re[0].        el
+0000a190: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000a1a0: 7261 6973 6520 4b65 7945 7272 6f72 2866  raise KeyError(f
+0000a1b0: 2227 4665 6174 7572 6547 726f 7570 2720  "'FeatureGroup' 
+0000a1c0: 6f62 6a65 6374 2068 6173 206e 6f20 6665  object has no fe
+0000a1d0: 6174 7572 6520 6361 6c6c 6564 2027 7b6e  ature called '{n
+0000a1e0: 616d 657d 272e 2229 0a0a 2020 2020 4070  ame}'.")..    @p
+0000a1f0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000a200: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+0000a210: 6728 7365 6c66 293a 0a20 2020 2020 2020  g(self):.       
+0000a220: 2022 2222 5374 6174 6973 7469 6373 2063   """Statistics c
+0000a230: 6f6e 6669 6775 7261 7469 6f6e 206f 626a  onfiguration obj
+0000a240: 6563 7420 6465 6669 6e69 6e67 2074 6865  ect defining the
+0000a250: 2073 6574 7469 6e67 7320 666f 7220 7374   settings for st
+0000a260: 6174 6973 7469 6373 0a20 2020 2020 2020  atistics.       
+0000a270: 2063 6f6d 7075 7461 7469 6f6e 206f 6620   computation of 
+0000a280: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+0000a290: 702e 2222 220a 2020 2020 2020 2020 7265  p.""".        re
+0000a2a0: 7475 726e 2073 656c 662e 5f73 7461 7469  turn self._stati
+0000a2b0: 7374 6963 735f 636f 6e66 6967 0a0a 2020  stics_config..  
+0000a2c0: 2020 4073 7461 7469 7374 6963 735f 636f    @statistics_co
+0000a2d0: 6e66 6967 2e73 6574 7465 720a 2020 2020  nfig.setter.    
+0000a2e0: 6465 6620 7374 6174 6973 7469 6373 5f63  def statistics_c
+0000a2f0: 6f6e 6669 6728 7365 6c66 2c20 7374 6174  onfig(self, stat
+0000a300: 6973 7469 6373 5f63 6f6e 6669 6729 3a0a  istics_config):.
+0000a310: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000a320: 7461 6e63 6528 7374 6174 6973 7469 6373  tance(statistics
+0000a330: 5f63 6f6e 6669 672c 2053 7461 7469 7374  _config, Statist
+0000a340: 6963 7343 6f6e 6669 6729 3a0a 2020 2020  icsConfig):.    
+0000a350: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
+0000a360: 6174 6973 7469 6373 5f63 6f6e 6669 6720  atistics_config 
+0000a370: 3d20 7374 6174 6973 7469 6373 5f63 6f6e  = statistics_con
+0000a380: 6669 670a 2020 2020 2020 2020 656c 6966  fig.        elif
+0000a390: 2069 7369 6e73 7461 6e63 6528 7374 6174   isinstance(stat
+0000a3a0: 6973 7469 6373 5f63 6f6e 6669 672c 2064  istics_config, d
+0000a3b0: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+0000a3c0: 2020 7365 6c66 2e5f 7374 6174 6973 7469    self._statisti
+0000a3d0: 6373 5f63 6f6e 6669 6720 3d20 5374 6174  cs_config = Stat
+0000a3e0: 6973 7469 6373 436f 6e66 6967 282a 2a73  isticsConfig(**s
+0000a3f0: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
+0000a400: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
+0000a410: 7369 6e73 7461 6e63 6528 7374 6174 6973  sinstance(statis
+0000a420: 7469 6373 5f63 6f6e 6669 672c 2062 6f6f  tics_config, boo
+0000a430: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0000a440: 7365 6c66 2e5f 7374 6174 6973 7469 6373  self._statistics
+0000a450: 5f63 6f6e 6669 6720 3d20 5374 6174 6973  _config = Statis
+0000a460: 7469 6373 436f 6e66 6967 2873 7461 7469  ticsConfig(stati
+0000a470: 7374 6963 735f 636f 6e66 6967 290a 2020  stics_config).  
+0000a480: 2020 2020 2020 656c 6966 2073 7461 7469        elif stati
+0000a490: 7374 6963 735f 636f 6e66 6967 2069 7320  stics_config is 
+0000a4a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000a4b0: 2020 7365 6c66 2e5f 7374 6174 6973 7469    self._statisti
+0000a4c0: 6373 5f63 6f6e 6669 6720 3d20 5374 6174  cs_config = Stat
+0000a4d0: 6973 7469 6373 436f 6e66 6967 2829 0a20  isticsConfig(). 
+0000a4e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000a4f0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+0000a500: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+0000a510: 2020 2020 2020 2020 2020 2254 6865 2061            "The a
+0000a520: 7267 756d 656e 7420 6073 7461 7469 7374  rgument `statist
+0000a530: 6963 735f 636f 6e66 6967 6020 6861 7320  ics_config` has 
+0000a540: 746f 2062 6520 604e 6f6e 6560 206f 6620  to be `None` of 
+0000a550: 7479 7065 2060 5374 6174 6973 7469 6373  type `Statistics
+0000a560: 436f 6e66 6967 2c20 6062 6f6f 6c60 206f  Config, `bool` o
+0000a570: 7220 6064 6963 7460 2c20 6275 7420 6973  r `dict`, but is
+0000a580: 206f 6620 7479 7065 3a20 607b 7d60 222e   of type: `{}`".
+0000a590: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+0000a5a0: 2020 2020 2020 2020 2020 2020 7479 7065              type
+0000a5b0: 2873 7461 7469 7374 6963 735f 636f 6e66  (statistics_conf
+0000a5c0: 6967 290a 2020 2020 2020 2020 2020 2020  ig).            
+0000a5d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000a5e0: 2020 290a 0a20 2020 2040 7072 6f70 6572    )..    @proper
+0000a5f0: 7479 0a20 2020 2064 6566 2073 7461 7469  ty.    def stati
+0000a600: 7374 6963 7328 7365 6c66 293a 0a20 2020  stics(self):.   
+0000a610: 2020 2020 2022 2222 4765 7420 7468 6520       """Get the 
+0000a620: 6c61 7465 7374 2063 6f6d 7075 7465 6420  latest computed 
+0000a630: 7374 6174 6973 7469 6373 2066 6f72 2074  statistics for t
+0000a640: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+0000a650: 2e22 2222 0a20 2020 2020 2020 2072 6574  .""".        ret
+0000a660: 7572 6e20 7365 6c66 2e5f 7374 6174 6973  urn self._statis
+0000a670: 7469 6373 5f65 6e67 696e 652e 6765 745f  tics_engine.get_
+0000a680: 6c61 7374 2873 656c 6629 0a0a 2020 2020  last(self)..    
+0000a690: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000a6a0: 6620 7072 696d 6172 795f 6b65 7928 7365  f primary_key(se
+0000a6b0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000a6c0: 4c69 7374 206f 6620 6665 6174 7572 6573  List of features
+0000a6d0: 2062 7569 6c64 696e 6720 7468 6520 7072   building the pr
+0000a6e0: 696d 6172 7920 6b65 792e 2222 220a 2020  imary key.""".  
+0000a6f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000a700: 662e 5f70 7269 6d61 7279 5f6b 6579 0a0a  f._primary_key..
+0000a710: 2020 2020 4070 7269 6d61 7279 5f6b 6579      @primary_key
+0000a720: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+0000a730: 7072 696d 6172 795f 6b65 7928 7365 6c66  primary_key(self
+0000a740: 2c20 6e65 775f 7072 696d 6172 795f 6b65  , new_primary_ke
+0000a750: 7929 3a0a 2020 2020 2020 2020 7365 6c66  y):.        self
+0000a760: 2e5f 7072 696d 6172 795f 6b65 7920 3d20  ._primary_key = 
+0000a770: 5b70 6b2e 6c6f 7765 7228 2920 666f 7220  [pk.lower() for 
+0000a780: 706b 2069 6e20 6e65 775f 7072 696d 6172  pk in new_primar
+0000a790: 795f 6b65 795d 0a0a 2020 2020 6465 6620  y_key]..    def 
+0000a7a0: 6765 745f 7374 6174 6973 7469 6373 280a  get_statistics(.
+0000a7b0: 2020 2020 2020 2020 7365 6c66 2c20 636f          self, co
+0000a7c0: 6d6d 6974 5f74 696d 653a 204f 7074 696f  mmit_time: Optio
+0000a7d0: 6e61 6c5b 556e 696f 6e5b 7374 722c 2069  nal[Union[str, i
+0000a7e0: 6e74 2c20 6461 7465 7469 6d65 2c20 6461  nt, datetime, da
+0000a7f0: 7465 5d5d 203d 204e 6f6e 650a 2020 2020  te]] = None.    
+0000a800: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
+0000a810: 7475 726e 7320 7468 6520 7374 6174 6973  turns the statis
+0000a820: 7469 6373 2066 6f72 2074 6869 7320 6665  tics for this fe
+0000a830: 6174 7572 6520 6772 6f75 7020 6174 2061  ature group at a
+0000a840: 2073 7065 6369 6669 6320 7469 6d65 2e0a   specific time..
+0000a850: 0a20 2020 2020 2020 2049 6620 6063 6f6d  .        If `com
+0000a860: 6d69 745f 7469 6d65 6020 6973 2060 4e6f  mit_time` is `No
+0000a870: 6e65 602c 2074 6865 206d 6f73 7420 7265  ne`, the most re
+0000a880: 6365 6e74 2073 7461 7469 7374 6963 7320  cent statistics 
+0000a890: 6172 6520 7265 7475 726e 6564 2e0a 0a20  are returned... 
+0000a8a0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+0000a8b0: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
+0000a8c0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+0000a8d0: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
+0000a8e0: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
+0000a8f0: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+0000a900: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
+0000a910: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
+0000a920: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
+0000a930: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+0000a940: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
+0000a950: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+0000a960: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
+0000a970: 2020 2020 2020 2020 2066 675f 7374 6174           fg_stat
+0000a980: 6973 7469 6373 203d 2066 672e 6765 745f  istics = fg.get_
+0000a990: 7374 6174 6973 7469 6373 2863 6f6d 6d69  statistics(commi
+0000a9a0: 745f 7469 6d65 3d4e 6f6e 6529 0a20 2020  t_time=None).   
+0000a9b0: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
+0000a9c0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+0000a9d0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
+0000a9e0: 6d6d 6974 5f74 696d 653a 2044 6174 6520  mmit_time: Date 
+0000a9f0: 616e 6420 7469 6d65 206f 6620 7468 6520  and time of the 
+0000aa00: 636f 6d6d 6974 2e20 4465 6661 756c 7473  commit. Defaults
+0000aa10: 2074 6f20 604e 6f6e 6560 2e20 5374 7269   to `None`. Stri
+0000aa20: 6e67 7320 7368 6f75 6c64 0a20 2020 2020  ngs should.     
+0000aa30: 2020 2020 2020 2020 2020 2062 6520 666f             be fo
+0000aa40: 726d 6174 7465 6420 696e 206f 6e65 206f  rmatted in one o
+0000aa50: 6620 7468 6520 666f 6c6c 6f77 696e 6720  f the following 
+0000aa60: 666f 726d 6174 7320 6025 592d 256d 2d25  formats `%Y-%m-%
+0000aa70: 6460 2c20 6025 592d 256d 2d25 6420 2548  d`, `%Y-%m-%d %H
+0000aa80: 602c 2060 2559 2d25 6d2d 2564 2025 483a  `, `%Y-%m-%d %H:
+0000aa90: 254d 602c 2060 2559 2d25 6d2d 2564 2025  %M`, `%Y-%m-%d %
+0000aaa0: 483a 254d 3a25 5360 2c0a 2020 2020 2020  H:%M:%S`,.      
+0000aab0: 2020 2020 2020 2020 2020 6f72 2060 2559            or `%Y
+0000aac0: 2d25 6d2d 2564 2025 483a 254d 3a25 532e  -%m-%d %H:%M:%S.
+0000aad0: 2566 602e 0a0a 2020 2020 2020 2020 2320  %f`...        # 
+0000aae0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0000aaf0: 2020 2020 6053 7461 7469 7374 6963 7360      `Statistics`
+0000ab00: 2e20 5374 6174 6973 7469 6373 206f 626a  . Statistics obj
+0000ab10: 6563 742e 0a0a 2020 2020 2020 2020 2320  ect...        # 
+0000ab20: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
+0000ab30: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
+0000ab40: 6578 6365 7074 696f 6e73 2e52 6573 7441  exceptions.RestA
+0000ab50: 5049 4572 726f 7260 2e0a 2020 2020 2020  PIError`..      
+0000ab60: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+0000ab70: 2063 6f6d 6d69 745f 7469 6d65 2069 7320   commit_time is 
+0000ab80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000ab90: 2020 7265 7475 726e 2073 656c 662e 7374    return self.st
+0000aba0: 6174 6973 7469 6373 0a20 2020 2020 2020  atistics.       
+0000abb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000abc0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000abd0: 7374 6174 6973 7469 6373 5f65 6e67 696e  statistics_engin
+0000abe0: 652e 6765 7428 7365 6c66 2c20 636f 6d6d  e.get(self, comm
+0000abf0: 6974 5f74 696d 6529 0a0a 2020 2020 6465  it_time)..    de
+0000ac00: 6620 636f 6d70 7574 655f 7374 6174 6973  f compute_statis
+0000ac10: 7469 6373 2873 656c 6629 3a0a 2020 2020  tics(self):.    
+0000ac20: 2020 2020 2222 2252 6563 6f6d 7075 7465      """Recompute
+0000ac30: 2074 6865 2073 7461 7469 7374 6963 7320   the statistics 
+0000ac40: 666f 7220 7468 6520 6665 6174 7572 6520  for the feature 
+0000ac50: 6772 6f75 7020 616e 6420 7361 7665 2074  group and save t
+0000ac60: 6865 6d20 746f 2074 6865 0a20 2020 2020  hem to the.     
+0000ac70: 2020 2066 6561 7475 7265 2073 746f 7265     feature store
+0000ac80: 2e0a 2020 2020 2020 2020 5374 6174 6973  ..        Statis
+0000ac90: 7469 6373 2061 7265 206f 6e6c 7920 636f  tics are only co
+0000aca0: 6d70 7574 6564 2066 6f72 2064 6174 6120  mputed for data 
+0000acb0: 696e 2074 6865 206f 6666 6c69 6e65 2073  in the offline s
+0000acc0: 746f 7261 6765 206f 6620 7468 6520 6665  torage of the fe
+0000acd0: 6174 7572 650a 2020 2020 2020 2020 6772  ature.        gr
+0000ace0: 6f75 702e 0a0a 2020 2020 2020 2020 2121  oup...        !!
+0000acf0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+0000ad00: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+0000ad10: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+0000ad20: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+0000ad30: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+0000ad40: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+0000ad50: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+0000ad60: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+0000ad70: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+0000ad80: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+0000ad90: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+0000ada0: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+0000adb0: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+0000adc0: 7374 6174 6973 7469 6373 5f6d 6574 6164  statistics_metad
+0000add0: 6174 6120 3d20 6667 2e63 6f6d 7075 7465  ata = fg.compute
+0000ade0: 5f73 7461 7469 7374 6963 7328 290a 2020  _statistics().  
+0000adf0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
+0000ae00: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
+0000ae10: 0a20 2020 2020 2020 2020 2020 2060 5374  .            `St
+0000ae20: 6174 6973 7469 6373 602e 2054 6865 2073  atistics`. The s
+0000ae30: 7461 7469 7374 6963 7320 6d65 7461 6461  tatistics metada
+0000ae40: 7461 206f 626a 6563 742e 0a0a 2020 2020  ta object...    
+0000ae50: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+0000ae60: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+0000ae70: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+0000ae80: 2e52 6573 7441 5049 4572 726f 7260 2e20  .RestAPIError`. 
+0000ae90: 556e 6162 6c65 2074 6f20 7065 7273 6973  Unable to persis
+0000aea0: 7420 7468 6520 7374 6174 6973 7469 6373  t the statistics
+0000aeb0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000aec0: 2020 2020 2020 6966 2073 656c 662e 7374        if self.st
+0000aed0: 6174 6973 7469 6373 5f63 6f6e 6669 672e  atistics_config.
+0000aee0: 656e 6162 6c65 643a 0a20 2020 2020 2020  enabled:.       
+0000aef0: 2020 2020 2023 2044 6f6e 2774 2072 6561       # Don't rea
+0000af00: 6420 7468 6520 6461 7461 6672 616d 6520  d the dataframe 
+0000af10: 6865 7265 2c20 746f 2061 766f 6964 2074  here, to avoid t
+0000af20: 7269 6767 6572 696e 6720 6120 7265 6164  riggering a read
+0000af30: 206f 7065 7261 7469 6f6e 0a20 2020 2020   operation.     
+0000af40: 2020 2020 2020 2023 2066 6f72 2074 6865         # for the
+0000af50: 2050 7974 686f 6e20 656e 6769 6e65 2e20   Python engine. 
+0000af60: 5468 6520 5079 7468 6f6e 2065 6e67 696e  The Python engin
+0000af70: 6520 6973 2067 6f69 6e67 2074 6f20 7365  e is going to se
+0000af80: 7475 7020 6120 5370 6172 6b20 4a6f 620a  tup a Spark Job.
+0000af90: 2020 2020 2020 2020 2020 2020 2320 746f              # to
+0000afa0: 2075 7064 6174 6520 7468 6520 7374 6174   update the stat
+0000afb0: 6973 7469 6373 2e0a 2020 2020 2020 2020  istics..        
+0000afc0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000afd0: 5f73 7461 7469 7374 6963 735f 656e 6769  _statistics_engi
+0000afe0: 6e65 2e63 6f6d 7075 7465 5f73 7461 7469  ne.compute_stati
+0000aff0: 7374 6963 7328 7365 6c66 290a 2020 2020  stics(self).    
+0000b000: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000b010: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+0000b020: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+0000b030: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+0000b040: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+0000b050: 7374 6174 6973 7469 6373 2061 7265 206e  statistics are n
+0000b060: 6f74 2065 6e61 626c 6564 206f 6620 6665  ot enabled of fe
+0000b070: 6174 7572 6520 6772 6f75 7020 607b 7d60  ature group `{}`
+0000b080: 2c20 7769 7468 2076 6572 7369 6f6e 220a  , with version".
+0000b090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0a0: 2020 2020 2220 607b 7d60 2e20 4e6f 2073      " `{}`. No s
+0000b0b0: 7461 7469 7374 6963 7320 636f 6d70 7574  tatistics comput
+0000b0c0: 6564 2e22 0a20 2020 2020 2020 2020 2020  ed.".           
+0000b0d0: 2020 2020 2029 2e66 6f72 6d61 7428 7365       ).format(se
+0000b0e0: 6c66 2e5f 6e61 6d65 2c20 7365 6c66 2e5f  lf._name, self._
+0000b0f0: 7665 7273 696f 6e29 2c0a 2020 2020 2020  version),.      
+0000b100: 2020 2020 2020 2020 2020 7574 696c 2e53            util.S
+0000b110: 746f 7261 6765 5761 726e 696e 672c 0a20  torageWarning,. 
+0000b120: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000b130: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000b140: 6465 6620 6576 656e 745f 7469 6d65 2873  def event_time(s
+0000b150: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+0000b160: 2245 7665 6e74 2074 696d 6520 6665 6174  "Event time feat
+0000b170: 7572 6520 696e 2074 6865 2066 6561 7475  ure in the featu
+0000b180: 7265 2067 726f 7570 2e22 2222 0a20 2020  re group.""".   
+0000b190: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000b1a0: 2e5f 6576 656e 745f 7469 6d65 0a0a 2020  ._event_time..  
+0000b1b0: 2020 4065 7665 6e74 5f74 696d 652e 7365    @event_time.se
+0000b1c0: 7474 6572 0a20 2020 2064 6566 2065 7665  tter.    def eve
+0000b1d0: 6e74 5f74 696d 6528 7365 6c66 2c20 6665  nt_time(self, fe
+0000b1e0: 6174 7572 655f 6e61 6d65 3a20 4f70 7469  ature_name: Opti
+0000b1f0: 6f6e 616c 5b73 7472 5d29 3a0a 2020 2020  onal[str]):.    
+0000b200: 2020 2020 6966 2066 6561 7475 7265 5f6e      if feature_n
+0000b210: 616d 6520 6973 204e 6f6e 653a 0a20 2020  ame is None:.   
+0000b220: 2020 2020 2020 2020 2073 656c 662e 5f65           self._e
+0000b230: 7665 6e74 5f74 696d 6520 3d20 4e6f 6e65  vent_time = None
+0000b240: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000b250: 7572 6e0a 2020 2020 2020 2020 656c 6966  urn.        elif
+0000b260: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
+0000b270: 7572 655f 6e61 6d65 2c20 7374 7229 3a0a  ure_name, str):.
+0000b280: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000b290: 2e5f 6576 656e 745f 7469 6d65 203d 2066  ._event_time = f
+0000b2a0: 6561 7475 7265 5f6e 616d 650a 2020 2020  eature_name.    
+0000b2b0: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
+0000b2c0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+0000b2d0: 7374 616e 6365 2866 6561 7475 7265 5f6e  stance(feature_n
+0000b2e0: 616d 652c 206c 6973 7429 2061 6e64 206c  ame, list) and l
+0000b2f0: 656e 2866 6561 7475 7265 5f6e 616d 6529  en(feature_name)
+0000b300: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
+0000b310: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000b320: 2866 6561 7475 7265 5f6e 616d 655b 305d  (feature_name[0]
+0000b330: 2c20 7374 7229 3a0a 2020 2020 2020 2020  , str):.        
+0000b340: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
+0000b350: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
+0000b360: 2020 2020 2020 2020 2020 2022 5072 6f76             "Prov
+0000b370: 6964 696e 6720 6576 656e 745f 7469 6d65  iding event_time
+0000b380: 2061 7320 6120 7369 6e67 6c65 2d65 6c65   as a single-ele
+0000b390: 6d65 6e74 206c 6973 7420 6973 2064 6570  ment list is dep
+0000b3a0: 7265 6361 7465 6422 0a20 2020 2020 2020  recated".       
+0000b3b0: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+0000b3c0: 2061 6e64 2077 696c 6c20 6265 2064 726f   and will be dro
+0000b3d0: 7070 6564 2069 6e20 6675 7475 7265 2076  pped in future v
+0000b3e0: 6572 7369 6f6e 732e 2050 726f 7669 6465  ersions. Provide
+0000b3f0: 2074 6865 2066 6561 7475 7265 5f6e 616d   the feature_nam
+0000b400: 6520 7374 7269 6e67 2069 6e73 7465 6164  e string instead
+0000b410: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+0000b420: 2020 2020 2020 2020 4465 7072 6563 6174          Deprecat
+0000b430: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
+0000b440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b450: 7374 6163 6b6c 6576 656c 3d32 2c0a 2020  stacklevel=2,.  
+0000b460: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0000b470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b480: 7365 6c66 2e5f 6576 656e 745f 7469 6d65  self._event_time
+0000b490: 203d 2066 6561 7475 7265 5f6e 616d 655b   = feature_name[
+0000b4a0: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+0000b4b0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+0000b4c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000b4d0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+0000b4e0: 2022 6576 656e 745f 7469 6d65 206d 7573   "event_time mus
+0000b4f0: 7420 6265 2061 2073 7472 696e 6720 636f  t be a string co
+0000b500: 7272 6573 706f 6e64 696e 6720 746f 2061  rresponding to a
+0000b510: 6e20 6578 6973 7469 6e67 2066 6561 7475  n existing featu
+0000b520: 7265 206e 616d 6520 6f66 2074 6865 2046  re name of the F
+0000b530: 6561 7475 7265 2047 726f 7570 2e22 0a20  eature Group.". 
+0000b540: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
+0000b550: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000b560: 6c6f 6361 7469 6f6e 2873 656c 6629 3a0a  location(self):.
+0000b570: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000b580: 656c 662e 5f6c 6f63 6174 696f 6e0a 0a20  elf._location.. 
+0000b590: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000b5a0: 2064 6566 2065 7870 6563 7461 7469 6f6e   def expectation
+0000b5b0: 5f73 7569 7465 280a 2020 2020 2020 2020  _suite(.        
+0000b5c0: 7365 6c66 2c0a 2020 2020 2920 2d3e 204f  self,.    ) -> O
+0000b5d0: 7074 696f 6e61 6c5b 4578 7065 6374 6174  ptional[Expectat
+0000b5e0: 696f 6e53 7569 7465 5d3a 0a20 2020 2020  ionSuite]:.     
+0000b5f0: 2020 2022 2222 4578 7065 6374 6174 696f     """Expectatio
+0000b600: 6e20 5375 6974 6520 636f 6e66 6967 7572  n Suite configur
+0000b610: 6174 696f 6e20 6f62 6a65 6374 2064 6566  ation object def
+0000b620: 696e 696e 6720 7468 6520 7365 7474 696e  ining the settin
+0000b630: 6773 2066 6f72 0a20 2020 2020 2020 2064  gs for.        d
+0000b640: 6174 6120 7661 6c69 6461 7469 6f6e 206f  ata validation o
+0000b650: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
+0000b660: 6f75 702e 2222 220a 2020 2020 2020 2020  oup.""".        
+0000b670: 7265 7475 726e 2073 656c 662e 5f65 7870  return self._exp
+0000b680: 6563 7461 7469 6f6e 5f73 7569 7465 0a0a  ectation_suite..
+0000b690: 2020 2020 4065 7870 6563 7461 7469 6f6e      @expectation
+0000b6a0: 5f73 7569 7465 2e73 6574 7465 720a 2020  _suite.setter.  
+0000b6b0: 2020 6465 6620 6578 7065 6374 6174 696f    def expectatio
+0000b6c0: 6e5f 7375 6974 6528 0a20 2020 2020 2020  n_suite(.       
+0000b6d0: 2073 656c 662c 0a20 2020 2020 2020 2065   self,.        e
+0000b6e0: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000b6f0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+0000b700: 2020 2020 2045 7870 6563 7461 7469 6f6e       Expectation
+0000b710: 5375 6974 652c 2067 652e 636f 7265 2e45  Suite, ge.core.E
+0000b720: 7870 6563 7461 7469 6f6e 5375 6974 652c  xpectationSuite,
+0000b730: 2064 6963 742c 204e 6f6e 650a 2020 2020   dict, None.    
+0000b740: 2020 2020 5d2c 0a20 2020 2029 3a0a 2020      ],.    ):.  
+0000b750: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0000b760: 6e63 6528 6578 7065 6374 6174 696f 6e5f  nce(expectation_
+0000b770: 7375 6974 652c 2045 7870 6563 7461 7469  suite, Expectati
+0000b780: 6f6e 5375 6974 6529 3a0a 2020 2020 2020  onSuite):.      
+0000b790: 2020 2020 2020 746d 705f 6578 7065 6374        tmp_expect
+0000b7a0: 6174 696f 6e5f 7375 6974 6520 3d20 6578  ation_suite = ex
+0000b7b0: 7065 6374 6174 696f 6e5f 7375 6974 652e  pectation_suite.
+0000b7c0: 746f 5f6a 736f 6e5f 6469 6374 2829 0a20  to_json_dict(). 
+0000b7d0: 2020 2020 2020 2020 2020 2074 6d70 5f65             tmp_e
+0000b7e0: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000b7f0: 5b22 6665 6174 7572 6567 726f 7570 5f69  ["featuregroup_i
+0000b800: 6422 5d20 3d20 7365 6c66 2e5f 6964 0a20  d"] = self._id. 
+0000b810: 2020 2020 2020 2020 2020 2074 6d70 5f65             tmp_e
+0000b820: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000b830: 5b22 6665 6174 7572 6573 746f 7265 5f69  ["featurestore_i
+0000b840: 6422 5d20 3d20 7365 6c66 2e5f 6665 6174  d"] = self._feat
+0000b850: 7572 655f 7374 6f72 655f 6964 0a20 2020  ure_store_id.   
+0000b860: 2020 2020 2020 2020 2073 656c 662e 5f65           self._e
+0000b870: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000b880: 203d 2045 7870 6563 7461 7469 6f6e 5375   = ExpectationSu
+0000b890: 6974 6528 2a2a 746d 705f 6578 7065 6374  ite(**tmp_expect
+0000b8a0: 6174 696f 6e5f 7375 6974 6529 0a20 2020  ation_suite).   
+0000b8b0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
+0000b8c0: 616e 6365 2865 7870 6563 7461 7469 6f6e  ance(expectation
+0000b8d0: 5f73 7569 7465 2c20 6765 2e63 6f72 652e  _suite, ge.core.
+0000b8e0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+0000b8f0: 652e 4578 7065 6374 6174 696f 6e53 7569  e.ExpectationSui
+0000b900: 7465 293a 0a20 2020 2020 2020 2020 2020  te):.           
+0000b910: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
+0000b920: 6f6e 5f73 7569 7465 203d 2045 7870 6563  on_suite = Expec
+0000b930: 7461 7469 6f6e 5375 6974 6528 0a20 2020  tationSuite(.   
+0000b940: 2020 2020 2020 2020 2020 2020 202a 2a65               **e
+0000b950: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000b960: 2e74 6f5f 6a73 6f6e 5f64 6963 7428 292c  .to_json_dict(),
+0000b970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b980: 2066 6561 7475 7265 5f73 746f 7265 5f69   feature_store_i
+0000b990: 643d 7365 6c66 2e5f 6665 6174 7572 655f  d=self._feature_
+0000b9a0: 7374 6f72 655f 6964 2c0a 2020 2020 2020  store_id,.      
+0000b9b0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+0000b9c0: 655f 6772 6f75 705f 6964 3d73 656c 662e  e_group_id=self.
+0000b9d0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+0000b9e0: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
+0000b9f0: 6973 696e 7374 616e 6365 2865 7870 6563  isinstance(expec
+0000ba00: 7461 7469 6f6e 5f73 7569 7465 2c20 6469  tation_suite, di
+0000ba10: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
+0000ba20: 2074 6d70 5f65 7870 6563 7461 7469 6f6e   tmp_expectation
+0000ba30: 5f73 7569 7465 203d 2065 7870 6563 7461  _suite = expecta
+0000ba40: 7469 6f6e 5f73 7569 7465 2e63 6f70 7928  tion_suite.copy(
+0000ba50: 290a 2020 2020 2020 2020 2020 2020 746d  ).            tm
+0000ba60: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
+0000ba70: 6974 655b 2266 6561 7475 7265 5f73 746f  ite["feature_sto
+0000ba80: 7265 5f69 6422 5d20 3d20 7365 6c66 2e5f  re_id"] = self._
+0000ba90: 6665 6174 7572 655f 7374 6f72 655f 6964  feature_store_id
+0000baa0: 0a20 2020 2020 2020 2020 2020 2074 6d70  .            tmp
+0000bab0: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
+0000bac0: 7465 5b22 6665 6174 7572 655f 6772 6f75  te["feature_grou
+0000bad0: 705f 6964 225d 203d 2073 656c 662e 5f69  p_id"] = self._i
+0000bae0: 640a 2020 2020 2020 2020 2020 2020 7365  d.            se
+0000baf0: 6c66 2e5f 6578 7065 6374 6174 696f 6e5f  lf._expectation_
+0000bb00: 7375 6974 6520 3d20 4578 7065 6374 6174  suite = Expectat
+0000bb10: 696f 6e53 7569 7465 282a 2a74 6d70 5f65  ionSuite(**tmp_e
+0000bb20: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000bb30: 290a 2020 2020 2020 2020 656c 6966 2065  ).        elif e
+0000bb40: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000bb50: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0000bb60: 2020 2020 2020 7365 6c66 2e5f 6578 7065        self._expe
+0000bb70: 6374 6174 696f 6e5f 7375 6974 6520 3d20  ctation_suite = 
+0000bb80: 4e6f 6e65 0a20 2020 2020 2020 2065 6c73  None.        els
+0000bb90: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0000bba0: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
+0000bbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bbc0: 2254 6865 2061 7267 756d 656e 7420 6065  "The argument `e
+0000bbd0: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+0000bbe0: 6020 6861 7320 746f 2062 6520 604e 6f6e  ` has to be `Non
+0000bbf0: 6560 206f 6620 7479 7065 2060 4578 7065  e` of type `Expe
+0000bc00: 6374 6174 696f 6e53 7569 7465 6020 6f72  ctationSuite` or
+0000bc10: 2060 6469 6374 602c 2062 7574 2069 7320   `dict`, but is 
+0000bc20: 6f66 2074 7970 653a 2060 7b7d 6022 2e66  of type: `{}`".f
+0000bc30: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+0000bc40: 2020 2020 2020 2020 2020 2074 7970 6528             type(
+0000bc50: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+0000bc60: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0000bc70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000bc80: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
+0000bc90: 790a 2020 2020 6465 6620 6f6e 6c69 6e65  y.    def online
+0000bca0: 5f65 6e61 626c 6564 2873 656c 6629 3a0a  _enabled(self):.
+0000bcb0: 2020 2020 2020 2020 2222 2253 6574 7469          """Setti
+0000bcc0: 6e67 2069 6620 7468 6520 6665 6174 7572  ng if the featur
+0000bcd0: 6520 6772 6f75 7020 6973 2061 7661 696c  e group is avail
+0000bce0: 6162 6c65 2069 6e20 6f6e 6c69 6e65 2073  able in online s
+0000bcf0: 746f 7261 6765 2e22 2222 0a20 2020 2020  torage.""".     
+0000bd00: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000bd10: 6f6e 6c69 6e65 5f65 6e61 626c 6564 0a0a  online_enabled..
+0000bd20: 2020 2020 406f 6e6c 696e 655f 656e 6162      @online_enab
+0000bd30: 6c65 642e 7365 7474 6572 0a20 2020 2064  led.setter.    d
+0000bd40: 6566 206f 6e6c 696e 655f 656e 6162 6c65  ef online_enable
+0000bd50: 6428 7365 6c66 2c20 6f6e 6c69 6e65 5f65  d(self, online_e
+0000bd60: 6e61 626c 6564 293a 0a20 2020 2020 2020  nabled):.       
+0000bd70: 2073 656c 662e 5f6f 6e6c 696e 655f 656e   self._online_en
+0000bd80: 6162 6c65 6420 3d20 6f6e 6c69 6e65 5f65  abled = online_e
+0000bd90: 6e61 626c 6564 0a0a 2020 2020 4070 726f  nabled..    @pro
+0000bda0: 7065 7274 790a 2020 2020 6465 6620 7375  perty.    def su
+0000bdb0: 626a 6563 7428 7365 6c66 293a 0a20 2020  bject(self):.   
+0000bdc0: 2020 2020 2022 2222 5375 626a 6563 7420       """Subject 
+0000bdd0: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
+0000bde0: 726f 7570 2e22 2222 0a20 2020 2020 2020  roup.""".       
+0000bdf0: 2069 6620 7365 6c66 2e5f 7375 626a 6563   if self._subjec
+0000be00: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+0000be10: 2020 2020 2020 2023 2063 6163 6865 2074         # cache t
+0000be20: 6865 2073 6368 656d 610a 2020 2020 2020  he schema.      
+0000be30: 2020 2020 2020 7365 6c66 2e5f 7375 626a        self._subj
+0000be40: 6563 7420 3d20 7365 6c66 2e5f 6665 6174  ect = self._feat
+0000be50: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
+0000be60: 2e67 6574 5f73 7562 6a65 6374 2873 656c  .get_subject(sel
+0000be70: 6629 0a20 2020 2020 2020 2072 6574 7572  f).        retur
+0000be80: 6e20 7365 6c66 2e5f 7375 626a 6563 740a  n self._subject.
+0000be90: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000bea0: 2020 2064 6566 2061 7672 6f5f 7363 6865     def avro_sche
+0000beb0: 6d61 2873 656c 6629 3a0a 2020 2020 2020  ma(self):.      
+0000bec0: 2020 2222 2241 7672 6f20 7363 6865 6d61    """Avro schema
+0000bed0: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
+0000bee0: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
+0000bef0: 726f 7570 2e22 2222 0a20 2020 2020 2020  roup.""".       
+0000bf00: 2072 6574 7572 6e20 7365 6c66 2e73 7562   return self.sub
+0000bf10: 6a65 6374 5b22 7363 6865 6d61 225d 0a0a  ject["schema"]..
+0000bf20: 2020 2020 6465 6620 6765 745f 636f 6d70      def get_comp
+0000bf30: 6c65 785f 6665 6174 7572 6573 2873 656c  lex_features(sel
+0000bf40: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
+0000bf50: 6574 7572 6e73 2074 6865 206e 616d 6573  eturns the names
+0000bf60: 206f 6620 616c 6c20 6665 6174 7572 6573   of all features
+0000bf70: 2077 6974 6820 6120 636f 6d70 6c65 7820   with a complex 
+0000bf80: 6461 7461 2074 7970 6520 696e 2074 6869  data type in thi
+0000bf90: 730a 2020 2020 2020 2020 6665 6174 7572  s.        featur
+0000bfa0: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
+0000bfb0: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
+0000bfc0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+0000bfd0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+0000bfe0: 636f 6d70 6c65 785f 6474 7970 655f 6665  complex_dtype_fe
+0000bff0: 6174 7572 6573 203d 2066 672e 6765 745f  atures = fg.get_
+0000c000: 636f 6d70 6c65 785f 6665 6174 7572 6573  complex_features
+0000c010: 2829 0a20 2020 2020 2020 2020 2020 2060  ().            `
+0000c020: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
+0000c030: 2020 2020 2020 2072 6574 7572 6e20 5b66         return [f
+0000c040: 2e6e 616d 6520 666f 7220 6620 696e 2073  .name for f in s
+0000c050: 656c 662e 6665 6174 7572 6573 2069 6620  elf.features if 
+0000c060: 662e 6973 5f63 6f6d 706c 6578 2829 5d0a  f.is_complex()].
+0000c070: 0a20 2020 2064 6566 205f 6765 745f 656e  .    def _get_en
+0000c080: 636f 6465 645f 6176 726f 5f73 6368 656d  coded_avro_schem
+0000c090: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
+0000c0a0: 2063 6f6d 706c 6578 5f66 6561 7475 7265   complex_feature
+0000c0b0: 7320 3d20 7365 6c66 2e67 6574 5f63 6f6d  s = self.get_com
+0000c0c0: 706c 6578 5f66 6561 7475 7265 7328 290a  plex_features().
+0000c0d0: 2020 2020 2020 2020 7363 6865 6d61 203d          schema =
+0000c0e0: 206a 736f 6e2e 6c6f 6164 7328 7365 6c66   json.loads(self
+0000c0f0: 2e61 7672 6f5f 7363 6865 6d61 290a 0a20  .avro_schema).. 
+0000c100: 2020 2020 2020 2066 6f72 2066 6965 6c64         for field
+0000c110: 2069 6e20 7363 6865 6d61 5b22 6669 656c   in schema["fiel
+0000c120: 6473 225d 3a0a 2020 2020 2020 2020 2020  ds"]:.          
+0000c130: 2020 6966 2066 6965 6c64 5b22 6e61 6d65    if field["name
+0000c140: 225d 2069 6e20 636f 6d70 6c65 785f 6665  "] in complex_fe
+0000c150: 6174 7572 6573 3a0a 2020 2020 2020 2020  atures:.        
+0000c160: 2020 2020 2020 2020 6669 656c 645b 2274          field["t
+0000c170: 7970 6522 5d20 3d20 5b22 6e75 6c6c 222c  ype"] = ["null",
+0000c180: 2022 6279 7465 7322 5d0a 0a20 2020 2020   "bytes"]..     
+0000c190: 2020 2073 6368 656d 615f 7320 3d20 6a73     schema_s = js
+0000c1a0: 6f6e 2e64 756d 7073 2873 6368 656d 6129  on.dumps(schema)
+0000c1b0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0000c1c0: 2020 2020 2020 2020 2020 6176 726f 2e73            avro.s
+0000c1d0: 6368 656d 612e 7061 7273 6528 7363 6865  chema.parse(sche
+0000c1e0: 6d61 5f73 290a 2020 2020 2020 2020 6578  ma_s).        ex
+0000c1f0: 6365 7074 2061 7672 6f2e 7363 6865 6d61  cept avro.schema
+0000c200: 2e53 6368 656d 6150 6172 7365 4578 6365  .SchemaParseExce
+0000c210: 7074 696f 6e20 6173 2065 3a0a 2020 2020  ption as e:.    
+0000c220: 2020 2020 2020 2020 7261 6973 6520 4665          raise Fe
+0000c230: 6174 7572 6553 746f 7265 4578 6365 7074  atureStoreExcept
+0000c240: 696f 6e28 2246 6169 6c65 6420 746f 2063  ion("Failed to c
+0000c250: 6f6e 7374 7275 6374 2041 7672 6f20 5363  onstruct Avro Sc
+0000c260: 6865 6d61 3a20 7b7d 222e 666f 726d 6174  hema: {}".format
+0000c270: 2865 2929 0a20 2020 2020 2020 2072 6574  (e)).        ret
+0000c280: 7572 6e20 7363 6865 6d61 5f73 0a0a 2020  urn schema_s..  
+0000c290: 2020 6465 6620 5f67 6574 5f66 6561 7475    def _get_featu
+0000c2a0: 7265 5f61 7672 6f5f 7363 6865 6d61 2873  re_avro_schema(s
+0000c2b0: 656c 662c 2066 6561 7475 7265 5f6e 616d  elf, feature_nam
+0000c2c0: 6529 3a0a 2020 2020 2020 2020 666f 7220  e):.        for 
+0000c2d0: 6669 656c 6420 696e 206a 736f 6e2e 6c6f  field in json.lo
+0000c2e0: 6164 7328 7365 6c66 2e61 7672 6f5f 7363  ads(self.avro_sc
+0000c2f0: 6865 6d61 295b 2266 6965 6c64 7322 5d3a  hema)["fields"]:
+0000c300: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000c310: 6669 656c 645b 226e 616d 6522 5d20 3d3d  field["name"] ==
+0000c320: 2066 6561 7475 7265 5f6e 616d 653a 0a20   feature_name:. 
+0000c330: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000c340: 6574 7572 6e20 6a73 6f6e 2e64 756d 7073  eturn json.dumps
+0000c350: 2866 6965 6c64 5b22 7479 7065 225d 290a  (field["type"]).
+0000c360: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000c370: 2020 2064 6566 2066 6561 7475 7265 7328     def features(
+0000c380: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0000c390: 2222 5363 6865 6d61 2069 6e66 6f72 6d61  ""Schema informa
+0000c3a0: 7469 6f6e 2e22 2222 0a20 2020 2020 2020  tion.""".       
+0000c3b0: 2072 6574 7572 6e20 7365 6c66 2e5f 6665   return self._fe
+0000c3c0: 6174 7572 6573 0a0a 2020 2020 4066 6561  atures..    @fea
+0000c3d0: 7475 7265 732e 7365 7474 6572 0a20 2020  tures.setter.   
+0000c3e0: 2064 6566 2066 6561 7475 7265 7328 7365   def features(se
+0000c3f0: 6c66 2c20 6e65 775f 6665 6174 7572 6573  lf, new_features
+0000c400: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+0000c410: 5f66 6561 7475 7265 7320 3d20 6e65 775f  _features = new_
+0000c420: 6665 6174 7572 6573 0a0a 0a63 6c61 7373  features...class
+0000c430: 2046 6561 7475 7265 4772 6f75 7028 4665   FeatureGroup(Fe
+0000c440: 6174 7572 6547 726f 7570 4261 7365 293a  atureGroupBase):
+0000c450: 0a20 2020 2043 4143 4845 445f 4645 4154  .    CACHED_FEAT
+0000c460: 5552 455f 4752 4f55 5020 3d20 2243 4143  URE_GROUP = "CAC
+0000c470: 4845 445f 4645 4154 5552 455f 4752 4f55  HED_FEATURE_GROU
+0000c480: 5022 0a20 2020 2053 5452 4541 4d5f 4645  P".    STREAM_FE
+0000c490: 4154 5552 455f 4752 4f55 5020 3d20 2253  ATURE_GROUP = "S
+0000c4a0: 5452 4541 4d5f 4645 4154 5552 455f 4752  TREAM_FEATURE_GR
+0000c4b0: 4f55 5022 0a20 2020 2045 4e54 4954 595f  OUP".    ENTITY_
+0000c4c0: 5459 5045 203d 2022 6665 6174 7572 6567  TYPE = "featureg
+0000c4d0: 726f 7570 7322 0a0a 2020 2020 6465 6620  roups"..    def 
+0000c4e0: 5f5f 696e 6974 5f5f 280a 2020 2020 2020  __init__(.      
+0000c4f0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0000c500: 6e61 6d65 2c0a 2020 2020 2020 2020 7665  name,.        ve
+0000c510: 7273 696f 6e2c 0a20 2020 2020 2020 2066  rsion,.        f
+0000c520: 6561 7475 7265 7374 6f72 655f 6964 2c0a  eaturestore_id,.
+0000c530: 2020 2020 2020 2020 6465 7363 7269 7074          descript
+0000c540: 696f 6e3d 2222 2c0a 2020 2020 2020 2020  ion="",.        
+0000c550: 7061 7274 6974 696f 6e5f 6b65 793d 4e6f  partition_key=No
+0000c560: 6e65 2c0a 2020 2020 2020 2020 7072 696d  ne,.        prim
+0000c570: 6172 795f 6b65 793d 4e6f 6e65 2c0a 2020  ary_key=None,.  
+0000c580: 2020 2020 2020 6875 6469 5f70 7265 636f        hudi_preco
+0000c590: 6d62 696e 655f 6b65 793d 4e6f 6e65 2c0a  mbine_key=None,.
+0000c5a0: 2020 2020 2020 2020 6665 6174 7572 6573          features
+0000c5b0: 746f 7265 5f6e 616d 653d 4e6f 6e65 2c0a  tore_name=None,.
+0000c5c0: 2020 2020 2020 2020 6372 6561 7465 643d          created=
+0000c5d0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6372  None,.        cr
+0000c5e0: 6561 746f 723d 4e6f 6e65 2c0a 2020 2020  eator=None,.    
+0000c5f0: 2020 2020 6964 3d4e 6f6e 652c 0a20 2020      id=None,.   
+0000c600: 2020 2020 2066 6561 7475 7265 733d 4e6f       features=No
+0000c610: 6e65 2c0a 2020 2020 2020 2020 6c6f 6361  ne,.        loca
+0000c620: 7469 6f6e 3d4e 6f6e 652c 0a20 2020 2020  tion=None,.     
+0000c630: 2020 206f 6e6c 696e 655f 656e 6162 6c65     online_enable
+0000c640: 643d 4661 6c73 652c 0a20 2020 2020 2020  d=False,.       
+0000c650: 2074 696d 655f 7472 6176 656c 5f66 6f72   time_travel_for
+0000c660: 6d61 743d 4e6f 6e65 2c0a 2020 2020 2020  mat=None,.      
+0000c670: 2020 7374 6174 6973 7469 6373 5f63 6f6e    statistics_con
+0000c680: 6669 673d 4e6f 6e65 2c0a 2020 2020 2020  fig=None,.      
+0000c690: 2020 6f6e 6c69 6e65 5f74 6f70 6963 5f6e    online_topic_n
+0000c6a0: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
+0000c6b0: 2020 6576 656e 745f 7469 6d65 3d4e 6f6e    event_time=Non
+0000c6c0: 652c 0a20 2020 2020 2020 2073 7472 6561  e,.        strea
+0000c6d0: 6d3d 4661 6c73 652c 0a20 2020 2020 2020  m=False,.       
+0000c6e0: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
+0000c6f0: 7465 3d4e 6f6e 652c 0a20 2020 2020 2020  te=None,.       
+0000c700: 2070 6172 656e 7473 3d4e 6f6e 652c 0a20   parents=None,. 
+0000c710: 2020 2020 2020 2068 7265 663d 4e6f 6e65         href=None
+0000c720: 2c0a 2020 2020 2020 2020 6465 6c74 615f  ,.        delta_
+0000c730: 7374 7265 616d 6572 5f6a 6f62 5f63 6f6e  streamer_job_con
+0000c740: 663d 4e6f 6e65 2c0a 2020 2020 293a 0a20  f=None,.    ):. 
+0000c750: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+0000c760: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
+0000c770: 2020 2020 2066 6561 7475 7265 7374 6f72       featurestor
+0000c780: 655f 6964 2c0a 2020 2020 2020 2020 2020  e_id,.          
+0000c790: 2020 6c6f 6361 7469 6f6e 2c0a 2020 2020    location,.    
+0000c7a0: 2020 2020 2020 2020 6576 656e 745f 7469          event_ti
+0000c7b0: 6d65 3d65 7665 6e74 5f74 696d 652c 0a20  me=event_time,. 
+0000c7c0: 2020 2020 2020 2020 2020 206f 6e6c 696e             onlin
+0000c7d0: 655f 656e 6162 6c65 643d 6f6e 6c69 6e65  e_enabled=online
+0000c7e0: 5f65 6e61 626c 6564 2c0a 2020 2020 2020  _enabled,.      
+0000c7f0: 2020 2020 2020 6964 3d69 642c 0a20 2020        id=id,.   
+0000c800: 2020 2020 2020 2020 2065 7870 6563 7461           expecta
+0000c810: 7469 6f6e 5f73 7569 7465 3d65 7870 6563  tion_suite=expec
+0000c820: 7461 7469 6f6e 5f73 7569 7465 2c0a 2020  tation_suite,.  
+0000c830: 2020 2020 2020 2020 2020 6f6e 6c69 6e65            online
+0000c840: 5f74 6f70 6963 5f6e 616d 653d 6f6e 6c69  _topic_name=onli
+0000c850: 6e65 5f74 6f70 6963 5f6e 616d 652c 0a20  ne_topic_name,. 
+0000c860: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000c870: 2020 7365 6c66 2e5f 6665 6174 7572 655f    self._feature_
+0000c880: 7374 6f72 655f 6e61 6d65 203d 2066 6561  store_name = fea
+0000c890: 7475 7265 7374 6f72 655f 6e61 6d65 0a20  turestore_name. 
+0000c8a0: 2020 2020 2020 2073 656c 662e 5f64 6573         self._des
+0000c8b0: 6372 6970 7469 6f6e 203d 2064 6573 6372  cription = descr
+0000c8c0: 6970 7469 6f6e 0a20 2020 2020 2020 2073  iption.        s
+0000c8d0: 656c 662e 5f63 7265 6174 6564 203d 2063  elf._created = c
+0000c8e0: 7265 6174 6564 0a20 2020 2020 2020 2073  reated.        s
+0000c8f0: 656c 662e 5f63 7265 6174 6f72 203d 2075  elf._creator = u
+0000c900: 7365 722e 5573 6572 2e66 726f 6d5f 7265  ser.User.from_re
+0000c910: 7370 6f6e 7365 5f6a 736f 6e28 6372 6561  sponse_json(crea
+0000c920: 746f 7229 0a20 2020 2020 2020 2073 656c  tor).        sel
+0000c930: 662e 5f76 6572 7369 6f6e 203d 2076 6572  f._version = ver
+0000c940: 7369 6f6e 0a20 2020 2020 2020 2073 656c  sion.        sel
+0000c950: 662e 5f6e 616d 6520 3d20 6e61 6d65 0a20  f._name = name. 
+0000c960: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
+0000c970: 7475 7265 7320 3d20 5b0a 2020 2020 2020  tures = [.      
+0000c980: 2020 2020 2020 6665 6174 7572 652e 4665        feature.Fe
+0000c990: 6174 7572 652e 6672 6f6d 5f72 6573 706f  ature.from_respo
+0000c9a0: 6e73 655f 6a73 6f6e 2866 6561 7429 2069  nse_json(feat) i
+0000c9b0: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
+0000c9c0: 742c 2064 6963 7429 2065 6c73 6520 6665  t, dict) else fe
+0000c9d0: 6174 0a20 2020 2020 2020 2020 2020 2066  at.            f
+0000c9e0: 6f72 2066 6561 7420 696e 2028 6665 6174  or feat in (feat
+0000c9f0: 7572 6573 206f 7220 5b5d 290a 2020 2020  ures or []).    
+0000ca00: 2020 2020 5d0a 0a20 2020 2020 2020 2073      ]..        s
+0000ca10: 656c 662e 5f74 696d 655f 7472 6176 656c  elf._time_travel
+0000ca20: 5f66 6f72 6d61 7420 3d20 280a 2020 2020  _format = (.    
+0000ca30: 2020 2020 2020 2020 7469 6d65 5f74 7261          time_tra
+0000ca40: 7665 6c5f 666f 726d 6174 2e75 7070 6572  vel_format.upper
+0000ca50: 2829 2069 6620 7469 6d65 5f74 7261 7665  () if time_trave
+0000ca60: 6c5f 666f 726d 6174 2069 7320 6e6f 7420  l_format is not 
+0000ca70: 4e6f 6e65 2065 6c73 6520 4e6f 6e65 0a20  None else None. 
+0000ca80: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000ca90: 2020 7365 6c66 2e5f 7374 7265 616d 203d    self._stream =
+0000caa0: 2073 7472 6561 6d0a 2020 2020 2020 2020   stream.        
+0000cab0: 7365 6c66 2e5f 7061 7265 6e74 7320 3d20  self._parents = 
+0000cac0: 7061 7265 6e74 730a 2020 2020 2020 2020  parents.        
+0000cad0: 7365 6c66 2e5f 6465 6c74 6173 7472 6561  self._deltastrea
+0000cae0: 6d65 725f 6a6f 6263 6f6e 6620 3d20 6465  mer_jobconf = de
+0000caf0: 6c74 615f 7374 7265 616d 6572 5f6a 6f62  lta_streamer_job
+0000cb00: 5f63 6f6e 660a 0a20 2020 2020 2020 2073  _conf..        s
+0000cb10: 656c 662e 5f62 6163 6b66 696c 6c5f 6a6f  elf._backfill_jo
+0000cb20: 6220 3d20 4e6f 6e65 0a0a 2020 2020 2020  b = None..      
+0000cb30: 2020 6966 2073 656c 662e 5f69 643a 0a20    if self._id:. 
+0000cb40: 2020 2020 2020 2020 2020 2023 2069 6e69             # ini
+0000cb50: 7469 616c 697a 6564 2062 7920 6261 636b  tialized by back
+0000cb60: 656e 640a 2020 2020 2020 2020 2020 2020  end.            
+0000cb70: 7365 6c66 2e70 7269 6d61 7279 5f6b 6579  self.primary_key
+0000cb80: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0000cb90: 2020 2020 2066 6561 742e 6e61 6d65 2066       feat.name f
+0000cba0: 6f72 2066 6561 7420 696e 2073 656c 662e  or feat in self.
+0000cbb0: 5f66 6561 7475 7265 7320 6966 2066 6561  _features if fea
+0000cbc0: 742e 7072 696d 6172 7920 6973 2054 7275  t.primary is Tru
+0000cbd0: 650a 2020 2020 2020 2020 2020 2020 5d0a  e.            ].
+0000cbe0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cbf0: 2e5f 7061 7274 6974 696f 6e5f 6b65 7920  ._partition_key 
+0000cc00: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+0000cc10: 2020 2020 6665 6174 2e6e 616d 6520 666f      feat.name fo
+0000cc20: 7220 6665 6174 2069 6e20 7365 6c66 2e5f  r feat in self._
+0000cc30: 6665 6174 7572 6573 2069 6620 6665 6174  features if feat
+0000cc40: 2e70 6172 7469 7469 6f6e 2069 7320 5472  .partition is Tr
+0000cc50: 7565 0a20 2020 2020 2020 2020 2020 205d  ue.            ]
+0000cc60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000cc70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000cc80: 2020 7469 6d65 5f74 7261 7665 6c5f 666f    time_travel_fo
+0000cc90: 726d 6174 2069 7320 6e6f 7420 4e6f 6e65  rmat is not None
+0000cca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ccb0: 2061 6e64 2074 696d 655f 7472 6176 656c   and time_travel
+0000ccc0: 5f66 6f72 6d61 742e 7570 7065 7228 2920  _format.upper() 
+0000ccd0: 3d3d 2022 4855 4449 220a 2020 2020 2020  == "HUDI".      
+0000cce0: 2020 2020 2020 2020 2020 616e 6420 7365            and se
+0000ccf0: 6c66 2e5f 6665 6174 7572 6573 0a20 2020  lf._features.   
+0000cd00: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+0000cd10: 2020 2020 2020 2020 2020 2020 2320 6875              # hu
+0000cd20: 6469 2070 7265 636f 6d62 696e 6520 6b65  di precombine ke
+0000cd30: 7920 6973 2061 6c77 6179 7320 6120 7369  y is always a si
+0000cd40: 6e67 6c65 2066 6561 7475 7265 0a20 2020  ngle feature.   
+0000cd50: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000cd60: 662e 5f68 7564 695f 7072 6563 6f6d 6269  f._hudi_precombi
+0000cd70: 6e65 5f6b 6579 203d 205b 0a20 2020 2020  ne_key = [.     
+0000cd80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000cd90: 6561 742e 6e61 6d65 0a20 2020 2020 2020  eat.name.       
+0000cda0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0000cdb0: 2066 6561 7420 696e 2073 656c 662e 5f66   feat in self._f
+0000cdc0: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
+0000cdd0: 2020 2020 2020 2020 2020 2020 6966 2066              if f
+0000cde0: 6561 742e 6875 6469 5f70 7265 636f 6d62  eat.hudi_precomb
+0000cdf0: 696e 655f 6b65 7920 6973 2054 7275 650a  ine_key is True.
+0000ce00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce10: 5d5b 305d 0a20 2020 2020 2020 2020 2020  ][0].           
+0000ce20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000ce30: 2020 2020 2020 2073 656c 662e 5f68 7564         self._hud
+0000ce40: 695f 7072 6563 6f6d 6269 6e65 5f6b 6579  i_precombine_key
+0000ce50: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+0000ce60: 2020 2020 2073 656c 662e 7374 6174 6973       self.statis
+0000ce70: 7469 6373 5f63 6f6e 6669 6720 3d20 7374  tics_config = st
+0000ce80: 6174 6973 7469 6373 5f63 6f6e 6669 670a  atistics_config.
+0000ce90: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000cea0: 2020 2020 2020 2020 2020 2023 2069 6e69             # ini
+0000ceb0: 7469 616c 697a 6564 2062 7920 7573 6572  tialized by user
+0000cec0: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
+0000ced0: 6f72 2070 7974 686f 6e20 656e 6769 6e65  or python engine
+0000cee0: 2077 6520 616c 7761 7973 2075 7365 2073   we always use s
+0000cef0: 7472 6561 6d20 6665 6174 7572 6520 6772  tream feature gr
+0000cf00: 6f75 700a 2020 2020 2020 2020 2020 2020  oup.            
+0000cf10: 6966 2065 6e67 696e 652e 6765 745f 7479  if engine.get_ty
+0000cf20: 7065 2829 203d 3d20 2270 7974 686f 6e22  pe() == "python"
+0000cf30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000cf40: 2020 7365 6c66 2e5f 7374 7265 616d 203d    self._stream =
+0000cf50: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0000cf60: 2020 2320 666f 7220 7374 7265 616d 2066    # for stream f
+0000cf70: 6561 7475 7265 2067 726f 7570 2074 696d  eature group tim
+0000cf80: 6520 7472 6176 656c 2066 6f72 6d61 7420  e travel format 
+0000cf90: 6973 2061 6c77 6179 7320 4855 4449 0a20  is always HUDI. 
+0000cfa0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0000cfb0: 6c66 2e5f 7374 7265 616d 3a0a 2020 2020  lf._stream:.    
+0000cfc0: 2020 2020 2020 2020 2020 2020 6578 7065              expe
+0000cfd0: 6374 6564 5f66 6f72 6d61 7420 3d20 2248  cted_format = "H
+0000cfe0: 5544 4922 0a20 2020 2020 2020 2020 2020  UDI".           
+0000cff0: 2020 2020 2069 6620 7365 6c66 2e5f 7469       if self._ti
+0000d000: 6d65 5f74 7261 7665 6c5f 666f 726d 6174  me_travel_format
+0000d010: 2021 3d20 6578 7065 6374 6564 5f66 6f72   != expected_for
+0000d020: 6d61 743a 0a20 2020 2020 2020 2020 2020  mat:.           
+0000d030: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+0000d040: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+0000d050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d060: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000d070: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+0000d080: 6865 2070 726f 7669 6465 6420 7469 6d65  he provided time
+0000d090: 2074 7261 7665 6c20 666f 726d 6174 2060   travel format `
+0000d0a0: 7b7d 6020 6861 7320 6265 656e 206f 7665  {}` has been ove
+0000d0b0: 7277 7269 7474 656e 2022 0a20 2020 2020  rwritten ".     
+0000d0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d0d0: 2020 2020 2020 2022 6265 6361 7573 6520         "because 
+0000d0e0: 5374 7265 616d 2065 6e61 626c 6564 2066  Stream enabled f
+0000d0f0: 6561 7475 7265 2067 726f 7570 7320 6f6e  eature groups on
+0000d100: 6c79 2073 7570 706f 7274 2060 7b7d 6022  ly support `{}`"
+0000d110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d120: 2020 2020 2020 2020 2029 2e66 6f72 6d61           ).forma
+0000d130: 7428 7365 6c66 2e5f 7469 6d65 5f74 7261  t(self._time_tra
+0000d140: 7665 6c5f 666f 726d 6174 2c20 6578 7065  vel_format, expe
+0000d150: 6374 6564 5f66 6f72 6d61 7429 2c0a 2020  cted_format),.  
+0000d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d170: 2020 2020 2020 7574 696c 2e46 6561 7475        util.Featu
+0000d180: 7265 4772 6f75 7057 6172 6e69 6e67 2c0a  reGroupWarning,.
+0000d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d1a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000d1b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000d1c0: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
+0000d1d0: 6174 203d 2065 7870 6563 7465 645f 666f  at = expected_fo
+0000d1e0: 726d 6174 0a0a 2020 2020 2020 2020 2020  rmat..          
+0000d1f0: 2020 7365 6c66 2e70 7269 6d61 7279 5f6b    self.primary_k
+0000d200: 6579 203d 2070 7269 6d61 7279 5f6b 6579  ey = primary_key
+0000d210: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d220: 662e 7061 7274 6974 696f 6e5f 6b65 7920  f.partition_key 
+0000d230: 3d20 7061 7274 6974 696f 6e5f 6b65 790a  = partition_key.
+0000d240: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000d250: 2e5f 6875 6469 5f70 7265 636f 6d62 696e  ._hudi_precombin
+0000d260: 655f 6b65 7920 3d20 280a 2020 2020 2020  e_key = (.      
+0000d270: 2020 2020 2020 2020 2020 6875 6469 5f70            hudi_p
+0000d280: 7265 636f 6d62 696e 655f 6b65 792e 6c6f  recombine_key.lo
+0000d290: 7765 7228 290a 2020 2020 2020 2020 2020  wer().          
+0000d2a0: 2020 2020 2020 6966 2068 7564 695f 7072        if hudi_pr
+0000d2b0: 6563 6f6d 6269 6e65 5f6b 6579 2069 7320  ecombine_key is 
+0000d2c0: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+0000d2d0: 2020 2020 2020 2020 2061 6e64 2073 656c           and sel
+0000d2e0: 662e 5f74 696d 655f 7472 6176 656c 5f66  f._time_travel_f
+0000d2f0: 6f72 6d61 7420 6973 206e 6f74 204e 6f6e  ormat is not Non
+0000d300: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0000d310: 2020 616e 6420 7365 6c66 2e5f 7469 6d65    and self._time
+0000d320: 5f74 7261 7665 6c5f 666f 726d 6174 203d  _travel_format =
+0000d330: 3d20 2248 5544 4922 0a20 2020 2020 2020  = "HUDI".       
+0000d340: 2020 2020 2020 2020 2065 6c73 6520 4e6f           else No
+0000d350: 6e65 0a20 2020 2020 2020 2020 2020 2029  ne.            )
+0000d360: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000d370: 662e 7374 6174 6973 7469 6373 5f63 6f6e  f.statistics_con
+0000d380: 6669 6720 3d20 7374 6174 6973 7469 6373  fig = statistics
+0000d390: 5f63 6f6e 6669 670a 0a20 2020 2020 2020  _config..       
+0000d3a0: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+0000d3b0: 726f 7570 5f65 6e67 696e 6520 3d20 6665  roup_engine = fe
+0000d3c0: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
+0000d3d0: 6e65 2e46 6561 7475 7265 4772 6f75 7045  ne.FeatureGroupE
+0000d3e0: 6e67 696e 6528 0a20 2020 2020 2020 2020  ngine(.         
+0000d3f0: 2020 2066 6561 7475 7265 7374 6f72 655f     featurestore_
+0000d400: 6964 0a20 2020 2020 2020 2029 0a20 2020  id.        ).   
+0000d410: 2020 2020 2073 656c 662e 5f68 7265 6620       self._href 
+0000d420: 3d20 6872 6566 0a0a 2020 2020 2020 2020  = href..        
+0000d430: 2320 6361 6368 6520 666f 7220 6f70 7469  # cache for opti
+0000d440: 6d69 7a65 6420 7772 6974 6573 0a20 2020  mized writes.   
+0000d450: 2020 2020 2073 656c 662e 5f6b 6166 6b61       self._kafka
+0000d460: 5f70 726f 6475 6365 7220 3d20 4e6f 6e65  _producer = None
+0000d470: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+0000d480: 6561 7475 7265 5f77 7269 7465 7273 203d  eature_writers =
+0000d490: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+0000d4a0: 6c66 2e5f 7772 6974 6572 203d 204e 6f6e  lf._writer = Non
+0000d4b0: 650a 0a20 2020 2064 6566 2072 6561 6428  e..    def read(
+0000d4c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000d4d0: 2020 2020 2020 2077 616c 6c63 6c6f 636b         wallclock
+0000d4e0: 5f74 696d 653a 204f 7074 696f 6e61 6c5b  _time: Optional[
+0000d4f0: 556e 696f 6e5b 7374 722c 2069 6e74 2c20  Union[str, int, 
+0000d500: 6461 7465 7469 6d65 2c20 6461 7465 5d5d  datetime, date]]
+0000d510: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000d520: 206f 6e6c 696e 653a 204f 7074 696f 6e61   online: Optiona
+0000d530: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
+0000d540: 0a20 2020 2020 2020 2064 6174 6166 7261  .        datafra
+0000d550: 6d65 5f74 7970 653a 204f 7074 696f 6e61  me_type: Optiona
+0000d560: 6c5b 7374 725d 203d 2022 6465 6661 756c  l[str] = "defaul
+0000d570: 7422 2c0a 2020 2020 2020 2020 7265 6164  t",.        read
+0000d580: 5f6f 7074 696f 6e73 3a20 4f70 7469 6f6e  _options: Option
+0000d590: 616c 5b64 6963 745d 203d 207b 7d2c 0a20  al[dict] = {},. 
+0000d5a0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0000d5b0: 220a 2020 2020 2020 2020 5265 6164 2074  ".        Read t
+0000d5c0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+0000d5d0: 2069 6e74 6f20 6120 6461 7461 6672 616d   into a datafram
+0000d5e0: 652e 0a0a 2020 2020 2020 2020 5265 6164  e...        Read
+0000d5f0: 7320 7468 6520 6665 6174 7572 6520 6772  s the feature gr
+0000d600: 6f75 7020 6279 2064 6566 6175 6c74 2066  oup by default f
+0000d610: 726f 6d20 7468 6520 6f66 666c 696e 6520  rom the offline 
+0000d620: 7374 6f72 6167 6520 6173 2053 7061 726b  storage as Spark
+0000d630: 2044 6174 6146 7261 6d65 0a20 2020 2020   DataFrame.     
+0000d640: 2020 206f 6e20 486f 7073 776f 726b 7320     on Hopsworks 
+0000d650: 616e 6420 4461 7461 6272 6963 6b73 2c20  and Databricks, 
+0000d660: 616e 6420 6173 2050 616e 6461 7320 6461  and as Pandas da
+0000d670: 7461 6672 616d 6520 6f6e 2041 5753 2053  taframe on AWS S
+0000d680: 6167 656d 616b 6572 2061 6e64 2070 7572  agemaker and pur
+0000d690: 650a 2020 2020 2020 2020 5079 7468 6f6e  e.        Python
+0000d6a0: 2065 6e76 6972 6f6e 6d65 6e74 732e 0a0a   environments...
+0000d6b0: 2020 2020 2020 2020 5365 7420 606f 6e6c          Set `onl
+0000d6c0: 696e 6560 2074 6f20 6054 7275 6560 2074  ine` to `True` t
+0000d6d0: 6f20 7265 6164 2066 726f 6d20 7468 6520  o read from the 
+0000d6e0: 6f6e 6c69 6e65 2073 746f 7261 6765 2c20  online storage, 
+0000d6f0: 6f72 2063 6861 6e67 650a 2020 2020 2020  or change.      
+0000d700: 2020 6064 6174 6166 7261 6d65 5f74 7970    `dataframe_typ
+0000d710: 6560 2074 6f20 7265 6164 2061 7320 6120  e` to read as a 
+0000d720: 6469 6666 6572 656e 7420 666f 726d 6174  different format
+0000d730: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+0000d740: 7861 6d70 6c65 2022 5265 6164 2066 6561  xample "Read fea
+0000d750: 7475 7265 2067 726f 7570 2061 7320 6f66  ture group as of
+0000d760: 206c 6174 6573 7420 7374 6174 653a 220a   latest state:".
+0000d770: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+0000d780: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
+0000d790: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
+0000d7a0: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
+0000d7b0: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
+0000d7c0: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
+0000d7d0: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
+0000d7e0: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
+0000d7f0: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
+0000d800: 6667 203d 2066 732e 6765 745f 6f72 5f63  fg = fs.get_or_c
+0000d810: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
+0000d820: 6f75 7028 2e2e 2e29 0a20 2020 2020 2020  oup(...).       
+0000d830: 2020 2020 2066 672e 7265 6164 2829 0a20       fg.read(). 
+0000d840: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+0000d850: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
+0000d860: 706c 6520 2252 6561 6420 6665 6174 7572  ple "Read featur
+0000d870: 6520 6772 6f75 7020 6173 206f 6620 7370  e group as of sp
+0000d880: 6563 6966 6963 2070 6f69 6e74 2069 6e20  ecific point in 
+0000d890: 7469 6d65 3a22 0a20 2020 2020 2020 2020  time:".         
+0000d8a0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+0000d8b0: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
+0000d8c0: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
+0000d8d0: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
+0000d8e0: 290a 2020 2020 2020 2020 2020 2020 6667  ).            fg
+0000d8f0: 2e72 6561 6428 2232 3032 302d 3130 2d32  .read("2020-10-2
+0000d900: 3020 3037 3a33 343a 3131 2229 0a20 2020  0 07:34:11").   
+0000d910: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
+0000d920: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+0000d930: 730a 2020 2020 2020 2020 2020 2020 7761  s.            wa
+0000d940: 6c6c 636c 6f63 6b5f 7469 6d65 3a20 4966  llclock_time: If
+0000d950: 2073 7065 6369 6669 6564 2077 696c 6c20   specified will 
+0000d960: 7265 7472 6965 7665 2066 6561 7475 7265  retrieve feature
+0000d970: 2067 726f 7570 2061 7320 6f66 2073 7065   group as of spe
+0000d980: 6369 6669 6320 706f 696e 7420 696e 2074  cific point in t
+0000d990: 696d 652e 2044 6566 6175 6c74 7320 746f  ime. Defaults to
+0000d9a0: 2060 4e6f 6e65 602e 0a20 2020 2020 2020   `None`..       
+0000d9b0: 2020 2020 2020 2020 2049 6620 6e6f 7420           If not 
+0000d9c0: 7370 6563 6966 6965 642c 2077 696c 6c20  specified, will 
+0000d9d0: 7265 7475 726e 2061 7320 6f66 206d 6f73  return as of mos
+0000d9e0: 7420 7265 6365 6e74 2074 696d 652e 0a20  t recent time.. 
+0000d9f0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+0000da00: 7472 696e 6773 2073 686f 756c 6420 6265  trings should be
+0000da10: 2066 6f72 6d61 7474 6564 2069 6e20 6f6e   formatted in on
+0000da20: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
+0000da30: 6e67 2066 6f72 6d61 7473 2060 2559 2d25  ng formats `%Y-%
+0000da40: 6d2d 2564 602c 2060 2559 2d25 6d2d 2564  m-%d`, `%Y-%m-%d
+0000da50: 2025 4860 2c20 6025 592d 256d 2d25 6420   %H`, `%Y-%m-%d 
+0000da60: 2548 3a25 4d60 2c20 6025 592d 256d 2d25  %H:%M`, `%Y-%m-%
+0000da70: 6420 2548 3a25 4d3a 2553 602c 0a20 2020  d %H:%M:%S`,.   
+0000da80: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+0000da90: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
+0000daa0: 2553 2e25 6660 2e0a 2020 2020 2020 2020  %S.%f`..        
+0000dab0: 2020 2020 6f6e 6c69 6e65 3a20 626f 6f6c      online: bool
+0000dac0: 2c20 6f70 7469 6f6e 616c 2e20 4966 2060  , optional. If `
+0000dad0: 5472 7565 6020 7265 6164 2066 726f 6d20  True` read from 
+0000dae0: 6f6e 6c69 6e65 2066 6561 7475 7265 2073  online feature s
+0000daf0: 746f 7265 2c20 6465 6661 756c 7473 0a20  tore, defaults. 
+0000db00: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0000db10: 6f20 6046 616c 7365 602e 0a20 2020 2020  o `False`..     
+0000db20: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
+0000db30: 5f74 7970 653a 2073 7472 2c20 6f70 7469  _type: str, opti
+0000db40: 6f6e 616c 2e20 506f 7373 6962 6c65 2076  onal. Possible v
+0000db50: 616c 7565 7320 6172 6520 6022 6465 6661  alues are `"defa
+0000db60: 756c 7422 602c 2060 2273 7061 726b 2260  ult"`, `"spark"`
+0000db70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000db80: 2020 6022 7061 6e64 6173 2260 2c20 6022    `"pandas"`, `"
+0000db90: 6e75 6d70 7922 6020 6f72 2060 2270 7974  numpy"` or `"pyt
+0000dba0: 686f 6e22 602c 2064 6566 6175 6c74 7320  hon"`, defaults 
+0000dbb0: 746f 2060 2264 6566 6175 6c74 2260 2e0a  to `"default"`..
+0000dbc0: 2020 2020 2020 2020 2020 2020 7265 6164              read
+0000dbd0: 5f6f 7074 696f 6e73 3a20 4164 6469 7469  _options: Additi
+0000dbe0: 6f6e 616c 206f 7074 696f 6e73 2061 7320  onal options as 
+0000dbf0: 6b65 792f 7661 6c75 6520 7061 6972 7320  key/value pairs 
+0000dc00: 746f 2070 6173 7320 746f 2074 6865 2065  to pass to the e
+0000dc10: 7865 6375 7469 6f6e 2065 6e67 696e 652e  xecution engine.
+0000dc20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dc30: 2046 6f72 2073 7061 726b 2065 6e67 696e   For spark engin
+0000dc40: 653a 2044 6963 7469 6f6e 6172 7920 6f66  e: Dictionary of
+0000dc50: 2072 6561 6420 6f70 7469 6f6e 7320 666f   read options fo
+0000dc60: 7220 5370 6172 6b2e 0a20 2020 2020 2020  r Spark..       
+0000dc70: 2020 2020 2020 2020 2046 6f72 2070 7974           For pyt
+0000dc80: 686f 6e20 656e 6769 6e65 3a0a 2020 2020  hon engine:.    
+0000dc90: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
+0000dca0: 7920 6022 6869 7665 5f63 6f6e 6669 6722  y `"hive_config"
+0000dcb0: 6020 746f 2070 6173 7320 6120 6469 6374  ` to pass a dict
+0000dcc0: 696f 6e61 7279 206f 6620 6869 7665 206f  ionary of hive o
+0000dcd0: 7220 7465 7a20 636f 6e66 6967 7572 6174  r tez configurat
+0000dce0: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0000dcf0: 2020 2020 2020 2020 466f 7220 6578 616d          For exam
+0000dd00: 706c 653a 2060 7b22 6869 7665 5f63 6f6e  ple: `{"hive_con
+0000dd10: 6669 6722 3a20 7b22 6869 7665 2e74 657a  fig": {"hive.tez
+0000dd20: 2e63 7075 2e76 636f 7265 7322 3a20 322c  .cpu.vcores": 2,
+0000dd30: 2022 7465 7a2e 6772 6f75 7069 6e67 2e73   "tez.grouping.s
+0000dd40: 706c 6974 2d63 6f75 6e74 223a 2022 3322  plit-count": "3"
+0000dd50: 7d7d 600a 2020 2020 2020 2020 2020 2020  }}`.            
+0000dd60: 2020 2020 2a20 6b65 7920 6022 7061 6e64      * key `"pand
+0000dd70: 6173 5f74 7970 6573 2260 2061 6e64 2076  as_types"` and v
+0000dd80: 616c 7565 2060 5472 7565 6020 746f 2072  alue `True` to r
+0000dd90: 6574 7269 6576 6520 636f 6c75 6d6e 7320  etrieve columns 
+0000dda0: 6173 2050 616e 6461 7320 6e75 6c6c 6162  as Pandas nullab
+0000ddb0: 6c65 2074 7970 6573 0a20 2020 2020 2020  le types.       
+0000ddc0: 2020 2020 2020 2020 2020 2072 6174 6865             rathe
+0000ddd0: 7220 7468 616e 206e 756d 7079 2f6f 626a  r than numpy/obj
+0000dde0: 6563 7428 7374 7269 6e67 2920 7479 7065  ect(string) type
+0000ddf0: 7320 2865 7870 6572 696d 656e 7461 6c29  s (experimental)
+0000de00: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000de10: 2020 2020 2873 6565 2068 7474 7073 3a2f      (see https:/
+0000de20: 2f70 616e 6461 732e 7079 6461 7461 2e6f  /pandas.pydata.o
+0000de30: 7267 2f64 6f63 732f 7573 6572 5f67 7569  rg/docs/user_gui
+0000de40: 6465 2f69 6e74 6567 6572 5f6e 612e 6874  de/integer_na.ht
+0000de50: 6d6c 292e 0a20 2020 2020 2020 2020 2020  ml)..           
+0000de60: 2020 2020 2044 6566 6175 6c74 7320 746f       Defaults to
+0000de70: 2060 7b7d 602e 0a0a 2020 2020 2020 2020   `{}`...        
+0000de80: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
+0000de90: 2020 2020 2020 6044 6174 6146 7261 6d65        `DataFrame
+0000dea0: 603a 2054 6865 2073 7061 726b 2064 6174  `: The spark dat
+0000deb0: 6166 7261 6d65 2063 6f6e 7461 696e 696e  aframe containin
+0000dec0: 6720 7468 6520 6665 6174 7572 6520 6461  g the feature da
+0000ded0: 7461 2e0a 2020 2020 2020 2020 2020 2020  ta..            
+0000dee0: 6070 7973 7061 726b 2e44 6174 6146 7261  `pyspark.DataFra
+0000def0: 6d65 602e 2041 2053 7061 726b 2044 6174  me`. A Spark Dat
+0000df00: 6146 7261 6d65 2e0a 2020 2020 2020 2020  aFrame..        
+0000df10: 2020 2020 6070 616e 6461 732e 4461 7461      `pandas.Data
+0000df20: 4672 616d 6560 2e20 4120 5061 6e64 6173  Frame`. A Pandas
+0000df30: 2044 6174 6146 7261 6d65 2e0a 2020 2020   DataFrame..    
+0000df40: 2020 2020 2020 2020 606e 756d 7079 2e6e          `numpy.n
+0000df50: 6461 7272 6179 602e 2041 2074 776f 2d64  darray`. A two-d
+0000df60: 696d 656e 7369 6f6e 616c 204e 756d 7079  imensional Numpy
+0000df70: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
+0000df80: 2020 2020 606c 6973 7460 2e20 4120 7477      `list`. A tw
+0000df90: 6f2d 6469 6d65 6e73 696f 6e61 6c20 5079  o-dimensional Py
+0000dfa0: 7468 6f6e 206c 6973 742e 0a0a 2020 2020  thon list...    
+0000dfb0: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+0000dfc0: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+0000dfd0: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+0000dfe0: 2e52 6573 7441 5049 4572 726f 7260 2e20  .RestAPIError`. 
+0000dff0: 4e6f 2064 6174 6120 6973 2061 7661 696c  No data is avail
+0000e000: 6162 6c65 2066 6f72 2066 6561 7475 7265  able for feature
+0000e010: 2067 726f 7570 2077 6974 6820 7468 6973   group with this
+0000e020: 2063 6f6d 6d69 7420 6461 7465 2c20 4966   commit date, If
+0000e030: 2074 696d 6520 7472 6176 656c 2065 6e61   time travel ena
+0000e040: 626c 6564 2e0a 2020 2020 2020 2020 2222  bled..        ""
+0000e050: 220a 2020 2020 2020 2020 656e 6769 6e65  ".        engine
+0000e060: 2e67 6574 5f69 6e73 7461 6e63 6528 292e  .get_instance().
+0000e070: 7365 745f 6a6f 625f 6772 6f75 7028 0a20  set_job_group(. 
+0000e080: 2020 2020 2020 2020 2020 2022 4665 7463             "Fetc
+0000e090: 6869 6e67 2046 6561 7475 7265 2067 726f  hing Feature gro
+0000e0a0: 7570 222c 0a20 2020 2020 2020 2020 2020  up",.           
+0000e0b0: 2022 4765 7474 696e 6720 6665 6174 7572   "Getting featur
+0000e0c0: 6520 6772 6f75 703a 207b 7d20 6672 6f6d  e group: {} from
+0000e0d0: 2074 6865 2066 6561 7475 7265 7374 6f72   the featurestor
+0000e0e0: 6520 7b7d 222e 666f 726d 6174 280a 2020  e {}".format(.  
+0000e0f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000e100: 6c66 2e5f 6e61 6d65 2c20 7365 6c66 2e5f  lf._name, self._
+0000e110: 6665 6174 7572 655f 7374 6f72 655f 6e61  feature_store_na
+0000e120: 6d65 0a20 2020 2020 2020 2020 2020 2029  me.            )
+0000e130: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000e140: 2020 2020 6966 2077 616c 6c63 6c6f 636b      if wallclock
+0000e150: 5f74 696d 653a 0a20 2020 2020 2020 2020  _time:.         
+0000e160: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
+0000e170: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e180: 2e73 656c 6563 745f 616c 6c28 290a 2020  .select_all().  
+0000e190: 2020 2020 2020 2020 2020 2020 2020 2e61                .a
+0000e1a0: 735f 6f66 2877 616c 6c63 6c6f 636b 5f74  s_of(wallclock_t
+0000e1b0: 696d 6529 0a20 2020 2020 2020 2020 2020  ime).           
+0000e1c0: 2020 2020 202e 7265 6164 280a 2020 2020       .read(.    
+0000e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1e0: 6f6e 6c69 6e65 2c0a 2020 2020 2020 2020  online,.        
+0000e1f0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0000e200: 6672 616d 655f 7479 7065 2c0a 2020 2020  frame_type,.    
+0000e210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e220: 7265 6164 5f6f 7074 696f 6e73 2c0a 2020  read_options,.  
+0000e230: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0000e240: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000e250: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000e260: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000e270: 656c 662e 7365 6c65 6374 5f61 6c6c 2829  elf.select_all()
+0000e280: 2e72 6561 6428 0a20 2020 2020 2020 2020  .read(.         
+0000e290: 2020 2020 2020 206f 6e6c 696e 652c 0a20         online,. 
+0000e2a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000e2b0: 6174 6166 7261 6d65 5f74 7970 652c 0a20  ataframe_type,. 
+0000e2c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000e2d0: 6561 645f 6f70 7469 6f6e 732c 0a20 2020  ead_options,.   
+0000e2e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000e2f0: 6465 6620 7265 6164 5f63 6861 6e67 6573  def read_changes
+0000e300: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000e310: 2020 2020 2020 2020 7374 6172 745f 7761          start_wa
+0000e320: 6c6c 636c 6f63 6b5f 7469 6d65 3a20 556e  llclock_time: Un
+0000e330: 696f 6e5b 7374 722c 2069 6e74 2c20 6461  ion[str, int, da
+0000e340: 7465 7469 6d65 2c20 6461 7465 5d2c 0a20  tetime, date],. 
+0000e350: 2020 2020 2020 2065 6e64 5f77 616c 6c63         end_wallc
+0000e360: 6c6f 636b 5f74 696d 653a 2055 6e69 6f6e  lock_time: Union
+0000e370: 5b73 7472 2c20 696e 742c 2064 6174 6574  [str, int, datet
+0000e380: 696d 652c 2064 6174 655d 2c0a 2020 2020  ime, date],.    
+0000e390: 2020 2020 7265 6164 5f6f 7074 696f 6e73      read_options
+0000e3a0: 3a20 4f70 7469 6f6e 616c 5b64 6963 745d  : Optional[dict]
+0000e3b0: 203d 207b 7d2c 0a20 2020 2029 3a0a 2020   = {},.    ):.  
+0000e3c0: 2020 2020 2020 2222 2252 6561 6473 2075        """Reads u
+0000e3d0: 7064 6174 6573 206f 6620 7468 6973 2066  pdates of this f
+0000e3e0: 6561 7475 7265 2074 6861 7420 6f63 6375  eature that occu
+0000e3f0: 7272 6564 2062 6574 7765 656e 2073 7065  rred between spe
+0000e400: 6369 6669 6564 2070 6f69 6e74 7320 696e  cified points in
+0000e410: 2074 696d 652e 0a0a 2020 2020 2020 2020   time...        
+0000e420: 2121 2120 7761 726e 696e 6720 2244 6570  !!! warning "Dep
+0000e430: 7265 6361 7465 6422 0a20 2020 2020 2020  recated".       
+0000e440: 2020 2020 2020 2020 2020 2020 2060 7265               `re
+0000e450: 6164 5f63 6861 6e67 6573 6020 6d65 7468  ad_changes` meth
+0000e460: 6f64 2069 7320 6465 7072 6563 6174 6564  od is deprecated
+0000e470: 2e20 5573 650a 2020 2020 2020 2020 2020  . Use.          
+0000e480: 2020 2020 2020 2020 2020 6061 735f 6f66            `as_of
+0000e490: 2865 6e64 5f77 616c 6c63 6c6f 636b 5f74  (end_wallclock_t
+0000e4a0: 696d 652c 2065 7863 6c75 6465 5f75 6e74  ime, exclude_unt
+0000e4b0: 696c 3d73 7461 7274 5f77 616c 6c63 6c6f  il=start_wallclo
+0000e4c0: 636b 5f74 696d 6529 2e72 6561 6428 7265  ck_time).read(re
+0000e4d0: 6164 5f6f 7074 696f 6e73 3d72 6561 645f  ad_options=read_
+0000e4e0: 6f70 7469 6f6e 7329 600a 2020 2020 2020  options)`.      
+0000e4f0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0000e500: 7374 6561 642e 0a0a 2020 2020 2020 2020  stead...        
+0000e510: 5468 6973 2066 756e 6374 696f 6e20 6f6e  This function on
+0000e520: 6c79 2077 6f72 6b73 206f 6e20 6665 6174  ly works on feat
+0000e530: 7572 6520 6772 6f75 7073 2077 6974 6820  ure groups with 
+0000e540: 6048 5544 4960 2074 696d 6520 7472 6176  `HUDI` time trav
+0000e550: 656c 2066 6f72 6d61 742e 0a0a 2020 2020  el format...    
+0000e560: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
+0000e570: 2020 2020 2020 2020 2020 2020 7374 6172              star
+0000e580: 745f 7761 6c6c 636c 6f63 6b5f 7469 6d65  t_wallclock_time
+0000e590: 3a20 5374 6172 7420 7469 6d65 206f 6620  : Start time of 
+0000e5a0: 7468 6520 7469 6d65 2074 7261 7665 6c20  the time travel 
+0000e5b0: 7175 6572 792e 2053 7472 696e 6773 2073  query. Strings s
+0000e5c0: 686f 756c 6420 6265 2066 6f72 6d61 7474  hould be formatt
+0000e5d0: 6564 2069 6e20 6f6e 6520 6f66 2074 6865  ed in one of the
+0000e5e0: 2066 6f6c 6c6f 7769 6e67 2066 6f72 6d61   following forma
+0000e5f0: 7473 2060 2559 2d25 6d2d 2564 602c 2060  ts `%Y-%m-%d`, `
+0000e600: 2559 2d25 6d2d 2564 2025 4860 2c20 6025  %Y-%m-%d %H`, `%
+0000e610: 592d 256d 2d25 6420 2548 3a25 4d60 2c0a  Y-%m-%d %H:%M`,.
+0000e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e630: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
+0000e640: 2553 602c 206f 7220 6025 592d 256d 2d25  %S`, or `%Y-%m-%
+0000e650: 6420 2548 3a25 4d3a 2553 2e25 6660 2e0a  d %H:%M:%S.%f`..
+0000e660: 2020 2020 2020 2020 2020 2020 656e 645f              end_
+0000e670: 7761 6c6c 636c 6f63 6b5f 7469 6d65 3a20  wallclock_time: 
+0000e680: 456e 6420 7469 6d65 206f 6620 7468 6520  End time of the 
+0000e690: 7469 6d65 2074 7261 7665 6c20 7175 6572  time travel quer
+0000e6a0: 792e 2053 7472 696e 6773 2073 686f 756c  y. Strings shoul
+0000e6b0: 6420 6265 2066 6f72 6d61 7474 6564 2069  d be formatted i
+0000e6c0: 6e20 6f6e 6520 6f66 2074 6865 2066 6f6c  n one of the fol
+0000e6d0: 6c6f 7769 6e67 2066 6f72 6d61 7473 2060  lowing formats `
+0000e6e0: 2559 2d25 6d2d 2564 602c 2060 2559 2d25  %Y-%m-%d`, `%Y-%
+0000e6f0: 6d2d 2564 2025 4860 2c20 6025 592d 256d  m-%d %H`, `%Y-%m
+0000e700: 2d25 6420 2548 3a25 4d60 2c0a 2020 2020  -%d %H:%M`,.    
+0000e710: 2020 2020 2020 2020 2020 2020 6025 592d              `%Y-
+0000e720: 256d 2d25 6420 2548 3a25 4d3a 2553 602c  %m-%d %H:%M:%S`,
+0000e730: 206f 7220 6025 592d 256d 2d25 6420 2548   or `%Y-%m-%d %H
+0000e740: 3a25 4d3a 2553 2e25 6660 2e0a 2020 2020  :%M:%S.%f`..    
+0000e750: 2020 2020 2020 2020 7265 6164 5f6f 7074          read_opt
+0000e760: 696f 6e73 3a20 4164 6469 7469 6f6e 616c  ions: Additional
+0000e770: 206f 7074 696f 6e73 2061 7320 6b65 792f   options as key/
+0000e780: 7661 6c75 6520 7061 6972 7320 746f 2070  value pairs to p
+0000e790: 6173 7320 746f 2074 6865 2065 7865 6375  ass to the execu
+0000e7a0: 7469 6f6e 2065 6e67 696e 652e 0a20 2020  tion engine..   
+0000e7b0: 2020 2020 2020 2020 2020 2020 2046 6f72               For
+0000e7c0: 2073 7061 726b 2065 6e67 696e 653a 2044   spark engine: D
+0000e7d0: 6963 7469 6f6e 6172 7920 6f66 2072 6561  ictionary of rea
+0000e7e0: 6420 6f70 7469 6f6e 7320 666f 7220 5370  d options for Sp
+0000e7f0: 6172 6b2e 0a20 2020 2020 2020 2020 2020  ark..           
+0000e800: 2020 2020 2046 6f72 2070 7974 686f 6e20       For python 
+0000e810: 656e 6769 6e65 3a0a 2020 2020 2020 2020  engine:.        
+0000e820: 2020 2020 2020 2020 2a20 6b65 7920 6022          * key `"
+0000e830: 6869 7665 5f63 6f6e 6669 6722 6020 746f  hive_config"` to
+0000e840: 2070 6173 7320 6120 6469 6374 696f 6e61   pass a dictiona
+0000e850: 7279 206f 6620 6869 7665 206f 7220 7465  ry of hive or te
+0000e860: 7a20 636f 6e66 6967 7572 6174 696f 6e73  z configurations
+0000e870: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000e880: 2020 2020 466f 7220 6578 616d 706c 653a      For example:
+0000e890: 2060 7b22 6869 7665 5f63 6f6e 6669 6722   `{"hive_config"
+0000e8a0: 3a20 7b22 6869 7665 2e74 657a 2e63 7075  : {"hive.tez.cpu
+0000e8b0: 2e76 636f 7265 7322 3a20 322c 2022 7465  .vcores": 2, "te
+0000e8c0: 7a2e 6772 6f75 7069 6e67 2e73 706c 6974  z.grouping.split
+0000e8d0: 2d63 6f75 6e74 223a 2022 3322 7d7d 600a  -count": "3"}}`.
+0000e8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e8f0: 4465 6661 756c 7473 2074 6f20 607b 7d60  Defaults to `{}`
+0000e900: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
+0000e910: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
+0000e920: 2060 4461 7461 4672 616d 6560 2e20 5468   `DataFrame`. Th
+0000e930: 6520 7370 6172 6b20 6461 7461 6672 616d  e spark datafram
+0000e940: 6520 636f 6e74 6169 6e69 6e67 2074 6865  e containing the
+0000e950: 2069 6e63 7265 6d65 6e74 616c 2063 6861   incremental cha
+0000e960: 6e67 6573 206f 660a 2020 2020 2020 2020  nges of.        
+0000e970: 2020 2020 6665 6174 7572 6520 6461 7461      feature data
+0000e980: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
+0000e990: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+0000e9a0: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+0000e9b0: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+0000e9c0: 7272 6f72 602e 2020 4e6f 2064 6174 6120  rror`.  No data 
+0000e9d0: 6973 2061 7661 696c 6162 6c65 2066 6f72  is available for
+0000e9e0: 2066 6561 7475 7265 2067 726f 7570 2077   feature group w
+0000e9f0: 6974 6820 7468 6973 2063 6f6d 6d69 7420  ith this commit 
+0000ea00: 6461 7465 2e0a 2020 2020 2020 2020 2020  date..          
+0000ea10: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
+0000ea20: 7863 6570 7469 6f6e 732e 4665 6174 7572  xceptions.Featur
+0000ea30: 6553 746f 7265 4578 6365 7074 696f 6e60  eStoreException`
+0000ea40: 2e20 4966 2074 6865 2066 6561 7475 7265  . If the feature
+0000ea50: 2067 726f 7570 2064 6f65 7320 6e6f 7420   group does not 
+0000ea60: 6861 7665 2060 4855 4449 6020 7469 6d65  have `HUDI` time
+0000ea70: 2074 7261 7665 6c20 666f 726d 6174 0a20   travel format. 
+0000ea80: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000ea90: 2020 2072 6574 7572 6e20 280a 2020 2020     return (.    
+0000eaa0: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
+0000eab0: 6563 745f 616c 6c28 290a 2020 2020 2020  ect_all().      
+0000eac0: 2020 2020 2020 2e70 756c 6c5f 6368 616e        .pull_chan
+0000ead0: 6765 7328 7374 6172 745f 7761 6c6c 636c  ges(start_wallcl
+0000eae0: 6f63 6b5f 7469 6d65 2c20 656e 645f 7761  ock_time, end_wa
+0000eaf0: 6c6c 636c 6f63 6b5f 7469 6d65 290a 2020  llclock_time).  
+0000eb00: 2020 2020 2020 2020 2020 2e72 6561 6428            .read(
+0000eb10: 4661 6c73 652c 2022 6465 6661 756c 7422  False, "default"
+0000eb20: 2c20 7265 6164 5f6f 7074 696f 6e73 290a  , read_options).
+0000eb30: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0000eb40: 6566 2073 686f 7728 7365 6c66 2c20 6e3a  ef show(self, n:
+0000eb50: 2069 6e74 2c20 6f6e 6c69 6e65 3a20 4f70   int, online: Op
+0000eb60: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2046  tional[bool] = F
+0000eb70: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+0000eb80: 2222 5368 6f77 2074 6865 2066 6972 7374  ""Show the first
+0000eb90: 2060 6e60 2072 6f77 7320 6f66 2074 6865   `n` rows of the
+0000eba0: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
+0000ebb0: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+0000ebc0: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+0000ebd0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+0000ebe0: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+0000ebf0: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+0000ec00: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+0000ec10: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+0000ec20: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+0000ec30: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+0000ec40: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+0000ec50: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+0000ec60: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+0000ec70: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
+0000ec80: 2020 2020 2020 2020 2020 2023 206d 616b             # mak
+0000ec90: 6520 6120 7175 6572 7920 616e 6420 7368  e a query and sh
+0000eca0: 6f77 2074 6f70 2035 2072 6f77 730a 2020  ow top 5 rows.  
+0000ecb0: 2020 2020 2020 2020 2020 6667 2e73 656c            fg.sel
+0000ecc0: 6563 7428 5b27 6461 7465 272c 2777 6565  ect(['date','wee
+0000ecd0: 6b6c 795f 7361 6c65 7327 2c27 6973 5f68  kly_sales','is_h
+0000ece0: 6f6c 6964 6179 275d 292e 7368 6f77 2835  oliday']).show(5
+0000ecf0: 290a 2020 2020 2020 2020 2020 2020 6060  ).            ``
+0000ed00: 600a 0a20 2020 2020 2020 2023 2041 7267  `..        # Arg
+0000ed10: 756d 656e 7473 0a20 2020 2020 2020 2020  uments.         
+0000ed20: 2020 206e 3a20 696e 742e 204e 756d 6265     n: int. Numbe
+0000ed30: 7220 6f66 2072 6f77 7320 746f 2073 686f  r of rows to sho
+0000ed40: 772e 0a20 2020 2020 2020 2020 2020 206f  w..            o
+0000ed50: 6e6c 696e 653a 2062 6f6f 6c2c 206f 7074  nline: bool, opt
+0000ed60: 696f 6e61 6c2e 2049 6620 6054 7275 6560  ional. If `True`
+0000ed70: 2072 6561 6420 6672 6f6d 206f 6e6c 696e   read from onlin
+0000ed80: 6520 6665 6174 7572 6520 7374 6f72 652c  e feature store,
+0000ed90: 2064 6566 6175 6c74 730a 2020 2020 2020   defaults.      
+0000eda0: 2020 2020 2020 2020 2020 746f 2060 4661            to `Fa
+0000edb0: 6c73 6560 2e0a 2020 2020 2020 2020 2222  lse`..        ""
+0000edc0: 220a 2020 2020 2020 2020 656e 6769 6e65  ".        engine
+0000edd0: 2e67 6574 5f69 6e73 7461 6e63 6528 292e  .get_instance().
+0000ede0: 7365 745f 6a6f 625f 6772 6f75 7028 0a20  set_job_group(. 
+0000edf0: 2020 2020 2020 2020 2020 2022 4665 7463             "Fetc
+0000ee00: 6869 6e67 2046 6561 7475 7265 2067 726f  hing Feature gro
+0000ee10: 7570 222c 0a20 2020 2020 2020 2020 2020  up",.           
+0000ee20: 2022 4765 7474 696e 6720 6665 6174 7572   "Getting featur
+0000ee30: 6520 6772 6f75 703a 207b 7d20 6672 6f6d  e group: {} from
+0000ee40: 2074 6865 2066 6561 7475 7265 7374 6f72   the featurestor
+0000ee50: 6520 7b7d 222e 666f 726d 6174 280a 2020  e {}".format(.  
+0000ee60: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000ee70: 6c66 2e5f 6e61 6d65 2c20 7365 6c66 2e5f  lf._name, self._
+0000ee80: 6665 6174 7572 655f 7374 6f72 655f 6e61  feature_store_na
+0000ee90: 6d65 0a20 2020 2020 2020 2020 2020 2029  me.            )
+0000eea0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+0000eeb0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000eec0: 7365 6c65 6374 5f61 6c6c 2829 2e73 686f  select_all().sho
+0000eed0: 7728 6e2c 206f 6e6c 696e 6529 0a0a 2020  w(n, online)..  
+0000eee0: 2020 6465 6620 7361 7665 280a 2020 2020    def save(.    
+0000eef0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000ef00: 2020 6665 6174 7572 6573 3a20 556e 696f    features: Unio
+0000ef10: 6e5b 0a20 2020 2020 2020 2020 2020 2070  n[.            p
+0000ef20: 642e 4461 7461 4672 616d 652c 0a20 2020  d.DataFrame,.   
+0000ef30: 2020 2020 2020 2020 2054 7970 6556 6172           TypeVar
+0000ef40: 2822 7079 7370 6172 6b2e 7371 6c2e 4461  ("pyspark.sql.Da
+0000ef50: 7461 4672 616d 6522 292c 2020 2320 6e6f  taFrame"),  # no
+0000ef60: 7161 3a20 4638 3231 0a20 2020 2020 2020  qa: F821.       
+0000ef70: 2020 2020 2054 7970 6556 6172 2822 7079       TypeVar("py
+0000ef80: 7370 6172 6b2e 5244 4422 292c 2020 2320  spark.RDD"),  # 
+0000ef90: 6e6f 7161 3a20 4638 3231 0a20 2020 2020  noqa: F821.     
+0000efa0: 2020 2020 2020 206e 702e 6e64 6172 7261         np.ndarra
+0000efb0: 792c 0a20 2020 2020 2020 2020 2020 204c  y,.            L
+0000efc0: 6973 745b 6665 6174 7572 652e 4665 6174  ist[feature.Feat
+0000efd0: 7572 655d 2c0a 2020 2020 2020 2020 5d20  ure],.        ] 
+0000efe0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000eff0: 7772 6974 655f 6f70 7469 6f6e 733a 204f  write_options: O
+0000f000: 7074 696f 6e61 6c5b 4469 6374 5b41 6e79  ptional[Dict[Any
+0000f010: 2c20 416e 795d 5d20 3d20 7b7d 2c0a 2020  , Any]] = {},.  
+0000f020: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
+0000f030: 5f6f 7074 696f 6e73 3a20 4f70 7469 6f6e  _options: Option
+0000f040: 616c 5b44 6963 745b 416e 792c 2041 6e79  al[Dict[Any, Any
+0000f050: 5d5d 203d 207b 7d2c 0a20 2020 2020 2020  ]] = {},.       
+0000f060: 2077 6169 743a 2062 6f6f 6c20 3d20 4661   wait: bool = Fa
+0000f070: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
+0000f080: 2020 2020 2222 2250 6572 7369 7374 2074      """Persist t
+0000f090: 6865 206d 6574 6164 6174 6120 616e 6420  he metadata and 
+0000f0a0: 6d61 7465 7269 616c 697a 6520 7468 6520  materialize the 
+0000f0b0: 6665 6174 7572 6520 6772 6f75 7020 746f  feature group to
+0000f0c0: 2074 6865 2066 6561 7475 7265 2073 746f   the feature sto
+0000f0d0: 7265 2e0a 0a20 2020 2020 2020 2021 2121  re...        !!!
+0000f0e0: 2077 6172 6e69 6e67 2022 4368 616e 6765   warning "Change
+0000f0f0: 6420 696e 2033 2e33 2e30 220a 2020 2020  d in 3.3.0".    
+0000f100: 2020 2020 2020 2020 6069 6e73 6572 7460          `insert`
+0000f110: 2061 6e64 2060 7361 7665 6020 6d65 7468   and `save` meth
+0000f120: 6f64 7320 6172 6520 6e6f 7720 6173 796e  ods are now asyn
+0000f130: 6320 6279 2064 6566 6175 6c74 2069 6e20  c by default in 
+0000f140: 6e6f 6e2d 7370 6172 6b20 636c 6965 6e74  non-spark client
+0000f150: 732e 0a20 2020 2020 2020 2020 2020 2054  s..            T
+0000f160: 6f20 6163 6869 6576 6520 7468 6520 6f6c  o achieve the ol
+0000f170: 6420 6265 6861 7669 6f75 722c 2073 6574  d behaviour, set
+0000f180: 2060 7761 6974 6020 6172 6775 6d65 6e74   `wait` argument
+0000f190: 2074 6f20 6054 7275 6560 2e0a 0a20 2020   to `True`...   
+0000f1a0: 2020 2020 2043 616c 6c69 6e67 2060 7361       Calling `sa
+0000f1b0: 7665 6020 6372 6561 7465 7320 7468 6520  ve` creates the 
+0000f1c0: 6d65 7461 6461 7461 2066 6f72 2074 6865  metadata for the
+0000f1d0: 2066 6561 7475 7265 2067 726f 7570 2069   feature group i
+0000f1e0: 6e20 7468 6520 6665 6174 7572 6520 7374  n the feature st
+0000f1f0: 6f72 652e 0a20 2020 2020 2020 2049 6620  ore..        If 
+0000f200: 6120 4461 7461 4672 616d 652c 2052 4444  a DataFrame, RDD
+0000f210: 206f 7220 4e64 6172 7261 7920 6973 2070   or Ndarray is p
+0000f220: 726f 7669 6465 642c 2074 6865 2064 6174  rovided, the dat
+0000f230: 6120 6973 2077 7269 7474 656e 2074 6f20  a is written to 
+0000f240: 7468 650a 2020 2020 2020 2020 6f6e 6c69  the.        onli
+0000f250: 6e65 2f6f 6666 6c69 6e65 2066 6561 7475  ne/offline featu
+0000f260: 7265 2073 746f 7265 2061 7320 7370 6563  re store as spec
+0000f270: 6966 6965 642e 0a20 2020 2020 2020 2042  ified..        B
+0000f280: 7920 6465 6661 756c 742c 2074 6869 7320  y default, this 
+0000f290: 7772 6974 6573 2074 6865 2066 6561 7475  writes the featu
+0000f2a0: 7265 2067 726f 7570 2074 6f20 7468 6520  re group to the 
+0000f2b0: 6f66 666c 696e 6520 7374 6f72 6167 652c  offline storage,
+0000f2c0: 2061 6e64 2069 660a 2020 2020 2020 2020   and if.        
+0000f2d0: 606f 6e6c 696e 655f 656e 6162 6c65 6460  `online_enabled`
+0000f2e0: 2066 6f72 2074 6865 2066 6561 7475 7265   for the feature
+0000f2f0: 2067 726f 7570 2c20 616c 736f 2074 6f20   group, also to 
+0000f300: 7468 6520 6f6e 6c69 6e65 2066 6561 7475  the online featu
+0000f310: 7265 2073 746f 7265 2e0a 2020 2020 2020  re store..      
+0000f320: 2020 5468 6520 6066 6561 7475 7265 7360    The `features`
+0000f330: 2064 6174 6166 7261 6d65 2063 616e 2062   dataframe can b
+0000f340: 6520 6120 5370 6172 6b20 4461 7461 4672  e a Spark DataFr
+0000f350: 616d 6520 6f72 2052 4444 2c20 6120 5061  ame or RDD, a Pa
+0000f360: 6e64 6173 2044 6174 6146 7261 6d65 2c0a  ndas DataFrame,.
+0000f370: 2020 2020 2020 2020 6f72 2061 2074 776f          or a two
+0000f380: 2d64 696d 656e 7369 6f6e 616c 204e 756d  -dimensional Num
+0000f390: 7079 2061 7272 6179 206f 7220 6120 7477  py array or a tw
+0000f3a0: 6f2d 6469 6d65 6e73 696f 6e61 6c20 5079  o-dimensional Py
+0000f3b0: 7468 6f6e 206e 6573 7465 6420 6c69 7374  thon nested list
+0000f3c0: 2e0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
+0000f3d0: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
+0000f3e0: 2020 6665 6174 7572 6573 3a20 4461 7461    features: Data
+0000f3f0: 4672 616d 652c 2052 4444 2c20 4e64 6172  Frame, RDD, Ndar
+0000f400: 7261 7920 6f72 2061 206c 6973 7420 6f66  ray or a list of
+0000f410: 2066 6561 7475 7265 732e 2046 6561 7475   features. Featu
+0000f420: 7265 7320 746f 2062 6520 7361 7665 642e  res to be saved.
+0000f430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f440: 2054 6869 7320 6172 6775 6d65 6e74 2069   This argument i
+0000f450: 7320 6f70 7469 6f6e 616c 2069 6620 7468  s optional if th
+0000f460: 6520 6665 6174 7572 6520 6c69 7374 2069  e feature list i
+0000f470: 7320 7072 6f76 6964 6564 2069 6e20 7468  s provided in th
+0000f480: 6520 6372 6561 7465 5f66 6561 7475 7265  e create_feature
+0000f490: 5f67 726f 7570 206f 720a 2020 2020 2020  _group or.      
+0000f4a0: 2020 2020 2020 2020 2020 696e 2074 6865            in the
+0000f4b0: 2067 6574 5f6f 725f 6372 6561 7465 5f66   get_or_create_f
+0000f4c0: 6561 7475 7265 5f67 726f 7570 206d 6574  eature_group met
+0000f4d0: 686f 6420 696e 766f 6b61 7469 6f6e 2e0a  hod invokation..
+0000f4e0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+0000f4f0: 655f 6f70 7469 6f6e 733a 2041 6464 6974  e_options: Addit
+0000f500: 696f 6e61 6c20 7772 6974 6520 6f70 7469  ional write opti
+0000f510: 6f6e 7320 6173 206b 6579 2d76 616c 7565  ons as key-value
+0000f520: 2070 6169 7273 2c20 6465 6661 756c 7473   pairs, defaults
+0000f530: 2074 6f20 607b 7d60 2e0a 2020 2020 2020   to `{}`..      
+0000f540: 2020 2020 2020 2020 2020 5768 656e 2075            When u
+0000f550: 7369 6e67 2074 6865 2060 7079 7468 6f6e  sing the `python
+0000f560: 6020 656e 6769 6e65 2c20 7772 6974 655f  ` engine, write_
+0000f570: 6f70 7469 6f6e 7320 6361 6e20 636f 6e74  options can cont
+0000f580: 6169 6e20 7468 650a 2020 2020 2020 2020  ain the.        
+0000f590: 2020 2020 2020 2020 666f 6c6c 6f77 696e          followin
+0000f5a0: 6720 656e 7472 6965 733a 0a20 2020 2020  g entries:.     
+0000f5b0: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+0000f5c0: 2060 7370 6172 6b60 2061 6e64 2076 616c   `spark` and val
+0000f5d0: 7565 2061 6e20 6f62 6a65 6374 206f 6620  ue an object of 
+0000f5e0: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
+0000f5f0: 2020 2020 205b 6873 6673 2e63 6f72 652e       [hsfs.core.
+0000f600: 6a6f 625f 636f 6e66 6967 7572 6174 696f  job_configuratio
+0000f610: 6e2e 4a6f 6243 6f6e 6669 6775 7261 7469  n.JobConfigurati
+0000f620: 6f6e 5d28 2e2e 2f6a 6f62 5f63 6f6e 6669  on](../job_confi
+0000f630: 6775 7261 7469 6f6e 290a 2020 2020 2020  guration).      
+0000f640: 2020 2020 2020 2020 2020 2020 746f 2063              to c
+0000f650: 6f6e 6669 6775 7265 2074 6865 2048 6f70  onfigure the Hop
+0000f660: 7377 6f72 6b73 204a 6f62 2075 7365 6420  sworks Job used 
+0000f670: 746f 2077 7269 7465 2064 6174 6120 696e  to write data in
+0000f680: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
+0000f690: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+0000f6a0: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
+0000f6b0: 2020 2020 2020 2020 2a20 6b65 7920 6077          * key `w
+0000f6c0: 6169 745f 666f 725f 6a6f 6260 2061 6e64  ait_for_job` and
+0000f6d0: 2076 616c 7565 2060 5472 7565 6020 6f72   value `True` or
+0000f6e0: 2060 4661 6c73 6560 2074 6f20 636f 6e66   `False` to conf
+0000f6f0: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
+0000f700: 2020 2020 2020 2020 7768 6574 6865 7220          whether 
+0000f710: 6f72 206e 6f74 2074 6f20 7468 6520 7361  or not to the sa
+0000f720: 7665 2063 616c 6c20 7368 6f75 6c64 2072  ve call should r
+0000f730: 6574 7572 6e20 6f6e 6c79 0a20 2020 2020  eturn only.     
+0000f740: 2020 2020 2020 2020 2020 2020 2061 6674               aft
+0000f750: 6572 2074 6865 2048 6f70 7377 6f72 6b73  er the Hopsworks
+0000f760: 204a 6f62 2068 6173 2066 696e 6973 6865   Job has finishe
+0000f770: 642e 2042 7920 6465 6661 756c 7420 6974  d. By default it
+0000f780: 2064 6f65 7320 6e6f 7420 7761 6974 2e0a   does not wait..
+0000f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f7a0: 2a20 6b65 7920 6073 7461 7274 5f6f 6666  * key `start_off
+0000f7b0: 6c69 6e65 5f62 6163 6b66 696c 6c60 2061  line_backfill` a
+0000f7c0: 6e64 2076 616c 7565 2060 5472 7565 6020  nd value `True` 
+0000f7d0: 6f72 2060 4661 6c73 6560 2074 6f20 636f  or `False` to co
+0000f7e0: 6e66 6967 7572 650a 2020 2020 2020 2020  nfigure.        
+0000f7f0: 2020 2020 2020 2020 2020 7768 6574 6865            whethe
+0000f800: 7220 6f72 206e 6f74 2074 6f20 7374 6172  r or not to star
+0000f810: 7420 7468 6520 6261 636b 6669 6c6c 206a  t the backfill j
+0000f820: 6f62 2074 6f20 7772 6974 6520 6461 7461  ob to write data
+0000f830: 2074 6f20 7468 6520 6f66 666c 696e 650a   to the offline.
+0000f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f850: 2020 7374 6f72 6167 652e 2042 7920 6465    storage. By de
+0000f860: 6661 756c 7420 7468 6520 6261 636b 6669  fault the backfi
+0000f870: 6c6c 206a 6f62 2067 6574 7320 7374 6172  ll job gets star
+0000f880: 7465 6420 696d 6d65 6469 6174 656c 792e  ted immediately.
+0000f890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f8a0: 202a 206b 6579 2060 696e 7465 726e 616c   * key `internal
+0000f8b0: 5f6b 6166 6b61 6020 616e 6420 7661 6c75  _kafka` and valu
+0000f8c0: 6520 6054 7275 6560 206f 7220 6046 616c  e `True` or `Fal
+0000f8d0: 7365 6020 696e 2063 6173 6520 796f 7520  se` in case you 
+0000f8e0: 6573 7461 626c 6973 6865 640a 2020 2020  established.    
+0000f8f0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0000f900: 6e6e 6563 7469 7669 7479 2066 726f 6d20  nnectivity from 
+0000f910: 796f 7520 5079 7468 6f6e 2065 6e76 6972  you Python envir
+0000f920: 6f6e 6d65 6e74 2074 6f20 7468 6520 696e  onment to the in
+0000f930: 7465 726e 616c 2061 6476 6572 7469 7365  ternal advertise
+0000f940: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000f950: 2020 2020 6c69 7374 656e 6572 7320 6f66      listeners of
+0000f960: 2074 6865 2048 6f70 7377 6f72 6b73 204b   the Hopsworks K
+0000f970: 6166 6b61 2043 6c75 7374 6572 2e20 4465  afka Cluster. De
+0000f980: 6661 756c 7473 2074 6f20 6046 616c 7365  faults to `False
+0000f990: 6020 616e 640a 2020 2020 2020 2020 2020  ` and.          
+0000f9a0: 2020 2020 2020 2020 7769 6c6c 2075 7365          will use
+0000f9b0: 2065 7874 6572 6e61 6c20 6c69 7374 656e   external listen
+0000f9c0: 6572 7320 7768 656e 2063 6f6e 6e65 6374  ers when connect
+0000f9d0: 696e 6720 6672 6f6d 206f 7574 7369 6465  ing from outside
+0000f9e0: 206f 6620 486f 7073 776f 726b 732e 0a20   of Hopsworks.. 
+0000f9f0: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+0000fa00: 6174 696f 6e5f 6f70 7469 6f6e 733a 2041  ation_options: A
+0000fa10: 6464 6974 696f 6e61 6c20 7661 6c69 6461  dditional valida
+0000fa20: 7469 6f6e 206f 7074 696f 6e73 2061 7320  tion options as 
+0000fa30: 6b65 792d 7661 6c75 6520 7061 6972 732c  key-value pairs,
+0000fa40: 2064 6566 6175 6c74 7320 746f 2060 7b7d   defaults to `{}
+0000fa50: 602e 0a20 2020 2020 2020 2020 2020 2020  `..             
+0000fa60: 2020 202a 206b 6579 2060 7275 6e5f 7661     * key `run_va
+0000fa70: 6c69 6461 7469 6f6e 6020 626f 6f6c 6561  lidation` boolea
+0000fa80: 6e20 7661 6c75 652c 2073 6574 2074 6f20  n value, set to 
+0000fa90: 6046 616c 7365 6020 746f 2073 6b69 7020  `False` to skip 
+0000faa0: 7661 6c69 6461 7469 6f6e 2074 656d 706f  validation tempo
+0000fab0: 7261 7269 6c79 206f 6e20 696e 6765 7374  rarily on ingest
+0000fac0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+0000fad0: 2020 2020 202a 206b 6579 2060 7361 7665       * key `save
+0000fae0: 5f72 6570 6f72 7460 2062 6f6f 6c65 616e  _report` boolean
+0000faf0: 2076 616c 7565 2c20 7365 7420 746f 2060   value, set to `
+0000fb00: 4661 6c73 6560 2074 6f20 736b 6970 2075  False` to skip u
+0000fb10: 706c 6f61 6420 6f66 2074 6865 2076 616c  pload of the val
+0000fb20: 6964 6174 696f 6e20 7265 706f 7274 2074  idation report t
+0000fb30: 6f20 486f 7073 776f 726b 732e 0a20 2020  o Hopsworks..   
+0000fb40: 2020 2020 2020 2020 2020 2020 202a 206b               * k
+0000fb50: 6579 2060 6765 5f76 616c 6964 6174 655f  ey `ge_validate_
+0000fb60: 6b77 6172 6773 6020 6120 6469 6374 696f  kwargs` a dictio
+0000fb70: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
+0000fb80: 6b77 6172 6773 2066 6f72 2074 6865 2076  kwargs for the v
+0000fb90: 616c 6964 6174 6520 6d65 7468 6f64 206f  alidate method o
+0000fba0: 6620 4772 6561 7420 4578 7065 6374 6174  f Great Expectat
+0000fbb0: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0000fbc0: 2020 7761 6974 3a20 5761 6974 2066 6f72    wait: Wait for
+0000fbd0: 206a 6f62 2074 6f20 6669 6e69 7368 2062   job to finish b
+0000fbe0: 6566 6f72 6520 7265 7475 726e 696e 672c  efore returning,
+0000fbf0: 2064 6566 6175 6c74 7320 746f 2060 4661   defaults to `Fa
+0000fc00: 6c73 6560 2e0a 2020 2020 2020 2020 2020  lse`..          
+0000fc10: 2020 2020 2020 5368 6f72 7463 7574 2066        Shortcut f
+0000fc20: 6f72 2072 6561 645f 6f70 7469 6f6e 7320  or read_options 
+0000fc30: 607b 2277 6169 745f 666f 725f 6a6f 6222  `{"wait_for_job"
+0000fc40: 3a20 4661 6c73 657d 602e 0a0a 2020 2020  : False}`...    
+0000fc50: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
+0000fc60: 2020 2020 2020 2020 2020 604a 6f62 603a            `Job`:
+0000fc70: 2057 6865 6e20 7573 696e 6720 7468 6520   When using the 
+0000fc80: 6070 7974 686f 6e60 2065 6e67 696e 652c  `python` engine,
+0000fc90: 2069 7420 7265 7475 726e 7320 7468 6520   it returns the 
+0000fca0: 486f 7073 776f 726b 7320 4a6f 620a 2020  Hopsworks Job.  
+0000fcb0: 2020 2020 2020 2020 2020 2020 2020 7468                th
+0000fcc0: 6174 2077 6173 206c 6175 6e63 6865 6420  at was launched 
+0000fcd0: 746f 2069 6e67 6573 7420 7468 6520 6665  to ingest the fe
+0000fce0: 6174 7572 6520 6772 6f75 7020 6461 7461  ature group data
+0000fcf0: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
+0000fd00: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+0000fd10: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+0000fd20: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+0000fd30: 7272 6f72 602e 2055 6e61 626c 6520 746f  rror`. Unable to
+0000fd40: 2063 7265 6174 6520 6665 6174 7572 6520   create feature 
+0000fd50: 6772 6f75 702e 0a20 2020 2020 2020 2022  group..        "
+0000fd60: 2222 0a20 2020 2020 2020 2069 6620 2866  "".        if (f
+0000fd70: 6561 7475 7265 7320 6973 204e 6f6e 6520  eatures is None 
+0000fd80: 616e 6420 6c65 6e28 7365 6c66 2e5f 6665  and len(self._fe
+0000fd90: 6174 7572 6573 2920 3e20 3029 206f 7220  atures) > 0) or 
+0000fda0: 280a 2020 2020 2020 2020 2020 2020 6973  (.            is
+0000fdb0: 696e 7374 616e 6365 2866 6561 7475 7265  instance(feature
+0000fdc0: 732c 204c 6973 7429 0a20 2020 2020 2020  s, List).       
+0000fdd0: 2020 2020 2061 6e64 206c 656e 2866 6561       and len(fea
+0000fde0: 7475 7265 7329 203e 2030 0a20 2020 2020  tures) > 0.     
+0000fdf0: 2020 2020 2020 2061 6e64 2061 6c6c 285b         and all([
+0000fe00: 6973 696e 7374 616e 6365 2866 2c20 6665  isinstance(f, fe
+0000fe10: 6174 7572 652e 4665 6174 7572 6529 2066  ature.Feature) f
+0000fe20: 6f72 2066 2069 6e20 6665 6174 7572 6573  or f in features
+0000fe30: 5d29 0a20 2020 2020 2020 2029 3a0a 2020  ]).        ):.  
+0000fe40: 2020 2020 2020 2020 2020 2320 5468 6973            # This
+0000fe50: 2069 7320 646f 6e65 2066 6f72 2063 6f6d   is done for com
+0000fe60: 7061 7469 6269 6c69 7479 2e20 5573 6572  patibility. User
+0000fe70: 7320 6361 6e20 7370 6563 6966 7920 7468  s can specify th
+0000fe80: 6520 6665 6174 7572 6520 6c69 7374 2069  e feature list i
+0000fe90: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
+0000fea0: 2020 2320 2867 6574 5f6f 725f 2963 7265    # (get_or_)cre
+0000feb0: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
+0000fec0: 702e 2055 7365 7273 2063 616e 2061 6c73  p. Users can als
+0000fed0: 6f20 7072 6f76 6964 6520 7468 6520 6665  o provide the fe
+0000fee0: 6174 7572 6520 6c69 7374 2069 6e20 7468  ature list in th
+0000fef0: 6520 7361 7665 2829 2e0a 2020 2020 2020  e save()..      
+0000ff00: 2020 2020 2020 2320 5468 6f75 6768 2069        # Though i
+0000ff10: 7427 7320 616e 206f 7074 696f 6e61 6c20  t's an optional 
+0000ff20: 7061 7261 6d65 7465 722e 0a20 2020 2020  parameter..     
+0000ff30: 2020 2020 2020 2023 2046 6f72 2063 6f6e         # For con
+0000ff40: 7369 7374 656e 6379 2072 6561 736f 6e73  sistency reasons
+0000ff50: 2069 6620 7468 6520 7573 6572 2073 7065   if the user spe
+0000ff60: 6369 6679 2062 6f74 6820 7468 6520 6665  cify both the fe
+0000ff70: 6174 7572 6520 6c69 7374 2069 6e20 7468  ature list in th
+0000ff80: 6520 2867 6574 5f6f 725f 2963 7265 6174  e (get_or_)creat
+0000ff90: 655f 6665 6174 7572 655f 6772 6f75 700a  e_feature_group.
+0000ffa0: 2020 2020 2020 2020 2020 2020 2320 616e              # an
+0000ffb0: 6420 696e 2074 6865 2060 7361 7665 2829  d in the `save()
+0000ffc0: 6020 6361 6c6c 2c20 7468 656e 2074 6865  ` call, then the
+0000ffd0: 2028 6765 745f 6f72 5f29 6372 6561 7465   (get_or_)create
+0000ffe0: 5f66 6561 7475 7265 5f67 726f 7570 2077  _feature_group w
+0000fff0: 696e 732e 0a20 2020 2020 2020 2020 2020  ins..           
+00010000: 2023 2054 6869 7320 6973 2063 6f6e 7369   # This is consi
+00010010: 7374 656e 7420 7769 7468 2074 6865 2062  stent with the b
+00010020: 6568 6176 696f 7220 6f66 2074 6865 2069  ehavior of the i
+00010030: 6e73 6572 7420 6d65 7468 6f64 2077 6865  nsert method whe
+00010040: 7265 2074 6865 2066 6561 7475 7265 206c  re the feature l
+00010050: 6973 7420 7769 6e73 206f 7665 7220 7468  ist wins over th
+00010060: 650a 2020 2020 2020 2020 2020 2020 2320  e.            # 
+00010070: 6461 7461 6672 616d 6520 7374 7275 6374  dataframe struct
+00010080: 7572 650a 2020 2020 2020 2020 2020 2020  ure.            
+00010090: 7365 6c66 2e5f 6665 6174 7572 6573 203d  self._features =
+000100a0: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
+000100b0: 6966 206c 656e 2873 656c 662e 5f66 6561  if len(self._fea
+000100c0: 7475 7265 7329 203e 2030 2065 6c73 6520  tures) > 0 else 
+000100d0: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
+000100e0: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
+000100f0: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
+00010100: 7361 7665 5f66 6561 7475 7265 5f67 726f  save_feature_gro
+00010110: 7570 5f6d 6574 6164 6174 6128 0a20 2020  up_metadata(.   
+00010120: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00010130: 662c 204e 6f6e 652c 2077 7269 7465 5f6f  f, None, write_o
+00010140: 7074 696f 6e73 0a20 2020 2020 2020 2020  ptions.         
+00010150: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+00010160: 2020 7265 7475 726e 204e 6f6e 652c 204e    return None, N
+00010170: 6f6e 650a 0a20 2020 2020 2020 2069 6620  one..        if 
+00010180: 6665 6174 7572 6573 2069 7320 4e6f 6e65  features is None
+00010190: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000101a0: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
+000101b0: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
+000101c0: 2020 2020 2020 2020 2020 2022 4665 6174             "Feat
+000101d0: 7572 6520 6c69 7374 206e 6f74 2070 726f  ure list not pro
+000101e0: 7669 6465 6420 696e 2074 6865 2063 7265  vided in the cre
+000101f0: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
+00010200: 7020 6f72 2067 6574 5f6f 725f 6372 6561  p or get_or_crea
+00010210: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+00010220: 2069 6e76 6f6b 6174 696f 6e73 2e22 0a20   invokations.". 
+00010230: 2020 2020 2020 2020 2020 2020 2020 202b                 +
+00010240: 2022 2050 6c65 6173 6520 7072 6f76 6964   " Please provid
+00010250: 6520 6120 6c69 7374 206f 6620 6665 6174  e a list of feat
+00010260: 7572 6573 206f 7220 6120 4461 7461 6672  ures or a Datafr
+00010270: 616d 6522 0a20 2020 2020 2020 2020 2020  ame".           
+00010280: 2029 0a0a 2020 2020 2020 2020 6665 6174   )..        feat
+00010290: 7572 655f 6461 7461 6672 616d 6520 3d20  ure_dataframe = 
+000102a0: 656e 6769 6e65 2e67 6574 5f69 6e73 7461  engine.get_insta
+000102b0: 6e63 6528 292e 636f 6e76 6572 745f 746f  nce().convert_to
+000102c0: 5f64 6566 6175 6c74 5f64 6174 6166 7261  _default_datafra
+000102d0: 6d65 2866 6561 7475 7265 7329 0a0a 2020  me(features)..  
+000102e0: 2020 2020 2020 7573 6572 5f76 6572 7369        user_versi
+000102f0: 6f6e 203d 2073 656c 662e 5f76 6572 7369  on = self._versi
+00010300: 6f6e 0a0a 2020 2020 2020 2020 6966 2077  on..        if w
+00010310: 7269 7465 5f6f 7074 696f 6e73 2069 7320  rite_options is 
+00010320: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00010330: 2020 7772 6974 655f 6f70 7469 6f6e 7320    write_options 
+00010340: 3d20 7b7d 0a20 2020 2020 2020 2069 6620  = {}.        if 
+00010350: 2277 6169 745f 666f 725f 6a6f 6222 206e  "wait_for_job" n
+00010360: 6f74 2069 6e20 7772 6974 655f 6f70 7469  ot in write_opti
+00010370: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
+00010380: 2077 7269 7465 5f6f 7074 696f 6e73 5b22   write_options["
+00010390: 7761 6974 5f66 6f72 5f6a 6f62 225d 203d  wait_for_job"] =
+000103a0: 2077 6169 740a 0a20 2020 2020 2020 2023   wait..        #
+000103b0: 2066 675f 6a6f 6220 6973 2075 7365 6420   fg_job is used 
+000103c0: 6f6e 6c79 2069 6620 7468 6520 7079 7468  only if the pyth
+000103d0: 6f6e 2065 6e67 696e 6520 6973 2075 7365  on engine is use
+000103e0: 640a 2020 2020 2020 2020 6667 5f6a 6f62  d.        fg_job
+000103f0: 2c20 6765 5f72 6570 6f72 7420 3d20 7365  , ge_report = se
+00010400: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
+00010410: 705f 656e 6769 6e65 2e73 6176 6528 0a20  p_engine.save(. 
+00010420: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+00010430: 2066 6561 7475 7265 5f64 6174 6166 7261   feature_datafra
+00010440: 6d65 2c20 7772 6974 655f 6f70 7469 6f6e  me, write_option
+00010450: 732c 2076 616c 6964 6174 696f 6e5f 6f70  s, validation_op
+00010460: 7469 6f6e 730a 2020 2020 2020 2020 290a  tions.        ).
+00010470: 2020 2020 2020 2020 6966 2067 655f 7265          if ge_re
+00010480: 706f 7274 2069 7320 4e6f 6e65 206f 7220  port is None or 
+00010490: 6765 5f72 6570 6f72 742e 696e 6765 7374  ge_report.ingest
+000104a0: 696f 6e5f 7265 7375 6c74 203d 3d20 2249  ion_result == "I
+000104b0: 4e47 4553 5445 4422 3a0a 2020 2020 2020  NGESTED":.      
+000104c0: 2020 2020 2020 7365 6c66 2e5f 636f 6465        self._code
+000104d0: 5f65 6e67 696e 652e 7361 7665 5f63 6f64  _engine.save_cod
+000104e0: 6528 7365 6c66 290a 0a20 2020 2020 2020  e(self)..       
+000104f0: 2069 6620 7365 6c66 2e73 7461 7469 7374   if self.statist
+00010500: 6963 735f 636f 6e66 6967 2e65 6e61 626c  ics_config.enabl
+00010510: 6564 2061 6e64 2065 6e67 696e 652e 6765  ed and engine.ge
+00010520: 745f 7479 7065 2829 203d 3d20 2273 7061  t_type() == "spa
+00010530: 726b 223a 0a20 2020 2020 2020 2020 2020  rk":.           
+00010540: 2023 204f 6e6c 7920 636f 6d70 7574 6520   # Only compute 
+00010550: 7374 6174 6973 7469 6373 2069 6620 7468  statistics if th
+00010560: 6520 656e 6769 6e65 2069 7320 5370 6172  e engine is Spar
+00010570: 6b2e 0a20 2020 2020 2020 2020 2020 2023  k..            #
+00010580: 2046 6f72 2050 7974 686f 6e20 656e 6769   For Python engi
+00010590: 6e65 2c20 7468 6520 636f 6d70 7574 6174  ne, the computat
+000105a0: 696f 6e20 6861 7070 656e 7320 696e 2074  ion happens in t
+000105b0: 6865 2048 6f70 7377 6f72 6b73 2061 7070  he Hopsworks app
+000105c0: 6c69 6361 7469 6f6e 0a20 2020 2020 2020  lication.       
+000105d0: 2020 2020 2073 656c 662e 5f73 7461 7469       self._stati
+000105e0: 7374 6963 735f 656e 6769 6e65 2e63 6f6d  stics_engine.com
+000105f0: 7075 7465 5f73 7461 7469 7374 6963 7328  pute_statistics(
+00010600: 7365 6c66 2c20 6665 6174 7572 655f 6461  self, feature_da
+00010610: 7461 6672 616d 6529 0a20 2020 2020 2020  taframe).       
+00010620: 2069 6620 7573 6572 5f76 6572 7369 6f6e   if user_version
+00010630: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00010640: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
+00010650: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00010660: 2020 2020 2022 4e6f 2076 6572 7369 6f6e       "No version
+00010670: 2070 726f 7669 6465 6420 666f 7220 6372   provided for cr
+00010680: 6561 7469 6e67 2066 6561 7475 7265 2067  eating feature g
+00010690: 726f 7570 2060 7b7d 602c 2069 6e63 7265  roup `{}`, incre
+000106a0: 6d65 6e74 6564 2076 6572 7369 6f6e 2074  mented version t
+000106b0: 6f20 607b 7d60 2e22 2e66 6f72 6d61 7428  o `{}`.".format(
+000106c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000106d0: 2020 2020 2073 656c 662e 5f6e 616d 652c       self._name,
+000106e0: 2073 656c 662e 5f76 6572 7369 6f6e 0a20   self._version. 
+000106f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00010700: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010710: 2020 7574 696c 2e56 6572 7369 6f6e 5761    util.VersionWa
+00010720: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
+00010730: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00010740: 7572 6e20 280a 2020 2020 2020 2020 2020  urn (.          
+00010750: 2020 6667 5f6a 6f62 2c0a 2020 2020 2020    fg_job,.      
+00010760: 2020 2020 2020 6765 5f72 6570 6f72 742e        ge_report.
+00010770: 746f 5f67 655f 7479 7065 2829 2069 6620  to_ge_type() if 
+00010780: 6765 5f72 6570 6f72 7420 6973 206e 6f74  ge_report is not
+00010790: 204e 6f6e 6520 656c 7365 204e 6f6e 652c   None else None,
+000107a0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000107b0: 6465 6620 696e 7365 7274 280a 2020 2020  def insert(.    
+000107c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000107d0: 2020 6665 6174 7572 6573 3a20 556e 696f    features: Unio
+000107e0: 6e5b 0a20 2020 2020 2020 2020 2020 2070  n[.            p
+000107f0: 642e 4461 7461 4672 616d 652c 0a20 2020  d.DataFrame,.   
+00010800: 2020 2020 2020 2020 2054 7970 6556 6172           TypeVar
+00010810: 2822 7079 7370 6172 6b2e 7371 6c2e 4461  ("pyspark.sql.Da
+00010820: 7461 4672 616d 6522 292c 2020 2320 6e6f  taFrame"),  # no
+00010830: 7161 3a20 4638 3231 0a20 2020 2020 2020  qa: F821.       
+00010840: 2020 2020 2054 7970 6556 6172 2822 7079       TypeVar("py
+00010850: 7370 6172 6b2e 5244 4422 292c 2020 2320  spark.RDD"),  # 
+00010860: 6e6f 7161 3a20 4638 3231 0a20 2020 2020  noqa: F821.     
+00010870: 2020 2020 2020 206e 702e 6e64 6172 7261         np.ndarra
+00010880: 792c 0a20 2020 2020 2020 2020 2020 204c  y,.            L
+00010890: 6973 745b 6c69 7374 5d2c 0a20 2020 2020  ist[list],.     
+000108a0: 2020 205d 2c0a 2020 2020 2020 2020 6f76     ],.        ov
+000108b0: 6572 7772 6974 653a 204f 7074 696f 6e61  erwrite: Optiona
+000108c0: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
+000108d0: 0a20 2020 2020 2020 206f 7065 7261 7469  .        operati
+000108e0: 6f6e 3a20 4f70 7469 6f6e 616c 5b73 7472  on: Optional[str
+000108f0: 5d20 3d20 2275 7073 6572 7422 2c0a 2020  ] = "upsert",.  
+00010900: 2020 2020 2020 7374 6f72 6167 653a 204f        storage: O
+00010910: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+00010920: 6f6e 652c 0a20 2020 2020 2020 2077 7269  one,.        wri
+00010930: 7465 5f6f 7074 696f 6e73 3a20 4f70 7469  te_options: Opti
+00010940: 6f6e 616c 5b44 6963 745b 7374 722c 2041  onal[Dict[str, A
+00010950: 6e79 5d5d 203d 207b 7d2c 0a20 2020 2020  ny]] = {},.     
+00010960: 2020 2076 616c 6964 6174 696f 6e5f 6f70     validation_op
+00010970: 7469 6f6e 733a 204f 7074 696f 6e61 6c5b  tions: Optional[
+00010980: 4469 6374 5b73 7472 2c20 416e 795d 5d20  Dict[str, Any]] 
+00010990: 3d20 7b7d 2c0a 2020 2020 2020 2020 7361  = {},.        sa
+000109a0: 7665 5f63 6f64 653a 204f 7074 696f 6e61  ve_code: Optiona
+000109b0: 6c5b 626f 6f6c 5d20 3d20 5472 7565 2c0a  l[bool] = True,.
+000109c0: 2020 2020 2020 2020 7761 6974 3a20 626f          wait: bo
+000109d0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+000109e0: 2920 2d3e 2054 7570 6c65 5b4f 7074 696f  ) -> Tuple[Optio
+000109f0: 6e61 6c5b 4a6f 625d 2c20 4f70 7469 6f6e  nal[Job], Option
+00010a00: 616c 5b56 616c 6964 6174 696f 6e52 6570  al[ValidationRep
+00010a10: 6f72 745d 5d3a 0a20 2020 2020 2020 2022  ort]]:.        "
+00010a20: 2222 5065 7273 6973 7420 7468 6520 6d65  ""Persist the me
+00010a30: 7461 6461 7461 2061 6e64 206d 6174 6572  tadata and mater
+00010a40: 6961 6c69 7a65 2074 6865 2066 6561 7475  ialize the featu
+00010a50: 7265 2067 726f 7570 2074 6f20 7468 6520  re group to the 
+00010a60: 6665 6174 7572 6520 7374 6f72 650a 2020  feature store.  
+00010a70: 2020 2020 2020 6f72 2069 6e73 6572 7420        or insert 
+00010a80: 6461 7461 2066 726f 6d20 6120 6461 7461  data from a data
+00010a90: 6672 616d 6520 696e 746f 2074 6865 2065  frame into the e
+00010aa0: 7869 7374 696e 6720 6665 6174 7572 6520  xisting feature 
+00010ab0: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+00010ac0: 496e 6372 656d 656e 7461 6c6c 7920 696e  Incrementally in
+00010ad0: 7365 7274 2064 6174 6120 746f 2061 2066  sert data to a f
+00010ae0: 6561 7475 7265 2067 726f 7570 206f 7220  eature group or 
+00010af0: 6f76 6572 7772 6974 6520 616c 6c20 2064  overwrite all  d
+00010b00: 6174 6120 636f 6e74 6169 6e65 6420 696e  ata contained in
+00010b10: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00010b20: 7570 2e20 4279 0a20 2020 2020 2020 2064  up. By.        d
+00010b30: 6566 6175 6c74 2c20 7468 6520 6461 7461  efault, the data
+00010b40: 2069 7320 696e 7365 7274 6564 2069 6e74   is inserted int
+00010b50: 6f20 7468 6520 6f66 666c 696e 6520 7374  o the offline st
+00010b60: 6f72 6167 6520 6173 2077 656c 6c20 6173  orage as well as
+00010b70: 2074 6865 206f 6e6c 696e 6520 7374 6f72   the online stor
+00010b80: 6167 6520 6966 2074 6865 2066 6561 7475  age if the featu
+00010b90: 7265 2067 726f 7570 2069 730a 2020 2020  re group is.    
+00010ba0: 2020 2020 606f 6e6c 696e 655f 656e 6162      `online_enab
+00010bb0: 6c65 643d 5472 7565 602e 2054 6f20 696e  led=True`. To in
+00010bc0: 7365 7274 206f 6e6c 7920 696e 746f 2074  sert only into t
+00010bd0: 6865 206f 6e6c 696e 6520 6f72 206f 6666  he online or off
+00010be0: 6c69 6e65 2073 746f 7261 6765 2073 6574  line storage set
+00010bf0: 2060 7374 6f72 6167 653d 226f 6e6c 696e   `storage="onlin
+00010c00: 6522 6020 6f72 0a20 2020 2020 2020 2060  e"` or.        `
+00010c10: 7374 6f72 6167 653d 226f 6666 6c69 6e65  storage="offline
+00010c20: 2260 2072 6573 7065 6374 6976 656c 792e  "` respectively.
+00010c30: 0a0a 2020 2020 2020 2020 5468 6520 6066  ..        The `f
+00010c40: 6561 7475 7265 7360 2064 6174 6166 7261  eatures` datafra
+00010c50: 6d65 2063 616e 2062 6520 6120 5370 6172  me can be a Spar
+00010c60: 6b20 4461 7461 4672 616d 6520 6f72 2052  k DataFrame or R
+00010c70: 4444 2c20 6120 5061 6e64 6173 2044 6174  DD, a Pandas Dat
+00010c80: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
+00010c90: 6f72 2061 2074 776f 2d64 696d 656e 7369  or a two-dimensi
+00010ca0: 6f6e 616c 204e 756d 7079 2061 7272 6179  onal Numpy array
+00010cb0: 206f 7220 6120 7477 6f2d 6469 6d65 6e73   or a two-dimens
+00010cc0: 696f 6e61 6c20 5079 7468 6f6e 206e 6573  ional Python nes
+00010cd0: 7465 6420 6c69 7374 2e0a 2020 2020 2020  ted list..      
+00010ce0: 2020 4966 2073 7461 7469 7374 6963 7320    If statistics 
+00010cf0: 6172 6520 656e 6162 6c65 642c 2073 7461  are enabled, sta
+00010d00: 7469 7374 6963 7320 6172 6520 7265 636f  tistics are reco
+00010d10: 6d70 7574 6564 2066 6f72 2074 6865 2065  mputed for the e
+00010d20: 6e74 6972 6520 6665 6174 7572 650a 2020  ntire feature.  
+00010d30: 2020 2020 2020 6772 6f75 702e 0a20 2020        group..   
+00010d40: 2020 2020 2049 6620 6665 6174 7572 6520       If feature 
+00010d50: 6772 6f75 7027 7320 7469 6d65 2074 7261  group's time tra
+00010d60: 7665 6c20 666f 726d 6174 2069 7320 6048  vel format is `H
+00010d70: 5544 4960 2074 6865 6e20 606f 7065 7261  UDI` then `opera
+00010d80: 7469 6f6e 6020 6172 6775 6d65 6e74 2063  tion` argument c
+00010d90: 616e 2062 650a 2020 2020 2020 2020 6569  an be.        ei
+00010da0: 7468 6572 2060 696e 7365 7274 6020 6f72  ther `insert` or
+00010db0: 2060 7570 7365 7274 602e 0a0a 2020 2020   `upsert`...    
+00010dc0: 2020 2020 4966 2066 6561 7475 7265 2067      If feature g
+00010dd0: 726f 7570 2064 6f65 736e 2774 2065 7869  roup doesn't exi
+00010de0: 7374 7320 2074 6865 2069 6e73 6572 7420  sts  the insert 
+00010df0: 6d65 7468 6f64 2077 696c 6c20 6372 6561  method will crea
+00010e00: 7465 2074 6865 206e 6563 6573 7361 7279  te the necessary
+00010e10: 206d 6574 6164 6174 6120 7468 6520 6669   metadata the fi
+00010e20: 7273 7420 7469 6d65 2069 7420 6973 0a20  rst time it is. 
+00010e30: 2020 2020 2020 2069 6e76 6f6b 6564 2061         invoked a
+00010e40: 6e64 2077 7269 7465 7320 7468 6520 7370  nd writes the sp
+00010e50: 6563 6966 6965 6420 6066 6561 7475 7265  ecified `feature
+00010e60: 7360 2064 6174 6166 7261 6d65 2061 7320  s` dataframe as 
+00010e70: 6665 6174 7572 6520 6772 6f75 7020 746f  feature group to
+00010e80: 2074 6865 206f 6e6c 696e 652f 6f66 666c   the online/offl
+00010e90: 696e 6520 6665 6174 7572 6520 7374 6f72  ine feature stor
+00010ea0: 652e 0a0a 2020 2020 2020 2020 2121 2120  e...        !!! 
+00010eb0: 7761 726e 696e 6720 2243 6861 6e67 6564  warning "Changed
+00010ec0: 2069 6e20 332e 332e 3022 0a20 2020 2020   in 3.3.0".     
+00010ed0: 2020 2020 2020 2060 696e 7365 7274 6020         `insert` 
+00010ee0: 616e 6420 6073 6176 6560 206d 6574 686f  and `save` metho
+00010ef0: 6473 2061 7265 206e 6f77 2061 7379 6e63  ds are now async
+00010f00: 2062 7920 6465 6661 756c 7420 696e 206e   by default in n
+00010f10: 6f6e 2d73 7061 726b 2063 6c69 656e 7473  on-spark clients
+00010f20: 2e0a 2020 2020 2020 2020 2020 2020 546f  ..            To
+00010f30: 2061 6368 6965 7665 2074 6865 206f 6c64   achieve the old
+00010f40: 2062 6568 6176 696f 7572 2c20 7365 7420   behaviour, set 
+00010f50: 6077 6169 7460 2061 7267 756d 656e 7420  `wait` argument 
+00010f60: 746f 2060 5472 7565 602e 0a0a 2020 2020  to `True`...    
+00010f70: 2020 2020 2121 2120 6578 616d 706c 6520      !!! example 
+00010f80: 2255 7073 6572 7420 6e65 7720 6665 6174  "Upsert new feat
+00010f90: 7572 6520 6461 7461 2077 6974 6820 7469  ure data with ti
+00010fa0: 6d65 2074 7261 7665 6c20 666f 726d 6174  me travel format
+00010fb0: 2060 4855 4449 6022 0a20 2020 2020 2020   `HUDI`".       
+00010fc0: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00010fd0: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
+00010fe0: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
+00010ff0: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
+00011000: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
+00011010: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
+00011020: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
+00011030: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
+00011040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011050: 206e 616d 653d 2762 6974 636f 696e 5f70   name='bitcoin_p
+00011060: 7269 6365 272c 0a20 2020 2020 2020 2020  rice',.         
+00011070: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
+00011080: 6f6e 3d27 4269 7463 6f69 6e20 7072 6963  on='Bitcoin pric
+00011090: 6520 6167 6772 6567 6174 6564 2066 6f72  e aggregated for
+000110a0: 2064 6179 7327 2c0a 2020 2020 2020 2020   days',.        
+000110b0: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+000110c0: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+000110d0: 2020 2070 7269 6d61 7279 5f6b 6579 3d5b     primary_key=[
+000110e0: 2775 6e69 7827 5d2c 0a20 2020 2020 2020  'unix'],.       
+000110f0: 2020 2020 2020 2020 206f 6e6c 696e 655f           online_
+00011100: 656e 6162 6c65 643d 5472 7565 2c0a 2020  enabled=True,.  
+00011110: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00011120: 656e 745f 7469 6d65 3d27 756e 6978 270a  ent_time='unix'.
+00011130: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00011140: 2020 2020 2020 2020 2020 2066 672e 696e             fg.in
+00011150: 7365 7274 2864 665f 6269 7463 6f69 6e5f  sert(df_bitcoin_
+00011160: 7072 6f63 6573 7365 6429 0a20 2020 2020  processed).     
+00011170: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
+00011180: 2020 2020 2121 2120 6578 616d 706c 6520      !!! example 
+00011190: 2241 7379 6e63 2069 6e73 6572 7422 0a20  "Async insert". 
+000111a0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+000111b0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+000111c0: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
+000111d0: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
+000111e0: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
+000111f0: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
+00011200: 2020 6667 3120 3d20 6673 2e67 6574 5f6f    fg1 = fs.get_o
+00011210: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+00011220: 5f67 726f 7570 280a 2020 2020 2020 2020  _group(.        
+00011230: 2020 2020 2020 2020 6e61 6d65 3d27 6665          name='fe
+00011240: 6174 7572 655f 6772 6f75 705f 6e61 6d65  ature_group_name
+00011250: 3127 2c0a 2020 2020 2020 2020 2020 2020  1',.            
+00011260: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
+00011270: 2744 6573 6372 6970 7469 6f6e 206f 6620  'Description of 
+00011280: 7468 6520 6669 7273 7420 4647 272c 0a20  the first FG',. 
+00011290: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000112a0: 6572 7369 6f6e 3d31 2c0a 2020 2020 2020  ersion=1,.      
+000112b0: 2020 2020 2020 2020 2020 7072 696d 6172            primar
+000112c0: 795f 6b65 793d 5b27 756e 6978 275d 2c0a  y_key=['unix'],.
+000112d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000112e0: 6f6e 6c69 6e65 5f65 6e61 626c 6564 3d54  online_enabled=T
+000112f0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+00011300: 2020 2020 2065 7665 6e74 5f74 696d 653d       event_time=
+00011310: 2775 6e69 7827 0a20 2020 2020 2020 2020  'unix'.         
+00011320: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00011330: 2023 2061 7379 6e63 2069 6e73 6572 7469   # async inserti
+00011340: 6f6e 2069 6e20 6f72 6465 7220 6e6f 7420  on in order not 
+00011350: 746f 2077 6169 7420 7469 6c6c 2066 696e  to wait till fin
+00011360: 6973 6820 6f66 2074 6865 206a 6f62 0a20  ish of the job. 
+00011370: 2020 2020 2020 2020 2020 2066 672e 696e             fg.in
+00011380: 7365 7274 2864 665f 666f 725f 6667 312c  sert(df_for_fg1,
+00011390: 2077 7269 7465 5f6f 7074 696f 6e73 3d7b   write_options={
+000113a0: 2277 6169 745f 666f 725f 6a6f 6222 203a  "wait_for_job" :
+000113b0: 2046 616c 7365 7d29 0a0a 2020 2020 2020   False})..      
+000113c0: 2020 2020 2020 6667 3220 3d20 6673 2e67        fg2 = fs.g
+000113d0: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+000113e0: 7475 7265 5f67 726f 7570 280a 2020 2020  ture_group(.    
+000113f0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00011400: 3d27 6665 6174 7572 655f 6772 6f75 705f  ='feature_group_
+00011410: 6e61 6d65 3227 2c0a 2020 2020 2020 2020  name2',.        
+00011420: 2020 2020 2020 2020 6465 7363 7269 7074          descript
+00011430: 696f 6e3d 2744 6573 6372 6970 7469 6f6e  ion='Description
+00011440: 206f 6620 7468 6520 7365 636f 6e64 2046   of the second F
+00011450: 4727 2c0a 2020 2020 2020 2020 2020 2020  G',.            
+00011460: 2020 2020 7665 7273 696f 6e3d 312c 0a20      version=1,. 
+00011470: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00011480: 7269 6d61 7279 5f6b 6579 3d5b 2775 6e69  rimary_key=['uni
+00011490: 7827 5d2c 0a20 2020 2020 2020 2020 2020  x'],.           
+000114a0: 2020 2020 206f 6e6c 696e 655f 656e 6162       online_enab
+000114b0: 6c65 643d 5472 7565 2c0a 2020 2020 2020  led=True,.      
+000114c0: 2020 2020 2020 2020 2020 6576 656e 745f            event_
+000114d0: 7469 6d65 3d27 756e 6978 270a 2020 2020  time='unix'.    
+000114e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000114f0: 2020 2020 2020 6667 2e69 6e73 6572 7428        fg.insert(
+00011500: 6466 5f66 6f72 5f66 6732 290a 2020 2020  df_for_fg2).    
+00011510: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+00011520: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+00011530: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+00011540: 7475 7265 733a 2044 6174 6146 7261 6d65  tures: DataFrame
+00011550: 2c20 5244 442c 204e 6461 7272 6179 2c20  , RDD, Ndarray, 
+00011560: 6c69 7374 2e20 4665 6174 7572 6573 2074  list. Features t
+00011570: 6f20 6265 2073 6176 6564 2e0a 2020 2020  o be saved..    
+00011580: 2020 2020 2020 2020 6f76 6572 7772 6974          overwrit
+00011590: 653a 2044 726f 7020 616c 6c20 6461 7461  e: Drop all data
+000115a0: 2069 6e20 7468 6520 6665 6174 7572 6520   in the feature 
+000115b0: 6772 6f75 7020 6265 666f 7265 0a20 2020  group before.   
+000115c0: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+000115d0: 6572 7469 6e67 206e 6577 2064 6174 612e  erting new data.
+000115e0: 2054 6869 7320 646f 6573 206e 6f74 2061   This does not a
+000115f0: 6666 6563 7420 6d65 7461 6461 7461 2c20  ffect metadata, 
+00011600: 6465 6661 756c 7473 2074 6f20 4661 6c73  defaults to Fals
+00011610: 652e 0a20 2020 2020 2020 2020 2020 206f  e..            o
+00011620: 7065 7261 7469 6f6e 3a20 4170 6163 6865  peration: Apache
+00011630: 2048 7564 6920 6f70 6572 6174 696f 6e20   Hudi operation 
+00011640: 7479 7065 2060 2269 6e73 6572 7422 6020  type `"insert"` 
+00011650: 6f72 2060 2275 7073 6572 7422 602e 0a20  or `"upsert"`.. 
+00011660: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+00011670: 6566 6175 6c74 7320 746f 2060 2275 7073  efaults to `"ups
+00011680: 6572 7422 602e 0a20 2020 2020 2020 2020  ert"`..         
+00011690: 2020 2073 746f 7261 6765 3a20 4f76 6572     storage: Over
+000116a0: 7772 6974 6520 6465 6661 756c 7420 6265  write default be
+000116b0: 6861 7669 6f75 722c 2077 7269 7465 2074  haviour, write t
+000116c0: 6f20 6f66 666c 696e 650a 2020 2020 2020  o offline.      
+000116d0: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
+000116e0: 6520 6f6e 6c79 2077 6974 6820 6022 6f66  e only with `"of
+000116f0: 666c 696e 6522 6020 6f72 206f 6e6c 696e  fline"` or onlin
+00011700: 6520 6f6e 6c79 2077 6974 6820 6022 6f6e  e only with `"on
+00011710: 6c69 6e65 2260 2c20 6465 6661 756c 7473  line"`, defaults
+00011720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011730: 2074 6f20 604e 6f6e 6560 2e0a 2020 2020   to `None`..    
+00011740: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
+00011750: 7469 6f6e 733a 2041 6464 6974 696f 6e61  tions: Additiona
+00011760: 6c20 7772 6974 6520 6f70 7469 6f6e 7320  l write options 
+00011770: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
+00011780: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
+00011790: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
+000117a0: 2020 2020 2020 5768 656e 2075 7369 6e67        When using
+000117b0: 2074 6865 2060 7079 7468 6f6e 6020 656e   the `python` en
+000117c0: 6769 6e65 2c20 7772 6974 655f 6f70 7469  gine, write_opti
+000117d0: 6f6e 7320 6361 6e20 636f 6e74 6169 6e20  ons can contain 
+000117e0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+000117f0: 2020 2020 666f 6c6c 6f77 696e 6720 656e      following en
+00011800: 7472 6965 733a 0a20 2020 2020 2020 2020  tries:.         
+00011810: 2020 2020 2020 202a 206b 6579 2060 7370         * key `sp
+00011820: 6172 6b60 2061 6e64 2076 616c 7565 2061  ark` and value a
+00011830: 6e20 6f62 6a65 6374 206f 6620 7479 7065  n object of type
+00011840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011850: 205b 6873 6673 2e63 6f72 652e 6a6f 625f   [hsfs.core.job_
+00011860: 636f 6e66 6967 7572 6174 696f 6e2e 4a6f  configuration.Jo
+00011870: 6243 6f6e 6669 6775 7261 7469 6f6e 5d28  bConfiguration](
+00011880: 2e2e 2f6a 6f62 5f63 6f6e 6669 6775 7261  ../job_configura
+00011890: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+000118a0: 2020 2020 2020 2020 746f 2063 6f6e 6669          to confi
+000118b0: 6775 7265 2074 6865 2048 6f70 7377 6f72  gure the Hopswor
+000118c0: 6b73 204a 6f62 2075 7365 6420 746f 2077  ks Job used to w
+000118d0: 7269 7465 2064 6174 6120 696e 746f 2074  rite data into t
+000118e0: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
+000118f0: 2020 2020 2066 6561 7475 7265 2067 726f       feature gro
+00011900: 7570 2e0a 2020 2020 2020 2020 2020 2020  up..            
+00011910: 2020 2020 2a20 6b65 7920 6077 6169 745f      * key `wait_
+00011920: 666f 725f 6a6f 6260 2061 6e64 2076 616c  for_job` and val
+00011930: 7565 2060 5472 7565 6020 6f72 2060 4661  ue `True` or `Fa
+00011940: 6c73 6560 2074 6f20 636f 6e66 6967 7572  lse` to configur
+00011950: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00011960: 2020 2020 7768 6574 6865 7220 6f72 206e      whether or n
+00011970: 6f74 2074 6f20 7468 6520 696e 7365 7274  ot to the insert
+00011980: 2063 616c 6c20 7368 6f75 6c64 2072 6574   call should ret
+00011990: 7572 6e20 6f6e 6c79 0a20 2020 2020 2020  urn only.       
+000119a0: 2020 2020 2020 2020 2020 2061 6674 6572             after
+000119b0: 2074 6865 2048 6f70 7377 6f72 6b73 204a   the Hopsworks J
+000119c0: 6f62 2068 6173 2066 696e 6973 6865 642e  ob has finished.
+000119d0: 2042 7920 6465 6661 756c 7420 6974 2077   By default it w
+000119e0: 6169 7473 2e0a 2020 2020 2020 2020 2020  aits..          
+000119f0: 2020 2020 2020 2a20 6b65 7920 6073 7461        * key `sta
+00011a00: 7274 5f6f 6666 6c69 6e65 5f62 6163 6b66  rt_offline_backf
+00011a10: 696c 6c60 2061 6e64 2076 616c 7565 2060  ill` and value `
+00011a20: 5472 7565 6020 6f72 2060 4661 6c73 6560  True` or `False`
+00011a30: 2074 6f20 636f 6e66 6967 7572 650a 2020   to configure.  
+00011a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a50: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
+00011a60: 6f20 7374 6172 7420 7468 6520 6261 636b  o start the back
+00011a70: 6669 6c6c 206a 6f62 2074 6f20 7772 6974  fill job to writ
+00011a80: 6520 6461 7461 2074 6f20 7468 6520 6f66  e data to the of
+00011a90: 666c 696e 650a 2020 2020 2020 2020 2020  fline.          
+00011aa0: 2020 2020 2020 2020 7374 6f72 6167 652e          storage.
+00011ab0: 2042 7920 6465 6661 756c 7420 7468 6520   By default the 
+00011ac0: 6261 636b 6669 6c6c 206a 6f62 2067 6574  backfill job get
+00011ad0: 7320 7374 6172 7465 6420 696d 6d65 6469  s started immedi
+00011ae0: 6174 656c 792e 0a20 2020 2020 2020 2020  ately..         
+00011af0: 2020 2020 2020 202a 206b 6579 2060 696e         * key `in
+00011b00: 7465 726e 616c 5f6b 6166 6b61 6020 616e  ternal_kafka` an
+00011b10: 6420 7661 6c75 6520 6054 7275 6560 206f  d value `True` o
+00011b20: 7220 6046 616c 7365 6020 696e 2063 6173  r `False` in cas
+00011b30: 6520 796f 7520 6573 7461 626c 6973 6865  e you establishe
+00011b40: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00011b50: 2020 2020 636f 6e6e 6563 7469 7669 7479      connectivity
+00011b60: 2066 726f 6d20 796f 7520 5079 7468 6f6e   from you Python
+00011b70: 2065 6e76 6972 6f6e 6d65 6e74 2074 6f20   environment to 
+00011b80: 7468 6520 696e 7465 726e 616c 2061 6476  the internal adv
+00011b90: 6572 7469 7365 640a 2020 2020 2020 2020  ertised.        
+00011ba0: 2020 2020 2020 2020 2020 6c69 7374 656e            listen
+00011bb0: 6572 7320 6f66 2074 6865 2048 6f70 7377  ers of the Hopsw
+00011bc0: 6f72 6b73 204b 6166 6b61 2043 6c75 7374  orks Kafka Clust
+00011bd0: 6572 2e20 4465 6661 756c 7473 2074 6f20  er. Defaults to 
+00011be0: 6046 616c 7365 6020 616e 640a 2020 2020  `False` and.    
+00011bf0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00011c00: 6c6c 2075 7365 2065 7874 6572 6e61 6c20  ll use external 
+00011c10: 6c69 7374 656e 6572 7320 7768 656e 2063  listeners when c
+00011c20: 6f6e 6e65 6374 696e 6720 6672 6f6d 206f  onnecting from o
+00011c30: 7574 7369 6465 206f 6620 486f 7073 776f  utside of Hopswo
+00011c40: 726b 732e 0a20 2020 2020 2020 2020 2020  rks..           
+00011c50: 2076 616c 6964 6174 696f 6e5f 6f70 7469   validation_opti
+00011c60: 6f6e 733a 2041 6464 6974 696f 6e61 6c20  ons: Additional 
+00011c70: 7661 6c69 6461 7469 6f6e 206f 7074 696f  validation optio
+00011c80: 6e73 2061 7320 6b65 792d 7661 6c75 6520  ns as key-value 
+00011c90: 7061 6972 732c 2064 6566 6175 6c74 7320  pairs, defaults 
+00011ca0: 746f 2060 7b7d 602e 0a20 2020 2020 2020  to `{}`..       
+00011cb0: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
+00011cc0: 7275 6e5f 7661 6c69 6461 7469 6f6e 6020  run_validation` 
+00011cd0: 626f 6f6c 6561 6e20 7661 6c75 652c 2073  boolean value, s
+00011ce0: 6574 2074 6f20 6046 616c 7365 6020 746f  et to `False` to
+00011cf0: 2073 6b69 7020 7661 6c69 6461 7469 6f6e   skip validation
+00011d00: 2074 656d 706f 7261 7269 6c79 206f 6e20   temporarily on 
+00011d10: 696e 6765 7374 696f 6e2e 0a20 2020 2020  ingestion..     
+00011d20: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+00011d30: 2060 7361 7665 5f72 6570 6f72 7460 2062   `save_report` b
+00011d40: 6f6f 6c65 616e 2076 616c 7565 2c20 7365  oolean value, se
+00011d50: 7420 746f 2060 4661 6c73 6560 2074 6f20  t to `False` to 
+00011d60: 736b 6970 2075 706c 6f61 6420 6f66 2074  skip upload of t
+00011d70: 6865 2076 616c 6964 6174 696f 6e20 7265  he validation re
+00011d80: 706f 7274 2074 6f20 486f 7073 776f 726b  port to Hopswork
+00011d90: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+00011da0: 2020 202a 206b 6579 2060 6765 5f76 616c     * key `ge_val
+00011db0: 6964 6174 655f 6b77 6172 6773 6020 6120  idate_kwargs` a 
+00011dc0: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
+00011dd0: 696e 696e 6720 6b77 6172 6773 2066 6f72  ining kwargs for
+00011de0: 2074 6865 2076 616c 6964 6174 6520 6d65   the validate me
+00011df0: 7468 6f64 206f 6620 4772 6561 7420 4578  thod of Great Ex
+00011e00: 7065 6374 6174 696f 6e73 2e0a 2020 2020  pectations..    
+00011e10: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
+00011e20: 7920 6066 6574 6368 5f65 7870 6563 7461  y `fetch_expecta
+00011e30: 7469 6f6e 5f73 7569 7465 6020 6120 626f  tion_suite` a bo
+00011e40: 6f6c 6561 6e20 7661 6c75 652c 2062 7920  olean value, by 
+00011e50: 6465 6661 756c 7420 6054 7275 6560 2c20  default `True`, 
+00011e60: 746f 2063 6f6e 7472 6f6c 2077 6865 7468  to control wheth
+00011e70: 6572 2074 6865 2065 7870 6563 7461 7469  er the expectati
+00011e80: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
+00011e90: 2020 2020 2020 7375 6974 6520 6f66 2074        suite of t
+00011ea0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00011eb0: 2073 686f 756c 6420 6265 2066 6574 6368   should be fetch
+00011ec0: 6564 2062 6566 6f72 6520 6576 6572 7920  ed before every 
+00011ed0: 696e 7365 7274 2e0a 2020 2020 2020 2020  insert..        
+00011ee0: 2020 2020 7361 7665 5f63 6f64 653a 2057      save_code: W
+00011ef0: 6865 6e20 7275 6e6e 696e 6720 4853 4653  hen running HSFS
+00011f00: 206f 6e20 486f 7073 776f 726b 7320 6f72   on Hopsworks or
+00011f10: 2044 6174 6162 7269 636b 732c 2048 5346   Databricks, HSF
+00011f20: 5320 6361 6e20 7361 7665 2074 6865 2063  S can save the c
+00011f30: 6f64 652f 6e6f 7465 626f 6f6b 2075 7365  ode/notebook use
+00011f40: 6420 746f 2063 7265 6174 650a 2020 2020  d to create.    
+00011f50: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00011f60: 6665 6174 7572 6520 6772 6f75 7020 6f72  feature group or
+00011f70: 2075 7365 6420 746f 2069 6e73 6572 7420   used to insert 
+00011f80: 6461 7461 2074 6f20 6974 2e20 5768 656e  data to it. When
+00011f90: 2063 616c 6c69 6e67 2074 6865 2060 696e   calling the `in
+00011fa0: 7365 7274 6020 6d65 7468 6f64 2072 6570  sert` method rep
+00011fb0: 6561 7465 646c 790a 2020 2020 2020 2020  eatedly.        
+00011fc0: 2020 2020 2020 2020 7769 7468 2073 6d61          with sma
+00011fd0: 6c6c 2062 6174 6368 6573 206f 6620 6461  ll batches of da
+00011fe0: 7461 2c20 7468 6973 2063 616e 2073 6c6f  ta, this can slo
+00011ff0: 7720 646f 776e 2074 6865 2077 7269 7465  w down the write
+00012000: 732e 2055 7365 2074 6869 7320 6f70 7469  s. Use this opti
+00012010: 6f6e 2074 6f20 7475 726e 206f 6666 2073  on to turn off s
+00012020: 6176 696e 670a 2020 2020 2020 2020 2020  aving.          
+00012030: 2020 2020 2020 636f 6465 2e20 4465 6661        code. Defa
+00012040: 756c 7473 2074 6f20 6054 7275 6560 2e0a  ults to `True`..
+00012050: 2020 2020 2020 2020 2020 2020 7761 6974              wait
+00012060: 3a20 5761 6974 2066 6f72 206a 6f62 2074  : Wait for job t
+00012070: 6f20 6669 6e69 7368 2062 6566 6f72 6520  o finish before 
+00012080: 7265 7475 726e 696e 672c 2064 6566 6175  returning, defau
+00012090: 6c74 7320 746f 2060 4661 6c73 6560 2e0a  lts to `False`..
+000120a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000120b0: 5368 6f72 7463 7574 2066 6f72 2072 6561  Shortcut for rea
+000120c0: 645f 6f70 7469 6f6e 7320 607b 2277 6169  d_options `{"wai
+000120d0: 745f 666f 725f 6a6f 6222 3a20 4661 6c73  t_for_job": Fals
+000120e0: 657d 602e 0a0a 2020 2020 2020 2020 2320  e}`...        # 
+000120f0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00012100: 2020 2020 2860 4a6f 6260 2c20 6056 616c      (`Job`, `Val
+00012110: 6964 6174 696f 6e52 6570 6f72 7460 2920  idationReport`) 
+00012120: 4120 7475 706c 6520 7769 7468 206a 6f62  A tuple with job
+00012130: 2069 6e66 6f72 6d61 7469 6f6e 2069 6620   information if 
+00012140: 7079 7468 6f6e 2065 6e67 696e 6520 6973  python engine is
+00012150: 2075 7365 6420 616e 6420 7468 6520 7661   used and the va
+00012160: 6c69 6461 7469 6f6e 2072 6570 6f72 7420  lidation report 
+00012170: 6966 2076 616c 6964 6174 696f 6e20 6973  if validation is
+00012180: 2065 6e61 626c 6564 2e0a 2020 2020 2020   enabled..      
+00012190: 2020 2222 220a 2020 2020 2020 2020 6665    """.        fe
+000121a0: 6174 7572 655f 6461 7461 6672 616d 6520  ature_dataframe 
+000121b0: 3d20 656e 6769 6e65 2e67 6574 5f69 6e73  = engine.get_ins
+000121c0: 7461 6e63 6528 292e 636f 6e76 6572 745f  tance().convert_
+000121d0: 746f 5f64 6566 6175 6c74 5f64 6174 6166  to_default_dataf
+000121e0: 7261 6d65 2866 6561 7475 7265 7329 0a0a  rame(features)..
+000121f0: 2020 2020 2020 2020 6966 2077 7269 7465          if write
+00012200: 5f6f 7074 696f 6e73 2069 7320 4e6f 6e65  _options is None
+00012210: 3a0a 2020 2020 2020 2020 2020 2020 7772  :.            wr
+00012220: 6974 655f 6f70 7469 6f6e 7320 3d20 7b7d  ite_options = {}
+00012230: 0a20 2020 2020 2020 2069 6620 2277 6169  .        if "wai
+00012240: 745f 666f 725f 6a6f 6222 206e 6f74 2069  t_for_job" not i
+00012250: 6e20 7772 6974 655f 6f70 7469 6f6e 733a  n write_options:
+00012260: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
+00012270: 7465 5f6f 7074 696f 6e73 5b22 7761 6974  te_options["wait
+00012280: 5f66 6f72 5f6a 6f62 225d 203d 2077 6169  _for_job"] = wai
+00012290: 740a 0a20 2020 2020 2020 206a 6f62 2c20  t..        job, 
+000122a0: 6765 5f72 6570 6f72 7420 3d20 7365 6c66  ge_report = self
+000122b0: 2e5f 6665 6174 7572 655f 6772 6f75 705f  ._feature_group_
+000122c0: 656e 6769 6e65 2e69 6e73 6572 7428 0a20  engine.insert(. 
+000122d0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+000122e0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+000122f0: 7475 7265 5f64 6174 6166 7261 6d65 3d66  ture_dataframe=f
+00012300: 6561 7475 7265 5f64 6174 6166 7261 6d65  eature_dataframe
+00012310: 2c0a 2020 2020 2020 2020 2020 2020 6f76  ,.            ov
+00012320: 6572 7772 6974 653d 6f76 6572 7772 6974  erwrite=overwrit
+00012330: 652c 0a20 2020 2020 2020 2020 2020 206f  e,.            o
+00012340: 7065 7261 7469 6f6e 3d6f 7065 7261 7469  peration=operati
+00012350: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00012360: 7374 6f72 6167 653d 7374 6f72 6167 652e  storage=storage.
+00012370: 6c6f 7765 7228 2920 6966 2073 746f 7261  lower() if stora
+00012380: 6765 2069 7320 6e6f 7420 4e6f 6e65 2065  ge is not None e
+00012390: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
+000123a0: 2020 2020 2020 7772 6974 655f 6f70 7469        write_opti
+000123b0: 6f6e 733d 7772 6974 655f 6f70 7469 6f6e  ons=write_option
+000123c0: 732c 0a20 2020 2020 2020 2020 2020 2076  s,.            v
+000123d0: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
+000123e0: 733d 7b22 7361 7665 5f72 6570 6f72 7422  s={"save_report"
+000123f0: 3a20 5472 7565 2c20 2a2a 7661 6c69 6461  : True, **valida
+00012400: 7469 6f6e 5f6f 7074 696f 6e73 7d2c 0a20  tion_options},. 
+00012410: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00012420: 2069 6620 7361 7665 5f63 6f64 6520 616e   if save_code an
+00012430: 6420 280a 2020 2020 2020 2020 2020 2020  d (.            
+00012440: 6765 5f72 6570 6f72 7420 6973 204e 6f6e  ge_report is Non
+00012450: 6520 6f72 2067 655f 7265 706f 7274 2e69  e or ge_report.i
+00012460: 6e67 6573 7469 6f6e 5f72 6573 756c 7420  ngestion_result 
+00012470: 3d3d 2022 494e 4745 5354 4544 220a 2020  == "INGESTED".  
+00012480: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00012490: 2020 2020 2073 656c 662e 5f63 6f64 655f       self._code_
+000124a0: 656e 6769 6e65 2e73 6176 655f 636f 6465  engine.save_code
+000124b0: 2873 656c 6629 0a0a 2020 2020 2020 2020  (self)..        
+000124c0: 6966 2065 6e67 696e 652e 6765 745f 7479  if engine.get_ty
+000124d0: 7065 2829 203d 3d20 2273 7061 726b 223a  pe() == "spark":
+000124e0: 0a20 2020 2020 2020 2020 2020 2023 204f  .            # O
+000124f0: 6e6c 7920 636f 6d70 7574 6520 7374 6174  nly compute stat
+00012500: 6973 7469 6373 2069 6620 7468 6520 656e  istics if the en
+00012510: 6769 6e65 2069 7320 5370 6172 6b2c 0a20  gine is Spark,. 
+00012520: 2020 2020 2020 2020 2020 2023 2069 6620             # if 
+00012530: 5079 7468 6f6e 2c20 7468 6520 7374 6174  Python, the stat
+00012540: 6973 7469 6373 2061 7265 2063 6f6d 7075  istics are compu
+00012550: 7465 6420 6279 2074 6865 2061 7070 6c69  ted by the appli
+00012560: 6361 7469 6f6e 2064 6f69 6e67 2074 6865  cation doing the
+00012570: 2069 6e73 6572 740a 2020 2020 2020 2020   insert.        
+00012580: 2020 2020 7365 6c66 2e63 6f6d 7075 7465      self.compute
+00012590: 5f73 7461 7469 7374 6963 7328 290a 0a20  _statistics().. 
+000125a0: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
+000125b0: 2020 2020 2020 2020 2020 2020 6a6f 622c              job,
+000125c0: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
+000125d0: 7265 706f 7274 2e74 6f5f 6765 5f74 7970  report.to_ge_typ
+000125e0: 6528 2920 6966 2067 655f 7265 706f 7274  e() if ge_report
+000125f0: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+00012600: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
+00012610: 290a 0a20 2020 2064 6566 206d 756c 7469  )..    def multi
+00012620: 5f70 6172 745f 696e 7365 7274 280a 2020  _part_insert(.  
+00012630: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00012640: 2020 2020 6665 6174 7572 6573 3a20 556e      features: Un
+00012650: 696f 6e5b 0a20 2020 2020 2020 2020 2020  ion[.           
+00012660: 2070 642e 4461 7461 4672 616d 652c 0a20   pd.DataFrame,. 
+00012670: 2020 2020 2020 2020 2020 2054 7970 6556             TypeV
+00012680: 6172 2822 7079 7370 6172 6b2e 7371 6c2e  ar("pyspark.sql.
+00012690: 4461 7461 4672 616d 6522 292c 2020 2320  DataFrame"),  # 
+000126a0: 6e6f 7161 3a20 4638 3231 0a20 2020 2020  noqa: F821.     
+000126b0: 2020 2020 2020 2054 7970 6556 6172 2822         TypeVar("
+000126c0: 7079 7370 6172 6b2e 5244 4422 292c 2020  pyspark.RDD"),  
+000126d0: 2320 6e6f 7161 3a20 4638 3231 0a20 2020  # noqa: F821.   
+000126e0: 2020 2020 2020 2020 206e 702e 6e64 6172           np.ndar
+000126f0: 7261 792c 0a20 2020 2020 2020 2020 2020  ray,.           
+00012700: 204c 6973 745b 6c69 7374 5d2c 0a20 2020   List[list],.   
+00012710: 2020 2020 205d 203d 204e 6f6e 652c 0a20       ] = None,. 
+00012720: 2020 2020 2020 206f 7665 7277 7269 7465         overwrite
+00012730: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00012740: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00012750: 2020 6f70 6572 6174 696f 6e3a 204f 7074    operation: Opt
+00012760: 696f 6e61 6c5b 7374 725d 203d 2022 7570  ional[str] = "up
+00012770: 7365 7274 222c 0a20 2020 2020 2020 2073  sert",.        s
+00012780: 746f 7261 6765 3a20 4f70 7469 6f6e 616c  torage: Optional
+00012790: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+000127a0: 2020 2020 2020 7772 6974 655f 6f70 7469        write_opti
+000127b0: 6f6e 733a 204f 7074 696f 6e61 6c5b 4469  ons: Optional[Di
+000127c0: 6374 5b73 7472 2c20 416e 795d 5d20 3d20  ct[str, Any]] = 
+000127d0: 7b7d 2c0a 2020 2020 2020 2020 7661 6c69  {},.        vali
+000127e0: 6461 7469 6f6e 5f6f 7074 696f 6e73 3a20  dation_options: 
+000127f0: 4f70 7469 6f6e 616c 5b44 6963 745b 7374  Optional[Dict[st
+00012800: 722c 2041 6e79 5d5d 203d 207b 7d2c 0a20  r, Any]] = {},. 
+00012810: 2020 2029 202d 3e20 556e 696f 6e5b 0a20     ) -> Union[. 
+00012820: 2020 2020 2020 2054 7570 6c65 5b4f 7074         Tuple[Opt
+00012830: 696f 6e61 6c5b 4a6f 625d 2c20 4f70 7469  ional[Job], Opti
+00012840: 6f6e 616c 5b56 616c 6964 6174 696f 6e52  onal[ValidationR
+00012850: 6570 6f72 745d 5d2c 0a20 2020 2020 2020  eport]],.       
+00012860: 2066 6561 7475 7265 5f67 726f 7570 5f77   feature_group_w
+00012870: 7269 7465 722e 4665 6174 7572 6547 726f  riter.FeatureGro
+00012880: 7570 5772 6974 6572 2c0a 2020 2020 5d3a  upWriter,.    ]:
+00012890: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
+000128a0: 4665 6174 7572 6547 726f 7570 5772 6974  FeatureGroupWrit
+000128b0: 6572 2066 6f72 206f 7074 696d 697a 6564  er for optimized
+000128c0: 206d 756c 7469 2070 6172 7420 696e 7365   multi part inse
+000128d0: 7274 7320 6f72 2063 616c 6c20 7468 6973  rts or call this
+000128e0: 206d 6574 686f 640a 2020 2020 2020 2020   method.        
+000128f0: 746f 2073 7461 7274 206d 616e 7561 6c20  to start manual 
+00012900: 6d75 6c74 6920 7061 7274 206f 7074 696d  multi part optim
+00012910: 697a 6564 2069 6e73 6572 7473 2e0a 0a20  ized inserts... 
+00012920: 2020 2020 2020 2049 6e20 7573 6520 6361         In use ca
+00012930: 7365 7320 7768 6572 6520 7665 7279 2073  ses where very s
+00012940: 6d61 6c6c 2062 6174 6368 6573 2028 3120  mall batches (1 
+00012950: 746f 2031 3030 3029 2072 6f77 7320 7065  to 1000) rows pe
+00012960: 7220 4461 7461 6672 616d 6520 6e65 6564  r Dataframe need
+00012970: 0a20 2020 2020 2020 2074 6f20 6265 2077  .        to be w
+00012980: 7269 7474 656e 2074 6f20 7468 6520 6665  ritten to the fe
+00012990: 6174 7572 6520 7374 6f72 6520 7265 7065  ature store repe
+000129a0: 6174 6564 6c79 2c20 6974 206d 6967 6874  atedly, it might
+000129b0: 2062 6520 696e 6566 6669 6369 656e 7420   be inefficient 
+000129c0: 746f 2075 7365 0a20 2020 2020 2020 2074  to use.        t
+000129d0: 6865 2073 7461 6e64 6172 6420 6066 6561  he standard `fea
+000129e0: 7475 7265 5f67 726f 7570 2e69 6e73 6572  ture_group.inser
+000129f0: 7428 2960 206d 6574 686f 6420 6173 2069  t()` method as i
+00012a00: 7420 7065 7266 6f72 6d73 2073 6f6d 6520  t performs some 
+00012a10: 6261 636b 6772 6f75 6e64 0a20 2020 2020  background.     
+00012a20: 2020 2061 6374 696f 6e73 2074 6f20 7570     actions to up
+00012a30: 6461 7465 2074 6865 206d 6574 6164 6174  date the metadat
+00012a40: 6120 6f66 2074 6865 2066 6561 7475 7265  a of the feature
+00012a50: 2067 726f 7570 206f 626a 6563 7420 6669   group object fi
+00012a60: 7273 742e 0a0a 2020 2020 2020 2020 466f  rst...        Fo
+00012a70: 7220 7468 6573 6520 6361 7365 732c 2074  r these cases, t
+00012a80: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00012a90: 2070 726f 7669 6465 7320 7468 6520 606d   provides the `m
+00012aa0: 756c 7469 5f70 6172 745f 696e 7365 7274  ulti_part_insert
+00012ab0: 6020 4150 492c 0a20 2020 2020 2020 2077  ` API,.        w
+00012ac0: 6869 6368 2069 7320 6f70 7469 6d69 7a65  hich is optimize
+00012ad0: 6420 666f 7220 7772 6974 696e 6720 6d61  d for writing ma
+00012ae0: 6e79 2073 6d61 6c6c 2044 6174 6166 7261  ny small Datafra
+00012af0: 6d65 7320 6166 7465 7220 616e 6f74 6865  mes after anothe
+00012b00: 722e 0a0a 2020 2020 2020 2020 5468 6572  r...        Ther
+00012b10: 6520 6172 6520 7477 6f20 7761 7973 2074  e are two ways t
+00012b20: 6f20 7573 6520 7468 6973 2041 5049 3a0a  o use this API:.
+00012b30: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
+00012b40: 706c 6520 2250 7974 686f 6e20 436f 6e74  ple "Python Cont
+00012b50: 6578 7420 4d61 6e61 6765 7222 0a20 2020  ext Manager".   
+00012b60: 2020 2020 2020 2020 2055 7369 6e67 2074           Using t
+00012b70: 6865 2050 7974 686f 6e20 6077 6974 6860  he Python `with`
+00012b80: 2073 796e 7461 7820 796f 7520 6361 6e20   syntax you can 
+00012b90: 6163 7175 6972 6520 6120 4665 6174 7572  acquire a Featur
+00012ba0: 6547 726f 7570 5772 6974 6572 0a20 2020  eGroupWriter.   
+00012bb0: 2020 2020 2020 2020 206f 626a 6563 7420           object 
+00012bc0: 7468 6174 2069 6d70 6c65 6d65 6e74 7320  that implements 
+00012bd0: 7468 6520 7361 6d65 2060 6d75 6c74 695f  the same `multi_
+00012be0: 7061 7274 5f69 6e73 6572 7460 2041 5049  part_insert` API
+00012bf0: 2e0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
+00012c00: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+00012c10: 2020 2020 6665 6174 7572 655f 6772 6f75      feature_grou
+00012c20: 7020 3d20 6673 2e67 6574 5f6f 725f 6372  p = fs.get_or_cr
+00012c30: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
+00012c40: 7570 2822 6667 5f6e 616d 6522 2c20 7665  up("fg_name", ve
+00012c50: 7273 696f 6e3d 3129 0a0a 2020 2020 2020  rsion=1)..      
+00012c60: 2020 2020 2020 7769 7468 2066 6561 7475        with featu
+00012c70: 7265 5f67 726f 7570 2e6d 756c 7469 5f70  re_group.multi_p
+00012c80: 6172 745f 696e 7365 7274 2829 2061 7320  art_insert() as 
+00012c90: 7772 6974 6572 3a0a 2020 2020 2020 2020  writer:.        
+00012ca0: 2020 2020 2020 2020 2320 7275 6e20 696e          # run in
+00012cb0: 7365 7274 7320 696e 2061 206c 6f6f 703a  serts in a loop:
+00012cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012cd0: 2077 6869 6c65 206c 6f6f 703a 0a20 2020   while loop:.   
+00012ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012cf0: 2073 6d61 6c6c 5f62 6174 6368 5f64 6620   small_batch_df 
+00012d00: 3d20 2e2e 2e0a 2020 2020 2020 2020 2020  = ....          
+00012d10: 2020 2020 2020 2020 2020 7772 6974 6572            writer
+00012d20: 2e69 6e73 6572 7428 736d 616c 6c5f 6261  .insert(small_ba
+00012d30: 7463 685f 6466 290a 2020 2020 2020 2020  tch_df).        
+00012d40: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00012d50: 2020 2020 5468 6520 7772 6974 6572 2062      The writer b
+00012d60: 6174 6368 6573 2074 6865 2073 6d61 6c6c  atches the small
+00012d70: 2044 6174 6166 7261 6d65 7320 616e 6420   Dataframes and 
+00012d80: 7472 616e 736d 6974 7320 7468 656d 2074  transmits them t
+00012d90: 6f20 486f 7073 776f 726b 730a 2020 2020  o Hopsworks.    
+00012da0: 2020 2020 2020 2020 6566 6669 6369 656e          efficien
+00012db0: 746c 792e 0a20 2020 2020 2020 2020 2020  tly..           
+00012dc0: 2057 6865 6e20 6578 6974 696e 6720 7468   When exiting th
+00012dd0: 6520 636f 6e74 6578 742c 2074 6865 2066  e context, the f
+00012de0: 6561 7475 7265 2067 726f 7570 2077 7269  eature group wri
+00012df0: 7465 7220 6973 2073 7572 6520 746f 2065  ter is sure to e
+00012e00: 7869 740a 2020 2020 2020 2020 2020 2020  xit.            
+00012e10: 6f6e 6c79 206f 6e63 6520 616c 6c20 7468  only once all th
+00012e20: 6520 726f 7773 2068 6176 6520 6265 656e  e rows have been
+00012e30: 2074 7261 6e73 6d69 7474 6564 2e0a 0a20   transmitted... 
+00012e40: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00012e50: 6c65 2022 4d75 6c74 6920 7061 7274 2069  le "Multi part i
+00012e60: 6e73 6572 7420 7769 7468 206d 616e 7561  nsert with manua
+00012e70: 6c20 636f 6e74 6578 7420 6d61 6e61 6765  l context manage
+00012e80: 6d65 6e74 220a 2020 2020 2020 2020 2020  ment".          
+00012e90: 2020 496e 7374 6561 6420 6f66 206c 6574    Instead of let
+00012ea0: 7469 6e67 2050 7974 686f 6e20 6861 6e64  ting Python hand
+00012eb0: 6c65 2074 6865 2065 6e74 6572 696e 6720  le the entering 
+00012ec0: 616e 6420 6578 6974 696e 6720 6f66 2074  and exiting of t
+00012ed0: 6865 0a20 2020 2020 2020 2020 2020 206d  he.            m
+00012ee0: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
+00012ef0: 2063 6f6e 7465 7874 2c20 796f 7520 6361   context, you ca
+00012f00: 6e20 7374 6172 7420 616e 6420 6669 6e61  n start and fina
+00012f10: 6c69 7a65 2074 6865 2063 6f6e 7465 7874  lize the context
+00012f20: 0a20 2020 2020 2020 2020 2020 206d 616e  .            man
+00012f30: 7561 6c6c 792e 0a20 2020 2020 2020 2020  ually..         
+00012f40: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+00012f50: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00012f60: 5f67 726f 7570 203d 2066 732e 6765 745f  _group = fs.get_
+00012f70: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
+00012f80: 655f 6772 6f75 7028 2266 675f 6e61 6d65  e_group("fg_name
+00012f90: 222c 2076 6572 7369 6f6e 3d31 290a 0a20  ", version=1).. 
+00012fa0: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+00012fb0: 206c 6f6f 703a 0a20 2020 2020 2020 2020   loop:.         
+00012fc0: 2020 2020 2020 2073 6d61 6c6c 5f62 6174         small_bat
+00012fd0: 6368 5f64 6620 3d20 2e2e 2e0a 2020 2020  ch_df = ....    
+00012fe0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00012ff0: 7572 655f 6772 6f75 702e 6d75 6c74 695f  ure_group.multi_
+00013000: 7061 7274 5f69 6e73 6572 7428 736d 616c  part_insert(smal
+00013010: 6c5f 6261 7463 685f 6466 290a 0a20 2020  l_batch_df)..   
+00013020: 2020 2020 2020 2020 2023 2049 4d50 4f52           # IMPOR
+00013030: 5441 4e54 3a20 6669 6e61 6c69 7a65 2074  TANT: finalize t
+00013040: 6865 206d 756c 7469 2070 6172 7420 696e  he multi part in
+00013050: 7365 7274 2074 6f20 6d61 6b65 2073 7572  sert to make sur
+00013060: 6520 616c 6c20 726f 7773 0a20 2020 2020  e all rows.     
+00013070: 2020 2020 2020 2023 2068 6176 6520 6265         # have be
+00013080: 656e 2074 7261 6e73 6d69 7474 6564 0a20  en transmitted. 
+00013090: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+000130a0: 7265 5f67 726f 7570 2e66 696e 616c 697a  re_group.finaliz
+000130b0: 655f 6d75 6c74 695f 7061 7274 5f69 6e73  e_multi_part_ins
+000130c0: 6572 7428 290a 2020 2020 2020 2020 2020  ert().          
+000130d0: 2020 6060 600a 2020 2020 2020 2020 2020    ```.          
+000130e0: 2020 4e6f 7465 2074 6861 7420 7468 6520    Note that the 
+000130f0: 6669 7273 7420 6361 6c6c 2074 6f20 606d  first call to `m
+00013100: 756c 7469 5f70 6172 745f 696e 7365 7274  ulti_part_insert
+00013110: 6020 696e 6974 6961 7465 7320 7468 6520  ` initiates the 
+00013120: 636f 6e74 6578 740a 2020 2020 2020 2020  context.        
+00013130: 2020 2020 616e 6420 6265 2073 7572 6520      and be sure 
+00013140: 746f 2066 696e 616c 697a 6520 6974 2e20  to finalize it. 
+00013150: 5468 6520 6066 696e 616c 697a 655f 6d75  The `finalize_mu
+00013160: 6c74 695f 7061 7274 5f69 6e73 6572 7460  lti_part_insert`
+00013170: 2069 7320 610a 2020 2020 2020 2020 2020   is a.          
+00013180: 2020 626c 6f63 6b69 6e67 2063 616c 6c20    blocking call 
+00013190: 7468 6174 2072 6574 7572 6e73 206f 6e63  that returns onc
+000131a0: 6520 616c 6c20 726f 7773 2068 6176 6520  e all rows have 
+000131b0: 6265 656e 2074 7261 6e73 6d69 7474 6564  been transmitted
+000131c0: 2e0a 0a20 2020 2020 2020 2020 2020 204f  ...            O
+000131d0: 6e63 6520 796f 7520 6172 6520 646f 6e65  nce you are done
+000131e0: 2077 6974 6820 7468 6520 6d75 6c74 6920   with the multi 
+000131f0: 7061 7274 2069 6e73 6572 742c 2069 7420  part insert, it 
+00013200: 6973 2067 6f6f 6420 7072 6163 7469 6365  is good practice
+00013210: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+00013220: 7374 6172 7420 7468 6520 6261 636b 6669  start the backfi
+00013230: 6c6c 206a 6f62 2069 6e20 6f72 6465 7220  ll job in order 
+00013240: 746f 2077 7269 7465 2074 6865 2064 6174  to write the dat
+00013250: 6120 746f 2074 6865 206f 6666 6c69 6e65  a to the offline
+00013260: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
+00013270: 7261 6765 3a0a 2020 2020 2020 2020 2020  rage:.          
+00013280: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+00013290: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+000132a0: 6772 6f75 702e 6261 636b 6669 6c6c 5f6a  group.backfill_j
+000132b0: 6f62 2e72 756e 2861 7761 6974 5f74 6572  ob.run(await_ter
+000132c0: 6d69 6e61 7469 6f6e 3d54 7275 6529 0a20  mination=True). 
+000132d0: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+000132e0: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+000132f0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+00013300: 6665 6174 7572 6573 3a20 4461 7461 4672  features: DataFr
+00013310: 616d 652c 2052 4444 2c20 4e64 6172 7261  ame, RDD, Ndarra
+00013320: 792c 206c 6973 742e 2046 6561 7475 7265  y, list. Feature
+00013330: 7320 746f 2062 6520 7361 7665 642e 0a20  s to be saved.. 
+00013340: 2020 2020 2020 2020 2020 206f 7665 7277             overw
+00013350: 7269 7465 3a20 4472 6f70 2061 6c6c 2064  rite: Drop all d
+00013360: 6174 6120 696e 2074 6865 2066 6561 7475  ata in the featu
+00013370: 7265 2067 726f 7570 2062 6566 6f72 650a  re group before.
+00013380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013390: 696e 7365 7274 696e 6720 6e65 7720 6461  inserting new da
+000133a0: 7461 2e20 5468 6973 2064 6f65 7320 6e6f  ta. This does no
+000133b0: 7420 6166 6665 6374 206d 6574 6164 6174  t affect metadat
+000133c0: 612c 2064 6566 6175 6c74 7320 746f 2046  a, defaults to F
+000133d0: 616c 7365 2e0a 2020 2020 2020 2020 2020  alse..          
+000133e0: 2020 6f70 6572 6174 696f 6e3a 2041 7061    operation: Apa
+000133f0: 6368 6520 4875 6469 206f 7065 7261 7469  che Hudi operati
+00013400: 6f6e 2074 7970 6520 6022 696e 7365 7274  on type `"insert
+00013410: 2260 206f 7220 6022 7570 7365 7274 2260  "` or `"upsert"`
+00013420: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013430: 2020 4465 6661 756c 7473 2074 6f20 6022    Defaults to `"
+00013440: 7570 7365 7274 2260 2e0a 2020 2020 2020  upsert"`..      
+00013450: 2020 2020 2020 7374 6f72 6167 653a 204f        storage: O
+00013460: 7665 7277 7269 7465 2064 6566 6175 6c74  verwrite default
+00013470: 2062 6568 6176 696f 7572 2c20 7772 6974   behaviour, writ
+00013480: 6520 746f 206f 6666 6c69 6e65 0a20 2020  e to offline.   
+00013490: 2020 2020 2020 2020 2020 2020 2073 746f               sto
+000134a0: 7261 6765 206f 6e6c 7920 7769 7468 2060  rage only with `
+000134b0: 226f 6666 6c69 6e65 2260 206f 7220 6f6e  "offline"` or on
+000134c0: 6c69 6e65 206f 6e6c 7920 7769 7468 2060  line only with `
+000134d0: 226f 6e6c 696e 6522 602c 2064 6566 6175  "online"`, defau
+000134e0: 6c74 730a 2020 2020 2020 2020 2020 2020  lts.            
+000134f0: 2020 2020 746f 2060 4e6f 6e65 602e 0a20      to `None`.. 
+00013500: 2020 2020 2020 2020 2020 2077 7269 7465             write
+00013510: 5f6f 7074 696f 6e73 3a20 4164 6469 7469  _options: Additi
+00013520: 6f6e 616c 2077 7269 7465 206f 7074 696f  onal write optio
+00013530: 6e73 2061 7320 6b65 792d 7661 6c75 6520  ns as key-value 
+00013540: 7061 6972 732c 2064 6566 6175 6c74 7320  pairs, defaults 
+00013550: 746f 2060 7b7d 602e 0a20 2020 2020 2020  to `{}`..       
+00013560: 2020 2020 2020 2020 2057 6865 6e20 7573           When us
+00013570: 696e 6720 7468 6520 6070 7974 686f 6e60  ing the `python`
+00013580: 2065 6e67 696e 652c 2077 7269 7465 5f6f   engine, write_o
+00013590: 7074 696f 6e73 2063 616e 2063 6f6e 7461  ptions can conta
+000135a0: 696e 2074 6865 0a20 2020 2020 2020 2020  in the.         
+000135b0: 2020 2020 2020 2066 6f6c 6c6f 7769 6e67         following
+000135c0: 2065 6e74 7269 6573 3a0a 2020 2020 2020   entries:.      
+000135d0: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
+000135e0: 6073 7061 726b 6020 616e 6420 7661 6c75  `spark` and valu
+000135f0: 6520 616e 206f 626a 6563 7420 6f66 2074  e an object of t
+00013600: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+00013610: 2020 2020 5b68 7366 732e 636f 7265 2e6a      [hsfs.core.j
+00013620: 6f62 5f63 6f6e 6669 6775 7261 7469 6f6e  ob_configuration
+00013630: 2e4a 6f62 436f 6e66 6967 7572 6174 696f  .JobConfiguratio
+00013640: 6e5d 282e 2e2f 6a6f 625f 636f 6e66 6967  n](../job_config
+00013650: 7572 6174 696f 6e29 0a20 2020 2020 2020  uration).       
+00013660: 2020 2020 2020 2020 2020 2074 6f20 636f             to co
+00013670: 6e66 6967 7572 6520 7468 6520 486f 7073  nfigure the Hops
+00013680: 776f 726b 7320 4a6f 6220 7573 6564 2074  works Job used t
+00013690: 6f20 7772 6974 6520 6461 7461 2069 6e74  o write data int
+000136a0: 6f20 7468 650a 2020 2020 2020 2020 2020  o the.          
+000136b0: 2020 2020 2020 2020 6665 6174 7572 6520          feature 
+000136c0: 6772 6f75 702e 0a20 2020 2020 2020 2020  group..         
+000136d0: 2020 2020 2020 202a 206b 6579 2060 7761         * key `wa
+000136e0: 6974 5f66 6f72 5f6a 6f62 6020 616e 6420  it_for_job` and 
+000136f0: 7661 6c75 6520 6054 7275 6560 206f 7220  value `True` or 
+00013700: 6046 616c 7365 6020 746f 2063 6f6e 6669  `False` to confi
+00013710: 6775 7265 0a20 2020 2020 2020 2020 2020  gure.           
+00013720: 2020 2020 2020 2077 6865 7468 6572 206f         whether o
+00013730: 7220 6e6f 7420 746f 2074 6865 2069 6e73  r not to the ins
+00013740: 6572 7420 6361 6c6c 2073 686f 756c 6420  ert call should 
+00013750: 7265 7475 726e 206f 6e6c 790a 2020 2020  return only.    
+00013760: 2020 2020 2020 2020 2020 2020 2020 6166                af
+00013770: 7465 7220 7468 6520 486f 7073 776f 726b  ter the Hopswork
+00013780: 7320 4a6f 6220 6861 7320 6669 6e69 7368  s Job has finish
+00013790: 6564 2e20 4279 2064 6566 6175 6c74 2069  ed. By default i
+000137a0: 7420 7761 6974 732e 0a20 2020 2020 2020  t waits..       
+000137b0: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
+000137c0: 7374 6172 745f 6f66 666c 696e 655f 6261  start_offline_ba
+000137d0: 636b 6669 6c6c 6020 616e 6420 7661 6c75  ckfill` and valu
+000137e0: 6520 6054 7275 6560 206f 7220 6046 616c  e `True` or `Fal
+000137f0: 7365 6020 746f 2063 6f6e 6669 6775 7265  se` to configure
+00013800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013810: 2020 2077 6865 7468 6572 206f 7220 6e6f     whether or no
+00013820: 7420 746f 2073 7461 7274 2074 6865 2062  t to start the b
+00013830: 6163 6b66 696c 6c20 6a6f 6220 746f 2077  ackfill job to w
+00013840: 7269 7465 2064 6174 6120 746f 2074 6865  rite data to the
+00013850: 206f 6666 6c69 6e65 0a20 2020 2020 2020   offline.       
+00013860: 2020 2020 2020 2020 2020 2073 746f 7261             stora
+00013870: 6765 2e20 4279 2064 6566 6175 6c74 2074  ge. By default t
+00013880: 6865 2062 6163 6b66 696c 6c20 6a6f 6220  he backfill job 
+00013890: 646f 6573 206e 6f74 2067 6574 2073 7461  does not get sta
+000138a0: 7274 6564 2061 7574 6f6d 6174 6963 616c  rted automatical
+000138b0: 6c79 0a20 2020 2020 2020 2020 2020 2020  ly.             
+000138c0: 2020 2020 2066 6f72 206d 756c 7469 2070       for multi p
+000138d0: 6172 7420 696e 7365 7274 732e 0a20 2020  art inserts..   
+000138e0: 2020 2020 2020 2020 2020 2020 202a 206b               * k
+000138f0: 6579 2060 696e 7465 726e 616c 5f6b 6166  ey `internal_kaf
+00013900: 6b61 6020 616e 6420 7661 6c75 6520 6054  ka` and value `T
+00013910: 7275 6560 206f 7220 6046 616c 7365 6020  rue` or `False` 
+00013920: 696e 2063 6173 6520 796f 7520 6573 7461  in case you esta
+00013930: 626c 6973 6865 640a 2020 2020 2020 2020  blished.        
+00013940: 2020 2020 2020 2020 2020 636f 6e6e 6563            connec
+00013950: 7469 7669 7479 2066 726f 6d20 796f 7520  tivity from you 
+00013960: 5079 7468 6f6e 2065 6e76 6972 6f6e 6d65  Python environme
+00013970: 6e74 2074 6f20 7468 6520 696e 7465 726e  nt to the intern
+00013980: 616c 2061 6476 6572 7469 7365 640a 2020  al advertised.  
+00013990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000139a0: 6c69 7374 656e 6572 7320 6f66 2074 6865  listeners of the
+000139b0: 2048 6f70 7377 6f72 6b73 204b 6166 6b61   Hopsworks Kafka
+000139c0: 2043 6c75 7374 6572 2e20 4465 6661 756c   Cluster. Defaul
+000139d0: 7473 2074 6f20 6046 616c 7365 6020 616e  ts to `False` an
+000139e0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+000139f0: 2020 2020 7769 6c6c 2075 7365 2065 7874      will use ext
+00013a00: 6572 6e61 6c20 6c69 7374 656e 6572 7320  ernal listeners 
+00013a10: 7768 656e 2063 6f6e 6e65 6374 696e 6720  when connecting 
+00013a20: 6672 6f6d 206f 7574 7369 6465 206f 6620  from outside of 
+00013a30: 486f 7073 776f 726b 732e 0a20 2020 2020  Hopsworks..     
+00013a40: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
+00013a50: 6e5f 6f70 7469 6f6e 733a 2041 6464 6974  n_options: Addit
+00013a60: 696f 6e61 6c20 7661 6c69 6461 7469 6f6e  ional validation
+00013a70: 206f 7074 696f 6e73 2061 7320 6b65 792d   options as key-
+00013a80: 7661 6c75 6520 7061 6972 732c 2064 6566  value pairs, def
+00013a90: 6175 6c74 7320 746f 2060 7b7d 602e 0a20  aults to `{}`.. 
+00013aa0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+00013ab0: 206b 6579 2060 7275 6e5f 7661 6c69 6461   key `run_valida
+00013ac0: 7469 6f6e 6020 626f 6f6c 6561 6e20 7661  tion` boolean va
+00013ad0: 6c75 652c 2073 6574 2074 6f20 6046 616c  lue, set to `Fal
+00013ae0: 7365 6020 746f 2073 6b69 7020 7661 6c69  se` to skip vali
+00013af0: 6461 7469 6f6e 2074 656d 706f 7261 7269  dation temporari
+00013b00: 6c79 206f 6e20 696e 6765 7374 696f 6e2e  ly on ingestion.
+00013b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013b20: 202a 206b 6579 2060 7361 7665 5f72 6570   * key `save_rep
+00013b30: 6f72 7460 2062 6f6f 6c65 616e 2076 616c  ort` boolean val
+00013b40: 7565 2c20 7365 7420 746f 2060 4661 6c73  ue, set to `Fals
+00013b50: 6560 2074 6f20 736b 6970 2075 706c 6f61  e` to skip uploa
+00013b60: 6420 6f66 2074 6865 2076 616c 6964 6174  d of the validat
+00013b70: 696f 6e20 7265 706f 7274 2074 6f20 486f  ion report to Ho
+00013b80: 7073 776f 726b 732e 0a20 2020 2020 2020  psworks..       
+00013b90: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
+00013ba0: 6765 5f76 616c 6964 6174 655f 6b77 6172  ge_validate_kwar
+00013bb0: 6773 6020 6120 6469 6374 696f 6e61 7279  gs` a dictionary
+00013bc0: 2063 6f6e 7461 696e 696e 6720 6b77 6172   containing kwar
+00013bd0: 6773 2066 6f72 2074 6865 2076 616c 6964  gs for the valid
+00013be0: 6174 6520 6d65 7468 6f64 206f 6620 4772  ate method of Gr
+00013bf0: 6561 7420 4578 7065 6374 6174 696f 6e73  eat Expectations
+00013c00: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00013c10: 2020 2a20 6b65 7920 6066 6574 6368 5f65    * key `fetch_e
+00013c20: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+00013c30: 6020 6120 626f 6f6c 6561 6e20 7661 6c75  ` a boolean valu
+00013c40: 652c 2062 7920 6465 6661 756c 7420 6046  e, by default `F
+00013c50: 616c 7365 6020 666f 7220 6d75 6c74 6920  alse` for multi 
+00013c60: 7061 7274 2069 6e73 6572 7473 2c0a 2020  part inserts,.  
+00013c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c80: 2074 6f20 636f 6e74 726f 6c20 7768 6574   to control whet
+00013c90: 6865 7220 7468 6520 6578 7065 6374 6174  her the expectat
+00013ca0: 696f 6e20 7375 6974 6520 6f66 2074 6865  ion suite of the
+00013cb0: 2066 6561 7475 7265 2067 726f 7570 2073   feature group s
+00013cc0: 686f 756c 6420 6265 2066 6574 6368 6564  hould be fetched
+00013cd0: 2062 6566 6f72 6520 6576 6572 7920 696e   before every in
+00013ce0: 7365 7274 2e0a 0a20 2020 2020 2020 2023  sert...        #
+00013cf0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00013d00: 2020 2020 2028 604a 6f62 602c 2060 5661       (`Job`, `Va
+00013d10: 6c69 6461 7469 6f6e 5265 706f 7274 6029  lidationReport`)
+00013d20: 2041 2074 7570 6c65 2077 6974 6820 6a6f   A tuple with jo
+00013d30: 6220 696e 666f 726d 6174 696f 6e20 6966  b information if
+00013d40: 2070 7974 686f 6e20 656e 6769 6e65 2069   python engine i
+00013d50: 7320 7573 6564 2061 6e64 2074 6865 2076  s used and the v
+00013d60: 616c 6964 6174 696f 6e20 7265 706f 7274  alidation report
+00013d70: 2069 6620 7661 6c69 6461 7469 6f6e 2069   if validation i
+00013d80: 7320 656e 6162 6c65 642e 0a20 2020 2020  s enabled..     
+00013d90: 2020 2020 2020 2060 4665 6174 7572 6547         `FeatureG
+00013da0: 726f 7570 5772 6974 6572 6020 5768 656e  roupWriter` When
+00013db0: 2075 7365 6420 6173 2061 2063 6f6e 7465   used as a conte
+00013dc0: 7874 206d 616e 6167 6572 2077 6974 6820  xt manager with 
+00013dd0: 5079 7468 6f6e 2060 7769 7468 6020 7374  Python `with` st
+00013de0: 6174 656d 656e 742e 0a20 2020 2020 2020  atement..       
+00013df0: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+00013e00: 662e 5f6d 756c 7469 5f70 6172 745f 696e  f._multi_part_in
+00013e10: 7365 7274 203d 2054 7275 650a 2020 2020  sert = True.    
+00013e20: 2020 2020 6d75 6c74 695f 7061 7274 5f77      multi_part_w
+00013e30: 7269 7465 7220 3d20 6665 6174 7572 655f  riter = feature_
+00013e40: 6772 6f75 705f 7772 6974 6572 2e46 6561  group_writer.Fea
+00013e50: 7475 7265 4772 6f75 7057 7269 7465 7228  tureGroupWriter(
+00013e60: 7365 6c66 290a 2020 2020 2020 2020 6966  self).        if
+00013e70: 2066 6561 7475 7265 7320 6973 204e 6f6e   features is Non
+00013e80: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00013e90: 6574 7572 6e20 6d75 6c74 695f 7061 7274  eturn multi_part
+00013ea0: 5f77 7269 7465 720a 2020 2020 2020 2020  _writer.        
+00013eb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00013ec0: 2020 2320 676f 2074 6872 6f75 6768 2077    # go through w
+00013ed0: 7269 7465 7220 746f 2061 766f 6964 2073  riter to avoid s
+00013ee0: 6574 7469 6e67 206d 756c 7469 2069 6e73  etting multi ins
+00013ef0: 6572 7420 6465 6661 756c 7473 2061 6761  ert defaults aga
+00013f00: 696e 0a20 2020 2020 2020 2020 2020 2072  in.            r
+00013f10: 6574 7572 6e20 6d75 6c74 695f 7061 7274  eturn multi_part
+00013f20: 5f77 7269 7465 722e 696e 7365 7274 280a  _writer.insert(.
+00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f40: 6665 6174 7572 6573 2c0a 2020 2020 2020  features,.      
+00013f50: 2020 2020 2020 2020 2020 6f76 6572 7772            overwr
+00013f60: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
+00013f70: 2020 2020 206f 7065 7261 7469 6f6e 2c0a       operation,.
+00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f90: 7374 6f72 6167 652c 0a20 2020 2020 2020  storage,.       
+00013fa0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
+00013fb0: 7074 696f 6e73 2c0a 2020 2020 2020 2020  ptions,.        
+00013fc0: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
+00013fd0: 6f6e 5f6f 7074 696f 6e73 2c0a 2020 2020  on_options,.    
+00013fe0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00013ff0: 6566 2066 696e 616c 697a 655f 6d75 6c74  ef finalize_mult
+00014000: 695f 7061 7274 5f69 6e73 6572 7428 7365  i_part_insert(se
+00014010: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+00014020: 4669 6e61 6c69 7a65 7320 616e 6420 6578  Finalizes and ex
+00014030: 6974 7320 7468 6520 6d75 6c74 6920 7061  its the multi pa
+00014040: 7274 2069 6e73 6572 7420 636f 6e74 6578  rt insert contex
+00014050: 7420 6f70 656e 6564 2062 7920 606d 756c  t opened by `mul
+00014060: 7469 5f70 6172 745f 696e 7365 7274 600a  ti_part_insert`.
+00014070: 2020 2020 2020 2020 696e 2061 2062 6c6f          in a blo
+00014080: 636b 696e 6720 6661 7368 696f 6e20 6f6e  cking fashion on
+00014090: 6365 2061 6c6c 2072 6f77 7320 6861 7665  ce all rows have
+000140a0: 2062 6565 6e20 7472 616e 736d 6974 7465   been transmitte
+000140b0: 642e 0a0a 2020 2020 2020 2020 2121 2120  d...        !!! 
+000140c0: 6578 616d 706c 6520 224d 756c 7469 2070  example "Multi p
+000140d0: 6172 7420 696e 7365 7274 2077 6974 6820  art insert with 
+000140e0: 6d61 6e75 616c 2063 6f6e 7465 7874 206d  manual context m
+000140f0: 616e 6167 656d 656e 7422 0a20 2020 2020  anagement".     
+00014100: 2020 2020 2020 2049 6e73 7465 6164 206f         Instead o
+00014110: 6620 6c65 7474 696e 6720 5079 7468 6f6e  f letting Python
+00014120: 2068 616e 646c 6520 7468 6520 656e 7465   handle the ente
+00014130: 7269 6e67 2061 6e64 2065 7869 7469 6e67  ring and exiting
+00014140: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
+00014150: 2020 2020 6d75 6c74 6920 7061 7274 2069      multi part i
+00014160: 6e73 6572 7420 636f 6e74 6578 742c 2079  nsert context, y
+00014170: 6f75 2063 616e 2073 7461 7274 2061 6e64  ou can start and
+00014180: 2066 696e 616c 697a 6520 7468 6520 636f   finalize the co
+00014190: 6e74 6578 740a 2020 2020 2020 2020 2020  ntext.          
+000141a0: 2020 6d61 6e75 616c 6c79 2e0a 2020 2020    manually..    
+000141b0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+000141c0: 6e0a 2020 2020 2020 2020 2020 2020 6665  n.            fe
+000141d0: 6174 7572 655f 6772 6f75 7020 3d20 6673  ature_group = fs
+000141e0: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
+000141f0: 6561 7475 7265 5f67 726f 7570 2822 6667  eature_group("fg
+00014200: 5f6e 616d 6522 2c20 7665 7273 696f 6e3d  _name", version=
+00014210: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
+00014220: 7768 696c 6520 6c6f 6f70 3a0a 2020 2020  while loop:.    
+00014230: 2020 2020 2020 2020 2020 2020 736d 616c              smal
+00014240: 6c5f 6261 7463 685f 6466 203d 202e 2e2e  l_batch_df = ...
+00014250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014260: 2066 6561 7475 7265 5f67 726f 7570 2e6d   feature_group.m
+00014270: 756c 7469 5f70 6172 745f 696e 7365 7274  ulti_part_insert
+00014280: 2873 6d61 6c6c 5f62 6174 6368 5f64 6629  (small_batch_df)
+00014290: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000142a0: 494d 504f 5254 414e 543a 2066 696e 616c  IMPORTANT: final
+000142b0: 697a 6520 7468 6520 6d75 6c74 6920 7061  ize the multi pa
+000142c0: 7274 2069 6e73 6572 7420 746f 206d 616b  rt insert to mak
+000142d0: 6520 7375 7265 2061 6c6c 2072 6f77 730a  e sure all rows.
+000142e0: 2020 2020 2020 2020 2020 2020 2320 6861              # ha
+000142f0: 7665 2062 6565 6e20 7472 616e 736d 6974  ve been transmit
+00014300: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
+00014310: 6665 6174 7572 655f 6772 6f75 702e 6669  feature_group.fi
+00014320: 6e61 6c69 7a65 5f6d 756c 7469 5f70 6172  nalize_multi_par
+00014330: 745f 696e 7365 7274 2829 0a20 2020 2020  t_insert().     
+00014340: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+00014350: 2020 2020 2020 204e 6f74 6520 7468 6174         Note that
+00014360: 2074 6865 2066 6972 7374 2063 616c 6c20   the first call 
+00014370: 746f 2060 6d75 6c74 695f 7061 7274 5f69  to `multi_part_i
+00014380: 6e73 6572 7460 2069 6e69 7469 6174 6573  nsert` initiates
+00014390: 2074 6865 2063 6f6e 7465 7874 0a20 2020   the context.   
+000143a0: 2020 2020 2020 2020 2061 6e64 2062 6520           and be 
+000143b0: 7375 7265 2074 6f20 6669 6e61 6c69 7a65  sure to finalize
+000143c0: 2069 742e 2054 6865 2060 6669 6e61 6c69   it. The `finali
+000143d0: 7a65 5f6d 756c 7469 5f70 6172 745f 696e  ze_multi_part_in
+000143e0: 7365 7274 6020 6973 2061 0a20 2020 2020  sert` is a.     
+000143f0: 2020 2020 2020 2062 6c6f 636b 696e 6720         blocking 
+00014400: 6361 6c6c 2074 6861 7420 7265 7475 726e  call that return
+00014410: 7320 6f6e 6365 2061 6c6c 2072 6f77 7320  s once all rows 
+00014420: 6861 7665 2062 6565 6e20 7472 616e 736d  have been transm
+00014430: 6974 7465 642e 0a20 2020 2020 2020 2022  itted..        "
+00014440: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
+00014450: 6c66 2e5f 6b61 666b 615f 7072 6f64 7563  lf._kafka_produc
+00014460: 6572 2069 7320 6e6f 7420 4e6f 6e65 3a0a  er is not None:.
+00014470: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00014480: 2e5f 6b61 666b 615f 7072 6f64 7563 6572  ._kafka_producer
+00014490: 2e66 6c75 7368 2829 0a20 2020 2020 2020  .flush().       
+000144a0: 2020 2020 2073 656c 662e 5f6b 6166 6b61       self._kafka
+000144b0: 5f70 726f 6475 6365 7220 3d20 4e6f 6e65  _producer = None
+000144c0: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+000144d0: 6561 7475 7265 5f77 7269 7465 7273 203d  eature_writers =
+000144e0: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+000144f0: 6c66 2e5f 7772 6974 6572 203d 204e 6f6e  lf._writer = Non
+00014500: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00014510: 6d75 6c74 695f 7061 7274 5f69 6e73 6572  multi_part_inser
+00014520: 7420 3d20 4661 6c73 650a 0a20 2020 2064  t = False..    d
+00014530: 6566 2069 6e73 6572 745f 7374 7265 616d  ef insert_stream
+00014540: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00014550: 2020 2020 2020 2020 6665 6174 7572 6573          features
+00014560: 3a20 5479 7065 5661 7228 2270 7973 7061  : TypeVar("pyspa
+00014570: 726b 2e73 716c 2e44 6174 6146 7261 6d65  rk.sql.DataFrame
+00014580: 2229 2c20 2023 206e 6f71 613a 2046 3832  "),  # noqa: F82
+00014590: 310a 2020 2020 2020 2020 7175 6572 795f  1.        query_
+000145a0: 6e61 6d65 3a20 4f70 7469 6f6e 616c 5b73  name: Optional[s
+000145b0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+000145c0: 2020 2020 6f75 7470 7574 5f6d 6f64 653a      output_mode:
+000145d0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+000145e0: 2022 6170 7065 6e64 222c 0a20 2020 2020   "append",.     
+000145f0: 2020 2061 7761 6974 5f74 6572 6d69 6e61     await_termina
+00014600: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b62  tion: Optional[b
+00014610: 6f6f 6c5d 203d 2046 616c 7365 2c0a 2020  ool] = False,.  
+00014620: 2020 2020 2020 7469 6d65 6f75 743a 204f        timeout: O
+00014630: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00014640: 6f6e 652c 0a20 2020 2020 2020 2063 6865  one,.        che
+00014650: 636b 706f 696e 745f 6469 723a 204f 7074  ckpoint_dir: Opt
+00014660: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+00014670: 652c 0a20 2020 2020 2020 2077 7269 7465  e,.        write
+00014680: 5f6f 7074 696f 6e73 3a20 4f70 7469 6f6e  _options: Option
+00014690: 616c 5b44 6963 745b 416e 792c 2041 6e79  al[Dict[Any, Any
+000146a0: 5d5d 203d 207b 7d2c 0a20 2020 2029 3a0a  ]] = {},.    ):.
+000146b0: 2020 2020 2020 2020 2222 2249 6e67 6573          """Inges
+000146c0: 7420 6120 5370 6172 6b20 5374 7275 6374  t a Spark Struct
+000146d0: 7572 6564 2053 7472 6561 6d69 6e67 2044  ured Streaming D
+000146e0: 6174 6166 7261 6d65 2074 6f20 7468 6520  ataframe to the 
+000146f0: 6f6e 6c69 6e65 2066 6561 7475 7265 2073  online feature s
+00014700: 746f 7265 2e0a 0a20 2020 2020 2020 2054  tore...        T
+00014710: 6869 7320 6d65 7468 6f64 2063 7265 6174  his method creat
+00014720: 6573 2061 206c 6f6e 6720 7275 6e6e 696e  es a long runnin
+00014730: 6720 5370 6172 6b20 5374 7265 616d 696e  g Spark Streamin
+00014740: 6720 5175 6572 792c 2079 6f75 2063 616e  g Query, you can
+00014750: 2063 6f6e 7472 6f6c 2074 6865 0a20 2020   control the.   
+00014760: 2020 2020 2074 6572 6d69 6e61 7469 6f6e       termination
+00014770: 206f 6620 7468 6520 7175 6572 7920 7468   of the query th
+00014780: 726f 7567 6820 7468 6520 6172 6775 6d65  rough the argume
+00014790: 6e74 732e 0a0a 2020 2020 2020 2020 4974  nts...        It
+000147a0: 2069 7320 706f 7373 6962 6c65 2074 6f20   is possible to 
+000147b0: 7374 6f70 2074 6865 2072 6574 7572 6e65  stop the returne
+000147c0: 6420 7175 6572 7920 7769 7468 2074 6865  d query with the
+000147d0: 2060 2e73 746f 7028 2960 2061 6e64 2063   `.stop()` and c
+000147e0: 6865 636b 2069 7473 0a20 2020 2020 2020  heck its.       
+000147f0: 2073 7461 7475 7320 7769 7468 2060 2e69   status with `.i
+00014800: 7341 6374 6976 6560 2e0a 0a20 2020 2020  sActive`...     
+00014810: 2020 2054 6f20 6765 7420 6120 6c69 7374     To get a list
+00014820: 206f 6620 616c 6c20 6163 7469 7665 2071   of all active q
+00014830: 7565 7269 6573 2c20 7573 653a 0a0a 2020  ueries, use:..  
+00014840: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00014850: 2020 2020 2020 2020 7371 6d20 3d20 7370          sqm = sp
+00014860: 6172 6b2e 7374 7265 616d 730a 0a20 2020  ark.streams..   
+00014870: 2020 2020 2023 2067 6574 2074 6865 206c       # get the l
+00014880: 6973 7420 6f66 2061 6374 6976 6520 7374  ist of active st
+00014890: 7265 616d 696e 6720 7175 6572 6965 730a  reaming queries.
+000148a0: 2020 2020 2020 2020 5b71 2e6e 616d 6520          [q.name 
+000148b0: 666f 7220 7120 696e 2073 716d 2e61 6374  for q in sqm.act
+000148c0: 6976 655d 0a20 2020 2020 2020 2060 6060  ive].        ```
+000148d0: 0a0a 2020 2020 2020 2020 2121 2120 7761  ..        !!! wa
+000148e0: 726e 696e 6720 2245 6e67 696e 6520 5375  rning "Engine Su
+000148f0: 7070 6f72 7422 0a20 2020 2020 2020 2020  pport".         
+00014900: 2020 202a 2a53 7061 726b 206f 6e6c 792a     **Spark only*
+00014910: 2a0a 0a20 2020 2020 2020 2020 2020 2053  *..            S
+00014920: 7472 6561 6d20 696e 6765 7374 696f 6e20  tream ingestion 
+00014930: 7573 696e 6720 5061 6e64 6173 2f50 7974  using Pandas/Pyt
+00014940: 686f 6e20 6173 2065 6e67 696e 6520 6973  hon as engine is
+00014950: 2063 7572 7265 6e74 6c79 206e 6f74 2073   currently not s
+00014960: 7570 706f 7274 6564 2e0a 2020 2020 2020  upported..      
+00014970: 2020 2020 2020 5079 7468 6f6e 2f50 616e        Python/Pan
+00014980: 6461 7320 6861 7320 6e6f 206e 6f74 696f  das has no notio
+00014990: 6e20 6f66 2073 7472 6561 6d69 6e67 2e0a  n of streaming..
+000149a0: 0a20 2020 2020 2020 2021 2121 2077 6172  .        !!! war
+000149b0: 6e69 6e67 2022 4461 7461 2056 616c 6964  ning "Data Valid
+000149c0: 6174 696f 6e20 5375 7070 6f72 7422 0a20  ation Support". 
+000149d0: 2020 2020 2020 2020 2020 2060 696e 7365             `inse
+000149e0: 7274 5f73 7472 6561 6d60 2064 6f65 7320  rt_stream` does 
+000149f0: 6e6f 7420 7065 7266 6f72 6d20 616e 7920  not perform any 
+00014a00: 6461 7461 2076 616c 6964 6174 696f 6e20  data validation 
+00014a10: 7573 696e 6720 4772 6561 7420 4578 7065  using Great Expe
+00014a20: 6374 6174 696f 6e73 0a20 2020 2020 2020  ctations.       
+00014a30: 2020 2020 2065 7665 6e20 7768 656e 2061       even when a
+00014a40: 2065 7870 6563 7461 7469 6f6e 2073 7569   expectation sui
+00014a50: 7465 2069 7320 6174 7461 6368 6564 2e0a  te is attached..
+00014a60: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
+00014a70: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+00014a80: 2066 6561 7475 7265 733a 2046 6561 7475   features: Featu
+00014a90: 7265 7320 696e 2053 7472 6561 6d69 6e67  res in Streaming
+00014aa0: 2044 6174 6166 7261 6d65 2074 6f20 6265   Dataframe to be
+00014ab0: 2073 6176 6564 2e0a 2020 2020 2020 2020   saved..        
+00014ac0: 2020 2020 7175 6572 795f 6e61 6d65 3a20      query_name: 
+00014ad0: 4974 2069 7320 706f 7373 6962 6c65 2074  It is possible t
+00014ae0: 6f20 6f70 7469 6f6e 616c 6c79 2073 7065  o optionally spe
+00014af0: 6369 6679 2061 206e 616d 6520 666f 7220  cify a name for 
+00014b00: 7468 6520 7175 6572 7920 746f 0a20 2020  the query to.   
+00014b10: 2020 2020 2020 2020 2020 2020 206d 616b               mak
+00014b20: 6520 6974 2065 6173 6965 7220 746f 2072  e it easier to r
+00014b30: 6563 6f67 6e69 7365 2069 6e20 7468 6520  ecognise in the 
+00014b40: 5370 6172 6b20 5549 2e20 4465 6661 756c  Spark UI. Defaul
+00014b50: 7473 2074 6f20 604e 6f6e 6560 2e0a 2020  ts to `None`..  
+00014b60: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+00014b70: 5f6d 6f64 653a 2053 7065 6369 6669 6573  _mode: Specifies
+00014b80: 2068 6f77 2064 6174 6120 6f66 2061 2073   how data of a s
+00014b90: 7472 6561 6d69 6e67 2044 6174 6146 7261  treaming DataFra
+00014ba0: 6d65 2f44 6174 6173 6574 2069 730a 2020  me/Dataset is.  
+00014bb0: 2020 2020 2020 2020 2020 2020 2020 7772                wr
+00014bc0: 6974 7465 6e20 746f 2061 2073 7472 6561  itten to a strea
+00014bd0: 6d69 6e67 2073 696e 6b2e 2028 3129 2060  ming sink. (1) `
+00014be0: 2261 7070 656e 6422 603a 204f 6e6c 7920  "append"`: Only 
+00014bf0: 7468 6520 6e65 7720 726f 7773 2069 6e20  the new rows in 
+00014c00: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00014c10: 2020 2020 7374 7265 616d 696e 6720 4461      streaming Da
+00014c20: 7461 4672 616d 652f 4461 7461 7365 7420  taFrame/Dataset 
+00014c30: 7769 6c6c 2062 6520 7772 6974 7465 6e20  will be written 
+00014c40: 746f 2074 6865 2073 696e 6b2e 2028 3229  to the sink. (2)
+00014c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014c60: 2060 2263 6f6d 706c 6574 6522 603a 2041   `"complete"`: A
+00014c70: 6c6c 2074 6865 2072 6f77 7320 696e 2074  ll the rows in t
+00014c80: 6865 2073 7472 6561 6d69 6e67 2044 6174  he streaming Dat
+00014c90: 6146 7261 6d65 2f44 6174 6173 6574 2077  aFrame/Dataset w
+00014ca0: 696c 6c20 6265 0a20 2020 2020 2020 2020  ill be.         
+00014cb0: 2020 2020 2020 2077 7269 7474 656e 2074         written t
+00014cc0: 6f20 7468 6520 7369 6e6b 2065 7665 7279  o the sink every
+00014cd0: 2074 696d 6520 7468 6572 6520 6973 2073   time there is s
+00014ce0: 6f6d 6520 7570 6461 7465 2e20 2833 2920  ome update. (3) 
+00014cf0: 6022 7570 6461 7465 2260 3a0a 2020 2020  `"update"`:.    
+00014d00: 2020 2020 2020 2020 2020 2020 6f6e 6c79              only
+00014d10: 2074 6865 2072 6f77 7320 7468 6174 2077   the rows that w
+00014d20: 6572 6520 7570 6461 7465 6420 696e 2074  ere updated in t
+00014d30: 6865 2073 7472 6561 6d69 6e67 2044 6174  he streaming Dat
+00014d40: 6146 7261 6d65 2f44 6174 6173 6574 2077  aFrame/Dataset w
+00014d50: 696c 6c0a 2020 2020 2020 2020 2020 2020  ill.            
+00014d60: 2020 2020 6265 2077 7269 7474 656e 2074      be written t
+00014d70: 6f20 7468 6520 7369 6e6b 2065 7665 7279  o the sink every
+00014d80: 2074 696d 6520 7468 6572 6520 6172 6520   time there are 
+00014d90: 736f 6d65 2075 7064 6174 6573 2e0a 2020  some updates..  
+00014da0: 2020 2020 2020 2020 2020 2020 2020 4966                If
+00014db0: 2074 6865 2071 7565 7279 2064 6f65 736e   the query doesn
+00014dc0: e280 9974 2063 6f6e 7461 696e 2061 6767  ...t contain agg
+00014dd0: 7265 6761 7469 6f6e 732c 2069 7420 7769  regations, it wi
+00014de0: 6c6c 2062 6520 6571 7569 7661 6c65 6e74  ll be equivalent
+00014df0: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
+00014e00: 2020 2020 6170 7065 6e64 206d 6f64 652e      append mode.
+00014e10: 2044 6566 6175 6c74 7320 746f 2060 2261   Defaults to `"a
+00014e20: 7070 656e 6422 602e 0a20 2020 2020 2020  ppend"`..       
+00014e30: 2020 2020 2061 7761 6974 5f74 6572 6d69       await_termi
+00014e40: 6e61 7469 6f6e 3a20 5761 6974 7320 666f  nation: Waits fo
+00014e50: 7220 7468 6520 7465 726d 696e 6174 696f  r the terminatio
+00014e60: 6e20 6f66 2074 6869 7320 7175 6572 792c  n of this query,
+00014e70: 2065 6974 6865 7220 6279 0a20 2020 2020   either by.     
+00014e80: 2020 2020 2020 2020 2020 2071 7565 7279             query
+00014e90: 2e73 746f 7028 2920 6f72 2062 7920 616e  .stop() or by an
+00014ea0: 2065 7863 6570 7469 6f6e 2e20 4966 2074   exception. If t
+00014eb0: 6865 2071 7565 7279 2068 6173 2074 6572  he query has ter
+00014ec0: 6d69 6e61 7465 6420 7769 7468 2061 6e0a  minated with an.
+00014ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ee0: 6578 6365 7074 696f 6e2c 2074 6865 6e20  exception, then 
+00014ef0: 7468 6520 6578 6365 7074 696f 6e20 7769  the exception wi
+00014f00: 6c6c 2062 6520 7468 726f 776e 2e20 4966  ll be thrown. If
+00014f10: 2074 696d 656f 7574 2069 7320 7365 742c   timeout is set,
+00014f20: 2069 740a 2020 2020 2020 2020 2020 2020   it.            
+00014f30: 2020 2020 7265 7475 726e 7320 7768 6574      returns whet
+00014f40: 6865 7220 7468 6520 7175 6572 7920 6861  her the query ha
+00014f50: 7320 7465 726d 696e 6174 6564 206f 7220  s terminated or 
+00014f60: 6e6f 7420 7769 7468 696e 2074 6865 2074  not within the t
+00014f70: 696d 656f 7574 0a20 2020 2020 2020 2020  imeout.         
+00014f80: 2020 2020 2020 2073 6563 6f6e 6473 2e20         seconds. 
+00014f90: 4465 6661 756c 7473 2074 6f20 6046 616c  Defaults to `Fal
+00014fa0: 7365 602e 0a20 2020 2020 2020 2020 2020  se`..           
+00014fb0: 2074 696d 656f 7574 3a20 4f6e 6c79 2072   timeout: Only r
+00014fc0: 656c 6576 616e 7420 696e 2063 6f6d 6269  elevant in combi
+00014fd0: 6e61 7469 6f6e 2077 6974 6820 6061 7761  nation with `awa
+00014fe0: 6974 5f74 6572 6d69 6e61 7469 6f6e 3d54  it_termination=T
+00014ff0: 7275 6560 2e0a 2020 2020 2020 2020 2020  rue`..          
+00015000: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
+00015010: 6f20 604e 6f6e 6560 2e0a 2020 2020 2020  o `None`..      
+00015020: 2020 2020 2020 6368 6563 6b70 6f69 6e74        checkpoint
+00015030: 5f64 6972 3a20 4368 6563 6b70 6f69 6e74  _dir: Checkpoint
+00015040: 2064 6972 6563 746f 7279 206c 6f63 6174   directory locat
+00015050: 696f 6e2e 2054 6869 7320 7769 6c6c 2062  ion. This will b
+00015060: 6520 7573 6564 2074 6f20 6173 2061 2072  e used to as a r
+00015070: 6566 6572 656e 6365 2074 6f0a 2020 2020  eference to.    
+00015080: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
+00015090: 2077 6865 7265 2074 6f20 7265 7375 6d65   where to resume
+000150a0: 2074 6865 2073 7472 6561 6d69 6e67 206a   the streaming j
+000150b0: 6f62 2e20 4966 2060 4e6f 6e65 6020 7468  ob. If `None` th
+000150c0: 656e 2068 7366 7320 7769 6c6c 2063 6f6e  en hsfs will con
+000150d0: 7374 7275 6374 2061 730a 2020 2020 2020  struct as.      
+000150e0: 2020 2020 2020 2020 2020 2269 6e73 6572            "inser
+000150f0: 745f 7374 7265 616d 5f22 202b 206f 6e6c  t_stream_" + onl
+00015100: 696e 655f 746f 7069 635f 6e61 6d65 2e20  ine_topic_name. 
+00015110: 4465 6661 756c 7473 2074 6f20 604e 6f6e  Defaults to `Non
+00015120: 6560 2e0a 2020 2020 2020 2020 2020 2020  e`..            
+00015130: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
+00015140: 733a 2041 6464 6974 696f 6e61 6c20 7772  s: Additional wr
+00015150: 6974 6520 6f70 7469 6f6e 7320 666f 7220  ite options for 
+00015160: 5370 6172 6b20 6173 206b 6579 2d76 616c  Spark as key-val
+00015170: 7565 2070 6169 7273 2e0a 2020 2020 2020  ue pairs..      
+00015180: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
+00015190: 7473 2074 6f20 607b 7d60 2e0a 0a20 2020  ts to `{}`...   
+000151a0: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
+000151b0: 2020 2020 2020 2020 2020 2060 5374 7265             `Stre
+000151c0: 616d 696e 6751 7565 7279 603a 2053 7061  amingQuery`: Spa
+000151d0: 726b 2053 7472 7563 7475 7265 6420 5374  rk Structured St
+000151e0: 7265 616d 696e 6720 5175 6572 7920 6f62  reaming Query ob
+000151f0: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
+00015200: 220a 2020 2020 2020 2020 6966 2028 0a20  ".        if (. 
+00015210: 2020 2020 2020 2020 2020 206e 6f74 2065             not e
+00015220: 6e67 696e 652e 6765 745f 696e 7374 616e  ngine.get_instan
+00015230: 6365 2829 2e69 735f 7370 6172 6b5f 6461  ce().is_spark_da
+00015240: 7461 6672 616d 6528 6665 6174 7572 6573  taframe(features
+00015250: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
+00015260: 206e 6f74 2066 6561 7475 7265 732e 6973   not features.is
+00015270: 5374 7265 616d 696e 670a 2020 2020 2020  Streaming.      
+00015280: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00015290: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+000152a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000152b0: 2020 2246 6561 7475 7265 7320 6861 7665    "Features have
+000152c0: 2074 6f20 6265 2061 2073 7472 6561 6d69   to be a streami
+000152d0: 6e67 2074 7970 6520 7370 6172 6b20 6461  ng type spark da
+000152e0: 7461 6672 616d 652e 2055 7365 2060 696e  taframe. Use `in
+000152f0: 7365 7274 2829 6020 6d65 7468 6f64 2069  sert()` method i
+00015300: 6e73 7465 6164 2e22 0a20 2020 2020 2020  nstead.".       
+00015310: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00015320: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00015330: 2023 206c 6f77 6572 2063 6173 696e 6720   # lower casing 
+00015340: 6665 6174 7572 6520 6e61 6d65 730a 2020  feature names.  
+00015350: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00015360: 655f 6461 7461 6672 616d 6520 3d20 656e  e_dataframe = en
+00015370: 6769 6e65 2e67 6574 5f69 6e73 7461 6e63  gine.get_instanc
+00015380: 6528 292e 636f 6e76 6572 745f 746f 5f64  e().convert_to_d
+00015390: 6566 6175 6c74 5f64 6174 6166 7261 6d65  efault_dataframe
+000153a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000153b0: 2020 6665 6174 7572 6573 0a20 2020 2020    features.     
+000153c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000153d0: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
+000153e0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+000153f0: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+00015400: 2020 2020 2020 2020 2020 2253 7472 6561            "Strea
+00015410: 6d20 696e 6765 7374 696f 6e20 666f 7220  m ingestion for 
+00015420: 6665 6174 7572 6520 6772 6f75 7020 607b  feature group `{
+00015430: 7d60 2c20 7769 7468 2076 6572 7369 6f6e  }`, with version
+00015440: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00015450: 2020 2020 2020 2220 607b 7d60 2077 696c        " `{}` wil
+00015460: 6c20 6e6f 7420 636f 6d70 7574 6520 7374  l not compute st
+00015470: 6174 6973 7469 6373 2e22 0a20 2020 2020  atistics.".     
+00015480: 2020 2020 2020 2020 2020 2029 2e66 6f72             ).for
+00015490: 6d61 7428 7365 6c66 2e5f 6e61 6d65 2c20  mat(self._name, 
+000154a0: 7365 6c66 2e5f 7665 7273 696f 6e29 2c0a  self._version),.
+000154b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154c0: 7574 696c 2e53 7461 7469 7374 6963 7357  util.StatisticsW
+000154d0: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+000154e0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+000154f0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00015500: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
+00015510: 6769 6e65 2e69 6e73 6572 745f 7374 7265  gine.insert_stre
+00015520: 616d 280a 2020 2020 2020 2020 2020 2020  am(.            
+00015530: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00015540: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00015550: 655f 6461 7461 6672 616d 652c 0a20 2020  e_dataframe,.   
+00015560: 2020 2020 2020 2020 2020 2020 2071 7565               que
+00015570: 7279 5f6e 616d 652c 0a20 2020 2020 2020  ry_name,.       
+00015580: 2020 2020 2020 2020 206f 7574 7075 745f           output_
+00015590: 6d6f 6465 2c0a 2020 2020 2020 2020 2020  mode,.          
+000155a0: 2020 2020 2020 6177 6169 745f 7465 726d        await_term
+000155b0: 696e 6174 696f 6e2c 0a20 2020 2020 2020  ination,.       
+000155c0: 2020 2020 2020 2020 2074 696d 656f 7574           timeout
+000155d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000155e0: 2020 6368 6563 6b70 6f69 6e74 5f64 6972    checkpoint_dir
+000155f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015600: 2020 7772 6974 655f 6f70 7469 6f6e 732c    write_options,
+00015610: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00015620: 2020 2020 6465 6620 636f 6d6d 6974 5f64      def commit_d
+00015630: 6574 6169 6c73 280a 2020 2020 2020 2020  etails(.        
+00015640: 7365 6c66 2c0a 2020 2020 2020 2020 7761  self,.        wa
+00015650: 6c6c 636c 6f63 6b5f 7469 6d65 3a20 4f70  llclock_time: Op
+00015660: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
+00015670: 2c20 696e 742c 2064 6174 6574 696d 652c  , int, datetime,
+00015680: 2064 6174 655d 5d20 3d20 4e6f 6e65 2c0a   date]] = None,.
+00015690: 2020 2020 2020 2020 6c69 6d69 743a 204f          limit: O
+000156a0: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+000156b0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+000156c0: 2020 2020 2222 2252 6574 7269 6576 6573      """Retrieves
+000156d0: 2063 6f6d 6d69 7420 7469 6d65 6c69 6e65   commit timeline
+000156e0: 2066 6f72 2074 6869 7320 6665 6174 7572   for this featur
+000156f0: 6520 6772 6f75 702e 2054 6869 7320 6d65  e group. This me
+00015700: 7468 6f64 2063 616e 206f 6e6c 7920 6265  thod can only be
+00015710: 2075 7365 640a 2020 2020 2020 2020 6f6e   used.        on
+00015720: 2074 696d 6520 7472 6176 656c 2065 6e61   time travel ena
+00015730: 626c 6564 2066 6561 7475 7265 2067 726f  bled feature gro
+00015740: 7570 730a 0a20 2020 2020 2020 2021 2121  ups..        !!!
+00015750: 2065 7861 6d70 6c65 0a20 2020 2020 2020   example.       
+00015760: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00015770: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
+00015780: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
+00015790: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
+000157a0: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
+000157b0: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
+000157c0: 7420 7468 6520 4665 6174 7572 6520 4772  t the Feature Gr
+000157d0: 6f75 7020 696e 7374 616e 6365 0a20 2020  oup instance.   
+000157e0: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
+000157f0: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
+00015800: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
+00015810: 290a 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00015820: 6f6d 6d69 745f 6465 7461 696c 7320 3d20  ommit_details = 
+00015830: 6667 2e63 6f6d 6d69 745f 6465 7461 696c  fg.commit_detail
+00015840: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00015850: 6060 600a 0a20 2020 2020 2020 2023 2041  ```..        # A
+00015860: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00015870: 2020 2020 2077 616c 6c63 6c6f 636b 5f74       wallclock_t
+00015880: 696d 653a 2043 6f6d 6d69 7420 6465 7461  ime: Commit deta
+00015890: 696c 7320 6173 206f 6620 7370 6563 6966  ils as of specif
+000158a0: 6963 2070 6f69 6e74 2069 6e20 7469 6d65  ic point in time
+000158b0: 2e20 4465 6661 756c 7473 2074 6f20 604e  . Defaults to `N
+000158c0: 6f6e 6560 2e0a 2020 2020 2020 2020 2020  one`..          
+000158d0: 2020 2020 2020 2053 7472 696e 6773 2073         Strings s
+000158e0: 686f 756c 6420 6265 2066 6f72 6d61 7474  hould be formatt
+000158f0: 6564 2069 6e20 6f6e 6520 6f66 2074 6865  ed in one of the
+00015900: 2066 6f6c 6c6f 7769 6e67 2066 6f72 6d61   following forma
+00015910: 7473 2060 2559 2d25 6d2d 2564 602c 2060  ts `%Y-%m-%d`, `
+00015920: 2559 2d25 6d2d 2564 2025 4860 2c20 6025  %Y-%m-%d %H`, `%
+00015930: 592d 256d 2d25 6420 2548 3a25 4d60 2c0a  Y-%m-%d %H:%M`,.
+00015940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015950: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
+00015960: 2553 602c 206f 7220 6025 592d 256d 2d25  %S`, or `%Y-%m-%
+00015970: 6420 2548 3a25 4d3a 2553 2e25 6660 2e0a  d %H:%M:%S.%f`..
+00015980: 2020 2020 2020 2020 2020 2020 6c69 6d69              limi
+00015990: 743a 204e 756d 6265 7220 6f66 2063 6f6d  t: Number of com
+000159a0: 6d69 7473 2074 6f20 7265 7472 6965 7665  mits to retrieve
+000159b0: 2e20 4465 6661 756c 7473 2074 6f20 604e  . Defaults to `N
+000159c0: 6f6e 6560 2e0a 0a20 2020 2020 2020 2023  one`...        #
+000159d0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+000159e0: 2020 2020 2060 4469 6374 5b73 7472 2c20       `Dict[str, 
+000159f0: 4469 6374 5b73 7472 2c20 7374 725d 5d60  Dict[str, str]]`
+00015a00: 2e20 4469 6374 696f 6e61 7279 206f 626a  . Dictionary obj
+00015a10: 6563 7420 6f66 2063 6f6d 6d69 7420 6d65  ect of commit me
+00015a20: 7461 6461 7461 2074 696d 656c 696e 652c  tadata timeline,
+00015a30: 2077 6865 7265 204b 6579 2069 7320 636f   where Key is co
+00015a40: 6d6d 6974 2069 6420 616e 6420 7661 6c75  mmit id and valu
+00015a50: 650a 2020 2020 2020 2020 2020 2020 6973  e.            is
+00015a60: 2060 4469 6374 5b73 7472 2c20 7374 725d   `Dict[str, str]
+00015a70: 6020 7769 7468 206b 6579 2076 616c 7565  ` with key value
+00015a80: 2070 6169 7273 206f 6620 6461 7465 2063   pairs of date c
+00015a90: 6f6d 6d69 7474 6564 206f 6e2c 206e 756d  ommitted on, num
+00015aa0: 6265 7220 6f66 2072 6f77 7320 7570 6461  ber of rows upda
+00015ab0: 7465 642c 2069 6e73 6572 7465 6420 616e  ted, inserted an
+00015ac0: 6420 6465 6c65 7465 642e 0a0a 2020 2020  d deleted...    
+00015ad0: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+00015ae0: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+00015af0: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+00015b00: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
+00015b10: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
+00015b20: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
+00015b30: 6f6e 732e 4665 6174 7572 6553 746f 7265  ons.FeatureStore
+00015b40: 4578 6365 7074 696f 6e60 2e20 4966 2074  Exception`. If t
+00015b50: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00015b60: 2064 6f65 7320 6e6f 7420 6861 7665 2060   does not have `
+00015b70: 4855 4449 6020 7469 6d65 2074 7261 7665  HUDI` time trave
+00015b80: 6c20 666f 726d 6174 0a20 2020 2020 2020  l format.       
+00015b90: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00015ba0: 7572 6e20 7365 6c66 2e5f 6665 6174 7572  urn self._featur
+00015bb0: 655f 6772 6f75 705f 656e 6769 6e65 2e63  e_group_engine.c
+00015bc0: 6f6d 6d69 745f 6465 7461 696c 7328 7365  ommit_details(se
+00015bd0: 6c66 2c20 7761 6c6c 636c 6f63 6b5f 7469  lf, wallclock_ti
+00015be0: 6d65 2c20 6c69 6d69 7429 0a0a 2020 2020  me, limit)..    
+00015bf0: 6465 6620 636f 6d6d 6974 5f64 656c 6574  def commit_delet
+00015c00: 655f 7265 636f 7264 280a 2020 2020 2020  e_record(.      
+00015c10: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00015c20: 6465 6c65 7465 5f64 663a 2054 7970 6556  delete_df: TypeV
+00015c30: 6172 2822 7079 7370 6172 6b2e 7371 6c2e  ar("pyspark.sql.
+00015c40: 4461 7461 4672 616d 6522 292c 2020 2320  DataFrame"),  # 
+00015c50: 6e6f 7161 3a20 4638 3231 0a20 2020 2020  noqa: F821.     
+00015c60: 2020 2077 7269 7465 5f6f 7074 696f 6e73     write_options
+00015c70: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
+00015c80: 416e 792c 2041 6e79 5d5d 203d 207b 7d2c  Any, Any]] = {},
+00015c90: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00015ca0: 2222 2244 726f 7073 2072 6563 6f72 6473  """Drops records
+00015cb0: 2070 7265 7365 6e74 2069 6e20 7468 6520   present in the 
+00015cc0: 7072 6f76 6964 6564 2044 6174 6146 7261  provided DataFra
+00015cd0: 6d65 2061 6e64 2063 6f6d 6d69 7473 2069  me and commits i
+00015ce0: 7420 6173 2075 7064 6174 6520 746f 2074  t as update to t
+00015cf0: 6869 730a 2020 2020 2020 2020 4665 6174  his.        Feat
+00015d00: 7572 6520 6772 6f75 702e 2054 6869 7320  ure group. This 
+00015d10: 6d65 7468 6f64 2063 616e 206f 6e6c 7920  method can only 
+00015d20: 6265 2075 7365 6420 6f6e 2074 696d 6520  be used on time 
+00015d30: 7472 6176 656c 2065 6e61 626c 6564 2066  travel enabled f
+00015d40: 6561 7475 7265 2067 726f 7570 732e 0a0a  eature groups...
+00015d50: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+00015d60: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+00015d70: 6465 6c65 7465 5f64 663a 2064 6174 6146  delete_df: dataF
+00015d80: 7261 6d65 2063 6f6e 7461 696e 696e 6720  rame containing 
+00015d90: 7265 636f 7264 7320 746f 2062 6520 6465  records to be de
+00015da0: 6c65 7465 642e 0a20 2020 2020 2020 2020  leted..         
+00015db0: 2020 2077 7269 7465 5f6f 7074 696f 6e73     write_options
+00015dc0: 3a20 5573 6572 2070 726f 7669 6465 6420  : User provided 
+00015dd0: 7772 6974 6520 6f70 7469 6f6e 732e 2044  write options. D
+00015de0: 6566 6175 6c74 7320 746f 2060 7b7d 602e  efaults to `{}`.
+00015df0: 0a0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
+00015e00: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
+00015e10: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
+00015e20: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
+00015e30: 726f 7260 2e0a 2020 2020 2020 2020 2222  ror`..        ""
+00015e40: 220a 2020 2020 2020 2020 7365 6c66 2e5f  ".        self._
+00015e50: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
+00015e60: 6769 6e65 2e63 6f6d 6d69 745f 6465 6c65  gine.commit_dele
+00015e70: 7465 2873 656c 662c 2064 656c 6574 655f  te(self, delete_
+00015e80: 6466 2c20 7772 6974 655f 6f70 7469 6f6e  df, write_option
+00015e90: 7329 0a0a 2020 2020 6465 6620 6173 5f6f  s)..    def as_o
+00015ea0: 6628 0a20 2020 2020 2020 2073 656c 662c  f(.        self,
+00015eb0: 0a20 2020 2020 2020 2077 616c 6c63 6c6f  .        wallclo
+00015ec0: 636b 5f74 696d 653a 204f 7074 696f 6e61  ck_time: Optiona
+00015ed0: 6c5b 556e 696f 6e5b 7374 722c 2069 6e74  l[Union[str, int
+00015ee0: 2c20 6461 7465 7469 6d65 2c20 6461 7465  , datetime, date
+00015ef0: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
+00015f00: 2020 2065 7863 6c75 6465 5f75 6e74 696c     exclude_until
+00015f10: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+00015f20: 5b73 7472 2c20 696e 742c 2064 6174 6574  [str, int, datet
+00015f30: 696d 652c 2064 6174 655d 5d20 3d20 4e6f  ime, date]] = No
+00015f40: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+00015f50: 2020 2022 2222 4765 7420 5175 6572 7920     """Get Query 
+00015f60: 6f62 6a65 6374 2074 6f20 7265 7472 6965  object to retrie
+00015f70: 7665 2061 6c6c 2066 6561 7475 7265 7320  ve all features 
+00015f80: 6f66 2074 6865 2067 726f 7570 2061 7420  of the group at 
+00015f90: 6120 706f 696e 7420 696e 2074 6865 2070  a point in the p
+00015fa0: 6173 742e 0a0a 2020 2020 2020 2020 5468  ast...        Th
+00015fb0: 6973 206d 6574 686f 6420 7365 6c65 6374  is method select
+00015fc0: 7320 616c 6c20 6665 6174 7572 6573 2069  s all features i
+00015fd0: 6e20 7468 6520 6665 6174 7572 6520 6772  n the feature gr
+00015fe0: 6f75 7020 616e 6420 7265 7475 726e 7320  oup and returns 
+00015ff0: 6120 5175 6572 7920 6f62 6a65 6374 0a20  a Query object. 
+00016000: 2020 2020 2020 2061 7420 7468 6520 7370         at the sp
+00016010: 6563 6966 6965 6420 706f 696e 7420 696e  ecified point in
+00016020: 2074 696d 652e 204f 7074 696f 6e61 6c6c   time. Optionall
+00016030: 792c 2063 6f6d 6d69 7473 2062 6566 6f72  y, commits befor
+00016040: 6520 6120 7370 6563 6966 6965 6420 706f  e a specified po
+00016050: 696e 7420 696e 2074 696d 6520 6361 6e20  int in time can 
+00016060: 6265 0a20 2020 2020 2020 2065 7863 6c75  be.        exclu
+00016070: 6465 6420 6672 6f6d 2074 6865 2071 7565  ded from the que
+00016080: 7279 2e20 5468 6520 5175 6572 7920 6361  ry. The Query ca
+00016090: 6e20 7468 656e 2065 6974 6865 7220 6265  n then either be
+000160a0: 2072 6561 6420 696e 746f 2061 2044 6174   read into a Dat
+000160b0: 6166 7261 6d65 0a20 2020 2020 2020 206f  aframe.        o
+000160c0: 7220 7573 6564 2066 7572 7468 6572 2074  r used further t
+000160d0: 6f20 7065 7266 6f72 6d20 6a6f 696e 7320  o perform joins 
+000160e0: 6f72 2063 6f6e 7374 7275 6374 2061 2074  or construct a t
+000160f0: 7261 696e 696e 6720 6461 7461 7365 742e  raining dataset.
+00016100: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
+00016110: 616d 706c 6520 2252 6561 6469 6e67 2066  ample "Reading f
+00016120: 6561 7475 7265 7320 6174 2061 2073 7065  eatures at a spe
+00016130: 6369 6669 6320 706f 696e 7420 696e 2074  cific point in t
+00016140: 696d 653a 220a 2020 2020 2020 2020 2020  ime:".          
+00016150: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+00016160: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
+00016170: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
+00016180: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
+00016190: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
+000161a0: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
+000161b0: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
+000161c0: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
+000161d0: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
+000161e0: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
+000161f0: 7572 655f 6772 6f75 7028 2e2e 2e29 0a0a  ure_group(...)..
+00016200: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
+00016210: 7420 6461 7461 2061 7420 6120 7370 6563  t data at a spec
+00016220: 6966 6963 2070 6f69 6e74 2069 6e20 7469  ific point in ti
+00016230: 6d65 2061 6e64 2073 686f 7720 6974 0a20  me and show it. 
+00016240: 2020 2020 2020 2020 2020 2066 672e 6173             fg.as
+00016250: 5f6f 6628 2232 3032 302d 3130 2d32 3020  _of("2020-10-20 
+00016260: 3037 3a33 343a 3131 2229 2e72 6561 6428  07:34:11").read(
+00016270: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00016280: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00016290: 2020 2121 2120 6578 616d 706c 6520 2252    !!! example "R
+000162a0: 6561 6469 6e67 2063 6f6d 6d69 7473 2069  eading commits i
+000162b0: 6e63 7265 6d65 6e74 616c 6c79 2062 6574  ncrementally bet
+000162c0: 7765 656e 2073 7065 6369 6669 6564 2070  ween specified p
+000162d0: 6f69 6e74 7320 696e 2074 696d 653a 220a  oints in time:".
+000162e0: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+000162f0: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
+00016300: 2020 6667 2e61 735f 6f66 2822 3230 3230    fg.as_of("2020
+00016310: 2d31 302d 3230 2030 373a 3334 3a31 3122  -10-20 07:34:11"
+00016320: 2c20 6578 636c 7564 655f 756e 7469 6c3d  , exclude_until=
+00016330: 2232 3032 302d 3130 2d31 3920 3037 3a33  "2020-10-19 07:3
+00016340: 343a 3131 2229 2e72 6561 6428 292e 7368  4:11").read().sh
+00016350: 6f77 2829 0a20 2020 2020 2020 2020 2020  ow().           
+00016360: 2060 6060 0a0a 2020 2020 2020 2020 5468   ```..        Th
+00016370: 6520 6669 7273 7420 7061 7261 6d65 7465  e first paramete
+00016380: 7220 6973 2069 6e63 6c75 7369 7665 2077  r is inclusive w
+00016390: 6869 6c65 2074 6865 206c 6174 7465 7220  hile the latter 
+000163a0: 6973 2065 7863 6c75 7369 7665 2e0a 2020  is exclusive..  
+000163b0: 2020 2020 2020 5468 6174 206d 6561 6e73        That means
+000163c0: 2c20 696e 206f 7264 6572 2074 6f20 7175  , in order to qu
+000163d0: 6572 7920 6120 7369 6e67 6c65 2063 6f6d  ery a single com
+000163e0: 6d69 742c 2079 6f75 206e 6565 6420 746f  mit, you need to
+000163f0: 2071 7565 7279 2074 6861 7420 636f 6d6d   query that comm
+00016400: 6974 2074 696d 650a 2020 2020 2020 2020  it time.        
+00016410: 616e 6420 6578 636c 7564 6520 6576 6572  and exclude ever
+00016420: 7974 6869 6e67 206a 7573 7420 6265 666f  ything just befo
+00016430: 7265 2074 6865 2063 6f6d 6d69 742e 0a0a  re the commit...
+00016440: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
+00016450: 706c 6520 2252 6561 6469 6e67 206f 6e6c  ple "Reading onl
+00016460: 7920 7468 6520 6368 616e 6765 7320 6672  y the changes fr
+00016470: 6f6d 2061 2073 696e 676c 6520 636f 6d6d  om a single comm
+00016480: 6974 220a 2020 2020 2020 2020 2020 2020  it".            
+00016490: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+000164a0: 2020 2020 2020 6667 2e61 735f 6f66 2822        fg.as_of("
+000164b0: 3230 3230 2d31 302d 3230 2030 373a 3331  2020-10-20 07:31
+000164c0: 3a33 3822 2c20 6578 636c 7564 655f 756e  :38", exclude_un
+000164d0: 7469 6c3d 2232 3032 302d 3130 2d32 3020  til="2020-10-20 
+000164e0: 3037 3a33 313a 3337 2229 2e72 6561 6428  07:31:37").read(
+000164f0: 292e 7368 6f77 2829 0a20 2020 2020 2020  ).show().       
+00016500: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00016510: 2020 5768 656e 206e 6f20 7761 6c6c 636c    When no wallcl
+00016520: 6f63 6b5f 7469 6d65 2069 7320 6769 7665  ock_time is give
+00016530: 6e2c 2074 6865 206c 6174 6573 7420 7374  n, the latest st
+00016540: 6174 6520 6f66 2066 6561 7475 7265 7320  ate of features 
+00016550: 6973 2072 6574 7572 6e65 642e 204f 7074  is returned. Opt
+00016560: 696f 6e61 6c6c 792c 2063 6f6d 6d69 7473  ionally, commits
+00016570: 2062 6566 6f72 650a 2020 2020 2020 2020   before.        
+00016580: 6120 7370 6563 6966 6965 6420 706f 696e  a specified poin
+00016590: 7420 696e 2074 696d 6520 6361 6e20 7374  t in time can st
+000165a0: 696c 6c20 6265 2065 7863 6c75 6465 642e  ill be excluded.
+000165b0: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
+000165c0: 616d 706c 6520 2252 6561 6469 6e67 2074  ample "Reading t
+000165d0: 6865 206c 6174 6573 7420 7374 6174 6520  he latest state 
+000165e0: 6f66 2066 6561 7475 7265 732c 2065 7863  of features, exc
+000165f0: 6c75 6469 6e67 2063 6f6d 6d69 7473 2062  luding commits b
+00016600: 6566 6f72 6520 6120 7370 6563 6966 6965  efore a specifie
+00016610: 6420 706f 696e 7420 696e 2074 696d 653a  d point in time:
+00016620: 220a 2020 2020 2020 2020 2020 2020 6060  ".            ``
+00016630: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+00016640: 2020 2020 6667 2e61 735f 6f66 284e 6f6e      fg.as_of(Non
+00016650: 652c 2065 7863 6c75 6465 5f75 6e74 696c  e, exclude_until
+00016660: 3d22 3230 3230 2d31 302d 3230 2030 373a  ="2020-10-20 07:
+00016670: 3331 3a33 3822 292e 7265 6164 2829 2e73  31:38").read().s
+00016680: 686f 7728 290a 2020 2020 2020 2020 2020  how().          
+00016690: 2020 6060 600a 0a20 2020 2020 2020 204e    ```..        N
+000166a0: 6f74 6520 7468 6174 2074 6865 2069 6e74  ote that the int
+000166b0: 6572 7661 6c20 7769 6c6c 2062 6520 6170  erval will be ap
+000166c0: 706c 6965 6420 746f 2061 6c6c 206a 6f69  plied to all joi
+000166d0: 6e73 2069 6e20 7468 6520 7175 6572 792e  ns in the query.
+000166e0: 0a20 2020 2020 2020 2049 6620 796f 7520  .        If you 
+000166f0: 7761 6e74 2074 6f20 7175 6572 7920 6469  want to query di
+00016700: 6666 6572 656e 7420 696e 7465 7276 616c  fferent interval
+00016710: 7320 666f 7220 6469 6666 6572 656e 7420  s for different 
+00016720: 6665 6174 7572 6520 6772 6f75 7073 2069  feature groups i
+00016730: 6e0a 2020 2020 2020 2020 7468 6520 7175  n.        the qu
+00016740: 6572 792c 2079 6f75 2068 6176 6520 746f  ery, you have to
+00016750: 2061 7070 6c79 2074 6865 6d20 696e 2061   apply them in a
+00016760: 206e 6573 7465 6420 6661 7368 696f 6e3a   nested fashion:
+00016770: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+00016780: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+00016790: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+000167a0: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+000167b0: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+000167c0: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+000167d0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+000167e0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+000167f0: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+00016800: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+00016810: 2020 2020 2066 6731 203d 2066 732e 6765       fg1 = fs.ge
+00016820: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
+00016830: 7572 655f 6772 6f75 7028 2e2e 2e29 0a20  ure_group(...). 
+00016840: 2020 2020 2020 2020 2020 2066 6732 203d             fg2 =
+00016850: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
+00016860: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
+00016870: 2e2e 2e29 0a0a 2020 2020 2020 2020 2020  ...)..          
+00016880: 2020 6667 312e 7365 6c65 6374 5f61 6c6c    fg1.select_all
+00016890: 2829 2e61 735f 6f66 2822 3230 3230 2d31  ().as_of("2020-1
+000168a0: 302d 3230 222c 2065 7863 6c75 6465 5f75  0-20", exclude_u
+000168b0: 6e74 696c 3d22 3230 3230 2d31 302d 3139  ntil="2020-10-19
+000168c0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+000168d0: 2020 202e 6a6f 696e 2866 6732 2e73 656c     .join(fg2.sel
+000168e0: 6563 745f 616c 6c28 292e 6173 5f6f 6628  ect_all().as_of(
+000168f0: 2232 3032 302d 3130 2d32 3022 2c20 6578  "2020-10-20", ex
+00016900: 636c 7564 655f 756e 7469 6c3d 2232 3032  clude_until="202
+00016910: 302d 3130 2d31 3922 2929 0a20 2020 2020  0-10-19")).     
+00016920: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
+00016930: 2020 2020 4966 2069 6e73 7465 6164 2079      If instead y
+00016940: 6f75 2061 7070 6c79 2061 6e6f 7468 6572  ou apply another
+00016950: 2060 6173 5f6f 6660 2073 656c 6563 7469   `as_of` selecti
+00016960: 6f6e 2061 6674 6572 2074 6865 206a 6f69  on after the joi
+00016970: 6e2c 2061 6c6c 0a20 2020 2020 2020 206a  n, all.        j
+00016980: 6f69 6e65 6420 6665 6174 7572 6520 6772  oined feature gr
+00016990: 6f75 7073 2077 696c 6c20 6265 2071 7565  oups will be que
+000169a0: 7269 6564 2077 6974 6820 7468 6973 2069  ried with this i
+000169b0: 6e74 6572 7661 6c3a 0a20 2020 2020 2020  nterval:.       
+000169c0: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+000169d0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+000169e0: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
+000169f0: 6731 2e73 656c 6563 745f 616c 6c28 292e  g1.select_all().
+00016a00: 6173 5f6f 6628 2232 3032 302d 3130 2d32  as_of("2020-10-2
+00016a10: 3022 2c20 6578 636c 7564 655f 756e 7469  0", exclude_unti
+00016a20: 6c3d 2232 3032 302d 3130 2d31 3922 2920  l="2020-10-19") 
+00016a30: 2023 2061 735f 6f66 2069 7320 6e6f 7420   # as_of is not 
+00016a40: 6170 706c 6965 640a 2020 2020 2020 2020  applied.        
+00016a50: 2020 2020 2020 2020 2e6a 6f69 6e28 6667          .join(fg
+00016a60: 322e 7365 6c65 6374 5f61 6c6c 2829 2e61  2.select_all().a
+00016a70: 735f 6f66 2822 3230 3230 2d31 302d 3230  s_of("2020-10-20
+00016a80: 222c 2065 7863 6c75 6465 5f75 6e74 696c  ", exclude_until
+00016a90: 3d22 3230 3230 2d31 302d 3135 2229 2920  ="2020-10-15")) 
+00016aa0: 2023 2061 735f 6f66 2069 7320 6e6f 7420   # as_of is not 
+00016ab0: 6170 706c 6965 640a 2020 2020 2020 2020  applied.        
+00016ac0: 2020 2020 2020 2020 2e61 735f 6f66 2822          .as_of("
+00016ad0: 3230 3230 2d31 302d 3230 222c 2065 7863  2020-10-20", exc
+00016ae0: 6c75 6465 5f75 6e74 696c 3d22 3230 3230  lude_until="2020
+00016af0: 2d31 302d 3139 2229 0a20 2020 2020 2020  -10-19").       
+00016b00: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00016b10: 2020 2121 2120 7761 726e 696e 670a 2020    !!! warning.  
+00016b20: 2020 2020 2020 2020 2020 5468 6973 2066            This f
+00016b30: 756e 6374 696f 6e20 6f6e 6c79 2077 6f72  unction only wor
+00016b40: 6b73 2066 6f72 2066 6561 7475 7265 2067  ks for feature g
+00016b50: 726f 7570 7320 7769 7468 2074 696d 655f  roups with time_
+00016b60: 7472 6176 656c 5f66 6f72 6d61 743d 2748  travel_format='H
+00016b70: 5544 4927 2e0a 0a20 2020 2020 2020 2021  UDI'...        !
+00016b80: 2121 2077 6172 6e69 6e67 0a20 2020 2020  !! warning.     
+00016b90: 2020 2020 2020 2045 7863 6c75 6469 6e67         Excluding
+00016ba0: 2063 6f6d 6d69 7473 2076 6961 2065 7863   commits via exc
+00016bb0: 6c75 6465 5f75 6e74 696c 2069 7320 6f6e  lude_until is on
+00016bc0: 6c79 2070 6f73 7369 626c 6520 7769 7468  ly possible with
+00016bd0: 696e 2074 6865 2072 616e 6765 206f 6620  in the range of 
+00016be0: 7468 6520 4875 6469 2061 6374 6976 6520  the Hudi active 
+00016bf0: 7469 6d65 6c69 6e65 2e0a 2020 2020 2020  timeline..      
+00016c00: 2020 2020 2020 4279 2064 6566 6175 6c74        By default
+00016c10: 2c20 4875 6469 206b 6565 7073 2074 6865  , Hudi keeps the
+00016c20: 206c 6173 7420 3230 2074 6f20 3330 2063   last 20 to 30 c
+00016c30: 6f6d 6d69 7473 2069 6e20 7468 6520 6163  ommits in the ac
+00016c40: 7469 7665 2074 696d 656c 696e 652e 0a20  tive timeline.. 
+00016c50: 2020 2020 2020 2020 2020 2049 6620 796f             If yo
+00016c60: 7520 6e65 6564 2074 6f20 6b65 6570 2061  u need to keep a
+00016c70: 206c 6f6e 6765 7220 6163 7469 7665 2074   longer active t
+00016c80: 696d 656c 696e 652c 2079 6f75 2063 616e  imeline, you can
+00016c90: 206f 7665 7277 7269 7465 2074 6865 206f   overwrite the o
+00016ca0: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
+00016cb0: 2020 2020 6068 6f6f 6469 652e 6b65 6570      `hoodie.keep
+00016cc0: 2e6d 696e 2e63 6f6d 6d69 7473 6020 616e  .min.commits` an
+00016cd0: 6420 6068 6f6f 6469 652e 6b65 6570 2e6d  d `hoodie.keep.m
+00016ce0: 6178 2e63 6f6d 6d69 7473 600a 2020 2020  ax.commits`.    
+00016cf0: 2020 2020 2020 2020 7768 656e 2063 616c          when cal
+00016d00: 6c69 6e67 2074 6865 2060 696e 7365 7274  ling the `insert
+00016d10: 2829 6020 6d65 7468 6f64 2e0a 0a20 2020  ()` method...   
+00016d20: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+00016d30: 0a20 2020 2020 2020 2020 2020 2077 616c  .            wal
+00016d40: 6c63 6c6f 636b 5f74 696d 653a 2052 6561  lclock_time: Rea
+00016d50: 6420 6461 7461 2061 7320 6f66 2074 6869  d data as of thi
+00016d60: 7320 706f 696e 7420 696e 2074 696d 652e  s point in time.
+00016d70: 2053 7472 696e 6773 2073 686f 756c 6420   Strings should 
+00016d80: 6265 2066 6f72 6d61 7474 6564 2069 6e20  be formatted in 
+00016d90: 6f6e 6520 6f66 2074 6865 0a20 2020 2020  one of the.     
+00016da0: 2020 2020 2020 2020 2020 2066 6f6c 6c6f             follo
+00016db0: 7769 6e67 2066 6f72 6d61 7473 2060 2559  wing formats `%Y
+00016dc0: 2d25 6d2d 2564 602c 2060 2559 2d25 6d2d  -%m-%d`, `%Y-%m-
+00016dd0: 2564 2025 4860 2c20 6025 592d 256d 2d25  %d %H`, `%Y-%m-%
+00016de0: 6420 2548 3a25 4d60 2c20 6f72 2060 2559  d %H:%M`, or `%Y
+00016df0: 2d25 6d2d 2564 2025 483a 254d 3a25 5360  -%m-%d %H:%M:%S`
+00016e00: 2e0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+00016e10: 636c 7564 655f 756e 7469 6c3a 2045 7863  clude_until: Exc
+00016e20: 6c75 6465 2063 6f6d 6d69 7473 2075 6e74  lude commits unt
+00016e30: 696c 2074 6869 7320 706f 696e 7420 696e  il this point in
+00016e40: 2074 696d 652e 2053 7472 696e 6720 7368   time. String sh
+00016e50: 6f75 6c64 2062 6520 666f 726d 6174 7465  ould be formatte
+00016e60: 6420 696e 206f 6e65 206f 6620 7468 650a  d in one of the.
+00016e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e80: 666f 6c6c 6f77 696e 6720 666f 726d 6174  following format
+00016e90: 7320 6025 592d 256d 2d25 6460 2c20 6025  s `%Y-%m-%d`, `%
+00016ea0: 592d 256d 2d25 6420 2548 602c 2060 2559  Y-%m-%d %H`, `%Y
+00016eb0: 2d25 6d2d 2564 2025 483a 254d 602c 206f  -%m-%d %H:%M`, o
+00016ec0: 7220 6025 592d 256d 2d25 6420 2548 3a25  r `%Y-%m-%d %H:%
+00016ed0: 4d3a 2553 602e 0a0a 2020 2020 2020 2020  M:%S`...        
+00016ee0: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
+00016ef0: 2020 2020 2020 6051 7565 7279 602e 2054        `Query`. T
+00016f00: 6865 2071 7565 7279 206f 626a 6563 7420  he query object 
+00016f10: 7769 7468 2074 6865 2061 7070 6c69 6564  with the applied
+00016f20: 2074 696d 6520 7472 6176 656c 2063 6f6e   time travel con
+00016f30: 6469 7469 6f6e 2e0a 2020 2020 2020 2020  dition..        
+00016f40: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00016f50: 726e 2073 656c 662e 7365 6c65 6374 5f61  rn self.select_a
+00016f60: 6c6c 2829 2e61 735f 6f66 2877 616c 6c63  ll().as_of(wallc
+00016f70: 6c6f 636b 5f74 696d 652c 2065 7863 6c75  lock_time, exclu
+00016f80: 6465 5f75 6e74 696c 290a 0a20 2020 2064  de_until)..    d
+00016f90: 6566 2063 6f6d 7075 7465 5f73 7461 7469  ef compute_stati
+00016fa0: 7374 6963 7328 0a20 2020 2020 2020 2073  stics(.        s
+00016fb0: 656c 662c 2077 616c 6c63 6c6f 636b 5f74  elf, wallclock_t
+00016fc0: 696d 653a 204f 7074 696f 6e61 6c5b 556e  ime: Optional[Un
+00016fd0: 696f 6e5b 7374 722c 2069 6e74 2c20 6461  ion[str, int, da
+00016fe0: 7465 7469 6d65 2c20 6461 7465 5d5d 203d  tetime, date]] =
+00016ff0: 204e 6f6e 650a 2020 2020 293a 0a20 2020   None.    ):.   
+00017000: 2020 2020 2022 2222 5265 636f 6d70 7574       """Recomput
+00017010: 6520 7468 6520 7374 6174 6973 7469 6373  e the statistics
+00017020: 2066 6f72 2074 6865 2066 6561 7475 7265   for the feature
+00017030: 2067 726f 7570 2061 6e64 2073 6176 6520   group and save 
+00017040: 7468 656d 2074 6f20 7468 650a 2020 2020  them to the.    
+00017050: 2020 2020 6665 6174 7572 6520 7374 6f72      feature stor
+00017060: 652e 0a0a 2020 2020 2020 2020 5374 6174  e...        Stat
+00017070: 6973 7469 6373 2061 7265 206f 6e6c 7920  istics are only 
+00017080: 636f 6d70 7574 6564 2066 6f72 2064 6174  computed for dat
+00017090: 6120 696e 2074 6865 206f 6666 6c69 6e65  a in the offline
+000170a0: 2073 746f 7261 6765 206f 6620 7468 6520   storage of the 
+000170b0: 6665 6174 7572 650a 2020 2020 2020 2020  feature.        
+000170c0: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+000170d0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
+000170e0: 2020 2020 2020 2020 7761 6c6c 636c 6f63          wallcloc
+000170f0: 6b5f 7469 6d65 3a20 4966 2073 7065 6369  k_time: If speci
+00017100: 6669 6564 2077 696c 6c20 7265 636f 6d70  fied will recomp
+00017110: 7574 6520 7374 6174 6973 7469 6373 206f  ute statistics o
+00017120: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+00017130: 2020 6665 6174 7572 6520 6772 6f75 7020    feature group 
+00017140: 6173 206f 6620 7370 6563 6966 6963 2070  as of specific p
+00017150: 6f69 6e74 2069 6e20 7469 6d65 2e20 4966  oint in time. If
+00017160: 206e 6f74 2073 7065 6369 6669 6564 2074   not specified t
+00017170: 6865 6e20 7769 6c6c 2063 6f6d 7075 7465  hen will compute
+00017180: 2073 7461 7469 7374 6963 730a 2020 2020   statistics.    
+00017190: 2020 2020 2020 2020 2020 2020 6173 206f              as o
+000171a0: 6620 6d6f 7374 2072 6563 656e 7420 7469  f most recent ti
+000171b0: 6d65 206f 6620 7468 6973 2066 6561 7475  me of this featu
+000171c0: 7265 2067 726f 7570 2e20 4465 6661 756c  re group. Defaul
+000171d0: 7473 2074 6f20 604e 6f6e 6560 2e20 5374  ts to `None`. St
+000171e0: 7269 6e67 7320 7368 6f75 6c64 0a20 2020  rings should.   
+000171f0: 2020 2020 2020 2020 2020 2020 2062 6520               be 
+00017200: 666f 726d 6174 7465 6420 696e 206f 6e65  formatted in one
+00017210: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
+00017220: 6720 666f 726d 6174 7320 6025 592d 256d  g formats `%Y-%m
+00017230: 2d25 6460 2c20 6025 592d 256d 2d25 6420  -%d`, `%Y-%m-%d 
+00017240: 2548 602c 2060 2559 2d25 6d2d 2564 2025  %H`, `%Y-%m-%d %
+00017250: 483a 254d 602c 2060 2559 2d25 6d2d 2564  H:%M`, `%Y-%m-%d
+00017260: 2025 483a 254d 3a25 5360 2c0a 2020 2020   %H:%M:%S`,.    
+00017270: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
+00017280: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+00017290: 532e 2566 602e 0a0a 2020 2020 2020 2020  S.%f`...        
+000172a0: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
+000172b0: 2020 2020 2020 6053 7461 7469 7374 6963        `Statistic
+000172c0: 7360 2e20 5468 6520 7374 6174 6973 7469  s`. The statisti
+000172d0: 6373 206d 6574 6164 6174 6120 6f62 6a65  cs metadata obje
+000172e0: 6374 2e0a 0a20 2020 2020 2020 2023 2052  ct...        # R
+000172f0: 6169 7365 730a 2020 2020 2020 2020 2020  aises.          
+00017300: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
+00017310: 7863 6570 7469 6f6e 732e 5265 7374 4150  xceptions.RestAP
+00017320: 4945 7272 6f72 602e 2055 6e61 626c 6520  IError`. Unable 
+00017330: 746f 2070 6572 7369 7374 2074 6865 2073  to persist the s
+00017340: 7461 7469 7374 6963 732e 0a20 2020 2020  tatistics..     
+00017350: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00017360: 6620 7365 6c66 2e73 7461 7469 7374 6963  f self.statistic
+00017370: 735f 636f 6e66 6967 2e65 6e61 626c 6564  s_config.enabled
+00017380: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00017390: 446f 6e27 7420 7265 6164 2074 6865 2064  Don't read the d
+000173a0: 6174 6166 7261 6d65 2068 6572 652c 2074  ataframe here, t
+000173b0: 6f20 6176 6f69 6420 7472 6967 6765 7269  o avoid triggeri
+000173c0: 6e67 2061 2072 6561 6420 6f70 6572 6174  ng a read operat
+000173d0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+000173e0: 2320 666f 7220 7468 6520 5079 7468 6f6e  # for the Python
+000173f0: 2065 6e67 696e 652e 2054 6865 2050 7974   engine. The Pyt
+00017400: 686f 6e20 656e 6769 6e65 2069 7320 676f  hon engine is go
+00017410: 696e 6720 746f 2073 6574 7570 2061 2053  ing to setup a S
+00017420: 7061 726b 204a 6f62 0a20 2020 2020 2020  park Job.       
+00017430: 2020 2020 2023 2074 6f20 7570 6461 7465       # to update
+00017440: 2074 6865 2073 7461 7469 7374 6963 732e   the statistics.
+00017450: 0a0a 2020 2020 2020 2020 2020 2020 6667  ..            fg
+00017460: 5f63 6f6d 6d69 745f 6964 203d 204e 6f6e  _commit_id = Non
+00017470: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+00017480: 2077 616c 6c63 6c6f 636b 5f74 696d 6520   wallclock_time 
+00017490: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000174a0: 2020 2020 2020 2020 2020 2020 2023 2052               # R
+000174b0: 6574 7269 6576 6520 6667 2063 6f6d 6d69  etrieve fg commi
+000174c0: 7420 6964 2072 656c 6174 6564 2074 6f20  t id related to 
+000174d0: 7468 6973 2077 616c 6c20 636c 6f63 6b20  this wall clock 
+000174e0: 7469 6d65 2061 6e64 2072 6563 6f6d 7075  time and recompu
+000174f0: 7465 2073 7461 7469 7374 6963 732e 2049  te statistics. I
+00017500: 7420 7769 6c6c 2074 6872 6f77 0a20 2020  t will throw.   
+00017510: 2020 2020 2020 2020 2020 2020 2023 2065               # e
+00017520: 7863 6570 7469 6f6e 2069 6620 6974 7320  xception if its 
+00017530: 6e6f 7420 7469 6d65 2074 7261 7665 6c20  not time travel 
+00017540: 656e 6162 6c65 6420 6665 6174 7572 6520  enabled feature 
+00017550: 6772 6f75 702e 0a20 2020 2020 2020 2020  group..         
+00017560: 2020 2020 2020 2066 675f 636f 6d6d 6974         fg_commit
+00017570: 5f69 6420 3d20 5b0a 2020 2020 2020 2020  _id = [.        
+00017580: 2020 2020 2020 2020 2020 2020 636f 6d6d              comm
+00017590: 6974 5f69 640a 2020 2020 2020 2020 2020  it_id.          
+000175a0: 2020 2020 2020 2020 2020 666f 7220 636f            for co
+000175b0: 6d6d 6974 5f69 6420 696e 2073 656c 662e  mmit_id in self.
+000175c0: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
+000175d0: 6e67 696e 652e 636f 6d6d 6974 5f64 6574  ngine.commit_det
+000175e0: 6169 6c73 280a 2020 2020 2020 2020 2020  ails(.          
+000175f0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00017600: 6c66 2c20 7761 6c6c 636c 6f63 6b5f 7469  lf, wallclock_ti
+00017610: 6d65 2c20 310a 2020 2020 2020 2020 2020  me, 1.          
+00017620: 2020 2020 2020 2020 2020 292e 6b65 7973            ).keys
+00017630: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00017640: 2020 205d 5b30 5d0a 0a20 2020 2020 2020     ][0]..       
+00017650: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00017660: 2e5f 7374 6174 6973 7469 6373 5f65 6e67  ._statistics_eng
+00017670: 696e 652e 636f 6d70 7574 655f 7374 6174  ine.compute_stat
+00017680: 6973 7469 6373 280a 2020 2020 2020 2020  istics(.        
+00017690: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000176a0: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+000176b0: 6174 7572 655f 6772 6f75 705f 636f 6d6d  ature_group_comm
+000176c0: 6974 5f69 643d 6667 5f63 6f6d 6d69 745f  it_id=fg_commit_
+000176d0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
+000176e0: 2020 2069 6620 6667 5f63 6f6d 6d69 745f     if fg_commit_
+000176f0: 6964 2069 7320 6e6f 7420 4e6f 6e65 0a20  id is not None. 
+00017700: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00017710: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
+00017720: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00017730: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00017740: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00017750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017760: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00017770: 2020 2020 2020 2022 5468 6520 7374 6174         "The stat
+00017780: 6973 7469 6373 2061 7265 206e 6f74 2065  istics are not e
+00017790: 6e61 626c 6564 206f 6620 6665 6174 7572  nabled of featur
+000177a0: 6520 6772 6f75 7020 607b 7d60 2c20 7769  e group `{}`, wi
+000177b0: 7468 2076 6572 7369 6f6e 220a 2020 2020  th version".    
+000177c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177d0: 2220 607b 7d60 2e20 4e6f 2073 7461 7469  " `{}`. No stati
+000177e0: 7374 6963 7320 636f 6d70 7574 6564 2e22  stics computed."
+000177f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017800: 2029 2e66 6f72 6d61 7428 7365 6c66 2e5f   ).format(self._
+00017810: 6e61 6d65 2c20 7365 6c66 2e5f 7665 7273  name, self._vers
+00017820: 696f 6e29 2c0a 2020 2020 2020 2020 2020  ion),.          
+00017830: 2020 2020 2020 7574 696c 2e53 746f 7261        util.Stora
+00017840: 6765 5761 726e 696e 672c 0a20 2020 2020  geWarning,.     
+00017850: 2020 2020 2020 2029 0a0a 2020 2020 4063         )..    @c
+00017860: 6c61 7373 6d65 7468 6f64 0a20 2020 2064  lassmethod.    d
+00017870: 6566 2066 726f 6d5f 7265 7370 6f6e 7365  ef from_response
+00017880: 5f6a 736f 6e28 636c 732c 206a 736f 6e5f  _json(cls, json_
+00017890: 6469 6374 293a 0a20 2020 2020 2020 206a  dict):.        j
+000178a0: 736f 6e5f 6465 6361 6d65 6c69 7a65 6420  son_decamelized 
+000178b0: 3d20 6875 6d70 732e 6465 6361 6d65 6c69  = humps.decameli
+000178c0: 7a65 286a 736f 6e5f 6469 6374 290a 2020  ze(json_dict).  
+000178d0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+000178e0: 6e63 6528 6a73 6f6e 5f64 6563 616d 656c  nce(json_decamel
+000178f0: 697a 6564 2c20 6469 6374 293a 0a20 2020  ized, dict):.   
+00017900: 2020 2020 2020 2020 2069 6620 2274 7970           if "typ
+00017910: 6522 2069 6e20 6a73 6f6e 5f64 6563 616d  e" in json_decam
+00017920: 656c 697a 6564 3a0a 2020 2020 2020 2020  elized:.        
+00017930: 2020 2020 2020 2020 6a73 6f6e 5f64 6563          json_dec
+00017940: 616d 656c 697a 6564 5b22 7374 7265 616d  amelized["stream
+00017950: 225d 203d 2028 0a20 2020 2020 2020 2020  "] = (.         
+00017960: 2020 2020 2020 2020 2020 206a 736f 6e5f             json_
+00017970: 6465 6361 6d65 6c69 7a65 645b 2274 7970  decamelized["typ
+00017980: 6522 5d20 3d3d 2022 7374 7265 616d 4665  e"] == "streamFe
+00017990: 6174 7572 6547 726f 7570 4454 4f22 0a20  atureGroupDTO". 
+000179a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000179b0: 0a20 2020 2020 2020 2020 2020 205f 203d  .            _ =
+000179c0: 206a 736f 6e5f 6465 6361 6d65 6c69 7a65   json_decamelize
+000179d0: 642e 706f 7028 2274 7970 6522 2c20 4e6f  d.pop("type", No
+000179e0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+000179f0: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
+00017a00: 2e70 6f70 2822 7661 6c69 6461 7469 6f6e  .pop("validation
+00017a10: 5f74 7970 6522 2c20 4e6f 6e65 290a 2020  _type", None).  
+00017a20: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00017a30: 2063 6c73 282a 2a6a 736f 6e5f 6465 6361   cls(**json_deca
+00017a40: 6d65 6c69 7a65 6429 0a20 2020 2020 2020  melized).       
+00017a50: 2066 6f72 2066 6720 696e 206a 736f 6e5f   for fg in json_
+00017a60: 6465 6361 6d65 6c69 7a65 643a 0a20 2020  decamelized:.   
+00017a70: 2020 2020 2020 2020 2069 6620 2274 7970           if "typ
+00017a80: 6522 2069 6e20 6667 3a0a 2020 2020 2020  e" in fg:.      
+00017a90: 2020 2020 2020 2020 2020 6667 5b22 7374            fg["st
+00017aa0: 7265 616d 225d 203d 2066 675b 2274 7970  ream"] = fg["typ
+00017ab0: 6522 5d20 3d3d 2022 7374 7265 616d 4665  e"] == "streamFe
+00017ac0: 6174 7572 6547 726f 7570 4454 4f22 0a20  atureGroupDTO". 
+00017ad0: 2020 2020 2020 2020 2020 205f 203d 2066             _ = f
+00017ae0: 672e 706f 7028 2274 7970 6522 2c20 4e6f  g.pop("type", No
+00017af0: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00017b00: 6667 2e70 6f70 2822 7661 6c69 6461 7469  fg.pop("validati
+00017b10: 6f6e 5f74 7970 6522 2c20 4e6f 6e65 290a  on_type", None).
+00017b20: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00017b30: 636c 7328 2a2a 6667 2920 666f 7220 6667  cls(**fg) for fg
+00017b40: 2069 6e20 6a73 6f6e 5f64 6563 616d 656c   in json_decamel
+00017b50: 697a 6564 5d0a 0a20 2020 2064 6566 2075  ized]..    def u
+00017b60: 7064 6174 655f 6672 6f6d 5f72 6573 706f  pdate_from_respo
+00017b70: 6e73 655f 6a73 6f6e 2873 656c 662c 206a  nse_json(self, j
+00017b80: 736f 6e5f 6469 6374 293a 0a20 2020 2020  son_dict):.     
+00017b90: 2020 206a 736f 6e5f 6465 6361 6d65 6c69     json_decameli
+00017ba0: 7a65 6420 3d20 6875 6d70 732e 6465 6361  zed = humps.deca
+00017bb0: 6d65 6c69 7a65 286a 736f 6e5f 6469 6374  melize(json_dict
+00017bc0: 290a 2020 2020 2020 2020 6a73 6f6e 5f64  ).        json_d
+00017bd0: 6563 616d 656c 697a 6564 5b22 7374 7265  ecamelized["stre
+00017be0: 616d 225d 203d 206a 736f 6e5f 6465 6361  am"] = json_deca
+00017bf0: 6d65 6c69 7a65 645b 2274 7970 6522 5d20  melized["type"] 
+00017c00: 3d3d 2022 7374 7265 616d 4665 6174 7572  == "streamFeatur
+00017c10: 6547 726f 7570 4454 4f22 0a20 2020 2020  eGroupDTO".     
+00017c20: 2020 205f 203d 206a 736f 6e5f 6465 6361     _ = json_deca
+00017c30: 6d65 6c69 7a65 642e 706f 7028 2274 7970  melized.pop("typ
+00017c40: 6522 290a 2020 2020 2020 2020 7365 6c66  e").        self
+00017c50: 2e5f 5f69 6e69 745f 5f28 2a2a 6a73 6f6e  .__init__(**json
+00017c60: 5f64 6563 616d 656c 697a 6564 290a 2020  _decamelized).  
+00017c70: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00017c80: 660a 0a20 2020 2064 6566 206a 736f 6e28  f..    def json(
+00017c90: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00017ca0: 2222 4765 7420 7370 6563 6966 6963 2046  ""Get specific F
+00017cb0: 6561 7475 7265 2047 726f 7570 206d 6574  eature Group met
+00017cc0: 6164 6174 6120 696e 206a 736f 6e20 666f  adata in json fo
+00017cd0: 726d 6174 2e0a 0a20 2020 2020 2020 2021  rmat...        !
+00017ce0: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
+00017cf0: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00017d00: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
+00017d10: 6a73 6f6e 2829 0a20 2020 2020 2020 2020  json().         
+00017d20: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+00017d30: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00017d40: 6e20 6a73 6f6e 2e64 756d 7073 2873 656c  n json.dumps(sel
+00017d50: 662c 2063 6c73 3d75 7469 6c2e 4665 6174  f, cls=util.Feat
+00017d60: 7572 6553 746f 7265 456e 636f 6465 7229  ureStoreEncoder)
+00017d70: 0a0a 2020 2020 6465 6620 746f 5f64 6963  ..    def to_dic
+00017d80: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+00017d90: 2022 2222 4765 7420 7374 7275 6374 7572   """Get structur
+00017da0: 6564 2069 6e66 6f20 6162 6f75 7420 7370  ed info about sp
+00017db0: 6563 6966 6963 2046 6561 7475 7265 2047  ecific Feature G
+00017dc0: 726f 7570 2069 6e20 7079 7468 6f6e 2064  roup in python d
+00017dd0: 6963 7469 6f6e 6172 7920 666f 726d 6174  ictionary format
+00017de0: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+00017df0: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+00017e00: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+00017e10: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
+00017e20: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
+00017e30: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
+00017e40: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
+00017e50: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+00017e60: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+00017e70: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
+00017e80: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
+00017e90: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+00017ea0: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
+00017eb0: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
+00017ec0: 746f 5f64 6963 7428 290a 2020 2020 2020  to_dict().      
+00017ed0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+00017ee0: 2020 2222 220a 2020 2020 2020 2020 6667    """.        fg
+00017ef0: 5f6d 6574 615f 6469 6374 203d 207b 0a20  _meta_dict = {. 
+00017f00: 2020 2020 2020 2020 2020 2022 6964 223a             "id":
+00017f10: 2073 656c 662e 5f69 642c 0a20 2020 2020   self._id,.     
+00017f20: 2020 2020 2020 2022 6e61 6d65 223a 2073         "name": s
+00017f30: 656c 662e 5f6e 616d 652c 0a20 2020 2020  elf._name,.     
+00017f40: 2020 2020 2020 2022 7665 7273 696f 6e22         "version"
+00017f50: 3a20 7365 6c66 2e5f 7665 7273 696f 6e2c  : self._version,
+00017f60: 0a20 2020 2020 2020 2020 2020 2022 6465  .            "de
+00017f70: 7363 7269 7074 696f 6e22 3a20 7365 6c66  scription": self
+00017f80: 2e5f 6465 7363 7269 7074 696f 6e2c 0a20  ._description,. 
+00017f90: 2020 2020 2020 2020 2020 2022 6f6e 6c69             "onli
+00017fa0: 6e65 456e 6162 6c65 6422 3a20 7365 6c66  neEnabled": self
+00017fb0: 2e5f 6f6e 6c69 6e65 5f65 6e61 626c 6564  ._online_enabled
+00017fc0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00017fd0: 696d 6554 7261 7665 6c46 6f72 6d61 7422  imeTravelFormat"
+00017fe0: 3a20 7365 6c66 2e5f 7469 6d65 5f74 7261  : self._time_tra
+00017ff0: 7665 6c5f 666f 726d 6174 2c0a 2020 2020  vel_format,.    
+00018000: 2020 2020 2020 2020 2266 6561 7475 7265          "feature
+00018010: 7322 3a20 7365 6c66 2e5f 6665 6174 7572  s": self._featur
+00018020: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+00018030: 2266 6561 7475 7265 7374 6f72 6549 6422  "featurestoreId"
+00018040: 3a20 7365 6c66 2e5f 6665 6174 7572 655f  : self._feature_
+00018050: 7374 6f72 655f 6964 2c0a 2020 2020 2020  store_id,.      
+00018060: 2020 2020 2020 2274 7970 6522 3a20 2263        "type": "c
+00018070: 6163 6865 6446 6561 7475 7265 6772 6f75  achedFeaturegrou
+00018080: 7044 544f 220a 2020 2020 2020 2020 2020  pDTO".          
+00018090: 2020 6966 206e 6f74 2073 656c 662e 5f73    if not self._s
+000180a0: 7472 6561 6d0a 2020 2020 2020 2020 2020  tream.          
+000180b0: 2020 656c 7365 2022 7374 7265 616d 4665    else "streamFe
+000180c0: 6174 7572 6547 726f 7570 4454 4f22 2c0a  atureGroupDTO",.
+000180d0: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+000180e0: 7469 7374 6963 7343 6f6e 6669 6722 3a20  tisticsConfig": 
+000180f0: 7365 6c66 2e5f 7374 6174 6973 7469 6373  self._statistics
+00018100: 5f63 6f6e 6669 672c 0a20 2020 2020 2020  _config,.       
+00018110: 2020 2020 2022 6576 656e 7454 696d 6522       "eventTime"
+00018120: 3a20 7365 6c66 2e65 7665 6e74 5f74 696d  : self.event_tim
+00018130: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00018140: 6578 7065 6374 6174 696f 6e53 7569 7465  expectationSuite
+00018150: 223a 2073 656c 662e 5f65 7870 6563 7461  ": self._expecta
+00018160: 7469 6f6e 5f73 7569 7465 2c0a 2020 2020  tion_suite,.    
+00018170: 2020 2020 2020 2020 2270 6172 656e 7473          "parents
+00018180: 223a 2073 656c 662e 5f70 6172 656e 7473  ": self._parents
+00018190: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+000181a0: 2020 2020 6966 2073 656c 662e 5f73 7472      if self._str
+000181b0: 6561 6d3a 0a20 2020 2020 2020 2020 2020  eam:.           
+000181c0: 2066 675f 6d65 7461 5f64 6963 745b 2264   fg_meta_dict["d
+000181d0: 656c 7461 5374 7265 616d 6572 4a6f 6243  eltaStreamerJobC
+000181e0: 6f6e 6622 5d20 3d20 7365 6c66 2e5f 6465  onf"] = self._de
+000181f0: 6c74 6173 7472 6561 6d65 725f 6a6f 6263  ltastreamer_jobc
+00018200: 6f6e 660a 2020 2020 2020 2020 7265 7475  onf.        retu
+00018210: 726e 2066 675f 6d65 7461 5f64 6963 740a  rn fg_meta_dict.
+00018220: 0a20 2020 2064 6566 205f 6765 745f 7461  .    def _get_ta
+00018230: 626c 655f 6e61 6d65 2873 656c 6629 3a0a  ble_name(self):.
+00018240: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00018250: 656c 662e 6665 6174 7572 655f 7374 6f72  elf.feature_stor
+00018260: 655f 6e61 6d65 202b 2022 2e22 202b 2073  e_name + "." + s
+00018270: 656c 662e 6e61 6d65 202b 2022 5f22 202b  elf.name + "_" +
+00018280: 2073 7472 2873 656c 662e 7665 7273 696f   str(self.versio
+00018290: 6e29 0a0a 2020 2020 6465 6620 5f67 6574  n)..    def _get
+000182a0: 5f6f 6e6c 696e 655f 7461 626c 655f 6e61  _online_table_na
+000182b0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
+000182c0: 2020 7265 7475 726e 2073 656c 662e 6e61    return self.na
+000182d0: 6d65 202b 2022 5f22 202b 2073 7472 2873  me + "_" + str(s
+000182e0: 656c 662e 7665 7273 696f 6e29 0a0a 2020  elf.version)..  
+000182f0: 2020 6465 6620 5f67 6574 5f70 726f 6a65    def _get_proje
+00018300: 6374 5f6e 616d 6528 7365 6c66 293a 0a20  ct_name(self):. 
+00018310: 2020 2020 2020 2069 6620 7365 6c66 2e66         if self.f
+00018320: 6561 7475 7265 5f73 746f 7265 5f6e 616d  eature_store_nam
+00018330: 652e 656e 6473 7769 7468 2822 5f66 6561  e.endswith("_fea
+00018340: 7475 7265 7374 6f72 6522 293a 0a20 2020  turestore"):.   
+00018350: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00018360: 7365 6c66 2e66 6561 7475 7265 5f73 746f  self.feature_sto
+00018370: 7265 5f6e 616d 655b 3a2d 3133 5d0a 2020  re_name[:-13].  
+00018380: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00018390: 662e 6665 6174 7572 655f 7374 6f72 655f  f.feature_store_
+000183a0: 6e61 6d65 0a0a 2020 2020 4070 726f 7065  name..    @prope
+000183b0: 7274 790a 2020 2020 6465 6620 6964 2873  rty.    def id(s
+000183c0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+000183d0: 2246 6561 7475 7265 2067 726f 7570 2069  "Feature group i
+000183e0: 642e 2222 220a 2020 2020 2020 2020 7265  d.""".        re
+000183f0: 7475 726e 2073 656c 662e 5f69 640a 0a20  turn self._id.. 
+00018400: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00018410: 2064 6566 206e 616d 6528 7365 6c66 293a   def name(self):
+00018420: 0a20 2020 2020 2020 2022 2222 4e61 6d65  .        """Name
+00018430: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+00018440: 6772 6f75 702e 2222 220a 2020 2020 2020  group.""".      
+00018450: 2020 7265 7475 726e 2073 656c 662e 5f6e    return self._n
+00018460: 616d 650a 0a20 2020 2040 7072 6f70 6572  ame..    @proper
+00018470: 7479 0a20 2020 2064 6566 2076 6572 7369  ty.    def versi
+00018480: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
+00018490: 2020 2222 2256 6572 7369 6f6e 206e 756d    """Version num
+000184a0: 6265 7220 6f66 2074 6865 2066 6561 7475  ber of the featu
+000184b0: 7265 2067 726f 7570 2e22 2222 0a20 2020  re group.""".   
+000184c0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000184d0: 2e5f 7665 7273 696f 6e0a 0a20 2020 2040  ._version..    @
+000184e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+000184f0: 2064 6573 6372 6970 7469 6f6e 2873 656c   description(sel
+00018500: 6629 3a0a 2020 2020 2020 2020 2222 2244  f):.        """D
+00018510: 6573 6372 6970 7469 6f6e 206f 6620 7468  escription of th
+00018520: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
+00018530: 636f 6e74 656e 7473 2e22 2222 0a20 2020  contents.""".   
+00018540: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00018550: 2e5f 6465 7363 7269 7074 696f 6e0a 0a20  ._description.. 
+00018560: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00018570: 2064 6566 2074 696d 655f 7472 6176 656c   def time_travel
+00018580: 5f66 6f72 6d61 7428 7365 6c66 293a 0a20  _format(self):. 
+00018590: 2020 2020 2020 2022 2222 5365 7474 696e         """Settin
+000185a0: 6720 6f66 2074 6865 2066 6561 7475 7265  g of the feature
+000185b0: 2067 726f 7570 2074 696d 6520 7472 6176   group time trav
+000185c0: 656c 2066 6f72 6d61 742e 2222 220a 2020  el format.""".  
+000185d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000185e0: 662e 5f74 696d 655f 7472 6176 656c 5f66  f._time_travel_f
+000185f0: 6f72 6d61 740a 0a20 2020 2040 7072 6f70  ormat..    @prop
+00018600: 6572 7479 0a20 2020 2064 6566 2070 6172  erty.    def par
+00018610: 7469 7469 6f6e 5f6b 6579 2873 656c 6629  tition_key(self)
+00018620: 3a0a 2020 2020 2020 2020 2222 224c 6973  :.        """Lis
+00018630: 7420 6f66 2066 6561 7475 7265 7320 6275  t of features bu
+00018640: 696c 6469 6e67 2074 6865 2070 6172 7469  ilding the parti
+00018650: 7469 6f6e 206b 6579 2e22 2222 0a20 2020  tion key.""".   
+00018660: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00018670: 2e5f 7061 7274 6974 696f 6e5f 6b65 790a  ._partition_key.
+00018680: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00018690: 2020 2064 6566 2068 7564 695f 7072 6563     def hudi_prec
+000186a0: 6f6d 6269 6e65 5f6b 6579 2873 656c 6629  ombine_key(self)
+000186b0: 3a0a 2020 2020 2020 2020 2222 2246 6561  :.        """Fea
+000186c0: 7475 7265 206e 616d 6520 7468 6174 2069  ture name that i
+000186d0: 7320 7468 6520 6875 6469 2070 7265 636f  s the hudi preco
+000186e0: 6d62 696e 6520 6b65 792e 2222 220a 2020  mbine key.""".  
+000186f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00018700: 662e 5f68 7564 695f 7072 6563 6f6d 6269  f._hudi_precombi
+00018710: 6e65 5f6b 6579 0a0a 2020 2020 4070 726f  ne_key..    @pro
+00018720: 7065 7274 790a 2020 2020 6465 6620 6665  perty.    def fe
+00018730: 6174 7572 655f 7374 6f72 655f 6964 2873  ature_store_id(s
+00018740: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00018750: 7475 726e 2073 656c 662e 5f66 6561 7475  turn self._featu
+00018760: 7265 5f73 746f 7265 5f69 640a 0a20 2020  re_store_id..   
+00018770: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00018780: 6566 2066 6561 7475 7265 5f73 746f 7265  ef feature_store
+00018790: 5f6e 616d 6528 7365 6c66 293a 0a20 2020  _name(self):.   
+000187a0: 2020 2020 2022 2222 4e61 6d65 206f 6620       """Name of 
+000187b0: 7468 6520 6665 6174 7572 6520 7374 6f72  the feature stor
+000187c0: 6520 696e 2077 6869 6368 2074 6865 2066  e in which the f
+000187d0: 6561 7475 7265 2067 726f 7570 2069 7320  eature group is 
+000187e0: 6c6f 6361 7465 642e 2222 220a 2020 2020  located.""".    
+000187f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00018800: 5f66 6561 7475 7265 5f73 746f 7265 5f6e  _feature_store_n
+00018810: 616d 650a 0a20 2020 2040 7072 6f70 6572  ame..    @proper
+00018820: 7479 0a20 2020 2064 6566 2063 7265 6174  ty.    def creat
+00018830: 6f72 2873 656c 6629 3a0a 2020 2020 2020  or(self):.      
+00018840: 2020 2222 2255 7365 726e 616d 6520 6f66    """Username of
+00018850: 2074 6865 2063 7265 6174 6f72 2e22 2222   the creator."""
+00018860: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00018870: 7365 6c66 2e5f 6372 6561 746f 720a 0a20  self._creator.. 
+00018880: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00018890: 2064 6566 2063 7265 6174 6564 2873 656c   def created(sel
+000188a0: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+000188b0: 696d 6573 7461 6d70 2077 6865 6e20 7468  imestamp when th
+000188c0: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
+000188d0: 7761 7320 6372 6561 7465 642e 2222 220a  was created.""".
+000188e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000188f0: 656c 662e 5f63 7265 6174 6564 0a0a 2020  elf._created..  
+00018900: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00018910: 6465 6620 7374 7265 616d 2873 656c 6629  def stream(self)
+00018920: 3a0a 2020 2020 2020 2020 2222 2257 6865  :.        """Whe
+00018930: 7468 6572 2074 6f20 656e 6162 6c65 2072  ther to enable r
+00018940: 6561 6c20 7469 6d65 2073 7472 6561 6d20  eal time stream 
+00018950: 7772 6974 696e 6720 6361 7061 6269 6c69  writing capabili
+00018960: 7469 6573 2e22 2222 0a20 2020 2020 2020  ties.""".       
+00018970: 2072 6574 7572 6e20 7365 6c66 2e5f 7374   return self._st
+00018980: 7265 616d 0a0a 2020 2020 4070 726f 7065  ream..    @prope
+00018990: 7274 790a 2020 2020 6465 6620 7061 7265  rty.    def pare
+000189a0: 6e74 7328 7365 6c66 293a 0a20 2020 2020  nts(self):.     
+000189b0: 2020 2022 2222 5061 7265 6e74 2066 6561     """Parent fea
+000189c0: 7475 7265 2067 726f 7570 7320 6173 206f  ture groups as o
+000189d0: 7269 6769 6e20 6f66 2074 6865 2064 6174  rigin of the dat
+000189e0: 6120 696e 2074 6865 2063 7572 7265 6e74  a in the current
+000189f0: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
+00018a00: 2020 2020 2020 2020 5468 6973 2069 7320          This is 
+00018a10: 7061 7274 206f 6620 6578 706c 6963 6974  part of explicit
+00018a20: 2070 726f 7665 6e61 6e63 6522 2222 0a20   provenance""". 
+00018a30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00018a40: 6c66 2e5f 7061 7265 6e74 730a 0a20 2020  lf._parents..   
+00018a50: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00018a60: 6566 2062 6163 6b66 696c 6c5f 6a6f 6228  ef backfill_job(
+00018a70: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00018a80: 2222 4765 7420 7468 6520 4a6f 6220 6f62  ""Get the Job ob
+00018a90: 6a65 6374 2072 6566 6572 656e 6365 2066  ject reference f
+00018aa0: 6f72 2074 6865 2062 6163 6b66 696c 6c20  or the backfill 
+00018ab0: 6a6f 6220 666f 7220 7468 6973 0a20 2020  job for this.   
+00018ac0: 2020 2020 2046 6561 7475 7265 2047 726f       Feature Gro
+00018ad0: 7570 2e22 2222 0a20 2020 2020 2020 2069  up.""".        i
+00018ae0: 6620 7365 6c66 2e5f 6261 636b 6669 6c6c  f self._backfill
+00018af0: 5f6a 6f62 2069 7320 4e6f 6e65 3a0a 2020  _job is None:.  
+00018b00: 2020 2020 2020 2020 2020 6a6f 625f 6e61            job_na
+00018b10: 6d65 203d 2022 7b66 675f 6e61 6d65 7d5f  me = "{fg_name}_
+00018b20: 7b76 6572 7369 6f6e 7d5f 6f66 666c 696e  {version}_offlin
+00018b30: 655f 6667 5f62 6163 6b66 696c 6c22 2e66  e_fg_backfill".f
+00018b40: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+00018b50: 2020 2020 2020 2066 675f 6e61 6d65 3d73         fg_name=s
+00018b60: 656c 662e 5f6e 616d 652c 2076 6572 7369  elf._name, versi
+00018b70: 6f6e 3d73 656c 662e 5f76 6572 7369 6f6e  on=self._version
+00018b80: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00018b90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018ba0: 5f62 6163 6b66 696c 6c5f 6a6f 6220 3d20  _backfill_job = 
+00018bb0: 6a6f 625f 6170 692e 4a6f 6241 7069 2829  job_api.JobApi()
+00018bc0: 2e67 6574 286a 6f62 5f6e 616d 6529 0a20  .get(job_name). 
+00018bd0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00018be0: 6c66 2e5f 6261 636b 6669 6c6c 5f6a 6f62  lf._backfill_job
+00018bf0: 0a0a 2020 2020 4076 6572 7369 6f6e 2e73  ..    @version.s
+00018c00: 6574 7465 720a 2020 2020 6465 6620 7665  etter.    def ve
+00018c10: 7273 696f 6e28 7365 6c66 2c20 7665 7273  rsion(self, vers
+00018c20: 696f 6e29 3a0a 2020 2020 2020 2020 7365  ion):.        se
+00018c30: 6c66 2e5f 7665 7273 696f 6e20 3d20 7665  lf._version = ve
+00018c40: 7273 696f 6e0a 0a20 2020 2040 6465 7363  rsion..    @desc
+00018c50: 7269 7074 696f 6e2e 7365 7474 6572 0a20  ription.setter. 
+00018c60: 2020 2064 6566 2064 6573 6372 6970 7469     def descripti
+00018c70: 6f6e 2873 656c 662c 206e 6577 5f64 6573  on(self, new_des
+00018c80: 6372 6970 7469 6f6e 293a 0a20 2020 2020  cription):.     
+00018c90: 2020 2073 656c 662e 5f64 6573 6372 6970     self._descrip
+00018ca0: 7469 6f6e 203d 206e 6577 5f64 6573 6372  tion = new_descr
+00018cb0: 6970 7469 6f6e 0a0a 2020 2020 4074 696d  iption..    @tim
+00018cc0: 655f 7472 6176 656c 5f66 6f72 6d61 742e  e_travel_format.
+00018cd0: 7365 7474 6572 0a20 2020 2064 6566 2074  setter.    def t
+00018ce0: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
+00018cf0: 7428 7365 6c66 2c20 6e65 775f 7469 6d65  t(self, new_time
+00018d00: 5f74 7261 7665 6c5f 666f 726d 6174 293a  _travel_format):
+00018d10: 0a20 2020 2020 2020 2073 656c 662e 5f74  .        self._t
+00018d20: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
+00018d30: 7420 3d20 6e65 775f 7469 6d65 5f74 7261  t = new_time_tra
+00018d40: 7665 6c5f 666f 726d 6174 0a0a 2020 2020  vel_format..    
+00018d50: 4070 6172 7469 7469 6f6e 5f6b 6579 2e73  @partition_key.s
+00018d60: 6574 7465 720a 2020 2020 6465 6620 7061  etter.    def pa
+00018d70: 7274 6974 696f 6e5f 6b65 7928 7365 6c66  rtition_key(self
+00018d80: 2c20 6e65 775f 7061 7274 6974 696f 6e5f  , new_partition_
+00018d90: 6b65 7929 3a0a 2020 2020 2020 2020 7365  key):.        se
+00018da0: 6c66 2e5f 7061 7274 6974 696f 6e5f 6b65  lf._partition_ke
+00018db0: 7920 3d20 5b70 6b2e 6c6f 7765 7228 2920  y = [pk.lower() 
+00018dc0: 666f 7220 706b 2069 6e20 6e65 775f 7061  for pk in new_pa
+00018dd0: 7274 6974 696f 6e5f 6b65 795d 0a0a 2020  rtition_key]..  
+00018de0: 2020 4068 7564 695f 7072 6563 6f6d 6269    @hudi_precombi
+00018df0: 6e65 5f6b 6579 2e73 6574 7465 720a 2020  ne_key.setter.  
+00018e00: 2020 6465 6620 6875 6469 5f70 7265 636f    def hudi_preco
+00018e10: 6d62 696e 655f 6b65 7928 7365 6c66 2c20  mbine_key(self, 
+00018e20: 6875 6469 5f70 7265 636f 6d62 696e 655f  hudi_precombine_
+00018e30: 6b65 7929 3a0a 2020 2020 2020 2020 7365  key):.        se
+00018e40: 6c66 2e5f 6875 6469 5f70 7265 636f 6d62  lf._hudi_precomb
+00018e50: 696e 655f 6b65 7920 3d20 6875 6469 5f70  ine_key = hudi_p
+00018e60: 7265 636f 6d62 696e 655f 6b65 792e 6c6f  recombine_key.lo
+00018e70: 7765 7228 290a 0a20 2020 2040 7374 7265  wer()..    @stre
+00018e80: 616d 2e73 6574 7465 720a 2020 2020 6465  am.setter.    de
+00018e90: 6620 7374 7265 616d 2873 656c 662c 2073  f stream(self, s
+00018ea0: 7472 6561 6d29 3a0a 2020 2020 2020 2020  tream):.        
+00018eb0: 7365 6c66 2e5f 7374 7265 616d 203d 2073  self._stream = s
+00018ec0: 7472 6561 6d0a 0a20 2020 2040 7061 7265  tream..    @pare
+00018ed0: 6e74 732e 7365 7474 6572 0a20 2020 2064  nts.setter.    d
+00018ee0: 6566 2070 6172 656e 7473 2873 656c 662c  ef parents(self,
+00018ef0: 206e 6577 5f70 6172 656e 7473 293a 0a20   new_parents):. 
+00018f00: 2020 2020 2020 2073 656c 662e 5f70 6172         self._par
+00018f10: 656e 7473 203d 206e 6577 5f70 6172 656e  ents = new_paren
+00018f20: 7473 0a0a 0a63 6c61 7373 2045 7874 6572  ts...class Exter
+00018f30: 6e61 6c46 6561 7475 7265 4772 6f75 7028  nalFeatureGroup(
+00018f40: 4665 6174 7572 6547 726f 7570 4261 7365  FeatureGroupBase
+00018f50: 293a 0a20 2020 2045 5854 4552 4e41 4c5f  ):.    EXTERNAL_
+00018f60: 4645 4154 5552 455f 4752 4f55 5020 3d20  FEATURE_GROUP = 
+00018f70: 224f 4e5f 4445 4d41 4e44 5f46 4541 5455  "ON_DEMAND_FEATU
+00018f80: 5245 5f47 524f 5550 220a 2020 2020 454e  RE_GROUP".    EN
+00018f90: 5449 5459 5f54 5950 4520 3d20 2266 6561  TITY_TYPE = "fea
+00018fa0: 7475 7265 6772 6f75 7073 220a 0a20 2020  turegroups"..   
+00018fb0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
+00018fc0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00018fd0: 2020 2020 2073 746f 7261 6765 5f63 6f6e       storage_con
+00018fe0: 6e65 6374 6f72 2c0a 2020 2020 2020 2020  nector,.        
+00018ff0: 7175 6572 793d 4e6f 6e65 2c0a 2020 2020  query=None,.    
+00019000: 2020 2020 6461 7461 5f66 6f72 6d61 743d      data_format=
+00019010: 4e6f 6e65 2c0a 2020 2020 2020 2020 7061  None,.        pa
+00019020: 7468 3d4e 6f6e 652c 0a20 2020 2020 2020  th=None,.       
+00019030: 206f 7074 696f 6e73 3d7b 7d2c 0a20 2020   options={},.   
+00019040: 2020 2020 206e 616d 653d 4e6f 6e65 2c0a       name=None,.
+00019050: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+00019060: 4e6f 6e65 2c0a 2020 2020 2020 2020 6465  None,.        de
+00019070: 7363 7269 7074 696f 6e3d 4e6f 6e65 2c0a  scription=None,.
+00019080: 2020 2020 2020 2020 7072 696d 6172 795f          primary_
+00019090: 6b65 793d 4e6f 6e65 2c0a 2020 2020 2020  key=None,.      
+000190a0: 2020 6665 6174 7572 6573 746f 7265 5f69    featurestore_i
+000190b0: 643d 4e6f 6e65 2c0a 2020 2020 2020 2020  d=None,.        
+000190c0: 6665 6174 7572 6573 746f 7265 5f6e 616d  featurestore_nam
+000190d0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
+000190e0: 6372 6561 7465 643d 4e6f 6e65 2c0a 2020  created=None,.  
+000190f0: 2020 2020 2020 6372 6561 746f 723d 4e6f        creator=No
+00019100: 6e65 2c0a 2020 2020 2020 2020 6964 3d4e  ne,.        id=N
+00019110: 6f6e 652c 0a20 2020 2020 2020 2066 6561  one,.        fea
+00019120: 7475 7265 733d 4e6f 6e65 2c0a 2020 2020  tures=None,.    
+00019130: 2020 2020 6c6f 6361 7469 6f6e 3d4e 6f6e      location=Non
+00019140: 652c 0a20 2020 2020 2020 2073 7461 7469  e,.        stati
+00019150: 7374 6963 735f 636f 6e66 6967 3d4e 6f6e  stics_config=Non
+00019160: 652c 0a20 2020 2020 2020 2065 7665 6e74  e,.        event
+00019170: 5f74 696d 653d 4e6f 6e65 2c0a 2020 2020  _time=None,.    
+00019180: 2020 2020 6578 7065 6374 6174 696f 6e5f      expectation_
+00019190: 7375 6974 653d 4e6f 6e65 2c0a 2020 2020  suite=None,.    
+000191a0: 2020 2020 6f6e 6c69 6e65 5f65 6e61 626c      online_enabl
+000191b0: 6564 3d46 616c 7365 2c0a 2020 2020 2020  ed=False,.      
+000191c0: 2020 6872 6566 3d4e 6f6e 652c 0a20 2020    href=None,.   
+000191d0: 2020 2020 206f 6e6c 696e 655f 746f 7069       online_topi
+000191e0: 635f 6e61 6d65 3d4e 6f6e 652c 0a20 2020  c_name=None,.   
+000191f0: 2020 2020 2073 7069 6e65 3d46 616c 7365       spine=False
+00019200: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+00019210: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
+00019220: 5f28 0a20 2020 2020 2020 2020 2020 2066  _(.            f
+00019230: 6561 7475 7265 7374 6f72 655f 6964 2c0a  eaturestore_id,.
+00019240: 2020 2020 2020 2020 2020 2020 6c6f 6361              loca
+00019250: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00019260: 2020 6576 656e 745f 7469 6d65 3d65 7665    event_time=eve
+00019270: 6e74 5f74 696d 652c 0a20 2020 2020 2020  nt_time,.       
+00019280: 2020 2020 206f 6e6c 696e 655f 656e 6162       online_enab
+00019290: 6c65 643d 6f6e 6c69 6e65 5f65 6e61 626c  led=online_enabl
+000192a0: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
+000192b0: 6964 3d69 642c 0a20 2020 2020 2020 2020  id=id,.         
+000192c0: 2020 2065 7870 6563 7461 7469 6f6e 5f73     expectation_s
+000192d0: 7569 7465 3d65 7870 6563 7461 7469 6f6e  uite=expectation
+000192e0: 5f73 7569 7465 2c0a 2020 2020 2020 2020  _suite,.        
+000192f0: 2020 2020 6f6e 6c69 6e65 5f74 6f70 6963      online_topic
+00019300: 5f6e 616d 653d 6f6e 6c69 6e65 5f74 6f70  _name=online_top
+00019310: 6963 5f6e 616d 652c 0a20 2020 2020 2020  ic_name,.       
+00019320: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+00019330: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
+00019340: 6e61 6d65 203d 2066 6561 7475 7265 7374  name = featurest
+00019350: 6f72 655f 6e61 6d65 0a20 2020 2020 2020  ore_name.       
+00019360: 2073 656c 662e 5f64 6573 6372 6970 7469   self._descripti
+00019370: 6f6e 203d 2064 6573 6372 6970 7469 6f6e  on = description
+00019380: 0a20 2020 2020 2020 2073 656c 662e 5f63  .        self._c
+00019390: 7265 6174 6564 203d 2063 7265 6174 6564  reated = created
+000193a0: 0a20 2020 2020 2020 2073 656c 662e 5f63  .        self._c
+000193b0: 7265 6174 6f72 203d 2075 7365 722e 5573  reator = user.Us
+000193c0: 6572 2e66 726f 6d5f 7265 7370 6f6e 7365  er.from_response
+000193d0: 5f6a 736f 6e28 6372 6561 746f 7229 0a20  _json(creator). 
+000193e0: 2020 2020 2020 2073 656c 662e 5f76 6572         self._ver
+000193f0: 7369 6f6e 203d 2076 6572 7369 6f6e 0a20  sion = version. 
+00019400: 2020 2020 2020 2073 656c 662e 5f6e 616d         self._nam
+00019410: 6520 3d20 6e61 6d65 0a20 2020 2020 2020  e = name.       
+00019420: 2073 656c 662e 5f71 7565 7279 203d 2071   self._query = q
+00019430: 7565 7279 0a20 2020 2020 2020 2073 656c  uery.        sel
+00019440: 662e 5f64 6174 615f 666f 726d 6174 203d  f._data_format =
+00019450: 2064 6174 615f 666f 726d 6174 2e75 7070   data_format.upp
+00019460: 6572 2829 2069 6620 6461 7461 5f66 6f72  er() if data_for
+00019470: 6d61 7420 656c 7365 204e 6f6e 650a 2020  mat else None.  
+00019480: 2020 2020 2020 7365 6c66 2e5f 7061 7468        self._path
+00019490: 203d 2070 6174 680a 0a20 2020 2020 2020   = path..       
+000194a0: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
+000194b0: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+000194c0: 6665 6174 7572 652e 4665 6174 7572 652e  feature.Feature.
+000194d0: 6672 6f6d 5f72 6573 706f 6e73 655f 6a73  from_response_js
+000194e0: 6f6e 2866 6561 7429 2069 6620 6973 696e  on(feat) if isin
+000194f0: 7374 616e 6365 2866 6561 742c 2064 6963  stance(feat, dic
+00019500: 7429 2065 6c73 6520 6665 6174 0a20 2020  t) else feat.   
+00019510: 2020 2020 2020 2020 2066 6f72 2066 6561           for fea
+00019520: 7420 696e 2028 6665 6174 7572 6573 206f  t in (features o
+00019530: 7220 5b5d 290a 2020 2020 2020 2020 5d0a  r []).        ].
+00019540: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+00019550: 6561 7475 7265 5f67 726f 7570 5f65 6e67  eature_group_eng
+00019560: 696e 6520 3d20 280a 2020 2020 2020 2020  ine = (.        
+00019570: 2020 2020 6578 7465 726e 616c 5f66 6561      external_fea
+00019580: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
+00019590: 652e 4578 7465 726e 616c 4665 6174 7572  e.ExternalFeatur
+000195a0: 6547 726f 7570 456e 6769 6e65 2866 6561  eGroupEngine(fea
+000195b0: 7475 7265 7374 6f72 655f 6964 290a 2020  turestore_id).  
+000195c0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000195d0: 2069 6620 7365 6c66 2e5f 6964 3a0a 2020   if self._id:.  
+000195e0: 2020 2020 2020 2020 2020 2320 476f 7420            # Got 
+000195f0: 6672 6f6d 2048 6f70 7377 6f72 6b73 2c20  from Hopsworks, 
+00019600: 6465 7365 7269 616c 697a 6520 6665 6174  deserialize feat
+00019610: 7572 6573 2061 6e64 2073 746f 7261 6765  ures and storage
+00019620: 2063 6f6e 6e65 6374 6f72 0a20 2020 2020   connector.     
+00019630: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
+00019640: 7475 7265 7320 3d20 280a 2020 2020 2020  tures = (.      
+00019650: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00019660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019670: 6665 6174 7572 652e 4665 6174 7572 652e  feature.Feature.
+00019680: 6672 6f6d 5f72 6573 706f 6e73 655f 6a73  from_response_js
+00019690: 6f6e 2866 6561 7429 0a20 2020 2020 2020  on(feat).       
+000196a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000196b0: 6973 696e 7374 616e 6365 2866 6561 742c  isinstance(feat,
+000196c0: 2064 6963 7429 0a20 2020 2020 2020 2020   dict).         
+000196d0: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+000196e0: 6665 6174 0a20 2020 2020 2020 2020 2020  feat.           
+000196f0: 2020 2020 2020 2020 2066 6f72 2066 6561           for fea
+00019700: 7420 696e 2066 6561 7475 7265 730a 2020  t in features.  
+00019710: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00019720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019730: 6966 2066 6561 7475 7265 730a 2020 2020  if features.    
+00019740: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00019750: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00019760: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00019770: 7365 6c66 2e70 7269 6d61 7279 5f6b 6579  self.primary_key
+00019780: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00019790: 2020 2020 205b 6665 6174 2e6e 616d 6520       [feat.name 
+000197a0: 666f 7220 6665 6174 2069 6e20 7365 6c66  for feat in self
+000197b0: 2e5f 6665 6174 7572 6573 2069 6620 6665  ._features if fe
+000197c0: 6174 2e70 7269 6d61 7279 2069 7320 5472  at.primary is Tr
+000197d0: 7565 5d0a 2020 2020 2020 2020 2020 2020  ue].            
+000197e0: 2020 2020 6966 2073 656c 662e 5f66 6561      if self._fea
+000197f0: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
+00019800: 2020 2020 2020 656c 7365 205b 5d0a 2020        else [].  
+00019810: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00019820: 2020 2020 2020 2020 7365 6c66 2e73 7461          self.sta
+00019830: 7469 7374 6963 735f 636f 6e66 6967 203d  tistics_config =
+00019840: 2073 7461 7469 7374 6963 735f 636f 6e66   statistics_conf
+00019850: 6967 0a0a 2020 2020 2020 2020 2020 2020  ig..            
+00019860: 7365 6c66 2e5f 6f70 7469 6f6e 7320 3d20  self._options = 
+00019870: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00019880: 2020 7b6f 7074 696f 6e5b 226e 616d 6522    {option["name"
+00019890: 5d3a 206f 7074 696f 6e5b 2276 616c 7565  ]: option["value
+000198a0: 225d 2066 6f72 206f 7074 696f 6e20 696e  "] for option in
+000198b0: 206f 7074 696f 6e73 7d0a 2020 2020 2020   options}.      
+000198c0: 2020 2020 2020 2020 2020 6966 206f 7074            if opt
+000198d0: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+000198e0: 2020 2020 2065 6c73 6520 4e6f 6e65 0a20       else None. 
+000198f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00019900: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00019910: 2020 2020 2020 2073 656c 662e 7072 696d         self.prim
+00019920: 6172 795f 6b65 7920 3d20 7072 696d 6172  ary_key = primar
+00019930: 795f 6b65 790a 2020 2020 2020 2020 2020  y_key.          
+00019940: 2020 7365 6c66 2e73 7461 7469 7374 6963    self.statistic
+00019950: 735f 636f 6e66 6967 203d 2073 7461 7469  s_config = stati
+00019960: 7374 6963 735f 636f 6e66 6967 0a20 2020  stics_config.   
+00019970: 2020 2020 2020 2020 2073 656c 662e 5f66           self._f
+00019980: 6561 7475 7265 7320 3d20 6665 6174 7572  eatures = featur
+00019990: 6573 0a20 2020 2020 2020 2020 2020 2073  es.            s
+000199a0: 656c 662e 5f6f 7074 696f 6e73 203d 206f  elf._options = o
+000199b0: 7074 696f 6e73 0a0a 2020 2020 2020 2020  ptions..        
+000199c0: 6966 2073 746f 7261 6765 5f63 6f6e 6e65  if storage_conne
+000199d0: 6374 6f72 2069 7320 6e6f 7420 4e6f 6e65  ctor is not None
+000199e0: 2061 6e64 2069 7369 6e73 7461 6e63 6528   and isinstance(
+000199f0: 7374 6f72 6167 655f 636f 6e6e 6563 746f  storage_connecto
+00019a00: 722c 2064 6963 7429 3a0a 2020 2020 2020  r, dict):.      
+00019a10: 2020 2020 2020 7365 6c66 2e5f 7374 6f72        self._stor
+00019a20: 6167 655f 636f 6e6e 6563 746f 7220 3d20  age_connector = 
+00019a30: 7363 2e53 746f 7261 6765 436f 6e6e 6563  sc.StorageConnec
+00019a40: 746f 722e 6672 6f6d 5f72 6573 706f 6e73  tor.from_respons
+00019a50: 655f 6a73 6f6e 280a 2020 2020 2020 2020  e_json(.        
+00019a60: 2020 2020 2020 2020 7374 6f72 6167 655f          storage_
+00019a70: 636f 6e6e 6563 746f 720a 2020 2020 2020  connector.      
+00019a80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019a90: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00019aa0: 2020 7365 6c66 2e5f 7374 6f72 6167 655f    self._storage_
+00019ab0: 636f 6e6e 6563 746f 7220 3d20 7374 6f72  connector = stor
+00019ac0: 6167 655f 636f 6e6e 6563 746f 720a 0a20  age_connector.. 
+00019ad0: 2020 2020 2020 2073 656c 662e 5f68 7265         self._hre
+00019ae0: 6620 3d20 6872 6566 0a0a 2020 2020 6465  f = href..    de
+00019af0: 6620 7361 7665 2873 656c 6629 3a0a 2020  f save(self):.  
+00019b00: 2020 2020 2020 2222 2250 6572 7369 7374        """Persist
+00019b10: 2074 6865 206d 6574 6164 6174 6120 666f   the metadata fo
+00019b20: 7220 7468 6973 2065 7874 6572 6e61 6c20  r this external 
+00019b30: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
+00019b40: 2020 2020 2020 2020 5769 7468 6f75 7420          Without 
+00019b50: 6361 6c6c 696e 6720 7468 6973 206d 6574  calling this met
+00019b60: 686f 642c 2079 6f75 7220 6665 6174 7572  hod, your featur
+00019b70: 6520 6772 6f75 7020 7769 6c6c 206f 6e6c  e group will onl
+00019b80: 7920 6578 6973 740a 2020 2020 2020 2020  y exist.        
+00019b90: 696e 2079 6f75 7220 5079 7468 6f6e 204b  in your Python K
+00019ba0: 6572 6e65 6c2c 2062 7574 206e 6f74 2069  ernel, but not i
+00019bb0: 6e20 486f 7073 776f 726b 732e 0a0a 2020  n Hopsworks...  
+00019bc0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00019bd0: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
+00019be0: 2253 454c 4543 5420 2a20 4652 4f4d 2073  "SELECT * FROM s
+00019bf0: 616c 6573 220a 0a20 2020 2020 2020 2066  ales"..        f
+00019c00: 6720 3d20 6665 6174 7572 655f 7374 6f72  g = feature_stor
+00019c10: 652e 6372 6561 7465 5f65 7874 6572 6e61  e.create_externa
+00019c20: 6c5f 6665 6174 7572 655f 6772 6f75 7028  l_feature_group(
+00019c30: 6e61 6d65 3d22 7361 6c65 7322 2c0a 2020  name="sales",.  
+00019c40: 2020 2020 2020 2020 2020 7665 7273 696f            versio
+00019c50: 6e3d 312c 0a20 2020 2020 2020 2020 2020  n=1,.           
+00019c60: 2064 6573 6372 6970 7469 6f6e 3d22 5068   description="Ph
+00019c70: 7973 6963 616c 2073 686f 7020 7361 6c65  ysical shop sale
+00019c80: 7320 6665 6174 7572 6573 222c 0a20 2020  s features",.   
+00019c90: 2020 2020 2020 2020 2071 7565 7279 3d71           query=q
+00019ca0: 7565 7279 2c0a 2020 2020 2020 2020 2020  uery,.          
+00019cb0: 2020 7374 6f72 6167 655f 636f 6e6e 6563    storage_connec
+00019cc0: 746f 723d 636f 6e6e 6563 746f 722c 0a20  tor=connector,. 
+00019cd0: 2020 2020 2020 2020 2020 2070 7269 6d61             prima
+00019ce0: 7279 5f6b 6579 3d5b 2773 735f 7374 6f72  ry_key=['ss_stor
+00019cf0: 655f 736b 275d 2c0a 2020 2020 2020 2020  e_sk'],.        
+00019d00: 2020 2020 6576 656e 745f 7469 6d65 3d27      event_time='
+00019d10: 7361 6c65 5f64 6174 6527 0a20 2020 2020  sale_date'.     
+00019d20: 2020 2029 0a0a 2020 2020 2020 2020 6667     )..        fg
+00019d30: 2e73 6176 6528 290a 2020 2020 2020 2020  .save().        
+00019d40: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+00019d50: 2e5f 6665 6174 7572 655f 6772 6f75 705f  ._feature_group_
+00019d60: 656e 6769 6e65 2e73 6176 6528 7365 6c66  engine.save(self
+00019d70: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00019d80: 636f 6465 5f65 6e67 696e 652e 7361 7665  code_engine.save
+00019d90: 5f63 6f64 6528 7365 6c66 290a 0a20 2020  _code(self)..   
+00019da0: 2020 2020 2069 6620 7365 6c66 2e73 7461       if self.sta
+00019db0: 7469 7374 6963 735f 636f 6e66 6967 2e65  tistics_config.e
+00019dc0: 6e61 626c 6564 3a0a 2020 2020 2020 2020  nabled:.        
+00019dd0: 2020 2020 7365 6c66 2e5f 7374 6174 6973      self._statis
+00019de0: 7469 6373 5f65 6e67 696e 652e 636f 6d70  tics_engine.comp
+00019df0: 7574 655f 7374 6174 6973 7469 6373 2873  ute_statistics(s
+00019e00: 656c 6629 0a0a 2020 2020 6465 6620 696e  elf)..    def in
+00019e10: 7365 7274 280a 2020 2020 2020 2020 7365  sert(.        se
+00019e20: 6c66 2c0a 2020 2020 2020 2020 6665 6174  lf,.        feat
+00019e30: 7572 6573 3a20 556e 696f 6e5b 0a20 2020  ures: Union[.   
+00019e40: 2020 2020 2020 2020 2070 642e 4461 7461           pd.Data
+00019e50: 4672 616d 652c 0a20 2020 2020 2020 2020  Frame,.         
+00019e60: 2020 2054 7970 6556 6172 2822 7079 7370     TypeVar("pysp
+00019e70: 6172 6b2e 7371 6c2e 4461 7461 4672 616d  ark.sql.DataFram
+00019e80: 6522 292c 2020 2320 6e6f 7161 3a20 4638  e"),  # noqa: F8
+00019e90: 3231 0a20 2020 2020 2020 2020 2020 2054  21.            T
+00019ea0: 7970 6556 6172 2822 7079 7370 6172 6b2e  ypeVar("pyspark.
+00019eb0: 5244 4422 292c 2020 2320 6e6f 7161 3a20  RDD"),  # noqa: 
+00019ec0: 4638 3231 0a20 2020 2020 2020 2020 2020  F821.           
+00019ed0: 206e 702e 6e64 6172 7261 792c 0a20 2020   np.ndarray,.   
+00019ee0: 2020 2020 2020 2020 204c 6973 745b 6c69           List[li
+00019ef0: 7374 5d2c 0a20 2020 2020 2020 205d 2c0a  st],.        ],.
+00019f00: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
+00019f10: 7469 6f6e 733a 204f 7074 696f 6e61 6c5b  tions: Optional[
+00019f20: 4469 6374 5b73 7472 2c20 416e 795d 5d20  Dict[str, Any]] 
+00019f30: 3d20 7b7d 2c0a 2020 2020 2020 2020 7661  = {},.        va
+00019f40: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
+00019f50: 3a20 4f70 7469 6f6e 616c 5b44 6963 745b  : Optional[Dict[
+00019f60: 7374 722c 2041 6e79 5d5d 203d 207b 7d2c  str, Any]] = {},
+00019f70: 0a20 2020 2020 2020 2073 6176 655f 636f  .        save_co
+00019f80: 6465 3a20 4f70 7469 6f6e 616c 5b62 6f6f  de: Optional[boo
+00019f90: 6c5d 203d 2054 7275 652c 0a20 2020 2020  l] = True,.     
+00019fa0: 2020 2077 6169 743a 2062 6f6f 6c20 3d20     wait: bool = 
+00019fb0: 4661 6c73 652c 0a20 2020 2029 202d 3e20  False,.    ) -> 
+00019fc0: 5475 706c 655b 4f70 7469 6f6e 616c 5b4a  Tuple[Optional[J
+00019fd0: 6f62 5d2c 204f 7074 696f 6e61 6c5b 5661  ob], Optional[Va
+00019fe0: 6c69 6461 7469 6f6e 5265 706f 7274 5d5d  lidationReport]]
+00019ff0: 3a0a 2020 2020 2020 2020 6665 6174 7572  :.        featur
+0001a000: 655f 6461 7461 6672 616d 6520 3d20 656e  e_dataframe = en
+0001a010: 6769 6e65 2e67 6574 5f69 6e73 7461 6e63  gine.get_instanc
+0001a020: 6528 292e 636f 6e76 6572 745f 746f 5f64  e().convert_to_d
+0001a030: 6566 6175 6c74 5f64 6174 6166 7261 6d65  efault_dataframe
+0001a040: 2866 6561 7475 7265 7329 0a0a 2020 2020  (features)..    
+0001a050: 2020 2020 6966 2077 7269 7465 5f6f 7074      if write_opt
+0001a060: 696f 6e73 2069 7320 4e6f 6e65 3a0a 2020  ions is None:.  
+0001a070: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+0001a080: 6f70 7469 6f6e 7320 3d20 7b7d 0a20 2020  options = {}.   
+0001a090: 2020 2020 2069 6620 2277 6169 745f 666f       if "wait_fo
+0001a0a0: 725f 6a6f 6222 206e 6f74 2069 6e20 7772  r_job" not in wr
+0001a0b0: 6974 655f 6f70 7469 6f6e 733a 0a20 2020  ite_options:.   
+0001a0c0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
+0001a0d0: 7074 696f 6e73 5b22 7761 6974 5f66 6f72  ptions["wait_for
+0001a0e0: 5f6a 6f62 225d 203d 2077 6169 740a 0a20  _job"] = wait.. 
+0001a0f0: 2020 2020 2020 206a 6f62 2c20 6765 5f72         job, ge_r
+0001a100: 6570 6f72 7420 3d20 7365 6c66 2e5f 6665  eport = self._fe
+0001a110: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
+0001a120: 6e65 2e69 6e73 6572 7428 0a20 2020 2020  ne.insert(.     
+0001a130: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001a140: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+0001a150: 5f64 6174 6166 7261 6d65 3d66 6561 7475  _dataframe=featu
+0001a160: 7265 5f64 6174 6166 7261 6d65 2c0a 2020  re_dataframe,.  
+0001a170: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+0001a180: 6f70 7469 6f6e 733d 7772 6974 655f 6f70  options=write_op
+0001a190: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0001a1a0: 2020 2076 616c 6964 6174 696f 6e5f 6f70     validation_op
+0001a1b0: 7469 6f6e 733d 7b22 7361 7665 5f72 6570  tions={"save_rep
+0001a1c0: 6f72 7422 3a20 5472 7565 2c20 2a2a 7661  ort": True, **va
+0001a1d0: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
+0001a1e0: 7d2c 0a20 2020 2020 2020 2029 0a0a 2020  },.        )..  
+0001a1f0: 2020 2020 2020 6966 2073 6176 655f 636f        if save_co
+0001a200: 6465 2061 6e64 2028 0a20 2020 2020 2020  de and (.       
+0001a210: 2020 2020 2067 655f 7265 706f 7274 2069       ge_report i
+0001a220: 7320 4e6f 6e65 206f 7220 6765 5f72 6570  s None or ge_rep
+0001a230: 6f72 742e 696e 6765 7374 696f 6e5f 7265  ort.ingestion_re
+0001a240: 7375 6c74 203d 3d20 2249 4e47 4553 5445  sult == "INGESTE
+0001a250: 4422 0a20 2020 2020 2020 2029 3a0a 2020  D".        ):.  
+0001a260: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0001a270: 636f 6465 5f65 6e67 696e 652e 7361 7665  code_engine.save
+0001a280: 5f63 6f64 6528 7365 6c66 290a 0a20 2020  _code(self)..   
+0001a290: 2020 2020 2069 6620 7365 6c66 2e73 7461       if self.sta
+0001a2a0: 7469 7374 6963 735f 636f 6e66 6967 2e65  tistics_config.e
+0001a2b0: 6e61 626c 6564 3a0a 2020 2020 2020 2020  nabled:.        
+0001a2c0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+0001a2d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0001a2e0: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+0001a2f0: 2020 2020 2020 2020 2022 5374 6174 6973           "Statis
+0001a300: 7469 6373 2061 7265 206e 6f74 2063 6f6d  tics are not com
+0001a310: 7075 7465 6420 666f 7220 696e 7365 7274  puted for insert
+0001a320: 696f 6e20 746f 206f 6e6c 696e 6520 656e  ion to online en
+0001a330: 6162 6c65 6420 6578 7465 726e 616c 2066  abled external f
+0001a340: 6561 7475 7265 2067 726f 7570 2060 7b7d  eature group `{}
+0001a350: 602c 2077 6974 6820 7665 7273 696f 6e22  `, with version"
+0001a360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a370: 2020 2020 2022 2060 7b7d 602e 2043 616c       " `{}`. Cal
+0001a380: 6c20 6063 6f6d 7075 7465 5f73 7461 7469  l `compute_stati
+0001a390: 7374 6963 7360 2065 7870 6c69 6369 746c  stics` explicitl
+0001a3a0: 7920 746f 2063 6f6d 7075 7465 2073 7461  y to compute sta
+0001a3b0: 7469 7374 6963 7320 6f76 6572 2074 6865  tistics over the
+0001a3c0: 2064 6174 6120 696e 2074 6865 2065 7874   data in the ext
+0001a3d0: 6572 6e61 6c20 7374 6f72 6167 6520 7379  ernal storage sy
+0001a3e0: 7374 656d 2e22 0a20 2020 2020 2020 2020  stem.".         
+0001a3f0: 2020 2020 2020 2029 2e66 6f72 6d61 7428         ).format(
+0001a400: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+0001a410: 2e5f 7665 7273 696f 6e29 2c0a 2020 2020  ._version),.    
+0001a420: 2020 2020 2020 2020 2020 2020 7574 696c              util
+0001a430: 2e53 746f 7261 6765 5761 726e 696e 672c  .StorageWarning,
+0001a440: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0001a450: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+0001a460: 0a20 2020 2020 2020 2020 2020 206a 6f62  .            job
+0001a470: 2c0a 2020 2020 2020 2020 2020 2020 6765  ,.            ge
+0001a480: 5f72 6570 6f72 742e 746f 5f67 655f 7479  _report.to_ge_ty
+0001a490: 7065 2829 2069 6620 6765 5f72 6570 6f72  pe() if ge_repor
+0001a4a0: 7420 6973 206e 6f74 204e 6f6e 6520 656c  t is not None el
+0001a4b0: 7365 204e 6f6e 652c 0a20 2020 2020 2020  se None,.       
+0001a4c0: 2029 0a0a 2020 2020 6465 6620 7265 6164   )..    def read
+0001a4d0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
+0001a4e0: 6461 7461 6672 616d 655f 7479 7065 3a20  dataframe_type: 
+0001a4f0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0001a500: 2264 6566 6175 6c74 222c 206f 6e6c 696e  "default", onlin
+0001a510: 653a 204f 7074 696f 6e61 6c5b 626f 6f6c  e: Optional[bool
+0001a520: 5d20 3d20 4661 6c73 650a 2020 2020 293a  ] = False.    ):
+0001a530: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
+0001a540: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+0001a550: 7020 6173 2061 2044 6174 6146 7261 6d65  p as a DataFrame
+0001a560: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+0001a570: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+0001a580: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+0001a590: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
+0001a5a0: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
+0001a5b0: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
+0001a5c0: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
+0001a5d0: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+0001a5e0: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+0001a5f0: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
+0001a600: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
+0001a610: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+0001a620: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
+0001a630: 0a20 2020 2020 2020 2020 2020 2064 6620  .            df 
+0001a640: 3d20 6667 2e72 6561 6428 290a 2020 2020  = fg.read().    
+0001a650: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+0001a660: 2020 2020 2021 2121 2077 6172 6e69 6e67       !!! warning
+0001a670: 2022 456e 6769 6e65 2053 7570 706f 7274   "Engine Support
+0001a680: 220a 2020 2020 2020 2020 2020 2020 2a2a  ".            **
+0001a690: 5370 6172 6b20 6f6e 6c79 2a2a 0a0a 2020  Spark only**..  
+0001a6a0: 2020 2020 2020 2020 2020 5265 6164 696e            Readin
+0001a6b0: 6720 616e 2045 7874 6572 6e61 6c20 4665  g an External Fe
+0001a6c0: 6174 7572 6520 4772 6f75 7020 6469 7265  ature Group dire
+0001a6d0: 6374 6c79 2069 6e74 6f20 6120 5061 6e64  ctly into a Pand
+0001a6e0: 6173 2044 6174 6166 7261 6d65 2075 7369  as Dataframe usi
+0001a6f0: 6e67 0a20 2020 2020 2020 2020 2020 2050  ng.            P
+0001a700: 7974 686f 6e2f 5061 6e64 6173 2061 7320  ython/Pandas as 
+0001a710: 456e 6769 6e65 2069 7320 6e6f 7420 7375  Engine is not su
+0001a720: 7070 6f72 7465 642c 2068 6f77 6576 6572  pported, however
+0001a730: 2c20 796f 7520 6361 6e20 7573 6520 7468  , you can use th
+0001a740: 650a 2020 2020 2020 2020 2020 2020 5175  e.            Qu
+0001a750: 6572 7920 4150 4920 746f 2063 7265 6174  ery API to creat
+0001a760: 6520 4665 6174 7572 6520 5669 6577 732f  e Feature Views/
+0001a770: 5472 6169 6e69 6e67 2044 6174 6120 636f  Training Data co
+0001a780: 6e74 6169 6e69 6e67 2045 7874 6572 6e61  ntaining Externa
+0001a790: 6c0a 2020 2020 2020 2020 2020 2020 4665  l.            Fe
+0001a7a0: 6174 7572 6520 4772 6f75 7073 2e0a 0a20  ature Groups... 
+0001a7b0: 2020 2020 2020 2023 2041 7267 756d 656e         # Argumen
+0001a7c0: 7473 0a20 2020 2020 2020 2020 2020 2064  ts.            d
+0001a7d0: 6174 6166 7261 6d65 5f74 7970 653a 2073  ataframe_type: s
+0001a7e0: 7472 2c20 6f70 7469 6f6e 616c 2e20 506f  tr, optional. Po
+0001a7f0: 7373 6962 6c65 2076 616c 7565 7320 6172  ssible values ar
+0001a800: 6520 6022 6465 6661 756c 7422 602c 2060  e `"default"`, `
+0001a810: 2273 7061 726b 2260 2c0a 2020 2020 2020  "spark"`,.      
+0001a820: 2020 2020 2020 2020 2020 6022 7061 6e64            `"pand
+0001a830: 6173 2260 2c20 6022 6e75 6d70 7922 6020  as"`, `"numpy"` 
+0001a840: 6f72 2060 2270 7974 686f 6e22 602c 2064  or `"python"`, d
+0001a850: 6566 6175 6c74 7320 746f 2060 2264 6566  efaults to `"def
+0001a860: 6175 6c74 2260 2e0a 2020 2020 2020 2020  ault"`..        
+0001a870: 2020 2020 6f6e 6c69 6e65 3a20 626f 6f6c      online: bool
+0001a880: 2c20 6f70 7469 6f6e 616c 2e20 4966 2060  , optional. If `
+0001a890: 5472 7565 6020 7265 6164 2066 726f 6d20  True` read from 
+0001a8a0: 6f6e 6c69 6e65 2066 6561 7475 7265 2073  online feature s
+0001a8b0: 746f 7265 2c20 6465 6661 756c 7473 0a20  tore, defaults. 
+0001a8c0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0001a8d0: 6f20 6046 616c 7365 602e 0a0a 2020 2020  o `False`...    
+0001a8e0: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
+0001a8f0: 2020 2020 2020 2020 2020 6044 6174 6146            `DataF
+0001a900: 7261 6d65 603a 2054 6865 2073 7061 726b  rame`: The spark
+0001a910: 2064 6174 6166 7261 6d65 2063 6f6e 7461   dataframe conta
+0001a920: 696e 696e 6720 7468 6520 6665 6174 7572  ining the featur
+0001a930: 6520 6461 7461 2e0a 2020 2020 2020 2020  e data..        
+0001a940: 2020 2020 6070 7973 7061 726b 2e44 6174      `pyspark.Dat
+0001a950: 6146 7261 6d65 602e 2041 2053 7061 726b  aFrame`. A Spark
+0001a960: 2044 6174 6146 7261 6d65 2e0a 2020 2020   DataFrame..    
+0001a970: 2020 2020 2020 2020 6070 616e 6461 732e          `pandas.
+0001a980: 4461 7461 4672 616d 6560 2e20 4120 5061  DataFrame`. A Pa
+0001a990: 6e64 6173 2044 6174 6146 7261 6d65 2e0a  ndas DataFrame..
+0001a9a0: 2020 2020 2020 2020 2020 2020 606e 756d              `num
+0001a9b0: 7079 2e6e 6461 7272 6179 602e 2041 2074  py.ndarray`. A t
+0001a9c0: 776f 2d64 696d 656e 7369 6f6e 616c 204e  wo-dimensional N
+0001a9d0: 756d 7079 2061 7272 6179 2e0a 2020 2020  umpy array..    
+0001a9e0: 2020 2020 2020 2020 606c 6973 7460 2e20          `list`. 
+0001a9f0: 4120 7477 6f2d 6469 6d65 6e73 696f 6e61  A two-dimensiona
+0001aa00: 6c20 5079 7468 6f6e 206c 6973 742e 0a0a  l Python list...
+0001aa10: 2020 2020 2020 2020 2320 5261 6973 6573          # Raises
+0001aa20: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
+0001aa30: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
+0001aa40: 696f 6e73 2e52 6573 7441 5049 4572 726f  ions.RestAPIErro
+0001aa50: 7260 2e0a 2020 2020 2020 2020 2222 220a  r`..        """.
+0001aa60: 2020 2020 2020 2020 6966 2065 6e67 696e          if engin
+0001aa70: 652e 6765 745f 7479 7065 2829 203d 3d20  e.get_type() == 
+0001aa80: 2270 7974 686f 6e22 2061 6e64 206e 6f74  "python" and not
+0001aa90: 206f 6e6c 696e 653a 0a20 2020 2020 2020   online:.       
+0001aaa0: 2020 2020 2072 6169 7365 2046 6561 7475       raise Featu
+0001aab0: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
+0001aac0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001aad0: 2020 2252 6561 6469 6e67 2061 6e20 4578    "Reading an Ex
+0001aae0: 7465 726e 616c 2046 6561 7475 7265 2047  ternal Feature G
+0001aaf0: 726f 7570 2064 6972 6563 746c 7920 696e  roup directly in
+0001ab00: 746f 2061 2050 616e 6461 7320 4461 7461  to a Pandas Data
+0001ab10: 6672 616d 6520 7573 696e 6720 220a 2020  frame using ".  
+0001ab20: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+0001ab30: 2250 7974 686f 6e2f 5061 6e64 6173 2061  "Python/Pandas a
+0001ab40: 7320 456e 6769 6e65 2066 726f 6d20 7468  s Engine from th
+0001ab50: 6520 6578 7465 726e 616c 2073 746f 7261  e external stora
+0001ab60: 6765 2073 7973 7465 6d20 220a 2020 2020  ge system ".    
+0001ab70: 2020 2020 2020 2020 2020 2020 2b20 2269              + "i
+0001ab80: 7320 6e6f 7420 7375 7070 6f72 7465 642c  s not supported,
+0001ab90: 2068 6f77 6576 6572 2c20 6966 2074 6865   however, if the
+0001aba0: 2066 6561 7475 7265 2067 726f 7570 2069   feature group i
+0001abb0: 7320 6f6e 6c69 6e65 2065 6e61 626c 6564  s online enabled
+0001abc0: 2c20 796f 7520 6361 6e20 7265 6164 2022  , you can read "
+0001abd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001abe0: 202b 2022 6672 6f6d 206f 6e6c 696e 6520   + "from online 
+0001abf0: 7374 6f72 6167 6520 6f72 2079 6f75 2063  storage or you c
+0001ac00: 616e 2075 7365 2074 6865 2022 0a20 2020  an use the ".   
+0001ac10: 2020 2020 2020 2020 2020 2020 202b 2022               + "
+0001ac20: 5175 6572 7920 4150 4920 746f 2063 7265  Query API to cre
+0001ac30: 6174 6520 4665 6174 7572 6520 5669 6577  ate Feature View
+0001ac40: 732f 5472 6169 6e69 6e67 2044 6174 6120  s/Training Data 
+0001ac50: 636f 6e74 6169 6e69 6e67 2045 7874 6572  containing Exter
+0001ac60: 6e61 6c20 220a 2020 2020 2020 2020 2020  nal ".          
+0001ac70: 2020 2020 2020 2b20 2246 6561 7475 7265        + "Feature
+0001ac80: 2047 726f 7570 732e 220a 2020 2020 2020   Groups.".      
+0001ac90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001aca0: 656e 6769 6e65 2e67 6574 5f69 6e73 7461  engine.get_insta
+0001acb0: 6e63 6528 292e 7365 745f 6a6f 625f 6772  nce().set_job_gr
+0001acc0: 6f75 7028 0a20 2020 2020 2020 2020 2020  oup(.           
+0001acd0: 2022 4665 7463 6869 6e67 2046 6561 7475   "Fetching Featu
+0001ace0: 7265 2067 726f 7570 222c 0a20 2020 2020  re group",.     
+0001acf0: 2020 2020 2020 2022 4765 7474 696e 6720         "Getting 
+0001ad00: 6665 6174 7572 6520 6772 6f75 703a 207b  feature group: {
+0001ad10: 7d20 6672 6f6d 2074 6865 2066 6561 7475  } from the featu
+0001ad20: 7265 7374 6f72 6520 7b7d 222e 666f 726d  restore {}".form
+0001ad30: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
+0001ad40: 2020 2020 7365 6c66 2e5f 6e61 6d65 2c20      self._name, 
+0001ad50: 7365 6c66 2e5f 6665 6174 7572 655f 7374  self._feature_st
+0001ad60: 6f72 655f 6e61 6d65 0a20 2020 2020 2020  ore_name.       
+0001ad70: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+0001ad80: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+0001ad90: 2073 656c 662e 7365 6c65 6374 5f61 6c6c   self.select_all
+0001ada0: 2829 2e72 6561 6428 6461 7461 6672 616d  ().read(datafram
+0001adb0: 655f 7479 7065 3d64 6174 6166 7261 6d65  e_type=dataframe
+0001adc0: 5f74 7970 652c 206f 6e6c 696e 653d 6f6e  _type, online=on
+0001add0: 6c69 6e65 290a 0a20 2020 2064 6566 2073  line)..    def s
+0001ade0: 686f 7728 7365 6c66 2c20 6e29 3a0a 2020  how(self, n):.  
+0001adf0: 2020 2020 2020 2222 2253 686f 7720 7468        """Show th
+0001ae00: 6520 6669 7273 7420 6e20 726f 7773 206f  e first n rows o
+0001ae10: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
+0001ae20: 6f75 702e 0a0a 2020 2020 2020 2020 2121  oup...        !!
+0001ae30: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+0001ae40: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+0001ae50: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+0001ae60: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+0001ae70: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+0001ae80: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+0001ae90: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+0001aea0: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+0001aeb0: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+0001aec0: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+0001aed0: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+0001aee0: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+0001aef0: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+0001af00: 6667 2e73 686f 7728 3529 0a20 2020 2020  fg.show(5).     
+0001af10: 2020 2020 2020 2060 6060 0a20 2020 2020         ```.     
+0001af20: 2020 2022 2222 0a20 2020 2020 2020 2065     """.        e
+0001af30: 6e67 696e 652e 6765 745f 696e 7374 616e  ngine.get_instan
+0001af40: 6365 2829 2e73 6574 5f6a 6f62 5f67 726f  ce().set_job_gro
+0001af50: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
+0001af60: 2246 6574 6368 696e 6720 4665 6174 7572  "Fetching Featur
+0001af70: 6520 6772 6f75 7022 2c0a 2020 2020 2020  e group",.      
+0001af80: 2020 2020 2020 2247 6574 7469 6e67 2066        "Getting f
+0001af90: 6561 7475 7265 2067 726f 7570 3a20 7b7d  eature group: {}
+0001afa0: 2066 726f 6d20 7468 6520 6665 6174 7572   from the featur
+0001afb0: 6573 746f 7265 207b 7d22 2e66 6f72 6d61  estore {}".forma
+0001afc0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0001afd0: 2020 2073 656c 662e 5f6e 616d 652c 2073     self._name, s
+0001afe0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
+0001aff0: 7265 5f6e 616d 650a 2020 2020 2020 2020  re_name.        
+0001b000: 2020 2020 292c 0a20 2020 2020 2020 2029      ),.        )
+0001b010: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001b020: 7365 6c66 2e73 656c 6563 745f 616c 6c28  self.select_all(
+0001b030: 292e 7368 6f77 286e 290a 0a20 2020 2040  ).show(n)..    @
+0001b040: 636c 6173 736d 6574 686f 640a 2020 2020  classmethod.    
+0001b050: 6465 6620 6672 6f6d 5f72 6573 706f 6e73  def from_respons
+0001b060: 655f 6a73 6f6e 2863 6c73 2c20 6a73 6f6e  e_json(cls, json
+0001b070: 5f64 6963 7429 3a0a 2020 2020 2020 2020  _dict):.        
+0001b080: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
+0001b090: 203d 2068 756d 7073 2e64 6563 616d 656c   = humps.decamel
+0001b0a0: 697a 6528 6a73 6f6e 5f64 6963 7429 0a20  ize(json_dict). 
+0001b0b0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0001b0c0: 616e 6365 286a 736f 6e5f 6465 6361 6d65  ance(json_decame
+0001b0d0: 6c69 7a65 642c 2064 6963 7429 3a0a 2020  lized, dict):.  
+0001b0e0: 2020 2020 2020 2020 2020 5f20 3d20 6a73            _ = js
+0001b0f0: 6f6e 5f64 6563 616d 656c 697a 6564 2e70  on_decamelized.p
+0001b100: 6f70 2822 7479 7065 222c 204e 6f6e 6529  op("type", None)
+0001b110: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001b120: 7572 6e20 636c 7328 2a2a 6a73 6f6e 5f64  urn cls(**json_d
+0001b130: 6563 616d 656c 697a 6564 290a 2020 2020  ecamelized).    
+0001b140: 2020 2020 666f 7220 6667 2069 6e20 6a73      for fg in js
+0001b150: 6f6e 5f64 6563 616d 656c 697a 6564 3a0a  on_decamelized:.
+0001b160: 2020 2020 2020 2020 2020 2020 5f20 3d20              _ = 
+0001b170: 6667 2e70 6f70 2822 7479 7065 222c 204e  fg.pop("type", N
+0001b180: 6f6e 6529 0a20 2020 2020 2020 2072 6574  one).        ret
+0001b190: 7572 6e20 5b63 6c73 282a 2a66 6729 2066  urn [cls(**fg) f
+0001b1a0: 6f72 2066 6720 696e 206a 736f 6e5f 6465  or fg in json_de
+0001b1b0: 6361 6d65 6c69 7a65 645d 0a0a 2020 2020  camelized]..    
+0001b1c0: 6465 6620 7570 6461 7465 5f66 726f 6d5f  def update_from_
+0001b1d0: 7265 7370 6f6e 7365 5f6a 736f 6e28 7365  response_json(se
+0001b1e0: 6c66 2c20 6a73 6f6e 5f64 6963 7429 3a0a  lf, json_dict):.
+0001b1f0: 2020 2020 2020 2020 6a73 6f6e 5f64 6563          json_dec
+0001b200: 616d 656c 697a 6564 203d 2068 756d 7073  amelized = humps
+0001b210: 2e64 6563 616d 656c 697a 6528 6a73 6f6e  .decamelize(json
+0001b220: 5f64 6963 7429 0a20 2020 2020 2020 2069  _dict).        i
+0001b230: 6620 2274 7970 6522 2069 6e20 6a73 6f6e  f "type" in json
+0001b240: 5f64 6563 616d 656c 697a 6564 3a0a 2020  _decamelized:.  
+0001b250: 2020 2020 2020 2020 2020 5f20 3d20 6a73            _ = js
+0001b260: 6f6e 5f64 6563 616d 656c 697a 6564 2e70  on_decamelized.p
+0001b270: 6f70 2822 7479 7065 2229 0a20 2020 2020  op("type").     
+0001b280: 2020 2073 656c 662e 5f5f 696e 6974 5f5f     self.__init__
+0001b290: 282a 2a6a 736f 6e5f 6465 6361 6d65 6c69  (**json_decameli
+0001b2a0: 7a65 6429 0a20 2020 2020 2020 2072 6574  zed).        ret
+0001b2b0: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+0001b2c0: 6620 6a73 6f6e 2873 656c 6629 3a0a 2020  f json(self):.  
+0001b2d0: 2020 2020 2020 7265 7475 726e 206a 736f        return jso
+0001b2e0: 6e2e 6475 6d70 7328 7365 6c66 2c20 636c  n.dumps(self, cl
+0001b2f0: 733d 7574 696c 2e46 6561 7475 7265 5374  s=util.FeatureSt
+0001b300: 6f72 6545 6e63 6f64 6572 290a 0a20 2020  oreEncoder)..   
+0001b310: 2064 6566 2074 6f5f 6469 6374 2873 656c   def to_dict(sel
+0001b320: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0001b330: 726e 207b 0a20 2020 2020 2020 2020 2020  rn {.           
+0001b340: 2022 6964 223a 2073 656c 662e 5f69 642c   "id": self._id,
+0001b350: 0a20 2020 2020 2020 2020 2020 2022 6e61  .            "na
+0001b360: 6d65 223a 2073 656c 662e 5f6e 616d 652c  me": self._name,
+0001b370: 0a20 2020 2020 2020 2020 2020 2022 6465  .            "de
+0001b380: 7363 7269 7074 696f 6e22 3a20 7365 6c66  scription": self
+0001b390: 2e5f 6465 7363 7269 7074 696f 6e2c 0a20  ._description,. 
+0001b3a0: 2020 2020 2020 2020 2020 2022 7665 7273             "vers
+0001b3b0: 696f 6e22 3a20 7365 6c66 2e5f 7665 7273  ion": self._vers
+0001b3c0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001b3d0: 2022 6665 6174 7572 6573 223a 2073 656c   "features": sel
+0001b3e0: 662e 5f66 6561 7475 7265 732c 0a20 2020  f._features,.   
+0001b3f0: 2020 2020 2020 2020 2022 6665 6174 7572           "featur
+0001b400: 6573 746f 7265 4964 223a 2073 656c 662e  estoreId": self.
+0001b410: 5f66 6561 7475 7265 5f73 746f 7265 5f69  _feature_store_i
+0001b420: 642c 0a20 2020 2020 2020 2020 2020 2022  d,.            "
+0001b430: 7175 6572 7922 3a20 7365 6c66 2e5f 7175  query": self._qu
+0001b440: 6572 792c 0a20 2020 2020 2020 2020 2020  ery,.           
+0001b450: 2022 6461 7461 466f 726d 6174 223a 2073   "dataFormat": s
+0001b460: 656c 662e 5f64 6174 615f 666f 726d 6174  elf._data_format
+0001b470: 2c0a 2020 2020 2020 2020 2020 2020 2270  ,.            "p
+0001b480: 6174 6822 3a20 7365 6c66 2e5f 7061 7468  ath": self._path
+0001b490: 2c0a 2020 2020 2020 2020 2020 2020 226f  ,.            "o
+0001b4a0: 7074 696f 6e73 223a 205b 7b22 6e61 6d65  ptions": [{"name
+0001b4b0: 223a 206b 2c20 2276 616c 7565 223a 2076  ": k, "value": v
+0001b4c0: 7d20 666f 7220 6b2c 2076 2069 6e20 7365  } for k, v in se
+0001b4d0: 6c66 2e5f 6f70 7469 6f6e 732e 6974 656d  lf._options.item
+0001b4e0: 7328 295d 0a20 2020 2020 2020 2020 2020  s()].           
+0001b4f0: 2069 6620 7365 6c66 2e5f 6f70 7469 6f6e   if self._option
+0001b500: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+0001b510: 7365 204e 6f6e 652c 0a20 2020 2020 2020  se None,.       
+0001b520: 2020 2020 2022 7374 6f72 6167 6543 6f6e       "storageCon
+0001b530: 6e65 6374 6f72 223a 2073 656c 662e 5f73  nector": self._s
+0001b540: 746f 7261 6765 5f63 6f6e 6e65 6374 6f72  torage_connector
+0001b550: 2e74 6f5f 6469 6374 2829 2c0a 2020 2020  .to_dict(),.    
+0001b560: 2020 2020 2020 2020 2274 7970 6522 3a20          "type": 
+0001b570: 226f 6e44 656d 616e 6446 6561 7475 7265  "onDemandFeature
+0001b580: 6772 6f75 7044 544f 222c 0a20 2020 2020  groupDTO",.     
+0001b590: 2020 2020 2020 2022 7374 6174 6973 7469         "statisti
+0001b5a0: 6373 436f 6e66 6967 223a 2073 656c 662e  csConfig": self.
+0001b5b0: 5f73 7461 7469 7374 6963 735f 636f 6e66  _statistics_conf
+0001b5c0: 6967 2c0a 2020 2020 2020 2020 2020 2020  ig,.            
+0001b5d0: 2265 7665 6e74 5469 6d65 223a 2073 656c  "eventTime": sel
+0001b5e0: 662e 5f65 7665 6e74 5f74 696d 652c 0a20  f._event_time,. 
+0001b5f0: 2020 2020 2020 2020 2020 2022 6578 7065             "expe
+0001b600: 6374 6174 696f 6e53 7569 7465 223a 2073  ctationSuite": s
+0001b610: 656c 662e 5f65 7870 6563 7461 7469 6f6e  elf._expectation
+0001b620: 5f73 7569 7465 2c0a 2020 2020 2020 2020  _suite,.        
+0001b630: 2020 2020 226f 6e6c 696e 6545 6e61 626c      "onlineEnabl
+0001b640: 6564 223a 2073 656c 662e 5f6f 6e6c 696e  ed": self._onlin
+0001b650: 655f 656e 6162 6c65 642c 0a20 2020 2020  e_enabled,.     
+0001b660: 2020 2020 2020 2022 7370 696e 6522 3a20         "spine": 
+0001b670: 4661 6c73 652c 0a20 2020 2020 2020 207d  False,.        }
+0001b680: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+0001b690: 2020 2020 6465 6620 6964 2873 656c 6629      def id(self)
+0001b6a0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001b6b0: 2073 656c 662e 5f69 640a 0a20 2020 2040   self._id..    @
+0001b6c0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0001b6d0: 206e 616d 6528 7365 6c66 293a 0a20 2020   name(self):.   
+0001b6e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001b6f0: 2e5f 6e61 6d65 0a0a 2020 2020 4070 726f  ._name..    @pro
+0001b700: 7065 7274 790a 2020 2020 6465 6620 7665  perty.    def ve
+0001b710: 7273 696f 6e28 7365 6c66 293a 0a20 2020  rsion(self):.   
+0001b720: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001b730: 2e5f 7665 7273 696f 6e0a 0a20 2020 2040  ._version..    @
+0001b740: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0001b750: 2064 6573 6372 6970 7469 6f6e 2873 656c   description(sel
+0001b760: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+0001b770: 726e 2073 656c 662e 5f64 6573 6372 6970  rn self._descrip
+0001b780: 7469 6f6e 0a0a 2020 2020 4070 726f 7065  tion..    @prope
+0001b790: 7274 790a 2020 2020 6465 6620 7175 6572  rty.    def quer
+0001b7a0: 7928 7365 6c66 293a 0a20 2020 2020 2020  y(self):.       
+0001b7b0: 2072 6574 7572 6e20 7365 6c66 2e5f 7175   return self._qu
+0001b7c0: 6572 790a 0a20 2020 2040 7072 6f70 6572  ery..    @proper
+0001b7d0: 7479 0a20 2020 2064 6566 2064 6174 615f  ty.    def data_
+0001b7e0: 666f 726d 6174 2873 656c 6629 3a0a 2020  format(self):.  
+0001b7f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0001b800: 662e 5f64 6174 615f 666f 726d 6174 0a0a  f._data_format..
+0001b810: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0001b820: 2020 6465 6620 7061 7468 2873 656c 6629    def path(self)
+0001b830: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001b840: 2073 656c 662e 5f70 6174 680a 0a20 2020   self._path..   
+0001b850: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0001b860: 6566 206f 7074 696f 6e73 2873 656c 6629  ef options(self)
+0001b870: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001b880: 2073 656c 662e 5f6f 7074 696f 6e73 0a0a   self._options..
+0001b890: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0001b8a0: 2020 6465 6620 7374 6f72 6167 655f 636f    def storage_co
+0001b8b0: 6e6e 6563 746f 7228 7365 6c66 293a 0a20  nnector(self):. 
+0001b8c0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001b8d0: 6c66 2e5f 7374 6f72 6167 655f 636f 6e6e  lf._storage_conn
+0001b8e0: 6563 746f 720a 0a20 2020 2040 7072 6f70  ector..    @prop
+0001b8f0: 6572 7479 0a20 2020 2064 6566 2063 7265  erty.    def cre
+0001b900: 6174 6f72 2873 656c 6629 3a0a 2020 2020  ator(self):.    
+0001b910: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0001b920: 5f63 7265 6174 6f72 0a0a 2020 2020 4070  _creator..    @p
+0001b930: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0001b940: 6372 6561 7465 6428 7365 6c66 293a 0a20  created(self):. 
+0001b950: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001b960: 6c66 2e5f 6372 6561 7465 640a 0a20 2020  lf._created..   
+0001b970: 2040 7665 7273 696f 6e2e 7365 7474 6572   @version.setter
+0001b980: 0a20 2020 2064 6566 2076 6572 7369 6f6e  .    def version
+0001b990: 2873 656c 662c 2076 6572 7369 6f6e 293a  (self, version):
+0001b9a0: 0a20 2020 2020 2020 2073 656c 662e 5f76  .        self._v
+0001b9b0: 6572 7369 6f6e 203d 2076 6572 7369 6f6e  ersion = version
+0001b9c0: 0a0a 2020 2020 4064 6573 6372 6970 7469  ..    @descripti
+0001b9d0: 6f6e 2e73 6574 7465 720a 2020 2020 6465  on.setter.    de
+0001b9e0: 6620 6465 7363 7269 7074 696f 6e28 7365  f description(se
+0001b9f0: 6c66 2c20 6e65 775f 6465 7363 7269 7074  lf, new_descript
+0001ba00: 696f 6e29 3a0a 2020 2020 2020 2020 7365  ion):.        se
+0001ba10: 6c66 2e5f 6465 7363 7269 7074 696f 6e20  lf._description 
+0001ba20: 3d20 6e65 775f 6465 7363 7269 7074 696f  = new_descriptio
+0001ba30: 6e0a 0a20 2020 2040 7072 6f70 6572 7479  n..    @property
+0001ba40: 0a20 2020 2064 6566 2066 6561 7475 7265  .    def feature
+0001ba50: 5f73 746f 7265 5f6e 616d 6528 7365 6c66  _store_name(self
+0001ba60: 293a 0a20 2020 2020 2020 2022 2222 4e61  ):.        """Na
+0001ba70: 6d65 206f 6620 7468 6520 6665 6174 7572  me of the featur
+0001ba80: 6520 7374 6f72 6520 696e 2077 6869 6368  e store in which
+0001ba90: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+0001baa0: 7570 2069 7320 6c6f 6361 7465 642e 2222  up is located.""
+0001bab0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+0001bac0: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
+0001bad0: 746f 7265 5f6e 616d 650a 0a20 2020 2040  tore_name..    @
+0001bae0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+0001baf0: 2066 6561 7475 7265 5f73 746f 7265 5f69   feature_store_i
+0001bb00: 6428 7365 6c66 293a 0a20 2020 2020 2020  d(self):.       
+0001bb10: 2022 2222 4964 206f 6620 7468 6520 6665   """Id of the fe
+0001bb20: 6174 7572 6520 7374 6f72 6520 696e 2077  ature store in w
+0001bb30: 6869 6368 2074 6865 2066 6561 7475 7265  hich the feature
+0001bb40: 2067 726f 7570 2069 7320 6c6f 6361 7465   group is locate
+0001bb50: 642e 2222 220a 2020 2020 2020 2020 7265  d.""".        re
+0001bb60: 7475 726e 2073 656c 662e 5f66 6561 7475  turn self._featu
+0001bb70: 7265 5f73 746f 7265 5f69 640a 0a0a 636c  re_store_id...cl
+0001bb80: 6173 7320 5370 696e 6547 726f 7570 2846  ass SpineGroup(F
+0001bb90: 6561 7475 7265 4772 6f75 7042 6173 6529  eatureGroupBase)
+0001bba0: 3a0a 2020 2020 5350 494e 455f 4752 4f55  :.    SPINE_GROU
+0001bbb0: 5020 3d20 224f 4e5f 4445 4d41 4e44 5f46  P = "ON_DEMAND_F
+0001bbc0: 4541 5455 5245 5f47 524f 5550 220a 2020  EATURE_GROUP".  
+0001bbd0: 2020 454e 5449 5459 5f54 5950 4520 3d20    ENTITY_TYPE = 
+0001bbe0: 2266 6561 7475 7265 6772 6f75 7073 220a  "featuregroups".
+0001bbf0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+0001bc00: 5f28 0a20 2020 2020 2020 2073 656c 662c  _(.        self,
+0001bc10: 0a20 2020 2020 2020 2073 746f 7261 6765  .        storage
+0001bc20: 5f63 6f6e 6e65 6374 6f72 3d4e 6f6e 652c  _connector=None,
+0001bc30: 0a20 2020 2020 2020 2071 7565 7279 3d4e  .        query=N
+0001bc40: 6f6e 652c 0a20 2020 2020 2020 2064 6174  one,.        dat
+0001bc50: 615f 666f 726d 6174 3d4e 6f6e 652c 0a20  a_format=None,. 
+0001bc60: 2020 2020 2020 2070 6174 683d 4e6f 6e65         path=None
+0001bc70: 2c0a 2020 2020 2020 2020 6f70 7469 6f6e  ,.        option
+0001bc80: 733d 7b7d 2c0a 2020 2020 2020 2020 6e61  s={},.        na
+0001bc90: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
+0001bca0: 2076 6572 7369 6f6e 3d4e 6f6e 652c 0a20   version=None,. 
+0001bcb0: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
+0001bcc0: 6f6e 3d4e 6f6e 652c 0a20 2020 2020 2020  on=None,.       
+0001bcd0: 2070 7269 6d61 7279 5f6b 6579 3d4e 6f6e   primary_key=Non
+0001bce0: 652c 0a20 2020 2020 2020 2066 6561 7475  e,.        featu
+0001bcf0: 7265 7374 6f72 655f 6964 3d4e 6f6e 652c  restore_id=None,
+0001bd00: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+0001bd10: 7374 6f72 655f 6e61 6d65 3d4e 6f6e 652c  store_name=None,
+0001bd20: 0a20 2020 2020 2020 2063 7265 6174 6564  .        created
+0001bd30: 3d4e 6f6e 652c 0a20 2020 2020 2020 2063  =None,.        c
+0001bd40: 7265 6174 6f72 3d4e 6f6e 652c 0a20 2020  reator=None,.   
+0001bd50: 2020 2020 2069 643d 4e6f 6e65 2c0a 2020       id=None,.  
+0001bd60: 2020 2020 2020 6665 6174 7572 6573 3d4e        features=N
+0001bd70: 6f6e 652c 0a20 2020 2020 2020 206c 6f63  one,.        loc
+0001bd80: 6174 696f 6e3d 4e6f 6e65 2c0a 2020 2020  ation=None,.    
+0001bd90: 2020 2020 7374 6174 6973 7469 6373 5f63      statistics_c
+0001bda0: 6f6e 6669 673d 4e6f 6e65 2c0a 2020 2020  onfig=None,.    
+0001bdb0: 2020 2020 6576 656e 745f 7469 6d65 3d4e      event_time=N
+0001bdc0: 6f6e 652c 0a20 2020 2020 2020 2065 7870  one,.        exp
+0001bdd0: 6563 7461 7469 6f6e 5f73 7569 7465 3d4e  ectation_suite=N
+0001bde0: 6f6e 652c 0a20 2020 2020 2020 206f 6e6c  one,.        onl
+0001bdf0: 696e 655f 656e 6162 6c65 643d 4661 6c73  ine_enabled=Fals
+0001be00: 652c 0a20 2020 2020 2020 2068 7265 663d  e,.        href=
+0001be10: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f6e  None,.        on
+0001be20: 6c69 6e65 5f74 6f70 6963 5f6e 616d 653d  line_topic_name=
+0001be30: 4e6f 6e65 2c0a 2020 2020 2020 2020 7370  None,.        sp
+0001be40: 696e 653d 5472 7565 2c0a 2020 2020 2020  ine=True,.      
+0001be50: 2020 6461 7461 6672 616d 653d 2273 7069    dataframe="spi
+0001be60: 6e65 222c 0a20 2020 2029 3a0a 2020 2020  ne",.    ):.    
+0001be70: 2020 2020 7375 7065 7228 292e 5f5f 696e      super().__in
+0001be80: 6974 5f5f 280a 2020 2020 2020 2020 2020  it__(.          
+0001be90: 2020 6665 6174 7572 6573 746f 7265 5f69    featurestore_i
+0001bea0: 642c 0a20 2020 2020 2020 2020 2020 206c  d,.            l
+0001beb0: 6f63 6174 696f 6e2c 0a20 2020 2020 2020  ocation,.       
+0001bec0: 2020 2020 2065 7665 6e74 5f74 696d 653d       event_time=
+0001bed0: 6576 656e 745f 7469 6d65 2c0a 2020 2020  event_time,.    
+0001bee0: 2020 2020 2020 2020 6f6e 6c69 6e65 5f65          online_e
+0001bef0: 6e61 626c 6564 3d6f 6e6c 696e 655f 656e  nabled=online_en
+0001bf00: 6162 6c65 642c 0a20 2020 2020 2020 2020  abled,.         
+0001bf10: 2020 2069 643d 6964 2c0a 2020 2020 2020     id=id,.      
+0001bf20: 2020 2020 2020 6578 7065 6374 6174 696f        expectatio
+0001bf30: 6e5f 7375 6974 653d 6578 7065 6374 6174  n_suite=expectat
+0001bf40: 696f 6e5f 7375 6974 652c 0a20 2020 2020  ion_suite,.     
+0001bf50: 2020 2020 2020 206f 6e6c 696e 655f 746f         online_to
+0001bf60: 7069 635f 6e61 6d65 3d6f 6e6c 696e 655f  pic_name=online_
+0001bf70: 746f 7069 635f 6e61 6d65 2c0a 2020 2020  topic_name,.    
+0001bf80: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
+0001bf90: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
+0001bfa0: 7265 5f6e 616d 6520 3d20 6665 6174 7572  re_name = featur
+0001bfb0: 6573 746f 7265 5f6e 616d 650a 2020 2020  estore_name.    
+0001bfc0: 2020 2020 7365 6c66 2e5f 6465 7363 7269      self._descri
+0001bfd0: 7074 696f 6e20 3d20 6465 7363 7269 7074  ption = descript
+0001bfe0: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
+0001bff0: 2e5f 6372 6561 7465 6420 3d20 6372 6561  ._created = crea
+0001c000: 7465 640a 2020 2020 2020 2020 7365 6c66  ted.        self
+0001c010: 2e5f 6372 6561 746f 7220 3d20 7573 6572  ._creator = user
+0001c020: 2e55 7365 722e 6672 6f6d 5f72 6573 706f  .User.from_respo
+0001c030: 6e73 655f 6a73 6f6e 2863 7265 6174 6f72  nse_json(creator
+0001c040: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+0001c050: 7665 7273 696f 6e20 3d20 7665 7273 696f  version = versio
+0001c060: 6e0a 2020 2020 2020 2020 7365 6c66 2e5f  n.        self._
+0001c070: 6e61 6d65 203d 206e 616d 650a 0a20 2020  name = name..   
+0001c080: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
+0001c090: 7265 7320 3d20 5b0a 2020 2020 2020 2020  res = [.        
+0001c0a0: 2020 2020 6665 6174 7572 652e 4665 6174      feature.Feat
+0001c0b0: 7572 652e 6672 6f6d 5f72 6573 706f 6e73  ure.from_respons
+0001c0c0: 655f 6a73 6f6e 2866 6561 7429 2069 6620  e_json(feat) if 
+0001c0d0: 6973 696e 7374 616e 6365 2866 6561 742c  isinstance(feat,
+0001c0e0: 2064 6963 7429 2065 6c73 6520 6665 6174   dict) else feat
+0001c0f0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0001c100: 2066 6561 7420 696e 2028 6665 6174 7572   feat in (featur
+0001c110: 6573 206f 7220 5b5d 290a 2020 2020 2020  es or []).      
+0001c120: 2020 5d0a 0a20 2020 2020 2020 2073 656c    ]..        sel
+0001c130: 662e 5f66 6561 7475 7265 5f67 726f 7570  f._feature_group
+0001c140: 5f65 6e67 696e 6520 3d20 7370 696e 655f  _engine = spine_
+0001c150: 6772 6f75 705f 656e 6769 6e65 2e53 7069  group_engine.Spi
+0001c160: 6e65 4772 6f75 7045 6e67 696e 6528 0a20  neGroupEngine(. 
+0001c170: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+0001c180: 7265 7374 6f72 655f 6964 0a20 2020 2020  restore_id.     
+0001c190: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+0001c1a0: 2073 656c 662e 5f69 643a 0a20 2020 2020   self._id:.     
+0001c1b0: 2020 2020 2020 2023 2047 6f74 2066 726f         # Got fro
+0001c1c0: 6d20 486f 7073 776f 726b 732c 2064 6573  m Hopsworks, des
+0001c1d0: 6572 6961 6c69 7a65 2066 6561 7475 7265  erialize feature
+0001c1e0: 7320 616e 6420 7374 6f72 6167 6520 636f  s and storage co
+0001c1f0: 6e6e 6563 746f 720a 2020 2020 2020 2020  nnector.        
+0001c200: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
+0001c210: 6573 203d 2028 0a20 2020 2020 2020 2020  es = (.         
+0001c220: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0001c230: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+0001c240: 7475 7265 2e46 6561 7475 7265 2e66 726f  ture.Feature.fro
+0001c250: 6d5f 7265 7370 6f6e 7365 5f6a 736f 6e28  m_response_json(
+0001c260: 6665 6174 290a 2020 2020 2020 2020 2020  feat).          
+0001c270: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+0001c280: 6e73 7461 6e63 6528 6665 6174 2c20 6469  nstance(feat, di
+0001c290: 6374 290a 2020 2020 2020 2020 2020 2020  ct).            
+0001c2a0: 2020 2020 2020 2020 656c 7365 2066 6561          else fea
+0001c2b0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0001c2c0: 2020 2020 2020 666f 7220 6665 6174 2069        for feat i
+0001c2d0: 6e20 6665 6174 7572 6573 0a20 2020 2020  n features.     
+0001c2e0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+0001c2f0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001c300: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
+0001c310: 2020 2020 2020 2020 2065 6c73 6520 4e6f           else No
+0001c320: 6e65 0a20 2020 2020 2020 2020 2020 2029  ne.            )
+0001c330: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0001c340: 662e 7072 696d 6172 795f 6b65 7920 3d20  f.primary_key = 
+0001c350: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001c360: 2020 5b66 6561 742e 6e61 6d65 2066 6f72    [feat.name for
+0001c370: 2066 6561 7420 696e 2073 656c 662e 5f66   feat in self._f
+0001c380: 6561 7475 7265 7320 6966 2066 6561 742e  eatures if feat.
+0001c390: 7072 696d 6172 7920 6973 2054 7275 655d  primary is True]
+0001c3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c3b0: 2069 6620 7365 6c66 2e5f 6665 6174 7572   if self._featur
+0001c3c0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+0001c3d0: 2020 2065 6c73 6520 5b5d 0a20 2020 2020     else [].     
+0001c3e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001c3f0: 2020 2020 2073 656c 662e 7374 6174 6973       self.statis
+0001c400: 7469 6373 5f63 6f6e 6669 6720 3d20 7374  tics_config = st
+0001c410: 6174 6973 7469 6373 5f63 6f6e 6669 670a  atistics_config.
+0001c420: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001c430: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
+0001c440: 7269 6d61 7279 5f6b 6579 203d 2070 7269  rimary_key = pri
+0001c450: 6d61 7279 5f6b 6579 0a20 2020 2020 2020  mary_key.       
+0001c460: 2020 2020 2073 656c 662e 7374 6174 6973       self.statis
+0001c470: 7469 6373 5f63 6f6e 6669 6720 3d20 7374  tics_config = st
+0001c480: 6174 6973 7469 6373 5f63 6f6e 6669 670a  atistics_config.
+0001c490: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001c4a0: 2e5f 6665 6174 7572 6573 203d 2066 6561  ._features = fea
+0001c4b0: 7475 7265 730a 0a20 2020 2020 2020 2073  tures..        s
+0001c4c0: 656c 662e 5f68 7265 6620 3d20 6872 6566  elf._href = href
+0001c4d0: 0a0a 2020 2020 2020 2020 2320 6861 7320  ..        # has 
+0001c4e0: 746f 2068 6170 7065 6e20 6c61 7374 202d  to happen last -
+0001c4f0: 3e20 6665 6174 7572 6573 2061 6e64 2069  > features and i
+0001c500: 6420 6172 6520 6e65 6564 6564 2066 6f72  d are needed for
+0001c510: 2073 6368 656d 6120 7665 7269 6669 6361   schema verifica
+0001c520: 7469 6f6e 0a20 2020 2020 2020 2023 2075  tion.        # u
+0001c530: 7365 2073 6574 7465 7220 746f 2063 6f6e  se setter to con
+0001c540: 7665 7274 2074 6f20 6465 6661 756c 7420  vert to default 
+0001c550: 6461 7461 6672 616d 6520 7479 7065 2066  dataframe type f
+0001c560: 6f72 2065 6e67 696e 650a 2020 2020 2020  or engine.      
+0001c570: 2020 7365 6c66 2e64 6174 6166 7261 6d65    self.dataframe
+0001c580: 203d 2064 6174 6166 7261 6d65 0a0a 2020   = dataframe..  
+0001c590: 2020 6465 6620 5f73 6176 6528 7365 6c66    def _save(self
+0001c5a0: 293a 0a20 2020 2020 2020 2022 2222 5065  ):.        """Pe
+0001c5b0: 7273 6973 7420 7468 6520 6d65 7461 6461  rsist the metada
+0001c5c0: 7461 2066 6f72 2074 6869 7320 7370 696e  ta for this spin
+0001c5d0: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
+0001c5e0: 2020 5769 7468 6f75 7420 6361 6c6c 696e    Without callin
+0001c5f0: 6720 7468 6973 206d 6574 686f 642c 2079  g this method, y
+0001c600: 6f75 7220 6665 6174 7572 6520 6772 6f75  our feature grou
+0001c610: 7020 7769 6c6c 206f 6e6c 7920 6578 6973  p will only exis
+0001c620: 740a 2020 2020 2020 2020 696e 2079 6f75  t.        in you
+0001c630: 7220 5079 7468 6f6e 204b 6572 6e65 6c2c  r Python Kernel,
+0001c640: 2062 7574 206e 6f74 2069 6e20 486f 7073   but not in Hops
+0001c650: 776f 726b 732e 0a0a 2020 2020 2020 2020  works...        
+0001c660: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+0001c670: 2020 7175 6572 7920 3d20 2253 454c 4543    query = "SELEC
+0001c680: 5420 2a20 4652 4f4d 2073 616c 6573 220a  T * FROM sales".
+0001c690: 0a20 2020 2020 2020 2066 6720 3d20 6665  .        fg = fe
+0001c6a0: 6174 7572 655f 7374 6f72 652e 6372 6561  ature_store.crea
+0001c6b0: 7465 5f73 7069 6e65 5f67 726f 7570 286e  te_spine_group(n
+0001c6c0: 616d 653d 2273 616c 6573 222c 0a20 2020  ame="sales",.   
+0001c6d0: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+0001c6e0: 3d31 2c0a 2020 2020 2020 2020 2020 2020  =1,.            
+0001c6f0: 6465 7363 7269 7074 696f 6e3d 2250 6879  description="Phy
+0001c700: 7369 6361 6c20 7368 6f70 2073 616c 6573  sical shop sales
+0001c710: 2066 6561 7475 7265 7322 2c0a 2020 2020   features",.    
+0001c720: 2020 2020 2020 2020 7072 696d 6172 795f          primary_
+0001c730: 6b65 793d 5b27 7373 5f73 746f 7265 5f73  key=['ss_store_s
+0001c740: 6b27 5d2c 0a20 2020 2020 2020 2020 2020  k'],.           
+0001c750: 2065 7665 6e74 5f74 696d 653d 2773 616c   event_time='sal
+0001c760: 655f 6461 7465 272c 0a20 2020 2020 2020  e_date',.       
+0001c770: 2020 2020 2064 6174 6166 7261 6d65 3d64       dataframe=d
+0001c780: 662c 0a20 2020 2020 2020 2029 0a0a 2020  f,.        )..  
+0001c790: 2020 2020 2020 6667 2e5f 7361 7665 2829        fg._save()
+0001c7a0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001c7b0: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
+0001c7c0: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
+0001c7d0: 7361 7665 2873 656c 6629 0a20 2020 2020  save(self).     
+0001c7e0: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+0001c7f0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0001c800: 2020 6465 6620 6461 7461 6672 616d 6528    def dataframe(
+0001c810: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+0001c820: 2222 5370 696e 6520 6461 7461 6672 616d  ""Spine datafram
+0001c830: 6520 7769 7468 2070 7269 6d61 7279 206b  e with primary k
+0001c840: 6579 2c20 6576 656e 7420 7469 6d65 2061  ey, event time a
+0001c850: 6e64 0a20 2020 2020 2020 206c 6162 656c  nd.        label
+0001c860: 2063 6f6c 756d 6e20 746f 2075 7365 2066   column to use f
+0001c870: 6f72 2070 6f69 6e74 2069 6e20 7469 6d65  or point in time
+0001c880: 206a 6f69 6e20 7768 656e 2066 6574 6368   join when fetch
+0001c890: 696e 6720 6665 6174 7572 6573 2e0a 2020  ing features..  
+0001c8a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001c8b0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0001c8c0: 6174 6166 7261 6d65 0a0a 2020 2020 4064  ataframe..    @d
+0001c8d0: 6174 6166 7261 6d65 2e73 6574 7465 720a  ataframe.setter.
+0001c8e0: 2020 2020 6465 6620 6461 7461 6672 616d      def datafram
+0001c8f0: 6528 7365 6c66 2c20 6461 7461 6672 616d  e(self, datafram
+0001c900: 6529 3a0a 2020 2020 2020 2020 2222 2255  e):.        """U
+0001c910: 7064 6174 6520 7468 6520 7370 696e 6520  pdate the spine 
+0001c920: 6461 7461 6672 616d 6520 636f 6e74 6169  dataframe contai
+0001c930: 6e65 6420 696e 2074 6865 2073 7069 6e65  ned in the spine
+0001c940: 2067 726f 7570 2e22 2222 0a20 2020 2020   group.""".     
+0001c950: 2020 2073 656c 662e 5f64 6174 6166 7261     self._datafra
+0001c960: 6d65 203d 2065 6e67 696e 652e 6765 745f  me = engine.get_
+0001c970: 696e 7374 616e 6365 2829 2e63 6f6e 7665  instance().conve
+0001c980: 7274 5f74 6f5f 6465 6661 756c 745f 6461  rt_to_default_da
+0001c990: 7461 6672 616d 6528 6461 7461 6672 616d  taframe(datafram
+0001c9a0: 6529 0a0a 2020 2020 2020 2020 2320 696e  e)..        # in
+0001c9b0: 2066 7320 7175 6572 7920 7468 6520 6665   fs query the fe
+0001c9c0: 6174 7572 6573 2061 7265 206e 6f74 2073  atures are not s
+0001c9d0: 656e 742c 2073 6f20 7468 656e 2064 6f6e  ent, so then don
+0001c9e0: 2774 2064 6f20 7661 6c69 6461 7469 6f6e  't do validation
+0001c9f0: 0a20 2020 2020 2020 2069 6620 280a 2020  .        if (.  
+0001ca00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0001ca10: 6964 2069 7320 6e6f 7420 4e6f 6e65 0a20  id is not None. 
+0001ca20: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
+0001ca30: 656c 662e 5f64 6174 6166 7261 6d65 2069  elf._dataframe i
+0001ca40: 7320 6e6f 7420 4e6f 6e65 0a20 2020 2020  s not None.     
+0001ca50: 2020 2020 2020 2061 6e64 2073 656c 662e         and self.
+0001ca60: 5f66 6561 7475 7265 7320 6973 206e 6f74  _features is not
+0001ca70: 204e 6f6e 650a 2020 2020 2020 2020 293a   None.        ):
+0001ca80: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
+0001ca90: 6166 7261 6d65 5f66 6561 7475 7265 7320  aframe_features 
+0001caa0: 3d20 656e 6769 6e65 2e67 6574 5f69 6e73  = engine.get_ins
+0001cab0: 7461 6e63 6528 292e 7061 7273 655f 7363  tance().parse_sc
+0001cac0: 6865 6d61 5f66 6561 7475 7265 5f67 726f  hema_feature_gro
+0001cad0: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
+0001cae0: 2020 2020 7365 6c66 2e5f 6461 7461 6672      self._datafr
+0001caf0: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+0001cb00: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0001cb10: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
+0001cb20: 705f 656e 6769 6e65 2e5f 7665 7269 6679  p_engine._verify
+0001cb30: 5f73 6368 656d 615f 636f 6d70 6174 6962  _schema_compatib
+0001cb40: 696c 6974 7928 0a20 2020 2020 2020 2020  ility(.         
+0001cb50: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
+0001cb60: 7475 7265 732c 2064 6174 6166 7261 6d65  tures, dataframe
+0001cb70: 5f66 6561 7475 7265 730a 2020 2020 2020  _features.      
+0001cb80: 2020 2020 2020 290a 0a20 2020 2040 636c        )..    @cl
+0001cb90: 6173 736d 6574 686f 640a 2020 2020 6465  assmethod.    de
+0001cba0: 6620 6672 6f6d 5f72 6573 706f 6e73 655f  f from_response_
+0001cbb0: 6a73 6f6e 2863 6c73 2c20 6a73 6f6e 5f64  json(cls, json_d
+0001cbc0: 6963 7429 3a0a 2020 2020 2020 2020 6a73  ict):.        js
+0001cbd0: 6f6e 5f64 6563 616d 656c 697a 6564 203d  on_decamelized =
+0001cbe0: 2068 756d 7073 2e64 6563 616d 656c 697a   humps.decameliz
+0001cbf0: 6528 6a73 6f6e 5f64 6963 7429 0a20 2020  e(json_dict).   
+0001cc00: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0001cc10: 6365 286a 736f 6e5f 6465 6361 6d65 6c69  ce(json_decameli
+0001cc20: 7a65 642c 2064 6963 7429 3a0a 2020 2020  zed, dict):.    
+0001cc30: 2020 2020 2020 2020 5f20 3d20 6a73 6f6e          _ = json
+0001cc40: 5f64 6563 616d 656c 697a 6564 2e70 6f70  _decamelized.pop
+0001cc50: 2822 7479 7065 222c 204e 6f6e 6529 0a20  ("type", None). 
+0001cc60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001cc70: 6e20 636c 7328 2a2a 6a73 6f6e 5f64 6563  n cls(**json_dec
+0001cc80: 616d 656c 697a 6564 290a 2020 2020 2020  amelized).      
+0001cc90: 2020 666f 7220 6667 2069 6e20 6a73 6f6e    for fg in json
+0001cca0: 5f64 6563 616d 656c 697a 6564 3a0a 2020  _decamelized:.  
+0001ccb0: 2020 2020 2020 2020 2020 5f20 3d20 6667            _ = fg
+0001ccc0: 2e70 6f70 2822 7479 7065 222c 204e 6f6e  .pop("type", Non
+0001ccd0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
+0001cce0: 6e20 5b63 6c73 282a 2a66 6729 2066 6f72  n [cls(**fg) for
+0001ccf0: 2066 6720 696e 206a 736f 6e5f 6465 6361   fg in json_deca
+0001cd00: 6d65 6c69 7a65 645d 0a0a 2020 2020 6465  melized]..    de
+0001cd10: 6620 7570 6461 7465 5f66 726f 6d5f 7265  f update_from_re
+0001cd20: 7370 6f6e 7365 5f6a 736f 6e28 7365 6c66  sponse_json(self
+0001cd30: 2c20 6a73 6f6e 5f64 6963 7429 3a0a 2020  , json_dict):.  
+0001cd40: 2020 2020 2020 6a73 6f6e 5f64 6563 616d        json_decam
+0001cd50: 656c 697a 6564 203d 2068 756d 7073 2e64  elized = humps.d
+0001cd60: 6563 616d 656c 697a 6528 6a73 6f6e 5f64  ecamelize(json_d
+0001cd70: 6963 7429 0a20 2020 2020 2020 2069 6620  ict).        if 
+0001cd80: 2274 7970 6522 2069 6e20 6a73 6f6e 5f64  "type" in json_d
+0001cd90: 6563 616d 656c 697a 6564 3a0a 2020 2020  ecamelized:.    
+0001cda0: 2020 2020 2020 2020 5f20 3d20 6a73 6f6e          _ = json
+0001cdb0: 5f64 6563 616d 656c 697a 6564 2e70 6f70  _decamelized.pop
+0001cdc0: 2822 7479 7065 2229 0a20 2020 2020 2020  ("type").       
+0001cdd0: 2073 656c 662e 5f5f 696e 6974 5f5f 282a   self.__init__(*
+0001cde0: 2a6a 736f 6e5f 6465 6361 6d65 6c69 7a65  *json_decamelize
+0001cdf0: 6429 0a20 2020 2020 2020 2072 6574 7572  d).        retur
+0001ce00: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
+0001ce10: 6a73 6f6e 2873 656c 6629 3a0a 2020 2020  json(self):.    
+0001ce20: 2020 2020 7265 7475 726e 206a 736f 6e2e      return json.
+0001ce30: 6475 6d70 7328 7365 6c66 2c20 636c 733d  dumps(self, cls=
+0001ce40: 7574 696c 2e46 6561 7475 7265 5374 6f72  util.FeatureStor
+0001ce50: 6545 6e63 6f64 6572 290a 0a20 2020 2064  eEncoder)..    d
+0001ce60: 6566 2074 6f5f 6469 6374 2873 656c 6629  ef to_dict(self)
+0001ce70: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0001ce80: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+0001ce90: 6964 223a 2073 656c 662e 5f69 642c 0a20  id": self._id,. 
+0001cea0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+0001ceb0: 223a 2073 656c 662e 5f6e 616d 652c 0a20  ": self._name,. 
+0001cec0: 2020 2020 2020 2020 2020 2022 6465 7363             "desc
+0001ced0: 7269 7074 696f 6e22 3a20 7365 6c66 2e5f  ription": self._
+0001cee0: 6465 7363 7269 7074 696f 6e2c 0a20 2020  description,.   
+0001cef0: 2020 2020 2020 2020 2022 7665 7273 696f           "versio
+0001cf00: 6e22 3a20 7365 6c66 2e5f 7665 7273 696f  n": self._versio
+0001cf10: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
+0001cf20: 6665 6174 7572 6573 223a 2073 656c 662e  features": self.
+0001cf30: 5f66 6561 7475 7265 732c 0a20 2020 2020  _features,.     
+0001cf40: 2020 2020 2020 2022 6665 6174 7572 6573         "features
+0001cf50: 746f 7265 4964 223a 2073 656c 662e 5f66  toreId": self._f
+0001cf60: 6561 7475 7265 5f73 746f 7265 5f69 642c  eature_store_id,
+0001cf70: 0a20 2020 2020 2020 2020 2020 2022 7479  .            "ty
+0001cf80: 7065 223a 2022 6f6e 4465 6d61 6e64 4665  pe": "onDemandFe
+0001cf90: 6174 7572 6567 726f 7570 4454 4f22 2c0a  aturegroupDTO",.
+0001cfa0: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+0001cfb0: 7469 7374 6963 7343 6f6e 6669 6722 3a20  tisticsConfig": 
+0001cfc0: 7365 6c66 2e5f 7374 6174 6973 7469 6373  self._statistics
+0001cfd0: 5f63 6f6e 6669 672c 0a20 2020 2020 2020  _config,.       
+0001cfe0: 2020 2020 2022 6576 656e 7454 696d 6522       "eventTime"
+0001cff0: 3a20 7365 6c66 2e5f 6576 656e 745f 7469  : self._event_ti
+0001d000: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0001d010: 2273 7069 6e65 223a 2054 7275 652c 0a20  "spine": True,. 
+0001d020: 2020 2020 2020 207d 0a                          }.
```

### Comparing `hsfs-3.2.1/hsfs/feature_group_commit.py` & `hsfs-3.3.0rc0/hsfs/feature_group_commit.py`

 * *Files 14% similar despite different names*

```diff
@@ -26,25 +26,29 @@
         commitid=None,
         commit_date_string=None,
         rows_inserted=None,
         rows_updated=None,
         rows_deleted=None,
         validation_id=None,
         commit_time=None,
+        archived=None,
+        last_active_commit_time=None,
         items=None,
         count=None,
         href=None,
     ):
         self._commitid = commitid
         self._commit_date_string = commit_date_string
         self._commit_time = commit_time
         self._rows_inserted = rows_inserted
         self._rows_updated = rows_updated
         self._rows_deleted = rows_deleted
         self._validation_id = validation_id
+        self._archived = archived
+        self._last_active_commit_time = last_active_commit_time
 
     @classmethod
     def from_response_json(cls, json_dict):
         json_decamelized = humps.decamelize(json_dict)
         return [cls(**commit_dto) for commit_dto in json_decamelized["items"]]
 
     def update_from_response_json(self, json_dict):
@@ -61,14 +65,16 @@
             "commitID": self._commitid,
             "commitDateString": self._commit_date_string,
             "commitTime": self._commit_time,
             "rowsInserted": self._rows_inserted,
             "rowsUpdated": self._rows_updated,
             "rowsDeleted": self._rows_deleted,
             "validationId": self._validation_id,
+            "archived": self._archived,
+            "lastActiveCommitTime": self._last_active_commit_time,
         }
 
     @property
     def commitid(self):
         return self._commitid
 
     @property
@@ -91,14 +97,22 @@
     def rows_deleted(self):
         return self._rows_deleted
 
     @property
     def validation_id(self):
         return self._validation_id
 
+    @property
+    def archived(self):
+        return self._archived
+
+    @property
+    def last_active_commit_time(self):
+        return self._last_active_commit_time
+
     @commitid.setter
     def commitid(self, commitid):
         self._commitid = commitid
 
     @commit_time.setter
     def commit_time(self, commit_time):
         self._commit_time = commit_time
@@ -114,7 +128,11 @@
     @rows_deleted.setter
     def rows_deleted(self, rows_deleted):
         self._rows_deleted = rows_deleted
 
     @validation_id.setter
     def validation_id(self, validation_id):
         self._validation_id = validation_id
+
+    @last_active_commit_time.setter
+    def last_active_commit_time(self, last_active_commit_time):
+        self._last_active_commit_time = last_active_commit_time
```

### Comparing `hsfs-3.2.1/hsfs/feature_group_writer.py` & `hsfs-3.3.0rc0/hsfs/feature_group_writer.py`

 * *Files 0% similar despite different names*

```diff
@@ -41,15 +41,14 @@
         ],
         overwrite: Optional[bool] = False,
         operation: Optional[str] = "upsert",
         storage: Optional[str] = None,
         write_options: Optional[Dict[str, Any]] = {},
         validation_options: Optional[Dict[str, Any]] = {},
     ) -> Tuple[Optional[Job], Optional[ValidationReport]]:
-
         return self._feature_group.insert(
             features=features,
             overwrite=overwrite,
             operation=operation,
             storage=storage,
             write_options={"start_offline_backfill": False, **write_options},
             validation_options={"fetch_expectation_suite": False, **validation_options},
```

### Comparing `hsfs-3.2.1/hsfs/feature_store.py` & `hsfs-3.3.0rc0/hsfs/feature_store.py`

 * *Files 2% similar despite different names*

```diff
@@ -13,19 +13,21 @@
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import warnings
 import datetime
-from typing import Optional, Union, List, Dict
+from typing import Optional, Union, List, Dict, TypeVar
 
 import humps
 import numpy
 import great_expectations as ge
+import pandas as pd
+import numpy as np
 
 from hsfs.transformation_function import TransformationFunction
 from hsfs.client import exceptions
 from hsfs.core import transformation_function_engine
 
 from hsfs import (
     training_dataset,
@@ -867,18 +869,16 @@
                 `"exact_uniqueness"` to compute uniqueness, distinctness and entropy.
                 The values should be booleans indicating the setting. To fully turn off
                 statistics computation pass `statistics_config=False`. Defaults to
                 `None` and will compute only descriptive statistics.
             event_time: Optionally, provide the name of the feature containing the event
                 time for the features in this feature group. If event_time is set
                 the feature group can be used for point-in-time joins. Defaults to `None`.
-
-                !!!note "Event time data type restriction"
-                    The supported data types for the event time column are: `timestamp`, `date` and `bigint`.
-
+            !!! note "Event time data type restriction"
+                The supported data types for the event time column are: `timestamp`, `date` and `bigint`.
             expectation_suite: Optionally, attach an expectation suite to the feature
                 group which dataframes should be validated against upon insertion.
                 Defaults to `None`.
             online_enabled: Define whether it should be possible to sync the feature group to
                 the online feature store for low latency access, defaults to `False`.
 
         # Returns
@@ -899,14 +899,154 @@
             features=features,
             statistics_config=statistics_config,
             event_time=event_time,
             expectation_suite=expectation_suite,
             online_enabled=online_enabled,
         )
 
+    def get_or_create_spine_group(
+        self,
+        name: str,
+        version: Optional[int] = None,
+        description: Optional[str] = "",
+        primary_key: Optional[List[str]] = [],
+        event_time: Optional[str] = None,
+        features: Optional[List[feature.Feature]] = [],
+        dataframe: Union[
+            pd.DataFrame,
+            TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+            TypeVar("pyspark.RDD"),  # noqa: F821
+            np.ndarray,
+            List[list],
+        ] = None,
+    ):
+        """Create a spine group metadata object.
+
+        Instead of using a feature group to save a label/prediction target, you can use a spine together with a dataframe containing the labels.
+        A Spine is essentially a metadata object similar to a feature group, however, the data is not materialized in the feature store.
+        It only containes the needed metadata such as the relevant event time column and primary key columns to perform point-in-time correct joins.
+
+        !!! example
+            ```python
+            # connect to the Feature Store
+            fs = ...
+
+            spine_df = pd.Dataframe()
+
+            spine_group = fs.get_or_create_spine_group(
+                                name="sales",
+                                version=1,
+                                description="Physical shop sales features",
+                                primary_key=['ss_store_sk'],
+                                event_time='sale_date',
+                                dataframe=spine_df
+                                )
+            ```
+
+        Note that you can inspect the dataframe in the spine group, or replace the dataframe:
+
+        ```python
+        spine_group.dataframe.show()
+
+        spine_group.dataframe = new_df
+        ```
+
+        The spine can then be used to construct queries, with only one speciality:
+
+        !!! note
+            Spines can only be used on the left side of a feature join, as this is the base
+            set of entities for which features are to be fetched and the left side of the join
+            determines the event timestamps to compare against.
+
+        **If you want to use the query for a feature view to be used for online serving,
+        you can only select the label or target feature from the spine.**
+        For the online lookup, the label is not required, therefore it is important to only
+        select label from the left feature group, so that we don't need to provide a spine
+        for online serving.
+
+        These queries can then be used to create feature views. Since the dataframe contained in the
+        spine is not being materialized, every time you use a feature view created with spine to read data
+        you will have to provide a dataframe with the same structure again.
+
+        For example, to generate training data:
+
+        ```python
+        X_train, X_test, y_train, y_test = feature_view_spine.train_test_split(0.2, spine=training_data_entities)
+        ```
+
+        Or to get batches of fresh data for batch scoring:
+        ```python
+        feature_view_spine.get_batch_data(spine=scoring_entities_df).show()
+        ```
+
+        Here you have the chance to pass a different set of entities to generate the training dataset.
+
+        Sometimes it might be handy to create a feature view with a regular feature group containing
+        the label, but then at serving time to use a spine in order to fetch features for example only
+        for a small set of primary key values. To do this, you can pass the spine group
+        instead of a dataframe. Just make sure it contains the needed primary key, event time and
+        label column.
+
+        ```python
+        feature_view.get_batch_data(spine=spine_group)
+        ```
+
+        # Arguments
+            name: Name of the spine group to create.
+            version: Version of the spine group to retrieve, defaults to `None` and
+                will create the spine group with incremented version from the last
+                version in the feature store.
+            description: A string describing the contents of the spine group to
+                improve discoverability for Data Scientists, defaults to empty string
+                `""`.
+            primary_key: A list of feature names to be used as primary key for the
+                spine group. This primary key can be a composite key of multiple
+                features and will be used as joining key, if not specified otherwise.
+                Defaults to empty list `[]`, and the spine group won't have any primary key.
+            event_time: Optionally, provide the name of the feature containing the event
+                time for the features in this spine group. If event_time is set
+                the spine group can be used for point-in-time joins. Defaults to `None`.
+            features: Optionally, define the schema of the spine group manually as a
+                list of `Feature` objects. Defaults to empty list `[]` and will use the
+                schema information of the DataFrame resulting by executing the provided query
+                against the data source.
+            !!!note "Event time data type restriction"
+                The supported data types for the event time column are: `timestamp`, `date` and `bigint`.
+            dataframe: DataFrame, RDD, Ndarray, list. Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features.
+
+        # Returns
+            `SpineGroup`. The spine group metadata object.
+        """
+        try:
+            spine = self._feature_group_api.get(
+                name, version, feature_group_api.FeatureGroupApi.SPINE
+            )
+            spine.dataframe = dataframe
+            return spine
+        except exceptions.RestAPIError as e:
+            if (
+                e.response.json().get("errorCode", "") == 270009
+                and e.response.status_code == 404
+            ):
+                spine = feature_group.SpineGroup(
+                    name=name,
+                    version=version,
+                    description=description,
+                    primary_key=primary_key,
+                    event_time=event_time,
+                    features=features,
+                    dataframe=dataframe,
+                    featurestore_id=self._id,
+                    featurestore_name=self._name,
+                )
+                return spine._save()
+            else:
+                raise e
+
     def create_training_dataset(
         self,
         name: str,
         version: Optional[int] = None,
         description: Optional[str] = "",
         data_format: Optional[str] = "tfrecords",
         coalesce: Optional[bool] = False,
```

### Comparing `hsfs-3.2.1/hsfs/feature_view.py` & `hsfs-3.3.0rc0/hsfs/feature_view.py`

 * *Files 4% similar despite different names*

```diff
@@ -13,30 +13,37 @@
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import json
 import warnings
 from datetime import datetime, date
-from typing import Optional, Union, List, Dict, Any
-from hsfs.training_dataset_split import TrainingDatasetSplit
+from typing import Optional, Union, List, Dict, Any, TypeVar
 
 import humps
 import copy
+import pandas as pd
+import numpy as np
 
-from hsfs import util, training_dataset_feature, storage_connector, training_dataset
+from hsfs import (
+    util,
+    training_dataset_feature,
+    storage_connector,
+    training_dataset,
+)
 from hsfs.constructor import query, filter
 from hsfs.core import (
     feature_view_engine,
     transformation_function_engine,
     vector_server,
 )
 from hsfs.transformation_function import TransformationFunction
 from hsfs.statistics_config import StatisticsConfig
 from hsfs.core.feature_view_api import FeatureViewApi
+from hsfs.training_dataset_split import TrainingDatasetSplit
 
 
 class FeatureView:
     ENTITY_TYPE = "featureview"
 
     def __init__(
         self,
@@ -304,14 +311,15 @@
         )
 
     def get_feature_vector(
         self,
         entry: Dict[str, Any],
         passed_features: Optional[Dict[str, Any]] = {},
         external: Optional[bool] = None,
+        return_type: Optional[str] = "list",
     ):
         """Returns assembled feature vector from online feature store.
             Call [`feature_view.init_serving`](#init_serving) before this method if the following configurations are needed.
               1. The training dataset version of the transformation statistics
               2. Additional configurations of online serving engine
         !!! warning "Missing primary key entries"
             If the provided primary key `entry` can't be found in one or more of the feature groups
@@ -321,18 +329,30 @@
             ```python
             # get feature store instance
             fs = ...
 
             # get feature view instance
             feature_view = fs.get_feature_view(...)
 
-            # get a feature vector
+            # get assembled serving vector as a python list
             feature_view.get_feature_vector(
                 entry = {"pk1": 1, "pk2": 2}
             )
+
+            # get assembled serving vector as a pandas dataframe
+            feature_view.get_feature_vector(
+                entry = {"pk1": 1, "pk2": 2},
+                return_type = "pandas"
+            )
+
+            # get assembled serving vector as a numpy array
+            feature_view.get_feature_vector(
+                entry = {"pk1": 1, "pk2": 2},
+                return_type = "numpy"
+            )
             ```
 
         !!! example "Get feature vector with user-supplied features"
             ```python
             # get feature store instance
             fs = ...
             # get feature view instance
@@ -355,32 +375,38 @@
                 providing feature values which are not available in the feature store.
             external: boolean, optional. If set to True, the connection to the
                 online feature store is established using the same host as
                 for the `host` parameter in the [`hsfs.connection()`](connection_api.md#connection) method.
                 If set to False, the online feature store storage connector is used
                 which relies on the private IP. Defaults to True if connection to Hopsworks is established from
                 external environment (e.g AWS Sagemaker or Google Colab), otherwise to False.
+            return_type: `"list"`, `"pandas"` or `"numpy"`. Defaults to `"list"`.
 
         # Returns
-            `list` List of feature values related to provided primary keys, ordered according to positions of this
-            features in the feature view query.
+            `list`, `pd.DataFrame` or `np.ndarray` if `return type` is set to `"list"`, `"pandas"` or `"numpy"`
+            respectively. Defaults to `list`.
+            Returned `list`, `pd.DataFrame` or `np.ndarray` contains feature values related to provided primary keys,
+            ordered according to positions of this features in the feature view query.
 
         # Raises
             `Exception`. When primary key entry cannot be found in one or more of the feature groups used by this
                 feature view.
         """
         if self._single_vector_server is None:
             self.init_serving(external=external)
-        return self._single_vector_server.get_feature_vector(entry, passed_features)
+        return self._single_vector_server.get_feature_vector(
+            entry, return_type, passed_features
+        )
 
     def get_feature_vectors(
         self,
         entry: List[Dict[str, Any]],
         passed_features: Optional[List[Dict[str, Any]]] = {},
         external: Optional[bool] = None,
+        return_type: Optional[str] = "list",
     ):
         """Returns assembled feature vectors in batches from online feature store.
             Call [`feature_view.init_serving`](#init_serving) before this method if the following configurations are needed.
               1. The training dataset version of the transformation statistics
               2. Additional configurations of online serving engine
         !!! warning "Missing primary key entries"
             If any of the provided primary key elements in `entry` can't be found in any
@@ -393,53 +419,89 @@
             ```python
             # get feature store instance
             fs = ...
 
             # get feature view instance
             feature_view = fs.get_feature_view(...)
 
-            # get assembled serving vectors
+            # get assembled serving vectors as a python list of lists
             feature_view.get_feature_vectors(
                 entry = [
                     {"pk1": 1, "pk2": 2},
                     {"pk1": 3, "pk2": 4},
                     {"pk1": 5, "pk2": 6}
                 ]
             )
+
+            # get assembled serving vectors as a pandas dataframe
+            feature_view.get_feature_vectors(
+                entry = [
+                    {"pk1": 1, "pk2": 2},
+                    {"pk1": 3, "pk2": 4},
+                    {"pk1": 5, "pk2": 6}
+                ],
+                return_type = "pandas"
+            )
+
+            # get assembled serving vectors as a numpy array
+            feature_view.get_feature_vectors(
+                entry = [
+                    {"pk1": 1, "pk2": 2},
+                    {"pk1": 3, "pk2": 4},
+                    {"pk1": 5, "pk2": 6}
+                ],
+                return_type = "numpy"
+            )
             ```
 
         # Arguments
             entry: a list of dictionary of feature group primary key and values provided by serving application.
             passed_features: a list of dictionary of feature values provided by the application at runtime.
                 They can replace features values fetched from the feature store as well as
                 providing feature values which are not available in the feature store.
             external: boolean, optional. If set to True, the connection to the
                 online feature store is established using the same host as
                 for the `host` parameter in the [`hsfs.connection()`](connection_api.md#connection) method.
                 If set to False, the online feature store storage connector is used
                 which relies on the private IP. Defaults to True if connection to Hopsworks is established from
                 external environment (e.g AWS Sagemaker or Google Colab), otherwise to False.
+            return_type: `"list"`, `"pandas"` or `"numpy"`. Defaults to `"list"`.
 
         # Returns
-            `List[list]` List of lists of feature values related to provided primary keys, ordered according
-                to positions of this features in the feature view query.
+            `List[list]`, `pd.DataFrame` or `np.ndarray` if `return type` is set to `"list", `"pandas"` or `"numpy"`
+            respectively. Defaults to `List[list]`.
+
+            Returned `List[list]`, `pd.DataFrame` or `np.ndarray` contains feature values related to provided primary
+            keys, ordered according to positions of this features in the feature view query.
 
         # Raises
             `Exception`. When primary key entry cannot be found in one or more of the feature groups used by this
                 feature view.
         """
         if self._batch_vectors_server is None:
             self.init_serving(external=external)
-        return self._batch_vectors_server.get_feature_vectors(entry, passed_features)
+        return self._batch_vectors_server.get_feature_vectors(
+            entry, return_type, passed_features
+        )
 
     def get_batch_data(
         self,
         start_time: Optional[Union[str, int, datetime, date]] = None,
         end_time: Optional[Union[str, int, datetime, date]] = None,
         read_options=None,
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """Get a batch of data from an event time interval from the offline feature store.
 
         !!! example "Batch data for the last 24 hours"
             ```python
                 # get feature store instance
                 fs = ...
@@ -455,22 +517,32 @@
                 # get a batch of data
                 df = feature_view.get_batch_data(
                     start_time=start_date,
                     end_time=end_date
                 )
             ```
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             start_time: Start event time for the batch query, inclusive. Optional. Strings should be
                 formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             end_time: End event time for the batch query, exclusive. Optional. Strings should be
                 formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             read_options: User provided read options. Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             `DataFrame`: A dataframe
         """
 
         if self._batch_scoring_server is None:
             self.init_batch_scoring()
@@ -478,14 +550,15 @@
         return self._feature_view_engine.get_batch_data(
             self,
             start_time,
             end_time,
             self._batch_scoring_server.training_dataset_version,
             self._batch_scoring_server._transformation_functions,
             read_options,
+            spine,
         )
 
     def add_tag(self, name: str, value):
         """Attach a tag to a feature view.
 
         A tag consists of a name and value pair.
         Tag names are unique identifiers across the whole cluster.
@@ -605,14 +678,24 @@
         description: Optional[str] = "",
         extra_filter: Optional[Union[filter.Filter, filter.Logic]] = None,
         data_format: Optional[str] = "parquet",
         coalesce: Optional[bool] = False,
         seed: Optional[int] = None,
         statistics_config: Optional[Union[StatisticsConfig, bool, dict]] = None,
         write_options: Optional[Dict[Any, Any]] = {},
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """Create the metadata for a training dataset and save the corresponding training data into `location`.
         The training data can be retrieved by calling `feature_view.get_training_data`.
 
         !!! example "Create training dataset"
             ```python
             # get feature store instance
@@ -711,14 +794,18 @@
             3. tsv
             4. parquet
             5. avro
             6. orc
 
             Currently not supported petastorm, hdf5 and npy file formats.
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             start_time: Start event time for the training dataset query, inclusive. Optional. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             end_time: End event time for the training dataset query, exclusive. Optional. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
@@ -756,14 +843,20 @@
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             (td_version, `Job`): Tuple of training dataset version and job.
                 When using the `python` engine, it returns the Hopsworks Job
                 that was launched to create the training dataset.
         """
         td = training_dataset.TrainingDataset(
@@ -780,15 +873,15 @@
             seed=seed,
             statistics_config=statistics_config,
             coalesce=coalesce,
             extra_filter=extra_filter,
         )
         # td_job is used only if the python engine is used
         td, td_job = self._feature_view_engine.create_training_dataset(
-            self, td, write_options
+            self, td, write_options, spine
         )
         warnings.warn(
             "Incremented version to `{}`.".format(td.version),
             util.VersionWarning,
         )
 
         return td.version, td_job
@@ -805,14 +898,24 @@
         description: Optional[str] = "",
         extra_filter: Optional[Union[filter.Filter, filter.Logic]] = None,
         data_format: Optional[str] = "parquet",
         coalesce: Optional[bool] = False,
         seed: Optional[int] = None,
         statistics_config: Optional[Union[StatisticsConfig, bool, dict]] = None,
         write_options: Optional[Dict[Any, Any]] = {},
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """Create the metadata for a training dataset and save the corresponding training data into `location`.
         The training data is split into train and test set at random or according to time ranges.
         The training data can be retrieved by calling `feature_view.get_train_test_split`.
 
         !!! example "Create random splits"
             ```python
@@ -950,14 +1053,18 @@
 
             feature_view.create_train_test_split(
                 test_size=0.5
             )
             # Output: KeyError: 'category_c'
             ```
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             test_size: size of test set.
             train_start: Start event time for the train split query, inclusive. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             train_end: End event time for the train split query, exclusive. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
@@ -1002,14 +1109,20 @@
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             (td_version, `Job`): Tuple of training dataset version and job.
                 When using the `python` engine, it returns the Hopsworks Job
                 that was launched to create the training dataset.
         """
 
@@ -1034,15 +1147,15 @@
             seed=seed,
             statistics_config=statistics_config,
             coalesce=coalesce,
             extra_filter=extra_filter,
         )
         # td_job is used only if the python engine is used
         td, td_job = self._feature_view_engine.create_training_dataset(
-            self, td, write_options
+            self, td, write_options, spine
         )
         warnings.warn(
             "Incremented version to `{}`.".format(td.version),
             util.VersionWarning,
         )
 
         return td.version, td_job
@@ -1062,14 +1175,24 @@
         description: Optional[str] = "",
         extra_filter: Optional[Union[filter.Filter, filter.Logic]] = None,
         data_format: Optional[str] = "parquet",
         coalesce: Optional[bool] = False,
         seed: Optional[int] = None,
         statistics_config: Optional[Union[StatisticsConfig, bool, dict]] = None,
         write_options: Optional[Dict[Any, Any]] = {},
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """Create the metadata for a training dataset and save the corresponding training data into `location`.
         The training data is split into train, validation, and test set at random or according to time range.
         The training data can be retrieved by calling `feature_view.get_train_validation_test_split`.
 
         !!! example "Create random splits"
             ```python
@@ -1186,14 +1309,18 @@
             3. tsv
             4. parquet
             5. avro
             6. orc
 
             Currently not supported petastorm, hdf5 and npy file formats.
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             validation_size: size of validation set.
             test_size: size of test set.
             train_start: Start event time for the train split query, inclusive. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             train_end: End event time for the train split query, exclusive. Strings should
@@ -1245,14 +1372,20 @@
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             (td_version, `Job`): Tuple of training dataset version and job.
                 When using the `python` engine, it returns the Hopsworks Job
                 that was launched to create the training dataset.
         """
 
@@ -1285,27 +1418,37 @@
             seed=seed,
             statistics_config=statistics_config,
             coalesce=coalesce,
             extra_filter=extra_filter,
         )
         # td_job is used only if the python engine is used
         td, td_job = self._feature_view_engine.create_training_dataset(
-            self, td, write_options
+            self, td, write_options, spine
         )
         warnings.warn(
             "Incremented version to `{}`.".format(td.version),
             util.VersionWarning,
         )
 
         return td.version, td_job
 
     def recreate_training_dataset(
         self,
         training_dataset_version: int,
         write_options: Optional[Dict[Any, Any]] = None,
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """
         Recreate a training dataset.
 
         !!! example
             ```python
             # get feature store instance
@@ -1318,45 +1461,65 @@
             feature_view.recreate_training_dataset(training_dataset_version=1)
             ```
 
         !!! info
             If a materialised training data has deleted. Use `recreate_training_dataset()` to
             recreate the training data.
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             training_dataset_version: training dataset version
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, write_options can contain the
                 following entries:
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             `Job`: When using the `python` engine, it returns the Hopsworks Job
                 that was launched to create the training dataset.
         """
         td, td_job = self._feature_view_engine.recreate_training_dataset(
-            self, training_dataset_version, write_options
+            self, training_dataset_version, write_options, spine
         )
         return td_job
 
     def training_data(
         self,
         start_time: Optional[Union[str, int, datetime, date]] = None,
         end_time: Optional[Union[str, int, datetime, date]] = None,
         description: Optional[str] = "",
         extra_filter: Optional[Union[filter.Filter, filter.Logic]] = None,
         statistics_config: Optional[Union[StatisticsConfig, bool, dict]] = None,
         read_options: Optional[Dict[Any, Any]] = None,
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """
         Create the metadata for a training dataset and get the corresponding training data from the offline feature store.
         This returns the training data in memory and does not materialise data in storage.
         The training data can be recreated by calling `feature_view.get_training_data` with the metadata created.
 
         !!! example "Create random splits"
@@ -1390,14 +1553,18 @@
             features_df, labels_df = feature_view.training_data(
                 start_time=start_time,
                 end_time=end_time,
                 description='Description of a dataset'
             )
             ```
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             start_time: Start event time for the training dataset query, inclusive. Strings should
             be formatted in one of the following
                 formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             end_time: End event time for the training dataset query, exclusive. Strings should be
             formatted in one of the following
@@ -1421,14 +1588,20 @@
                 following entries:
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             (X, y): Tuple of dataframe of features and labels. If there are no labels, y returns `None`.
         """
         td = training_dataset.TrainingDataset(
             name=self.name,
             version=None,
@@ -1441,15 +1614,15 @@
             data_format="tsv",
             location="",
             statistics_config=statistics_config,
             training_dataset_type=training_dataset.TrainingDataset.IN_MEMORY,
             extra_filter=extra_filter,
         )
         td, df = self._feature_view_engine.get_training_data(
-            self, read_options, training_dataset_obj=td
+            self, read_options, training_dataset_obj=td, spine=spine
         )
         warnings.warn(
             "Incremented version to `{}`.".format(td.version),
             util.VersionWarning,
         )
         return df
 
@@ -1460,14 +1633,24 @@
         train_end: Optional[Union[str, int, datetime, date]] = "",
         test_start: Optional[Union[str, int, datetime, date]] = "",
         test_end: Optional[Union[str, int, datetime, date]] = "",
         description: Optional[str] = "",
         extra_filter: Optional[Union[filter.Filter, filter.Logic]] = None,
         statistics_config: Optional[Union[StatisticsConfig, bool, dict]] = None,
         read_options: Optional[Dict[Any, Any]] = None,
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """
         Create the metadata for a training dataset and get the corresponding training data from the offline feature store.
         This returns the training data in memory and does not materialise data in storage.
         The training data is split into train and test set at random or according to time ranges.
         The training data can be recreated by calling `feature_view.get_train_test_split` with the metadata created.
 
@@ -1506,14 +1689,18 @@
                 train_end=train_end,
                 test_start=test_start,
                 test_end=test_end,
                 description='Description of a dataset'
             )
             ```
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             test_size: size of test set. Should be between 0 and 1.
             train_start: Start event time for the train split query, inclusive. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`.
             train_end: End event time for the train split query, exclusive. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
@@ -1542,14 +1729,20 @@
                 following entries:
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             (X_train, X_test, y_train, y_test):
                 Tuple of dataframe of features and labels
         """
         self._validate_train_test_split(
             test_size=test_size, train_end=train_end, test_start=test_start
@@ -1574,14 +1767,15 @@
             extra_filter=extra_filter,
         )
         td, df = self._feature_view_engine.get_training_data(
             self,
             read_options,
             training_dataset_obj=td,
             splits=[TrainingDatasetSplit.TRAIN, TrainingDatasetSplit.TEST],
+            spine=spine,
         )
         warnings.warn(
             "Incremented version to `{}`.".format(td.version),
             util.VersionWarning,
         )
         return df
 
@@ -1604,14 +1798,24 @@
         validation_end: Optional[Union[str, int, datetime, date]] = "",
         test_start: Optional[Union[str, int, datetime, date]] = "",
         test_end: Optional[Union[str, int, datetime, date]] = "",
         description: Optional[str] = "",
         extra_filter: Optional[Union[filter.Filter, filter.Logic]] = None,
         statistics_config: Optional[Union[StatisticsConfig, bool, dict]] = None,
         read_options: Optional[Dict[Any, Any]] = None,
+        spine: Optional[
+            Union[
+                pd.DataFrame,
+                TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
+                TypeVar("pyspark.RDD"),  # noqa: F821
+                np.ndarray,
+                List[list],
+                TypeVar("SpineGroup"),
+            ]
+        ] = None,
     ):
         """
         Create the metadata for a training dataset and get the corresponding training data from the offline feature store.
         This returns the training data in memory and does not materialise data in storage.
         The training data is split into train, validation, and test set at random or according to time ranges.
         The training data can be recreated by calling `feature_view.get_train_validation_test_split` with the metadata created.
 
@@ -1656,14 +1860,18 @@
                 validation_start=start_time_val,
                 validation_end=end_time_val,
                 test_start=start_time_test,
                 test_end=end_time_test
             )
             ```
 
+        !!! warning "Spine Groups/Dataframes"
+            Spine groups and dataframes are currently only supported with the Spark engine and
+            Spark dataframes.
+
         # Arguments
             validation_size: size of validation set. Should be between 0 and 1.
             test_size: size of test set. Should be between 0 and 1.
             train_start: Start event time for the train split query, inclusive. Strings should
                 be formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             train_end: End event time for the train split query, exclusive. Strings should
@@ -1699,14 +1907,20 @@
                 following entries:
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 Defaults to `{}`.
+            spine: Spine dataframe with primary key, event time and
+                label column to use for point in time join when fetching features. Defaults to `None` and is only required
+                when feature view was created with spine group in the feature query.
+                It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
+                feature join, however, the same features as in the original feature group that is being replaced need to
+                be available in the spine group.
 
         # Returns
             (X_train, X_val, X_test, y_train, y_val, y_test):
                 Tuple of dataframe of features and labels
         """
 
         self._validate_train_validation_test_split(
@@ -1744,14 +1958,15 @@
             read_options,
             training_dataset_obj=td,
             splits=[
                 TrainingDatasetSplit.TRAIN,
                 TrainingDatasetSplit.VALIDATION,
                 TrainingDatasetSplit.TEST,
             ],
+            spine=spine,
         )
         warnings.warn(
             "Incremented version to `{}`.".format(td.version),
             util.VersionWarning,
         )
         return df
 
@@ -2256,14 +2471,19 @@
         self._transformation_functions = transformation_functions
 
     @property
     def schema(self):
         """Feature view schema."""
         return self._features
 
+    @property
+    def features(self):
+        """Feature view schema. (alias)"""
+        return self._features
+
     @schema.setter
     def schema(self, features):
         self._features = features
 
     @property
     def primary_keys(self):
         """Set of primary key names that is used as keys in input dict object for `get_serving_vector` method."""
```

### Comparing `hsfs-3.2.1/hsfs/ge_expectation.py` & `hsfs-3.3.0rc0/hsfs/ge_expectation.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/ge_validation_result.py` & `hsfs-3.3.0rc0/hsfs/ge_validation_result.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/split_statistics.py` & `hsfs-3.3.0rc0/hsfs/split_statistics.py`

 * *Files 0% similar despite different names*

```diff
@@ -20,15 +20,14 @@
 from hsfs import util
 
 
 class SplitStatistics:
     def __init__(
         self, name, content, href=None, expand=None, items=None, count=None, type=None
     ):
-
         self._name = name
         if not isinstance(content, dict):
             self._content = json.loads(content)
         else:
             self._content = content
 
     @classmethod
```

### Comparing `hsfs-3.2.1/hsfs/statistics.py` & `hsfs-3.3.0rc0/hsfs/statistics.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/statistics_config.py` & `hsfs-3.3.0rc0/hsfs/statistics_config.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/storage_connector.py` & `hsfs-3.3.0rc0/hsfs/storage_connector.py`

 * *Files 2% similar despite different names*

```diff
@@ -44,35 +44,38 @@
         self._storage_connector_api = storage_connector_api.StorageConnectorApi(
             self._featurestore_id
         )
 
     @classmethod
     def from_response_json(cls, json_dict):
         json_decamelized = humps.decamelize(json_dict)
-        _ = json_decamelized.pop("type")
+        _ = json_decamelized.pop("type", None)
         for subcls in cls.__subclasses__():
             if subcls.type == json_decamelized["storage_connector_type"]:
                 _ = json_decamelized.pop("storage_connector_type")
                 return subcls(**json_decamelized)
         raise ValueError
 
     def update_from_response_json(self, json_dict):
         json_decamelized = humps.decamelize(json_dict)
-        _ = json_decamelized.pop("type")
+        _ = json_decamelized.pop("type", None)
         if self.type == json_decamelized["storage_connector_type"]:
             _ = json_decamelized.pop("storage_connector_type")
             self.__init__(**json_decamelized)
         else:
             raise ValueError("Failed to update storage connector information.")
         return self
 
     def to_dict(self):
-        # Currently we use this method only when creating on demand feature groups.
-        # The backend needs only the id.
-        return {"id": self._id}
+        return {
+            "id": self._id,
+            "name": self._name,
+            "featurestoreId": self._featurestore_id,
+            "storageConnectorType": self.type,
+        }
 
     @property
     def type(self):
         """Type of the connector as string, e.g. "HOPFS, S3, ADLS, REDSHIFT, JDBC or SNOWFLAKE."""
         return self._type
 
     @property
@@ -173,25 +176,29 @@
         access_key=None,
         secret_key=None,
         server_encryption_algorithm=None,
         server_encryption_key=None,
         bucket=None,
         session_token=None,
         iam_role=None,
+        arguments=None,
     ):
         super().__init__(id, name, description, featurestore_id)
 
         # S3
         self._access_key = access_key
         self._secret_key = secret_key
         self._server_encryption_algorithm = server_encryption_algorithm
         self._server_encryption_key = server_encryption_key
         self._bucket = bucket
         self._session_token = session_token
         self._iam_role = iam_role
+        self._arguments = (
+            {opt["name"]: opt["value"] for opt in arguments} if arguments else {}
+        )
 
     @property
     def access_key(self):
         """Access key."""
         return self._access_key
 
     @property
@@ -225,19 +232,23 @@
         return self._iam_role
 
     @property
     def path(self):
         """If the connector refers to a path (e.g. S3) - return the path of the connector"""
         return "s3://" + self._bucket
 
+    @property
+    def arguments(self):
+        return self._arguments
+
     def spark_options(self):
         """Return prepared options to be passed to Spark, based on the additional
         arguments.
         """
-        return {}
+        return self._arguments
 
     def prepare_spark(self, path: Optional[str] = None):
         """Prepare Spark to use this Storage Connector.
 
         ```python
         conn.prepare_spark()
 
@@ -253,15 +264,15 @@
         return engine.get_instance().setup_storage_connector(self, path)
 
     def read(
         self,
         query: str = None,
         data_format: str = None,
         options: dict = {},
-        path: str = None,
+        path: str = "",
     ):
         """Reads a query or a path into a dataframe using the storage connector.
 
         Note, paths are only supported for object stores like S3, HopsFS and ADLS, while
         queries are meant for JDBC or databases like Redshift and Snowflake.
 
         # Arguments
@@ -270,14 +281,27 @@
             options: Any additional key/value options to be passed to the S3 connector.
             path: Path within the bucket to be read.
 
         # Returns
             `DataFrame`.
         """
         self.refetch()
+        options = (
+            {**self.spark_options(), **options}
+            if options is not None
+            else self.spark_options()
+        )
+        if not path.startswith("s3://"):
+            path = self._get_path(path)
+            print(
+                "Prepending default bucket specified on connector, final path: {}".format(
+                    path
+                )
+            )
+
         return engine.get_instance().read(self, data_format, options, path)
 
     def _get_path(self, sub_path: str):
         return os.path.join(self.path, sub_path)
 
 
 class RedshiftConnector(StorageConnector):
@@ -994,14 +1018,15 @@
             options,
             include_metadata,
         )
 
 
 class GcsConnector(StorageConnector):
     type = StorageConnector.GCS
+    GS_FS_PREFIX = "gs://"  # Google Storage Filesystem prefix
 
     def __init__(
         self,
         id,
         name,
         featurestore_id,
         description=None,
@@ -1039,15 +1064,15 @@
     def encryption_key_hash(self):
         """Encryption Key Hash"""
         return self._encryption_key_hash
 
     @property
     def path(self):
         """the path of the connector along with gs file system prefixed"""
-        return "gs://" + self._bucket
+        return self.GS_FS_PREFIX + self._bucket
 
     @property
     def bucket(self):
         """GCS Bucket"""
         return self._bucket
 
     def _get_path(self, sub_path: str):
@@ -1063,33 +1088,56 @@
         return {}
 
     def read(
         self,
         query: str = None,
         data_format: str = None,
         options: dict = {},
-        path: str = None,
+        path: str = "",
     ):
         """Reads GCS path into a dataframe using the storage connector.
 
+        To read directly from the default bucket, you can omit the path argument:
+        ```python
+        conn.read(data_format='spark_formats')
+        ```
+        Or to read objects from default bucket provide the object path without gsUtil URI schema. For example,
+        following will read from a path gs://bucket_on_connector/Path/object :
+        ```python
+        conn.read(data_format='spark_formats', paths='Path/object')
+        ```
+        Or to read with full gsUtil URI path,
         ```python
         conn.read(data_format='spark_formats',path='gs://BUCKET/DATA')
         ```
-
         # Arguments
             query: Not relevant for GCS connectors.
             data_format: Spark data format. Defaults to `None`.
             options: Spark options. Defaults to `None`.
             path: GCS path. Defaults to `None`.
         # Raises
             `ValueError`: Malformed arguments.
 
         # Returns
             `Dataframe`: A Spark dataframe.
         """
+        # validate engine supports connector type
+        if not engine.get_instance().is_connector_type_supported(self.type):
+            raise NotImplementedError(
+                "GCS connector not yet supported for engine: " + engine.get_type()
+            )
+
+        # validate path begins with gs://
+        if not path.startswith(self.GS_FS_PREFIX):
+            path = self._get_path(path)
+            print(
+                "Prepending default bucket specified on connector, final path: {}".format(
+                    path
+                )
+            )
 
         return engine.get_instance().read(self, data_format, options, path)
 
     def prepare_spark(self, path: Optional[str] = None):
         """Prepare Spark to use this Storage Connector.
 
         ```python
@@ -1237,22 +1285,35 @@
 
         # Raises
             `ValueError`: Malformed arguments.
 
         # Returns
             `Dataframe`: A Spark dataframe.
         """
-
+        # validate engine supports connector type
+        if not engine.get_instance().is_connector_type_supported(self.type):
+            raise NotImplementedError(
+                "BigQuery connector not yet supported for engine: " + engine.get_type()
+            )
         # merge user spark options on top of default spark options
         options = (
             {**self.spark_options(), **options}
             if options is not None
             else self.spark_options()
         )
         if query:
+            if not {self.BIGQ_MATERIAL_DATASET, self.BIGQ_VIEWS_ENABLED}.issubset(
+                options.keys()
+            ):
+                raise ValueError(
+                    "BigQuery materialization views should be enabled for SQL query. "
+                    "Set spark options viewsEnabled=True and "
+                    + self.BIGQ_MATERIAL_DATASET
+                    + "=<temporaryDatasetName> to options argument or instead use BigQuery Query type connector from UI."
+                )
             path = query
         elif self._query_table:
             path = self._query_table
         elif path:
             pass
         else:
             raise ValueError(
```

### Comparing `hsfs-3.2.1/hsfs/training_dataset.py` & `hsfs-3.3.0rc0/hsfs/training_dataset.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/training_dataset_feature.py` & `hsfs-3.3.0rc0/hsfs/training_dataset_feature.py`

 * *Files 4% similar despite different names*

```diff
@@ -107,7 +107,10 @@
     @transformation_function.setter
     def transformation_function(self, transformation_function):
         self._transformation_function = transformation_function
 
     @property
     def feature_group(self):
         return self._feature_group
+
+    def __repr__(self):
+        return f"Training Dataset Feature({self._name!r}, {self._type!r}, {self._index!r}, {self._label}, {self._transformation_function}, {self._feature_group_feature_name}, {self._feature_group.id!r})"
```

### Comparing `hsfs-3.2.1/hsfs/transformation_function.py` & `hsfs-3.3.0rc0/hsfs/transformation_function.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/transformation_function_attached.py` & `hsfs-3.3.0rc0/hsfs/transformation_function_attached.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/user.py` & `hsfs-3.3.0rc0/hsfs/user.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/util.py` & `hsfs-3.3.0rc0/hsfs/util.py`

 * *Files 7% similar despite different names*

```diff
@@ -13,22 +13,26 @@
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import re
 import json
 import pandas as pd
+import time
+import threading
+import itertools
 
 from datetime import datetime, date, timezone
 from urllib.parse import urljoin, urlparse
 
 from sqlalchemy import create_engine
 
 from hsfs import client, feature
 from hsfs.client import exceptions
+from hsfs.core import variable_api
 
 
 class FeatureStoreEncoder(json.JSONEncoder):
     def default(self, o):
         try:
             return o.to_dict()
         except AttributeError:
@@ -73,17 +77,23 @@
     # useSSL and allowPublicKeyRetrieval are not valid properties for the pymysql driver
     # to use SSL we'll have to something like this:
     # ssl_args = {'ssl_ca': ca_path}
     # engine = create_engine("mysql+pymysql://<user>:<pass>@<addr>/<schema>", connect_args=ssl_args)
     if external:
         # This only works with external clients.
         # Hopsworks clients should use the storage connector
+        host = variable_api.VariableApi().get_loadbalancer_external_domain()
+        if host == "":
+            # If the load balancer is not configured, then fall back to
+            # use the MySQL node on the head node
+            host = client.get_instance().host
+
         online_options["url"] = re.sub(
             "/[0-9.]+:",
-            "/{}:".format(client.get_instance().host),
+            "/{}:".format(host),
             online_options["url"],
         )
 
     sql_alchemy_conn_str = (
         online_options["url"]
         .replace(
             "jdbc:mysql://",
@@ -296,14 +306,50 @@
         return "DATE"
     elif output_type == "BooleanType()":
         return "BOOLEAN"
     else:
         return "STRING"  # handle gracefully, and return STRING type, the default for spark udfs
 
 
+def _loading_animation(message, stop_event):
+    for char in itertools.cycle([".", "..", "...", ""]):
+        if stop_event.is_set():
+            break
+        print(f"{message}{char}   ", end="\r")
+        time.sleep(0.5)
+
+
+def run_with_loading_animation(message, func, *args, **kwargs):
+    stop_event = threading.Event()
+    t = threading.Thread(
+        target=_loading_animation,
+        args=(
+            message,
+            stop_event,
+        ),
+    )
+    t.daemon = True
+    t.start()
+    start = time.time()
+    end = None
+
+    try:
+        result = func(*args, **kwargs)
+        end = time.time()
+        return result
+    finally:
+        # Stop the animation and print the "Finished Querying" message
+        stop_event.set()
+        t.join()
+        if not end:
+            print(f"\rError: {message}           ", end="\n")
+        else:
+            print(f"\rFinished: {message} ({(end-start):.2f}s) ", end="\n")
+
+
 class VersionWarning(Warning):
     pass
 
 
 class JobWarning(Warning):
     pass
```

### Comparing `hsfs-3.2.1/hsfs/validation_report.py` & `hsfs-3.3.0rc0/hsfs/validation_report.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.2.1/hsfs/version.py` & `hsfs-3.3.0rc0/hsfs/version.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,8 +10,8 @@
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
-__version__ = "3.2.1"
+__version__ = "3.3.0rc0"
```

### Comparing `hsfs-3.2.1/hsfs.egg-info/PKG-INFO` & `hsfs-3.3.0rc0/hsfs.egg-info/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 Metadata-Version: 2.1
 Name: hsfs
-Version: 3.2.1
+Version: 3.3.0rc0
 Summary: HSFS: An environment independent client to interact with the Hopsworks Featurestore
 Home-page: https://github.com/logicalclocks/feature-store-api
 Author: Hopsworks AB
 Author-email: moritz@logicalclocks.com
 License: Apache License 2.0
-Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.2.1
+Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.3.0rc0
 Description: # Hopsworks Feature Store
         
         <p align="center">
           <a href="https://community.hopsworks.ai"><img
             src="https://img.shields.io/discourse/users?label=Hopsworks%20Community&server=https%3A%2F%2Fcommunity.hopsworks.ai"
             alt="Hopsworks Community"
           /></a>
@@ -165,10 +165,11 @@
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Intended Audience :: Developers
 Requires-Python: >=3.7,<3.11
 Description-Content-Type: text/markdown
 Provides-Extra: dev
+Provides-Extra: dev-pandas1
 Provides-Extra: docs
 Provides-Extra: hive
 Provides-Extra: python
```

#### html2text {}

```diff
@@ -1,12 +1,12 @@
-Metadata-Version: 2.1 Name: hsfs Version: 3.2.1 Summary: HSFS: An environment
-independent client to interact with the Hopsworks Featurestore Home-page:
-https://github.com/logicalclocks/feature-store-api Author: Hopsworks AB Author-
-email: moritz@logicalclocks.com License: Apache License 2.0 Download-URL:
-https://github.com/logicalclocks/feature-store-api/releases/tag/3.2.1
+Metadata-Version: 2.1 Name: hsfs Version: 3.3.0rc0 Summary: HSFS: An
+environment independent client to interact with the Hopsworks Featurestore
+Home-page: https://github.com/logicalclocks/feature-store-api Author: Hopsworks
+AB Author-email: moritz@logicalclocks.com License: Apache License 2.0 Download-
+URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.3.0rc0
 Description: # Hopsworks Feature Store
   [Hopsworks_Community] [Hopsworks_Feature_Store_Documentation] [PyPiStatus]
            [Scala/Java_Artifacts] [Downloads] [CodeStyle] [License]
 HSFS is the library to interact with the Hopsworks Feature Store. The library
 makes creating new features, feature groups and training datasets easy. The
 library is environment independent and can be used in two modes: - Spark mode:
 For data engineering jobs that create and write features into the feature store
@@ -63,9 +63,9 @@
 Guidelines](CONTRIBUTING.md). Keywords: Hopsworks,Feature Store,Spark,Machine
 Learning,MLOps,DataOps Platform: UNKNOWN Classifier: Development Status :: 5 -
 Production/Stable Classifier: Topic :: Utilities Classifier: License :: OSI
 Approved :: Apache Software License Classifier: Programming Language :: Python
 :: 3.8 Classifier: Programming Language :: Python :: 3.9 Classifier:
 Programming Language :: Python :: 3.10 Classifier: Intended Audience ::
 Developers Requires-Python: >=3.7,<3.11 Description-Content-Type: text/markdown
-Provides-Extra: dev Provides-Extra: docs Provides-Extra: hive Provides-Extra:
-python
+Provides-Extra: dev Provides-Extra: dev-pandas1 Provides-Extra: docs Provides-
+Extra: hive Provides-Extra: python
```

### Comparing `hsfs-3.2.1/hsfs.egg-info/SOURCES.txt` & `hsfs-3.3.0rc0/hsfs.egg-info/SOURCES.txt`

 * *Files 4% similar despite different names*

```diff
@@ -47,14 +47,15 @@
 hsfs/constructor/fs_query.py
 hsfs/constructor/hudi_feature_group_alias.py
 hsfs/constructor/join.py
 hsfs/constructor/prepared_statement_parameter.py
 hsfs/constructor/query.py
 hsfs/constructor/serving_prepared_statement.py
 hsfs/core/__init__.py
+hsfs/core/arrow_flight_client.py
 hsfs/core/builtin_transformation_function.py
 hsfs/core/code_api.py
 hsfs/core/code_engine.py
 hsfs/core/dataset_api.py
 hsfs/core/deltastreamer_jobconf.py
 hsfs/core/execution.py
 hsfs/core/expectation_api.py
@@ -78,14 +79,15 @@
 hsfs/core/job.py
 hsfs/core/job_api.py
 hsfs/core/job_configuration.py
 hsfs/core/kafka_api.py
 hsfs/core/project_api.py
 hsfs/core/query_constructor_api.py
 hsfs/core/services_api.py
+hsfs/core/spine_group_engine.py
 hsfs/core/statistics_api.py
 hsfs/core/statistics_engine.py
 hsfs/core/storage_connector_api.py
 hsfs/core/tags_api.py
 hsfs/core/training_dataset_api.py
 hsfs/core/training_dataset_engine.py
 hsfs/core/training_dataset_job_conf.py
```

### Comparing `hsfs-3.2.1/setup.py` & `hsfs-3.3.0rc0/setup.py`

 * *Files 11% similar despite different names*

```diff
@@ -17,57 +17,69 @@
     version=__version__,
     python_requires=">=3.7,<3.11",
     install_requires=[
         "pyhumps==1.6.1",
         "requests",
         "furl",
         "boto3",
-        "pandas>=1.2.0,<2.0.0",
+        "pandas",
         "numpy",
         "pyjks",
         "mock",
         "avro==1.11.0",
         "sqlalchemy",
         "PyMySQL[rsa]",
         "great_expectations==0.14.13",
         "markupsafe<2.1.0",  # GE issue 1: jinja2==2.11.3, pulls in markupsafe 2.1.0 which is not compatible with jinja2==2.11.3.
         "tzlocal",
+        "fsspec",
     ],
     extras_require={
         "dev": [
             "pytest==7.1.2",
             "pytest-mock==3.8.2",
             "flake8",
             "black",
             "pyspark==3.1.1",
             "moto[s3]",
         ],
+        "dev-pandas1": [
+            "pytest==7.1.2",
+            "pytest-mock==3.8.2",
+            "flake8",
+            "black",
+            "pyspark==3.1.1",
+            "moto[s3]",
+            "pandas<=1.5.3",
+            "sqlalchemy<=1.4.48",
+        ],
         "docs": [
             "mkdocs==1.3.0",
             "mkdocs-material==8.2.8",
             "mike==1.1.2",
             "sphinx==3.5.4",
             "keras_autodoc @ git+https://git@github.com/moritzmeister/keras-autodoc@split-tags-properties",
             "markdown-include",
             "mkdocs-jupyter==0.21.0",
             "markdown==3.3.7",
             "pymdown-extensions",
             "mkdocs-macros-plugin==0.7.0",
+            "mkdocs-minify-plugin>=0.2.0",
         ],
         "hive": [
             "pyhopshive[thrift]",
-            "pyarrow",
+            "pyarrow>=10.0",
             "confluent-kafka<=1.9.0",
-            "fastavro>=1.4.11,<=1.8.2",
+            "fastavro>=1.4.11,<=1.7.3",
         ],
         "python": [
             "pyhopshive[thrift]",
-            "pyarrow",
+            "pyarrow>=10.0",
             "confluent-kafka<=1.9.0",
-            "fastavro>=1.4.11,<=1.8.2",
+            "fastavro>=1.4.11,<=1.7.3",
             "tqdm",
         ],
     },
     author="Hopsworks AB",
     author_email="moritz@logicalclocks.com",
     description="HSFS: An environment independent client to interact with the Hopsworks Featurestore",
     license="Apache License 2.0",
```

