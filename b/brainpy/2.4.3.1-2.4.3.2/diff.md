# Comparing `tmp/brainpy-2.4.3.1-py3-none-any.whl.zip` & `tmp/brainpy-2.4.3.2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,154 +1,154 @@
-Zip file size: 657793 bytes, number of entries: 333
--rw-rw-rw-  2.0 fat     4723 b- defN 23-Jul-23 07:42 brainpy/__init__.py
--rw-rw-rw-  2.0 fat     6082 b- defN 23-Jul-21 14:18 brainpy/_add_deprecations.py
+Zip file size: 658173 bytes, number of entries: 333
+-rw-rw-rw-  2.0 fat     4723 b- defN 23-Jul-24 02:46 brainpy/__init__.py
+-rw-rw-rw-  2.0 fat     6082 b- defN 23-Jul-23 10:10 brainpy/_add_deprecations.py
 -rw-rw-rw-  2.0 fat      686 b- defN 23-Jun-22 06:44 brainpy/analysis.py
--rw-rw-rw-  2.0 fat       81 b- defN 23-Jul-23 02:03 brainpy/channels.py
--rw-rw-rw-  2.0 fat    19618 b- defN 23-Jul-21 14:18 brainpy/check.py
+-rw-rw-rw-  2.0 fat       81 b- defN 23-Jul-23 10:10 brainpy/channels.py
+-rw-rw-rw-  2.0 fat    19618 b- defN 23-Jul-23 10:10 brainpy/check.py
 -rw-rw-rw-  2.0 fat      429 b- defN 23-Jul-21 14:18 brainpy/checkpoints.py
 -rw-rw-rw-  2.0 fat     1332 b- defN 23-Jul-21 14:18 brainpy/connect.py
 -rw-rw-rw-  2.0 fat      338 b- defN 23-Jun-22 06:44 brainpy/encoding.py
--rw-rw-rw-  2.0 fat     7807 b- defN 23-Jul-21 14:18 brainpy/errors.py
--rw-rw-rw-  2.0 fat      384 b- defN 23-Jul-21 14:18 brainpy/experimental.py
+-rw-rw-rw-  2.0 fat     7807 b- defN 23-Jul-23 10:10 brainpy/errors.py
+-rw-rw-rw-  2.0 fat      384 b- defN 23-Jul-23 10:10 brainpy/experimental.py
 -rw-rw-rw-  2.0 fat     1178 b- defN 23-Jun-22 06:44 brainpy/initialize.py
 -rw-rw-rw-  2.0 fat      348 b- defN 23-Jun-22 06:44 brainpy/inputs.py
 -rw-rw-rw-  2.0 fat       22 b- defN 23-Jul-21 14:18 brainpy/layers.py
 -rw-rw-rw-  2.0 fat     1124 b- defN 23-Jul-21 14:18 brainpy/losses.py
 -rw-rw-rw-  2.0 fat      506 b- defN 23-Jun-22 06:44 brainpy/measure.py
--rw-rw-rw-  2.0 fat      278 b- defN 23-Jul-21 14:18 brainpy/mixin.py
--rw-rw-rw-  2.0 fat      999 b- defN 23-Jul-21 14:18 brainpy/neurons.py
+-rw-rw-rw-  2.0 fat      335 b- defN 23-Jul-23 13:09 brainpy/mixin.py
+-rw-rw-rw-  2.0 fat      999 b- defN 23-Jul-23 10:10 brainpy/neurons.py
 -rw-rw-rw-  2.0 fat     1060 b- defN 23-Jun-22 06:44 brainpy/optim.py
--rw-rw-rw-  2.0 fat       57 b- defN 23-Jul-21 14:18 brainpy/rates.py
+-rw-rw-rw-  2.0 fat       57 b- defN 23-Jul-23 10:10 brainpy/rates.py
 -rw-rw-rw-  2.0 fat      482 b- defN 23-Jun-22 06:44 brainpy/running.py
--rw-rw-rw-  2.0 fat      970 b- defN 23-Jul-23 02:03 brainpy/synapses.py
--rw-rw-rw-  2.0 fat      196 b- defN 23-Jul-21 14:18 brainpy/synouts.py
--rw-rw-rw-  2.0 fat      126 b- defN 23-Jul-21 14:18 brainpy/synplast.py
+-rw-rw-rw-  2.0 fat      970 b- defN 23-Jul-23 10:10 brainpy/synapses.py
+-rw-rw-rw-  2.0 fat      196 b- defN 23-Jul-23 10:10 brainpy/synouts.py
+-rw-rw-rw-  2.0 fat      126 b- defN 23-Jul-23 10:10 brainpy/synplast.py
 -rw-rw-rw-  2.0 fat     1094 b- defN 23-Jul-21 14:18 brainpy/tools.py
 -rw-rw-rw-  2.0 fat      279 b- defN 23-Jul-21 14:18 brainpy/types.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-21 14:18 brainpy/_src/__init__.py
--rw-rw-rw-  2.0 fat    10243 b- defN 23-Jul-21 14:18 brainpy/_src/_delay.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-23 10:10 brainpy/_src/__init__.py
+-rw-rw-rw-  2.0 fat    10243 b- defN 23-Jul-23 10:10 brainpy/_src/_delay.py
 -rw-rw-rw-  2.0 fat     2509 b- defN 23-Jul-21 14:18 brainpy/_src/checking.py
--rw-rw-rw-  2.0 fat     2714 b- defN 23-Jul-21 14:18 brainpy/_src/context.py
--rw-rw-rw-  2.0 fat    23734 b- defN 23-Jul-21 14:18 brainpy/_src/delay.py
--rw-rw-rw-  2.0 fat     2121 b- defN 23-Jul-21 14:18 brainpy/_src/deprecations.py
--rw-rw-rw-  2.0 fat    26006 b- defN 23-Jul-23 02:03 brainpy/_src/dynsys.py
--rw-rw-rw-  2.0 fat    20151 b- defN 23-Jul-23 02:03 brainpy/_src/mixin.py
+-rw-rw-rw-  2.0 fat     2714 b- defN 23-Jul-23 10:10 brainpy/_src/context.py
+-rw-rw-rw-  2.0 fat    23805 b- defN 23-Jul-24 02:42 brainpy/_src/delay.py
+-rw-rw-rw-  2.0 fat     2121 b- defN 23-Jul-23 10:10 brainpy/_src/deprecations.py
+-rw-rw-rw-  2.0 fat    25795 b- defN 23-Jul-23 13:29 brainpy/_src/dynsys.py
+-rw-rw-rw-  2.0 fat    21257 b- defN 23-Jul-23 13:30 brainpy/_src/mixin.py
 -rw-rw-rw-  2.0 fat     1128 b- defN 23-Jul-21 14:18 brainpy/_src/modes.py
--rw-rw-rw-  2.0 fat    24011 b- defN 23-Jul-23 02:03 brainpy/_src/runners.py
--rw-rw-rw-  2.0 fat    10537 b- defN 23-Jul-21 14:18 brainpy/_src/transform.py
+-rw-rw-rw-  2.0 fat    24011 b- defN 23-Jul-23 10:10 brainpy/_src/runners.py
+-rw-rw-rw-  2.0 fat    10537 b- defN 23-Jul-23 10:10 brainpy/_src/transform.py
 -rw-rw-rw-  2.0 fat     1102 b- defN 23-Jul-21 14:18 brainpy/_src/types.py
 -rw-rw-rw-  2.0 fat      871 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/__init__.py
 -rw-rw-rw-  2.0 fat      168 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/base.py
 -rw-rw-rw-  2.0 fat     1807 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/constants.py
 -rw-rw-rw-  2.0 fat     3997 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/plotstyle.py
 -rw-rw-rw-  2.0 fat     5867 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/stability.py
 -rw-rw-rw-  2.0 fat       55 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/highdim/__init__.py
--rw-rw-rw-  2.0 fat    32019 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/highdim/slow_points.py
+-rw-rw-rw-  2.0 fat    32019 b- defN 23-Jul-23 10:10 brainpy/_src/analysis/highdim/slow_points.py
 -rw-rw-rw-  2.0 fat       97 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/lowdim/__init__.py
--rw-rw-rw-  2.0 fat    45602 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/lowdim/lowdim_analyzer.py
--rw-rw-rw-  2.0 fat    25133 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/lowdim/lowdim_bifurcation.py
--rw-rw-rw-  2.0 fat    20543 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/lowdim/lowdim_phase_plane.py
+-rw-rw-rw-  2.0 fat    45602 b- defN 23-Jul-23 10:10 brainpy/_src/analysis/lowdim/lowdim_analyzer.py
+-rw-rw-rw-  2.0 fat    25133 b- defN 23-Jul-23 10:10 brainpy/_src/analysis/lowdim/lowdim_bifurcation.py
+-rw-rw-rw-  2.0 fat    20543 b- defN 23-Jul-23 10:10 brainpy/_src/analysis/lowdim/lowdim_phase_plane.py
 -rw-rw-rw-  2.0 fat      208 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/utils/__init__.py
 -rw-rw-rw-  2.0 fat     2944 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/utils/function.py
 -rw-rw-rw-  2.0 fat     3173 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/utils/measurement.py
--rw-rw-rw-  2.0 fat     5341 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/utils/model.py
+-rw-rw-rw-  2.0 fat     5341 b- defN 23-Jul-23 10:10 brainpy/_src/analysis/utils/model.py
 -rw-rw-rw-  2.0 fat    20145 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/utils/optimization.py
 -rw-rw-rw-  2.0 fat     6003 b- defN 23-Jul-21 14:18 brainpy/_src/analysis/utils/others.py
 -rw-rw-rw-  2.0 fat      171 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/utils/outputs.py
 -rw-rw-rw-  2.0 fat     1002 b- defN 23-Jun-28 12:42 brainpy/_src/analysis/utils/visualization.py
 -rw-rw-rw-  2.0 fat      178 b- defN 23-Jul-21 14:18 brainpy/_src/base/__init__.py
 -rw-rw-rw-  2.0 fat       25 b- defN 23-Jun-28 12:42 brainpy/_src/base/collector.py
 -rw-rw-rw-  2.0 fat       27 b- defN 23-Jun-28 12:42 brainpy/_src/base/function.py
 -rw-rw-rw-  2.0 fat     1049 b- defN 23-Jul-21 14:18 brainpy/_src/base/io.py
 -rw-rw-rw-  2.0 fat      321 b- defN 23-Jul-21 14:18 brainpy/_src/base/naming.py
 -rw-rw-rw-  2.0 fat       25 b- defN 23-Jun-28 12:42 brainpy/_src/checkpoints/__init__.py
 -rw-rw-rw-  2.0 fat    12625 b- defN 23-Jul-21 14:18 brainpy/_src/checkpoints/io.py
 -rw-rw-rw-  2.0 fat    58984 b- defN 23-Jul-21 14:18 brainpy/_src/checkpoints/serialization.py
 -rw-rw-rw-  2.0 fat      280 b- defN 23-Jun-28 12:42 brainpy/_src/connect/__init__.py
--rw-rw-rw-  2.0 fat    25459 b- defN 23-Jul-21 14:18 brainpy/_src/connect/base.py
--rw-rw-rw-  2.0 fat     4333 b- defN 23-Jul-21 14:18 brainpy/_src/connect/custom_conn.py
--rw-rw-rw-  2.0 fat    52570 b- defN 23-Jul-21 14:18 brainpy/_src/connect/random_conn.py
+-rw-rw-rw-  2.0 fat    25459 b- defN 23-Jul-23 10:10 brainpy/_src/connect/base.py
+-rw-rw-rw-  2.0 fat     4333 b- defN 23-Jul-23 10:10 brainpy/_src/connect/custom_conn.py
+-rw-rw-rw-  2.0 fat    52570 b- defN 23-Jul-23 10:10 brainpy/_src/connect/random_conn.py
 -rw-rw-rw-  2.0 fat     9473 b- defN 23-Jun-28 12:42 brainpy/_src/connect/regular_conn.py
 -rw-rw-rw-  2.0 fat      308 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/__init__.py
--rw-rw-rw-  2.0 fat    33758 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/activations.py
--rw-rw-rw-  2.0 fat      234 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/base.py
--rw-rw-rw-  2.0 fat    30591 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/conv.py
--rw-rw-rw-  2.0 fat     1464 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/dropout.py
--rw-rw-rw-  2.0 fat     1904 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/function.py
--rw-rw-rw-  2.0 fat     4260 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/interoperation_flax.py
--rw-rw-rw-  2.0 fat    37126 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/linear.py
--rw-rw-rw-  2.0 fat    26341 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/normalization.py
--rw-rw-rw-  2.0 fat     6949 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/nvar.py
--rw-rw-rw-  2.0 fat    35189 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/pooling.py
--rw-rw-rw-  2.0 fat     9114 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/reservoir.py
--rw-rw-rw-  2.0 fat    27783 b- defN 23-Jul-21 14:18 brainpy/_src/dnn/rnncells.py
+-rw-rw-rw-  2.0 fat    33758 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/activations.py
+-rw-rw-rw-  2.0 fat      234 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/base.py
+-rw-rw-rw-  2.0 fat    30591 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/conv.py
+-rw-rw-rw-  2.0 fat     1464 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/dropout.py
+-rw-rw-rw-  2.0 fat     1904 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/function.py
+-rw-rw-rw-  2.0 fat     4260 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/interoperation_flax.py
+-rw-rw-rw-  2.0 fat    37126 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/linear.py
+-rw-rw-rw-  2.0 fat    26341 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/normalization.py
+-rw-rw-rw-  2.0 fat     6949 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/nvar.py
+-rw-rw-rw-  2.0 fat    35189 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/pooling.py
+-rw-rw-rw-  2.0 fat     9114 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/reservoir.py
+-rw-rw-rw-  2.0 fat    27783 b- defN 23-Jul-23 10:10 brainpy/_src/dnn/rnncells.py
 -rw-rw-rw-  2.0 fat        2 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/__init__.py
--rw-rw-rw-  2.0 fat     1654 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/_docs.py
--rw-rw-rw-  2.0 fat      420 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/base.py
--rw-rw-rw-  2.0 fat      432 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/utils.py
--rw-rw-rw-  2.0 fat      221 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/channels/__init__.py
--rw-rw-rw-  2.0 fat      805 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/channels/base.py
--rw-rw-rw-  2.0 fat    28704 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/calcium.py
--rw-rw-rw-  2.0 fat     9442 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/hyperpolarization_activated.py
--rw-rw-rw-  2.0 fat     1570 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/channels/leaky.py
--rw-rw-rw-  2.0 fat    72311 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/potassium.py
--rw-rw-rw-  2.0 fat     4689 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/channels/potassium_calcium.py
--rw-rw-rw-  2.0 fat     4788 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/potassium_calcium_compatible.py
--rw-rw-rw-  2.0 fat    37946 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/potassium_compatible.py
--rw-rw-rw-  2.0 fat    12018 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/sodium.py
--rw-rw-rw-  2.0 fat    12425 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/channels/sodium_compatible.py
--rw-rw-rw-  2.0 fat       96 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/ions/__init__.py
--rw-rw-rw-  2.0 fat     7079 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/ions/base.py
--rw-rw-rw-  2.0 fat    12036 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/ions/calcium.py
--rw-rw-rw-  2.0 fat     1521 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/ions/potassium.py
--rw-rw-rw-  2.0 fat     1539 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/ions/sodium.py
+-rw-rw-rw-  2.0 fat     1654 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/_docs.py
+-rw-rw-rw-  2.0 fat      420 b- defN 23-Jul-23 13:03 brainpy/_src/dyn/base.py
+-rw-rw-rw-  2.0 fat      432 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/utils.py
+-rw-rw-rw-  2.0 fat      221 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/__init__.py
+-rw-rw-rw-  2.0 fat      805 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/base.py
+-rw-rw-rw-  2.0 fat    28704 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/calcium.py
+-rw-rw-rw-  2.0 fat     9442 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/hyperpolarization_activated.py
+-rw-rw-rw-  2.0 fat     1570 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/leaky.py
+-rw-rw-rw-  2.0 fat    72311 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/potassium.py
+-rw-rw-rw-  2.0 fat     4689 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/potassium_calcium.py
+-rw-rw-rw-  2.0 fat     4788 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/potassium_calcium_compatible.py
+-rw-rw-rw-  2.0 fat    37946 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/potassium_compatible.py
+-rw-rw-rw-  2.0 fat    12018 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/sodium.py
+-rw-rw-rw-  2.0 fat    12425 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/channels/sodium_compatible.py
+-rw-rw-rw-  2.0 fat       96 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/ions/__init__.py
+-rw-rw-rw-  2.0 fat     7147 b- defN 23-Jul-23 13:07 brainpy/_src/dyn/ions/base.py
+-rw-rw-rw-  2.0 fat    12036 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/ions/calcium.py
+-rw-rw-rw-  2.0 fat     1521 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/ions/potassium.py
+-rw-rw-rw-  2.0 fat     1539 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/ions/sodium.py
 -rw-rw-rw-  2.0 fat       24 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/neurons/__init__.py
--rw-rw-rw-  2.0 fat     1477 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/neurons/base.py
--rw-rw-rw-  2.0 fat    51059 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/neurons/hh.py
--rw-rw-rw-  2.0 fat    89947 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/neurons/lif.py
+-rw-rw-rw-  2.0 fat     1477 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/neurons/base.py
+-rw-rw-rw-  2.0 fat    49933 b- defN 23-Jul-23 13:07 brainpy/_src/dyn/neurons/hh.py
+-rw-rw-rw-  2.0 fat    88145 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/neurons/lif.py
 -rw-rw-rw-  2.0 fat       29 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/others/__init__.py
--rw-rw-rw-  2.0 fat     4293 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/others/common.py
--rw-rw-rw-  2.0 fat     6984 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/others/input.py
--rw-rw-rw-  2.0 fat     2278 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/others/noise.py
--rw-rw-rw-  2.0 fat       45 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/outs/__init__.py
--rw-rw-rw-  2.0 fat      779 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/outs/base.py
--rw-rw-rw-  2.0 fat     3314 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/outs/outputs.py
--rw-rw-rw-  2.0 fat       69 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/projections/__init__.py
--rw-rw-rw-  2.0 fat    30144 b- defN 23-Jul-23 02:03 brainpy/_src/dyn/projections/aligns.py
--rw-rw-rw-  2.0 fat     3872 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/projections/conn.py
--rw-rw-rw-  2.0 fat     2772 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/projections/others.py
--rw-rw-rw-  2.0 fat       55 b- defN 23-Jul-09 09:21 brainpy/_src/dyn/rates/__init__.py
--rw-rw-rw-  2.0 fat    42276 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/rates/populations.py
--rw-rw-rw-  2.0 fat       61 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/synapses/__init__.py
--rw-rw-rw-  2.0 fat    22572 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/synapses/abstract_models.py
--rw-rw-rw-  2.0 fat    12152 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/synapses/bio_models.py
--rw-rw-rw-  2.0 fat    11132 b- defN 23-Jul-21 14:18 brainpy/_src/dyn/synapses/delay_couplings.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/__init__.py
--rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/experimental/__init__.py
--rw-rw-rw-  2.0 fat    13965 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/experimental/abstract_synapses.py
--rw-rw-rw-  2.0 fat     4774 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/experimental/base.py
--rw-rw-rw-  2.0 fat     2632 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/experimental/others.py
--rw-rw-rw-  2.0 fat     2775 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/experimental/syn_outs.py
--rw-rw-rw-  2.0 fat     4898 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/experimental/syn_plasticity.py
--rw-rw-rw-  2.0 fat      126 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/neurons/__init__.py
--rw-rw-rw-  2.0 fat    37874 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/neurons/biological_models.py
--rw-rw-rw-  2.0 fat    13424 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/neurons/fractional_models.py
--rw-rw-rw-  2.0 fat    62971 b- defN 23-Jul-23 07:36 brainpy/_src/dynold/neurons/reduced_models.py
--rw-rw-rw-  2.0 fat      170 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synapses/__init__.py
--rw-rw-rw-  2.0 fat    29549 b- defN 23-Jul-23 02:03 brainpy/_src/dynold/synapses/abstract_models.py
--rw-rw-rw-  2.0 fat    10819 b- defN 23-Jul-23 02:03 brainpy/_src/dynold/synapses/base.py
--rw-rw-rw-  2.0 fat    13792 b- defN 23-Jul-23 02:03 brainpy/_src/dynold/synapses/biological_models.py
--rw-rw-rw-  2.0 fat     7826 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synapses/compat.py
--rw-rw-rw-  2.0 fat     2116 b- defN 23-Jul-23 02:03 brainpy/_src/dynold/synapses/gap_junction.py
--rw-rw-rw-  2.0 fat     8796 b- defN 23-Jul-23 02:03 brainpy/_src/dynold/synapses/learning_rules.py
--rw-rw-rw-  2.0 fat       77 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synouts/__init__.py
--rw-rw-rw-  2.0 fat     2727 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synouts/conductances.py
--rw-rw-rw-  2.0 fat     3363 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synouts/ions.py
--rw-rw-rw-  2.0 fat       65 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synplast/__init__.py
--rw-rw-rw-  2.0 fat     5782 b- defN 23-Jul-21 14:18 brainpy/_src/dynold/synplast/short_term_plasticity.py
+-rw-rw-rw-  2.0 fat     4293 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/others/common.py
+-rw-rw-rw-  2.0 fat     6984 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/others/input.py
+-rw-rw-rw-  2.0 fat     2278 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/others/noise.py
+-rw-rw-rw-  2.0 fat       45 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/outs/__init__.py
+-rw-rw-rw-  2.0 fat      779 b- defN 23-Jul-23 13:03 brainpy/_src/dyn/outs/base.py
+-rw-rw-rw-  2.0 fat     3314 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/outs/outputs.py
+-rw-rw-rw-  2.0 fat       69 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/projections/__init__.py
+-rw-rw-rw-  2.0 fat    30740 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/projections/aligns.py
+-rw-rw-rw-  2.0 fat     3872 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/projections/conn.py
+-rw-rw-rw-  2.0 fat     2772 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/projections/others.py
+-rw-rw-rw-  2.0 fat       55 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/rates/__init__.py
+-rw-rw-rw-  2.0 fat    42276 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/rates/populations.py
+-rw-rw-rw-  2.0 fat       61 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/synapses/__init__.py
+-rw-rw-rw-  2.0 fat    22572 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/synapses/abstract_models.py
+-rw-rw-rw-  2.0 fat    12152 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/synapses/bio_models.py
+-rw-rw-rw-  2.0 fat    11132 b- defN 23-Jul-23 10:10 brainpy/_src/dyn/synapses/delay_couplings.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/__init__.py
+-rw-rw-rw-  2.0 fat        0 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/experimental/__init__.py
+-rw-rw-rw-  2.0 fat    13965 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/experimental/abstract_synapses.py
+-rw-rw-rw-  2.0 fat     4774 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/experimental/base.py
+-rw-rw-rw-  2.0 fat     2632 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/experimental/others.py
+-rw-rw-rw-  2.0 fat     2775 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/experimental/syn_outs.py
+-rw-rw-rw-  2.0 fat     4898 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/experimental/syn_plasticity.py
+-rw-rw-rw-  2.0 fat      126 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/neurons/__init__.py
+-rw-rw-rw-  2.0 fat    37874 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/neurons/biological_models.py
+-rw-rw-rw-  2.0 fat    13424 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/neurons/fractional_models.py
+-rw-rw-rw-  2.0 fat    62971 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/neurons/reduced_models.py
+-rw-rw-rw-  2.0 fat      170 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/__init__.py
+-rw-rw-rw-  2.0 fat    29549 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/abstract_models.py
+-rw-rw-rw-  2.0 fat    10819 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/base.py
+-rw-rw-rw-  2.0 fat    13792 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/biological_models.py
+-rw-rw-rw-  2.0 fat     7826 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/compat.py
+-rw-rw-rw-  2.0 fat     2116 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/gap_junction.py
+-rw-rw-rw-  2.0 fat     8796 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synapses/learning_rules.py
+-rw-rw-rw-  2.0 fat       77 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synouts/__init__.py
+-rw-rw-rw-  2.0 fat     2727 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synouts/conductances.py
+-rw-rw-rw-  2.0 fat     3363 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synouts/ions.py
+-rw-rw-rw-  2.0 fat       65 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synplast/__init__.py
+-rw-rw-rw-  2.0 fat     5782 b- defN 23-Jul-23 10:10 brainpy/_src/dynold/synplast/short_term_plasticity.py
 -rw-rw-rw-  2.0 fat      121 b- defN 23-Jun-28 12:42 brainpy/_src/encoding/__init__.py
 -rw-rw-rw-  2.0 fat      381 b- defN 23-Jun-28 12:42 brainpy/_src/encoding/base.py
 -rw-rw-rw-  2.0 fat     4930 b- defN 23-Jul-21 14:18 brainpy/_src/encoding/stateful_encoding.py
 -rw-rw-rw-  2.0 fat     2224 b- defN 23-Jul-21 14:18 brainpy/_src/encoding/stateless_encoding.py
 -rw-rw-rw-  2.0 fat      163 b- defN 23-Jun-28 12:42 brainpy/_src/initialize/__init__.py
 -rw-rw-rw-  2.0 fat      644 b- defN 23-Jun-28 12:42 brainpy/_src/initialize/base.py
 -rw-rw-rw-  2.0 fat    13753 b- defN 23-Jul-21 14:18 brainpy/_src/initialize/decay_inits.py
@@ -170,15 +170,15 @@
 -rw-rw-rw-  2.0 fat     2861 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/fde/base.py
 -rw-rw-rw-  2.0 fat     2814 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/fde/generic.py
 -rw-rw-rw-  2.0 fat      231 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/ode/__init__.py
 -rw-rw-rw-  2.0 fat    18421 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/ode/adaptive_rk.py
 -rw-rw-rw-  2.0 fat     4995 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/ode/base.py
 -rw-rw-rw-  2.0 fat     1547 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/ode/common.py
 -rw-rw-rw-  2.0 fat    26850 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/ode/explicit_rk.py
--rw-rw-rw-  2.0 fat    14134 b- defN 23-Jul-21 14:18 brainpy/_src/integrators/ode/exponential.py
+-rw-rw-rw-  2.0 fat    14134 b- defN 23-Jul-23 10:10 brainpy/_src/integrators/ode/exponential.py
 -rw-rw-rw-  2.0 fat     4295 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/ode/generic.py
 -rw-rw-rw-  2.0 fat       25 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/pde/__init__.py
 -rw-rw-rw-  2.0 fat      106 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/pde/base.py
 -rw-rw-rw-  2.0 fat      196 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/sde/__init__.py
 -rw-rw-rw-  2.0 fat     3411 b- defN 23-Jul-21 14:18 brainpy/_src/integrators/sde/base.py
 -rw-rw-rw-  2.0 fat     4011 b- defN 23-Jun-28 12:42 brainpy/_src/integrators/sde/generic.py
 -rw-rw-rw-  2.0 fat    24810 b- defN 23-Jul-21 14:18 brainpy/_src/integrators/sde/normal.py
@@ -188,47 +188,47 @@
 -rw-rw-rw-  2.0 fat      469 b- defN 23-Jul-21 14:18 brainpy/_src/losses/base.py
 -rw-rw-rw-  2.0 fat    42034 b- defN 23-Jul-21 14:18 brainpy/_src/losses/comparison.py
 -rw-rw-rw-  2.0 fat     2447 b- defN 23-Jul-21 14:18 brainpy/_src/losses/regularization.py
 -rw-rw-rw-  2.0 fat      828 b- defN 23-Jun-28 12:42 brainpy/_src/losses/utils.py
 -rw-rw-rw-  2.0 fat     1549 b- defN 23-Jul-21 14:18 brainpy/_src/math/__init__.py
 -rw-rw-rw-  2.0 fat     1852 b- defN 23-Jul-21 14:18 brainpy/_src/math/_utils.py
 -rw-rw-rw-  2.0 fat    19658 b- defN 23-Jul-21 14:18 brainpy/_src/math/activations.py
--rw-rw-rw-  2.0 fat    30677 b- defN 23-Jul-21 14:18 brainpy/_src/math/compat_numpy.py
--rw-rw-rw-  2.0 fat     6732 b- defN 23-Jul-21 14:18 brainpy/_src/math/compat_pytorch.py
+-rw-rw-rw-  2.0 fat    30677 b- defN 23-Jul-23 10:10 brainpy/_src/math/compat_numpy.py
+-rw-rw-rw-  2.0 fat     6732 b- defN 23-Jul-23 10:10 brainpy/_src/math/compat_pytorch.py
 -rw-rw-rw-  2.0 fat    18341 b- defN 23-Jul-21 14:18 brainpy/_src/math/compat_tensorflow.py
 -rw-rw-rw-  2.0 fat      955 b- defN 23-Jun-28 12:42 brainpy/_src/math/datatypes.py
--rw-rw-rw-  2.0 fat    16624 b- defN 23-Jul-21 14:18 brainpy/_src/math/delayvars.py
+-rw-rw-rw-  2.0 fat    16624 b- defN 23-Jul-23 10:10 brainpy/_src/math/delayvars.py
 -rw-rw-rw-  2.0 fat    17477 b- defN 23-Jul-21 14:18 brainpy/_src/math/environment.py
 -rw-rw-rw-  2.0 fat     1528 b- defN 23-Jun-28 12:42 brainpy/_src/math/fft.py
 -rw-rw-rw-  2.0 fat     9169 b- defN 23-Jun-28 12:42 brainpy/_src/math/index_tricks.py
 -rw-rw-rw-  2.0 fat     2618 b- defN 23-Jul-21 14:18 brainpy/_src/math/interoperability.py
 -rw-rw-rw-  2.0 fat     1823 b- defN 23-Jun-28 12:42 brainpy/_src/math/linalg.py
 -rw-rw-rw-  2.0 fat     2409 b- defN 23-Jul-21 14:18 brainpy/_src/math/modes.py
--rw-rw-rw-  2.0 fat    48986 b- defN 23-Jul-21 14:18 brainpy/_src/math/ndarray.py
+-rw-rw-rw-  2.0 fat    48986 b- defN 23-Jul-23 10:10 brainpy/_src/math/ndarray.py
 -rw-rw-rw-  2.0 fat     2339 b- defN 23-Jun-28 12:42 brainpy/_src/math/others.py
 -rw-rw-rw-  2.0 fat    16468 b- defN 23-Jul-21 14:18 brainpy/_src/math/pre_syn_post.py
 -rw-rw-rw-  2.0 fat    80960 b- defN 23-Jul-21 14:18 brainpy/_src/math/random.py
 -rw-rw-rw-  2.0 fat     2169 b- defN 23-Jul-21 14:18 brainpy/_src/math/remove_vmap.py
--rw-rw-rw-  2.0 fat     4034 b- defN 23-Jul-21 14:18 brainpy/_src/math/sharding.py
+-rw-rw-rw-  2.0 fat     4034 b- defN 23-Jul-23 10:10 brainpy/_src/math/sharding.py
 -rw-rw-rw-  2.0 fat       65 b- defN 23-Jul-21 14:18 brainpy/_src/math/event/__init__.py
 -rw-rw-rw-  2.0 fat    18268 b- defN 23-Jul-21 14:18 brainpy/_src/math/event/_csr_matvec.py
 -rw-rw-rw-  2.0 fat     5233 b- defN 23-Jul-21 14:18 brainpy/_src/math/event/_info_collection.py
 -rw-rw-rw-  2.0 fat       56 b- defN 23-Jul-21 14:18 brainpy/_src/math/jitconn/__init__.py
--rw-rw-rw-  2.0 fat    25692 b- defN 23-Jul-21 14:18 brainpy/_src/math/jitconn/_event_matvec.py
+-rw-rw-rw-  2.0 fat    25692 b- defN 23-Jul-23 10:10 brainpy/_src/math/jitconn/_event_matvec.py
 -rw-rw-rw-  2.0 fat    29611 b- defN 23-Jul-21 14:18 brainpy/_src/math/jitconn/_matvec.py
 -rw-rw-rw-  2.0 fat      943 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/__init__.py
 -rw-rw-rw-  2.0 fat     3743 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/_tools.py
 -rw-rw-rw-  2.0 fat      787 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/_utils.py
--rw-rw-rw-  2.0 fat    41713 b- defN 23-Jul-23 02:03 brainpy/_src/math/object_transform/autograd.py
--rw-rw-rw-  2.0 fat    23465 b- defN 23-Jul-23 02:03 brainpy/_src/math/object_transform/base.py
+-rw-rw-rw-  2.0 fat    41713 b- defN 23-Jul-23 10:10 brainpy/_src/math/object_transform/autograd.py
+-rw-rw-rw-  2.0 fat    23768 b- defN 23-Jul-24 02:35 brainpy/_src/math/object_transform/base.py
 -rw-rw-rw-  2.0 fat     6140 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/collectors.py
--rw-rw-rw-  2.0 fat    33692 b- defN 23-Jul-23 02:03 brainpy/_src/math/object_transform/controls.py
+-rw-rw-rw-  2.0 fat    33692 b- defN 23-Jul-23 10:10 brainpy/_src/math/object_transform/controls.py
 -rw-rw-rw-  2.0 fat     3101 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/function.py
--rw-rw-rw-  2.0 fat    16259 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/jit.py
--rw-rw-rw-  2.0 fat     1711 b- defN 23-Jul-23 02:03 brainpy/_src/math/object_transform/naming.py
+-rw-rw-rw-  2.0 fat    16259 b- defN 23-Jul-23 10:10 brainpy/_src/math/object_transform/jit.py
+-rw-rw-rw-  2.0 fat     1711 b- defN 23-Jul-23 10:10 brainpy/_src/math/object_transform/naming.py
 -rw-rw-rw-  2.0 fat    18234 b- defN 23-Jul-21 14:18 brainpy/_src/math/object_transform/parallels.py
 -rw-rw-rw-  2.0 fat    15087 b- defN 23-Jul-23 02:03 brainpy/_src/math/object_transform/variables.py
 -rw-rw-rw-  2.0 fat      209 b- defN 23-Jul-21 14:18 brainpy/_src/math/op_registers/__init__.py
 -rw-rw-rw-  2.0 fat     1092 b- defN 23-Jul-21 14:18 brainpy/_src/math/op_registers/utils.py
 -rw-rw-rw-  2.0 fat     7322 b- defN 23-Jul-21 14:18 brainpy/_src/math/op_registers/numba_approach/__init__.py
 -rw-rw-rw-  2.0 fat     5274 b- defN 23-Jul-21 14:18 brainpy/_src/math/op_registers/numba_approach/cpu_translation.py
 -rw-rw-rw-  2.0 fat      151 b- defN 23-Jul-21 14:18 brainpy/_src/math/sparse/__init__.py
@@ -241,68 +241,68 @@
 -rw-rw-rw-  2.0 fat      105 b- defN 23-Jul-21 14:18 brainpy/_src/math/surrogate/__init__.py
 -rw-rw-rw-  2.0 fat     7463 b- defN 23-Jul-21 14:18 brainpy/_src/math/surrogate/_compt.py
 -rw-rw-rw-  2.0 fat    44266 b- defN 23-Jul-21 14:18 brainpy/_src/math/surrogate/_one_input.py
 -rw-rw-rw-  2.0 fat     1550 b- defN 23-Jul-21 14:18 brainpy/_src/math/surrogate/_two_inputs.py
 -rw-rw-rw-  2.0 fat     3800 b- defN 23-Jun-28 12:42 brainpy/_src/math/surrogate/_utils.py
 -rw-rw-rw-  2.0 fat      262 b- defN 23-Jul-21 14:18 brainpy/_src/math/surrogate/base.py
 -rw-rw-rw-  2.0 fat      301 b- defN 23-Jun-28 12:42 brainpy/_src/measure/__init__.py
--rw-rw-rw-  2.0 fat    10262 b- defN 23-Jul-21 14:18 brainpy/_src/measure/correlation.py
+-rw-rw-rw-  2.0 fat    10262 b- defN 23-Jul-23 10:10 brainpy/_src/measure/correlation.py
 -rw-rw-rw-  2.0 fat     1842 b- defN 23-Jun-28 12:42 brainpy/_src/measure/firings.py
 -rw-rw-rw-  2.0 fat     4010 b- defN 23-Jun-28 12:42 brainpy/_src/measure/lfp.py
 -rw-rw-rw-  2.0 fat       79 b- defN 23-Jun-28 12:42 brainpy/_src/optimizers/__init__.py
 -rw-rw-rw-  2.0 fat    42431 b- defN 23-Jul-21 14:18 brainpy/_src/optimizers/optimizer.py
 -rw-rw-rw-  2.0 fat    13640 b- defN 23-Jul-21 14:18 brainpy/_src/optimizers/scheduler.py
 -rw-rw-rw-  2.0 fat      549 b- defN 23-Jun-28 12:42 brainpy/_src/running/__init__.py
 -rw-rw-rw-  2.0 fat      290 b- defN 23-Jun-28 12:42 brainpy/_src/running/constants.py
--rw-rw-rw-  2.0 fat     5125 b- defN 23-Jul-21 14:18 brainpy/_src/running/jax_multiprocessing.py
+-rw-rw-rw-  2.0 fat     5125 b- defN 23-Jul-23 10:10 brainpy/_src/running/jax_multiprocessing.py
 -rw-rw-rw-  2.0 fat     3079 b- defN 23-Jun-28 12:42 brainpy/_src/running/native_multiprocessing.py
 -rw-rw-rw-  2.0 fat     7223 b- defN 23-Jun-28 12:42 brainpy/_src/running/pathos_multiprocessing.py
--rw-rw-rw-  2.0 fat     9939 b- defN 23-Jul-23 02:03 brainpy/_src/running/runner.py
+-rw-rw-rw-  2.0 fat     9939 b- defN 23-Jul-23 10:10 brainpy/_src/running/runner.py
 -rw-rw-rw-  2.0 fat      191 b- defN 23-Jul-21 14:18 brainpy/_src/tools/__init__.py
 -rw-rw-rw-  2.0 fat     7721 b- defN 23-Jul-21 14:18 brainpy/_src/tools/codes.py
--rw-rw-rw-  2.0 fat     4749 b- defN 23-Jul-23 02:03 brainpy/_src/tools/dicts.py
+-rw-rw-rw-  2.0 fat     4749 b- defN 23-Jul-23 10:10 brainpy/_src/tools/dicts.py
 -rw-rw-rw-  2.0 fat     1053 b- defN 23-Jul-21 14:18 brainpy/_src/tools/install.py
 -rw-rw-rw-  2.0 fat      241 b- defN 23-Jun-28 12:42 brainpy/_src/tools/math_util.py
 -rw-rw-rw-  2.0 fat     4611 b- defN 23-Jul-21 14:18 brainpy/_src/tools/others.py
 -rw-rw-rw-  2.0 fat     1476 b- defN 23-Jul-21 14:18 brainpy/_src/tools/package.py
--rw-rw-rw-  2.0 fat      638 b- defN 23-Jul-21 14:18 brainpy/_src/train/__init__.py
+-rw-rw-rw-  2.0 fat      638 b- defN 23-Jul-23 10:10 brainpy/_src/train/__init__.py
 -rw-rw-rw-  2.0 fat     2034 b- defN 23-Jul-21 14:18 brainpy/_src/train/_utils.py
--rw-rw-rw-  2.0 fat    22979 b- defN 23-Jul-23 02:03 brainpy/_src/train/back_propagation.py
--rw-rw-rw-  2.0 fat     2944 b- defN 23-Jul-21 14:18 brainpy/_src/train/base.py
--rw-rw-rw-  2.0 fat     9616 b- defN 23-Jul-21 14:18 brainpy/_src/train/offline.py
--rw-rw-rw-  2.0 fat    10002 b- defN 23-Jul-23 02:03 brainpy/_src/train/online.py
+-rw-rw-rw-  2.0 fat    22979 b- defN 23-Jul-23 10:10 brainpy/_src/train/back_propagation.py
+-rw-rw-rw-  2.0 fat     2944 b- defN 23-Jul-23 10:10 brainpy/_src/train/base.py
+-rw-rw-rw-  2.0 fat     9616 b- defN 23-Jul-23 10:10 brainpy/_src/train/offline.py
+-rw-rw-rw-  2.0 fat    10002 b- defN 23-Jul-23 10:10 brainpy/_src/train/online.py
 -rw-rw-rw-  2.0 fat       84 b- defN 23-Jun-28 12:42 brainpy/_src/visualization/__init__.py
 -rw-rw-rw-  2.0 fat     3651 b- defN 23-Jun-28 12:42 brainpy/_src/visualization/base.py
 -rw-rw-rw-  2.0 fat      877 b- defN 23-Jun-28 12:42 brainpy/_src/visualization/figures.py
 -rw-rw-rw-  2.0 fat    15119 b- defN 23-Jun-28 12:42 brainpy/_src/visualization/plots.py
 -rw-rw-rw-  2.0 fat     1071 b- defN 23-Jun-28 12:42 brainpy/_src/visualization/styles.py
 -rw-rw-rw-  2.0 fat       95 b- defN 23-Apr-05 12:57 brainpy/algorithms/__init__.py
 -rw-rw-rw-  2.0 fat    17904 b- defN 23-Jun-22 06:44 brainpy/algorithms/offline.py
 -rw-rw-rw-  2.0 fat     6494 b- defN 23-Jun-22 06:44 brainpy/algorithms/online.py
 -rw-rw-rw-  2.0 fat     2767 b- defN 23-Apr-05 12:57 brainpy/algorithms/utils.py
--rw-rw-rw-  2.0 fat      208 b- defN 23-Jul-21 14:18 brainpy/dnn/__init__.py
--rw-rw-rw-  2.0 fat      509 b- defN 23-Jul-21 14:18 brainpy/dnn/activations.py
--rw-rw-rw-  2.0 fat      285 b- defN 23-Jul-21 14:18 brainpy/dnn/conv.py
--rw-rw-rw-  2.0 fat       96 b- defN 23-Jul-21 14:18 brainpy/dnn/interoperation.py
--rw-rw-rw-  2.0 fat      540 b- defN 23-Jul-21 14:18 brainpy/dnn/linear.py
--rw-rw-rw-  2.0 fat      326 b- defN 23-Jul-21 14:18 brainpy/dnn/normalization.py
--rw-rw-rw-  2.0 fat      215 b- defN 23-Jul-21 14:18 brainpy/dnn/others.py
--rw-rw-rw-  2.0 fat      540 b- defN 23-Jul-21 14:18 brainpy/dnn/pooling.py
--rw-rw-rw-  2.0 fat      361 b- defN 23-Jul-21 14:18 brainpy/dnn/recurrent.py
--rw-rw-rw-  2.0 fat      242 b- defN 23-Jul-21 14:18 brainpy/dyn/__init__.py
--rw-rw-rw-  2.0 fat       78 b- defN 23-Jul-21 14:18 brainpy/dyn/base.py
--rw-rw-rw-  2.0 fat     1593 b- defN 23-Jul-21 14:18 brainpy/dyn/channels.py
--rw-rw-rw-  2.0 fat      102 b- defN 23-Jul-21 14:18 brainpy/dyn/compat.py
--rw-rw-rw-  2.0 fat      592 b- defN 23-Jul-21 14:18 brainpy/dyn/ions.py
--rw-rw-rw-  2.0 fat      632 b- defN 23-Jul-21 14:18 brainpy/dyn/neurons.py
--rw-rw-rw-  2.0 fat      358 b- defN 23-Jul-21 14:18 brainpy/dyn/others.py
--rw-rw-rw-  2.0 fat      134 b- defN 23-Jul-21 14:18 brainpy/dyn/outs.py
--rw-rw-rw-  2.0 fat      362 b- defN 23-Jul-21 14:18 brainpy/dyn/projections.py
--rw-rw-rw-  2.0 fat      146 b- defN 23-Jul-21 14:18 brainpy/dyn/rates.py
--rw-rw-rw-  2.0 fat      332 b- defN 23-Jul-21 14:18 brainpy/dyn/synapses.py
+-rw-rw-rw-  2.0 fat      208 b- defN 23-Jul-23 10:10 brainpy/dnn/__init__.py
+-rw-rw-rw-  2.0 fat      509 b- defN 23-Jul-23 10:10 brainpy/dnn/activations.py
+-rw-rw-rw-  2.0 fat      285 b- defN 23-Jul-23 10:10 brainpy/dnn/conv.py
+-rw-rw-rw-  2.0 fat       96 b- defN 23-Jul-23 10:10 brainpy/dnn/interoperation.py
+-rw-rw-rw-  2.0 fat      540 b- defN 23-Jul-23 10:10 brainpy/dnn/linear.py
+-rw-rw-rw-  2.0 fat      326 b- defN 23-Jul-23 10:10 brainpy/dnn/normalization.py
+-rw-rw-rw-  2.0 fat      215 b- defN 23-Jul-23 10:10 brainpy/dnn/others.py
+-rw-rw-rw-  2.0 fat      540 b- defN 23-Jul-23 10:10 brainpy/dnn/pooling.py
+-rw-rw-rw-  2.0 fat      361 b- defN 23-Jul-23 10:10 brainpy/dnn/recurrent.py
+-rw-rw-rw-  2.0 fat      242 b- defN 23-Jul-23 10:10 brainpy/dyn/__init__.py
+-rw-rw-rw-  2.0 fat       78 b- defN 23-Jul-23 10:10 brainpy/dyn/base.py
+-rw-rw-rw-  2.0 fat     1593 b- defN 23-Jul-23 10:10 brainpy/dyn/channels.py
+-rw-rw-rw-  2.0 fat      102 b- defN 23-Jul-23 10:10 brainpy/dyn/compat.py
+-rw-rw-rw-  2.0 fat      592 b- defN 23-Jul-23 10:10 brainpy/dyn/ions.py
+-rw-rw-rw-  2.0 fat      632 b- defN 23-Jul-23 10:10 brainpy/dyn/neurons.py
+-rw-rw-rw-  2.0 fat      358 b- defN 23-Jul-23 10:10 brainpy/dyn/others.py
+-rw-rw-rw-  2.0 fat      134 b- defN 23-Jul-23 10:10 brainpy/dyn/outs.py
+-rw-rw-rw-  2.0 fat      362 b- defN 23-Jul-23 10:10 brainpy/dyn/projections.py
+-rw-rw-rw-  2.0 fat      146 b- defN 23-Jul-23 10:10 brainpy/dyn/rates.py
+-rw-rw-rw-  2.0 fat      332 b- defN 23-Jul-23 10:10 brainpy/dyn/synapses.py
 -rw-rw-rw-  2.0 fat      134 b- defN 23-Jun-22 06:44 brainpy/integrators/__init__.py
 -rw-rw-rw-  2.0 fat      597 b- defN 23-Jun-22 06:44 brainpy/integrators/fde.py
 -rw-rw-rw-  2.0 fat     1103 b- defN 23-Jun-22 06:44 brainpy/integrators/ode.py
 -rw-rw-rw-  2.0 fat      706 b- defN 23-Jun-22 06:44 brainpy/integrators/sde.py
 -rw-rw-rw-  2.0 fat     4883 b- defN 23-Jul-21 14:18 brainpy/math/__init__.py
 -rw-rw-rw-  2.0 fat      819 b- defN 23-Jul-21 14:18 brainpy/math/activations.py
 -rw-rw-rw-  2.0 fat     8431 b- defN 23-Jun-22 06:44 brainpy/math/compat_numpy.py
@@ -323,13 +323,13 @@
 -rw-rw-rw-  2.0 fat      137 b- defN 23-Jul-21 14:18 brainpy/math/op_register.py
 -rw-rw-rw-  2.0 fat      268 b- defN 23-Jul-21 14:18 brainpy/math/others.py
 -rw-rw-rw-  2.0 fat      352 b- defN 23-Jul-21 14:18 brainpy/math/pre_syn_post.py
 -rw-rw-rw-  2.0 fat     1843 b- defN 23-Jun-22 06:44 brainpy/math/random.py
 -rw-rw-rw-  2.0 fat      228 b- defN 23-Jul-21 14:18 brainpy/math/sharding.py
 -rw-rw-rw-  2.0 fat      175 b- defN 23-Jul-21 14:18 brainpy/math/sparse.py
 -rw-rw-rw-  2.0 fat     1320 b- defN 23-Jul-21 14:18 brainpy/math/surrogate.py
--rw-rw-rw-  2.0 fat    35773 b- defN 23-Jul-23 07:42 brainpy-2.4.3.1.dist-info/LICENSE
--rw-rw-rw-  2.0 fat     4351 b- defN 23-Jul-23 07:42 brainpy-2.4.3.1.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Jul-23 07:42 brainpy-2.4.3.1.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 23-Jul-23 07:42 brainpy-2.4.3.1.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat    29719 b- defN 23-Jul-23 07:42 brainpy-2.4.3.1.dist-info/RECORD
-333 files, 2742203 bytes uncompressed, 610719 bytes compressed:  77.7%
+-rw-rw-rw-  2.0 fat    35773 b- defN 23-Jul-24 02:47 brainpy-2.4.3.2.dist-info/LICENSE
+-rw-rw-rw-  2.0 fat     4351 b- defN 23-Jul-24 02:47 brainpy-2.4.3.2.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-Jul-24 02:47 brainpy-2.4.3.2.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 23-Jul-24 02:47 brainpy-2.4.3.2.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat    29719 b- defN 23-Jul-24 02:47 brainpy-2.4.3.2.dist-info/RECORD
+333 files, 2741265 bytes uncompressed, 611099 bytes compressed:  77.7%
```

## zipnote {}

```diff
@@ -978,23 +978,23 @@
 
 Filename: brainpy/math/sparse.py
 Comment: 
 
 Filename: brainpy/math/surrogate.py
 Comment: 
 
-Filename: brainpy-2.4.3.1.dist-info/LICENSE
+Filename: brainpy-2.4.3.2.dist-info/LICENSE
 Comment: 
 
-Filename: brainpy-2.4.3.1.dist-info/METADATA
+Filename: brainpy-2.4.3.2.dist-info/METADATA
 Comment: 
 
-Filename: brainpy-2.4.3.1.dist-info/WHEEL
+Filename: brainpy-2.4.3.2.dist-info/WHEEL
 Comment: 
 
-Filename: brainpy-2.4.3.1.dist-info/top_level.txt
+Filename: brainpy-2.4.3.2.dist-info/top_level.txt
 Comment: 
 
-Filename: brainpy-2.4.3.1.dist-info/RECORD
+Filename: brainpy-2.4.3.2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## brainpy/__init__.py

```diff
@@ -1,10 +1,10 @@
 # -*- coding: utf-8 -*-
 
-__version__ = "2.4.3.1"
+__version__ = "2.4.3.2"
 
 # fundamental supporting modules
 from brainpy import errors, check, tools
 
 try:
   import jaxlib
   del jaxlib
```

## brainpy/mixin.py

```diff
@@ -1,12 +1,13 @@
 
 from brainpy._src.mixin import (
   MixIn as MixIn,
+  ReceiveInputProj as ReceiveInputProj,
   AlignPost as AlignPost,
   AutoDelaySupp as AutoDelaySupp,
   ParamDesc as ParamDesc,
   ParamDescInit as ParamDescInit,
-  NoSH as NoSH,
+  BindCondData as BindCondData,
   Container as Container,
   TreeNode as TreeNode,
   JointType as JointType,
 )
```

## brainpy/_src/delay.py

```diff
@@ -678,15 +678,18 @@
       batch_axis = self.target.batch_axis + 1
 
     f = jax.jit(jnp.zeros,
                 static_argnums=0,
                 static_argnames='dtype',
                 out_shardings=bm.sharding.get_sharding(self.axis_names))
     data = f((length,) + self.target.shape, dtype=self.target.dtype)
-    self.data = bm.Variable(data, batch_axis=batch_axis)
+    if self.data is None:
+      self.data = bm.Variable(data, batch_axis=batch_axis)
+    else:
+      self.data._value = data
     # update delay data
     if isinstance(self._init, (bm.Array, jax.Array, numbers.Number)):
       self.data[:] = self._init
     elif callable(self._init):
       self.data[:] = self._init((length,) + self.target.shape, dtype=self.target.dtype)
```

## brainpy/_src/dynsys.py

```diff
@@ -6,15 +6,15 @@
 import warnings
 from typing import Union, Dict, Callable, Sequence, Optional, Any
 
 import numpy as np
 
 from brainpy import tools, math as bm
 from brainpy._src.initialize import parameter, variable_
-from brainpy._src.mixin import AutoDelaySupp, Container, DelayRegister, global_delay_data
+from brainpy._src.mixin import AutoDelaySupp, Container, ReceiveInputProj, DelayRegister, global_delay_data
 from brainpy.errors import NoImplementationError, UnsupportedError
 from brainpy.types import ArrayType, Shape
 from brainpy._src.deprecations import _update_deprecate_msg
 
 share = None
 
 __all__ = [
@@ -361,14 +361,15 @@
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
       child_type: type = DynamicalSystem,
       **children_as_dict
   ):
     super().__init__(name=name, mode=mode)
 
+    # Attribute of "Container"
     self.children = bm.node_dict(self.format_elements(child_type, *children_as_tuple, **children_as_dict))
 
   def update(self, *args, **kwargs):
     """Step function of a network.
 
     In this update function, the update functions in children systems are
     iteratively called.
@@ -451,22 +452,22 @@
   >>> import brainpy as bp
   >>> import brainpy.math as bm
   >>>
   >>> # composing ANN models
   >>> l = bp.Sequential(bp.layers.Dense(100, 10),
   >>>                   bm.relu,
   >>>                   bp.layers.Dense(10, 2))
-  >>> l({}, bm.random.random((256, 100)))
+  >>> l(bm.random.random((256, 100)))
   >>>
   >>> # Using Sequential with Dict. This is functionally the
   >>> # same as the above code
   >>> l = bp.Sequential(l1=bp.layers.Dense(100, 10),
   >>>                   l2=bm.relu,
   >>>                   l3=bp.layers.Dense(10, 2))
-  >>> l({}, bm.random.random((256, 100)))
+  >>> l(bm.random.random((256, 100)))
 
 
   Args:
     modules_as_tuple: The children modules.
     modules_as_dict: The children modules.
     name: The object name.
     mode: The object computing context/mode. Default is ``None``.
@@ -476,14 +477,16 @@
       self,
       *modules_as_tuple,
       name: str = None,
       mode: bm.Mode = None,
       **modules_as_dict
   ):
     super().__init__(name=name, mode=mode)
+
+    # Attribute of "Container"
     self.children = bm.node_dict(self.format_elements(object, *modules_as_tuple, **modules_as_dict))
 
   def update(self, x):
     """Update function of a sequential model.
     """
     for m in self.children.values():
       x = m(x)
@@ -492,27 +495,14 @@
   def return_info(self):
     last = self[-1]
     if not isinstance(last, AutoDelaySupp):
       raise UnsupportedError(f'Does not support "return_info()" because the last node is '
                              f'not instance of {AutoDelaySupp.__name__}')
     return last.return_info()
 
-  def __format_key(self, i):
-    return f'l-{i}'
-
-  def __all_nodes(self):
-    nodes = []
-    for i in range(self._num):
-      key = self.__format_key(i)
-      if key not in self._dyn_modules:
-        nodes.append(self._static_modules[key])
-      else:
-        nodes.append(self._dyn_modules[key])
-    return nodes
-
   def __getitem__(self, key: Union[int, slice, str]):
     if isinstance(key, str):
       if key in self.children:
         return self.children[key]
       else:
         raise KeyError(f'Does not find a component named {key} in\n {str(self)}')
     elif isinstance(key, slice):
@@ -522,25 +512,25 @@
     elif isinstance(key, (tuple, list)):
       _all_nodes = tuple(self.children.items())
       return Sequential(**dict(_all_nodes[k] for k in key))
     else:
       raise KeyError(f'Unknown type of key: {type(key)}')
 
   def __repr__(self):
-    nodes = self.__all_nodes()
+    nodes = self.children.values()
     entries = '\n'.join(f'  [{i}] {tools.repr_object(x)}' for i, x in enumerate(nodes))
     return f'{self.__class__.__name__}(\n{entries}\n)'
 
 
 class Projection(DynamicalSystem):
   def reset_state(self, *args, **kwargs):
     pass
 
 
-class Dynamic(DynamicalSystem):
+class Dynamic(DynamicalSystem, ReceiveInputProj):
   """Base class to model dynamics.
 
   There are several essential attributes:
 
   - ``size``: the geometry of the neuron group. For example, `(10, )` denotes a line of
     neurons, `(10, 10)` denotes a neuron group aligned in a 2D space, `(10, 15, 4)` denotes
     a 3-dimensional neuron group.
@@ -585,20 +575,20 @@
 
     # axis names for parallelization
     self.sharding = sharding
 
     # integration method
     self.method = method
 
-    # inputs
-    self.cur_inputs: Dict = bm.node_dict()
-
     # initialize
     super().__init__(name=name, mode=mode)
 
+    # Attribute for "ReceiveInputProj"
+    self.cur_inputs = bm.node_dict()
+
   @property
   def varshape(self):
     """The shape of variables in the neuron group."""
     return self.size if self.keep_size else (self.num,)
 
   def get_batch_shape(self, batch_size=None):
     if batch_size is None:
```

## brainpy/_src/mixin.py

```diff
@@ -1,11 +1,11 @@
 import numbers
 import sys
 from dataclasses import dataclass
-from typing import Union, Dict, Callable, Sequence, Optional, TypeVar
+from typing import Union, Dict, Callable, Sequence, Optional, TypeVar, Any
 from typing import (_SpecialForm, _type_check, _remove_dups_flatten)
 
 import jax
 import jax.numpy as jnp
 import numpy as np
 
 from brainpy import math as bm, tools
@@ -22,29 +22,79 @@
 
 __all__ = [
   'MixIn',
   'ParamDesc',
   'ParamDescInit',
   'AlignPost',
   'AutoDelaySupp',
-  'NoSH',
   'Container',
   'TreeNode',
   'BindCondData',
   'JointType',
 ]
 
 global_delay_data = dict()
 
 
 class MixIn(object):
-  """Base MixIn object."""
+  """Base MixIn object.
+
+  The key for a :py:class:`~.MixIn` is that: no initialization function, only behavioral functions.
+  """
   pass
 
 
+class ReceiveInputProj(MixIn):
+  """The :py:class:`~.MixIn` that receives the input projections.
+
+  Note that the subclass should define a ``cur_inputs`` attribute.
+
+  """
+  cur_inputs: bm.node_dict
+
+  def add_inp_fun(self, key: Any, fun: Callable):
+    """Add an input function.
+
+    Args:
+      key: The dict key.
+      fun: The function to generate inputs.
+    """
+    if not callable(fun):
+      raise TypeError('Must be a function.')
+    if key in self.cur_inputs:
+      raise ValueError(f'Key "{key}" has been defined and used.')
+    self.cur_inputs[key] = fun
+
+  def get_inp_fun(self, key):
+    """Get the input function.
+
+    Args:
+      key: The key.
+
+    Returns:
+      The input function which generates currents.
+    """
+    return self.cur_inputs.get(key)
+
+  def sum_inputs(self, *args, init=0., **kwargs):
+    """Summarize all inputs by the defined input functions ``.cur_inputs``.
+
+    Args:
+      *args: The arguments for input functions.
+      init: The initial input data.
+      **kwargs: The arguments for input functions.
+
+    Returns:
+
+    """
+    for out in self.cur_inputs.values():
+      init = init + out(*args, **kwargs)
+    return init
+
+
 class ParamDesc(MixIn):
   """:py:class:`~.MixIn` indicates the function for describing initialization parameters.
 
   This mixin enables the subclass has a classmethod ``desc``, which
   produces an instance of :py:class:`~.ParamDescInit`.
 
   Note this MixIn can be applied in any Python object.
@@ -152,21 +202,14 @@
 class AutoDelaySupp(MixIn):
   """``MixIn`` to support the automatic delay in synaptic projection :py:class:`~.SynProj`."""
 
   def return_info(self) -> Union[bm.Variable, ReturnInfo]:
     raise NotImplementedError('Must implement the "return_info()" function.')
 
 
-class NoSH(MixIn):
-  """``MixIn`` to indicate that no shared parameters should be passed into the ``update()`` function."""
-
-  def __init__(self, *args, **kwargs):
-    self._pass_shared_args = False
-
-
 class Container(MixIn):
   """Container :py:class:`~.MixIn` which wrap a group of objects.
   """
   children: bm.node_dict
 
   def __getitem__(self, item):
     """Overwrite the slice access (`self['']`). """
```

## brainpy/_src/dyn/ions/base.py

```diff
@@ -27,17 +27,19 @@
   def __init__(self, *ions, **channels):
     # TODO: check "ions" should be independent from each other
     assert isinstance(ions, (tuple, list)), f'{self.__class__.__name__} requires at least two ions. '
     assert len(ions) >= 2, f'{self.__class__.__name__} requires at least two ions. '
     assert all([isinstance(cls, Ion) for cls in ions]), f'Must be a sequence of Ion. But got {ions}.'
     super().__init__(size=ions[0].size, keep_size=ions[0].keep_size, sharding=ions[0].sharding)
 
+    # Attribute of "Container"
+    self.children = bm.node_dict()
+
     self.ions: Sequence['Ion'] = tuple(ions)
     self._ion_classes = tuple([type(ion) for ion in self.ions])
-    self.children = bm.node_dict()
     for k, v in channels.items():
       self.add_elem(k=v)
 
   def update(self, V):
     nodes = tuple(self.nodes(level=1, include_self=False).unique().subset(IonChaDyn).values())
     self.check_hierarchies(self._ion_classes, *nodes)
     for node in nodes:
@@ -155,14 +157,16 @@
       keep_size: bool = False,
       method: str = 'exp_auto',
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
       **channels
   ):
     super().__init__(size, keep_size=keep_size, mode=mode, method=method, name=name)
+
+    # Attribute of "Container"
     self.children = bm.node_dict(self.format_elements(IonChaDyn, **channels))
     self.external: Dict[str, Callable] = dict()  # not found by `.nodes()` or `.vars()`
 
   def update(self, V):
     for node in self.nodes(level=1, include_self=False).unique().subset(IonChaDyn).values():
       node.update(V, self.C, self.E)
```

## brainpy/_src/dyn/neurons/hh.py

```diff
@@ -113,16 +113,15 @@
       self.integral = sdeint(f=self.derivative, g=self.noise, method=method)
 
     if init_var:
       self.reset_state(self.mode)
 
   def derivative(self, V, t, I):
     # synapses
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     # channels
     for ch in self.nodes(level=1, include_self=False).subset(IonChaDyn).unique().values():
       I = I + ch.current(V)
     return I / self.C
 
   def reset_state(self, batch_size=None):
     self.V = variable_(self._V_initializer, self.varshape, batch_size)
@@ -173,16 +172,15 @@
     for ch in self.nodes(level=1, include_self=False).subset(IonChaDyn).unique().values():
       I = I + ch.current(V)
     return I / self.C
 
   def update(self, x=None):
     # inputs
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class HHLTC(NeuDyn):
   r"""Hodgkin–Huxley neuron model with liquid time constant.
 
   **Model Descriptions**
@@ -440,16 +438,15 @@
     if self._n_initializer is None:
       self.n = bm.Variable(self.n_inf(self.V.value), batch_axis=self.V.batch_axis)
     else:
       self.n = self.init_variable(self._n_initializer, batch_size)
     self.spike = self.init_variable(partial(bm.zeros, dtype=bool), batch_size)
 
   def dV(self, V, t, m, h, n, I):
-    for out in self.cur_inputs.values():
-      I += out(V)
+    I = self.sum_inputs(V, init=I)
     I_Na = (self.gNa * m ** 3.0 * h) * (V - self.ENa)
     I_K = (self.gK * n ** 4.0) * (V - self.EK)
     I_leak = self.gL * (V - self.EL)
     dVdt = (- I_Na - I_K - I_leak + I) / self.C
     return dVdt
 
   @property
@@ -654,16 +651,15 @@
 
   @property
   def derivative(self):
     return JointEq(self.dV, self.dm, self.dh, self.dn)
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x += out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class MorrisLecarLTC(NeuDyn):
   r"""The Morris-Lecar neuron model with liquid time constant.
 
     **Model Descriptions**
@@ -802,16 +798,15 @@
 
   def reset_state(self, batch_size=None):
     self.V = self.init_variable(self._V_initializer, batch_size)
     self.W = self.init_variable(self._W_initializer, batch_size)
     self.spike = self.init_variable(partial(bm.zeros, dtype=bool), batch_size)
 
   def dV(self, V, t, W, I):
-    for out in self.cur_inputs.values():
-      I += out(V)
+    I = self.sum_inputs(V, init=I)
     M_inf = (1 / 2) * (1 + bm.tanh((V - self.V1) / self.V2))
     I_Ca = self.g_Ca * M_inf * (V - self.V_Ca)
     I_K = self.g_K * W * (V - self.V_K)
     I_Leak = self.g_leak * (V - self.V_leak)
     dVdt = (- I_Ca - I_K - I_Leak + I) / self.C
     return dVdt
 
@@ -920,28 +915,17 @@
     M_inf = (1 / 2) * (1 + bm.tanh((V - self.V1) / self.V2))
     I_Ca = self.g_Ca * M_inf * (V - self.V_Ca)
     I_K = self.g_K * W * (V - self.V_K)
     I_Leak = self.g_leak * (V - self.V_leak)
     dVdt = (- I_Ca - I_K - I_Leak + I) / self.C
     return dVdt
 
-  def dW(self, W, t, V):
-    tau_W = 1 / (self.phi * bm.cosh((V - self.V3) / (2 * self.V4)))
-    W_inf = (1 / 2) * (1 + bm.tanh((V - self.V3) / self.V4))
-    dWdt = (W_inf - W) / tau_W
-    return dWdt
-
-  @property
-  def derivative(self):
-    return JointEq(self.dV, self.dW)
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x += out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class WangBuzsakiHHLTC(NeuDyn):
   r"""Wang-Buzsaki model [9]_, an implementation of a modified Hodgkin-Huxley model with liquid time constant.
 
     Each model is described by a single compartment and obeys the current balance equation:
@@ -1101,16 +1085,15 @@
   def dn(self, n, t, V):
     alpha = -0.01 * (V + 34) / (bm.exp(-0.1 * (V + 34)) - 1)
     beta = 0.125 * bm.exp(-(V + 44) / 80)
     dndt = alpha * (1 - n) - beta * n
     return self.phi * dndt
 
   def dV(self, V, t, h, n, I):
-    for out in self.cur_inputs.values():
-      I += out(V)
+    I = self.sum_inputs(V, init=I)
     INa = self.gNa * self.m_inf(V) ** 3 * h * (V - self.ENa)
     IK = self.gK * n ** 4 * (V - self.EK)
     IL = self.gL * (V - self.EL)
     dVdt = (- INa - IK - IL + I) / self.C
     return dVdt
 
   @property
@@ -1214,40 +1197,18 @@
     ----------
     .. [9] Wang, X.J. and Buzsaki, G., (1996) Gamma oscillation by synaptic
            inhibition in a hippocampal interneuronal network model. Journal of
            neuroscience, 16(20), pp.6402-6413.
 
   """
 
-  def m_inf(self, V):
-    alpha = -0.1 * (V + 35) / (bm.exp(-0.1 * (V + 35)) - 1)
-    beta = 4. * bm.exp(-(V + 60.) / 18.)
-    return alpha / (alpha + beta)
-
-  def dh(self, h, t, V):
-    alpha = 0.07 * bm.exp(-(V + 58) / 20)
-    beta = 1 / (bm.exp(-0.1 * (V + 28)) + 1)
-    dhdt = alpha * (1 - h) - beta * h
-    return self.phi * dhdt
-
-  def dn(self, n, t, V):
-    alpha = -0.01 * (V + 34) / (bm.exp(-0.1 * (V + 34)) - 1)
-    beta = 0.125 * bm.exp(-(V + 44) / 80)
-    dndt = alpha * (1 - n) - beta * n
-    return self.phi * dndt
-
   def dV(self, V, t, h, n, I):
     INa = self.gNa * self.m_inf(V) ** 3 * h * (V - self.ENa)
     IK = self.gK * n ** 4 * (V - self.EK)
     IL = self.gL * (V - self.EL)
     dVdt = (- INa - IK - IL + I) / self.C
     return dVdt
 
-  @property
-  def derivative(self):
-    return JointEq(self.dV, self.dh, self.dn)
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x += out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
```

## brainpy/_src/dyn/neurons/lif.py

```diff
@@ -112,16 +112,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def derivative(self, V, t, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     return (-V + self.V_rest + self.R * I) / self.tau
 
   def reset_state(self, batch_size=None):
     self.V = self.init_variable(self._V_initializer, batch_size)
     self.spike = self.init_variable(partial(bm.zeros, dtype=self.spk_type), batch_size)
 
   def update(self, x=None):
@@ -140,16 +139,15 @@
 
 class IF(IFLTC):
   def derivative(self, V, t, I):
     return (-V + self.V_rest + self.R * I) / self.tau
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 IF.__doc__ = IFLTC.__doc__ % ('', if_doc, pneu_doc, dpneu_doc)
 IFLTC.__doc__ = IFLTC.__doc__ % (ltc_doc, if_doc, pneu_doc, dpneu_doc)
 
 
@@ -226,16 +224,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def derivative(self, V, t, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     return (-V + self.V_rest + self.R * I) / self.tau
 
   def reset_state(self, batch_size=None):
     self.V = self.init_variable(self._V_initializer, batch_size)
     self.spike = self.init_variable(partial(bm.zeros, dtype=self.spk_type), batch_size)
 
   def update(self, x=None):
@@ -271,16 +268,15 @@
 
 class Lif(LifLTC):
   def derivative(self, V, t, I):
     return (-V + self.V_rest + self.R * I) / self.tau
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 Lif.__doc__ = LifLTC.__doc__ % ('', lif_doc, pneu_doc, dpneu_doc)
 LifLTC.__doc__ = LifLTC.__doc__ % (ltc_doc, lif_doc, pneu_doc, dpneu_doc)
 
 
@@ -420,16 +416,15 @@
 
 class LifRef(LifRefLTC):
   def derivative(self, V, t, I):
     return (-V + self.V_rest + self.R * I) / self.tau
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 LifRef.__doc__ = LifRefLTC.__doc__ % ('', lif_doc, pneu_doc, dpneu_doc, ref_doc)
 LifRefLTC.__doc__ = LifRefLTC.__doc__ % (ltc_doc, lif_doc, pneu_doc, dpneu_doc, ref_doc)
 
 
@@ -583,16 +578,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def derivative(self, V, t, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     exp_v = self.delta_T * bm.exp((V - self.V_T) / self.delta_T)
     dvdt = (- (V - self.V_rest) + exp_v + self.R * I) / self.tau
     return dvdt
 
   def reset_state(self, batch_size=None):
     self.V = self.init_variable(self._V_initializer, batch_size)
     self.spike = self.init_variable(partial(bm.zeros, dtype=self.spk_type), batch_size)
@@ -632,16 +626,15 @@
   def derivative(self, V, t, I):
     exp_v = self.delta_T * bm.exp((V - self.V_T) / self.delta_T)
     dvdt = (- (V - self.V_rest) + exp_v + self.R * I) / self.tau
     return dvdt
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class ExpIFRefLTC(ExpIFLTC):
   def __init__(
       self,
       size: Shape,
@@ -762,16 +755,15 @@
   def derivative(self, V, t, I):
     exp_v = self.delta_T * bm.exp((V - self.V_T) / self.delta_T)
     dvdt = (- (V - self.V_rest) + exp_v + self.R * I) / self.tau
     return dvdt
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 ExpIF.__doc__ = ExpIFLTC.__doc__ % ('')
 ExpIFRefLTC.__doc__ = ExpIFLTC.__doc__ % (ltc_doc)
 ExpIFRef.__doc__ = ExpIFLTC.__doc__ % ('')
 ExpIFLTC.__doc__ = ExpIFLTC.__doc__ % (ltc_doc)
@@ -911,16 +903,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def dV(self, V, t, w, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     exp = self.delta_T * bm.exp((V - self.V_T) / self.delta_T)
     dVdt = (- V + self.V_rest + exp - self.R * w + self.R * I) / self.tau
     return dVdt
 
   def dw(self, w, t, V):
     dwdt = (self.a * (V - self.V_rest) - w) / self.tau_w
     return dwdt
@@ -970,26 +961,17 @@
 
 class AdExIF(AdExIFLTC):
   def dV(self, V, t, w, I):
     exp = self.delta_T * bm.exp((V - self.V_T) / self.delta_T)
     dVdt = (- V + self.V_rest + exp - self.R * w + self.R * I) / self.tau
     return dVdt
 
-  def dw(self, w, t, V):
-    dwdt = (self.a * (V - self.V_rest) - w) / self.tau_w
-    return dwdt
-
-  @property
-  def derivative(self):
-    return JointEq([self.dV, self.dw])
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class AdExIFRefLTC(AdExIFLTC):
   def __init__(
       self,
       size: Shape,
@@ -1120,26 +1102,17 @@
 
 class AdExIFRef(AdExIFRefLTC):
   def dV(self, V, t, w, I):
     exp = self.delta_T * bm.exp((V - self.V_T) / self.delta_T)
     dVdt = (- V + self.V_rest + exp - self.R * w + self.R * I) / self.tau
     return dVdt
 
-  def dw(self, w, t, V):
-    dwdt = (self.a * (V - self.V_rest) - w) / self.tau_w
-    return dwdt
-
-  @property
-  def derivative(self):
-    return JointEq([self.dV, self.dw])
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 AdExIF.__doc__ = AdExIFLTC.__doc__ % ('')
 AdExIFRefLTC.__doc__ = AdExIFLTC.__doc__ % (ltc_doc)
 AdExIFRef.__doc__ = AdExIFLTC.__doc__ % ('')
 AdExIFLTC.__doc__ = AdExIFLTC.__doc__ % (ltc_doc)
@@ -1263,16 +1236,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def derivative(self, V, t, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     dVdt = (self.c * (V - self.V_rest) * (V - self.V_c) + self.R * I) / self.tau
     return dVdt
 
   def reset_state(self, batch_size=None):
     self.V = self.init_variable(self._V_initializer, batch_size)
     self.spike = self.init_variable(partial(bm.zeros, dtype=self.spk_type), batch_size)
 
@@ -1310,16 +1282,15 @@
 class QuaIF(QuaIFLTC):
   def derivative(self, V, t, I):
     dVdt = (self.c * (V - self.V_rest) * (V - self.V_c) + self.R * I) / self.tau
     return dVdt
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class QuaIFRefLTC(QuaIFLTC):
   def __init__(
       self,
       size: Shape,
@@ -1439,16 +1410,15 @@
 class QuaIFRef(QuaIFRefLTC):
   def derivative(self, V, t, I):
     dVdt = (self.c * (V - self.V_rest) * (V - self.V_c) + self.R * I) / self.tau
     return dVdt
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 QuaIF.__doc__ = QuaIFLTC.__doc__ % ('')
 QuaIFRefLTC.__doc__ = QuaIFLTC.__doc__ % (ltc_doc)
 QuaIFRef.__doc__ = QuaIFLTC.__doc__ % ('')
 QuaIFLTC.__doc__ = QuaIFLTC.__doc__ % (ltc_doc)
@@ -1588,16 +1558,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def dV(self, V, t, w, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     dVdt = (self.c * (V - self.V_rest) * (V - self.V_c) - w + I) / self.tau
     return dVdt
 
   def dw(self, w, t, V):
     dwdt = (self.a * (V - self.V_rest) - w) / self.tau_w
     return dwdt
 
@@ -1645,26 +1614,17 @@
 
 
 class AdQuaIF(AdQuaIFLTC):
   def dV(self, V, t, w, I):
     dVdt = (self.c * (V - self.V_rest) * (V - self.V_c) - w + I) / self.tau
     return dVdt
 
-  def dw(self, w, t, V):
-    dwdt = (self.a * (V - self.V_rest) - w) / self.tau_w
-    return dwdt
-
-  @property
-  def derivative(self):
-    return JointEq([self.dV, self.dw])
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class AdQuaIFRefLTC(AdQuaIFLTC):
   def __init__(
       self,
       size: Shape,
@@ -1792,26 +1752,17 @@
 
 
 class AdQuaIFRef(AdQuaIFRefLTC):
   def dV(self, V, t, w, I):
     dVdt = (self.c * (V - self.V_rest) * (V - self.V_c) - w + I) / self.tau
     return dVdt
 
-  def dw(self, w, t, V):
-    dwdt = (self.a * (V - self.V_rest) - w) / self.tau_w
-    return dwdt
-
-  @property
-  def derivative(self):
-    return JointEq([self.dV, self.dw])
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 AdQuaIF.__doc__ = AdQuaIFLTC.__doc__ % ('')
 AdQuaIFRefLTC.__doc__ = AdQuaIFLTC.__doc__ % (ltc_doc)
 AdQuaIFRef.__doc__ = AdQuaIFLTC.__doc__ % ('')
 AdQuaIFLTC.__doc__ = AdQuaIFLTC.__doc__ % (ltc_doc)
@@ -1979,16 +1930,15 @@
   def dI2(self, I2, t):
     return - self.k2 * I2
 
   def dVth(self, V_th, t, V):
     return self.a * (V - self.V_rest) - self.b * (V_th - self.V_th_inf)
 
   def dV(self, V, t, I1, I2, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     return (- (V - self.V_rest) + self.R * (I + I1 + I2)) / self.tau
 
   @property
   def derivative(self):
     return JointEq(self.dI1, self.dI2, self.dVth, self.dV)
 
   def reset_state(self, batch_size=None):
@@ -2037,22 +1987,17 @@
     return self.spike
 
 
 class Gif(GifLTC):
   def dV(self, V, t, I1, I2, I):
     return (- (V - self.V_rest) + self.R * (I + I1 + I2)) / self.tau
 
-  @property
-  def derivative(self):
-    return JointEq(self.dI1, self.dI2, self.dVth, self.dV)
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class GifRefLTC(GifLTC):
   def __init__(
       self,
       size: Shape,
@@ -2203,16 +2148,15 @@
 
 class GifRef(GifRefLTC):
   def dV(self, V, t, I1, I2, I):
     return (- (V - self.V_rest) + self.R * (I + I1 + I2)) / self.tau
 
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 Gif.__doc__ = GifLTC.__doc__ % ''
 GifRefLTC.__doc__ = GifLTC.__doc__ % ltc_doc
 GifRef.__doc__ = GifLTC.__doc__ % ''
 GifLTC.__doc__ = GifLTC.__doc__ % ltc_doc
@@ -2339,16 +2283,15 @@
     self.integral = odeint(method=method, f=self.derivative)
 
     # variables
     if init_var:
       self.reset_state(self.mode)
 
   def dV(self, V, t, u, I):
-    for out in self.cur_inputs.values():
-      I = I + out(V)
+    I = self.sum_inputs(V, init=I)
     dVdt = 0.04 * V * V + 5 * V + 140 - u + I
     return dVdt
 
   def du(self, u, t, V):
     dudt = self.a * (self.b * V - u)
     return dudt
 
@@ -2393,26 +2336,17 @@
 
 
 class Izhikevich(IzhikevichLTC):
   def dV(self, V, t, u, I):
     dVdt = 0.04 * V * V + 5 * V + 140 - u + I
     return dVdt
 
-  def du(self, u, t, V):
-    dudt = self.a * (self.b * V - u)
-    return dudt
-
-  @property
-  def derivative(self):
-    return JointEq([self.dV, self.du])
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 class IzhikevichRefLTC(IzhikevichLTC):
   def __init__(
       self,
       size: Shape,
@@ -2531,26 +2465,17 @@
 
 
 class IzhikevichRef(IzhikevichRefLTC):
   def dV(self, V, t, u, I):
     dVdt = 0.04 * V * V + 5 * V + 140 - u + I
     return dVdt
 
-  def du(self, u, t, V):
-    dudt = self.a * (self.b * V - u)
-    return dudt
-
-  @property
-  def derivative(self):
-    return JointEq([self.dV, self.du])
-
   def update(self, x=None):
     x = 0. if x is None else x
-    for out in self.cur_inputs.values():
-      x = x + out(self.V.value)
+    x = self.sum_inputs(self.V.value, init=x)
     return super().update(x)
 
 
 Izhikevich.__doc__ = IzhikevichLTC.__doc__ % ''
 IzhikevichRefLTC.__doc__ = IzhikevichLTC.__doc__ % ltc_doc
 IzhikevichRef.__doc__ = IzhikevichLTC.__doc__ % ''
 IzhikevichLTC.__doc__ = IzhikevichLTC.__doc__ % ltc_doc
```

## brainpy/_src/dyn/projections/aligns.py

```diff
@@ -1,15 +1,17 @@
 from typing import Optional, Callable, Union
 
 import jax
 
 from brainpy import math as bm, check
 from brainpy._src.delay import Delay, VarDelay, DataDelay, DelayAccess
 from brainpy._src.dynsys import DynamicalSystem, Projection, Dynamic
-from brainpy._src.mixin import JointType, ParamDescInit, ReturnInfo, AutoDelaySupp, BindCondData, AlignPost
+from brainpy._src.mixin import (JointType, ParamDescInit, ReturnInfo,
+                                AutoDelaySupp, BindCondData, AlignPost,
+                                ReceiveInputProj)
 
 __all__ = [
   'VanillaProj',
   'ProjAlignPostMg1', 'ProjAlignPostMg2',
   'ProjAlignPost1', 'ProjAlignPost2',
   'ProjAlignPreMg1', 'ProjAlignPreMg2',
 ]
@@ -105,18 +107,18 @@
         def __init__(self):
           super().__init__()
           self.N = bp.dyn.LifRef(4000, V_rest=-60., V_th=-50., V_reset=-60., tau=20., tau_ref=5.,
                                  V_initializer=bp.init.Normal(-55., 2.))
           self.delay = bp.VarDelay(self.N.spike, entries={'I': None})
           self.syn1 = bp.dyn.Expon(size=3200, tau=5.)
           self.syn2 = bp.dyn.Expon(size=800, tau=10.)
-          self.E = bp.dyn.VanillaProj(comm=bp.dnn.EventJitFPHomoLinear(3200, 4000, prob=0.02, weight=0.6),
+          self.E = bp.dyn.VanillaProj(comm=bp.dnn.JitFPHomoLinear(3200, 4000, prob=0.02, weight=0.6),
                                       out=bp.dyn.COBA(E=0.),
                                       post=self.N)
-          self.I = bp.dyn.VanillaProj(comm=bp.dnn.EventJitFPHomoLinear(800, 4000, prob=0.02, weight=6.7),
+          self.I = bp.dyn.VanillaProj(comm=bp.dnn.JitFPHomoLinear(800, 4000, prob=0.02, weight=6.7),
                                       out=bp.dyn.COBA(E=-80.),
                                       post=self.N)
 
         def update(self, input):
           spk = self.delay.at('I')
           self.E(self.syn1(spk[:3200]))
           self.I(self.syn2(spk[3200:]))
@@ -137,33 +139,33 @@
     mode: Mode. The computing mode.
   """
 
   def __init__(
       self,
       comm: DynamicalSystem,
       out: JointType[DynamicalSystem, BindCondData],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(comm, DynamicalSystem)
     check.is_instance(out, JointType[DynamicalSystem, BindCondData])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.post = post
     self.comm = comm
 
     # output initialization
-    post.cur_inputs[self.name] = out
+    post.add_inp_fun(self.name, out)
 
   def update(self, x):
     current = self.comm(x)
-    self.post.cur_inputs[self.name].bind_cond(current)
+    self.post.get_inp_fun(self.name).bind_cond(current)
     return current
 
 
 class ProjAlignPostMg1(Projection):
   r"""Synaptic projection which defines the synaptic computation with the dimension of postsynaptic neuron group.
 
   **Code Examples**
@@ -212,34 +214,34 @@
   """
 
   def __init__(
       self,
       comm: DynamicalSystem,
       syn: ParamDescInit[JointType[DynamicalSystem, AlignPost]],
       out: ParamDescInit[JointType[DynamicalSystem, BindCondData]],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(comm, DynamicalSystem)
     check.is_instance(syn, ParamDescInit[JointType[DynamicalSystem, AlignPost]])
     check.is_instance(out, ParamDescInit[JointType[DynamicalSystem, BindCondData]])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.post = post
     self.comm = comm
 
     # synapse and output initialization
     self._post_repr = f'{syn._identifier} // {out._identifier}'
     if self._post_repr not in self.post.before_updates:
       syn_cls = syn()
       out_cls = out()
-      self.post.cur_inputs[self.name] = out_cls
+      self.post.add_inp_fun(self.name, out_cls)
       self.post.before_updates[self._post_repr] = _AlignPost(syn_cls, out_cls)
 
   def update(self, x):
     current = self.comm(x)
     syn: _AlignPost = self.post.before_updates[self._post_repr].syn
     syn.add_current(current)  # synapse post current
     return current
@@ -318,26 +320,26 @@
   def __init__(
       self,
       pre: JointType[DynamicalSystem, AutoDelaySupp],
       delay: Union[None, int, float],
       comm: DynamicalSystem,
       syn: ParamDescInit[JointType[DynamicalSystem, AlignPost]],
       out: ParamDescInit[JointType[DynamicalSystem, BindCondData]],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(pre, JointType[DynamicalSystem, AutoDelaySupp])
     check.is_instance(comm, DynamicalSystem)
     check.is_instance(syn, ParamDescInit[JointType[DynamicalSystem, AlignPost]])
     check.is_instance(out, ParamDescInit[JointType[DynamicalSystem, BindCondData]])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.pre = pre
     self.post = post
     self.comm = comm
 
     # delay initialization
     if _pre_delay_repr not in self.pre.after_updates:
       # pre should support "ProjAutoDelay"
@@ -348,15 +350,15 @@
     delay_cls.register_entry(self.name, delay)
 
     # synapse and output initialization
     self._post_repr = f'{syn._identifier} // {out._identifier}'
     if self._post_repr not in self.post.before_updates:
       syn_cls = syn()
       out_cls = out()
-      self.post.cur_inputs[self.name] = out_cls
+      self.post.add_inp_fun(self.name, out_cls)
       self.post.before_updates[self._post_repr] = _AlignPost(syn_cls, out_cls)
 
   def update(self):
     x = self.pre.after_updates[_pre_delay_repr].at(self.name)
     current = self.comm(x)
     self.post.before_updates[self._post_repr].syn.add_current(current)  # synapse post current
     return current
@@ -407,30 +409,30 @@
   """
 
   def __init__(
       self,
       comm: DynamicalSystem,
       syn: JointType[DynamicalSystem, AlignPost],
       out: JointType[DynamicalSystem, BindCondData],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(comm, DynamicalSystem)
     check.is_instance(syn, JointType[DynamicalSystem, AlignPost])
     check.is_instance(out, JointType[DynamicalSystem, BindCondData])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.post = post
     self.comm = comm
 
     # synapse and output initialization
-    self.post.cur_inputs[self.name] = out
+    self.post.add_inp_fun(self.name, out)
     self.post.before_updates[self.name] = _AlignPost(syn, out)
 
   def update(self, x):
     current = self.comm(x)
     syn: _AlignPost = self.post.before_updates[self.name].syn
     syn.add_current(current)  # synapse post current
     return current
@@ -505,41 +507,41 @@
   def __init__(
       self,
       pre: JointType[DynamicalSystem, AutoDelaySupp],
       delay: Union[None, int, float],
       comm: DynamicalSystem,
       syn: JointType[DynamicalSystem, AlignPost],
       out: JointType[DynamicalSystem, BindCondData],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(pre, JointType[DynamicalSystem, AutoDelaySupp])
     check.is_instance(comm, DynamicalSystem)
     check.is_instance(syn, JointType[DynamicalSystem, AlignPost])
     check.is_instance(out, JointType[DynamicalSystem, BindCondData])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.pre = pre
     self.post = post
     self.comm = comm
 
     # delay initialization
     if _pre_delay_repr not in self.pre.after_updates:
       # pre should support "ProjAutoDelay"
       delay_cls = _init_delay(pre.return_info())
       # add to "after_updates"
       self.pre.after_updates[_pre_delay_repr] = delay_cls
     delay_cls: Delay = pre.after_updates[_pre_delay_repr]
     delay_cls.register_entry(self.name, delay)
 
     # synapse and output initialization
-    self.post.cur_inputs[self.name] = out
+    self.post.add_inp_fun(self.name, out)
     self.post.before_updates[self.name] = _AlignPost(syn, out)
 
   def update(self):
     x = self.pre.after_updates[_pre_delay_repr].at(self.name)
     current = self.comm(x)
     self.post.before_updates[self.name].syn.add_current(current)  # synapse post current
     return current
@@ -614,26 +616,26 @@
   def __init__(
       self,
       pre: DynamicalSystem,
       syn: ParamDescInit[JointType[DynamicalSystem, AutoDelaySupp]],
       delay: Union[None, int, float],
       comm: Callable,
       out: JointType[DynamicalSystem, BindCondData],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(pre, DynamicalSystem)
     check.is_instance(syn, ParamDescInit[JointType[DynamicalSystem, AutoDelaySupp]])
     check.is_instance(comm, Callable)
     check.is_instance(out, JointType[DynamicalSystem, BindCondData])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.pre = pre
     self.post = post
     self.comm = comm
 
     # synapse and delay initialization
     self._syn_id = syn.identifier
     if self._syn_id not in pre.after_updates:
@@ -642,15 +644,15 @@
       delay_cls = _init_delay(syn_cls.return_info())
       # add to "after_updates"
       pre.after_updates[self._syn_id] = _AlignPre(syn_cls, delay_cls)
     delay_cls: Delay = pre.after_updates[self._syn_id].delay
     delay_cls.register_entry(self.name, delay)
 
     # output initialization
-    post.cur_inputs[self.name] = out
+    post.add_inp_fun(self.name, out)
 
   def update(self, x=None):
     if x is None:
       x = self.pre.after_updates[self._syn_id].delay.at(self.name)
     current = self.comm(x)
     self.post.cur_inputs[self.name].bind_cond(current)
     return current
@@ -725,26 +727,26 @@
   def __init__(
       self,
       pre: JointType[DynamicalSystem, AutoDelaySupp],
       delay: Union[None, int, float],
       syn: ParamDescInit[JointType[DynamicalSystem, AutoDelaySupp]],
       comm: Callable,
       out: JointType[DynamicalSystem, BindCondData],
-      post: Dynamic,
+      post: JointType[DynamicalSystem, ReceiveInputProj],
       name: Optional[str] = None,
       mode: Optional[bm.Mode] = None,
   ):
     super().__init__(name=name, mode=mode)
 
     # synaptic models
     check.is_instance(pre, JointType[DynamicalSystem, AutoDelaySupp])
     check.is_instance(syn, ParamDescInit[JointType[DynamicalSystem, AutoDelaySupp]])
     check.is_instance(comm, Callable)
     check.is_instance(out, JointType[DynamicalSystem, BindCondData])
-    check.is_instance(post, Dynamic)
+    check.is_instance(post, JointType[DynamicalSystem, ReceiveInputProj])
     self.pre = pre
     self.post = post
     self.comm = comm
 
     # synapse and delay initialization
     if _pre_delay_repr not in self.pre.after_updates:
       delay_ins = _init_delay(pre.return_info())
@@ -758,14 +760,14 @@
       delay_access = DelayAccess(delay_ins, delay)
       # synapse
       syn_cls = syn()
       # add to "after_updates"
       post.before_updates[self._syn_id] = _AlignPreMg(delay_access, syn_cls)
 
     # output initialization
-    post.cur_inputs[self.name] = out
+    post.add_inp_fun(self.name, out)
 
   def update(self):
     x = _get_return(self.post.before_updates[self._syn_id].syn.return_info())
     current = self.comm(x)
-    self.post.cur_inputs[self.name].bind_cond(current)
+    self.post.get_inp_fun(self.name).bind_cond(current)
     return current
```

## brainpy/_src/math/object_transform/base.py

```diff
@@ -637,15 +637,22 @@
 
   def __repr__(self):
     return self.__class__.__name__
 
 
 class NodeList(list):
   """A sequence of :py:class:`~.BrainPyObject`, which is compatible with
-  :py:func:`.vars()` operation in a :py:class:`~.BrainPyObject`.
+  :py:func:`~.vars()` and :py:func:`~.nodes()` operations in a :py:class:`~.BrainPyObject`.
+
+  That is to say, any nodes that are wrapped into :py:class:`~.NodeList` will be automatically
+  retieved when using :py:func:`~.nodes()` function.
+
+  >>> import brainpy as bp
+  >>> l = bm.node_list([bp.dnn.Dense(1, 2),
+  >>>                   bp.dnn.LSTMCell(2, 3)])
   """
 
   def __init__(self, seq=()):
     super().__init__()
     self.extend(seq)
 
   def append(self, element) -> 'NodeList':
```

## Comparing `brainpy-2.4.3.1.dist-info/LICENSE` & `brainpy-2.4.3.2.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `brainpy-2.4.3.1.dist-info/METADATA` & `brainpy-2.4.3.2.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: brainpy
-Version: 2.4.3.1
+Version: 2.4.3.2
 Summary: BrainPy: Brain Dynamics Programming in Python
 Home-page: https://github.com/brainpy/BrainPy
 Author: BrainPy Team
 Author-email: chao.brain@qq.com
 License: GPL-3.0 license
 Project-URL: Bug Tracker, https://github.com/brainpy/BrainPy/issues
 Project-URL: Documentation, https://brainpy.readthedocs.io/
```

### html2text {}

```diff
@@ -1,8 +1,8 @@
-Metadata-Version: 2.1 Name: brainpy Version: 2.4.3.1 Summary: BrainPy: Brain
+Metadata-Version: 2.1 Name: brainpy Version: 2.4.3.2 Summary: BrainPy: Brain
 Dynamics Programming in Python Home-page: https://github.com/brainpy/BrainPy
 Author: BrainPy Team Author-email: chao.brain@qq.com License: GPL-3.0 license
 Project-URL: Bug Tracker, https://github.com/brainpy/BrainPy/issues Project-
 URL: Documentation, https://brainpy.readthedocs.io/ Project-URL: Source Code,
 https://github.com/brainpy/BrainPy Keywords: computational neuroscience,brain-
 inspired computation,dynamical systems,differential equations,brain
 modeling,brain dynamics modeling,brain dynamics programming Classifier: Natural
```

## Comparing `brainpy-2.4.3.1.dist-info/RECORD` & `brainpy-2.4.3.2.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -1,40 +1,40 @@
-brainpy/__init__.py,sha256=PzAppAUcjZKOr7GXJZQVOJucUJwqYxJtlLKoerRaZd4,4723
+brainpy/__init__.py,sha256=szf0LurYIC3wtQHyIjz87IeQULyu09_5bYDc5PBHeFY,4723
 brainpy/_add_deprecations.py,sha256=VejwF-pk9I0AjruW-0TgtzTyZHlHFf_AUIz-MB1KMGw,6082
 brainpy/analysis.py,sha256=MqtAbIeuyjSI6obQesgrtuJX21hahCYOKIqh_P7o9F8,686
 brainpy/channels.py,sha256=HTexdVY_zeUWsEB09ZZ7SQQwFj7iD4NiKdjQWHKZ_N0,81
 brainpy/check.py,sha256=ZrpRXpLY2OJjUdNorSrQg3V0SjrpMBtYdj6eejE7j08,19618
 brainpy/checkpoints.py,sha256=2o7_DMDrE4iJ-IgKmDFMbON44ZCFk3Tx8UmLeFCJOQg,429
 brainpy/connect.py,sha256=tWKIDEsxqcdAbC2HzVClIAEbanFOymMi70KduMZyL1E,1332
 brainpy/encoding.py,sha256=2MhBAru8IpxhPt2B9OYTi1u3YxhT_GgTidNDAXese40,338
 brainpy/errors.py,sha256=4E71WAO9hzQR7fzmvbIGSVwDSBsf5dk2s287SlbK7_U,7807
 brainpy/experimental.py,sha256=FBqqxp7pih2yYdwnRrMz8XpEfMn36hW_zihcf_0NOtU,384
 brainpy/initialize.py,sha256=udEi3tcAULzoi96KMZcCysMZCGkm8S-7JdB1MNQaUPc,1178
 brainpy/inputs.py,sha256=_U6094enWUKacshR2w4WiRQydEXbUTcjKhwm24lLILY,348
 brainpy/layers.py,sha256=BFCWiyeI-jZ8DUjmB7NWpFpy5p5-_gi_39YOMPF7jpE,22
 brainpy/losses.py,sha256=vRKQmkGSCtbwy8cc1C8WY_4BYGgrJLXFNkvUdEAHaz8,1124
 brainpy/measure.py,sha256=Zi7NAZs1GwL1dA3BqM6i6K0SmkKO3iS9KnXx9HMviCI,506
-brainpy/mixin.py,sha256=meq-7RtMJlJOIxh5odFaIB9Q4vaHv3Xa6ZX8Gx_olH8,278
+brainpy/mixin.py,sha256=4TS9j48y8Guwthhvnu99SltD3xe5O8_nkdmlccDVOGU,335
 brainpy/neurons.py,sha256=yPB0gYLGbKd-BRqrYFPAoJuStj7I8NH21PNYp8xrSCE,999
 brainpy/optim.py,sha256=mDmV3YNaB-uiUSwr5GD2p-3y3nDBMQh8et0pzc2iE08,1060
 brainpy/rates.py,sha256=zt4gPMi7W5zhUO4v203pzs-jJ6j6HtllAFqaxozzdCI,57
 brainpy/running.py,sha256=7A66RM0hzEQLoWXJb5-EuGb977NCEF5slaUUn4X-500,482
 brainpy/synapses.py,sha256=ep6oYibtKwx4fWetl1qhfB_VB4hRY42xyV8RRIIYDi0,970
 brainpy/synouts.py,sha256=38tBZ991uhMgmA7b6URFS5RnXF-lSxABQbFb9M3gWu4,196
 brainpy/synplast.py,sha256=J3UlDw1Kkh3fZN8-A5a_qiX8aZ8Hd4L3cOWR_Cl04hI,126
 brainpy/tools.py,sha256=mn2LDO4JrTYc6gBvhXadYe1Ui5g6L80OBxjEmupBbVQ,1094
 brainpy/types.py,sha256=6BRhcrjF2c6lUaZAG7YU4e-bJ5o_vAleFPawIiXR-rs,279
 brainpy/_src/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 brainpy/_src/_delay.py,sha256=cAiPKloOodT-E5ED4b0BSIjxPD2YeIqpf-gyV9Q4YlI,10243
 brainpy/_src/checking.py,sha256=53gdS06Rwzkl9ckO5-CNhDuEOtbapZ7K9wdZOAQP67A,2509
 brainpy/_src/context.py,sha256=cqvAwG9Dzwv5alqiZlZ2NlJ8FIHqXx5T_lP0Zm-waWw,2714
-brainpy/_src/delay.py,sha256=7X6rV8xVLEPg5I-BnfCd1dKOvVul78NldfW17AJ9KXM,23734
+brainpy/_src/delay.py,sha256=hWILDCx3cqRV0ozk9ynJBm274PEK91P9Iih96FUPY20,23805
 brainpy/_src/deprecations.py,sha256=Jx2nSQuYtxt_CU1l01Q6fK0BQgajL9UIKx6c9lAFOnU,2121
-brainpy/_src/dynsys.py,sha256=zhru30oBcp42rTphoxCrOG-Xj7XNivZ5xTkQJ1B68Xc,26006
-brainpy/_src/mixin.py,sha256=gIbIIvEKG4fAzYmaGkjNiEf6gjMH2rNsnueDWdEBoy0,20151
+brainpy/_src/dynsys.py,sha256=8yrHOcAWNKf0uHsOgSPT6qs-hjZYwcfgJDVNnBJ9BPw,25795
+brainpy/_src/mixin.py,sha256=sVgNedHSjCYdoutCnIwToiINflYgfCE3Jx2nh4rFy6A,21257
 brainpy/_src/modes.py,sha256=7OgTXtnTtc6qHIGfgHZ9w6KL1x9_XddT3h43bWP9Udc,1128
 brainpy/_src/runners.py,sha256=Iiqzh7GSwECRNks-70G1Q6Qscn7kRgSIYQaO_YnRdZg,24011
 brainpy/_src/transform.py,sha256=liJTR98hAL5rGt4FlUZC0vJmgkh8XOVtpHUf-CvxxJs,10537
 brainpy/_src/types.py,sha256=mEif18T9TyVNE9pQCKmpJZE2zlffvg1suxSthv14S8M,1102
 brainpy/_src/analysis/__init__.py,sha256=dTG4qtP8tahngjI4qaB88EITJ8uTBX7UwpqkH_cE9wM,871
 brainpy/_src/analysis/base.py,sha256=bb4CVPh8gky53nqFM73-ZIPOnJlAPIBKd5Zw1_1ZWs8,168
 brainpy/_src/analysis/constants.py,sha256=eTb1lRw0HquV3T_vPjySIvSwj3fpe-cMBAL-DqjCoYE,1807
@@ -92,31 +92,31 @@
 brainpy/_src/dyn/channels/potassium.py,sha256=1WgH24W4galnw9AB2c9D94Z0G0RPB6FYrrvT4NtJL_0,72311
 brainpy/_src/dyn/channels/potassium_calcium.py,sha256=TPJGXHq1Lb4xMXIy2TRbdT5_Afs4thohQTJwYhKzPOI,4689
 brainpy/_src/dyn/channels/potassium_calcium_compatible.py,sha256=awaPI2HdQ3qjsiR6Ct9biO7P9rOV0lQ0iIoi3lZm070,4788
 brainpy/_src/dyn/channels/potassium_compatible.py,sha256=wja0FRwpLYJkHjOUYZMApCb1FWLPCXv62b9usb9Cv2Q,37946
 brainpy/_src/dyn/channels/sodium.py,sha256=uCpK58OFesdtGi1zxeofLAkZCln7dCneyqMW892YpBI,12018
 brainpy/_src/dyn/channels/sodium_compatible.py,sha256=XHKzh6--fL0_mNwnL-Q5YSCQTRhZ_BcGwKkRz5YX7G4,12425
 brainpy/_src/dyn/ions/__init__.py,sha256=hOuhbnivhYtEvS0UA_pJb4qpcE6-0aFdpSJxMBy_K1k,96
-brainpy/_src/dyn/ions/base.py,sha256=5ceGgrPKY1Bi6SfsoYlGiE_3AoM8n_8Cay9L_TK925c,7079
+brainpy/_src/dyn/ions/base.py,sha256=AXS3fdbALWWYADmE12Kz8MuSjKGlymCxXlK9bdaQ4n4,7147
 brainpy/_src/dyn/ions/calcium.py,sha256=Sca623fWdfox7E-9hLyCOR7t0OrjlZxQCtMzFrOsSAI,12036
 brainpy/_src/dyn/ions/potassium.py,sha256=tRXPnj1mpI0Xalm59WlH92L3nJoK539KQ7SGEUKUnO4,1521
 brainpy/_src/dyn/ions/sodium.py,sha256=mrPVX3FSx_70xK7pa5_LAMHsA8zRW9GYzZWahZtWs4w,1539
 brainpy/_src/dyn/neurons/__init__.py,sha256=R19l6mdN1mJ3CLtdBniSBT08PTGcALZ7VUgw1MCYoQ8,24
 brainpy/_src/dyn/neurons/base.py,sha256=pdiaOF1sfVeAD4sw4HFqnhLLM3k08UqEdSvRoVwR5O0,1477
-brainpy/_src/dyn/neurons/hh.py,sha256=9QSMH0SHp-9DNbLv8BRvMxjYn6Mcofkkx5jm4NQhF1A,51059
-brainpy/_src/dyn/neurons/lif.py,sha256=lH9VLwvVVyws38Qkfh8MwoDfdasxsHn0VHt984Hl_CY,89947
+brainpy/_src/dyn/neurons/hh.py,sha256=4RDDhzFBdsJfnmOk-djvNbMXUaro0Wv38iuqoY7fskg,49933
+brainpy/_src/dyn/neurons/lif.py,sha256=uifBbmuhvS0sOcrLq0NRDE-nW037XpnZnoTWYnPs_zE,88145
 brainpy/_src/dyn/others/__init__.py,sha256=zIQjP_A1B2ttcZoiD_JHeNooMamlJFW9yTBI7iVl7Ro,29
 brainpy/_src/dyn/others/common.py,sha256=rxqpcPrOUozx2EXReKlIYWgu09iAwcRu2lusC97i52s,4293
 brainpy/_src/dyn/others/input.py,sha256=zUPhsVjJ8Cju4a9PIvTrRJ0djR_C0orlHMPEhKYSFm4,6984
 brainpy/_src/dyn/others/noise.py,sha256=cqSDvXJZCsoyDUedCLfKgiLqlpLCD71mbrvL8MEYk1g,2278
 brainpy/_src/dyn/outs/__init__.py,sha256=Mb8sKszo6mi6BAm1vTXQkOXwVExvXdT0vL7tg7gcsq4,45
 brainpy/_src/dyn/outs/base.py,sha256=64TBXavDemdJiNw5OQCBIcUJcCk8bDyNzFEqYEZLBwQ,779
 brainpy/_src/dyn/outs/outputs.py,sha256=Js5TAtshUzMenlN91Iia-eZFyWKDLJQZm4gCuDgIT4w,3314
 brainpy/_src/dyn/projections/__init__.py,sha256=OQRdV0uLWhIsL_c9mDZ1rr9Z-o4EqwcbpHsg2yfWe2w,69
-brainpy/_src/dyn/projections/aligns.py,sha256=Vu1qd1DuwZsJrumOIDcInkkjED7r9wkQqCaroNJAwKY,30144
+brainpy/_src/dyn/projections/aligns.py,sha256=kcqATUikCfJKXGxqkMDUt-Y3RrufiQAdSnvv6kgNpzs,30740
 brainpy/_src/dyn/projections/conn.py,sha256=_dHCU0bNyMUSI89Xw3mbBz-sfA4RUWriOB6bx_D0s5c,3872
 brainpy/_src/dyn/projections/others.py,sha256=hN3elt7HGI6t78Nkcpy1G3UQYsjnnDz-iPDCjHSXvWI,2772
 brainpy/_src/dyn/rates/__init__.py,sha256=Iz02rqiBWUuifG87VY20P553MGapanBdHMmt48SN24A,55
 brainpy/_src/dyn/rates/populations.py,sha256=_-WLKjdeSIaghnRPdLaQPS3Hc2smh3y4c0l0eE96ny8,42276
 brainpy/_src/dyn/synapses/__init__.py,sha256=HovcuP8MxaZP1LrYVsRY00foNOO8W9wLIUdx-MbIXe0,61
 brainpy/_src/dyn/synapses/abstract_models.py,sha256=jHFZ5oZ2qKKaa-fLCs5TQyMSU0-9N_3CeloWw901VJk,22572
 brainpy/_src/dyn/synapses/bio_models.py,sha256=GsZPmZ0PE4_pwj2Xf_ZCp_409dJGvl3QyRdMUVEtzdc,12152
@@ -214,15 +214,15 @@
 brainpy/_src/math/jitconn/__init__.py,sha256=FaSf0D9daiFO5GqKpCPoQTUgSI9Aup-EBQU17c102So,56
 brainpy/_src/math/jitconn/_event_matvec.py,sha256=zJ03K_fj0XjFSGmHVEiSqrOcZVJOHuqzfoNKPvgyDeI,25692
 brainpy/_src/math/jitconn/_matvec.py,sha256=eHXjtakef4s3ni77wYNrkPBPL3MgWKbX5TQanePSOSI,29611
 brainpy/_src/math/object_transform/__init__.py,sha256=_HKjnYOIsWsssKZW6IEm0BpmkY2bN4ate34nB510ZYo,943
 brainpy/_src/math/object_transform/_tools.py,sha256=sS7Qz_KN61MXlK-ob9nhPnjDZibnZbeJic8_4KrD0h0,3743
 brainpy/_src/math/object_transform/_utils.py,sha256=_yubX0zl2E6yRtyr3avvl0Ukl_rUOR9FQV-fhC5z_Bc,787
 brainpy/_src/math/object_transform/autograd.py,sha256=NP2AphaXhDi2cH3Swh4ZyvEd7lxFG5pFlQgWoP9TfIs,41713
-brainpy/_src/math/object_transform/base.py,sha256=MS7XYIhDQ_KDzkauYlj1IOO8r6648pvjCBOnKyk8y3A,23465
+brainpy/_src/math/object_transform/base.py,sha256=DTPS47ebP426QMwjAZV5jI5qYKFFCQJUic1ogxCmNDg,23768
 brainpy/_src/math/object_transform/collectors.py,sha256=eeAvzhXQCSgjV9XLZWX_3grq1DeQxBvP64wB7Cm4bi0,6140
 brainpy/_src/math/object_transform/controls.py,sha256=VHqCwR79gZxaCtjBHeMourSRiBzSl6mnduOfPAdSOp4,33692
 brainpy/_src/math/object_transform/function.py,sha256=fjYzyLxp6WnLEio0AEL0x4Y3wXnMayKaTiheOS0YwvI,3101
 brainpy/_src/math/object_transform/jit.py,sha256=8ejHrvgApf0chMJne8lGEmnW43QhI20c-TQvcmJFoQQ,16259
 brainpy/_src/math/object_transform/naming.py,sha256=YhzbV5VMK3RRGOvYazvizAhpYSciWyGwdwHYMPlRZP4,1711
 brainpy/_src/math/object_transform/parallels.py,sha256=D0N5mOliArG5NwUL7LgDbT92UcRuw0bKt8-xOAO7hpA,18234
 brainpy/_src/math/object_transform/variables.py,sha256=blYNcxZ9O3lohQL8z2S6pHi0P65HQT9eKywvfuvssUo,15087
@@ -322,12 +322,12 @@
 brainpy/math/op_register.py,sha256=DEn119RDRxYp3xxUg92PnG5h4Ups49wEnjLoitPd1gU,137
 brainpy/math/others.py,sha256=z97UhqDnrGWOde7ghntc6-PVOAmo8Vts4H10IxnDdgc,268
 brainpy/math/pre_syn_post.py,sha256=jITwBquVo0vKVRZXn9KMdq-2uRS-dRRVCjb8Mf7b9MI,352
 brainpy/math/random.py,sha256=6OpnjzSNsclFEfSEd5NhQKH5zZ62X8ch3Cb0NYJcNCw,1843
 brainpy/math/sharding.py,sha256=Sx3qYaTrW2hMIDVlnL7leiPm3bKar9emYjCbGR7DY-M,228
 brainpy/math/sparse.py,sha256=WVo-6ZRTZ-v8hsGhlOdo3-WakSvymY0mY6UIxP7CKlQ,175
 brainpy/math/surrogate.py,sha256=jcbXBdt4PuKNT70NskkLUu_WJMhxlAmlbQMy2mOLx9k,1320
-brainpy-2.4.3.1.dist-info/LICENSE,sha256=y_p8Hru855LwiNwIbkjJLmA0ZMwQQzHvJR5BVplHk1I,35773
-brainpy-2.4.3.1.dist-info/METADATA,sha256=O1Vr6Ec8aBjHCAZ2VYK4QkmD0lfXJB8K7jKgoP1OPMM,4351
-brainpy-2.4.3.1.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
-brainpy-2.4.3.1.dist-info/top_level.txt,sha256=5oi55xrJaqccrIi7VVShKhvGx0MjnDl0efebGKr5Omc,8
-brainpy-2.4.3.1.dist-info/RECORD,,
+brainpy-2.4.3.2.dist-info/LICENSE,sha256=y_p8Hru855LwiNwIbkjJLmA0ZMwQQzHvJR5BVplHk1I,35773
+brainpy-2.4.3.2.dist-info/METADATA,sha256=mB40nl_MVrmtTSveY2RzFXPqfQXFbIK8E0L3TjgxIbY,4351
+brainpy-2.4.3.2.dist-info/WHEEL,sha256=G16H4A3IeoQmnOrYV4ueZGKSjhipXx8zc8nu9FGlvMA,92
+brainpy-2.4.3.2.dist-info/top_level.txt,sha256=5oi55xrJaqccrIi7VVShKhvGx0MjnDl0efebGKr5Omc,8
+brainpy-2.4.3.2.dist-info/RECORD,,
```

