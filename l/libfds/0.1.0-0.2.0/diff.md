# Comparing `tmp/libfds-0.1.0.tar.gz` & `tmp/libfds-0.2.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "libfds-0.1.0.tar", last modified: Mon Jul 17 20:23:25 2023, max compression
+gzip compressed data, was "libfds-0.2.0.tar", last modified: Sun Jul 23 23:07:49 2023, max compression
```

## Comparing `libfds-0.1.0.tar` & `libfds-0.2.0.tar`

### file list

```diff
@@ -1,19 +1,19 @@
-drwxr-xr-x   0 cdesjouy  (1000) cdesjouy  (1000)        0 2023-07-17 20:23:25.361895 libfds-0.1.0/
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      576 2023-07-17 20:23:25.361895 libfds-0.1.0/PKG-INFO
-drwxr-xr-x   0 cdesjouy  (1000) cdesjouy  (1000)        0 2023-07-17 20:23:25.358561 libfds-0.1.0/libfds/
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      865 2023-07-17 20:22:46.000000 libfds-0.1.0/libfds/__init__.py
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  1253488 2023-07-17 20:15:33.000000 libfds-0.1.0/libfds/cmaths.c
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)   970630 2023-07-17 20:15:34.000000 libfds-0.1.0/libfds/cutils.c
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  2848144 2023-07-17 20:15:35.000000 libfds-0.1.0/libfds/fields.c
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  1506303 2023-07-17 20:15:36.000000 libfds-0.1.0/libfds/filters.c
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  1548838 2023-07-17 20:15:37.000000 libfds-0.1.0/libfds/fluxes.c
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  6706210 2023-07-17 20:15:41.000000 libfds-0.1.0/libfds/libdiff.c
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  3395535 2023-07-17 20:15:43.000000 libfds-0.1.0/libfds/libfilt.c
-drwxr-xr-x   0 cdesjouy  (1000) cdesjouy  (1000)        0 2023-07-17 20:23:25.361895 libfds-0.1.0/libfds.egg-info/
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      576 2023-07-17 20:23:25.000000 libfds-0.1.0/libfds.egg-info/PKG-INFO
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      291 2023-07-17 20:23:25.000000 libfds-0.1.0/libfds.egg-info/SOURCES.txt
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)        1 2023-07-17 20:23:25.000000 libfds-0.1.0/libfds.egg-info/dependency_links.txt
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)        6 2023-07-17 20:23:25.000000 libfds-0.1.0/libfds.egg-info/requires.txt
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)        7 2023-07-17 20:23:25.000000 libfds-0.1.0/libfds.egg-info/top_level.txt
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)       38 2023-07-17 20:23:25.361895 libfds-0.1.0/setup.cfg
--rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)     3993 2023-03-07 13:27:13.000000 libfds-0.1.0/setup.py
+drwxr-xr-x   0 cdesjouy  (1000) cdesjouy  (1000)        0 2023-07-23 23:07:49.452861 libfds-0.2.0/
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      576 2023-07-23 23:07:49.452861 libfds-0.2.0/PKG-INFO
+drwxr-xr-x   0 cdesjouy  (1000) cdesjouy  (1000)        0 2023-07-23 23:07:49.446194 libfds-0.2.0/libfds/
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      865 2023-07-23 23:07:12.000000 libfds-0.2.0/libfds/__init__.py
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  1253488 2023-07-21 09:19:38.000000 libfds-0.2.0/libfds/cmaths.c
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)   970630 2023-07-21 09:19:38.000000 libfds-0.2.0/libfds/cutils.c
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  2853370 2023-07-21 09:19:40.000000 libfds-0.2.0/libfds/fields.c
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  1510355 2023-07-21 09:19:41.000000 libfds-0.2.0/libfds/filters.c
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  1553845 2023-07-21 09:19:42.000000 libfds-0.2.0/libfds/fluxes.c
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  6706210 2023-07-21 09:19:45.000000 libfds-0.2.0/libfds/libdiff.c
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)  3395535 2023-07-21 09:19:48.000000 libfds-0.2.0/libfds/libfilt.c
+drwxr-xr-x   0 cdesjouy  (1000) cdesjouy  (1000)        0 2023-07-23 23:07:49.452861 libfds-0.2.0/libfds.egg-info/
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      576 2023-07-23 23:07:49.000000 libfds-0.2.0/libfds.egg-info/PKG-INFO
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)      291 2023-07-23 23:07:49.000000 libfds-0.2.0/libfds.egg-info/SOURCES.txt
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)        1 2023-07-23 23:07:49.000000 libfds-0.2.0/libfds.egg-info/dependency_links.txt
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)        6 2023-07-23 23:07:49.000000 libfds-0.2.0/libfds.egg-info/requires.txt
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)        7 2023-07-23 23:07:49.000000 libfds-0.2.0/libfds.egg-info/top_level.txt
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)       38 2023-07-23 23:07:49.452861 libfds-0.2.0/setup.cfg
+-rw-r--r--   0 cdesjouy  (1000) cdesjouy  (1000)     3993 2023-07-23 23:07:12.000000 libfds-0.2.0/setup.py
```

### Comparing `libfds-0.1.0/PKG-INFO` & `libfds-0.2.0/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: libfds
-Version: 0.1.0
+Version: 0.2.0
 Summary: Finite difference library used by nsfds2/3
 Author: Cyril Desjouy
 Author-email: cyril.desjouy@univ-lemans.fr
 License: GPL
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: Python :: 3
 Classifier: Intended Audience :: Science/Research
```

### Comparing `libfds-0.1.0/libfds/__init__.py` & `libfds-0.2.0/libfds/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -20,8 +20,8 @@
 #
 # Creation Date : 2023-02-17 - 15:47:25
 """
 -----------
 -----------
 """
 
-__version__ = "0.1.0"
+__version__ = "0.2.0"
```

### Comparing `libfds-0.1.0/libfds/cmaths.c` & `libfds-0.2.0/libfds/cmaths.c`

 * *Files identical despite different names*

### Comparing `libfds-0.1.0/libfds/cutils.c` & `libfds-0.2.0/libfds/cutils.c`

 * *Files identical despite different names*

### Comparing `libfds-0.1.0/libfds/fields.c` & `libfds-0.2.0/libfds/fields.c`

 * *Files 0% similar despite different names*

```diff
@@ -1857,15 +1857,15 @@
 static struct __pyx_vtabstruct_6libfds_6fields_Face3d *__pyx_vtabptr_6libfds_6fields_Face3d;
 static void __pyx_f_6libfds_6fields_6Face3d_apply_bc(struct __pyx_obj_6libfds_6fields_Face3d *, Py_ssize_t);
 static void __pyx_f_6libfds_6fields_6Face3d__apply_V(struct __pyx_obj_6libfds_6fields_Face3d *, Py_ssize_t);
 static void __pyx_f_6libfds_6fields_6Face3d__apply_W(struct __pyx_obj_6libfds_6fields_Face3d *);
 static void __pyx_f_6libfds_6fields_6Face3d__apply_A(struct __pyx_obj_6libfds_6fields_Face3d *);
 
 
-/* "libfds/fields.pyx":310
+/* "libfds/fields.pyx":318
  * 
  * @cython.final
  * cdef class Fields2d:             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, cfg, msh):
  */
 
@@ -1924,15 +1924,15 @@
 static PyObject *__pyx_f_6libfds_6fields_8Fields2d_get_velocity(struct __pyx_obj_6libfds_6fields_Fields2d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_6fields_8Fields2d_phys2num(struct __pyx_obj_6libfds_6fields_Fields2d *);
 static void __pyx_f_6libfds_6fields_8Fields2d__phys2num(struct __pyx_obj_6libfds_6fields_Fields2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 static void __pyx_f_6libfds_6fields_8Fields2d_num2phys(struct __pyx_obj_6libfds_6fields_Fields2d *);
 static void __pyx_f_6libfds_6fields_8Fields2d__num2phys(struct __pyx_obj_6libfds_6fields_Fields2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/fields.pyx":813
+/* "libfds/fields.pyx":821
  * 
  * @cython.final
  * cdef class Fields3d:             # <<<<<<<<<<<<<<
  * 
  *     def __init__(self, cfg, msh):
  */
 
@@ -3116,16 +3116,16 @@
 static const char __pyx_k_r[] = "r";
 static const char __pyx_k_s[] = "s";
 static const char __pyx_k_v[] = "v";
 static const char __pyx_k_x[] = "x";
 static const char __pyx_k_y[] = "y";
 static const char __pyx_k_z[] = "z";
 static const char __pyx_k_B0[] = "B0";
-static const char __pyx_k_CP[] = "CP";
-static const char __pyx_k_CV[] = "CV";
+static const char __pyx_k_Cp[] = "Cp";
+static const char __pyx_k_Cv[] = "Cv";
 static const char __pyx_k_T0[] = "T0";
 static const char __pyx_k_Tk[] = "Tk";
 static const char __pyx_k__5[] = ", ";
 static const char __pyx_k_bc[] = "bc";
 static const char __pyx_k_c0[] = "c0";
 static const char __pyx_k_cn[] = "cn";
 static const char __pyx_k_dt[] = "dt";
@@ -3145,14 +3145,15 @@
 static const char __pyx_k_ru[] = "ru";
 static const char __pyx_k_rv[] = "rv";
 static const char __pyx_k_rw[] = "rw";
 static const char __pyx_k_rx[] = "rx";
 static const char __pyx_k_ry[] = "ry";
 static const char __pyx_k_rz[] = "rz";
 static const char __pyx_k_sn[] = "sn";
+static const char __pyx_k_tp[] = "tp";
 static const char __pyx_k_wx[] = "wx";
 static const char __pyx_k_wy[] = "wy";
 static const char __pyx_k_wz[] = "wz";
 static const char __pyx_k_xp[] = "xp";
 static const char __pyx_k_yp[] = "yp";
 static const char __pyx_k_zp[] = "zp";
 static const char __pyx_k_Ssu[] = "Ssu";
@@ -3327,21 +3328,21 @@
 static const char __pyx_k_unable_to_allocate_shape_and_str[] = "unable to allocate shape and strides.";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0_2[] = "Incompatible checksums (0x%x vs (0x25b6050, 0x847fd73, 0x76eed57) = (E, Ee, Eu, Ev, Ew, F, Fe, Fu, Fv, Fw, G, Ge, Gu, Gv, Gw, J, K, Ke, Ku, Kv, Kw, P11x, P11y, P11z, P3x, P3y, P3z, P5x, P5y, P5z, S11, S12, S13, S22, S23, S33, Ssu, T0, Tk, U0, V0, W0, bc, bz_forder, bz_n, c0, cdomains, cfg, cp, cpmcv, cppr, cpu, cv, dtrk, dx_du, dx_dv, dx_dw, dy_du, dy_dv, dy_dw, dz_du, dz_dv, dz_dw, flag_x, flag_y, flag_z, gaminusone, gamma, grid, mesh_type, msh, mu0, nsize, nx, ny, nz, odx, odx_m, odx_v, odxdt, odxdt_m, odxdt_v, odxdtrk, odxdtrk_m, odxdtrk_v, ody, ody_m, ody_v, odydt, odydt_m, odydt_v, odydtrk, odydtrk_m, odydtrk_v, odz, odz_m, odz_v, odzdt, odzdt_m, odzdt_v, odzdtrk, odzdtrk_m, odzdtrk_v, p, p0, r, re, rho0, ru, rv, rw, sigma, src, wx, wy, wz, xdomains, xnu_0, xnu_n, ydomains, zdomains))";
 static const char __pyx_k_Incompatible_checksums_0x_x_vs_0_3[] = "Incompatible checksums (0x%x vs (0xb068931, 0x82a3537, 0x6ae9995) = (name))";
 static PyObject *__pyx_n_u_A;
 static PyObject *__pyx_n_s_ASCII;
 static PyObject *__pyx_n_s_B0;
 static PyObject *__pyx_kp_s_Buffer_view_does_not_expose_stri;
-static PyObject *__pyx_n_s_CP;
-static PyObject *__pyx_n_s_CV;
 static PyObject *__pyx_kp_s_Can_only_create_a_buffer_that_is;
 static PyObject *__pyx_kp_s_Cannot_assign_to_read_only_memor;
 static PyObject *__pyx_kp_s_Cannot_create_writable_memory_vi;
 static PyObject *__pyx_kp_s_Cannot_index_with_type_s;
 static PyObject *__pyx_kp_u_Coordinates;
+static PyObject *__pyx_n_s_Cp;
+static PyObject *__pyx_n_s_Cv;
 static PyObject *__pyx_n_s_Domain2d;
 static PyObject *__pyx_n_s_Domain3d;
 static PyObject *__pyx_n_s_Ellipsis;
 static PyObject *__pyx_kp_s_Empty_shape_tuple_for_cython_arr;
 static PyObject *__pyx_n_s_Face2d;
 static PyObject *__pyx_n_s_Face3d;
 static PyObject *__pyx_n_u_False;
@@ -3526,14 +3527,15 @@
 static PyObject *__pyx_kp_s_strided_and_direct;
 static PyObject *__pyx_kp_s_strided_and_direct_or_indirect;
 static PyObject *__pyx_kp_s_strided_and_indirect;
 static PyObject *__pyx_kp_s_stringsource;
 static PyObject *__pyx_n_s_struct;
 static PyObject *__pyx_n_s_tag;
 static PyObject *__pyx_n_s_test;
+static PyObject *__pyx_n_s_tp;
 static PyObject *__pyx_kp_s_unable_to_allocate_array_data;
 static PyObject *__pyx_kp_s_unable_to_allocate_shape_and_str;
 static PyObject *__pyx_n_s_unpack;
 static PyObject *__pyx_n_s_update;
 static PyObject *__pyx_n_u_v;
 static PyObject *__pyx_n_s_vrt;
 static PyObject *__pyx_n_s_vsc;
@@ -8733,15 +8735,15 @@
   __Pyx_RefNannySetupContext("__repr__", 0);
 
   /* "libfds/fields.pyx":253
  * 
  *     def __repr__(self):
  *         return self.__str__()             # <<<<<<<<<<<<<<
  * 
- * @cython.final
+ * 
  */
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_str); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 253, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
@@ -8891,15 +8893,15 @@
   __Pyx_AddTraceback("libfds.fields.Domain2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":258
+/* "libfds/fields.pyx":259
  * cdef class Domain3d:
  * 
  *     def __cinit__(self, (Py_ssize_t, Py_ssize_t) ix, (Py_ssize_t, Py_ssize_t) iy, (Py_ssize_t, Py_ssize_t) iz, str scm, Py_ssize_t cpu):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t tsize = 2000
  */
 
@@ -8942,62 +8944,62 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ix)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_iy)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 1); __PYX_ERR(0, 258, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 1); __PYX_ERR(0, 259, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_iz)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 2); __PYX_ERR(0, 258, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 2); __PYX_ERR(0, 259, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_scm)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 3); __PYX_ERR(0, 258, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 3); __PYX_ERR(0, 259, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cpu)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 4); __PYX_ERR(0, 258, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, 4); __PYX_ERR(0, 259, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 258, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 259, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 5) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
     }
-    __pyx_v_ix = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[0]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 258, __pyx_L3_error)
-    __pyx_v_iy = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[1]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 258, __pyx_L3_error)
-    __pyx_v_iz = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[2]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 258, __pyx_L3_error)
+    __pyx_v_ix = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[0]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 259, __pyx_L3_error)
+    __pyx_v_iy = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[1]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 259, __pyx_L3_error)
+    __pyx_v_iz = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[2]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 259, __pyx_L3_error)
     __pyx_v_scm = ((PyObject*)values[3]);
-    __pyx_v_cpu = __Pyx_PyIndex_AsSsize_t(values[4]); if (unlikely((__pyx_v_cpu == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 258, __pyx_L3_error)
+    __pyx_v_cpu = __Pyx_PyIndex_AsSsize_t(values[4]); if (unlikely((__pyx_v_cpu == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 259, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 258, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 5, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 259, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Domain3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_scm), (&PyUnicode_Type), 1, "scm", 1))) __PYX_ERR(0, 258, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_scm), (&PyUnicode_Type), 1, "scm", 1))) __PYX_ERR(0, 259, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_6fields_8Domain3d___cinit__(((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_v_self), __pyx_v_ix, __pyx_v_iy, __pyx_v_iz, __pyx_v_scm, __pyx_v_cpu);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -9009,82 +9011,82 @@
   Py_ssize_t __pyx_v_tsize;
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fields.pyx":260
+  /* "libfds/fields.pyx":261
  *     def __cinit__(self, (Py_ssize_t, Py_ssize_t) ix, (Py_ssize_t, Py_ssize_t) iy, (Py_ssize_t, Py_ssize_t) iz, str scm, Py_ssize_t cpu):
  * 
  *         cdef Py_ssize_t tsize = 2000             # <<<<<<<<<<<<<<
  * 
  *         self.ix = ix
  */
   __pyx_v_tsize = 0x7D0;
 
-  /* "libfds/fields.pyx":262
+  /* "libfds/fields.pyx":263
  *         cdef Py_ssize_t tsize = 2000
  * 
  *         self.ix = ix             # <<<<<<<<<<<<<<
  *         self.iy = iy
  *         self.iz = iz
  */
   __pyx_v_self->ix = __pyx_v_ix;
 
-  /* "libfds/fields.pyx":263
+  /* "libfds/fields.pyx":264
  * 
  *         self.ix = ix
  *         self.iy = iy             # <<<<<<<<<<<<<<
  *         self.iz = iz
  * 
  */
   __pyx_v_self->iy = __pyx_v_iy;
 
-  /* "libfds/fields.pyx":264
+  /* "libfds/fields.pyx":265
  *         self.ix = ix
  *         self.iy = iy
  *         self.iz = iz             # <<<<<<<<<<<<<<
  * 
  *         self.scm = scm
  */
   __pyx_v_self->iz = __pyx_v_iz;
 
-  /* "libfds/fields.pyx":266
+  /* "libfds/fields.pyx":267
  *         self.iz = iz
  * 
  *         self.scm = scm             # <<<<<<<<<<<<<<
  * 
  *         self.cpu = cpu
  */
   __Pyx_INCREF(__pyx_v_scm);
   __Pyx_GIVEREF(__pyx_v_scm);
   __Pyx_GOTREF(__pyx_v_self->scm);
   __Pyx_DECREF(__pyx_v_self->scm);
   __pyx_v_self->scm = __pyx_v_scm;
 
-  /* "libfds/fields.pyx":268
+  /* "libfds/fields.pyx":269
  *         self.scm = scm
  * 
  *         self.cpu = cpu             # <<<<<<<<<<<<<<
  *         self.bsize = (self.ix[1] - self.ix[0]) * (self.iy[1] - self.iy[0]) * (self.iz[1] - self.iz[0])
  *         if self.bsize > tsize and self.cpu > 1:
  */
   __pyx_v_self->cpu = __pyx_v_cpu;
 
-  /* "libfds/fields.pyx":269
+  /* "libfds/fields.pyx":270
  * 
  *         self.cpu = cpu
  *         self.bsize = (self.ix[1] - self.ix[0]) * (self.iy[1] - self.iy[0]) * (self.iz[1] - self.iz[0])             # <<<<<<<<<<<<<<
  *         if self.bsize > tsize and self.cpu > 1:
  *             self.mp = True
  */
   __pyx_v_self->bsize = (((__pyx_v_self->ix.f1 - __pyx_v_self->ix.f0) * (__pyx_v_self->iy.f1 - __pyx_v_self->iy.f0)) * (__pyx_v_self->iz.f1 - __pyx_v_self->iz.f0));
 
-  /* "libfds/fields.pyx":270
+  /* "libfds/fields.pyx":271
  *         self.cpu = cpu
  *         self.bsize = (self.ix[1] - self.ix[0]) * (self.iy[1] - self.iy[0]) * (self.iz[1] - self.iz[0])
  *         if self.bsize > tsize and self.cpu > 1:             # <<<<<<<<<<<<<<
  *             self.mp = True
  *         else:
  */
   __pyx_t_2 = ((__pyx_v_self->bsize > __pyx_v_tsize) != 0);
@@ -9094,60 +9096,60 @@
     goto __pyx_L4_bool_binop_done;
   }
   __pyx_t_2 = ((__pyx_v_self->cpu > 1) != 0);
   __pyx_t_1 = __pyx_t_2;
   __pyx_L4_bool_binop_done:;
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":271
+    /* "libfds/fields.pyx":272
  *         self.bsize = (self.ix[1] - self.ix[0]) * (self.iy[1] - self.iy[0]) * (self.iz[1] - self.iz[0])
  *         if self.bsize > tsize and self.cpu > 1:
  *             self.mp = True             # <<<<<<<<<<<<<<
  *         else:
  *             self.mp = False
  */
     __pyx_v_self->mp = 1;
 
-    /* "libfds/fields.pyx":270
+    /* "libfds/fields.pyx":271
  *         self.cpu = cpu
  *         self.bsize = (self.ix[1] - self.ix[0]) * (self.iy[1] - self.iy[0]) * (self.iz[1] - self.iz[0])
  *         if self.bsize > tsize and self.cpu > 1:             # <<<<<<<<<<<<<<
  *             self.mp = True
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":273
+  /* "libfds/fields.pyx":274
  *             self.mp = True
  *         else:
  *             self.mp = False             # <<<<<<<<<<<<<<
  * 
  *     def __str__(self):
  */
   /*else*/ {
     __pyx_v_self->mp = 0;
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":258
+  /* "libfds/fields.pyx":259
  * cdef class Domain3d:
  * 
  *     def __cinit__(self, (Py_ssize_t, Py_ssize_t) ix, (Py_ssize_t, Py_ssize_t) iy, (Py_ssize_t, Py_ssize_t) iz, str scm, Py_ssize_t cpu):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t tsize = 2000
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":275
+/* "libfds/fields.pyx":276
  *             self.mp = False
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return f'Coordinates : ({self.ix}, {self.iy}, {self.iz}) - mp : {self.mp}'
  * 
  */
 
@@ -9173,86 +9175,86 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__str__", 0);
 
-  /* "libfds/fields.pyx":276
+  /* "libfds/fields.pyx":277
  * 
  *     def __str__(self):
  *         return f'Coordinates : ({self.ix}, {self.iy}, {self.iz}) - mp : {self.mp}'             # <<<<<<<<<<<<<<
  * 
  *     def __repr__(self):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyTuple_New(8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_2 = 0;
   __pyx_t_3 = 127;
   __Pyx_INCREF(__pyx_kp_u_Coordinates);
   __pyx_t_2 += 15;
   __Pyx_GIVEREF(__pyx_kp_u_Coordinates);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_kp_u_Coordinates);
-  __pyx_t_4 = __pyx_convert__to_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_v_self->ix); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_4 = __pyx_convert__to_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_v_self->ix); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
   __pyx_t_5 = 0;
   __Pyx_INCREF(__pyx_kp_u__5);
   __pyx_t_2 += 2;
   __Pyx_GIVEREF(__pyx_kp_u__5);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_kp_u__5);
-  __pyx_t_5 = __pyx_convert__to_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_v_self->iy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_5 = __pyx_convert__to_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_v_self->iy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_t_5, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_FormatSimple(__pyx_t_5, __pyx_empty_unicode); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_4) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 3, __pyx_t_4);
   __pyx_t_4 = 0;
   __Pyx_INCREF(__pyx_kp_u__5);
   __pyx_t_2 += 2;
   __Pyx_GIVEREF(__pyx_kp_u__5);
   PyTuple_SET_ITEM(__pyx_t_1, 4, __pyx_kp_u__5);
-  __pyx_t_4 = __pyx_convert__to_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_v_self->iz); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_4 = __pyx_convert__to_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_v_self->iz); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_FormatSimple(__pyx_t_4, __pyx_empty_unicode); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_3 = (__Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) > __pyx_t_3) ? __Pyx_PyUnicode_MAX_CHAR_VALUE(__pyx_t_5) : __pyx_t_3;
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 5, __pyx_t_5);
   __pyx_t_5 = 0;
   __Pyx_INCREF(__pyx_kp_u_mp);
   __pyx_t_2 += 9;
   __Pyx_GIVEREF(__pyx_kp_u_mp);
   PyTuple_SET_ITEM(__pyx_t_1, 6, __pyx_kp_u_mp);
-  __pyx_t_5 = __Pyx_PyUnicode_FromBInt_int(__pyx_v_self->mp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyUnicode_FromBInt_int(__pyx_v_self->mp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_2 += __Pyx_PyUnicode_GET_LENGTH(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 7, __pyx_t_5);
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_1, 8, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyUnicode_Join(__pyx_t_1, 8, __pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 277, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_r = __pyx_t_5;
   __pyx_t_5 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":275
+  /* "libfds/fields.pyx":276
  *             self.mp = False
  * 
  *     def __str__(self):             # <<<<<<<<<<<<<<
  *         return f'Coordinates : ({self.ix}, {self.iy}, {self.iz}) - mp : {self.mp}'
  * 
  */
 
@@ -9265,15 +9267,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":278
+/* "libfds/fields.pyx":279
  *         return f'Coordinates : ({self.ix}, {self.iy}, {self.iz}) - mp : {self.mp}'
  * 
  *     def __repr__(self):             # <<<<<<<<<<<<<<
  *         return self.__str__()
  * 
  */
 
@@ -9297,44 +9299,44 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__repr__", 0);
 
-  /* "libfds/fields.pyx":279
+  /* "libfds/fields.pyx":280
  * 
  *     def __repr__(self):
  *         return self.__str__()             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_str); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 279, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(((PyObject *)__pyx_v_self), __pyx_n_s_str); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 279, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":278
+  /* "libfds/fields.pyx":279
  *         return f'Coordinates : ({self.ix}, {self.iy}, {self.iz}) - mp : {self.mp}'
  * 
  *     def __repr__(self):             # <<<<<<<<<<<<<<
  *         return self.__str__()
  * 
  */
 
@@ -9460,15 +9462,15 @@
   __Pyx_AddTraceback("libfds.fields.Domain3d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":285
+/* "libfds/fields.pyx":286
  * cdef class Monopole2d:
  * 
  *     def __cinit__(self, double[:, ::1] profile, double[::1] evolution):             # <<<<<<<<<<<<<<
  * 
  *         self.profile = profile
  */
 
@@ -9502,32 +9504,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_profile)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_evolution)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, 1); __PYX_ERR(0, 285, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, 1); __PYX_ERR(0, 286, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 285, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 286, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_profile = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_profile.memview)) __PYX_ERR(0, 285, __pyx_L3_error)
-    __pyx_v_evolution = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_evolution.memview)) __PYX_ERR(0, 285, __pyx_L3_error)
+    __pyx_v_profile = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_profile.memview)) __PYX_ERR(0, 286, __pyx_L3_error)
+    __pyx_v_evolution = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_evolution.memview)) __PYX_ERR(0, 286, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 285, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 286, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Monopole2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_10Monopole2d___cinit__(((struct __pyx_obj_6libfds_6fields_Monopole2d *)__pyx_v_self), __pyx_v_profile, __pyx_v_evolution);
 
@@ -9537,37 +9539,37 @@
 }
 
 static int __pyx_pf_6libfds_6fields_10Monopole2d___cinit__(struct __pyx_obj_6libfds_6fields_Monopole2d *__pyx_v_self, __Pyx_memviewslice __pyx_v_profile, __Pyx_memviewslice __pyx_v_evolution) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fields.pyx":287
+  /* "libfds/fields.pyx":288
  *     def __cinit__(self, double[:, ::1] profile, double[::1] evolution):
  * 
  *         self.profile = profile             # <<<<<<<<<<<<<<
  *         self.evolution = evolution
  * 
  */
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->profile, 0);
   __PYX_INC_MEMVIEW(&__pyx_v_profile, 0);
   __pyx_v_self->profile = __pyx_v_profile;
 
-  /* "libfds/fields.pyx":288
+  /* "libfds/fields.pyx":289
  * 
  *         self.profile = profile
  *         self.evolution = evolution             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->evolution, 0);
   __PYX_INC_MEMVIEW(&__pyx_v_evolution, 0);
   __pyx_v_self->evolution = __pyx_v_evolution;
 
-  /* "libfds/fields.pyx":285
+  /* "libfds/fields.pyx":286
  * cdef class Monopole2d:
  * 
  *     def __cinit__(self, double[:, ::1] profile, double[::1] evolution):             # <<<<<<<<<<<<<<
  * 
  *         self.profile = profile
  */
 
@@ -9688,15 +9690,15 @@
   __Pyx_AddTraceback("libfds.fields.Monopole2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":294
+/* "libfds/fields.pyx":295
  * cdef class Monopole3d:
  * 
  *     def __cinit__(self, double[:, :, ::1] profile, double[::1] evolution):             # <<<<<<<<<<<<<<
  * 
  *         self.profile = profile
  */
 
@@ -9730,32 +9732,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_profile)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_evolution)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, 1); __PYX_ERR(0, 294, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, 1); __PYX_ERR(0, 295, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 294, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 295, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_profile = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_profile.memview)) __PYX_ERR(0, 294, __pyx_L3_error)
-    __pyx_v_evolution = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_evolution.memview)) __PYX_ERR(0, 294, __pyx_L3_error)
+    __pyx_v_profile = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_profile.memview)) __PYX_ERR(0, 295, __pyx_L3_error)
+    __pyx_v_evolution = __Pyx_PyObject_to_MemoryviewSlice_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_evolution.memview)) __PYX_ERR(0, 295, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 294, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 295, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Monopole3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_10Monopole3d___cinit__(((struct __pyx_obj_6libfds_6fields_Monopole3d *)__pyx_v_self), __pyx_v_profile, __pyx_v_evolution);
 
@@ -9765,37 +9767,37 @@
 }
 
 static int __pyx_pf_6libfds_6fields_10Monopole3d___cinit__(struct __pyx_obj_6libfds_6fields_Monopole3d *__pyx_v_self, __Pyx_memviewslice __pyx_v_profile, __Pyx_memviewslice __pyx_v_evolution) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fields.pyx":296
+  /* "libfds/fields.pyx":297
  *     def __cinit__(self, double[:, :, ::1] profile, double[::1] evolution):
  * 
  *         self.profile = profile             # <<<<<<<<<<<<<<
  *         self.evolution = evolution
  * 
  */
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->profile, 0);
   __PYX_INC_MEMVIEW(&__pyx_v_profile, 0);
   __pyx_v_self->profile = __pyx_v_profile;
 
-  /* "libfds/fields.pyx":297
+  /* "libfds/fields.pyx":298
  * 
  *         self.profile = profile
  *         self.evolution = evolution             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->evolution, 0);
   __PYX_INC_MEMVIEW(&__pyx_v_evolution, 0);
   __pyx_v_self->evolution = __pyx_v_evolution;
 
-  /* "libfds/fields.pyx":294
+  /* "libfds/fields.pyx":295
  * cdef class Monopole3d:
  * 
  *     def __cinit__(self, double[:, :, ::1] profile, double[::1] evolution):             # <<<<<<<<<<<<<<
  * 
  *         self.profile = profile
  */
 
@@ -9916,20 +9918,20 @@
   __Pyx_AddTraceback("libfds.fields.Monopole3d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":301
+/* "libfds/fields.pyx":302
  * 
  * 
  * cpdef Fields(cfg, msh):             # <<<<<<<<<<<<<<
+ *     """ Fields involved in nsfds3.
  * 
- *     if len(cfg.shape) == 2:
  */
 
 static PyObject *__pyx_pw_6libfds_6fields_1Fields(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_6libfds_6fields_Fields(PyObject *__pyx_v_cfg, PyObject *__pyx_v_msh, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
@@ -9937,89 +9939,89 @@
   int __pyx_t_3;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("Fields", 0);
 
-  /* "libfds/fields.pyx":303
- * cpdef Fields(cfg, msh):
- * 
+  /* "libfds/fields.pyx":312
+ *         Configuration of the solver
+ *     """
  *     if len(cfg.shape) == 2:             # <<<<<<<<<<<<<<
  *         return Fields2d(cfg, msh)
- * 
+ *     return Fields3d(cfg, msh)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_cfg, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_cfg, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 303, __pyx_L1_error)
+  __pyx_t_2 = PyObject_Length(__pyx_t_1); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1))) __PYX_ERR(0, 312, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_t_3 = ((__pyx_t_2 == 2) != 0);
   if (__pyx_t_3) {
 
-    /* "libfds/fields.pyx":304
- * 
+    /* "libfds/fields.pyx":313
+ *     """
  *     if len(cfg.shape) == 2:
  *         return Fields2d(cfg, msh)             # <<<<<<<<<<<<<<
- * 
  *     return Fields3d(cfg, msh)
+ * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_INCREF(__pyx_v_cfg);
     __Pyx_GIVEREF(__pyx_v_cfg);
     PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_v_cfg);
     __Pyx_INCREF(__pyx_v_msh);
     __Pyx_GIVEREF(__pyx_v_msh);
     PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_v_msh);
-    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Fields2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Fields2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 313, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_r = __pyx_t_4;
     __pyx_t_4 = 0;
     goto __pyx_L0;
 
-    /* "libfds/fields.pyx":303
- * cpdef Fields(cfg, msh):
- * 
+    /* "libfds/fields.pyx":312
+ *         Configuration of the solver
+ *     """
  *     if len(cfg.shape) == 2:             # <<<<<<<<<<<<<<
  *         return Fields2d(cfg, msh)
- * 
+ *     return Fields3d(cfg, msh)
  */
   }
 
-  /* "libfds/fields.pyx":306
+  /* "libfds/fields.pyx":314
+ *     if len(cfg.shape) == 2:
  *         return Fields2d(cfg, msh)
- * 
  *     return Fields3d(cfg, msh)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_INCREF(__pyx_v_cfg);
   __Pyx_GIVEREF(__pyx_v_cfg);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_v_cfg);
   __Pyx_INCREF(__pyx_v_msh);
   __Pyx_GIVEREF(__pyx_v_msh);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_v_msh);
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Fields3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Fields3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 314, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":301
+  /* "libfds/fields.pyx":302
  * 
  * 
  * cpdef Fields(cfg, msh):             # <<<<<<<<<<<<<<
+ *     """ Fields involved in nsfds3.
  * 
- *     if len(cfg.shape) == 2:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4);
   __Pyx_AddTraceback("libfds.fields.Fields", __pyx_clineno, __pyx_lineno, __pyx_filename);
@@ -10028,14 +10030,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_6fields_1Fields(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_6libfds_6fields_Fields[] = " Fields involved in nsfds3.\n\n    Parameters\n    ----------\n    cfg: nsfds3.solver.CfgSetup object\n        Configuration of the solver\n    msh: nsfds3.cpgrid.CartesianGrid or nsfds3.cpgrid.CurvilinearGrid\n        Configuration of the solver\n    ";
 static PyObject *__pyx_pw_6libfds_6fields_1Fields(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_cfg = 0;
   PyObject *__pyx_v_msh = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -10060,32 +10063,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cfg)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_msh)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("Fields", 1, 2, 2, 1); __PYX_ERR(0, 301, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("Fields", 1, 2, 2, 1); __PYX_ERR(0, 302, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Fields") < 0)) __PYX_ERR(0, 301, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "Fields") < 0)) __PYX_ERR(0, 302, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_cfg = values[0];
     __pyx_v_msh = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("Fields", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 301, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("Fields", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 302, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Fields", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_Fields(__pyx_self, __pyx_v_cfg, __pyx_v_msh);
 
@@ -10099,15 +10102,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("Fields", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fields_Fields(__pyx_v_cfg, __pyx_v_msh, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 301, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_Fields(__pyx_v_cfg, __pyx_v_msh, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10116,15 +10119,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":312
+/* "libfds/fields.pyx":320
  * cdef class Fields2d:
  * 
  *     def __init__(self, cfg, msh):             # <<<<<<<<<<<<<<
  * 
  *         self.msh = msh
  */
 
@@ -10158,32 +10161,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cfg)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_msh)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); __PYX_ERR(0, 312, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); __PYX_ERR(0, 320, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 312, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 320, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_cfg = values[0];
     __pyx_v_msh = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 312, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 320, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Fields2d.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_8Fields2d___init__(((struct __pyx_obj_6libfds_6fields_Fields2d *)__pyx_v_self), __pyx_v_cfg, __pyx_v_msh);
 
@@ -10193,412 +10196,445 @@
 }
 
 static int __pyx_pf_6libfds_6fields_8Fields2d___init__(struct __pyx_obj_6libfds_6fields_Fields2d *__pyx_v_self, PyObject *__pyx_v_cfg, PyObject *__pyx_v_msh) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "libfds/fields.pyx":314
+  /* "libfds/fields.pyx":322
  *     def __init__(self, cfg, msh):
  * 
  *         self.msh = msh             # <<<<<<<<<<<<<<
  *         self.cfg = cfg
  *         self.init_parameters()
  */
   __Pyx_INCREF(__pyx_v_msh);
   __Pyx_GIVEREF(__pyx_v_msh);
   __Pyx_GOTREF(__pyx_v_self->msh);
   __Pyx_DECREF(__pyx_v_self->msh);
   __pyx_v_self->msh = __pyx_v_msh;
 
-  /* "libfds/fields.pyx":315
+  /* "libfds/fields.pyx":323
  * 
  *         self.msh = msh
  *         self.cfg = cfg             # <<<<<<<<<<<<<<
  *         self.init_parameters()
  * 
  */
   __Pyx_INCREF(__pyx_v_cfg);
   __Pyx_GIVEREF(__pyx_v_cfg);
   __Pyx_GOTREF(__pyx_v_self->cfg);
   __Pyx_DECREF(__pyx_v_self->cfg);
   __pyx_v_self->cfg = __pyx_v_cfg;
 
-  /* "libfds/fields.pyx":316
+  /* "libfds/fields.pyx":324
  *         self.msh = msh
  *         self.cfg = cfg
  *         self.init_parameters()             # <<<<<<<<<<<<<<
  * 
  *         # Computational domain initialization
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_parameters(__pyx_v_self);
 
-  /* "libfds/fields.pyx":319
+  /* "libfds/fields.pyx":327
  * 
  *         # Computational domain initialization
  *         self.init_grid()             # <<<<<<<<<<<<<<
  *         self.init_bc()
  *         self.init_subdomains()
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_grid(__pyx_v_self);
 
-  /* "libfds/fields.pyx":320
+  /* "libfds/fields.pyx":328
  *         # Computational domain initialization
  *         self.init_grid()
  *         self.init_bc()             # <<<<<<<<<<<<<<
  *         self.init_subdomains()
  * 
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_bc(__pyx_v_self);
 
-  /* "libfds/fields.pyx":321
+  /* "libfds/fields.pyx":329
  *         self.init_grid()
  *         self.init_bc()
  *         self.init_subdomains()             # <<<<<<<<<<<<<<
  * 
  *         # Variable initialization
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_subdomains(__pyx_v_self);
 
-  /* "libfds/fields.pyx":324
+  /* "libfds/fields.pyx":332
  * 
  *         # Variable initialization
  *         self.init_field()             # <<<<<<<<<<<<<<
  *         self.init_sources()
  *         self.init_cvars()
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_field(__pyx_v_self);
 
-  /* "libfds/fields.pyx":325
+  /* "libfds/fields.pyx":333
  *         # Variable initialization
  *         self.init_field()
  *         self.init_sources()             # <<<<<<<<<<<<<<
  *         self.init_cvars()
  *         self.init_buffer()
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_sources(__pyx_v_self);
 
-  /* "libfds/fields.pyx":326
+  /* "libfds/fields.pyx":334
  *         self.init_field()
  *         self.init_sources()
  *         self.init_cvars()             # <<<<<<<<<<<<<<
  *         self.init_buffer()
  * 
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_cvars(__pyx_v_self);
 
-  /* "libfds/fields.pyx":327
+  /* "libfds/fields.pyx":335
  *         self.init_sources()
  *         self.init_cvars()
  *         self.init_buffer()             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_parameters(self):
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_buffer(__pyx_v_self);
 
-  /* "libfds/fields.pyx":312
+  /* "libfds/fields.pyx":320
  * cdef class Fields2d:
  * 
  *     def __init__(self, cfg, msh):             # <<<<<<<<<<<<<<
  * 
  *         self.msh = msh
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":329
+/* "libfds/fields.pyx":337
  *         self.init_buffer()
  * 
  *     cdef void init_parameters(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cpu = self.cfg.cpu
  */
 
 static void __pyx_f_6libfds_6fields_8Fields2d_init_parameters(struct __pyx_obj_6libfds_6fields_Fields2d *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
-  double __pyx_t_3;
-  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  double __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *(*__pyx_t_7)(PyObject *);
   double __pyx_t_8;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_parameters", 0);
 
-  /* "libfds/fields.pyx":331
+  /* "libfds/fields.pyx":339
  *     cdef void init_parameters(self):
  * 
  *         self.cpu = self.cfg.cpu             # <<<<<<<<<<<<<<
- *         self.c0 = self.cfg.c0
- *         self.gamma = self.cfg.gamma
+ *         self.c0 = self.cfg.tp.c0
+ *         self.gamma = self.cfg.tp.gamma
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 331, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 339, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->cpu = __pyx_t_2;
 
-  /* "libfds/fields.pyx":332
+  /* "libfds/fields.pyx":340
  * 
  *         self.cpu = self.cfg.cpu
- *         self.c0 = self.cfg.c0             # <<<<<<<<<<<<<<
- *         self.gamma = self.cfg.gamma
- *         self.p0 = self.cfg.p0
+ *         self.c0 = self.cfg.tp.c0             # <<<<<<<<<<<<<<
+ *         self.gamma = self.cfg.tp.gamma
+ *         self.p0 = self.cfg.tp.p0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_c0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 340, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 332, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_c0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 340, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->c0 = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 340, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->c0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":333
+  /* "libfds/fields.pyx":341
  *         self.cpu = self.cfg.cpu
- *         self.c0 = self.cfg.c0
- *         self.gamma = self.cfg.gamma             # <<<<<<<<<<<<<<
- *         self.p0 = self.cfg.p0
- *         self.T0 = self.cfg.T0
+ *         self.c0 = self.cfg.tp.c0
+ *         self.gamma = self.cfg.tp.gamma             # <<<<<<<<<<<<<<
+ *         self.p0 = self.cfg.tp.p0
+ *         self.T0 = self.cfg.tp.T0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_gamma); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 341, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_gamma); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 341, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 333, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 341, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->gamma = __pyx_t_3;
+  __pyx_v_self->gamma = __pyx_t_4;
 
-  /* "libfds/fields.pyx":334
- *         self.c0 = self.cfg.c0
- *         self.gamma = self.cfg.gamma
- *         self.p0 = self.cfg.p0             # <<<<<<<<<<<<<<
- *         self.T0 = self.cfg.T0
- *         self.rho0 = self.cfg.rho0
+  /* "libfds/fields.pyx":342
+ *         self.c0 = self.cfg.tp.c0
+ *         self.gamma = self.cfg.tp.gamma
+ *         self.p0 = self.cfg.tp.p0             # <<<<<<<<<<<<<<
+ *         self.T0 = self.cfg.tp.T0
+ *         self.rho0 = self.cfg.tp.rho0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_p0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 334, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_p0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 342, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->p0 = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 342, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->p0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":335
- *         self.gamma = self.cfg.gamma
- *         self.p0 = self.cfg.p0
- *         self.T0 = self.cfg.T0             # <<<<<<<<<<<<<<
- *         self.rho0 = self.cfg.rho0
+  /* "libfds/fields.pyx":343
+ *         self.gamma = self.cfg.tp.gamma
+ *         self.p0 = self.cfg.tp.p0
+ *         self.T0 = self.cfg.tp.T0             # <<<<<<<<<<<<<<
+ *         self.rho0 = self.cfg.tp.rho0
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_T0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_T0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 335, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 343, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->T0 = __pyx_t_3;
+  __pyx_v_self->T0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":336
- *         self.p0 = self.cfg.p0
- *         self.T0 = self.cfg.T0
- *         self.rho0 = self.cfg.rho0             # <<<<<<<<<<<<<<
+  /* "libfds/fields.pyx":344
+ *         self.p0 = self.cfg.tp.p0
+ *         self.T0 = self.cfg.tp.T0
+ *         self.rho0 = self.cfg.tp.rho0             # <<<<<<<<<<<<<<
  * 
- *         self.mu0 = self.cfg.mu0
+ *         self.mu0 = self.cfg.tp.mu0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_rho0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 336, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_rho0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->rho0 = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 344, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->rho0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":338
- *         self.rho0 = self.cfg.rho0
+  /* "libfds/fields.pyx":346
+ *         self.rho0 = self.cfg.tp.rho0
  * 
- *         self.mu0 = self.cfg.mu0             # <<<<<<<<<<<<<<
- *         self.Ssu = self.cfg.Ssu
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
+ *         self.mu0 = self.cfg.tp.mu0             # <<<<<<<<<<<<<<
+ *         self.Ssu = self.cfg.tp.Ssu
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_mu0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 346, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mu0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 338, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 346, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->mu0 = __pyx_t_3;
+  __pyx_v_self->mu0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":339
+  /* "libfds/fields.pyx":347
  * 
- *         self.mu0 = self.cfg.mu0
- *         self.Ssu = self.cfg.Ssu             # <<<<<<<<<<<<<<
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
- *         self.cpmcv = self.cfg.CP - self.cfg.CV
+ *         self.mu0 = self.cfg.tp.mu0
+ *         self.Ssu = self.cfg.tp.Ssu             # <<<<<<<<<<<<<<
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_Ssu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 339, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Ssu); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 347, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->Ssu = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 347, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->Ssu = __pyx_t_4;
 
-  /* "libfds/fields.pyx":340
- *         self.mu0 = self.cfg.mu0
- *         self.Ssu = self.cfg.Ssu
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl             # <<<<<<<<<<<<<<
- *         self.cpmcv = self.cfg.CP - self.cfg.CV
+  /* "libfds/fields.pyx":348
+ *         self.mu0 = self.cfg.tp.mu0
+ *         self.Ssu = self.cfg.tp.Ssu
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl             # <<<<<<<<<<<<<<
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv
  *         self.gaminusone = self.gamma - 1.
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_CP); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 340, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_Cp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 340, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_prandtl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 340, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 340, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_prandtl); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 340, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_v_self->cppr = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 348, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->cppr = __pyx_t_4;
 
-  /* "libfds/fields.pyx":341
- *         self.Ssu = self.cfg.Ssu
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
- *         self.cpmcv = self.cfg.CP - self.cfg.CV             # <<<<<<<<<<<<<<
+  /* "libfds/fields.pyx":349
+ *         self.Ssu = self.cfg.tp.Ssu
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv             # <<<<<<<<<<<<<<
  *         self.gaminusone = self.gamma - 1.
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_CP); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 341, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Cp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_CV); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 341, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Cv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 341, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 341, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_self->cpmcv = __pyx_t_3;
+  __pyx_v_self->cpmcv = __pyx_t_4;
 
-  /* "libfds/fields.pyx":342
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
- *         self.cpmcv = self.cfg.CP - self.cfg.CV
+  /* "libfds/fields.pyx":350
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv
  *         self.gaminusone = self.gamma - 1.             # <<<<<<<<<<<<<<
  * 
  *         # Selective filter
  */
   __pyx_v_self->gaminusone = (__pyx_v_self->gamma - 1.);
 
-  /* "libfds/fields.pyx":345
+  /* "libfds/fields.pyx":353
  * 
  *         # Selective filter
  *         self.xnu_n = self.cfg.flt_xnu_n             # <<<<<<<<<<<<<<
  *         self.xnu_0 = self.cfg.flt_xnu_0
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 345, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 345, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_self->xnu_n = __pyx_t_3;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 353, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->xnu_n = __pyx_t_4;
 
-  /* "libfds/fields.pyx":346
+  /* "libfds/fields.pyx":354
  *         # Selective filter
  *         self.xnu_n = self.cfg.flt_xnu_n
  *         self.xnu_0 = self.cfg.flt_xnu_0             # <<<<<<<<<<<<<<
  * 
  *         # flow
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 346, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 346, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_self->xnu_0 = __pyx_t_3;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 354, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->xnu_0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":349
+  /* "libfds/fields.pyx":357
  * 
  *         # flow
  *         self.U0, self.V0 = self.cfg.flw_components             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_grid(self):
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flw_components); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 349, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
-    PyObject* sequence = __pyx_t_4;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flw_components); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 357, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
+    PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 349, __pyx_L1_error)
+      __PYX_ERR(0, 357, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
-      __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
+      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
     } else {
-      __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
+      __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
     }
-    __Pyx_INCREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_5);
     #else
-    __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 349, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 357, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     #endif
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_6 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 349, __pyx_L1_error)
+    __pyx_t_6 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_7 = Py_TYPE(__pyx_t_6)->tp_iternext;
-    index = 0; __pyx_t_1 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
-    __Pyx_GOTREF(__pyx_t_1);
+    index = 0; __pyx_t_3 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
+    __Pyx_GOTREF(__pyx_t_3);
     index = 1; __pyx_t_5 = __pyx_t_7(__pyx_t_6); if (unlikely(!__pyx_t_5)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_5);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 2) < 0) __PYX_ERR(0, 349, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_7(__pyx_t_6), 2) < 0) __PYX_ERR(0, 357, __pyx_L1_error)
     __pyx_t_7 = NULL;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_7 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 349, __pyx_L1_error)
+    __PYX_ERR(0, 357, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 349, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_8 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 349, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 357, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_8 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_8 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 357, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_v_self->U0 = __pyx_t_3;
+  __pyx_v_self->U0 = __pyx_t_4;
   __pyx_v_self->V0 = __pyx_t_8;
 
-  /* "libfds/fields.pyx":329
+  /* "libfds/fields.pyx":337
  *         self.init_buffer()
  * 
  *     cdef void init_parameters(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cpu = self.cfg.cpu
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":351
+/* "libfds/fields.pyx":359
  *         self.U0, self.V0 = self.cfg.flw_components
  * 
  *     cdef void init_grid(self):             # <<<<<<<<<<<<<<
  * 
  *         self.nx, self.ny = self.msh.shape
  */
 
@@ -10616,268 +10652,268 @@
   __Pyx_memviewslice __pyx_t_10 = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_t_11;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_grid", 0);
 
-  /* "libfds/fields.pyx":353
+  /* "libfds/fields.pyx":361
  *     cdef void init_grid(self):
  * 
  *         self.nx, self.ny = self.msh.shape             # <<<<<<<<<<<<<<
  *         self.nsize = self.nx * self.ny
  *         self.init_spacial_steps()
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
     PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 2)) {
       if (size > 2) __Pyx_RaiseTooManyValuesError(2);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 353, __pyx_L1_error)
+      __PYX_ERR(0, 361, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
     } else {
       __pyx_t_2 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
     }
     __Pyx_INCREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_t_3);
     #else
-    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 353, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 353, __pyx_L1_error)
+    __pyx_t_4 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_5 = Py_TYPE(__pyx_t_4)->tp_iternext;
     index = 0; __pyx_t_2 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
     index = 1; __pyx_t_3 = __pyx_t_5(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_3);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_5(__pyx_t_4), 2) < 0) __PYX_ERR(0, 353, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_5(__pyx_t_4), 2) < 0) __PYX_ERR(0, 361, __pyx_L1_error)
     __pyx_t_5 = NULL;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __pyx_t_5 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 353, __pyx_L1_error)
+    __PYX_ERR(0, 361, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
-  __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_6 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 353, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_self->nx = __pyx_t_6;
   __pyx_v_self->ny = __pyx_t_7;
 
-  /* "libfds/fields.pyx":354
+  /* "libfds/fields.pyx":362
  * 
  *         self.nx, self.ny = self.msh.shape
  *         self.nsize = self.nx * self.ny             # <<<<<<<<<<<<<<
  *         self.init_spacial_steps()
  * 
  */
   __pyx_v_self->nsize = (__pyx_v_self->nx * __pyx_v_self->ny);
 
-  /* "libfds/fields.pyx":355
+  /* "libfds/fields.pyx":363
  *         self.nx, self.ny = self.msh.shape
  *         self.nsize = self.nx * self.ny
  *         self.init_spacial_steps()             # <<<<<<<<<<<<<<
  * 
  *         self.mesh_type = self.msh.mesh_type.lower()
  */
   __pyx_f_6libfds_6fields_8Fields2d_init_spacial_steps(__pyx_v_self);
 
-  /* "libfds/fields.pyx":357
+  /* "libfds/fields.pyx":365
  *         self.init_spacial_steps()
  * 
  *         self.mesh_type = self.msh.mesh_type.lower()             # <<<<<<<<<<<<<<
  *         self.grid = 'physical'
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_mesh_type); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 357, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_mesh_type); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 357, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_lower); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3) : __Pyx_PyObject_CallNoArg(__pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 357, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 357, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->mesh_type);
   __Pyx_DECREF(__pyx_v_self->mesh_type);
   __pyx_v_self->mesh_type = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":358
+  /* "libfds/fields.pyx":366
  * 
  *         self.mesh_type = self.msh.mesh_type.lower()
  *         self.grid = 'physical'             # <<<<<<<<<<<<<<
  * 
  *         if self.mesh_type == 'curvilinear':
  */
   __Pyx_INCREF(__pyx_n_u_physical);
   __Pyx_GIVEREF(__pyx_n_u_physical);
   __Pyx_GOTREF(__pyx_v_self->grid);
   __Pyx_DECREF(__pyx_v_self->grid);
   __pyx_v_self->grid = __pyx_n_u_physical;
 
-  /* "libfds/fields.pyx":360
+  /* "libfds/fields.pyx":368
  *         self.grid = 'physical'
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du
  */
-  __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_8 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 368, __pyx_L1_error)
   __pyx_t_9 = (__pyx_t_8 != 0);
   if (__pyx_t_9) {
 
-    /* "libfds/fields.pyx":361
+    /* "libfds/fields.pyx":369
  * 
  *         if self.mesh_type == 'curvilinear':
  *             self.J = self.msh.J             # <<<<<<<<<<<<<<
  *             self.dx_du = self.msh.dx_du
  *             self.dx_dv = self.msh.dx_dv
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_J); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_J); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 361, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 369, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->J, 0);
     __pyx_v_self->J = __pyx_t_10;
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "libfds/fields.pyx":362
+    /* "libfds/fields.pyx":370
  *         if self.mesh_type == 'curvilinear':
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du             # <<<<<<<<<<<<<<
  *             self.dx_dv = self.msh.dx_dv
  *             self.dy_du = self.msh.dy_du
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 362, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 370, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dx_du, 0);
     __pyx_v_self->dx_du = __pyx_t_10;
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "libfds/fields.pyx":363
+    /* "libfds/fields.pyx":371
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du
  *             self.dx_dv = self.msh.dx_dv             # <<<<<<<<<<<<<<
  *             self.dy_du = self.msh.dy_du
  *             self.dy_dv = self.msh.dy_dv
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 363, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 371, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dx_dv, 0);
     __pyx_v_self->dx_dv = __pyx_t_10;
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "libfds/fields.pyx":364
+    /* "libfds/fields.pyx":372
  *             self.dx_du = self.msh.dx_du
  *             self.dx_dv = self.msh.dx_dv
  *             self.dy_du = self.msh.dy_du             # <<<<<<<<<<<<<<
  *             self.dy_dv = self.msh.dy_dv
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 364, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 372, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 364, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 372, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dy_du, 0);
     __pyx_v_self->dy_du = __pyx_t_10;
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "libfds/fields.pyx":365
+    /* "libfds/fields.pyx":373
  *             self.dx_dv = self.msh.dx_dv
  *             self.dy_du = self.msh.dy_du
  *             self.dy_dv = self.msh.dy_dv             # <<<<<<<<<<<<<<
  * 
  *         # Buffer zone
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 365, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 373, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dy_dv, 0);
     __pyx_v_self->dy_dv = __pyx_t_10;
     __pyx_t_10.memview = NULL;
     __pyx_t_10.data = NULL;
 
-    /* "libfds/fields.pyx":360
+    /* "libfds/fields.pyx":368
  *         self.grid = 'physical'
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du
  */
   }
 
-  /* "libfds/fields.pyx":368
+  /* "libfds/fields.pyx":376
  * 
  *         # Buffer zone
  *         self.bz_n = self.cfg.bz_n             # <<<<<<<<<<<<<<
  *         self.bz_forder = self.cfg.bz_filter_order
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 368, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 376, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->bz_n = __pyx_t_7;
 
-  /* "libfds/fields.pyx":369
+  /* "libfds/fields.pyx":377
  *         # Buffer zone
  *         self.bz_n = self.cfg.bz_n
  *         self.bz_forder = self.cfg.bz_filter_order             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_spacial_steps(self):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_filter_order); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_filter_order); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 377, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 377, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->bz_forder = __pyx_t_11;
 
-  /* "libfds/fields.pyx":351
+  /* "libfds/fields.pyx":359
  *         self.U0, self.V0 = self.cfg.flw_components
  * 
  *     cdef void init_grid(self):             # <<<<<<<<<<<<<<
  * 
  *         self.nx, self.ny = self.msh.shape
  */
 
@@ -10890,15 +10926,15 @@
   __Pyx_XDECREF(__pyx_t_4);
   __PYX_XDEC_MEMVIEW(&__pyx_t_10, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_grid", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":371
+/* "libfds/fields.pyx":379
  *         self.bz_forder = self.cfg.bz_filter_order
  * 
  *     cdef void init_spacial_steps(self):             # <<<<<<<<<<<<<<
  * 
  *         self.flag_x = self.msh.flag_x
  */
 
@@ -10916,191 +10952,191 @@
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_spacial_steps", 0);
 
-  /* "libfds/fields.pyx":373
+  /* "libfds/fields.pyx":381
  *     cdef void init_spacial_steps(self):
  * 
  *         self.flag_x = self.msh.flag_x             # <<<<<<<<<<<<<<
  *         self.flag_y = self.msh.flag_y
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 373, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 381, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 373, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 381, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->flag_x);
   __Pyx_DECREF(__pyx_v_self->flag_x);
   __pyx_v_self->flag_x = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":374
+  /* "libfds/fields.pyx":382
  * 
  *         self.flag_x = self.msh.flag_x
  *         self.flag_y = self.msh.flag_y             # <<<<<<<<<<<<<<
  * 
  *         self.odx = 1. / self.msh.dx
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 374, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 382, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 374, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 382, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->flag_y);
   __Pyx_DECREF(__pyx_v_self->flag_y);
   __pyx_v_self->flag_y = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":376
+  /* "libfds/fields.pyx":384
  *         self.flag_y = self.msh.flag_y
  * 
  *         self.odx = 1. / self.msh.dx             # <<<<<<<<<<<<<<
  *         self.ody = 1. / self.msh.dy
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 376, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 376, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 376, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 384, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_self->odx = __pyx_t_3;
 
-  /* "libfds/fields.pyx":377
+  /* "libfds/fields.pyx":385
  * 
  *         self.odx = 1. / self.msh.dx
  *         self.ody = 1. / self.msh.dy             # <<<<<<<<<<<<<<
  * 
  *         self.odxdt = self.odx * self.cfg.dt
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_2, 1., 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 377, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_2, 1., 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 377, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 385, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->ody = __pyx_t_3;
 
-  /* "libfds/fields.pyx":379
+  /* "libfds/fields.pyx":387
  *         self.ody = 1. / self.msh.dy
  * 
  *         self.odxdt = self.odx * self.cfg.dt             # <<<<<<<<<<<<<<
  *         self.odydt = self.ody * self.cfg.dt
  * 
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->odx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->odx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 387, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 387, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_self->odxdt = __pyx_t_3;
 
-  /* "libfds/fields.pyx":380
+  /* "libfds/fields.pyx":388
  * 
  *         self.odxdt = self.odx * self.cfg.dt
  *         self.odydt = self.ody * self.cfg.dt             # <<<<<<<<<<<<<<
  * 
  *         self.odxdtrk = 0.
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_self->ody); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 380, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_self->ody); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 380, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyNumber_Multiply(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 380, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Multiply(__pyx_t_4, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 380, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 388, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->odydt = __pyx_t_3;
 
-  /* "libfds/fields.pyx":382
+  /* "libfds/fields.pyx":390
  *         self.odydt = self.ody * self.cfg.dt
  * 
  *         self.odxdtrk = 0.             # <<<<<<<<<<<<<<
  *         self.odydtrk = 0.
  * 
  */
   __pyx_v_self->odxdtrk = 0.;
 
-  /* "libfds/fields.pyx":383
+  /* "libfds/fields.pyx":391
  * 
  *         self.odxdtrk = 0.
  *         self.odydtrk = 0.             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_x == 'v':
  */
   __pyx_v_self->odydtrk = 0.;
 
-  /* "libfds/fields.pyx":385
+  /* "libfds/fields.pyx":393
  *         self.odydtrk = 0.
  * 
  *         if self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 385, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 393, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":386
+    /* "libfds/fields.pyx":394
  * 
  *         if self.flag_x == 'v':
  *             self.odx_v = odu(self.msh.x)             # <<<<<<<<<<<<<<
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_odu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_odu); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 394, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 394, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 386, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 394, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odx_v, 0);
     __pyx_v_self->odx_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":387
+    /* "libfds/fields.pyx":395
  *         if self.flag_x == 'v':
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)             # <<<<<<<<<<<<<<
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->odx_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->odx_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_9 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -11109,158 +11145,158 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_4, __pyx_t_7};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_4, __pyx_t_7};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 387, __pyx_L1_error)
+      __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 395, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       if (__pyx_t_9) {
         __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_4);
       PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_t_4);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_7);
       __pyx_t_4 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_11, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 387, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 395, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odxdt_v, 0);
     __pyx_v_self->odxdt_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":388
+    /* "libfds/fields.pyx":396
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_y == 'v':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 388, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 388, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 388, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 388, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 388, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 396, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odxdtrk_v, 0);
     __pyx_v_self->odxdtrk_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":385
+    /* "libfds/fields.pyx":393
  *         self.odydtrk = 0.
  * 
  *         if self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  */
   }
 
-  /* "libfds/fields.pyx":390
+  /* "libfds/fields.pyx":398
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  * 
  *         if self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 390, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 398, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":391
+    /* "libfds/fields.pyx":399
  * 
  *         if self.flag_y == 'v':
  *             self.ody_v = odu(self.msh.y)             # <<<<<<<<<<<<<<
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_odu); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_odu); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 391, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 391, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 399, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->ody_v, 0);
     __pyx_v_self->ody_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":392
+    /* "libfds/fields.pyx":400
  *         if self.flag_y == 'v':
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)             # <<<<<<<<<<<<<<
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_mult); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_mult); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 400, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->ody_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->ody_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 400, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 400, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_4 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -11269,102 +11305,102 @@
         __Pyx_DECREF_SET(__pyx_t_11, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_7};
-      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[3] = {__pyx_t_4, __pyx_t_2, __pyx_t_7};
-      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_9 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 392, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       if (__pyx_t_4) {
         __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_4); __pyx_t_4 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_10, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_10, __pyx_t_7);
       __pyx_t_2 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_9, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     }
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 392, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 400, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odydt_v, 0);
     __pyx_v_self->odydt_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":393
+    /* "libfds/fields.pyx":401
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_bc(self):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_7, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_11);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 393, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 401, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odydtrk_v, 0);
     __pyx_v_self->odydtrk_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":390
+    /* "libfds/fields.pyx":398
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  * 
  *         if self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  */
   }
 
-  /* "libfds/fields.pyx":371
+  /* "libfds/fields.pyx":379
  *         self.bz_forder = self.cfg.bz_filter_order
  * 
  *     cdef void init_spacial_steps(self):             # <<<<<<<<<<<<<<
  * 
  *         self.flag_x = self.msh.flag_x
  */
 
@@ -11379,15 +11415,15 @@
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_spacial_steps", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":395
+/* "libfds/fields.pyx":403
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  * 
  *     cdef void init_bc(self):             # <<<<<<<<<<<<<<
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  */
 
@@ -11407,79 +11443,79 @@
   int __pyx_t_11;
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_bc", 0);
 
-  /* "libfds/fields.pyx":398
+  /* "libfds/fields.pyx":406
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:             # <<<<<<<<<<<<<<
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 406, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_t_1, 0, 2, NULL, NULL, &__pyx_slice__14, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 398, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_t_1, 0, 2, NULL, NULL, &__pyx_slice__14, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 406, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 398, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 406, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
 
-    /* "libfds/fields.pyx":399
+    /* "libfds/fields.pyx":407
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))             # <<<<<<<<<<<<<<
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->nx - 5)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->nx - 5)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
     __pyx_t_1 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_7)) {
@@ -11488,85 +11524,85 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 399, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->P11x, 0);
     __pyx_v_self->P11x = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":400
+    /* "libfds/fields.pyx":408
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 400, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 400, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 408, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":401
+      /* "libfds/fields.pyx":409
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))             # <<<<<<<<<<<<<<
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->nx - 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->nx - 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_7);
       __pyx_t_5 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_1)) {
@@ -11575,72 +11611,72 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 401, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 409, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P3x, 0);
       __pyx_v_self->P3x = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":402
+      /* "libfds/fields.pyx":410
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))             # <<<<<<<<<<<<<<
  * 
  *         if 'P' in self.msh.bc[2:]:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyInt_FromSsize_t((__pyx_v_self->nx - 2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t((__pyx_v_self->nx - 2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
       __pyx_t_6 = 0;
       __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
         if (likely(__pyx_t_5)) {
@@ -11649,107 +11685,107 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_7, function);
         }
       }
       __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 402, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 402, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 410, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P5x, 0);
       __pyx_v_self->P5x = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":400
+      /* "libfds/fields.pyx":408
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  */
     }
 
-    /* "libfds/fields.pyx":398
+    /* "libfds/fields.pyx":406
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:             # <<<<<<<<<<<<<<
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  */
   }
 
-  /* "libfds/fields.pyx":404
+  /* "libfds/fields.pyx":412
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[2:]:             # <<<<<<<<<<<<<<
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 412, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_2, 2, 0, NULL, NULL, &__pyx_slice__18, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_2, 2, 0, NULL, NULL, &__pyx_slice__18, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 412, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_7, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_7, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 412, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = (__pyx_t_4 != 0);
   if (__pyx_t_3) {
 
-    /* "libfds/fields.pyx":405
+    /* "libfds/fields.pyx":413
  * 
  *         if 'P' in self.msh.bc[2:]:
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))             # <<<<<<<<<<<<<<
  *             if self.cfg.cpt:
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyInt_FromSsize_t((__pyx_v_self->ny - 5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t((__pyx_v_self->ny - 5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_2 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_5 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
@@ -11758,85 +11794,85 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_7 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 405, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 405, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 413, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->P11y, 0);
     __pyx_v_self->P11y = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":406
+    /* "libfds/fields.pyx":414
  *         if 'P' in self.msh.bc[2:]:
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 406, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 414, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 406, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 414, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_3) {
 
-      /* "libfds/fields.pyx":407
+      /* "libfds/fields.pyx":415
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))             # <<<<<<<<<<<<<<
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->ny - 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->ny - 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_6);
       __pyx_t_1 = 0;
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_2)) {
@@ -11845,72 +11881,72 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 407, __pyx_L1_error)
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 407, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 415, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P3y, 0);
       __pyx_v_self->P3y = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":408
+      /* "libfds/fields.pyx":416
  *             if self.cfg.cpt:
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))             # <<<<<<<<<<<<<<
  * 
  *         # Wall and NR BC
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->ny - 2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->ny - 2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
       __pyx_t_5 = 0;
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_1)) {
@@ -11919,270 +11955,270 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_7 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 408, __pyx_L1_error)
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 408, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 416, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P5y, 0);
       __pyx_v_self->P5y = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":406
+      /* "libfds/fields.pyx":414
  *         if 'P' in self.msh.bc[2:]:
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  */
     }
 
-    /* "libfds/fields.pyx":404
+    /* "libfds/fields.pyx":412
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[2:]:             # <<<<<<<<<<<<<<
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  */
   }
 
-  /* "libfds/fields.pyx":411
+  /* "libfds/fields.pyx":419
  * 
  *         # Wall and NR BC
  *         self.bc = []             # <<<<<<<<<<<<<<
  * 
  *         for face in self.msh.obstacles.faces:
  */
-  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 411, __pyx_L1_error)
+  __pyx_t_7 = PyList_New(0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 419, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_7);
   __Pyx_GOTREF(__pyx_v_self->bc);
   __Pyx_DECREF(__pyx_v_self->bc);
   __pyx_v_self->bc = ((PyObject*)__pyx_t_7);
   __pyx_t_7 = 0;
 
-  /* "libfds/fields.pyx":413
+  /* "libfds/fields.pyx":421
  *         self.bc = []
  * 
  *         for face in self.msh.obstacles.faces:             # <<<<<<<<<<<<<<
  *             if not face.covered and not face.clamped:
  *                 self.bc.append(Face2d(self, face))
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 413, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_faces); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_faces); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 421, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
     __pyx_t_7 = __pyx_t_6; __Pyx_INCREF(__pyx_t_7); __pyx_t_9 = 0;
     __pyx_t_10 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 413, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 421, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 413, __pyx_L1_error)
+    __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 421, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   for (;;) {
     if (likely(!__pyx_t_10)) {
       if (likely(PyList_CheckExact(__pyx_t_7))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_7)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 413, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 421, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 413, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 421, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 421, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       }
     } else {
       __pyx_t_6 = __pyx_t_10(__pyx_t_7);
       if (unlikely(!__pyx_t_6)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 413, __pyx_L1_error)
+          else __PYX_ERR(0, 421, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_6);
     }
     __Pyx_XDECREF_SET(__pyx_v_face, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":414
+    /* "libfds/fields.pyx":422
  * 
  *         for face in self.msh.obstacles.faces:
  *             if not face.covered and not face.clamped:             # <<<<<<<<<<<<<<
  *                 self.bc.append(Face2d(self, face))
  * 
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_covered); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_covered); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 422, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 422, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_11 = ((!__pyx_t_4) != 0);
     if (__pyx_t_11) {
     } else {
       __pyx_t_3 = __pyx_t_11;
       goto __pyx_L10_bool_binop_done;
     }
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_clamped); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_clamped); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 422, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 414, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 422, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_4 = ((!__pyx_t_11) != 0);
     __pyx_t_3 = __pyx_t_4;
     __pyx_L10_bool_binop_done:;
     if (__pyx_t_3) {
 
-      /* "libfds/fields.pyx":415
+      /* "libfds/fields.pyx":423
  *         for face in self.msh.obstacles.faces:
  *             if not face.covered and not face.clamped:
  *                 self.bc.append(Face2d(self, face))             # <<<<<<<<<<<<<<
  * 
  *         for face in self.msh.bounds:
  */
       if (unlikely(__pyx_v_self->bc == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-        __PYX_ERR(0, 415, __pyx_L1_error)
+        __PYX_ERR(0, 423, __pyx_L1_error)
       }
-      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 415, __pyx_L1_error)
+      __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 423, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_INCREF(((PyObject *)__pyx_v_self));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
       PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_self));
       __Pyx_INCREF(__pyx_v_face);
       __Pyx_GIVEREF(__pyx_v_face);
       PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_face);
-      __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face2d), __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 415, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face2d), __pyx_t_6, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 423, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_2); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 415, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_2); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 423, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-      /* "libfds/fields.pyx":414
+      /* "libfds/fields.pyx":422
  * 
  *         for face in self.msh.obstacles.faces:
  *             if not face.covered and not face.clamped:             # <<<<<<<<<<<<<<
  *                 self.bc.append(Face2d(self, face))
  * 
  */
     }
 
-    /* "libfds/fields.pyx":413
+    /* "libfds/fields.pyx":421
  *         self.bc = []
  * 
  *         for face in self.msh.obstacles.faces:             # <<<<<<<<<<<<<<
  *             if not face.covered and not face.clamped:
  *                 self.bc.append(Face2d(self, face))
  */
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "libfds/fields.pyx":417
+  /* "libfds/fields.pyx":425
  *                 self.bc.append(Face2d(self, face))
  * 
  *         for face in self.msh.bounds:             # <<<<<<<<<<<<<<
  *             self.bc.append(Face2d(self, face))
  * 
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 417, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 425, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   if (likely(PyList_CheckExact(__pyx_t_7)) || PyTuple_CheckExact(__pyx_t_7)) {
     __pyx_t_2 = __pyx_t_7; __Pyx_INCREF(__pyx_t_2); __pyx_t_9 = 0;
     __pyx_t_10 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 425, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 417, __pyx_L1_error)
+    __pyx_t_10 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 425, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   for (;;) {
     if (likely(!__pyx_t_10)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 417, __pyx_L1_error)
+        __pyx_t_7 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 425, __pyx_L1_error)
         #else
-        __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 417, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 425, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 417, __pyx_L1_error)
+        __pyx_t_7 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_9); __Pyx_INCREF(__pyx_t_7); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 425, __pyx_L1_error)
         #else
-        __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 417, __pyx_L1_error)
+        __pyx_t_7 = PySequence_ITEM(__pyx_t_2, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 425, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         #endif
       }
     } else {
       __pyx_t_7 = __pyx_t_10(__pyx_t_2);
       if (unlikely(!__pyx_t_7)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 417, __pyx_L1_error)
+          else __PYX_ERR(0, 425, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_7);
     }
     __Pyx_XDECREF_SET(__pyx_v_face, __pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "libfds/fields.pyx":418
+    /* "libfds/fields.pyx":426
  * 
  *         for face in self.msh.bounds:
  *             self.bc.append(Face2d(self, face))             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_subdomains(self):
  */
     if (unlikely(__pyx_v_self->bc == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 418, __pyx_L1_error)
+      __PYX_ERR(0, 426, __pyx_L1_error)
     }
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 418, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_INCREF(((PyObject *)__pyx_v_self));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
     PyTuple_SET_ITEM(__pyx_t_7, 0, ((PyObject *)__pyx_v_self));
     __Pyx_INCREF(__pyx_v_face);
     __Pyx_GIVEREF(__pyx_v_face);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_v_face);
-    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face2d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 418, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face2d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_6); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 418, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_6); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 426, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":417
+    /* "libfds/fields.pyx":425
  *                 self.bc.append(Face2d(self, face))
  * 
  *         for face in self.msh.bounds:             # <<<<<<<<<<<<<<
  *             self.bc.append(Face2d(self, face))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":395
+  /* "libfds/fields.pyx":403
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  * 
  *     cdef void init_bc(self):             # <<<<<<<<<<<<<<
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  */
 
@@ -12197,15 +12233,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_bc", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_face);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":420
+/* "libfds/fields.pyx":428
  *             self.bc.append(Face2d(self, face))
  * 
  *     cdef void init_subdomains(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cdomains = []
  */
 
@@ -12221,358 +12257,358 @@
   int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_subdomains", 0);
 
-  /* "libfds/fields.pyx":422
+  /* "libfds/fields.pyx":430
  *     cdef void init_subdomains(self):
  * 
  *         self.cdomains = []             # <<<<<<<<<<<<<<
  *         self.xdomains = []
  *         self.ydomains = []
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 422, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->cdomains);
   __Pyx_DECREF(__pyx_v_self->cdomains);
   __pyx_v_self->cdomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":423
+  /* "libfds/fields.pyx":431
  * 
  *         self.cdomains = []
  *         self.xdomains = []             # <<<<<<<<<<<<<<
  *         self.ydomains = []
  * 
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 423, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->xdomains);
   __Pyx_DECREF(__pyx_v_self->xdomains);
   __pyx_v_self->xdomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":424
+  /* "libfds/fields.pyx":432
  *         self.cdomains = []
  *         self.xdomains = []
  *         self.ydomains = []             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.cdomains:
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 424, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->ydomains);
   __Pyx_DECREF(__pyx_v_self->ydomains);
   __pyx_v_self->ydomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":426
+  /* "libfds/fields.pyx":434
  *         self.ydomains = []
  * 
  *         for sub in self.msh.cdomains:             # <<<<<<<<<<<<<<
  *             self.cdomains.append(Domain2d(*sub.cn, '_', self.cpu))
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_cdomains); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_cdomains); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 434, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 426, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 426, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 434, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 426, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 434, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 426, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 426, __pyx_L1_error)
+          else __PYX_ERR(0, 434, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":427
+    /* "libfds/fields.pyx":435
  * 
  *         for sub in self.msh.cdomains:
  *             self.cdomains.append(Domain2d(*sub.cn, '_', self.cpu))             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.xdomains:
  */
     if (unlikely(__pyx_v_self->cdomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 427, __pyx_L1_error)
+      __PYX_ERR(0, 435, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_n_u__19);
     __Pyx_GIVEREF(__pyx_n_u__19);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_n_u__19);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->cdomains, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 427, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->cdomains, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 435, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":426
+    /* "libfds/fields.pyx":434
  *         self.ydomains = []
  * 
  *         for sub in self.msh.cdomains:             # <<<<<<<<<<<<<<
  *             self.cdomains.append(Domain2d(*sub.cn, '_', self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":429
+  /* "libfds/fields.pyx":437
  *             self.cdomains.append(Domain2d(*sub.cn, '_', self.cpu))
  * 
  *         for sub in self.msh.xdomains:             # <<<<<<<<<<<<<<
  *             self.xdomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xdomains); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xdomains); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 437, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
     __pyx_t_6 = __pyx_t_2; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 429, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 437, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 429, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 437, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_6))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 429, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 437, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 437, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 429, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 437, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 437, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_4(__pyx_t_6);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 429, __pyx_L1_error)
+          else __PYX_ERR(0, 437, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "libfds/fields.pyx":430
+    /* "libfds/fields.pyx":438
  * 
  *         for sub in self.msh.xdomains:
  *             self.xdomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.ydomains:
  */
     if (unlikely(__pyx_v_self->xdomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 430, __pyx_L1_error)
+      __PYX_ERR(0, 438, __pyx_L1_error)
     }
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_5);
     __pyx_t_2 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain2d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain2d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->xdomains, __pyx_t_8); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 430, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->xdomains, __pyx_t_8); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 438, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "libfds/fields.pyx":429
+    /* "libfds/fields.pyx":437
  *             self.cdomains.append(Domain2d(*sub.cn, '_', self.cpu))
  * 
  *         for sub in self.msh.xdomains:             # <<<<<<<<<<<<<<
  *             self.xdomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "libfds/fields.pyx":432
+  /* "libfds/fields.pyx":440
  *             self.xdomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  *         for sub in self.msh.ydomains:             # <<<<<<<<<<<<<<
  *             self.ydomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_ydomains); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 432, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_ydomains); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 440, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
     __pyx_t_8 = __pyx_t_6; __Pyx_INCREF(__pyx_t_8); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 432, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 440, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 432, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 440, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_8))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 432, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 440, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 432, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 440, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 432, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 440, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 432, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 440, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       }
     } else {
       __pyx_t_6 = __pyx_t_4(__pyx_t_8);
       if (unlikely(!__pyx_t_6)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 432, __pyx_L1_error)
+          else __PYX_ERR(0, 440, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_6);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":433
+    /* "libfds/fields.pyx":441
  * 
  *         for sub in self.msh.ydomains:
  *             self.ydomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_field(self):
  */
     if (unlikely(__pyx_v_self->ydomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 433, __pyx_L1_error)
+      __PYX_ERR(0, 441, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
     __pyx_t_6 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->ydomains, __pyx_t_2); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 433, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->ydomains, __pyx_t_2); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 441, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "libfds/fields.pyx":432
+    /* "libfds/fields.pyx":440
  *             self.xdomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  *         for sub in self.msh.ydomains:             # <<<<<<<<<<<<<<
  *             self.ydomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "libfds/fields.pyx":420
+  /* "libfds/fields.pyx":428
  *             self.bc.append(Face2d(self, face))
  * 
  *     cdef void init_subdomains(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cdomains = []
  */
 
@@ -12586,15 +12622,15 @@
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_subdomains", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":435
+/* "libfds/fields.pyx":443
  *             self.ydomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  *     cdef void init_field(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -12614,31 +12650,31 @@
   double __pyx_t_11;
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_field", 0);
 
-  /* "libfds/fields.pyx":439
+  /* "libfds/fields.pyx":447
  *         cdef Py_ssize_t ix, iy
  * 
  *         self.p = _np.zeros((self.nx, self.ny)) + self.p0             # <<<<<<<<<<<<<<
  *         self.r = _np.zeros_like(self.p) + self.rho0
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_4);
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
@@ -12651,282 +12687,282 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 439, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_self->p0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_self->p0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 439, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->p, 0);
   __pyx_v_self->p = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":440
+  /* "libfds/fields.pyx":448
  * 
  *         self.p = _np.zeros((self.nx, self.ny)) + self.p0
  *         self.r = _np.zeros_like(self.p) + self.rho0             # <<<<<<<<<<<<<<
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 440, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->rho0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->rho0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 440, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->r, 0);
   __pyx_v_self->r = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":441
+  /* "libfds/fields.pyx":449
  *         self.p = _np.zeros((self.nx, self.ny)) + self.p0
  *         self.r = _np.zeros_like(self.p) + self.rho0
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0             # <<<<<<<<<<<<<<
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_5, function);
     }
   }
   __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 441, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_self->U0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_self->U0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 441, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->ru, 0);
   __pyx_v_self->ru = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":442
+  /* "libfds/fields.pyx":450
  *         self.r = _np.zeros_like(self.p) + self.rho0
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0             # <<<<<<<<<<<<<<
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 442, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_self->V0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_self->V0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 442, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_5, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->rv, 0);
   __pyx_v_self->rv = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":443
+  /* "libfds/fields.pyx":451
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone             # <<<<<<<<<<<<<<
  * 
  *         if self.cfg.vrt:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_5 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 443, __pyx_L1_error)
+  if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->p0 / __pyx_v_self->gaminusone)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->p0 / __pyx_v_self->gaminusone)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 443, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 451, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->re, 0);
   __pyx_v_self->re = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":445
+  /* "libfds/fields.pyx":453
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  * 
  *         if self.cfg.vrt:             # <<<<<<<<<<<<<<
  *             self.wz = _np.zeros_like(self.p)
  *         else:
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vrt); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 453, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 445, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_7 < 0)) __PYX_ERR(0, 453, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   if (__pyx_t_7) {
 
-    /* "libfds/fields.pyx":446
+    /* "libfds/fields.pyx":454
  * 
  *         if self.cfg.vrt:
  *             self.wz = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         else:
  *             self.wz = _np.zeros((0, ) * len(self.msh.shape))   # Because it's public!
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 446, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
+    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_3 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_4, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 446, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 446, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 454, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wz, 0);
     __pyx_v_self->wz = __pyx_t_6;
     __pyx_t_6.memview = NULL;
     __pyx_t_6.data = NULL;
 
-    /* "libfds/fields.pyx":445
+    /* "libfds/fields.pyx":453
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  * 
  *         if self.cfg.vrt:             # <<<<<<<<<<<<<<
  *             self.wz = _np.zeros_like(self.p)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":448
+  /* "libfds/fields.pyx":456
  *             self.wz = _np.zeros_like(self.p)
  *         else:
  *             self.wz = _np.zeros((0, ) * len(self.msh.shape))   # Because it's public!             # <<<<<<<<<<<<<<
  * 
  *         # Initial pulses
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_8 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -12934,119 +12970,119 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 448, __pyx_L1_error)
+    if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 448, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 456, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wz, 0);
     __pyx_v_self->wz = __pyx_t_6;
     __pyx_t_6.memview = NULL;
     __pyx_t_6.data = NULL;
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":451
+  /* "libfds/fields.pyx":459
  * 
  *         # Initial pulses
  *         for s in self.cfg.ics:             # <<<<<<<<<<<<<<
  *             self.pulse(s.origin, s.amplitude, s.width)
  * 
  */
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_ics); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_ics); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   if (likely(PyList_CheckExact(__pyx_t_3)) || PyTuple_CheckExact(__pyx_t_3)) {
     __pyx_t_1 = __pyx_t_3; __Pyx_INCREF(__pyx_t_1); __pyx_t_8 = 0;
     __pyx_t_9 = NULL;
   } else {
-    __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 451, __pyx_L1_error)
+    __pyx_t_8 = -1; __pyx_t_1 = PyObject_GetIter(__pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 451, __pyx_L1_error)
+    __pyx_t_9 = Py_TYPE(__pyx_t_1)->tp_iternext; if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 459, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   for (;;) {
     if (likely(!__pyx_t_9)) {
       if (likely(PyList_CheckExact(__pyx_t_1))) {
         if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
+        __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       } else {
         if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 451, __pyx_L1_error)
+        __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_8); __Pyx_INCREF(__pyx_t_3); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 459, __pyx_L1_error)
         #else
-        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 451, __pyx_L1_error)
+        __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 459, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         #endif
       }
     } else {
       __pyx_t_3 = __pyx_t_9(__pyx_t_1);
       if (unlikely(!__pyx_t_3)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 451, __pyx_L1_error)
+          else __PYX_ERR(0, 459, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_3);
     }
     __Pyx_XDECREF_SET(__pyx_v_s, __pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":452
+    /* "libfds/fields.pyx":460
  *         # Initial pulses
  *         for s in self.cfg.ics:
  *             self.pulse(s.origin, s.amplitude, s.width)             # <<<<<<<<<<<<<<
  * 
  *         # Set to 0 at obstacle locations
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 460, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_10 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_t_3); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_10 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_t_3); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 460, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_amplitude); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_amplitude); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 460, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_11 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_11 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 460, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 460, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 452, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_12 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 460, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_f_6libfds_6fields_8Fields2d_pulse(__pyx_v_self, __pyx_t_10, __pyx_t_11, __pyx_t_12);
 
-    /* "libfds/fields.pyx":451
+    /* "libfds/fields.pyx":459
  * 
  *         # Initial pulses
  *         for s in self.cfg.ics:             # <<<<<<<<<<<<<<
  *             self.pulse(s.origin, s.amplitude, s.width)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":455
+  /* "libfds/fields.pyx":463
  * 
  *         # Set to 0 at obstacle locations
  *         self.zero_obstacles()             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_sources(self):
  */
   __pyx_f_6libfds_6fields_8Fields2d_zero_obstacles(__pyx_v_self);
 
-  /* "libfds/fields.pyx":435
+  /* "libfds/fields.pyx":443
  *             self.ydomains.append(Domain2d(*sub.cn, sub.tag, self.cpu))
  * 
  *     cdef void init_field(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -13061,15 +13097,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_field", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_s);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":457
+/* "libfds/fields.pyx":465
  *         self.zero_obstacles()
  * 
  *     cdef void init_sources(self):             # <<<<<<<<<<<<<<
  * 
  *         self.src = []
  */
 
@@ -13087,133 +13123,133 @@
   PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_sources", 0);
 
-  /* "libfds/fields.pyx":459
+  /* "libfds/fields.pyx":467
  *     cdef void init_sources(self):
  * 
  *         self.src = []             # <<<<<<<<<<<<<<
  * 
  *         for s in self.cfg.src:
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 459, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->src);
   __Pyx_DECREF(__pyx_v_self->src);
   __pyx_v_self->src = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":461
+  /* "libfds/fields.pyx":469
  *         self.src = []
  * 
  *         for s in self.cfg.src:             # <<<<<<<<<<<<<<
  *             self.src.append(Monopole2d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_src); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_src); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 469, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 461, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 461, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 469, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 461, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 469, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 469, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 461, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 469, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 469, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 461, __pyx_L1_error)
+          else __PYX_ERR(0, 469, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_s, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":462
+    /* "libfds/fields.pyx":470
  * 
  *         for s in self.cfg.src:
  *             self.src.append(Monopole2d(self.monopole_distribution(s.origin, s.width), s.evolution))             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_cvars(self):
  */
     if (unlikely(__pyx_v_self->src == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 462, __pyx_L1_error)
+      __PYX_ERR(0, 470, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_5 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_7 = __pyx_f_6libfds_6fields_8Fields2d_monopole_distribution(__pyx_v_self, __pyx_t_5, __pyx_t_6, 0); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 462, __pyx_L1_error)
-    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_7, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_7 = __pyx_f_6libfds_6fields_8Fields2d_monopole_distribution(__pyx_v_self, __pyx_t_5, __pyx_t_6, 0); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 470, __pyx_L1_error)
+    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_7, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_evolution); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_evolution); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_8);
     __pyx_t_1 = 0;
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Monopole2d), __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Monopole2d), __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_self->src, __pyx_t_8); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 462, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_self->src, __pyx_t_8); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 470, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "libfds/fields.pyx":461
+    /* "libfds/fields.pyx":469
  *         self.src = []
  * 
  *         for s in self.cfg.src:             # <<<<<<<<<<<<<<
  *             self.src.append(Monopole2d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":457
+  /* "libfds/fields.pyx":465
  *         self.zero_obstacles()
  * 
  *     cdef void init_sources(self):             # <<<<<<<<<<<<<<
  * 
  *         self.src = []
  */
 
@@ -13227,15 +13263,15 @@
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_sources", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_s);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":464
+/* "libfds/fields.pyx":472
  *             self.src.append(Monopole2d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  *     cdef void init_cvars(self):             # <<<<<<<<<<<<<<
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)
  */
 
@@ -13249,538 +13285,538 @@
   int __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_cvars", 0);
 
-  /* "libfds/fields.pyx":465
+  /* "libfds/fields.pyx":473
  * 
  *     cdef void init_cvars(self):
  *         self.E = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Eu = _np.zeros_like(self.p)
  *         self.Ev = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 465, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 473, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->E, 0);
   __pyx_v_self->E = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":466
+  /* "libfds/fields.pyx":474
  *     cdef void init_cvars(self):
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ev = _np.zeros_like(self.p)
  *         self.Ee = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 466, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 466, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 466, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Eu, 0);
   __pyx_v_self->Eu = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":467
+  /* "libfds/fields.pyx":475
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)
  *         self.Ev = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ee = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 467, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 467, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 467, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 467, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 467, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 475, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ev, 0);
   __pyx_v_self->Ev = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":468
+  /* "libfds/fields.pyx":476
  *         self.Eu = _np.zeros_like(self.p)
  *         self.Ev = _np.zeros_like(self.p)
  *         self.Ee = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         self.F = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 468, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ee, 0);
   __pyx_v_self->Ee = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":470
+  /* "libfds/fields.pyx":478
  *         self.Ee = _np.zeros_like(self.p)
  * 
  *         self.F = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fu = _np.zeros_like(self.p)
  *         self.Fv = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 470, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 470, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->F, 0);
   __pyx_v_self->F = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":471
+  /* "libfds/fields.pyx":479
  * 
  *         self.F = _np.zeros_like(self.p)
  *         self.Fu = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fv = _np.zeros_like(self.p)
  *         self.Fe = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 471, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 471, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 471, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 479, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fu, 0);
   __pyx_v_self->Fu = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":472
+  /* "libfds/fields.pyx":480
  *         self.F = _np.zeros_like(self.p)
  *         self.Fu = _np.zeros_like(self.p)
  *         self.Fv = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fe = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 472, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 472, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 480, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fv, 0);
   __pyx_v_self->Fv = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":473
+  /* "libfds/fields.pyx":481
  *         self.Fu = _np.zeros_like(self.p)
  *         self.Fv = _np.zeros_like(self.p)
  *         self.Fe = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         self.K = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 473, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 473, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 481, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fe, 0);
   __pyx_v_self->Fe = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":475
+  /* "libfds/fields.pyx":483
  *         self.Fe = _np.zeros_like(self.p)
  * 
  *         self.K = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ku = _np.zeros_like(self.p)
  *         self.Kv = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 475, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 475, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 483, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->K, 0);
   __pyx_v_self->K = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":476
+  /* "libfds/fields.pyx":484
  * 
  *         self.K = _np.zeros_like(self.p)
  *         self.Ku = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Kv = _np.zeros_like(self.p)
  *         self.Ke = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 476, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 484, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ku, 0);
   __pyx_v_self->Ku = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":477
+  /* "libfds/fields.pyx":485
  *         self.K = _np.zeros_like(self.p)
  *         self.Ku = _np.zeros_like(self.p)
  *         self.Kv = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ke = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 477, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 485, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Kv, 0);
   __pyx_v_self->Kv = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":478
+  /* "libfds/fields.pyx":486
  *         self.Ku = _np.zeros_like(self.p)
  *         self.Kv = _np.zeros_like(self.p)
  *         self.Ke = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         if self.cfg.vsc:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 478, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 478, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 478, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 486, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ke, 0);
   __pyx_v_self->Ke = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":480
+  /* "libfds/fields.pyx":488
  *         self.Ke = _np.zeros_like(self.p)
  * 
  *         if self.cfg.vsc:             # <<<<<<<<<<<<<<
  *             self.Tk = _np.zeros_like(self.p)
  *         else: # because it's public
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vsc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vsc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 480, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 488, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":481
+    /* "libfds/fields.pyx":489
  * 
  *         if self.cfg.vsc:
  *             self.Tk = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         else: # because it's public
  *             self.Tk = _np.zeros((0, ) * len(self.msh.shape))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 481, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 481, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 481, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 481, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 489, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->Tk, 0);
     __pyx_v_self->Tk = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
 
-    /* "libfds/fields.pyx":480
+    /* "libfds/fields.pyx":488
  *         self.Ke = _np.zeros_like(self.p)
  * 
  *         if self.cfg.vsc:             # <<<<<<<<<<<<<<
  *             self.Tk = _np.zeros_like(self.p)
  *         else: # because it's public
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":483
+  /* "libfds/fields.pyx":491
  *             self.Tk = _np.zeros_like(self.p)
  *         else: # because it's public
  *             self.Tk = _np.zeros((0, ) * len(self.msh.shape))             # <<<<<<<<<<<<<<
  * 
  *         self.S11 = _np.zeros_like(self.Tk)
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -13788,138 +13824,138 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 483, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 491, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->Tk, 0);
     __pyx_v_self->Tk = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":485
+  /* "libfds/fields.pyx":493
  *             self.Tk = _np.zeros((0, ) * len(self.msh.shape))
  * 
  *         self.S11 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S22 = _np.zeros_like(self.Tk)
  *         self.S12 = _np.zeros_like(self.Tk)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 493, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 485, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 493, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 485, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 493, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 485, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 485, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 493, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S11, 0);
   __pyx_v_self->S11 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":486
+  /* "libfds/fields.pyx":494
  * 
  *         self.S11 = _np.zeros_like(self.Tk)
  *         self.S22 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S12 = _np.zeros_like(self.Tk)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 486, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 494, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 486, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 494, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 486, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 494, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 486, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 486, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 494, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S22, 0);
   __pyx_v_self->S22 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":487
+  /* "libfds/fields.pyx":495
  *         self.S11 = _np.zeros_like(self.Tk)
  *         self.S22 = _np.zeros_like(self.Tk)
  *         self.S12 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_buffer(self):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 487, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 495, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 487, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 487, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 495, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 487, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 487, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 495, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S12, 0);
   __pyx_v_self->S12 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":464
+  /* "libfds/fields.pyx":472
  *             self.src.append(Monopole2d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  *     cdef void init_cvars(self):             # <<<<<<<<<<<<<<
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)
  */
 
@@ -13932,15 +13968,15 @@
   __Pyx_XDECREF(__pyx_t_4);
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.init_cvars", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":489
+/* "libfds/fields.pyx":497
  *         self.S12 = _np.zeros_like(self.Tk)
  * 
  *     cdef void init_buffer(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double s0 = 1.
  */
 
@@ -13984,162 +14020,162 @@
   long __pyx_t_27;
   long __pyx_t_28;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_buffer", 0);
 
-  /* "libfds/fields.pyx":491
+  /* "libfds/fields.pyx":499
  *     cdef void init_buffer(self):
  * 
  *         cdef double s0 = 1.             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t i, ix, iy
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]
  */
   __pyx_v_s0 = 1.;
 
-  /* "libfds/fields.pyx":493
+  /* "libfds/fields.pyx":501
  *         cdef double s0 = 1.
  *         cdef Py_ssize_t i, ix, iy
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]             # <<<<<<<<<<<<<<
  *         cdef double Dy = self.msh.y[self.bz_n] - self.msh.y[0]
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 493, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 501, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Dx = __pyx_t_4;
 
-  /* "libfds/fields.pyx":494
+  /* "libfds/fields.pyx":502
  *         cdef Py_ssize_t i, ix, iy
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]
  *         cdef double Dy = self.msh.y[self.bz_n] - self.msh.y[0]             # <<<<<<<<<<<<<<
  * 
  *         cdef double[::1] sx = _np.zeros(self.nx)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 494, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 502, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Dy = __pyx_t_4;
 
-  /* "libfds/fields.pyx":496
+  /* "libfds/fields.pyx":504
  *         cdef double Dy = self.msh.y[self.bz_n] - self.msh.y[0]
  * 
  *         cdef double[::1] sx = _np.zeros(self.nx)             # <<<<<<<<<<<<<<
  *         cdef double[::1] sy = _np.zeros(self.ny)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 504, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_sx = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":497
+  /* "libfds/fields.pyx":505
  * 
  *         cdef double[::1] sx = _np.zeros(self.nx)
  *         cdef double[::1] sy = _np.zeros(self.ny)             # <<<<<<<<<<<<<<
  * 
  *         self.sigma = _np.zeros((self.nx, self.ny))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 497, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 497, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 505, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_sy = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":499
+  /* "libfds/fields.pyx":507
  *         cdef double[::1] sy = _np.zeros(self.ny)
  * 
  *         self.sigma = _np.zeros((self.nx, self.ny))             # <<<<<<<<<<<<<<
  * 
  *         for i in range(0, self.bz_n):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_5);
   __pyx_t_2 = 0;
   __pyx_t_5 = 0;
@@ -14152,366 +14188,366 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 499, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 507, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->sigma, 0);
   __pyx_v_self->sigma = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "libfds/fields.pyx":501
+  /* "libfds/fields.pyx":509
  *         self.sigma = _np.zeros((self.nx, self.ny))
  * 
  *         for i in range(0, self.bz_n):             # <<<<<<<<<<<<<<
  * 
  *             if self.msh.bounds[0].bc == 'A':
  */
   __pyx_t_9 = __pyx_v_self->bz_n;
   __pyx_t_10 = __pyx_t_9;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_i = __pyx_t_11;
 
-    /* "libfds/fields.pyx":503
+    /* "libfds/fields.pyx":511
  *         for i in range(0, self.bz_n):
  * 
  *             if self.msh.bounds[0].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 503, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 511, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 511, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 503, __pyx_L1_error)
+    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 511, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_12) {
 
-      /* "libfds/fields.pyx":504
+      /* "libfds/fields.pyx":512
  * 
  *             if self.msh.bounds[0].bc == 'A':
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  */
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_7 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_7); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 504, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_7); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 512, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_13 = __pyx_v_i;
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_13)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":503
+      /* "libfds/fields.pyx":511
  *         for i in range(0, self.bz_n):
  * 
  *             if self.msh.bounds[0].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":505
+    /* "libfds/fields.pyx":513
  *             if self.msh.bounds[0].bc == 'A':
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 513, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 513, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 513, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 505, __pyx_L1_error)
+    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 513, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_12) {
 
-      /* "libfds/fields.pyx":506
+      /* "libfds/fields.pyx":514
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  */
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_14 = ((__pyx_v_self->nx - 1) - __pyx_v_i);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_14 = ((__pyx_v_self->nx - 1) - __pyx_v_self->bz_n);
-      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Multiply(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 506, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 514, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_13 = ((__pyx_v_self->nx - 1) - __pyx_v_i);
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_13)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":505
+      /* "libfds/fields.pyx":513
  *             if self.msh.bounds[0].bc == 'A':
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":507
+    /* "libfds/fields.pyx":515
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 515, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 515, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 507, __pyx_L1_error)
+    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 515, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_12) {
 
-      /* "libfds/fields.pyx":508
+      /* "libfds/fields.pyx":516
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[3].bc == 'A':
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  */
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_7, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_7 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_7); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 508, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_7); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 516, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_13 = __pyx_v_i;
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_13)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":507
+      /* "libfds/fields.pyx":515
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":509
+    /* "libfds/fields.pyx":517
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  * 
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 509, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 517, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 509, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_7, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 517, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 509, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 517, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 509, __pyx_L1_error)
+    __pyx_t_12 = (__Pyx_PyUnicode_Equals(__pyx_t_7, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_12 < 0)) __PYX_ERR(0, 517, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_12) {
 
-      /* "libfds/fields.pyx":510
+      /* "libfds/fields.pyx":518
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder             # <<<<<<<<<<<<<<
  * 
  *         for ix in range(self.nx):
  */
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_14 = ((__pyx_v_self->ny - 1) - __pyx_v_i);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_14 = ((__pyx_v_self->ny - 1) - __pyx_v_self->bz_n);
-      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_14, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_5 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_5, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Multiply(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_7, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 510, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 518, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_13 = ((__pyx_v_self->ny - 1) - __pyx_v_i);
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_13)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":509
+      /* "libfds/fields.pyx":517
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  * 
  */
     }
   }
 
-  /* "libfds/fields.pyx":512
+  /* "libfds/fields.pyx":520
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  * 
  *         for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *             for iy in range(self.ny):
  *                 self.sigma[ix, iy] = sx[ix] / (1 + sy[iy]) + sy[iy] / (1 + sx[ix])
  */
   __pyx_t_9 = __pyx_v_self->nx;
   __pyx_t_10 = __pyx_t_9;
   for (__pyx_t_11 = 0; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
     __pyx_v_ix = __pyx_t_11;
 
-    /* "libfds/fields.pyx":513
+    /* "libfds/fields.pyx":521
  * 
  *         for ix in range(self.nx):
  *             for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                 self.sigma[ix, iy] = sx[ix] / (1 + sy[iy]) + sy[iy] / (1 + sx[ix])
  * 
  */
     __pyx_t_14 = __pyx_v_self->ny;
     __pyx_t_15 = __pyx_t_14;
     for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
       __pyx_v_iy = __pyx_t_16;
 
-      /* "libfds/fields.pyx":514
+      /* "libfds/fields.pyx":522
  *         for ix in range(self.nx):
  *             for iy in range(self.ny):
  *                 self.sigma[ix, iy] = sx[ix] / (1 + sy[iy]) + sy[iy] / (1 + sx[ix])             # <<<<<<<<<<<<<<
  * 
  *         for obs in self.msh.obstacles:
  */
       __pyx_t_13 = __pyx_v_ix;
@@ -14520,158 +14556,158 @@
       __pyx_t_19 = __pyx_v_ix;
       __pyx_t_20 = __pyx_v_ix;
       __pyx_t_21 = __pyx_v_iy;
       *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->sigma.data + __pyx_t_20 * __pyx_v_self->sigma.strides[0]) )) + __pyx_t_21)) )) = (((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_13)) ))) / (1.0 + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_17)) ))))) + ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_18)) ))) / (1.0 + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_19)) ))))));
     }
   }
 
-  /* "libfds/fields.pyx":516
+  /* "libfds/fields.pyx":524
  *                 self.sigma[ix, iy] = sx[ix] / (1 + sy[iy]) + sy[iy] / (1 + sx[ix])
  * 
  *         for obs in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_9 = 0;
     __pyx_t_22 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 524, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_22 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 516, __pyx_L1_error)
+    __pyx_t_22 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 524, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_22)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 516, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 524, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 516, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 524, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 516, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_22(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 516, __pyx_L1_error)
+          else __PYX_ERR(0, 524, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_obs, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":517
+    /* "libfds/fields.pyx":525
  * 
  *         for obs in self.msh.obstacles:
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  *                     self.sigma[ix, iy] = 0
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_23 = __Pyx_PyInt_As_long(__pyx_t_7); if (unlikely((__pyx_t_23 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_23 = __Pyx_PyInt_As_long(__pyx_t_7); if (unlikely((__pyx_t_23 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_24 = __Pyx_PyInt_As_long(__pyx_t_7); if (unlikely((__pyx_t_24 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 517, __pyx_L1_error)
+    __pyx_t_24 = __Pyx_PyInt_As_long(__pyx_t_7); if (unlikely((__pyx_t_24 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 525, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_25 = __pyx_t_23;
     for (__pyx_t_10 = __pyx_t_24; __pyx_t_10 < __pyx_t_25; __pyx_t_10+=1) {
       __pyx_v_ix = __pyx_t_10;
 
-      /* "libfds/fields.pyx":518
+      /* "libfds/fields.pyx":526
  *         for obs in self.msh.obstacles:
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):             # <<<<<<<<<<<<<<
  *                     self.sigma[ix, iy] = 0
  * 
  */
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_7, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_26 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_26 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_26 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_26 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_7, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_27 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_27 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 518, __pyx_L1_error)
+      __pyx_t_27 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_27 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 526, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_28 = __pyx_t_26;
       for (__pyx_t_11 = __pyx_t_27; __pyx_t_11 < __pyx_t_28; __pyx_t_11+=1) {
         __pyx_v_iy = __pyx_t_11;
 
-        /* "libfds/fields.pyx":519
+        /* "libfds/fields.pyx":527
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  *                     self.sigma[ix, iy] = 0             # <<<<<<<<<<<<<<
  * 
  *     cpdef tuple get_velocity(self):
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_18 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->sigma.data + __pyx_t_19 * __pyx_v_self->sigma.strides[0]) )) + __pyx_t_18)) )) = 0.0;
       }
     }
 
-    /* "libfds/fields.pyx":516
+    /* "libfds/fields.pyx":524
  *                 self.sigma[ix, iy] = sx[ix] / (1 + sy[iy]) + sy[iy] / (1 + sx[ix])
  * 
  *         for obs in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "libfds/fields.pyx":489
+  /* "libfds/fields.pyx":497
  *         self.S12 = _np.zeros_like(self.Tk)
  * 
  *     cdef void init_buffer(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double s0 = 1.
  */
 
@@ -14689,15 +14725,15 @@
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_sx, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_sy, 1);
   __Pyx_XDECREF(__pyx_v_obs);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":521
+/* "libfds/fields.pyx":529
  *                     self.sigma[ix, iy] = 0
  * 
  *     cpdef tuple get_velocity(self):             # <<<<<<<<<<<<<<
  *         """ Return (vx, vz) """
  *         self.update('V')
  */
 
@@ -14709,48 +14745,48 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_velocity", 0);
 
-  /* "libfds/fields.pyx":523
+  /* "libfds/fields.pyx":531
  *     cpdef tuple get_velocity(self):
  *         """ Return (vx, vz) """
  *         self.update('V')             # <<<<<<<<<<<<<<
  *         return self.Eu, self.Ev
  * 
  */
   __pyx_f_6libfds_6fields_8Fields2d_update(__pyx_v_self, __pyx_n_u_V);
 
-  /* "libfds/fields.pyx":524
+  /* "libfds/fields.pyx":532
  *         """ Return (vx, vz) """
  *         self.update('V')
  *         return self.Eu, self.Ev             # <<<<<<<<<<<<<<
  * 
  *     cpdef double[:, ::1] monopole_distribution(self, (Py_ssize_t, Py_ssize_t) origin, double B0):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->Eu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->Eu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Ev, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Ev, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 524, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 532, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_r = ((PyObject*)__pyx_t_3);
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":521
+  /* "libfds/fields.pyx":529
  *                     self.sigma[ix, iy] = 0
  * 
  *     cpdef tuple get_velocity(self):             # <<<<<<<<<<<<<<
  *         """ Return (vx, vz) """
  *         self.update('V')
  */
 
@@ -14786,15 +14822,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_velocity", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields2d_get_velocity(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 521, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields2d_get_velocity(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 529, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -14803,15 +14839,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":526
+/* "libfds/fields.pyx":534
  *         return self.Eu, self.Ev
  * 
  *     cpdef double[:, ::1] monopole_distribution(self, (Py_ssize_t, Py_ssize_t) origin, double B0):             # <<<<<<<<<<<<<<
  *         """ Monopole distribution
  * 
  */
 
@@ -14853,110 +14889,110 @@
   Py_ssize_t __pyx_t_23;
   Py_ssize_t __pyx_t_24;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("monopole_distribution", 0);
 
-  /* "libfds/fields.pyx":538
+  /* "libfds/fields.pyx":546
  * 
  *         cdef Py_ssize_t ix, iy
  *         cdef Py_ssize_t ix0 = origin[0]             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t iy0 = origin[1]
  *         cdef double[::1] x = self.msh.x
  */
   __pyx_v_ix0 = __pyx_v_origin.f0;
 
-  /* "libfds/fields.pyx":539
+  /* "libfds/fields.pyx":547
  *         cdef Py_ssize_t ix, iy
  *         cdef Py_ssize_t ix0 = origin[0]
  *         cdef Py_ssize_t iy0 = origin[1]             # <<<<<<<<<<<<<<
  *         cdef double[::1] x = self.msh.x
  *         cdef double[::1] y = self.msh.y
  */
   __pyx_v_iy0 = __pyx_v_origin.f1;
 
-  /* "libfds/fields.pyx":540
+  /* "libfds/fields.pyx":548
  *         cdef Py_ssize_t ix0 = origin[0]
  *         cdef Py_ssize_t iy0 = origin[1]
  *         cdef double[::1] x = self.msh.x             # <<<<<<<<<<<<<<
  *         cdef double[::1] y = self.msh.y
  *         cdef double log2 = log(2.)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 548, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 540, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 548, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_x = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "libfds/fields.pyx":541
+  /* "libfds/fields.pyx":549
  *         cdef Py_ssize_t iy0 = origin[1]
  *         cdef double[::1] x = self.msh.x
  *         cdef double[::1] y = self.msh.y             # <<<<<<<<<<<<<<
  *         cdef double log2 = log(2.)
  *         cdef double Bx = (B0 * self.msh.dx) ** 2
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 541, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 541, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 549, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_y = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "libfds/fields.pyx":542
+  /* "libfds/fields.pyx":550
  *         cdef double[::1] x = self.msh.x
  *         cdef double[::1] y = self.msh.y
  *         cdef double log2 = log(2.)             # <<<<<<<<<<<<<<
  *         cdef double Bx = (B0 * self.msh.dx) ** 2
  *         cdef double[:, ::1] m = _np.empty((self.nx, self.ny))
  */
   __pyx_v_log2 = log(2.);
 
-  /* "libfds/fields.pyx":543
+  /* "libfds/fields.pyx":551
  *         cdef double[::1] y = self.msh.y
  *         cdef double log2 = log(2.)
  *         cdef double Bx = (B0 * self.msh.dx) ** 2             # <<<<<<<<<<<<<<
  *         cdef double[:, ::1] m = _np.empty((self.nx, self.ny))
  * 
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_B0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_B0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Power(__pyx_t_4, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Power(__pyx_t_4, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 551, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_Bx = __pyx_t_5;
 
-  /* "libfds/fields.pyx":544
+  /* "libfds/fields.pyx":552
  *         cdef double log2 = log(2.)
  *         cdef double Bx = (B0 * self.msh.dx) ** 2
  *         cdef double[:, ::1] m = _np.empty((self.nx, self.ny))             # <<<<<<<<<<<<<<
  * 
  *         if self.mesh_type == 'curvilinear':
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
   __pyx_t_4 = 0;
   __pyx_t_6 = 0;
@@ -14969,243 +15005,243 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7);
   __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 544, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 544, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 552, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_m = __pyx_t_8;
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
 
-  /* "libfds/fields.pyx":546
+  /* "libfds/fields.pyx":554
  *         cdef double[:, ::1] m = _np.empty((self.nx, self.ny))
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  */
-  __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 546, __pyx_L1_error)
+  __pyx_t_9 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_9 < 0)) __PYX_ERR(0, 554, __pyx_L1_error)
   __pyx_t_10 = (__pyx_t_9 != 0);
   if (__pyx_t_10) {
 
-    /* "libfds/fields.pyx":547
+    /* "libfds/fields.pyx":555
  * 
  *         if self.mesh_type == 'curvilinear':
  *             for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +
  */
     __pyx_t_11 = __pyx_v_self->nx;
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_ix = __pyx_t_13;
 
-      /* "libfds/fields.pyx":548
+      /* "libfds/fields.pyx":556
  *         if self.mesh_type == 'curvilinear':
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)
  */
       __pyx_t_14 = __pyx_v_self->ny;
       __pyx_t_15 = __pyx_t_14;
       for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
         __pyx_v_iy = __pyx_t_16;
 
-        /* "libfds/fields.pyx":549
+        /* "libfds/fields.pyx":557
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +             # <<<<<<<<<<<<<<
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)
  *         else:
  */
-        __pyx_t_3 = PyFloat_FromDouble((-__pyx_v_log2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_3 = PyFloat_FromDouble((-__pyx_v_log2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_6);
         __pyx_t_7 = 0;
         __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
-        __pyx_t_17 = PyTuple_New(2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_17 = PyTuple_New(2); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_17);
         __Pyx_GIVEREF(__pyx_t_1);
         PyTuple_SET_ITEM(__pyx_t_17, 0, __pyx_t_1);
         __Pyx_GIVEREF(__pyx_t_7);
         PyTuple_SET_ITEM(__pyx_t_17, 1, __pyx_t_7);
         __pyx_t_1 = 0;
         __pyx_t_7 = 0;
-        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_17); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
-        __pyx_t_17 = PyNumber_Subtract(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_17 = PyNumber_Subtract(__pyx_t_6, __pyx_t_7); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_17);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-        __pyx_t_7 = PyNumber_Power(__pyx_t_17, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_7 = PyNumber_Power(__pyx_t_17, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_7);
         __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
 
-        /* "libfds/fields.pyx":550
+        /* "libfds/fields.pyx":558
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(self.nx):
  */
-        __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_17 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_17);
-        __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
-        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
         __Pyx_GIVEREF(__pyx_t_4);
         PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
         __pyx_t_6 = 0;
         __pyx_t_4 = 0;
-        __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_17, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_4 = __Pyx_PyObject_GetItem(__pyx_t_17, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_4);
         __Pyx_DECREF(__pyx_t_17); __pyx_t_17 = 0;
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_17 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_17 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_17)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_17);
-        __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
-        __pyx_t_18 = PyTuple_New(2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_18 = PyTuple_New(2); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         __Pyx_GIVEREF(__pyx_t_17);
         PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_17);
         __Pyx_GIVEREF(__pyx_t_6);
         PyTuple_SET_ITEM(__pyx_t_18, 1, __pyx_t_6);
         __pyx_t_17 = 0;
         __pyx_t_6 = 0;
-        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __pyx_t_18 = PyNumber_Subtract(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_18 = PyNumber_Subtract(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = PyNumber_Power(__pyx_t_18, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_6 = PyNumber_Power(__pyx_t_18, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-        /* "libfds/fields.pyx":549
+        /* "libfds/fields.pyx":557
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +             # <<<<<<<<<<<<<<
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)
  *         else:
  */
-        __pyx_t_18 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_18 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
         __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-        __pyx_t_6 = PyNumber_Multiply(__pyx_t_3, __pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 549, __pyx_L1_error)
+        __pyx_t_6 = PyNumber_Multiply(__pyx_t_3, __pyx_t_18); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 557, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
 
-        /* "libfds/fields.pyx":550
+        /* "libfds/fields.pyx":558
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(self.nx):
  */
-        __pyx_t_18 = PyFloat_FromDouble(__pyx_v_Bx); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_18 = PyFloat_FromDouble(__pyx_v_Bx); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_18);
-        __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_6, __pyx_t_18); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_3);
         __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
         __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
-        __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 550, __pyx_L1_error)
+        __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 558, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-        /* "libfds/fields.pyx":549
+        /* "libfds/fields.pyx":557
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((self.msh.xp[ix, iy] - self.msh.xp[ix0, iy0])**2 +             # <<<<<<<<<<<<<<
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)
  *         else:
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_20 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_m.data + __pyx_t_19 * __pyx_v_m.strides[0]) )) + __pyx_t_20)) )) = exp(__pyx_t_5);
       }
     }
 
-    /* "libfds/fields.pyx":546
+    /* "libfds/fields.pyx":554
  *         cdef double[:, ::1] m = _np.empty((self.nx, self.ny))
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":552
+  /* "libfds/fields.pyx":560
  *                                              (self.msh.yp[ix, iy] - self.msh.yp[ix0, iy0])**2) / Bx)
  *         else:
  *             for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((x[ix] - x[ix0])**2 + (y[iy] - y[iy0])**2) / Bx)
  */
   /*else*/ {
     __pyx_t_11 = __pyx_v_self->nx;
     __pyx_t_12 = __pyx_t_11;
     for (__pyx_t_13 = 0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
       __pyx_v_ix = __pyx_t_13;
 
-      /* "libfds/fields.pyx":553
+      /* "libfds/fields.pyx":561
  *         else:
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                     m[ix, iy] = exp(-log2 * ((x[ix] - x[ix0])**2 + (y[iy] - y[iy0])**2) / Bx)
  *         return m
  */
       __pyx_t_14 = __pyx_v_self->ny;
       __pyx_t_15 = __pyx_t_14;
       for (__pyx_t_16 = 0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
         __pyx_v_iy = __pyx_t_16;
 
-        /* "libfds/fields.pyx":554
+        /* "libfds/fields.pyx":562
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((x[ix] - x[ix0])**2 + (y[iy] - y[iy0])**2) / Bx)             # <<<<<<<<<<<<<<
  *         return m
  * 
  */
         __pyx_t_20 = __pyx_v_ix;
@@ -15216,26 +15252,26 @@
         __pyx_t_24 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_m.data + __pyx_t_23 * __pyx_v_m.strides[0]) )) + __pyx_t_24)) )) = exp((((-__pyx_v_log2) * (pow(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_20)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_19)) )))), 2.0) + pow(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_21)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_22)) )))), 2.0))) / __pyx_v_Bx));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":555
+  /* "libfds/fields.pyx":563
  *                 for iy in range(self.ny):
  *                     m[ix, iy] = exp(-log2 * ((x[ix] - x[ix0])**2 + (y[iy] - y[iy0])**2) / Bx)
  *         return m             # <<<<<<<<<<<<<<
  * 
  *     cdef void pulse(self, (Py_ssize_t, Py_ssize_t) origin, double S0, int B0):
  */
   __PYX_INC_MEMVIEW(&__pyx_v_m, 0);
   __pyx_r = __pyx_v_m;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":526
+  /* "libfds/fields.pyx":534
  *         return self.Eu, self.Ev
  * 
  *     cpdef double[:, ::1] monopole_distribution(self, (Py_ssize_t, Py_ssize_t) origin, double B0):             # <<<<<<<<<<<<<<
  *         """ Monopole distribution
  * 
  */
 
@@ -15297,32 +15333,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_origin)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_B0)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, 1); __PYX_ERR(0, 526, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, 1); __PYX_ERR(0, 534, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "monopole_distribution") < 0)) __PYX_ERR(0, 526, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "monopole_distribution") < 0)) __PYX_ERR(0, 534, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_origin = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[0]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 526, __pyx_L3_error)
-    __pyx_v_B0 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_B0 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 526, __pyx_L3_error)
+    __pyx_v_origin = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t(values[0]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 534, __pyx_L3_error)
+    __pyx_v_B0 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_B0 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 534, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 526, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 534, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Fields2d.monopole_distribution", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_8Fields2d_4monopole_distribution(((struct __pyx_obj_6libfds_6fields_Fields2d *)__pyx_v_self), __pyx_v_origin, __pyx_v_B0);
 
@@ -15337,16 +15373,16 @@
   __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("monopole_distribution", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields2d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 1); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 526, __pyx_L1_error)
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 526, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields2d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 1); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 534, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 534, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
@@ -15359,15 +15395,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":557
+/* "libfds/fields.pyx":565
  *         return m
  * 
  *     cdef void pulse(self, (Py_ssize_t, Py_ssize_t) origin, double S0, int B0):             # <<<<<<<<<<<<<<
  *         """ Pulse source initialization. """
  * 
  */
 
@@ -15392,126 +15428,126 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pulse", 0);
 
-  /* "libfds/fields.pyx":562
+  /* "libfds/fields.pyx":570
  *         cdef Domain2d sub
  *         cdef Py_ssize_t ix, iy
  *         cdef double[:, ::1] profile = self.monopole_distribution(origin, B0)             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.cdomains:
  */
-  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields2d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 0); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 562, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields2d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 0); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 570, __pyx_L1_error)
   __pyx_v_profile = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "libfds/fields.pyx":564
+  /* "libfds/fields.pyx":572
  *         cdef double[:, ::1] profile = self.monopole_distribution(origin, B0)
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                 for iy in range(sub.iy[0], sub.iy[1] + 1):
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 564, __pyx_L1_error)
+    __PYX_ERR(0, 572, __pyx_L1_error)
   }
   __pyx_t_2 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
   for (;;) {
     if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_4); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 564, __pyx_L1_error)
+    __pyx_t_4 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_4); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 572, __pyx_L1_error)
     #else
-    __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     #endif
-    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 564, __pyx_L1_error)
+    if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 572, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_4));
     __pyx_t_4 = 0;
 
-    /* "libfds/fields.pyx":565
+    /* "libfds/fields.pyx":573
  * 
  *         for sub in self.cdomains:
  *             for ix in range(sub.ix[0], sub.ix[1] + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                     self.p[ix, iy] += S0 * profile[ix, iy]
  */
     __pyx_t_5 = (__pyx_v_sub->ix.f1 + 1);
     __pyx_t_6 = __pyx_t_5;
     for (__pyx_t_7 = __pyx_v_sub->ix.f0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_ix = __pyx_t_7;
 
-      /* "libfds/fields.pyx":566
+      /* "libfds/fields.pyx":574
  *         for sub in self.cdomains:
  *             for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                 for iy in range(sub.iy[0], sub.iy[1] + 1):             # <<<<<<<<<<<<<<
  *                     self.p[ix, iy] += S0 * profile[ix, iy]
  *                     self.r[ix, iy] += (self.p[ix, iy] - self.p0) / (self.c0 * self.c0)
  */
       __pyx_t_8 = (__pyx_v_sub->iy.f1 + 1);
       __pyx_t_9 = __pyx_t_8;
       for (__pyx_t_10 = __pyx_v_sub->iy.f0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
         __pyx_v_iy = __pyx_t_10;
 
-        /* "libfds/fields.pyx":567
+        /* "libfds/fields.pyx":575
  *             for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                 for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                     self.p[ix, iy] += S0 * profile[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.r[ix, iy] += (self.p[ix, iy] - self.p0) / (self.c0 * self.c0)
  *                     self.re[ix, iy] = self.p[ix, iy] / self.gaminusone
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_13 * __pyx_v_self->p.strides[0]) )) + __pyx_t_14)) )) += (__pyx_v_S0 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_profile.data + __pyx_t_11 * __pyx_v_profile.strides[0]) )) + __pyx_t_12)) ))));
 
-        /* "libfds/fields.pyx":568
+        /* "libfds/fields.pyx":576
  *                 for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                     self.p[ix, iy] += S0 * profile[ix, iy]
  *                     self.r[ix, iy] += (self.p[ix, iy] - self.p0) / (self.c0 * self.c0)             # <<<<<<<<<<<<<<
  *                     self.re[ix, iy] = self.p[ix, iy] / self.gaminusone
  * 
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_14 * __pyx_v_self->r.strides[0]) )) + __pyx_t_13)) )) += (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_12 * __pyx_v_self->p.strides[0]) )) + __pyx_t_11)) ))) - __pyx_v_self->p0) / (__pyx_v_self->c0 * __pyx_v_self->c0));
 
-        /* "libfds/fields.pyx":569
+        /* "libfds/fields.pyx":577
  *                     self.p[ix, iy] += S0 * profile[ix, iy]
  *                     self.r[ix, iy] += (self.p[ix, iy] - self.p0) / (self.c0 * self.c0)
  *                     self.re[ix, iy] = self.p[ix, iy] / self.gaminusone             # <<<<<<<<<<<<<<
  * 
  *     cdef void update_sources(self):
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_13 * __pyx_v_self->re.strides[0]) )) + __pyx_t_14)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_11 * __pyx_v_self->p.strides[0]) )) + __pyx_t_12)) ))) / __pyx_v_self->gaminusone);
       }
     }
 
-    /* "libfds/fields.pyx":564
+    /* "libfds/fields.pyx":572
  *         cdef double[:, ::1] profile = self.monopole_distribution(origin, B0)
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                 for iy in range(sub.iy[0], sub.iy[1] + 1):
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":557
+  /* "libfds/fields.pyx":565
  *         return m
  * 
  *     cdef void pulse(self, (Py_ssize_t, Py_ssize_t) origin, double S0, int B0):             # <<<<<<<<<<<<<<
  *         """ Pulse source initialization. """
  * 
  */
 
@@ -15524,15 +15560,15 @@
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.pulse", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __PYX_XDEC_MEMVIEW(&__pyx_v_profile, 1);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":571
+/* "libfds/fields.pyx":579
  *                     self.re[ix, iy] = self.p[ix, iy] / self.gaminusone
  * 
  *     cdef void update_sources(self):             # <<<<<<<<<<<<<<
  *         """ Update sources. """
  * 
  */
 
@@ -15562,102 +15598,102 @@
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_sources", 0);
 
-  /* "libfds/fields.pyx":577
+  /* "libfds/fields.pyx":585
  *         cdef Monopole2d s
  *         cdef Py_ssize_t ix, iy
  *         cdef Py_ssize_t it = self.cfg.it             # <<<<<<<<<<<<<<
  * 
  *         for s in self.src:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 577, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 585, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 577, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 585, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_it = __pyx_t_2;
 
-  /* "libfds/fields.pyx":579
+  /* "libfds/fields.pyx":587
  *         cdef Py_ssize_t it = self.cfg.it
  * 
  *         for s in self.src:             # <<<<<<<<<<<<<<
  *             for sub in self.cdomains:
  *                 if sub.mp:
  */
   if (unlikely(__pyx_v_self->src == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 579, __pyx_L1_error)
+    __PYX_ERR(0, 587, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->src; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 579, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 587, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 579, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 587, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Monopole2d))))) __PYX_ERR(0, 579, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Monopole2d))))) __PYX_ERR(0, 587, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_s, ((struct __pyx_obj_6libfds_6fields_Monopole2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":580
+    /* "libfds/fields.pyx":588
  * 
  *         for s in self.src:
  *             for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  */
     if (unlikely(__pyx_v_self->cdomains == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-      __PYX_ERR(0, 580, __pyx_L1_error)
+      __PYX_ERR(0, 588, __pyx_L1_error)
     }
     __pyx_t_3 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     for (;;) {
       if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 580, __pyx_L1_error)
+      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 588, __pyx_L1_error)
       #else
-      __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 580, __pyx_L1_error)
+      __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 588, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       #endif
-      if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 580, __pyx_L1_error)
+      if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 588, __pyx_L1_error)
       __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_5));
       __pyx_t_5 = 0;
 
-      /* "libfds/fields.pyx":581
+      /* "libfds/fields.pyx":589
  *         for s in self.src:
  *             for sub in self.cdomains:
  *                 if sub.mp:             # <<<<<<<<<<<<<<
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  */
       __pyx_t_6 = (__pyx_v_sub->mp != 0);
       if (__pyx_t_6) {
 
-        /* "libfds/fields.pyx":582
+        /* "libfds/fields.pyx":590
  *             for sub in self.cdomains:
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk
  */
         {
             #ifdef WITH_THREAD
             PyThreadState *_save;
             Py_UNBLOCK_THREADS
             __Pyx_FastGIL_Remember();
             #endif
             /*try:*/ {
-              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 582, __pyx_L11_error) }
+              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 590, __pyx_L11_error) }
               __pyx_t_7 = __pyx_v_sub->ix.f0;
-              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 582, __pyx_L11_error) }
+              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 590, __pyx_L11_error) }
               __pyx_t_8 = (__pyx_v_sub->ix.f1 + 1);
               if ((1 == 0)) abort();
               {
                   #if ((defined(__APPLE__) || defined(__OSX__)) && (defined(__GNUC__) && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))))
                       #undef likely
                       #undef unlikely
                       #define likely(x)   (x)
@@ -15675,27 +15711,27 @@
                           #endif /* _OPENMP */
                           for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_10; __pyx_t_9++){
                               {
                                   __pyx_v_ix = (Py_ssize_t)(__pyx_t_7 + 1 * __pyx_t_9);
                                   /* Initialize private variables to invalid values */
                                   __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                                  /* "libfds/fields.pyx":583
+                                  /* "libfds/fields.pyx":591
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):             # <<<<<<<<<<<<<<
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  */
                                   __pyx_t_11 = (__pyx_v_sub->iy.f1 + 1);
                                   __pyx_t_12 = __pyx_t_11;
                                   for (__pyx_t_13 = __pyx_v_sub->iy.f0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
                                     __pyx_v_iy = __pyx_t_13;
 
-                                    /* "libfds/fields.pyx":584
+                                    /* "libfds/fields.pyx":592
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk             # <<<<<<<<<<<<<<
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  *                 else:
  */
                                     __pyx_t_14 = __pyx_v_it;
@@ -15714,15 +15750,15 @@
                   #undef likely
                   #undef unlikely
                   #define likely(x)   __builtin_expect(!!(x), 1)
                   #define unlikely(x) __builtin_expect(!!(x), 0)
               #endif
             }
 
-            /* "libfds/fields.pyx":582
+            /* "libfds/fields.pyx":590
  *             for sub in self.cdomains:
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk
  */
             /*finally:*/ {
@@ -15740,50 +15776,50 @@
                 #endif
                 goto __pyx_L1_error;
               }
               __pyx_L12:;
             }
         }
 
-        /* "libfds/fields.pyx":581
+        /* "libfds/fields.pyx":589
  *         for s in self.src:
  *             for sub in self.cdomains:
  *                 if sub.mp:             # <<<<<<<<<<<<<<
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  */
         goto __pyx_L7;
       }
 
-      /* "libfds/fields.pyx":587
+      /* "libfds/fields.pyx":595
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  *                 else:
  *                     for ix in range(sub.ix[0], sub.ix[1] + 1):             # <<<<<<<<<<<<<<
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk
  */
       /*else*/ {
         __pyx_t_10 = (__pyx_v_sub->ix.f1 + 1);
         __pyx_t_9 = __pyx_t_10;
         for (__pyx_t_8 = __pyx_v_sub->ix.f0; __pyx_t_8 < __pyx_t_9; __pyx_t_8+=1) {
           __pyx_v_ix = __pyx_t_8;
 
-          /* "libfds/fields.pyx":588
+          /* "libfds/fields.pyx":596
  *                 else:
  *                     for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):             # <<<<<<<<<<<<<<
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  */
           __pyx_t_7 = (__pyx_v_sub->iy.f1 + 1);
           __pyx_t_11 = __pyx_t_7;
           for (__pyx_t_12 = __pyx_v_sub->iy.f0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
             __pyx_v_iy = __pyx_t_12;
 
-            /* "libfds/fields.pyx":589
+            /* "libfds/fields.pyx":597
  *                     for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             self.p[ix, iy] += s.evolution[it] * s.profile[ix, iy] #* self.dtrk             # <<<<<<<<<<<<<<
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  * 
  */
             __pyx_t_16 = __pyx_v_it;
@@ -15793,35 +15829,35 @@
             __pyx_t_17 = __pyx_v_iy;
             *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_18 * __pyx_v_self->p.strides[0]) )) + __pyx_t_17)) )) += ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_s->evolution.data) + __pyx_t_16)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_s->profile.data + __pyx_t_15 * __pyx_v_s->profile.strides[0]) )) + __pyx_t_14)) ))));
           }
         }
       }
       __pyx_L7:;
 
-      /* "libfds/fields.pyx":580
+      /* "libfds/fields.pyx":588
  * 
  *         for s in self.src:
  *             for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  */
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":579
+    /* "libfds/fields.pyx":587
  *         cdef Py_ssize_t it = self.cfg.it
  * 
  *         for s in self.src:             # <<<<<<<<<<<<<<
  *             for sub in self.cdomains:
  *                 if sub.mp:
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":571
+  /* "libfds/fields.pyx":579
  *                     self.re[ix, iy] = self.p[ix, iy] / self.gaminusone
  * 
  *     cdef void update_sources(self):             # <<<<<<<<<<<<<<
  *         """ Update sources. """
  * 
  */
 
@@ -15834,15 +15870,15 @@
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.update_sources", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_XDECREF((PyObject *)__pyx_v_s);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":592
+/* "libfds/fields.pyx":600
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  * 
  *     cdef void zero_obstacles(self):             # <<<<<<<<<<<<<<
  *         """ Set velocity to 0 in obstacles. """
  * 
  */
 
@@ -15865,225 +15901,225 @@
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("zero_obstacles", 0);
 
-  /* "libfds/fields.pyx":597
+  /* "libfds/fields.pyx":605
  *         cdef Py_ssize_t ix, iy
  * 
  *         for sub in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 597, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 597, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 605, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 605, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 605, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 597, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 597, __pyx_L1_error)
+          else __PYX_ERR(0, 605, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":598
+    /* "libfds/fields.pyx":606
  * 
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:             # <<<<<<<<<<<<<<
  *                 for iy in sub.ry:
  *                     self.ru[ix, iy] = 0
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_rx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_rx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 606, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_5 = __pyx_t_1; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
       __pyx_t_7 = NULL;
     } else {
-      __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 598, __pyx_L1_error)
+      __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 598, __pyx_L1_error)
+      __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 606, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_7)) {
         if (likely(PyList_CheckExact(__pyx_t_5))) {
           if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 598, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 606, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 598, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 606, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 598, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 606, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_7(__pyx_t_5);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 598, __pyx_L1_error)
+            else __PYX_ERR(0, 606, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
-      __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 598, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 606, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_v_ix = __pyx_t_8;
 
-      /* "libfds/fields.pyx":599
+      /* "libfds/fields.pyx":607
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:
  *                 for iy in sub.ry:             # <<<<<<<<<<<<<<
  *                     self.ru[ix, iy] = 0
  *                     self.rv[ix, iy] = 0
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_ry); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_ry); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
         __pyx_t_9 = __pyx_t_1; __Pyx_INCREF(__pyx_t_9); __pyx_t_8 = 0;
         __pyx_t_10 = NULL;
       } else {
-        __pyx_t_8 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 599, __pyx_L1_error)
+        __pyx_t_8 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 607, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 599, __pyx_L1_error)
+        __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 607, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       for (;;) {
         if (likely(!__pyx_t_10)) {
           if (likely(PyList_CheckExact(__pyx_t_9))) {
             if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_9)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 599, __pyx_L1_error)
+            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
             #else
-            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
+            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             #endif
           } else {
             if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 599, __pyx_L1_error)
+            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
             #else
-            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 599, __pyx_L1_error)
+            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 607, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             #endif
           }
         } else {
           __pyx_t_1 = __pyx_t_10(__pyx_t_9);
           if (unlikely(!__pyx_t_1)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 599, __pyx_L1_error)
+              else __PYX_ERR(0, 607, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_1);
         }
-        __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 599, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 607, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_v_iy = __pyx_t_11;
 
-        /* "libfds/fields.pyx":600
+        /* "libfds/fields.pyx":608
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  *                     self.ru[ix, iy] = 0             # <<<<<<<<<<<<<<
  *                     self.rv[ix, iy] = 0
  * 
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_12 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_13)) )) = 0.0;
 
-        /* "libfds/fields.pyx":601
+        /* "libfds/fields.pyx":609
  *                 for iy in sub.ry:
  *                     self.ru[ix, iy] = 0
  *                     self.rv[ix, iy] = 0             # <<<<<<<<<<<<<<
  * 
  *     cdef void update_odudtrk(self, double rk):
  */
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_13 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_12)) )) = 0.0;
 
-        /* "libfds/fields.pyx":599
+        /* "libfds/fields.pyx":607
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:
  *                 for iy in sub.ry:             # <<<<<<<<<<<<<<
  *                     self.ru[ix, iy] = 0
  *                     self.rv[ix, iy] = 0
  */
       }
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "libfds/fields.pyx":598
+      /* "libfds/fields.pyx":606
  * 
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:             # <<<<<<<<<<<<<<
  *                 for iy in sub.ry:
  *                     self.ru[ix, iy] = 0
  */
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "libfds/fields.pyx":597
+    /* "libfds/fields.pyx":605
  *         cdef Py_ssize_t ix, iy
  * 
  *         for sub in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":592
+  /* "libfds/fields.pyx":600
  *                             #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  * 
  *     cdef void zero_obstacles(self):             # <<<<<<<<<<<<<<
  *         """ Set velocity to 0 in obstacles. """
  * 
  */
 
@@ -16096,15 +16132,15 @@
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.zero_obstacles", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":603
+/* "libfds/fields.pyx":611
  *                     self.rv[ix, iy] = 0
  * 
  *     cdef void update_odudtrk(self, double rk):             # <<<<<<<<<<<<<<
  * 
  *         self.dtrk = rk * self.cfg.dt
  */
 
@@ -16122,86 +16158,86 @@
   PyObject *__pyx_t_10 = NULL;
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_odudtrk", 0);
 
-  /* "libfds/fields.pyx":605
+  /* "libfds/fields.pyx":613
  *     cdef void update_odudtrk(self, double rk):
  * 
  *         self.dtrk = rk * self.cfg.dt             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_x == 's':
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_rk); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_rk); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 605, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 605, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 605, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 613, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_self->dtrk = __pyx_t_4;
 
-  /* "libfds/fields.pyx":607
+  /* "libfds/fields.pyx":615
  *         self.dtrk = rk * self.cfg.dt
  * 
  *         if self.flag_x == 's':             # <<<<<<<<<<<<<<
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 607, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 615, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":608
+    /* "libfds/fields.pyx":616
  * 
  *         if self.flag_x == 's':
  *             self.odxdtrk = - self.odxdt * rk             # <<<<<<<<<<<<<<
  *         elif self.flag_x == 'v':
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  */
     __pyx_v_self->odxdtrk = ((-__pyx_v_self->odxdt) * __pyx_v_rk);
 
-    /* "libfds/fields.pyx":607
+    /* "libfds/fields.pyx":615
  *         self.dtrk = rk * self.cfg.dt
  * 
  *         if self.flag_x == 's':             # <<<<<<<<<<<<<<
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":609
+  /* "libfds/fields.pyx":617
  *         if self.flag_x == 's':
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 609, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 617, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":610
+    /* "libfds/fields.pyx":618
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_y == 's':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->odxdt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
+    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->odxdt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 610, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_8 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -16210,118 +16246,118 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_1, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 618, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_1, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 618, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 610, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 618, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       if (__pyx_t_8) {
         __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_t_7);
       __pyx_t_1 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 610, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 618, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 610, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 618, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odxdtrk_v, 0);
     __pyx_v_self->odxdtrk_v = __pyx_t_11;
     __pyx_t_11.memview = NULL;
     __pyx_t_11.data = NULL;
 
-    /* "libfds/fields.pyx":609
+    /* "libfds/fields.pyx":617
  *         if self.flag_x == 's':
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  */
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":612
+  /* "libfds/fields.pyx":620
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  *         if self.flag_y == 's':             # <<<<<<<<<<<<<<
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 612, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 620, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":613
+    /* "libfds/fields.pyx":621
  * 
  *         if self.flag_y == 's':
  *             self.odydtrk = - self.odydt * rk             # <<<<<<<<<<<<<<
  *         elif self.flag_y == 'v':
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  */
     __pyx_v_self->odydtrk = ((-__pyx_v_self->odydt) * __pyx_v_rk);
 
-    /* "libfds/fields.pyx":612
+    /* "libfds/fields.pyx":620
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  *         if self.flag_y == 's':             # <<<<<<<<<<<<<<
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':
  */
     goto __pyx_L4;
   }
 
-  /* "libfds/fields.pyx":614
+  /* "libfds/fields.pyx":622
  *         if self.flag_y == 's':
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 614, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 622, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":615
+    /* "libfds/fields.pyx":623
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':
  *             self.odydtrk_v = mult(self.odydt_v, - rk)             # <<<<<<<<<<<<<<
  * 
  *     cdef void update(self, str var):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 615, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_self->odydt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 615, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_self->odydt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 615, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_1 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -16330,66 +16366,66 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_10, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_10, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_1) {
         __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_10);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_9, __pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_9, __pyx_t_7);
       __pyx_t_10 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 615, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 615, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 623, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odydtrk_v, 0);
     __pyx_v_self->odydtrk_v = __pyx_t_11;
     __pyx_t_11.memview = NULL;
     __pyx_t_11.data = NULL;
 
-    /* "libfds/fields.pyx":614
+    /* "libfds/fields.pyx":622
  *         if self.flag_y == 's':
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  */
   }
   __pyx_L4:;
 
-  /* "libfds/fields.pyx":603
+  /* "libfds/fields.pyx":611
  *                     self.rv[ix, iy] = 0
  * 
  *     cdef void update_odudtrk(self, double rk):             # <<<<<<<<<<<<<<
  * 
  *         self.dtrk = rk * self.cfg.dt
  */
 
@@ -16404,15 +16440,15 @@
   __Pyx_XDECREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_11, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.update_odudtrk", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":617
+/* "libfds/fields.pyx":625
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  *     cdef void update(self, str var):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -16425,194 +16461,194 @@
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "libfds/fields.pyx":621
+  /* "libfds/fields.pyx":629
  *         cdef Domain2d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 621, __pyx_L1_error)
+    __PYX_ERR(0, 629, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 621, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 629, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 621, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 629, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":622
+    /* "libfds/fields.pyx":630
  * 
  *         for sub in self.cdomains:
  *             if var == 'p':             # <<<<<<<<<<<<<<
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'K':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_p, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 622, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_p, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 630, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":623
+      /* "libfds/fields.pyx":631
  *         for sub in self.cdomains:
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields2d__update_p(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":622
+      /* "libfds/fields.pyx":630
  * 
  *         for sub in self.cdomains:
  *             if var == 'p':             # <<<<<<<<<<<<<<
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'K':
  */
     }
 
-    /* "libfds/fields.pyx":624
+    /* "libfds/fields.pyx":632
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'K':             # <<<<<<<<<<<<<<
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'Tk':
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_K, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 624, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_K, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 632, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":625
+      /* "libfds/fields.pyx":633
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields2d__update_K(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":624
+      /* "libfds/fields.pyx":632
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'K':             # <<<<<<<<<<<<<<
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'Tk':
  */
     }
 
-    /* "libfds/fields.pyx":626
+    /* "libfds/fields.pyx":634
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'Tk':             # <<<<<<<<<<<<<<
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'V':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_Tk, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 626, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_Tk, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 634, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":627
+      /* "libfds/fields.pyx":635
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields2d__update_Tk(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":626
+      /* "libfds/fields.pyx":634
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'Tk':             # <<<<<<<<<<<<<<
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'V':
  */
     }
 
-    /* "libfds/fields.pyx":628
+    /* "libfds/fields.pyx":636
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'V':             # <<<<<<<<<<<<<<
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'wz':
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_V, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 628, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_V, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 636, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":629
+      /* "libfds/fields.pyx":637
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'wz':
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields2d__update_V(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":628
+      /* "libfds/fields.pyx":636
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'V':             # <<<<<<<<<<<<<<
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'wz':
  */
     }
 
-    /* "libfds/fields.pyx":630
+    /* "libfds/fields.pyx":638
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'wz':             # <<<<<<<<<<<<<<
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wz, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 630, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wz, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 638, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":631
+      /* "libfds/fields.pyx":639
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'wz':
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_p(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
       __pyx_f_6libfds_6fields_8Fields2d__update_wz(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":630
+      /* "libfds/fields.pyx":638
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  *             if var == 'wz':             # <<<<<<<<<<<<<<
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
     }
 
-    /* "libfds/fields.pyx":621
+    /* "libfds/fields.pyx":629
  *         cdef Domain2d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":617
+  /* "libfds/fields.pyx":625
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  *     cdef void update(self, str var):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -16623,15 +16659,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.update", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":633
+/* "libfds/fields.pyx":641
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _update_p(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -16659,25 +16695,25 @@
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   Py_ssize_t __pyx_t_21;
   Py_ssize_t __pyx_t_22;
   __Pyx_RefNannySetupContext("_update_p", 0);
 
-  /* "libfds/fields.pyx":637
+  /* "libfds/fields.pyx":645
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":638
+    /* "libfds/fields.pyx":646
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  */
     {
@@ -16709,71 +16745,71 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":639
+                              /* "libfds/fields.pyx":647
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":640
+                                /* "libfds/fields.pyx":648
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -             # <<<<<<<<<<<<<<
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
 
-                                /* "libfds/fields.pyx":641
+                                /* "libfds/fields.pyx":649
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  *         else:
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
 
-                                /* "libfds/fields.pyx":642
+                                /* "libfds/fields.pyx":650
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = __pyx_v_iy;
                                 __pyx_t_17 = __pyx_v_ix;
                                 __pyx_t_18 = __pyx_v_iy;
 
-                                /* "libfds/fields.pyx":641
+                                /* "libfds/fields.pyx":649
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  *         else:
  */
                                 __pyx_t_19 = __pyx_v_ix;
                                 __pyx_t_20 = __pyx_v_iy;
 
-                                /* "libfds/fields.pyx":640
+                                /* "libfds/fields.pyx":648
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -             # <<<<<<<<<<<<<<
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  */
                                 __pyx_t_21 = __pyx_v_ix;
@@ -16789,15 +16825,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":638
+        /* "libfds/fields.pyx":646
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  */
         /*finally:*/ {
@@ -16808,121 +16844,121 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":637
+    /* "libfds/fields.pyx":645
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":644
+  /* "libfds/fields.pyx":652
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":645
+      /* "libfds/fields.pyx":653
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":646
+        /* "libfds/fields.pyx":654
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -             # <<<<<<<<<<<<<<
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  */
         __pyx_t_20 = __pyx_v_ix;
         __pyx_t_19 = __pyx_v_iy;
 
-        /* "libfds/fields.pyx":647
+        /* "libfds/fields.pyx":655
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  * 
  */
         __pyx_t_18 = __pyx_v_ix;
         __pyx_t_17 = __pyx_v_iy;
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
 
-        /* "libfds/fields.pyx":648
+        /* "libfds/fields.pyx":656
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_K(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
 
-        /* "libfds/fields.pyx":647
+        /* "libfds/fields.pyx":655
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
 
-        /* "libfds/fields.pyx":646
+        /* "libfds/fields.pyx":654
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.p[ix, iy] = (self.re[ix, iy] -             # <<<<<<<<<<<<<<
  *                                     0.5 * (self.ru[ix, iy] * self.ru[ix, iy] +
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  */
         __pyx_t_22 = __pyx_v_ix;
         __pyx_t_21 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_22 * __pyx_v_self->p.strides[0]) )) + __pyx_t_21)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_20 * __pyx_v_self->re.strides[0]) )) + __pyx_t_19)) ))) - ((0.5 * (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_18 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_17)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_16 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_15)) )))) + ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_14 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_13)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_12 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_11)) )))))) / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_10 * __pyx_v_self->r.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_self->gaminusone);
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":633
+  /* "libfds/fields.pyx":641
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _update_p(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":650
+/* "libfds/fields.pyx":658
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  * 
  *     cdef void _update_K(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -16940,25 +16976,25 @@
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   __Pyx_RefNannySetupContext("_update_K", 0);
 
-  /* "libfds/fields.pyx":654
+  /* "libfds/fields.pyx":662
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":655
+    /* "libfds/fields.pyx":663
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]
  */
     {
@@ -16990,27 +17026,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":656
+                              /* "libfds/fields.pyx":664
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":657
+                                /* "libfds/fields.pyx":665
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -17028,15 +17064,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":655
+        /* "libfds/fields.pyx":663
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]
  */
         /*finally:*/ {
@@ -17047,15 +17083,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":658
+    /* "libfds/fields.pyx":666
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  */
     {
@@ -17087,27 +17123,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":659
+                              /* "libfds/fields.pyx":667
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":660
+                                /* "libfds/fields.pyx":668
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -17125,15 +17161,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":658
+        /* "libfds/fields.pyx":666
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  */
         /*finally:*/ {
@@ -17144,15 +17180,15 @@
             #endif
             goto __pyx_L17;
           }
           __pyx_L17:;
         }
     }
 
-    /* "libfds/fields.pyx":661
+    /* "libfds/fields.pyx":669
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  */
     {
@@ -17184,27 +17220,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":662
+                              /* "libfds/fields.pyx":670
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":663
+                                /* "libfds/fields.pyx":671
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -17222,15 +17258,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":661
+        /* "libfds/fields.pyx":669
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  */
         /*finally:*/ {
@@ -17241,15 +17277,15 @@
             #endif
             goto __pyx_L28;
           }
           __pyx_L28:;
         }
     }
 
-    /* "libfds/fields.pyx":664
+    /* "libfds/fields.pyx":672
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  */
     {
@@ -17281,27 +17317,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":665
+                              /* "libfds/fields.pyx":673
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  *         else:
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":666
+                                /* "libfds/fields.pyx":674
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ke[ix, iy] = self.re[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -17319,15 +17355,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":664
+        /* "libfds/fields.pyx":672
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  */
         /*finally:*/ {
@@ -17338,167 +17374,167 @@
             #endif
             goto __pyx_L39;
           }
           __pyx_L39:;
         }
     }
 
-    /* "libfds/fields.pyx":654
+    /* "libfds/fields.pyx":662
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":668
+  /* "libfds/fields.pyx":676
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]
  */
   /*else*/ {
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/fields.pyx":669
+      /* "libfds/fields.pyx":677
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":670
+        /* "libfds/fields.pyx":678
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->K.data + __pyx_t_11 * __pyx_v_self->K.strides[0]) )) + __pyx_t_12)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_9 * __pyx_v_self->r.strides[0]) )) + __pyx_t_10)) )));
       }
     }
 
-    /* "libfds/fields.pyx":671
+    /* "libfds/fields.pyx":679
  *                 for iy in range(iymin, iymax + 1):
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/fields.pyx":672
+      /* "libfds/fields.pyx":680
  *                     self.K[ix, iy] = self.r[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":673
+        /* "libfds/fields.pyx":681
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->Ku.data + __pyx_t_12 * __pyx_v_self->Ku.strides[0]) )) + __pyx_t_11)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_10 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_9)) )));
       }
     }
 
-    /* "libfds/fields.pyx":674
+    /* "libfds/fields.pyx":682
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/fields.pyx":675
+      /* "libfds/fields.pyx":683
  *                     self.Ku[ix, iy] = self.ru[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":676
+        /* "libfds/fields.pyx":684
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->Kv.data + __pyx_t_11 * __pyx_v_self->Kv.strides[0]) )) + __pyx_t_12)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_9 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_10)) )));
       }
     }
 
-    /* "libfds/fields.pyx":677
+    /* "libfds/fields.pyx":685
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/fields.pyx":678
+      /* "libfds/fields.pyx":686
  *                     self.Kv[ix, iy] = self.rv[ix, iy]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":679
+        /* "libfds/fields.pyx":687
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ke[ix, iy] = self.re[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_Tk(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
         __pyx_t_10 = __pyx_v_ix;
@@ -17507,27 +17543,27 @@
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->Ke.data + __pyx_t_12 * __pyx_v_self->Ke.strides[0]) )) + __pyx_t_11)) )) = (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_10 * __pyx_v_self->re.strides[0]) )) + __pyx_t_9)) )));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":650
+  /* "libfds/fields.pyx":658
  *                                     self.rv[ix, iy] * self.rv[ix, iy]) / self.r[ix, iy]) * self.gaminusone
  * 
  *     cdef void _update_K(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":681
+/* "libfds/fields.pyx":689
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  * 
  *     cdef void _update_Tk(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -17547,25 +17583,25 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   __Pyx_RefNannySetupContext("_update_Tk", 0);
 
-  /* "libfds/fields.pyx":685
+  /* "libfds/fields.pyx":693
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":686
+    /* "libfds/fields.pyx":694
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  */
     {
@@ -17597,27 +17633,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":687
+                              /* "libfds/fields.pyx":695
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  *         else:
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":688
+                                /* "libfds/fields.pyx":696
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -17637,15 +17673,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":686
+        /* "libfds/fields.pyx":694
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  */
         /*finally:*/ {
@@ -17656,50 +17692,50 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":685
+    /* "libfds/fields.pyx":693
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":690
+  /* "libfds/fields.pyx":698
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":691
+      /* "libfds/fields.pyx":699
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  * 
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":692
+        /* "libfds/fields.pyx":700
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_V(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
         __pyx_t_12 = __pyx_v_ix;
@@ -17710,27 +17746,27 @@
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->Tk.data + __pyx_t_14 * __pyx_v_self->Tk.strides[0]) )) + __pyx_t_13)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_12 * __pyx_v_self->p.strides[0]) )) + __pyx_t_11)) ))) / ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_10 * __pyx_v_self->r.strides[0]) )) + __pyx_t_9)) ))) * __pyx_v_self->cpmcv));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":681
+  /* "libfds/fields.pyx":689
  *                     self.Ke[ix, iy] = self.re[ix, iy]
  * 
  *     cdef void _update_Tk(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":694
+/* "libfds/fields.pyx":702
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  * 
  *     cdef void _update_V(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -17750,25 +17786,25 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   __Pyx_RefNannySetupContext("_update_V", 0);
 
-  /* "libfds/fields.pyx":698
+  /* "libfds/fields.pyx":706
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":699
+    /* "libfds/fields.pyx":707
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  */
     {
@@ -17800,27 +17836,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":700
+                              /* "libfds/fields.pyx":708
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":701
+                                /* "libfds/fields.pyx":709
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -17840,15 +17876,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":699
+        /* "libfds/fields.pyx":707
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  */
         /*finally:*/ {
@@ -17859,15 +17895,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":703
+    /* "libfds/fields.pyx":711
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  */
     {
@@ -17899,27 +17935,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":704
+                              /* "libfds/fields.pyx":712
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  *         else:
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":705
+                                /* "libfds/fields.pyx":713
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_12 = __pyx_v_ix;
@@ -17939,15 +17975,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":703
+        /* "libfds/fields.pyx":711
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  */
         /*finally:*/ {
@@ -17958,50 +17994,50 @@
             #endif
             goto __pyx_L17;
           }
           __pyx_L17:;
         }
     }
 
-    /* "libfds/fields.pyx":698
+    /* "libfds/fields.pyx":706
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":707
+  /* "libfds/fields.pyx":715
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  */
   /*else*/ {
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/fields.pyx":708
+      /* "libfds/fields.pyx":716
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":709
+        /* "libfds/fields.pyx":717
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_9 = __pyx_v_ix;
@@ -18010,39 +18046,39 @@
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->Ee.data + __pyx_t_13 * __pyx_v_self->Ee.strides[0]) )) + __pyx_t_14)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_9 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_10)) ))) / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_11 * __pyx_v_self->r.strides[0]) )) + __pyx_t_12)) ))));
       }
     }
 
-    /* "libfds/fields.pyx":711
+    /* "libfds/fields.pyx":719
  *                     self.Ee[ix, iy] = self.ru[ix, iy] / self.r[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/fields.pyx":712
+      /* "libfds/fields.pyx":720
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":713
+        /* "libfds/fields.pyx":721
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_wz(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
         __pyx_t_12 = __pyx_v_ix;
@@ -18053,27 +18089,27 @@
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->Fe.data + __pyx_t_14 * __pyx_v_self->Fe.strides[0]) )) + __pyx_t_13)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_12 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_11)) ))) / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_10 * __pyx_v_self->r.strides[0]) )) + __pyx_t_9)) ))));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":694
+  /* "libfds/fields.pyx":702
  *                     self.Tk[ix, iy] = self.p[ix, iy] / (self.r[ix, iy] * self.cpmcv)
  * 
  *     cdef void _update_V(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":715
+/* "libfds/fields.pyx":723
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  * 
  *     cdef void _update_wz(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -18093,25 +18129,25 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   __Pyx_RefNannySetupContext("_update_wz", 0);
 
-  /* "libfds/fields.pyx":719
+  /* "libfds/fields.pyx":727
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":720
+    /* "libfds/fields.pyx":728
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  */
     {
@@ -18143,27 +18179,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":721
+                              /* "libfds/fields.pyx":729
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  *         else:
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":722
+                                /* "libfds/fields.pyx":730
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -18183,15 +18219,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":720
+        /* "libfds/fields.pyx":728
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  */
         /*finally:*/ {
@@ -18202,50 +18238,50 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":719
+    /* "libfds/fields.pyx":727
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":724
+  /* "libfds/fields.pyx":732
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":725
+      /* "libfds/fields.pyx":733
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  * 
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":726
+        /* "libfds/fields.pyx":734
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     cpdef double residual(self):
  */
         __pyx_t_12 = __pyx_v_ix;
@@ -18256,27 +18292,27 @@
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->wz.data + __pyx_t_14 * __pyx_v_self->wz.strides[0]) )) + __pyx_t_13)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->F.data + __pyx_t_12 * __pyx_v_self->F.strides[0]) )) + __pyx_t_11)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->E.data + __pyx_t_10 * __pyx_v_self->E.strides[0]) )) + __pyx_t_9)) ))));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":715
+  /* "libfds/fields.pyx":723
  *                     self.Fe[ix, iy] = self.rv[ix, iy] / self.r[ix, iy]
  * 
  *     cdef void _update_wz(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":728
+/* "libfds/fields.pyx":736
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  * 
  *     cpdef double residual(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double res = 0
  */
 
@@ -18290,77 +18326,77 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("residual", 0);
 
-  /* "libfds/fields.pyx":730
+  /* "libfds/fields.pyx":738
  *     cpdef double residual(self):
  * 
  *         cdef double res = 0             # <<<<<<<<<<<<<<
  *         cdef Domain2d sub
  * 
  */
   __pyx_v_res = 0.0;
 
-  /* "libfds/fields.pyx":733
+  /* "libfds/fields.pyx":741
  *         cdef Domain2d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 733, __pyx_L1_error)
+    __PYX_ERR(0, 741, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 741, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 733, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 733, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 741, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":734
+    /* "libfds/fields.pyx":742
  * 
  *         for sub in self.cdomains:
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         return sqrt(res / self.nsize)
  */
     __pyx_v_res = (__pyx_v_res + __pyx_f_6libfds_6fields_8Fields2d__residual(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp));
 
-    /* "libfds/fields.pyx":733
+    /* "libfds/fields.pyx":741
  *         cdef Domain2d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":736
+  /* "libfds/fields.pyx":744
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *         return sqrt(res / self.nsize)             # <<<<<<<<<<<<<<
  * 
  *     cdef double _residual(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
   __pyx_r = sqrt((__pyx_v_res / ((double)__pyx_v_self->nsize)));
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":728
+  /* "libfds/fields.pyx":736
  *                     self.wz[ix, iy] = self.F[ix, iy] - self.E[ix, iy]
  * 
  *     cpdef double residual(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double res = 0
  */
 
@@ -18394,15 +18430,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("residual", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_6libfds_6fields_8Fields2d_residual(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_6libfds_6fields_8Fields2d_residual(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -18411,15 +18447,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":738
+/* "libfds/fields.pyx":746
  *         return sqrt(res / self.nsize)
  * 
  *     cdef double _residual(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -18438,34 +18474,34 @@
   Py_ssize_t __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   __Pyx_RefNannySetupContext("_residual", 0);
 
-  /* "libfds/fields.pyx":741
+  /* "libfds/fields.pyx":749
  * 
  *         cdef Py_ssize_t ix, iy
  *         cdef double res = 0             # <<<<<<<<<<<<<<
  *         cdef double pa
  * 
  */
   __pyx_v_res = 0.0;
 
-  /* "libfds/fields.pyx":744
+  /* "libfds/fields.pyx":752
  *         cdef double pa
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":745
+    /* "libfds/fields.pyx":753
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0
  */
     {
@@ -18498,38 +18534,38 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_pa = ((double)__PYX_NAN());
 
-                              /* "libfds/fields.pyx":746
+                              /* "libfds/fields.pyx":754
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     pa = self.p[ix, iy] - self.p0
  *                     res += pa * pa
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":747
+                                /* "libfds/fields.pyx":755
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0             # <<<<<<<<<<<<<<
  *                     res += pa * pa
  *         else:
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_v_pa = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_9 * __pyx_v_self->p.strides[0]) )) + __pyx_t_10)) ))) - __pyx_v_self->p0);
 
-                                /* "libfds/fields.pyx":748
+                                /* "libfds/fields.pyx":756
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0
  *                     res += pa * pa             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_v_res = (__pyx_v_res + (__pyx_v_pa * __pyx_v_pa));
@@ -18543,15 +18579,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":745
+        /* "libfds/fields.pyx":753
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0
  */
         /*finally:*/ {
@@ -18562,98 +18598,98 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":744
+    /* "libfds/fields.pyx":752
  *         cdef double pa
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":750
+  /* "libfds/fields.pyx":758
  *                     res += pa * pa
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":751
+      /* "libfds/fields.pyx":759
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     pa = self.p[ix, iy] - self.p0
  *                     res += pa * pa
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":752
+        /* "libfds/fields.pyx":760
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0             # <<<<<<<<<<<<<<
  *                     res += pa * pa
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_v_pa = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_10 * __pyx_v_self->p.strides[0]) )) + __pyx_t_9)) ))) - __pyx_v_self->p0);
 
-        /* "libfds/fields.pyx":753
+        /* "libfds/fields.pyx":761
  *                 for iy in range(iymin, iymax + 1):
  *                     pa = self.p[ix, iy] - self.p0
  *                     res += pa * pa             # <<<<<<<<<<<<<<
  * 
  *         return res
  */
         __pyx_v_res = (__pyx_v_res + (__pyx_v_pa * __pyx_v_pa));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":755
+  /* "libfds/fields.pyx":763
  *                     res += pa * pa
  * 
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     cdef void phys2num(self):
  */
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":738
+  /* "libfds/fields.pyx":746
  *         return sqrt(res / self.nsize)
  * 
  *     cdef double _residual(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":757
+/* "libfds/fields.pyx":765
  *         return res
  * 
  *     cdef void phys2num(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -18664,71 +18700,71 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("phys2num", 0);
 
-  /* "libfds/fields.pyx":761
+  /* "libfds/fields.pyx":769
  *         cdef Domain2d sub
  * 
  *         self.grid = 'numerical'             # <<<<<<<<<<<<<<
  *         for sub in self.cdomains:
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
   __Pyx_INCREF(__pyx_n_u_numerical);
   __Pyx_GIVEREF(__pyx_n_u_numerical);
   __Pyx_GOTREF(__pyx_v_self->grid);
   __Pyx_DECREF(__pyx_v_self->grid);
   __pyx_v_self->grid = __pyx_n_u_numerical;
 
-  /* "libfds/fields.pyx":762
+  /* "libfds/fields.pyx":770
  * 
  *         self.grid = 'numerical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 762, __pyx_L1_error)
+    __PYX_ERR(0, 770, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 762, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 770, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 762, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 770, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 762, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 770, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":763
+    /* "libfds/fields.pyx":771
  *         self.grid = 'numerical'
  *         for sub in self.cdomains:
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _phys2num(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
     __pyx_f_6libfds_6fields_8Fields2d__phys2num(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-    /* "libfds/fields.pyx":762
+    /* "libfds/fields.pyx":770
  * 
  *         self.grid = 'numerical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":757
+  /* "libfds/fields.pyx":765
  *         return res
  * 
  *     cdef void phys2num(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -18739,15 +18775,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.phys2num", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":765
+/* "libfds/fields.pyx":773
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _phys2num(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -18765,25 +18801,25 @@
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   __Pyx_RefNannySetupContext("_phys2num", 0);
 
-  /* "libfds/fields.pyx":769
+  /* "libfds/fields.pyx":777
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":770
+    /* "libfds/fields.pyx":778
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]
  */
     {
@@ -18815,66 +18851,66 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":771
+                              /* "libfds/fields.pyx":779
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.r[ix, iy] /= self.J[ix, iy]
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":772
+                                /* "libfds/fields.pyx":780
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  *                     self.rv[ix, iy] /= self.J[ix, iy]
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_11 * __pyx_v_self->r.strides[0]) )) + __pyx_t_12)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-                                /* "libfds/fields.pyx":773
+                                /* "libfds/fields.pyx":781
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]
  *                     self.ru[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.rv[ix, iy] /= self.J[ix, iy]
  *                     self.re[ix, iy] /= self.J[ix, iy]
  */
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_12 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_11)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_10 * __pyx_v_self->J.strides[0]) )) + __pyx_t_9)) )));
 
-                                /* "libfds/fields.pyx":774
+                                /* "libfds/fields.pyx":782
  *                     self.r[ix, iy] /= self.J[ix, iy]
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  *                     self.rv[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.re[ix, iy] /= self.J[ix, iy]
  *         else:
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_11 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_12)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-                                /* "libfds/fields.pyx":775
+                                /* "libfds/fields.pyx":783
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  *                     self.rv[ix, iy] /= self.J[ix, iy]
  *                     self.re[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -18892,15 +18928,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":770
+        /* "libfds/fields.pyx":778
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]
  */
         /*finally:*/ {
@@ -18911,89 +18947,89 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":769
+    /* "libfds/fields.pyx":777
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":777
+  /* "libfds/fields.pyx":785
  *                     self.re[ix, iy] /= self.J[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":778
+      /* "libfds/fields.pyx":786
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.r[ix, iy] /= self.J[ix, iy]
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":779
+        /* "libfds/fields.pyx":787
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  *                     self.rv[ix, iy] /= self.J[ix, iy]
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_11 * __pyx_v_self->r.strides[0]) )) + __pyx_t_12)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-        /* "libfds/fields.pyx":780
+        /* "libfds/fields.pyx":788
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] /= self.J[ix, iy]
  *                     self.ru[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.rv[ix, iy] /= self.J[ix, iy]
  *                     self.re[ix, iy] /= self.J[ix, iy]
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_12 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_11)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_10 * __pyx_v_self->J.strides[0]) )) + __pyx_t_9)) )));
 
-        /* "libfds/fields.pyx":781
+        /* "libfds/fields.pyx":789
  *                     self.r[ix, iy] /= self.J[ix, iy]
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  *                     self.rv[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.re[ix, iy] /= self.J[ix, iy]
  * 
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_11 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_12)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-        /* "libfds/fields.pyx":782
+        /* "libfds/fields.pyx":790
  *                     self.ru[ix, iy] /= self.J[ix, iy]
  *                     self.rv[ix, iy] /= self.J[ix, iy]
  *                     self.re[ix, iy] /= self.J[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     cdef void num2phys(self):
  */
         __pyx_t_10 = __pyx_v_ix;
@@ -19002,27 +19038,27 @@
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_12 * __pyx_v_self->re.strides[0]) )) + __pyx_t_11)) )) /= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_10 * __pyx_v_self->J.strides[0]) )) + __pyx_t_9)) )));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":765
+  /* "libfds/fields.pyx":773
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _phys2num(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":784
+/* "libfds/fields.pyx":792
  *                     self.re[ix, iy] /= self.J[ix, iy]
  * 
  *     cdef void num2phys(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -19033,71 +19069,71 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("num2phys", 0);
 
-  /* "libfds/fields.pyx":788
+  /* "libfds/fields.pyx":796
  *         cdef Domain2d sub
  * 
  *         self.grid = 'physical'             # <<<<<<<<<<<<<<
  *         for sub in self.cdomains:
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  */
   __Pyx_INCREF(__pyx_n_u_physical);
   __Pyx_GIVEREF(__pyx_n_u_physical);
   __Pyx_GOTREF(__pyx_v_self->grid);
   __Pyx_DECREF(__pyx_v_self->grid);
   __pyx_v_self->grid = __pyx_n_u_physical;
 
-  /* "libfds/fields.pyx":789
+  /* "libfds/fields.pyx":797
  * 
  *         self.grid = 'physical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 789, __pyx_L1_error)
+    __PYX_ERR(0, 797, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 789, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 797, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 789, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 797, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 789, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 797, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":790
+    /* "libfds/fields.pyx":798
  *         self.grid = 'physical'
  *         for sub in self.cdomains:
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _num2phys(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
     __pyx_f_6libfds_6fields_8Fields2d__num2phys(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-    /* "libfds/fields.pyx":789
+    /* "libfds/fields.pyx":797
  * 
  *         self.grid = 'physical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":784
+  /* "libfds/fields.pyx":792
  *                     self.re[ix, iy] /= self.J[ix, iy]
  * 
  *     cdef void num2phys(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -19108,15 +19144,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fields.Fields2d.num2phys", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":792
+/* "libfds/fields.pyx":800
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _num2phys(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -19134,25 +19170,25 @@
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   __Pyx_RefNannySetupContext("_num2phys", 0);
 
-  /* "libfds/fields.pyx":796
+  /* "libfds/fields.pyx":804
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":797
+    /* "libfds/fields.pyx":805
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]
  */
     {
@@ -19184,66 +19220,66 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":798
+                              /* "libfds/fields.pyx":806
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.r[ix, iy] *= self.J[ix, iy]
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":799
+                                /* "libfds/fields.pyx":807
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  *                     self.rv[ix, iy] *= self.J[ix, iy]
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_11 * __pyx_v_self->r.strides[0]) )) + __pyx_t_12)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-                                /* "libfds/fields.pyx":800
+                                /* "libfds/fields.pyx":808
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]
  *                     self.ru[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.rv[ix, iy] *= self.J[ix, iy]
  *                     self.re[ix, iy] *= self.J[ix, iy]
  */
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_12 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_11)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_10 * __pyx_v_self->J.strides[0]) )) + __pyx_t_9)) )));
 
-                                /* "libfds/fields.pyx":801
+                                /* "libfds/fields.pyx":809
  *                     self.r[ix, iy] *= self.J[ix, iy]
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  *                     self.rv[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.re[ix, iy] *= self.J[ix, iy]
  *         else:
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_11 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_12)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-                                /* "libfds/fields.pyx":802
+                                /* "libfds/fields.pyx":810
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  *                     self.rv[ix, iy] *= self.J[ix, iy]
  *                     self.re[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -19261,15 +19297,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":797
+        /* "libfds/fields.pyx":805
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]
  */
         /*finally:*/ {
@@ -19280,89 +19316,89 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":796
+    /* "libfds/fields.pyx":804
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":804
+  /* "libfds/fields.pyx":812
  *                     self.re[ix, iy] *= self.J[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":805
+      /* "libfds/fields.pyx":813
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.r[ix, iy] *= self.J[ix, iy]
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":806
+        /* "libfds/fields.pyx":814
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  *                     self.rv[ix, iy] *= self.J[ix, iy]
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_11 * __pyx_v_self->r.strides[0]) )) + __pyx_t_12)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-        /* "libfds/fields.pyx":807
+        /* "libfds/fields.pyx":815
  *                 for iy in range(iymin, iymax + 1):
  *                     self.r[ix, iy] *= self.J[ix, iy]
  *                     self.ru[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.rv[ix, iy] *= self.J[ix, iy]
  *                     self.re[ix, iy] *= self.J[ix, iy]
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_12 * __pyx_v_self->ru.strides[0]) )) + __pyx_t_11)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_10 * __pyx_v_self->J.strides[0]) )) + __pyx_t_9)) )));
 
-        /* "libfds/fields.pyx":808
+        /* "libfds/fields.pyx":816
  *                     self.r[ix, iy] *= self.J[ix, iy]
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  *                     self.rv[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.re[ix, iy] *= self.J[ix, iy]
  * 
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_11 * __pyx_v_self->rv.strides[0]) )) + __pyx_t_12)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_9 * __pyx_v_self->J.strides[0]) )) + __pyx_t_10)) )));
 
-        /* "libfds/fields.pyx":809
+        /* "libfds/fields.pyx":817
  *                     self.ru[ix, iy] *= self.J[ix, iy]
  *                     self.rv[ix, iy] *= self.J[ix, iy]
  *                     self.re[ix, iy] *= self.J[ix, iy]             # <<<<<<<<<<<<<<
  * 
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
@@ -19371,15 +19407,15 @@
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_12 * __pyx_v_self->re.strides[0]) )) + __pyx_t_11)) )) *= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_10 * __pyx_v_self->J.strides[0]) )) + __pyx_t_9)) )));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":792
+  /* "libfds/fields.pyx":800
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _num2phys(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -21595,15 +21631,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":815
+/* "libfds/fields.pyx":823
  * cdef class Fields3d:
  * 
  *     def __init__(self, cfg, msh):             # <<<<<<<<<<<<<<
  * 
  *         self.msh = msh
  */
 
@@ -21637,32 +21673,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cfg)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_msh)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); __PYX_ERR(0, 815, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, 1); __PYX_ERR(0, 823, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 815, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") < 0)) __PYX_ERR(0, 823, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
     __pyx_v_cfg = values[0];
     __pyx_v_msh = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 815, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__init__", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 823, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Fields3d.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_8Fields3d___init__(((struct __pyx_obj_6libfds_6fields_Fields3d *)__pyx_v_self), __pyx_v_cfg, __pyx_v_msh);
 
@@ -21672,416 +21708,449 @@
 }
 
 static int __pyx_pf_6libfds_6fields_8Fields3d___init__(struct __pyx_obj_6libfds_6fields_Fields3d *__pyx_v_self, PyObject *__pyx_v_cfg, PyObject *__pyx_v_msh) {
   int __pyx_r;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("__init__", 0);
 
-  /* "libfds/fields.pyx":817
+  /* "libfds/fields.pyx":825
  *     def __init__(self, cfg, msh):
  * 
  *         self.msh = msh             # <<<<<<<<<<<<<<
  *         self.cfg = cfg
  *         self.init_parameters()
  */
   __Pyx_INCREF(__pyx_v_msh);
   __Pyx_GIVEREF(__pyx_v_msh);
   __Pyx_GOTREF(__pyx_v_self->msh);
   __Pyx_DECREF(__pyx_v_self->msh);
   __pyx_v_self->msh = __pyx_v_msh;
 
-  /* "libfds/fields.pyx":818
+  /* "libfds/fields.pyx":826
  * 
  *         self.msh = msh
  *         self.cfg = cfg             # <<<<<<<<<<<<<<
  *         self.init_parameters()
  * 
  */
   __Pyx_INCREF(__pyx_v_cfg);
   __Pyx_GIVEREF(__pyx_v_cfg);
   __Pyx_GOTREF(__pyx_v_self->cfg);
   __Pyx_DECREF(__pyx_v_self->cfg);
   __pyx_v_self->cfg = __pyx_v_cfg;
 
-  /* "libfds/fields.pyx":819
+  /* "libfds/fields.pyx":827
  *         self.msh = msh
  *         self.cfg = cfg
  *         self.init_parameters()             # <<<<<<<<<<<<<<
  * 
  *         # Computational domain initialization
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_parameters(__pyx_v_self);
 
-  /* "libfds/fields.pyx":822
+  /* "libfds/fields.pyx":830
  * 
  *         # Computational domain initialization
  *         self.init_grid()             # <<<<<<<<<<<<<<
  *         self.init_bc()
  *         self.init_subdomains()
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_grid(__pyx_v_self);
 
-  /* "libfds/fields.pyx":823
+  /* "libfds/fields.pyx":831
  *         # Computational domain initialization
  *         self.init_grid()
  *         self.init_bc()             # <<<<<<<<<<<<<<
  *         self.init_subdomains()
  * 
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_bc(__pyx_v_self);
 
-  /* "libfds/fields.pyx":824
+  /* "libfds/fields.pyx":832
  *         self.init_grid()
  *         self.init_bc()
  *         self.init_subdomains()             # <<<<<<<<<<<<<<
  * 
  *         # Variable initialization
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_subdomains(__pyx_v_self);
 
-  /* "libfds/fields.pyx":827
+  /* "libfds/fields.pyx":835
  * 
  *         # Variable initialization
  *         self.init_field()             # <<<<<<<<<<<<<<
  *         self.init_cvars()
  *         self.init_buffer()
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_field(__pyx_v_self);
 
-  /* "libfds/fields.pyx":828
+  /* "libfds/fields.pyx":836
  *         # Variable initialization
  *         self.init_field()
  *         self.init_cvars()             # <<<<<<<<<<<<<<
  *         self.init_buffer()
  * 
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_cvars(__pyx_v_self);
 
-  /* "libfds/fields.pyx":829
+  /* "libfds/fields.pyx":837
  *         self.init_field()
  *         self.init_cvars()
  *         self.init_buffer()             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_parameters(self):
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_buffer(__pyx_v_self);
 
-  /* "libfds/fields.pyx":815
+  /* "libfds/fields.pyx":823
  * cdef class Fields3d:
  * 
  *     def __init__(self, cfg, msh):             # <<<<<<<<<<<<<<
  * 
  *         self.msh = msh
  */
 
   /* function exit code */
   __pyx_r = 0;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":831
+/* "libfds/fields.pyx":839
  *         self.init_buffer()
  * 
  *     cdef void init_parameters(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cpu = self.cfg.cpu
  */
 
 static void __pyx_f_6libfds_6fields_8Fields3d_init_parameters(struct __pyx_obj_6libfds_6fields_Fields3d *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   Py_ssize_t __pyx_t_2;
-  double __pyx_t_3;
-  PyObject *__pyx_t_4 = NULL;
+  PyObject *__pyx_t_3 = NULL;
+  double __pyx_t_4;
   PyObject *__pyx_t_5 = NULL;
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   PyObject *(*__pyx_t_8)(PyObject *);
   double __pyx_t_9;
   double __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_parameters", 0);
 
-  /* "libfds/fields.pyx":833
+  /* "libfds/fields.pyx":841
  *     cdef void init_parameters(self):
  * 
  *         self.cpu = self.cfg.cpu             # <<<<<<<<<<<<<<
- *         self.c0 = self.cfg.c0
- *         self.gamma = self.cfg.gamma
+ *         self.c0 = self.cfg.tp.c0
+ *         self.gamma = self.cfg.tp.gamma
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 833, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 841, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 833, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 841, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->cpu = __pyx_t_2;
 
-  /* "libfds/fields.pyx":834
+  /* "libfds/fields.pyx":842
  * 
  *         self.cpu = self.cfg.cpu
- *         self.c0 = self.cfg.c0             # <<<<<<<<<<<<<<
- *         self.gamma = self.cfg.gamma
- *         self.p0 = self.cfg.p0
+ *         self.c0 = self.cfg.tp.c0             # <<<<<<<<<<<<<<
+ *         self.gamma = self.cfg.tp.gamma
+ *         self.p0 = self.cfg.tp.p0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_c0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 834, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 842, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 834, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_c0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->c0 = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 842, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->c0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":835
+  /* "libfds/fields.pyx":843
  *         self.cpu = self.cfg.cpu
- *         self.c0 = self.cfg.c0
- *         self.gamma = self.cfg.gamma             # <<<<<<<<<<<<<<
- *         self.p0 = self.cfg.p0
- *         self.T0 = self.cfg.T0
+ *         self.c0 = self.cfg.tp.c0
+ *         self.gamma = self.cfg.tp.gamma             # <<<<<<<<<<<<<<
+ *         self.p0 = self.cfg.tp.p0
+ *         self.T0 = self.cfg.tp.T0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_gamma); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 835, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 843, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_gamma); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 835, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 843, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->gamma = __pyx_t_3;
+  __pyx_v_self->gamma = __pyx_t_4;
 
-  /* "libfds/fields.pyx":836
- *         self.c0 = self.cfg.c0
- *         self.gamma = self.cfg.gamma
- *         self.p0 = self.cfg.p0             # <<<<<<<<<<<<<<
- *         self.T0 = self.cfg.T0
- *         self.rho0 = self.cfg.rho0
+  /* "libfds/fields.pyx":844
+ *         self.c0 = self.cfg.tp.c0
+ *         self.gamma = self.cfg.tp.gamma
+ *         self.p0 = self.cfg.tp.p0             # <<<<<<<<<<<<<<
+ *         self.T0 = self.cfg.tp.T0
+ *         self.rho0 = self.cfg.tp.rho0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_p0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 844, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 836, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_p0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 844, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->p0 = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 844, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->p0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":837
- *         self.gamma = self.cfg.gamma
- *         self.p0 = self.cfg.p0
- *         self.T0 = self.cfg.T0             # <<<<<<<<<<<<<<
- *         self.rho0 = self.cfg.rho0
+  /* "libfds/fields.pyx":845
+ *         self.gamma = self.cfg.tp.gamma
+ *         self.p0 = self.cfg.tp.p0
+ *         self.T0 = self.cfg.tp.T0             # <<<<<<<<<<<<<<
+ *         self.rho0 = self.cfg.tp.rho0
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_T0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 837, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 845, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_T0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 845, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 837, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 845, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->T0 = __pyx_t_3;
+  __pyx_v_self->T0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":838
- *         self.p0 = self.cfg.p0
- *         self.T0 = self.cfg.T0
- *         self.rho0 = self.cfg.rho0             # <<<<<<<<<<<<<<
+  /* "libfds/fields.pyx":846
+ *         self.p0 = self.cfg.tp.p0
+ *         self.T0 = self.cfg.tp.T0
+ *         self.rho0 = self.cfg.tp.rho0             # <<<<<<<<<<<<<<
  * 
- *         self.mu0 = self.cfg.mu0
+ *         self.mu0 = self.cfg.tp.mu0
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_rho0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 846, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 838, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_rho0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 846, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->rho0 = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 846, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->rho0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":840
- *         self.rho0 = self.cfg.rho0
+  /* "libfds/fields.pyx":848
+ *         self.rho0 = self.cfg.tp.rho0
  * 
- *         self.mu0 = self.cfg.mu0             # <<<<<<<<<<<<<<
- *         self.Ssu = self.cfg.Ssu
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
+ *         self.mu0 = self.cfg.tp.mu0             # <<<<<<<<<<<<<<
+ *         self.Ssu = self.cfg.tp.Ssu
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_mu0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 840, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 848, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_mu0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 840, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->mu0 = __pyx_t_3;
+  __pyx_v_self->mu0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":841
+  /* "libfds/fields.pyx":849
  * 
- *         self.mu0 = self.cfg.mu0
- *         self.Ssu = self.cfg.Ssu             # <<<<<<<<<<<<<<
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
- *         self.cpmcv = self.cfg.CP - self.cfg.CV
+ *         self.mu0 = self.cfg.tp.mu0
+ *         self.Ssu = self.cfg.tp.Ssu             # <<<<<<<<<<<<<<
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_Ssu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 841, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 849, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 841, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Ssu); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 849, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_v_self->Ssu = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 849, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_v_self->Ssu = __pyx_t_4;
 
-  /* "libfds/fields.pyx":842
- *         self.mu0 = self.cfg.mu0
- *         self.Ssu = self.cfg.Ssu
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl             # <<<<<<<<<<<<<<
- *         self.cpmcv = self.cfg.CP - self.cfg.CV
+  /* "libfds/fields.pyx":850
+ *         self.mu0 = self.cfg.tp.mu0
+ *         self.Ssu = self.cfg.tp.Ssu
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl             # <<<<<<<<<<<<<<
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv
  *         self.gaminusone = self.gamma - 1.
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_CP); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_Cp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 842, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_3 = PyNumber_Negative(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 850, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_prandtl); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_5 = __Pyx_PyNumber_Divide(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_prandtl); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 850, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 842, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 850, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_v_self->cppr = __pyx_t_3;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 850, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->cppr = __pyx_t_4;
 
-  /* "libfds/fields.pyx":843
- *         self.Ssu = self.cfg.Ssu
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
- *         self.cpmcv = self.cfg.CP - self.cfg.CV             # <<<<<<<<<<<<<<
+  /* "libfds/fields.pyx":851
+ *         self.Ssu = self.cfg.tp.Ssu
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv             # <<<<<<<<<<<<<<
  *         self.gaminusone = self.gamma - 1.
  * 
  */
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_CP); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 843, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Cp); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_CV); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 843, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_tp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_Cv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 851, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_3);
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Subtract(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 843, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 843, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_self->cpmcv = __pyx_t_3;
+  __pyx_v_self->cpmcv = __pyx_t_4;
 
-  /* "libfds/fields.pyx":844
- *         self.cppr = - self.cfg.CP / self.cfg.prandtl
- *         self.cpmcv = self.cfg.CP - self.cfg.CV
+  /* "libfds/fields.pyx":852
+ *         self.cppr = - self.cfg.tp.Cp / self.cfg.tp.prandtl
+ *         self.cpmcv = self.cfg.tp.Cp - self.cfg.tp.Cv
  *         self.gaminusone = self.gamma - 1.             # <<<<<<<<<<<<<<
  * 
  *         # Selective filter
  */
   __pyx_v_self->gaminusone = (__pyx_v_self->gamma - 1.);
 
-  /* "libfds/fields.pyx":847
+  /* "libfds/fields.pyx":855
  * 
  *         # Selective filter
  *         self.xnu_n = self.cfg.flt_xnu_n             # <<<<<<<<<<<<<<
  *         self.xnu_0 = self.cfg.flt_xnu_0
  * 
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_n); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 847, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 847, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_self->xnu_n = __pyx_t_3;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 855, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 855, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->xnu_n = __pyx_t_4;
 
-  /* "libfds/fields.pyx":848
+  /* "libfds/fields.pyx":856
  *         # Selective filter
  *         self.xnu_n = self.cfg.flt_xnu_n
  *         self.xnu_0 = self.cfg.flt_xnu_0             # <<<<<<<<<<<<<<
  * 
  *         # flow
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 848, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 848, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_v_self->xnu_0 = __pyx_t_3;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flt_xnu_0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 856, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 856, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
+  __pyx_v_self->xnu_0 = __pyx_t_4;
 
-  /* "libfds/fields.pyx":851
+  /* "libfds/fields.pyx":859
  * 
  *         # flow
  *         self.U0, self.V0, self.W0 = self.cfg.flw_components             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_grid(self):
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flw_components); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 851, __pyx_L1_error)
-  __Pyx_GOTREF(__pyx_t_4);
-  if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
-    PyObject* sequence = __pyx_t_4;
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_flw_components); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 859, __pyx_L1_error)
+  __Pyx_GOTREF(__pyx_t_1);
+  if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
+    PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 3)) {
       if (size > 3) __Pyx_RaiseTooManyValuesError(3);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 851, __pyx_L1_error)
+      __PYX_ERR(0, 859, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
-      __pyx_t_1 = PyTuple_GET_ITEM(sequence, 0); 
+      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
       __pyx_t_6 = PyTuple_GET_ITEM(sequence, 2); 
     } else {
-      __pyx_t_1 = PyList_GET_ITEM(sequence, 0); 
+      __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
       __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
       __pyx_t_6 = PyList_GET_ITEM(sequence, 2); 
     }
-    __Pyx_INCREF(__pyx_t_1);
+    __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_5);
     __Pyx_INCREF(__pyx_t_6);
     #else
-    __pyx_t_1 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 851, __pyx_L1_error)
-    __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 859, __pyx_L1_error)
+    __Pyx_GOTREF(__pyx_t_3);
+    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 859, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_6 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 859, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     #endif
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_7 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 851, __pyx_L1_error)
+    __pyx_t_7 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 859, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
+    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_8 = Py_TYPE(__pyx_t_7)->tp_iternext;
-    index = 0; __pyx_t_1 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_1)) goto __pyx_L3_unpacking_failed;
-    __Pyx_GOTREF(__pyx_t_1);
+    index = 0; __pyx_t_3 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
+    __Pyx_GOTREF(__pyx_t_3);
     index = 1; __pyx_t_5 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_5)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_5);
     index = 2; __pyx_t_6 = __pyx_t_8(__pyx_t_7); if (unlikely(!__pyx_t_6)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_6);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 3) < 0) __PYX_ERR(0, 851, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_8(__pyx_t_7), 3) < 0) __PYX_ERR(0, 859, __pyx_L1_error)
     __pyx_t_8 = NULL;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_8 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 851, __pyx_L1_error)
+    __PYX_ERR(0, 859, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
-  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_9 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 859, __pyx_L1_error)
+  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
+  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_9 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 859, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-  __pyx_t_10 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_10 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 851, __pyx_L1_error)
+  __pyx_t_10 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_10 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 859, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_v_self->U0 = __pyx_t_3;
+  __pyx_v_self->U0 = __pyx_t_4;
   __pyx_v_self->V0 = __pyx_t_9;
   __pyx_v_self->W0 = __pyx_t_10;
 
-  /* "libfds/fields.pyx":831
+  /* "libfds/fields.pyx":839
  *         self.init_buffer()
  * 
  *     cdef void init_parameters(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cpu = self.cfg.cpu
  */
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
-  __Pyx_XDECREF(__pyx_t_4);
+  __Pyx_XDECREF(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5);
   __Pyx_XDECREF(__pyx_t_6);
   __Pyx_XDECREF(__pyx_t_7);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":853
+/* "libfds/fields.pyx":861
  *         self.U0, self.V0, self.W0 = self.cfg.flw_components
  * 
  *     cdef void init_grid(self):             # <<<<<<<<<<<<<<
  * 
  *         self.nx, self.ny, self.nz = self.msh.shape
  */
 
@@ -22101,30 +22170,30 @@
   __Pyx_memviewslice __pyx_t_12 = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_grid", 0);
 
-  /* "libfds/fields.pyx":855
+  /* "libfds/fields.pyx":863
  *     cdef void init_grid(self):
  * 
  *         self.nx, self.ny, self.nz = self.msh.shape             # <<<<<<<<<<<<<<
  *         self.nsize = self.nx * self.ny * self.nz
  *         self.init_spacial_steps()
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 855, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if ((likely(PyTuple_CheckExact(__pyx_t_1))) || (PyList_CheckExact(__pyx_t_1))) {
     PyObject* sequence = __pyx_t_1;
     Py_ssize_t size = __Pyx_PySequence_SIZE(sequence);
     if (unlikely(size != 3)) {
       if (size > 3) __Pyx_RaiseTooManyValuesError(3);
       else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
-      __PYX_ERR(0, 855, __pyx_L1_error)
+      __PYX_ERR(0, 863, __pyx_L1_error)
     }
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
     if (likely(PyTuple_CheckExact(sequence))) {
       __pyx_t_2 = PyTuple_GET_ITEM(sequence, 0); 
       __pyx_t_3 = PyTuple_GET_ITEM(sequence, 1); 
       __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2); 
     } else {
@@ -22132,327 +22201,327 @@
       __pyx_t_3 = PyList_GET_ITEM(sequence, 1); 
       __pyx_t_4 = PyList_GET_ITEM(sequence, 2); 
     }
     __Pyx_INCREF(__pyx_t_2);
     __Pyx_INCREF(__pyx_t_3);
     __Pyx_INCREF(__pyx_t_4);
     #else
-    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __pyx_t_2 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 863, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 863, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __pyx_t_4 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 863, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     #endif
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   } else {
     Py_ssize_t index = -1;
-    __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 855, __pyx_L1_error)
+    __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 863, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_t_6 = Py_TYPE(__pyx_t_5)->tp_iternext;
     index = 0; __pyx_t_2 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_2)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_2);
     index = 1; __pyx_t_3 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_3);
     index = 2; __pyx_t_4 = __pyx_t_6(__pyx_t_5); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
     __Pyx_GOTREF(__pyx_t_4);
-    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_5), 3) < 0) __PYX_ERR(0, 855, __pyx_L1_error)
+    if (__Pyx_IternextUnpackEndCheck(__pyx_t_6(__pyx_t_5), 3) < 0) __PYX_ERR(0, 863, __pyx_L1_error)
     __pyx_t_6 = NULL;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     goto __pyx_L4_unpacking_done;
     __pyx_L3_unpacking_failed:;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_6 = NULL;
     if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
-    __PYX_ERR(0, 855, __pyx_L1_error)
+    __PYX_ERR(0, 863, __pyx_L1_error)
     __pyx_L4_unpacking_done:;
   }
-  __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 855, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyIndex_AsSsize_t(__pyx_t_2); if (unlikely((__pyx_t_7 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 855, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 855, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_4); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 863, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_self->nx = __pyx_t_7;
   __pyx_v_self->ny = __pyx_t_8;
   __pyx_v_self->nz = __pyx_t_9;
 
-  /* "libfds/fields.pyx":856
+  /* "libfds/fields.pyx":864
  * 
  *         self.nx, self.ny, self.nz = self.msh.shape
  *         self.nsize = self.nx * self.ny * self.nz             # <<<<<<<<<<<<<<
  *         self.init_spacial_steps()
  * 
  */
   __pyx_v_self->nsize = ((__pyx_v_self->nx * __pyx_v_self->ny) * __pyx_v_self->nz);
 
-  /* "libfds/fields.pyx":857
+  /* "libfds/fields.pyx":865
  *         self.nx, self.ny, self.nz = self.msh.shape
  *         self.nsize = self.nx * self.ny * self.nz
  *         self.init_spacial_steps()             # <<<<<<<<<<<<<<
  * 
  *         self.grid = 'physical'
  */
   __pyx_f_6libfds_6fields_8Fields3d_init_spacial_steps(__pyx_v_self);
 
-  /* "libfds/fields.pyx":859
+  /* "libfds/fields.pyx":867
  *         self.init_spacial_steps()
  * 
  *         self.grid = 'physical'             # <<<<<<<<<<<<<<
  *         self.mesh_type = self.msh.mesh_type.lower()
  * 
  */
   __Pyx_INCREF(__pyx_n_u_physical);
   __Pyx_GIVEREF(__pyx_n_u_physical);
   __Pyx_GOTREF(__pyx_v_self->grid);
   __Pyx_DECREF(__pyx_v_self->grid);
   __pyx_v_self->grid = __pyx_n_u_physical;
 
-  /* "libfds/fields.pyx":860
+  /* "libfds/fields.pyx":868
  * 
  *         self.grid = 'physical'
  *         self.mesh_type = self.msh.mesh_type.lower()             # <<<<<<<<<<<<<<
  * 
  *         if self.mesh_type == 'curvilinear':
  */
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_mesh_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_mesh_type); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_lower); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 860, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_lower); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && likely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallNoArg(__pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 860, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 860, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 868, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->mesh_type);
   __Pyx_DECREF(__pyx_v_self->mesh_type);
   __pyx_v_self->mesh_type = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":862
+  /* "libfds/fields.pyx":870
  *         self.mesh_type = self.msh.mesh_type.lower()
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du
  */
-  __pyx_t_10 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 862, __pyx_L1_error)
+  __pyx_t_10 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 870, __pyx_L1_error)
   __pyx_t_11 = (__pyx_t_10 != 0);
   if (__pyx_t_11) {
 
-    /* "libfds/fields.pyx":863
+    /* "libfds/fields.pyx":871
  * 
  *         if self.mesh_type == 'curvilinear':
  *             self.J = self.msh.J             # <<<<<<<<<<<<<<
  *             self.dx_du = self.msh.dx_du
  *             self.dx_dv = self.msh.dx_dv
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_J); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 863, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_J); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 871, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 863, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 871, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->J, 0);
     __pyx_v_self->J = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":864
+    /* "libfds/fields.pyx":872
  *         if self.mesh_type == 'curvilinear':
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du             # <<<<<<<<<<<<<<
  *             self.dx_dv = self.msh.dx_dv
  *             self.dx_dw = self.msh.dx_dw
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 864, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 864, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 872, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dx_du, 0);
     __pyx_v_self->dx_du = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":865
+    /* "libfds/fields.pyx":873
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du
  *             self.dx_dv = self.msh.dx_dv             # <<<<<<<<<<<<<<
  *             self.dx_dw = self.msh.dx_dw
  *             self.dy_du = self.msh.dy_du
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 865, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 873, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 865, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 873, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dx_dv, 0);
     __pyx_v_self->dx_dv = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":866
+    /* "libfds/fields.pyx":874
  *             self.dx_du = self.msh.dx_du
  *             self.dx_dv = self.msh.dx_dv
  *             self.dx_dw = self.msh.dx_dw             # <<<<<<<<<<<<<<
  *             self.dy_du = self.msh.dy_du
  *             self.dy_dv = self.msh.dy_dv
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_dw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 866, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx_dw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 874, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 866, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 874, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dx_dw, 0);
     __pyx_v_self->dx_dw = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":867
+    /* "libfds/fields.pyx":875
  *             self.dx_dv = self.msh.dx_dv
  *             self.dx_dw = self.msh.dx_dw
  *             self.dy_du = self.msh.dy_du             # <<<<<<<<<<<<<<
  *             self.dy_dv = self.msh.dy_dv
  *             self.dy_dw = self.msh.dy_dw
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 867, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 867, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 875, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dy_du, 0);
     __pyx_v_self->dy_du = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":868
+    /* "libfds/fields.pyx":876
  *             self.dx_dw = self.msh.dx_dw
  *             self.dy_du = self.msh.dy_du
  *             self.dy_dv = self.msh.dy_dv             # <<<<<<<<<<<<<<
  *             self.dy_dw = self.msh.dy_dw
  *             self.dz_du = self.msh.dz_du
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 868, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 868, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 876, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dy_dv, 0);
     __pyx_v_self->dy_dv = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":869
+    /* "libfds/fields.pyx":877
  *             self.dy_du = self.msh.dy_du
  *             self.dy_dv = self.msh.dy_dv
  *             self.dy_dw = self.msh.dy_dw             # <<<<<<<<<<<<<<
  *             self.dz_du = self.msh.dz_du
  *             self.dz_dv = self.msh.dz_dv
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_dw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 869, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy_dw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 869, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 877, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dy_dw, 0);
     __pyx_v_self->dy_dw = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":870
+    /* "libfds/fields.pyx":878
  *             self.dy_dv = self.msh.dy_dv
  *             self.dy_dw = self.msh.dy_dw
  *             self.dz_du = self.msh.dz_du             # <<<<<<<<<<<<<<
  *             self.dz_dv = self.msh.dz_dv
  *             self.dz_dw = self.msh.dz_dw
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 870, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz_du); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 878, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 870, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 878, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dz_du, 0);
     __pyx_v_self->dz_du = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":871
+    /* "libfds/fields.pyx":879
  *             self.dy_dw = self.msh.dy_dw
  *             self.dz_du = self.msh.dz_du
  *             self.dz_dv = self.msh.dz_dv             # <<<<<<<<<<<<<<
  *             self.dz_dw = self.msh.dz_dw
  * 
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 871, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz_dv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 871, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 879, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dz_dv, 0);
     __pyx_v_self->dz_dv = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":872
+    /* "libfds/fields.pyx":880
  *             self.dz_du = self.msh.dz_du
  *             self.dz_dv = self.msh.dz_dv
  *             self.dz_dw = self.msh.dz_dw             # <<<<<<<<<<<<<<
  * 
  *         # Buffer zone
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz_dw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz_dw); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 872, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_12.memview)) __PYX_ERR(0, 880, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->dz_dw, 0);
     __pyx_v_self->dz_dw = __pyx_t_12;
     __pyx_t_12.memview = NULL;
     __pyx_t_12.data = NULL;
 
-    /* "libfds/fields.pyx":862
+    /* "libfds/fields.pyx":870
  *         self.mesh_type = self.msh.mesh_type.lower()
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.J = self.msh.J
  *             self.dx_du = self.msh.dx_du
  */
   }
 
-  /* "libfds/fields.pyx":875
+  /* "libfds/fields.pyx":883
  * 
  *         # Buffer zone
  *         self.bz_n = self.cfg.bz_n             # <<<<<<<<<<<<<<
  *         self.bz_forder = self.cfg.bz_filter_order
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 875, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 875, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_9 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 883, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->bz_n = __pyx_t_9;
 
-  /* "libfds/fields.pyx":876
+  /* "libfds/fields.pyx":884
  *         # Buffer zone
  *         self.bz_n = self.cfg.bz_n
  *         self.bz_forder = self.cfg.bz_filter_order             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_spacial_steps(self):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_filter_order); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_bz_filter_order); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 876, __pyx_L1_error)
+  __pyx_t_13 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_13 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 884, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->bz_forder = __pyx_t_13;
 
-  /* "libfds/fields.pyx":853
+  /* "libfds/fields.pyx":861
  *         self.U0, self.V0, self.W0 = self.cfg.flw_components
  * 
  *     cdef void init_grid(self):             # <<<<<<<<<<<<<<
  * 
  *         self.nx, self.ny, self.nz = self.msh.shape
  */
 
@@ -22466,15 +22535,15 @@
   __Pyx_XDECREF(__pyx_t_5);
   __PYX_XDEC_MEMVIEW(&__pyx_t_12, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_grid", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":878
+/* "libfds/fields.pyx":886
  *         self.bz_forder = self.cfg.bz_filter_order
  * 
  *     cdef void init_spacial_steps(self):             # <<<<<<<<<<<<<<
  * 
  *         self.flag_x = self.msh.flag_x
  */
 
@@ -22492,251 +22561,251 @@
   int __pyx_t_10;
   PyObject *__pyx_t_11 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_spacial_steps", 0);
 
-  /* "libfds/fields.pyx":880
+  /* "libfds/fields.pyx":888
  *     cdef void init_spacial_steps(self):
  * 
  *         self.flag_x = self.msh.flag_x             # <<<<<<<<<<<<<<
  *         self.flag_y = self.msh.flag_y
  *         self.flag_z = self.msh.flag_z
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 880, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 880, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 888, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->flag_x);
   __Pyx_DECREF(__pyx_v_self->flag_x);
   __pyx_v_self->flag_x = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":881
+  /* "libfds/fields.pyx":889
  * 
  *         self.flag_x = self.msh.flag_x
  *         self.flag_y = self.msh.flag_y             # <<<<<<<<<<<<<<
  *         self.flag_z = self.msh.flag_z
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 881, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 881, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 889, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->flag_y);
   __Pyx_DECREF(__pyx_v_self->flag_y);
   __pyx_v_self->flag_y = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":882
+  /* "libfds/fields.pyx":890
  *         self.flag_x = self.msh.flag_x
  *         self.flag_y = self.msh.flag_y
  *         self.flag_z = self.msh.flag_z             # <<<<<<<<<<<<<<
  * 
  *         self.odx = 1. / self.msh.dx
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 882, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_flag_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 882, __pyx_L1_error)
+  if (!(likely(PyUnicode_CheckExact(__pyx_t_1))||((__pyx_t_1) == Py_None)||((void)PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "unicode", Py_TYPE(__pyx_t_1)->tp_name), 0))) __PYX_ERR(0, 890, __pyx_L1_error)
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->flag_z);
   __Pyx_DECREF(__pyx_v_self->flag_z);
   __pyx_v_self->flag_z = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":884
+  /* "libfds/fields.pyx":892
  *         self.flag_z = self.msh.flag_z
  * 
  *         self.odx = 1. / self.msh.dx             # <<<<<<<<<<<<<<
  *         self.ody = 1. / self.msh.dy
  *         self.odz = 1. / self.msh.dz
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 884, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 892, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_self->odx = __pyx_t_3;
 
-  /* "libfds/fields.pyx":885
+  /* "libfds/fields.pyx":893
  * 
  *         self.odx = 1. / self.msh.dx
  *         self.ody = 1. / self.msh.dy             # <<<<<<<<<<<<<<
  *         self.odz = 1. / self.msh.dz
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 885, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dy); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_2, 1., 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 885, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_2, 1., 0, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 885, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 893, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_self->ody = __pyx_t_3;
 
-  /* "libfds/fields.pyx":886
+  /* "libfds/fields.pyx":894
  *         self.odx = 1. / self.msh.dx
  *         self.ody = 1. / self.msh.dy
  *         self.odz = 1. / self.msh.dz             # <<<<<<<<<<<<<<
  * 
  *         self.odxdt = self.odx * self.cfg.dt
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 886, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 894, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 886, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyFloat_TrueDivideCObj(__pyx_float_1_, __pyx_t_1, 1., 0, 1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 894, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 886, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 894, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_self->odz = __pyx_t_3;
 
-  /* "libfds/fields.pyx":888
+  /* "libfds/fields.pyx":896
  *         self.odz = 1. / self.msh.dz
  * 
  *         self.odxdt = self.odx * self.cfg.dt             # <<<<<<<<<<<<<<
  *         self.odydt = self.ody * self.cfg.dt
  *         self.odzdt = self.odz * self.cfg.dt
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_self->odx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_self->odx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 896, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 888, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 896, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_self->odxdt = __pyx_t_3;
 
-  /* "libfds/fields.pyx":889
+  /* "libfds/fields.pyx":897
  * 
  *         self.odxdt = self.odx * self.cfg.dt
  *         self.odydt = self.ody * self.cfg.dt             # <<<<<<<<<<<<<<
  *         self.odzdt = self.odz * self.cfg.dt
  * 
  */
-  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_self->ody); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_self->ody); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 897, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyNumber_Multiply(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_2 = PyNumber_Multiply(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 897, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 889, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_2); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 897, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_v_self->odydt = __pyx_t_3;
 
-  /* "libfds/fields.pyx":890
+  /* "libfds/fields.pyx":898
  *         self.odxdt = self.odx * self.cfg.dt
  *         self.odydt = self.ody * self.cfg.dt
  *         self.odzdt = self.odz * self.cfg.dt             # <<<<<<<<<<<<<<
  * 
  *         self.odxdtrk = 0.
  */
-  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_self->odz); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_self->odz); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_2, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 890, __pyx_L1_error)
+  __pyx_t_3 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_3 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 898, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __pyx_v_self->odzdt = __pyx_t_3;
 
-  /* "libfds/fields.pyx":892
+  /* "libfds/fields.pyx":900
  *         self.odzdt = self.odz * self.cfg.dt
  * 
  *         self.odxdtrk = 0.             # <<<<<<<<<<<<<<
  *         self.odydtrk = 0.
  *         self.odzdtrk = 0.
  */
   __pyx_v_self->odxdtrk = 0.;
 
-  /* "libfds/fields.pyx":893
+  /* "libfds/fields.pyx":901
  * 
  *         self.odxdtrk = 0.
  *         self.odydtrk = 0.             # <<<<<<<<<<<<<<
  *         self.odzdtrk = 0.
  * 
  */
   __pyx_v_self->odydtrk = 0.;
 
-  /* "libfds/fields.pyx":894
+  /* "libfds/fields.pyx":902
  *         self.odxdtrk = 0.
  *         self.odydtrk = 0.
  *         self.odzdtrk = 0.             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_x == 'v':
  */
   __pyx_v_self->odzdtrk = 0.;
 
-  /* "libfds/fields.pyx":896
+  /* "libfds/fields.pyx":904
  *         self.odzdtrk = 0.
  * 
  *         if self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 904, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":897
+    /* "libfds/fields.pyx":905
  * 
  *         if self.flag_x == 'v':
  *             self.odx_v = odu(self.msh.x)             # <<<<<<<<<<<<<<
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_odu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 897, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_odu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 897, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 897, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 905, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odx_v, 0);
     __pyx_v_self->odx_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":898
+    /* "libfds/fields.pyx":906
  *         if self.flag_x == 'v':
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)             # <<<<<<<<<<<<<<
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 898, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_mult); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->odx_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 898, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->odx_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 898, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_9 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_9 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_9)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
@@ -22745,158 +22814,158 @@
         __Pyx_DECREF_SET(__pyx_t_1, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_2, __pyx_t_7};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_1)) {
       PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_t_2, __pyx_t_7};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_9); __pyx_t_9 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 898, __pyx_L1_error)
+      __pyx_t_11 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 906, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_11);
       if (__pyx_t_9) {
         __Pyx_GIVEREF(__pyx_t_9); PyTuple_SET_ITEM(__pyx_t_11, 0, __pyx_t_9); __pyx_t_9 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_11, 0+__pyx_t_10, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_11, 1+__pyx_t_10, __pyx_t_7);
       __pyx_t_2 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 898, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_11, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 906, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 898, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 906, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odxdt_v, 0);
     __pyx_v_self->odxdt_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":899
+    /* "libfds/fields.pyx":907
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_y == 'v':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 899, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_1);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 899, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 899, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 907, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odxdtrk_v, 0);
     __pyx_v_self->odxdtrk_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":896
+    /* "libfds/fields.pyx":904
  *         self.odzdtrk = 0.
  * 
  *         if self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odx_v = odu(self.msh.x)
  *             self.odxdt_v = mult(self.odx_v, self.cfg.dt)
  */
   }
 
-  /* "libfds/fields.pyx":901
+  /* "libfds/fields.pyx":909
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  * 
  *         if self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 901, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 909, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":902
+    /* "libfds/fields.pyx":910
  * 
  *         if self.flag_y == 'v':
  *             self.ody_v = odu(self.msh.y)             # <<<<<<<<<<<<<<
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_odu); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 902, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_odu); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 910, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 902, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 910, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_11, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_11, __pyx_t_7, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_11, __pyx_t_1);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 902, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 910, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 902, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 910, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->ody_v, 0);
     __pyx_v_self->ody_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":903
+    /* "libfds/fields.pyx":911
  *         if self.flag_y == 'v':
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)             # <<<<<<<<<<<<<<
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_mult); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_mult); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->ody_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->ody_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_2 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_11))) {
       __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_11);
       if (likely(__pyx_t_2)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_11);
@@ -22905,158 +22974,158 @@
         __Pyx_DECREF_SET(__pyx_t_11, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_1, __pyx_t_7};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_11)) {
       PyObject *__pyx_temp[3] = {__pyx_t_2, __pyx_t_1, __pyx_t_7};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_11, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_9 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 903, __pyx_L1_error)
+      __pyx_t_9 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_9);
       if (__pyx_t_2) {
         __Pyx_GIVEREF(__pyx_t_2); PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_2); __pyx_t_2 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_9, 0+__pyx_t_10, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_9, 1+__pyx_t_10, __pyx_t_7);
       __pyx_t_1 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 903, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_11, __pyx_t_9, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 911, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
     }
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 903, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 911, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odydt_v, 0);
     __pyx_v_self->odydt_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":904
+    /* "libfds/fields.pyx":912
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_z == 'v':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 904, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_11, __pyx_n_s_np); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 904, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_t_11, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 904, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_7, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_11);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 904, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 904, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 912, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odydtrk_v, 0);
     __pyx_v_self->odydtrk_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":901
+    /* "libfds/fields.pyx":909
  *             self.odxdtrk_v = _np.zeros_like(self.msh.x)
  * 
  *         if self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.ody_v = odu(self.msh.y)
  *             self.odydt_v = mult(self.ody_v, self.cfg.dt)
  */
   }
 
-  /* "libfds/fields.pyx":906
+  /* "libfds/fields.pyx":914
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  * 
  *         if self.flag_z == 'v':             # <<<<<<<<<<<<<<
  *             self.odz_v = odu(self.msh.z)
  *             self.odzdt_v = mult(self.odz_v, self.cfg.dt)
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_z, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 906, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_z, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 914, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":907
+    /* "libfds/fields.pyx":915
  * 
  *         if self.flag_z == 'v':
  *             self.odz_v = odu(self.msh.z)             # <<<<<<<<<<<<<<
  *             self.odzdt_v = mult(self.odz_v, self.cfg.dt)
  *             self.odzdtrk_v = _np.zeros_like(self.msh.z)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_odu); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 907, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_odu); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 915, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 907, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 915, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_9, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_9, __pyx_t_7, __pyx_t_11) : __Pyx_PyObject_CallOneArg(__pyx_t_9, __pyx_t_11);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 907, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 915, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 907, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 915, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odz_v, 0);
     __pyx_v_self->odz_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":908
+    /* "libfds/fields.pyx":916
  *         if self.flag_z == 'v':
  *             self.odz_v = odu(self.msh.z)
  *             self.odzdt_v = mult(self.odz_v, self.cfg.dt)             # <<<<<<<<<<<<<<
  *             self.odzdtrk_v = _np.zeros_like(self.msh.z)
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_mult); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 908, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_mult); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 916, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_self->odz_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 908, __pyx_L1_error)
+    __pyx_t_11 = __pyx_memoryview_fromslice(__pyx_v_self->odz_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 916, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_11);
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 908, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 916, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_1 = NULL;
     __pyx_t_10 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_9))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_9);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_9);
@@ -23065,102 +23134,102 @@
         __Pyx_DECREF_SET(__pyx_t_9, function);
         __pyx_t_10 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_11, __pyx_t_7};
-      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 916, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_9)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_11, __pyx_t_7};
-      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyCFunction_FastCall(__pyx_t_9, __pyx_temp+1-__pyx_t_10, 2+__pyx_t_10); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 916, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_11); __pyx_t_11 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_2 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2+__pyx_t_10); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 916, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       if (__pyx_t_1) {
         __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1); __pyx_t_1 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_11);
       PyTuple_SET_ITEM(__pyx_t_2, 0+__pyx_t_10, __pyx_t_11);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_2, 1+__pyx_t_10, __pyx_t_7);
       __pyx_t_11 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 908, __pyx_L1_error)
+      __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_9, __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 916, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_4);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     }
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 908, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 916, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odzdt_v, 0);
     __pyx_v_self->odzdt_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":909
+    /* "libfds/fields.pyx":917
  *             self.odz_v = odu(self.msh.z)
  *             self.odzdt_v = mult(self.odz_v, self.cfg.dt)
  *             self.odzdtrk_v = _np.zeros_like(self.msh.z)             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_bc(self):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 909, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_9, __pyx_n_s_np); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 917, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 909, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_9, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 909, __pyx_L1_error)
+    __pyx_t_9 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 917, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_7)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
         __Pyx_INCREF(__pyx_t_7);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_4 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_t_9) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_9);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 909, __pyx_L1_error)
+    if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 917, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 909, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_4, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 917, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odzdtrk_v, 0);
     __pyx_v_self->odzdtrk_v = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":906
+    /* "libfds/fields.pyx":914
  *             self.odydtrk_v = _np.zeros_like(self.msh.y)
  * 
  *         if self.flag_z == 'v':             # <<<<<<<<<<<<<<
  *             self.odz_v = odu(self.msh.z)
  *             self.odzdt_v = mult(self.odz_v, self.cfg.dt)
  */
   }
 
-  /* "libfds/fields.pyx":878
+  /* "libfds/fields.pyx":886
  *         self.bz_forder = self.cfg.bz_filter_order
  * 
  *     cdef void init_spacial_steps(self):             # <<<<<<<<<<<<<<
  * 
  *         self.flag_x = self.msh.flag_x
  */
 
@@ -23175,15 +23244,15 @@
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_XDECREF(__pyx_t_11);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_spacial_steps", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":911
+/* "libfds/fields.pyx":919
  *             self.odzdtrk_v = _np.zeros_like(self.msh.z)
  * 
  *     cdef void init_bc(self):             # <<<<<<<<<<<<<<
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  */
 
@@ -23203,79 +23272,79 @@
   int __pyx_t_11;
   int __pyx_t_12;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_bc", 0);
 
-  /* "libfds/fields.pyx":914
+  /* "libfds/fields.pyx":922
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:             # <<<<<<<<<<<<<<
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 914, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 922, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_t_1, 0, 2, NULL, NULL, &__pyx_slice__14, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 914, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetSlice(__pyx_t_1, 0, 2, NULL, NULL, &__pyx_slice__14, 0, 1, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 922, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 914, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_2, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 922, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
 
-    /* "libfds/fields.pyx":915
+    /* "libfds/fields.pyx":923
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))             # <<<<<<<<<<<<<<
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->nx - 5)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->nx - 5)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_6);
     __pyx_t_1 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_7 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __pyx_t_7 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_7)) {
@@ -23284,85 +23353,85 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_2 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_7, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 915, __pyx_L1_error)
+    if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 915, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 923, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->P11x, 0);
     __pyx_v_self->P11x = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":916
+    /* "libfds/fields.pyx":924
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  */
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 916, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 916, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 924, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":917
+      /* "libfds/fields.pyx":925
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))             # <<<<<<<<<<<<<<
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->nx - 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->nx - 1)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_7);
       __pyx_t_5 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_1)) {
@@ -23371,72 +23440,72 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_2 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 917, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 917, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 925, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P3x, 0);
       __pyx_v_self->P3x = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":918
+      /* "libfds/fields.pyx":926
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))             # <<<<<<<<<<<<<<
  * 
  *         if 'P' in self.msh.bc[2:4]:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_array); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyInt_FromSsize_t((__pyx_v_self->nx - 2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t((__pyx_v_self->nx - 2)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
       __pyx_t_6 = 0;
       __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __pyx_t_5 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_7))) {
         __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_7);
         if (likely(__pyx_t_5)) {
@@ -23445,107 +23514,107 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_7, function);
         }
       }
       __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_7, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_1);
       __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 918, __pyx_L1_error)
+      if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 918, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_2, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 926, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P5x, 0);
       __pyx_v_self->P5x = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":916
+      /* "libfds/fields.pyx":924
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  */
     }
 
-    /* "libfds/fields.pyx":914
+    /* "libfds/fields.pyx":922
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:             # <<<<<<<<<<<<<<
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  */
   }
 
-  /* "libfds/fields.pyx":920
+  /* "libfds/fields.pyx":928
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[2:4]:             # <<<<<<<<<<<<<<
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 920, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 928, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_2, 2, 4, NULL, NULL, &__pyx_slice__21, 1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 920, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetSlice(__pyx_t_2, 2, 4, NULL, NULL, &__pyx_slice__21, 1, 1, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 928, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_7, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 920, __pyx_L1_error)
+  __pyx_t_4 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_7, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 928, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __pyx_t_3 = (__pyx_t_4 != 0);
   if (__pyx_t_3) {
 
-    /* "libfds/fields.pyx":921
+    /* "libfds/fields.pyx":929
  * 
  *         if 'P' in self.msh.bc[2:4]:
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))             # <<<<<<<<<<<<<<
  *             if self.cfg.cpt:
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyInt_FromSsize_t((__pyx_v_self->ny - 5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_2 = PyInt_FromSsize_t((__pyx_v_self->ny - 5)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_2 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_5 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_2 = PyNumber_Add(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_6 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_1);
       if (likely(__pyx_t_6)) {
@@ -23554,85 +23623,85 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_1, function);
       }
     }
     __pyx_t_7 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_6, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 921, __pyx_L1_error)
+    if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 921, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 929, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->P11y, 0);
     __pyx_v_self->P11y = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":922
+    /* "libfds/fields.pyx":930
  *         if 'P' in self.msh.bc[2:4]:
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  */
-    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 922, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_7); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 930, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     if (__pyx_t_3) {
 
-      /* "libfds/fields.pyx":923
+      /* "libfds/fields.pyx":931
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))             # <<<<<<<<<<<<<<
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->ny - 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->ny - 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_6);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_6);
       __pyx_t_1 = 0;
       __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_6 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
-      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_6); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_2)) {
@@ -23641,72 +23710,72 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_7 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 923, __pyx_L1_error)
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 923, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 931, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P3y, 0);
       __pyx_v_self->P3y = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":924
+      /* "libfds/fields.pyx":932
  *             if self.cfg.cpt:
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))             # <<<<<<<<<<<<<<
  * 
  *         if 'P' in self.msh.bc[4:]:
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_array); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->ny - 2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t((__pyx_v_self->ny - 2)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
       __pyx_t_5 = 0;
       __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_1 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_1 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
         __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
         if (likely(__pyx_t_1)) {
@@ -23715,107 +23784,107 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_6, function);
         }
       }
       __pyx_t_7 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_1, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_2);
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 924, __pyx_L1_error)
+      if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 924, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_7, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 932, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P5y, 0);
       __pyx_v_self->P5y = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":922
+      /* "libfds/fields.pyx":930
  *         if 'P' in self.msh.bc[2:4]:
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3y = _np.array(list(range(self.ny - 1, self.ny)) + list(range(self.ny)) + list(range(1)))
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  */
     }
 
-    /* "libfds/fields.pyx":920
+    /* "libfds/fields.pyx":928
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[2:4]:             # <<<<<<<<<<<<<<
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  */
   }
 
-  /* "libfds/fields.pyx":926
+  /* "libfds/fields.pyx":934
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[4:]:             # <<<<<<<<<<<<<<
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bc); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 934, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_t_7, 4, 0, NULL, NULL, &__pyx_slice__22, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetSlice(__pyx_t_7, 4, 0, NULL, NULL, &__pyx_slice__22, 1, 0, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 934, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-  __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __pyx_t_3 = (__Pyx_PySequence_ContainsTF(__pyx_n_u_P, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 934, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __pyx_t_4 = (__pyx_t_3 != 0);
   if (__pyx_t_4) {
 
-    /* "libfds/fields.pyx":927
+    /* "libfds/fields.pyx":935
  * 
  *         if 'P' in self.msh.bc[4:]:
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))             # <<<<<<<<<<<<<<
  *             if self.cfg.cpt:
  *                 self.P3z = _np.array(list(range(self.nz - 1, self.nz)) + list(range(self.nz)) + list(range(1)))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_7, __pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_array); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyInt_FromSsize_t((__pyx_v_self->nz - 5)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_7 = PyInt_FromSsize_t((__pyx_v_self->nz - 5)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_1);
     __pyx_t_7 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_1 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-    __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_7 = PyNumber_Add(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__15, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_5 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_5)) {
@@ -23824,85 +23893,85 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_1);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 927, __pyx_L1_error)
+    if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 927, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 935, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->P11z, 0);
     __pyx_v_self->P11z = __pyx_t_8;
     __pyx_t_8.memview = NULL;
     __pyx_t_8.data = NULL;
 
-    /* "libfds/fields.pyx":928
+    /* "libfds/fields.pyx":936
  *         if 'P' in self.msh.bc[4:]:
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3z = _np.array(list(range(self.nz - 1, self.nz)) + list(range(self.nz)) + list(range(1)))
  *                 self.P5z = _np.array(list(range(self.nz - 2, self.nz)) + list(range(self.nz)) + list(range(2)))
  */
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_cpt); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 928, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_IsTrue(__pyx_t_6); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":929
+      /* "libfds/fields.pyx":937
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))
  *             if self.cfg.cpt:
  *                 self.P3z = _np.array(list(range(self.nz - 1, self.nz)) + list(range(self.nz)) + list(range(1)))             # <<<<<<<<<<<<<<
  *                 self.P5z = _np.array(list(range(self.nz - 2, self.nz)) + list(range(self.nz)) + list(range(2)))
  * 
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyInt_FromSsize_t((__pyx_v_self->nz - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_2 = PyInt_FromSsize_t((__pyx_v_self->nz - 1)); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
-      __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_GIVEREF(__pyx_t_2);
       PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_5);
       PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_5);
       __pyx_t_2 = 0;
       __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_2 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_5 = PySequence_List(__pyx_t_2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PyNumber_Add(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_2 = PyNumber_Add(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__16, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_7 = PySequence_List(__pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_5 = PyNumber_Add(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __pyx_t_7 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
         __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_1);
         if (likely(__pyx_t_7)) {
@@ -23911,72 +23980,72 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_1, function);
         }
       }
       __pyx_t_6 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5);
       __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 929, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 929, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 937, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P3z, 0);
       __pyx_v_self->P3z = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":930
+      /* "libfds/fields.pyx":938
  *             if self.cfg.cpt:
  *                 self.P3z = _np.array(list(range(self.nz - 1, self.nz)) + list(range(self.nz)) + list(range(1)))
  *                 self.P5z = _np.array(list(range(self.nz - 2, self.nz)) + list(range(self.nz)) + list(range(2)))             # <<<<<<<<<<<<<<
  * 
  *         # Wall and NR BC
  */
-      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_array); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->nz - 2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_1 = PyInt_FromSsize_t((__pyx_v_self->nz - 2)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_7);
       __pyx_t_1 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_t_2, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-      __pyx_t_2 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_builtin_range, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_7 = PySequence_List(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Add(__pyx_t_2, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(__pyx_builtin_range, __pyx_tuple__17, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_2 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_2 = PySequence_List(__pyx_t_7); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_2);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_7 = PyNumber_Add(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
       __pyx_t_2 = NULL;
       if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
         __pyx_t_2 = PyMethod_GET_SELF(__pyx_t_5);
         if (likely(__pyx_t_2)) {
@@ -23985,270 +24054,270 @@
           __Pyx_INCREF(function);
           __Pyx_DECREF_SET(__pyx_t_5, function);
         }
       }
       __pyx_t_6 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_7) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_7);
       __Pyx_XDECREF(__pyx_t_2); __pyx_t_2 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 930, __pyx_L1_error)
+      if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_6);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 930, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 938, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
       __PYX_XDEC_MEMVIEW(&__pyx_v_self->P5z, 0);
       __pyx_v_self->P5z = __pyx_t_8;
       __pyx_t_8.memview = NULL;
       __pyx_t_8.data = NULL;
 
-      /* "libfds/fields.pyx":928
+      /* "libfds/fields.pyx":936
  *         if 'P' in self.msh.bc[4:]:
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))
  *             if self.cfg.cpt:             # <<<<<<<<<<<<<<
  *                 self.P3z = _np.array(list(range(self.nz - 1, self.nz)) + list(range(self.nz)) + list(range(1)))
  *                 self.P5z = _np.array(list(range(self.nz - 2, self.nz)) + list(range(self.nz)) + list(range(2)))
  */
     }
 
-    /* "libfds/fields.pyx":926
+    /* "libfds/fields.pyx":934
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[4:]:             # <<<<<<<<<<<<<<
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))
  *             if self.cfg.cpt:
  */
   }
 
-  /* "libfds/fields.pyx":933
+  /* "libfds/fields.pyx":941
  * 
  *         # Wall and NR BC
  *         self.bc = []             # <<<<<<<<<<<<<<
  * 
  *         for face in self.msh.obstacles.faces:
  */
-  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 933, __pyx_L1_error)
+  __pyx_t_6 = PyList_New(0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 941, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_6);
   __Pyx_GOTREF(__pyx_v_self->bc);
   __Pyx_DECREF(__pyx_v_self->bc);
   __pyx_v_self->bc = ((PyObject*)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "libfds/fields.pyx":935
+  /* "libfds/fields.pyx":943
  *         self.bc = []
  * 
  *         for face in self.msh.obstacles.faces:             # <<<<<<<<<<<<<<
  *             if not face.covered and not face.clamped:
  *                 self.bc.append(Face3d(self, face))
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 943, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_faces); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_faces); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   if (likely(PyList_CheckExact(__pyx_t_5)) || PyTuple_CheckExact(__pyx_t_5)) {
     __pyx_t_6 = __pyx_t_5; __Pyx_INCREF(__pyx_t_6); __pyx_t_9 = 0;
     __pyx_t_10 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 943, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_10 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 935, __pyx_L1_error)
+    __pyx_t_10 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 943, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   for (;;) {
     if (likely(!__pyx_t_10)) {
       if (likely(PyList_CheckExact(__pyx_t_6))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_5 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 943, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_5 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_9); __Pyx_INCREF(__pyx_t_5); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 943, __pyx_L1_error)
         #else
-        __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
+        __pyx_t_5 = PySequence_ITEM(__pyx_t_6, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 943, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_5);
         #endif
       }
     } else {
       __pyx_t_5 = __pyx_t_10(__pyx_t_6);
       if (unlikely(!__pyx_t_5)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 935, __pyx_L1_error)
+          else __PYX_ERR(0, 943, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_5);
     }
     __Pyx_XDECREF_SET(__pyx_v_face, __pyx_t_5);
     __pyx_t_5 = 0;
 
-    /* "libfds/fields.pyx":936
+    /* "libfds/fields.pyx":944
  * 
  *         for face in self.msh.obstacles.faces:
  *             if not face.covered and not face.clamped:             # <<<<<<<<<<<<<<
  *                 self.bc.append(Face3d(self, face))
  * 
  */
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_covered); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_covered); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_11 = ((!__pyx_t_3) != 0);
     if (__pyx_t_11) {
     } else {
       __pyx_t_4 = __pyx_t_11;
       goto __pyx_L12_bool_binop_done;
     }
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_clamped); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_face, __pyx_n_s_clamped); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 936, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_IsTrue(__pyx_t_5); if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 944, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_3 = ((!__pyx_t_11) != 0);
     __pyx_t_4 = __pyx_t_3;
     __pyx_L12_bool_binop_done:;
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":937
+      /* "libfds/fields.pyx":945
  *         for face in self.msh.obstacles.faces:
  *             if not face.covered and not face.clamped:
  *                 self.bc.append(Face3d(self, face))             # <<<<<<<<<<<<<<
  * 
  *         for face in self.msh.bounds:
  */
       if (unlikely(__pyx_v_self->bc == Py_None)) {
         PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-        __PYX_ERR(0, 937, __pyx_L1_error)
+        __PYX_ERR(0, 945, __pyx_L1_error)
       }
-      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 937, __pyx_L1_error)
+      __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 945, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       __Pyx_INCREF(((PyObject *)__pyx_v_self));
       __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
       PyTuple_SET_ITEM(__pyx_t_5, 0, ((PyObject *)__pyx_v_self));
       __Pyx_INCREF(__pyx_v_face);
       __Pyx_GIVEREF(__pyx_v_face);
       PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_v_face);
-      __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 937, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 945, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-      __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_7); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 937, __pyx_L1_error)
+      __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_7); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 945, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-      /* "libfds/fields.pyx":936
+      /* "libfds/fields.pyx":944
  * 
  *         for face in self.msh.obstacles.faces:
  *             if not face.covered and not face.clamped:             # <<<<<<<<<<<<<<
  *                 self.bc.append(Face3d(self, face))
  * 
  */
     }
 
-    /* "libfds/fields.pyx":935
+    /* "libfds/fields.pyx":943
  *         self.bc = []
  * 
  *         for face in self.msh.obstacles.faces:             # <<<<<<<<<<<<<<
  *             if not face.covered and not face.clamped:
  *                 self.bc.append(Face3d(self, face))
  */
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "libfds/fields.pyx":939
+  /* "libfds/fields.pyx":947
  *                 self.bc.append(Face3d(self, face))
  * 
  *         for face in self.msh.bounds:             # <<<<<<<<<<<<<<
  *             self.bc.append(Face3d(self, face))
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 939, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
     __pyx_t_7 = __pyx_t_6; __Pyx_INCREF(__pyx_t_7); __pyx_t_9 = 0;
     __pyx_t_10 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 939, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_7 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 947, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 939, __pyx_L1_error)
+    __pyx_t_10 = Py_TYPE(__pyx_t_7)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 947, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   for (;;) {
     if (likely(!__pyx_t_10)) {
       if (likely(PyList_CheckExact(__pyx_t_7))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_7)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 939, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_7)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 939, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_7, __pyx_t_9); __Pyx_INCREF(__pyx_t_6); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 947, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 939, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_7, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 947, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       }
     } else {
       __pyx_t_6 = __pyx_t_10(__pyx_t_7);
       if (unlikely(!__pyx_t_6)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 939, __pyx_L1_error)
+          else __PYX_ERR(0, 947, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_6);
     }
     __Pyx_XDECREF_SET(__pyx_v_face, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":940
+    /* "libfds/fields.pyx":948
  * 
  *         for face in self.msh.bounds:
  *             self.bc.append(Face3d(self, face))             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_subdomains(self):
  */
     if (unlikely(__pyx_v_self->bc == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 940, __pyx_L1_error)
+      __PYX_ERR(0, 948, __pyx_L1_error)
     }
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 940, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 948, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(((PyObject *)__pyx_v_self));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
     PyTuple_SET_ITEM(__pyx_t_6, 0, ((PyObject *)__pyx_v_self));
     __Pyx_INCREF(__pyx_v_face);
     __Pyx_GIVEREF(__pyx_v_face);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_v_face);
-    __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face3d), __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 940, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Face3d), __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 948, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_5); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 940, __pyx_L1_error)
+    __pyx_t_12 = __Pyx_PyList_Append(__pyx_v_self->bc, __pyx_t_5); if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 948, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "libfds/fields.pyx":939
+    /* "libfds/fields.pyx":947
  *                 self.bc.append(Face3d(self, face))
  * 
  *         for face in self.msh.bounds:             # <<<<<<<<<<<<<<
  *             self.bc.append(Face3d(self, face))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
 
-  /* "libfds/fields.pyx":911
+  /* "libfds/fields.pyx":919
  *             self.odzdtrk_v = _np.zeros_like(self.msh.z)
  * 
  *     cdef void init_bc(self):             # <<<<<<<<<<<<<<
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  */
 
@@ -24263,15 +24332,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_bc", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_face);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":942
+/* "libfds/fields.pyx":950
  *             self.bc.append(Face3d(self, face))
  * 
  *     cdef void init_subdomains(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cdomains = []
  */
 
@@ -24287,473 +24356,473 @@
   int __pyx_t_7;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_subdomains", 0);
 
-  /* "libfds/fields.pyx":944
+  /* "libfds/fields.pyx":952
  *     cdef void init_subdomains(self):
  * 
  *         self.cdomains = []             # <<<<<<<<<<<<<<
  *         self.xdomains = []
  *         self.ydomains = []
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 952, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->cdomains);
   __Pyx_DECREF(__pyx_v_self->cdomains);
   __pyx_v_self->cdomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":945
+  /* "libfds/fields.pyx":953
  * 
  *         self.cdomains = []
  *         self.xdomains = []             # <<<<<<<<<<<<<<
  *         self.ydomains = []
  *         self.zdomains = []
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 945, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->xdomains);
   __Pyx_DECREF(__pyx_v_self->xdomains);
   __pyx_v_self->xdomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":946
+  /* "libfds/fields.pyx":954
  *         self.cdomains = []
  *         self.xdomains = []
  *         self.ydomains = []             # <<<<<<<<<<<<<<
  *         self.zdomains = []
  * 
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 954, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->ydomains);
   __Pyx_DECREF(__pyx_v_self->ydomains);
   __pyx_v_self->ydomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":947
+  /* "libfds/fields.pyx":955
  *         self.xdomains = []
  *         self.ydomains = []
  *         self.zdomains = []             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.cdomains:
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 947, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 955, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->zdomains);
   __Pyx_DECREF(__pyx_v_self->zdomains);
   __pyx_v_self->zdomains = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":949
+  /* "libfds/fields.pyx":957
  *         self.zdomains = []
  * 
  *         for sub in self.msh.cdomains:             # <<<<<<<<<<<<<<
  *             self.cdomains.append(Domain3d(*sub.cn, '_', self.cpu))
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_cdomains); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_cdomains); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 949, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 957, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 949, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 957, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 957, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 957, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 949, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 957, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 949, __pyx_L1_error)
+          else __PYX_ERR(0, 957, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":950
+    /* "libfds/fields.pyx":958
  * 
  *         for sub in self.msh.cdomains:
  *             self.cdomains.append(Domain3d(*sub.cn, '_', self.cpu))             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.xdomains:
  */
     if (unlikely(__pyx_v_self->cdomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 950, __pyx_L1_error)
+      __PYX_ERR(0, 958, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_INCREF(__pyx_n_u__19);
     __Pyx_GIVEREF(__pyx_n_u__19);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_n_u__19);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_1);
     __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->cdomains, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 950, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->cdomains, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 958, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":949
+    /* "libfds/fields.pyx":957
  *         self.zdomains = []
  * 
  *         for sub in self.msh.cdomains:             # <<<<<<<<<<<<<<
  *             self.cdomains.append(Domain3d(*sub.cn, '_', self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":952
+  /* "libfds/fields.pyx":960
  *             self.cdomains.append(Domain3d(*sub.cn, '_', self.cpu))
  * 
  *         for sub in self.msh.xdomains:             # <<<<<<<<<<<<<<
  *             self.xdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  */
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xdomains); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 952, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xdomains); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 960, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   if (likely(PyList_CheckExact(__pyx_t_2)) || PyTuple_CheckExact(__pyx_t_2)) {
     __pyx_t_6 = __pyx_t_2; __Pyx_INCREF(__pyx_t_6); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 952, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_6 = PyObject_GetIter(__pyx_t_2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 960, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 952, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_6)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 960, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_6))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 952, __pyx_L1_error)
+        __pyx_t_2 = PyList_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 960, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 952, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 960, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_6)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 952, __pyx_L1_error)
+        __pyx_t_2 = PyTuple_GET_ITEM(__pyx_t_6, __pyx_t_3); __Pyx_INCREF(__pyx_t_2); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 960, __pyx_L1_error)
         #else
-        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 952, __pyx_L1_error)
+        __pyx_t_2 = PySequence_ITEM(__pyx_t_6, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 960, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_2);
         #endif
       }
     } else {
       __pyx_t_2 = __pyx_t_4(__pyx_t_6);
       if (unlikely(!__pyx_t_2)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 952, __pyx_L1_error)
+          else __PYX_ERR(0, 960, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_2);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_2);
     __pyx_t_2 = 0;
 
-    /* "libfds/fields.pyx":953
+    /* "libfds/fields.pyx":961
  * 
  *         for sub in self.msh.xdomains:
  *             self.xdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.ydomains:
  */
     if (unlikely(__pyx_v_self->xdomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 953, __pyx_L1_error)
+      __PYX_ERR(0, 961, __pyx_L1_error)
     }
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(2); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_2);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_5);
     __pyx_t_2 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->xdomains, __pyx_t_8); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 953, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->xdomains, __pyx_t_8); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 961, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "libfds/fields.pyx":952
+    /* "libfds/fields.pyx":960
  *             self.cdomains.append(Domain3d(*sub.cn, '_', self.cpu))
  * 
  *         for sub in self.msh.xdomains:             # <<<<<<<<<<<<<<
  *             self.xdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-  /* "libfds/fields.pyx":955
+  /* "libfds/fields.pyx":963
  *             self.xdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  *         for sub in self.msh.ydomains:             # <<<<<<<<<<<<<<
  *             self.ydomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  */
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_ydomains); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_ydomains); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   if (likely(PyList_CheckExact(__pyx_t_6)) || PyTuple_CheckExact(__pyx_t_6)) {
     __pyx_t_8 = __pyx_t_6; __Pyx_INCREF(__pyx_t_8); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_8 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 963, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_4 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 955, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_8)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 963, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_8))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
+        __pyx_t_6 = PyList_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 963, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_8)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 955, __pyx_L1_error)
+        __pyx_t_6 = PyTuple_GET_ITEM(__pyx_t_8, __pyx_t_3); __Pyx_INCREF(__pyx_t_6); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 963, __pyx_L1_error)
         #else
-        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 955, __pyx_L1_error)
+        __pyx_t_6 = PySequence_ITEM(__pyx_t_8, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 963, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_6);
         #endif
       }
     } else {
       __pyx_t_6 = __pyx_t_4(__pyx_t_8);
       if (unlikely(!__pyx_t_6)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 955, __pyx_L1_error)
+          else __PYX_ERR(0, 963, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_6);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":956
+    /* "libfds/fields.pyx":964
  * 
  *         for sub in self.msh.ydomains:
  *             self.ydomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.msh.zdomains:
  */
     if (unlikely(__pyx_v_self->ydomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 956, __pyx_L1_error)
+      __PYX_ERR(0, 964, __pyx_L1_error)
     }
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PySequence_Tuple(__pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_2 = PyTuple_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
     __pyx_t_6 = 0;
     __pyx_t_1 = 0;
-    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_1 = PyNumber_Add(__pyx_t_5, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->ydomains, __pyx_t_2); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 956, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->ydomains, __pyx_t_2); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 964, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-    /* "libfds/fields.pyx":955
+    /* "libfds/fields.pyx":963
  *             self.xdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  *         for sub in self.msh.ydomains:             # <<<<<<<<<<<<<<
  *             self.ydomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-  /* "libfds/fields.pyx":958
+  /* "libfds/fields.pyx":966
  *             self.ydomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  *         for sub in self.msh.zdomains:             # <<<<<<<<<<<<<<
  *             self.zdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  */
-  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_zdomains); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 958, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_zdomains); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 966, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   if (likely(PyList_CheckExact(__pyx_t_8)) || PyTuple_CheckExact(__pyx_t_8)) {
     __pyx_t_2 = __pyx_t_8; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 958, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_8); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 966, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 958, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 966, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_8); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 958, __pyx_L1_error)
+        __pyx_t_8 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_8); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 966, __pyx_L1_error)
         #else
-        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 958, __pyx_L1_error)
+        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 966, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_8); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 958, __pyx_L1_error)
+        __pyx_t_8 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_8); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 966, __pyx_L1_error)
         #else
-        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 958, __pyx_L1_error)
+        __pyx_t_8 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 966, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         #endif
       }
     } else {
       __pyx_t_8 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_8)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 958, __pyx_L1_error)
+          else __PYX_ERR(0, 966, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_8);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_8);
     __pyx_t_8 = 0;
 
-    /* "libfds/fields.pyx":959
+    /* "libfds/fields.pyx":967
  * 
  *         for sub in self.msh.zdomains:
  *             self.zdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_field(self):
  */
     if (unlikely(__pyx_v_self->zdomains == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 959, __pyx_L1_error)
+      __PYX_ERR(0, 967, __pyx_L1_error)
     }
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PySequence_Tuple(__pyx_t_8); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_tag); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->cpu); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_5);
     __pyx_t_8 = 0;
     __pyx_t_5 = 0;
-    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Add(__pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Domain3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->zdomains, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 959, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyList_Append(__pyx_v_self->zdomains, __pyx_t_6); if (unlikely(__pyx_t_7 == ((int)-1))) __PYX_ERR(0, 967, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-    /* "libfds/fields.pyx":958
+    /* "libfds/fields.pyx":966
  *             self.ydomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  *         for sub in self.msh.zdomains:             # <<<<<<<<<<<<<<
  *             self.zdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":942
+  /* "libfds/fields.pyx":950
  *             self.bc.append(Face3d(self, face))
  * 
  *     cdef void init_subdomains(self):             # <<<<<<<<<<<<<<
  * 
  *         self.cdomains = []
  */
 
@@ -24767,15 +24836,15 @@
   __Pyx_XDECREF(__pyx_t_8);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_subdomains", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":961
+/* "libfds/fields.pyx":969
  *             self.zdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  *     cdef void init_field(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -24796,33 +24865,33 @@
   double __pyx_t_12;
   int __pyx_t_13;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_field", 0);
 
-  /* "libfds/fields.pyx":965
+  /* "libfds/fields.pyx":973
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         self.p = _np.zeros((self.nx, self.ny, self.nz)) + self.p0             # <<<<<<<<<<<<<<
  *         self.r = _np.zeros_like(self.p) + self.rho0
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_5);
@@ -24838,399 +24907,399 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_self->p0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_self->p0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 965, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 973, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->p, 0);
   __pyx_v_self->p = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "libfds/fields.pyx":966
+  /* "libfds/fields.pyx":974
  * 
  *         self.p = _np.zeros((self.nx, self.ny, self.nz)) + self.p0
  *         self.r = _np.zeros_like(self.p) + self.rho0             # <<<<<<<<<<<<<<
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 966, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->rho0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->rho0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 966, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 974, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->r, 0);
   __pyx_v_self->r = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "libfds/fields.pyx":967
+  /* "libfds/fields.pyx":975
  *         self.p = _np.zeros((self.nx, self.ny, self.nz)) + self.p0
  *         self.r = _np.zeros_like(self.p) + self.rho0
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0             # <<<<<<<<<<<<<<
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  *         self.rw = _np.zeros_like(self.p) + self.W0 * self.rho0
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 967, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_self->U0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_self->U0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 967, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 975, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->ru, 0);
   __pyx_v_self->ru = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "libfds/fields.pyx":968
+  /* "libfds/fields.pyx":976
  *         self.r = _np.zeros_like(self.p) + self.rho0
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0             # <<<<<<<<<<<<<<
  *         self.rw = _np.zeros_like(self.p) + self.W0 * self.rho0
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 968, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_self->V0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_self->V0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_6 = PyNumber_Add(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 968, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_6, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 976, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->rv, 0);
   __pyx_v_self->rv = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "libfds/fields.pyx":969
+  /* "libfds/fields.pyx":977
  *         self.ru = _np.zeros_like(self.p) + self.U0 * self.rho0
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  *         self.rw = _np.zeros_like(self.p) + self.W0 * self.rho0             # <<<<<<<<<<<<<<
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_1))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_6 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 969, __pyx_L1_error)
+  if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->W0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble((__pyx_v_self->W0 * __pyx_v_self->rho0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Add(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 969, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 977, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->rw, 0);
   __pyx_v_self->rw = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "libfds/fields.pyx":970
+  /* "libfds/fields.pyx":978
  *         self.rv = _np.zeros_like(self.p) + self.V0 * self.rho0
  *         self.rw = _np.zeros_like(self.p) + self.W0 * self.rho0
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone             # <<<<<<<<<<<<<<
  * 
  *         if self.cfg.vrt:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 970, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_1, __pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 970, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 970, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_6, function);
     }
   }
   __pyx_t_3 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_1) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 970, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_self->p0 / __pyx_v_self->gaminusone)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 970, __pyx_L1_error)
+  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_self->p0 / __pyx_v_self->gaminusone)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 970, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Add(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 970, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 978, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->re, 0);
   __pyx_v_self->re = __pyx_t_7;
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
 
-  /* "libfds/fields.pyx":972
+  /* "libfds/fields.pyx":980
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  * 
  *         if self.cfg.vrt:             # <<<<<<<<<<<<<<
  *             self.wx = _np.zeros_like(self.p)
  *             self.wy = _np.zeros_like(self.p)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 972, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_8 < 0)) __PYX_ERR(0, 980, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_8) {
 
-    /* "libfds/fields.pyx":973
+    /* "libfds/fields.pyx":981
  * 
  *         if self.cfg.vrt:
  *             self.wx = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *             self.wy = _np.zeros_like(self.p)
  *             self.wz = _np.zeros_like(self.p)
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 973, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 973, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 973, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 973, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 981, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wx, 0);
     __pyx_v_self->wx = __pyx_t_7;
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
 
-    /* "libfds/fields.pyx":974
+    /* "libfds/fields.pyx":982
  *         if self.cfg.vrt:
  *             self.wx = _np.zeros_like(self.p)
  *             self.wy = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *             self.wz = _np.zeros_like(self.p)
  *         else:
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 982, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 982, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 982, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 982, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 974, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 982, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wy, 0);
     __pyx_v_self->wy = __pyx_t_7;
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
 
-    /* "libfds/fields.pyx":975
+    /* "libfds/fields.pyx":983
  *             self.wx = _np.zeros_like(self.p)
  *             self.wy = _np.zeros_like(self.p)
  *             self.wz = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         else:
  *             self.wx = _np.zeros((0, ) * len(self.msh.shape))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 975, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 983, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 975, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 983, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 975, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 983, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_5);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 975, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 975, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 983, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wz, 0);
     __pyx_v_self->wz = __pyx_t_7;
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
 
-    /* "libfds/fields.pyx":972
+    /* "libfds/fields.pyx":980
  *         self.re = _np.zeros_like(self.p) + self.p0 / self.gaminusone
  * 
  *         if self.cfg.vrt:             # <<<<<<<<<<<<<<
  *             self.wx = _np.zeros_like(self.p)
  *             self.wy = _np.zeros_like(self.p)
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":977
+  /* "libfds/fields.pyx":985
  *             self.wz = _np.zeros_like(self.p)
  *         else:
  *             self.wx = _np.zeros((0, ) * len(self.msh.shape))             # <<<<<<<<<<<<<<
  *             self.wy = _np.zeros((0, ) * len(self.msh.shape))
  *             self.wz = _np.zeros((0, ) * len(self.msh.shape))
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_9 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_9 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_5 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_6))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_6);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
@@ -25238,43 +25307,43 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_6, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_t_5) : __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 977, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 977, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 985, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wx, 0);
     __pyx_v_self->wx = __pyx_t_7;
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
 
-    /* "libfds/fields.pyx":978
+    /* "libfds/fields.pyx":986
  *         else:
  *             self.wx = _np.zeros((0, ) * len(self.msh.shape))
  *             self.wy = _np.zeros((0, ) * len(self.msh.shape))             # <<<<<<<<<<<<<<
  *             self.wz = _np.zeros((0, ) * len(self.msh.shape))
  * 
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_6, __pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_9 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_9 = PyObject_Length(__pyx_t_6); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_6 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_3 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __pyx_t_6 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_5))) {
       __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
       if (likely(__pyx_t_6)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
@@ -25282,43 +25351,43 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_5, function);
       }
     }
     __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3);
     __Pyx_XDECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 978, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 978, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 986, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wy, 0);
     __pyx_v_self->wy = __pyx_t_7;
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
 
-    /* "libfds/fields.pyx":979
+    /* "libfds/fields.pyx":987
  *             self.wx = _np.zeros((0, ) * len(self.msh.shape))
  *             self.wy = _np.zeros((0, ) * len(self.msh.shape))
  *             self.wz = _np.zeros((0, ) * len(self.msh.shape))             # <<<<<<<<<<<<<<
  * 
  *         # Initial pulses
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_5, __pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_9 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_9 = PyObject_Length(__pyx_t_5); if (unlikely(__pyx_t_9 == ((Py_ssize_t)-1))) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
-    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_5 = PyInt_FromSsize_t(__pyx_t_9); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_6 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
     __pyx_t_5 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_5)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
@@ -25326,119 +25395,119 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_6) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6);
     __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 979, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 979, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 987, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->wz, 0);
     __pyx_v_self->wz = __pyx_t_7;
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":982
+  /* "libfds/fields.pyx":990
  * 
  *         # Initial pulses
  *         for s in self.cfg.ics:             # <<<<<<<<<<<<<<
  *             self.pulse(s.origin, s.amplitude, s.width)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_ics); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 982, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_ics); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_9 = 0;
     __pyx_t_10 = NULL;
   } else {
-    __pyx_t_9 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 982, __pyx_L1_error)
+    __pyx_t_9 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 982, __pyx_L1_error)
+    __pyx_t_10 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 990, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_10)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_9 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 982, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 990, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 982, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_9 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 982, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_9); __Pyx_INCREF(__pyx_t_1); __pyx_t_9++; if (unlikely(0 < 0)) __PYX_ERR(0, 990, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 982, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_9); __pyx_t_9++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_10(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 982, __pyx_L1_error)
+          else __PYX_ERR(0, 990, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_s, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":983
+    /* "libfds/fields.pyx":991
  *         # Initial pulses
  *         for s in self.cfg.ics:
  *             self.pulse(s.origin, s.amplitude, s.width)             # <<<<<<<<<<<<<<
  * 
  *         # Set to 0 at obstacle locations
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_11 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t__and_Py_ssize_t(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 983, __pyx_L1_error)
+    __pyx_t_11 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t__and_Py_ssize_t(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_amplitude); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_amplitude); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_12 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 983, __pyx_L1_error)
+    __pyx_t_12 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_12 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 983, __pyx_L1_error)
+    __pyx_t_13 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_13 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 991, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __pyx_f_6libfds_6fields_8Fields3d_pulse(__pyx_v_self, __pyx_t_11, __pyx_t_12, __pyx_t_13);
 
-    /* "libfds/fields.pyx":982
+    /* "libfds/fields.pyx":990
  * 
  *         # Initial pulses
  *         for s in self.cfg.ics:             # <<<<<<<<<<<<<<
  *             self.pulse(s.origin, s.amplitude, s.width)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "libfds/fields.pyx":986
+  /* "libfds/fields.pyx":994
  * 
  *         # Set to 0 at obstacle locations
  *         self.zero_obstacles()             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_sources(self):
  */
   __pyx_f_6libfds_6fields_8Fields3d_zero_obstacles(__pyx_v_self);
 
-  /* "libfds/fields.pyx":961
+  /* "libfds/fields.pyx":969
  *             self.zdomains.append(Domain3d(*sub.cn, sub.tag, self.cpu))
  * 
  *     cdef void init_field(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -25454,15 +25523,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_field", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_s);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":988
+/* "libfds/fields.pyx":996
  *         self.zero_obstacles()
  * 
  *     cdef void init_sources(self):             # <<<<<<<<<<<<<<
  * 
  *         self.src = []
  */
 
@@ -25480,133 +25549,133 @@
   PyObject *__pyx_t_9 = NULL;
   int __pyx_t_10;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_sources", 0);
 
-  /* "libfds/fields.pyx":990
+  /* "libfds/fields.pyx":998
  *     cdef void init_sources(self):
  * 
  *         self.src = []             # <<<<<<<<<<<<<<
  * 
  *         for s in self.cfg.src:
  */
-  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
+  __pyx_t_1 = PyList_New(0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->src);
   __Pyx_DECREF(__pyx_v_self->src);
   __pyx_v_self->src = ((PyObject*)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":992
+  /* "libfds/fields.pyx":1000
  *         self.src = []
  * 
  *         for s in self.cfg.src:             # <<<<<<<<<<<<<<
  *             self.src.append(Monopole3d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_src); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 992, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_src); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 992, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1000, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 992, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1000, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 992, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 992, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1000, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 992, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 992, __pyx_L1_error)
+          else __PYX_ERR(0, 1000, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_s, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":993
+    /* "libfds/fields.pyx":1001
  * 
  *         for s in self.cfg.src:
  *             self.src.append(Monopole3d(self.monopole_distribution(s.origin, s.width), s.evolution))             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_cvars(self):
  */
     if (unlikely(__pyx_v_self->src == Py_None)) {
       PyErr_Format(PyExc_AttributeError, "'NoneType' object has no attribute '%.30s'", "append");
-      __PYX_ERR(0, 993, __pyx_L1_error)
+      __PYX_ERR(0, 1001, __pyx_L1_error)
     }
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_origin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_5 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t__and_Py_ssize_t(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_5 = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t__and_Py_ssize_t(__pyx_t_1); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_width); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_6 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_6 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_7 = __pyx_f_6libfds_6fields_8Fields3d_monopole_distribution(__pyx_v_self, __pyx_t_5, __pyx_t_6, 0); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 993, __pyx_L1_error)
-    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_7, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_7 = __pyx_f_6libfds_6fields_8Fields3d_monopole_distribution(__pyx_v_self, __pyx_t_5, __pyx_t_6, 0); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 1001, __pyx_L1_error)
+    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_t_7, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
     __pyx_t_7.memview = NULL;
     __pyx_t_7.data = NULL;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_evolution); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_s, __pyx_n_s_evolution); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_9 = PyTuple_New(2); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_9);
     __Pyx_GIVEREF(__pyx_t_1);
     PyTuple_SET_ITEM(__pyx_t_9, 0, __pyx_t_1);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_9, 1, __pyx_t_8);
     __pyx_t_1 = 0;
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Monopole3d), __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_6fields_Monopole3d), __pyx_t_9, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
-    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_self->src, __pyx_t_8); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 993, __pyx_L1_error)
+    __pyx_t_10 = __Pyx_PyList_Append(__pyx_v_self->src, __pyx_t_8); if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 1001, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-    /* "libfds/fields.pyx":992
+    /* "libfds/fields.pyx":1000
  *         self.src = []
  * 
  *         for s in self.cfg.src:             # <<<<<<<<<<<<<<
  *             self.src.append(Monopole3d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":988
+  /* "libfds/fields.pyx":996
  *         self.zero_obstacles()
  * 
  *     cdef void init_sources(self):             # <<<<<<<<<<<<<<
  * 
  *         self.src = []
  */
 
@@ -25620,15 +25689,15 @@
   __Pyx_XDECREF(__pyx_t_9);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_sources", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_s);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":995
+/* "libfds/fields.pyx":1003
  *             self.src.append(Monopole3d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  *     cdef void init_cvars(self):             # <<<<<<<<<<<<<<
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)
  */
 
@@ -25642,834 +25711,834 @@
   int __pyx_t_6;
   Py_ssize_t __pyx_t_7;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_cvars", 0);
 
-  /* "libfds/fields.pyx":996
+  /* "libfds/fields.pyx":1004
  * 
  *     cdef void init_cvars(self):
  *         self.E = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Eu = _np.zeros_like(self.p)
  *         self.Ev = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 996, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1004, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->E, 0);
   __pyx_v_self->E = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":997
+  /* "libfds/fields.pyx":1005
  *     cdef void init_cvars(self):
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ev = _np.zeros_like(self.p)
  *         self.Ew = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1005, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1005, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 997, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1005, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Eu, 0);
   __pyx_v_self->Eu = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":998
+  /* "libfds/fields.pyx":1006
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)
  *         self.Ev = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ew = _np.zeros_like(self.p)
  *         self.Ee = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1006, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1006, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1006, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1006, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 998, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1006, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ev, 0);
   __pyx_v_self->Ev = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":999
+  /* "libfds/fields.pyx":1007
  *         self.Eu = _np.zeros_like(self.p)
  *         self.Ev = _np.zeros_like(self.p)
  *         self.Ew = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ee = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 999, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1007, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 999, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1007, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 999, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1007, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1007, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 999, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1007, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ew, 0);
   __pyx_v_self->Ew = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1000
+  /* "libfds/fields.pyx":1008
  *         self.Ev = _np.zeros_like(self.p)
  *         self.Ew = _np.zeros_like(self.p)
  *         self.Ee = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         self.F = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1008, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1000, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1008, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1008, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1008, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1000, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1008, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ee, 0);
   __pyx_v_self->Ee = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1002
+  /* "libfds/fields.pyx":1010
  *         self.Ee = _np.zeros_like(self.p)
  * 
  *         self.F = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fu = _np.zeros_like(self.p)
  *         self.Fv = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1010, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1002, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1010, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1002, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1010, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1002, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1010, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1002, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1010, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->F, 0);
   __pyx_v_self->F = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1003
+  /* "libfds/fields.pyx":1011
  * 
  *         self.F = _np.zeros_like(self.p)
  *         self.Fu = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fv = _np.zeros_like(self.p)
  *         self.Fw = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1003, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1011, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fu, 0);
   __pyx_v_self->Fu = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1004
+  /* "libfds/fields.pyx":1012
  *         self.F = _np.zeros_like(self.p)
  *         self.Fu = _np.zeros_like(self.p)
  *         self.Fv = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fw = _np.zeros_like(self.p)
  *         self.Fe = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1012, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1012, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1004, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1012, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fv, 0);
   __pyx_v_self->Fv = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1005
+  /* "libfds/fields.pyx":1013
  *         self.Fu = _np.zeros_like(self.p)
  *         self.Fv = _np.zeros_like(self.p)
  *         self.Fw = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Fe = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1005, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1013, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fw, 0);
   __pyx_v_self->Fw = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1006
+  /* "libfds/fields.pyx":1014
  *         self.Fv = _np.zeros_like(self.p)
  *         self.Fw = _np.zeros_like(self.p)
  *         self.Fe = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         self.G = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1006, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1014, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1006, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1014, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1006, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1014, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1006, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1014, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1006, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1014, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Fe, 0);
   __pyx_v_self->Fe = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1008
+  /* "libfds/fields.pyx":1016
  *         self.Fe = _np.zeros_like(self.p)
  * 
  *         self.G = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Gu = _np.zeros_like(self.p)
  *         self.Gv = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1008, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1008, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1008, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1008, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1008, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1016, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->G, 0);
   __pyx_v_self->G = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1009
+  /* "libfds/fields.pyx":1017
  * 
  *         self.G = _np.zeros_like(self.p)
  *         self.Gu = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Gv = _np.zeros_like(self.p)
  *         self.Gw = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1017, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1017, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1017, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1009, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1017, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Gu, 0);
   __pyx_v_self->Gu = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1010
+  /* "libfds/fields.pyx":1018
  *         self.G = _np.zeros_like(self.p)
  *         self.Gu = _np.zeros_like(self.p)
  *         self.Gv = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Gw = _np.zeros_like(self.p)
  *         self.Ge = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1010, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1010, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1010, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1010, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1010, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1018, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Gv, 0);
   __pyx_v_self->Gv = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1011
+  /* "libfds/fields.pyx":1019
  *         self.Gu = _np.zeros_like(self.p)
  *         self.Gv = _np.zeros_like(self.p)
  *         self.Gw = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ge = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1019, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1019, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1019, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1011, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1019, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Gw, 0);
   __pyx_v_self->Gw = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1012
+  /* "libfds/fields.pyx":1020
  *         self.Gv = _np.zeros_like(self.p)
  *         self.Gw = _np.zeros_like(self.p)
  *         self.Ge = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         self.K = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1012, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1020, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1020, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1012, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1020, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1012, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1020, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1012, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1020, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ge, 0);
   __pyx_v_self->Ge = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1014
+  /* "libfds/fields.pyx":1022
  *         self.Ge = _np.zeros_like(self.p)
  * 
  *         self.K = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ku = _np.zeros_like(self.p)
  *         self.Kv = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1022, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1022, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1022, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1022, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1014, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1022, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->K, 0);
   __pyx_v_self->K = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1015
+  /* "libfds/fields.pyx":1023
  * 
  *         self.K = _np.zeros_like(self.p)
  *         self.Ku = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Kv = _np.zeros_like(self.p)
  *         self.Kw = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1015, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1023, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ku, 0);
   __pyx_v_self->Ku = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1016
+  /* "libfds/fields.pyx":1024
  *         self.K = _np.zeros_like(self.p)
  *         self.Ku = _np.zeros_like(self.p)
  *         self.Kv = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Kw = _np.zeros_like(self.p)
  *         self.Ke = _np.zeros_like(self.p)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1016, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1024, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Kv, 0);
   __pyx_v_self->Kv = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1017
+  /* "libfds/fields.pyx":1025
  *         self.Ku = _np.zeros_like(self.p)
  *         self.Kv = _np.zeros_like(self.p)
  *         self.Kw = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         self.Ke = _np.zeros_like(self.p)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1017, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1017, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1017, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1017, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1025, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Kw, 0);
   __pyx_v_self->Kw = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1018
+  /* "libfds/fields.pyx":1026
  *         self.Kv = _np.zeros_like(self.p)
  *         self.Kw = _np.zeros_like(self.p)
  *         self.Ke = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  * 
  *         if self.cfg.vsc:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1018, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1018, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1026, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->Ke, 0);
   __pyx_v_self->Ke = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1020
+  /* "libfds/fields.pyx":1028
  *         self.Ke = _np.zeros_like(self.p)
  * 
  *         if self.cfg.vsc:             # <<<<<<<<<<<<<<
  *             self.Tk = _np.zeros_like(self.p)
  *         else:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vsc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1020, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_vsc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1020, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1028, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":1021
+    /* "libfds/fields.pyx":1029
  * 
  *         if self.cfg.vsc:
  *             self.Tk = _np.zeros_like(self.p)             # <<<<<<<<<<<<<<
  *         else:
  *             self.Tk = _np.zeros((0, ) * len(self.msh.shape))
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1021, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1021, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1029, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1021, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __pyx_t_4 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
       __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
       if (likely(__pyx_t_4)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
         __Pyx_INCREF(__pyx_t_4);
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_3, function);
       }
     }
     __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
     __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1021, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1021, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1029, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->Tk, 0);
     __pyx_v_self->Tk = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
 
-    /* "libfds/fields.pyx":1020
+    /* "libfds/fields.pyx":1028
  *         self.Ke = _np.zeros_like(self.p)
  * 
  *         if self.cfg.vsc:             # <<<<<<<<<<<<<<
  *             self.Tk = _np.zeros_like(self.p)
  *         else:
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1023
+  /* "libfds/fields.pyx":1031
  *             self.Tk = _np.zeros_like(self.p)
  *         else:
  *             self.Tk = _np.zeros((0, ) * len(self.msh.shape))             # <<<<<<<<<<<<<<
  * 
  *         self.S11 = _np.zeros_like(self.Tk)
  */
   /*else*/ {
-    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_shape); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __pyx_t_7 = PyObject_Length(__pyx_t_3); if (unlikely(__pyx_t_7 == ((Py_ssize_t)-1))) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __pyx_t_3 = PyInt_FromSsize_t(__pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __pyx_t_4 = PyNumber_Multiply(__pyx_tuple__20, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __pyx_t_3 = NULL;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_3)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -26477,249 +26546,249 @@
         __Pyx_INCREF(function);
         __Pyx_DECREF_SET(__pyx_t_2, function);
       }
     }
     __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
     __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1023, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1031, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->Tk, 0);
     __pyx_v_self->Tk = __pyx_t_5;
     __pyx_t_5.memview = NULL;
     __pyx_t_5.data = NULL;
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1025
+  /* "libfds/fields.pyx":1033
  *             self.Tk = _np.zeros((0, ) * len(self.msh.shape))
  * 
  *         self.S11 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S22 = _np.zeros_like(self.Tk)
  *         self.S33 = _np.zeros_like(self.Tk)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1025, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1025, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1025, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1025, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1033, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S11, 0);
   __pyx_v_self->S11 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1026
+  /* "libfds/fields.pyx":1034
  * 
  *         self.S11 = _np.zeros_like(self.Tk)
  *         self.S22 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S33 = _np.zeros_like(self.Tk)
  *         self.S12 = _np.zeros_like(self.Tk)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1034, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1034, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1034, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1034, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1026, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1034, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S22, 0);
   __pyx_v_self->S22 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1027
+  /* "libfds/fields.pyx":1035
  *         self.S11 = _np.zeros_like(self.Tk)
  *         self.S22 = _np.zeros_like(self.Tk)
  *         self.S33 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S12 = _np.zeros_like(self.Tk)
  *         self.S13 = _np.zeros_like(self.Tk)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1027, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1035, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S33, 0);
   __pyx_v_self->S33 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1028
+  /* "libfds/fields.pyx":1036
  *         self.S22 = _np.zeros_like(self.Tk)
  *         self.S33 = _np.zeros_like(self.Tk)
  *         self.S12 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S13 = _np.zeros_like(self.Tk)
  *         self.S23 = _np.zeros_like(self.Tk)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1028, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1036, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S12, 0);
   __pyx_v_self->S12 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1029
+  /* "libfds/fields.pyx":1037
  *         self.S33 = _np.zeros_like(self.Tk)
  *         self.S12 = _np.zeros_like(self.Tk)
  *         self.S13 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  *         self.S23 = _np.zeros_like(self.Tk)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_4))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_4, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_4, __pyx_t_3, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1029, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1037, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S13, 0);
   __pyx_v_self->S13 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":1030
+  /* "libfds/fields.pyx":1038
  *         self.S12 = _np.zeros_like(self.Tk)
  *         self.S13 = _np.zeros_like(self.Tk)
  *         self.S23 = _np.zeros_like(self.Tk)             # <<<<<<<<<<<<<<
  * 
  *     cdef void init_buffer(self):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1038, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1030, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1038, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1030, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1038, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __pyx_t_3 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_3)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_3);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_t_4) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_4);
   __Pyx_XDECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1030, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1030, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 1038, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->S23, 0);
   __pyx_v_self->S23 = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/fields.pyx":995
+  /* "libfds/fields.pyx":1003
  *             self.src.append(Monopole3d(self.monopole_distribution(s.origin, s.width), s.evolution))
  * 
  *     cdef void init_cvars(self):             # <<<<<<<<<<<<<<
  *         self.E = _np.zeros_like(self.p)
  *         self.Eu = _np.zeros_like(self.p)
  */
 
@@ -26732,15 +26801,15 @@
   __Pyx_XDECREF(__pyx_t_4);
   __PYX_XDEC_MEMVIEW(&__pyx_t_5, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.init_cvars", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1032
+/* "libfds/fields.pyx":1040
  *         self.S23 = _np.zeros_like(self.Tk)
  * 
  *     cdef void init_buffer(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double s0 = 1.
  */
 
@@ -26800,225 +26869,225 @@
   long __pyx_t_40;
   long __pyx_t_41;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("init_buffer", 0);
 
-  /* "libfds/fields.pyx":1034
+  /* "libfds/fields.pyx":1042
  *     cdef void init_buffer(self):
  * 
  *         cdef double s0 = 1.             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t i, ix, iy, iz
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]
  */
   __pyx_v_s0 = 1.;
 
-  /* "libfds/fields.pyx":1036
+  /* "libfds/fields.pyx":1044
  *         cdef double s0 = 1.
  *         cdef Py_ssize_t i, ix, iy, iz
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]             # <<<<<<<<<<<<<<
  *         cdef double Dy = self.msh.y[self.bz_n] - self.msh.y[0]
  *         cdef double Dz = self.msh.z[self.bz_n] - self.msh.z[0]
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1036, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1036, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1036, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1036, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1044, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Dx = __pyx_t_4;
 
-  /* "libfds/fields.pyx":1037
+  /* "libfds/fields.pyx":1045
  *         cdef Py_ssize_t i, ix, iy, iz
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]
  *         cdef double Dy = self.msh.y[self.bz_n] - self.msh.y[0]             # <<<<<<<<<<<<<<
  *         cdef double Dz = self.msh.z[self.bz_n] - self.msh.z[0]
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1037, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1045, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Dy = __pyx_t_4;
 
-  /* "libfds/fields.pyx":1038
+  /* "libfds/fields.pyx":1046
  *         cdef double Dx = self.msh.x[self.bz_n] - self.msh.x[0]
  *         cdef double Dy = self.msh.y[self.bz_n] - self.msh.y[0]
  *         cdef double Dz = self.msh.z[self.bz_n] - self.msh.z[0]             # <<<<<<<<<<<<<<
  * 
  *         cdef double[::1] sx = _np.zeros(self.nx)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_GetItemInt(__pyx_t_1, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_1 = PyNumber_Subtract(__pyx_t_2, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1038, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1046, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_Dz = __pyx_t_4;
 
-  /* "libfds/fields.pyx":1040
+  /* "libfds/fields.pyx":1048
  *         cdef double Dz = self.msh.z[self.bz_n] - self.msh.z[0]
  * 
  *         cdef double[::1] sx = _np.zeros(self.nx)             # <<<<<<<<<<<<<<
  *         cdef double[::1] sy = _np.zeros(self.ny)
  *         cdef double[::1] sz = _np.zeros(self.nz)
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1048, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1048, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1048, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1048, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1040, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1048, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_sx = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":1041
+  /* "libfds/fields.pyx":1049
  * 
  *         cdef double[::1] sx = _np.zeros(self.nx)
  *         cdef double[::1] sy = _np.zeros(self.ny)             # <<<<<<<<<<<<<<
  *         cdef double[::1] sz = _np.zeros(self.nz)
  * 
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1049, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1041, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1049, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_sy = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":1042
+  /* "libfds/fields.pyx":1050
  *         cdef double[::1] sx = _np.zeros(self.nx)
  *         cdef double[::1] sy = _np.zeros(self.ny)
  *         cdef double[::1] sz = _np.zeros(self.nz)             # <<<<<<<<<<<<<<
  * 
  *         self.sigma = _np.zeros((self.nx, self.ny, self.nz))
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_3, __pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1050, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1050, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_3 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1050, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_t_5 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
     __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_2);
     if (likely(__pyx_t_5)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
       __Pyx_INCREF(__pyx_t_5);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_2, function);
     }
   }
   __pyx_t_1 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_5, __pyx_t_3) : __Pyx_PyObject_CallOneArg(__pyx_t_2, __pyx_t_3);
   __Pyx_XDECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1050, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1042, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 1050, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_sz = __pyx_t_6;
   __pyx_t_6.memview = NULL;
   __pyx_t_6.data = NULL;
 
-  /* "libfds/fields.pyx":1044
+  /* "libfds/fields.pyx":1052
  *         cdef double[::1] sz = _np.zeros(self.nz)
  * 
  *         self.sigma = _np.zeros((self.nx, self.ny, self.nz))             # <<<<<<<<<<<<<<
  * 
  *         for i in range(self.bz_n):
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_2 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_5 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_7);
@@ -27034,757 +27103,757 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_7, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_8);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1044, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1052, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __PYX_XDEC_MEMVIEW(&__pyx_v_self->sigma, 0);
   __pyx_v_self->sigma = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "libfds/fields.pyx":1046
+  /* "libfds/fields.pyx":1054
  *         self.sigma = _np.zeros((self.nx, self.ny, self.nz))
  * 
  *         for i in range(self.bz_n):             # <<<<<<<<<<<<<<
  * 
  *             if self.msh.bounds[0].bc == 'A':
  */
   __pyx_t_10 = __pyx_v_self->bz_n;
   __pyx_t_11 = __pyx_t_10;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_i = __pyx_t_12;
 
-    /* "libfds/fields.pyx":1048
+    /* "libfds/fields.pyx":1056
  *         for i in range(self.bz_n):
  * 
  *             if self.msh.bounds[0].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1048, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1048, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1048, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1048, __pyx_L1_error)
+    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1056, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_13) {
 
-      /* "libfds/fields.pyx":1049
+      /* "libfds/fields.pyx":1057
  * 
  *             if self.msh.bounds[0].bc == 'A':
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  */
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_8 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1049, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1057, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_14 = __pyx_v_i;
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_14)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":1048
+      /* "libfds/fields.pyx":1056
  *         for i in range(self.bz_n):
  * 
  *             if self.msh.bounds[0].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":1050
+    /* "libfds/fields.pyx":1058
  *             if self.msh.bounds[0].bc == 'A':
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1050, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1050, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1050, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1050, __pyx_L1_error)
+    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1058, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (__pyx_t_13) {
 
-      /* "libfds/fields.pyx":1051
+      /* "libfds/fields.pyx":1059
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  */
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = ((__pyx_v_self->nx - 1) - __pyx_v_i);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = ((__pyx_v_self->nx - 1) - __pyx_v_self->bz_n);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dx); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Multiply(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1051, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1059, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_14 = ((__pyx_v_self->nx - 1) - __pyx_v_i);
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_14)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":1050
+      /* "libfds/fields.pyx":1058
  *             if self.msh.bounds[0].bc == 'A':
  *                 sx[i] = s0 * abs((self.msh.x[i] - self.msh.x[self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[1].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":1052
+    /* "libfds/fields.pyx":1060
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1060, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1060, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1052, __pyx_L1_error)
+    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1060, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_13) {
 
-      /* "libfds/fields.pyx":1053
+      /* "libfds/fields.pyx":1061
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[3].bc == 'A':
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  */
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_8 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1053, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1061, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_14 = __pyx_v_i;
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_14)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":1052
+      /* "libfds/fields.pyx":1060
  *             if self.msh.bounds[1].bc == 'A':
  *                 sx[self.nx - 1 - i] = s0 * abs((self.msh.x[self.nx - 1 - i] - self.msh.x[self.nx - 1 - self.bz_n]) / Dx) ** self.bz_forder
  *             if self.msh.bounds[2].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":1054
+    /* "libfds/fields.pyx":1062
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[4].bc == 'A':
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1054, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1062, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_8, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1054, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_8, 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1062, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1054, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1062, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1054, __pyx_L1_error)
+    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1062, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (__pyx_t_13) {
 
-      /* "libfds/fields.pyx":1055
+      /* "libfds/fields.pyx":1063
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[4].bc == 'A':
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder
  */
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = ((__pyx_v_self->ny - 1) - __pyx_v_i);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = ((__pyx_v_self->ny - 1) - __pyx_v_self->bz_n);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Multiply(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1055, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1063, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_14 = ((__pyx_v_self->ny - 1) - __pyx_v_i);
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_14)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":1054
+      /* "libfds/fields.pyx":1062
  *             if self.msh.bounds[2].bc == 'A':
  *                 sy[i] = s0 * abs((self.msh.y[i] - self.msh.y[self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[3].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[4].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":1056
+    /* "libfds/fields.pyx":1064
  *             if self.msh.bounds[3].bc == 'A':
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[4].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder
  *             if self.msh.bounds[5].bc == 'A':
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_1, 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1064, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1064, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1056, __pyx_L1_error)
+    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_1, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1064, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     if (__pyx_t_13) {
 
-      /* "libfds/fields.pyx":1057
+      /* "libfds/fields.pyx":1065
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[4].bc == 'A':
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder             # <<<<<<<<<<<<<<
  *             if self.msh.bounds[5].bc == 'A':
  *                 sz[self.nz - 1 - i] = s0 * abs((self.msh.z[self.nz - 1 - i] - self.msh.z[self.nz - 1 - self.bz_n]) / Dz) ** self.bz_forder
  */
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_i, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_v_self->bz_n, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_8, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_8); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_8, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_8 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1057, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_8); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1065, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __pyx_t_14 = __pyx_v_i;
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sz.data) + __pyx_t_14)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":1056
+      /* "libfds/fields.pyx":1064
  *             if self.msh.bounds[3].bc == 'A':
  *                 sy[self.ny - 1 - i] = s0 * abs((self.msh.y[self.ny - 1 - i] - self.msh.y[self.ny - 1 - self.bz_n]) / Dy) ** self.bz_forder
  *             if self.msh.bounds[4].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder
  *             if self.msh.bounds[5].bc == 'A':
  */
     }
 
-    /* "libfds/fields.pyx":1058
+    /* "libfds/fields.pyx":1066
  *             if self.msh.bounds[4].bc == 'A':
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder
  *             if self.msh.bounds[5].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sz[self.nz - 1 - i] = s0 * abs((self.msh.z[self.nz - 1 - i] - self.msh.z[self.nz - 1 - self.bz_n]) / Dz) ** self.bz_forder
  * 
  */
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1058, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_bounds); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1066, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_8, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1058, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_GetItemInt(__pyx_t_8, 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1066, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1058, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_bc); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1066, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1058, __pyx_L1_error)
+    __pyx_t_13 = (__Pyx_PyUnicode_Equals(__pyx_t_8, __pyx_n_u_A, Py_EQ)); if (unlikely(__pyx_t_13 < 0)) __PYX_ERR(0, 1066, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     if (__pyx_t_13) {
 
-      /* "libfds/fields.pyx":1059
+      /* "libfds/fields.pyx":1067
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder
  *             if self.msh.bounds[5].bc == 'A':
  *                 sz[self.nz - 1 - i] = s0 * abs((self.msh.z[self.nz - 1 - i] - self.msh.z[self.nz - 1 - self.bz_n]) / Dz) ** self.bz_forder             # <<<<<<<<<<<<<<
  * 
  *         for ix in range(self.nx):
  */
-      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_8 = PyFloat_FromDouble(__pyx_v_s0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = ((__pyx_v_self->nz - 1) - __pyx_v_i);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __pyx_t_15 = ((__pyx_v_self->nz - 1) - __pyx_v_self->bz_n);
-      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_GetItemInt(__pyx_t_3, __pyx_t_15, Py_ssize_t, 1, PyInt_FromSsize_t, 0, 0, 0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Subtract(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_7 = PyFloat_FromDouble(__pyx_v_Dz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
-      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyNumber_Divide(__pyx_t_3, __pyx_t_7); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
-      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_7 = __Pyx_PyNumber_Absolute(__pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_7);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_1 = PyFloat_FromDouble(__pyx_v_self->bz_forder); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_3 = PyNumber_Power(__pyx_t_7, __pyx_t_1, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = PyNumber_Multiply(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_1 = PyNumber_Multiply(__pyx_t_8, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1059, __pyx_L1_error)
+      __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1067, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_14 = ((__pyx_v_self->nz - 1) - __pyx_v_i);
       *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sz.data) + __pyx_t_14)) )) = __pyx_t_4;
 
-      /* "libfds/fields.pyx":1058
+      /* "libfds/fields.pyx":1066
  *             if self.msh.bounds[4].bc == 'A':
  *                 sz[i] = s0 * abs((self.msh.z[i] - self.msh.z[self.bz_n]) / Dz) ** self.bz_forder
  *             if self.msh.bounds[5].bc == 'A':             # <<<<<<<<<<<<<<
  *                 sz[self.nz - 1 - i] = s0 * abs((self.msh.z[self.nz - 1 - i] - self.msh.z[self.nz - 1 - self.bz_n]) / Dz) ** self.bz_forder
  * 
  */
     }
   }
 
-  /* "libfds/fields.pyx":1061
+  /* "libfds/fields.pyx":1069
  *                 sz[self.nz - 1 - i] = s0 * abs((self.msh.z[self.nz - 1 - i] - self.msh.z[self.nz - 1 - self.bz_n]) / Dz) ** self.bz_forder
  * 
  *         for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):
  */
   __pyx_t_10 = __pyx_v_self->nx;
   __pyx_t_11 = __pyx_t_10;
   for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
     __pyx_v_ix = __pyx_t_12;
 
-    /* "libfds/fields.pyx":1062
+    /* "libfds/fields.pyx":1070
  * 
  *         for ix in range(self.nx):
  *             for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                 for iz in range(self.nz):
  *                     self.sigma[ix, iy, iz] = sx[ix] / (1 + sy[iy] + sz[iz]) + \
  */
     __pyx_t_15 = __pyx_v_self->ny;
     __pyx_t_16 = __pyx_t_15;
     for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
       __pyx_v_iy = __pyx_t_17;
 
-      /* "libfds/fields.pyx":1063
+      /* "libfds/fields.pyx":1071
  *         for ix in range(self.nx):
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):             # <<<<<<<<<<<<<<
  *                     self.sigma[ix, iy, iz] = sx[ix] / (1 + sy[iy] + sz[iz]) + \
  *                                              sy[iy] / (1 + sx[ix] + sz[iz]) + \
  */
       __pyx_t_18 = __pyx_v_self->nz;
       __pyx_t_19 = __pyx_t_18;
       for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
         __pyx_v_iz = __pyx_t_20;
 
-        /* "libfds/fields.pyx":1064
+        /* "libfds/fields.pyx":1072
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):
  *                     self.sigma[ix, iy, iz] = sx[ix] / (1 + sy[iy] + sz[iz]) + \             # <<<<<<<<<<<<<<
  *                                              sy[iy] / (1 + sx[ix] + sz[iz]) + \
  *                                              sz[iz] / (1 + sy[iy] + sz[iz])
  */
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_21 = __pyx_v_iy;
         __pyx_t_22 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1065
+        /* "libfds/fields.pyx":1073
  *                 for iz in range(self.nz):
  *                     self.sigma[ix, iy, iz] = sx[ix] / (1 + sy[iy] + sz[iz]) + \
  *                                              sy[iy] / (1 + sx[ix] + sz[iz]) + \             # <<<<<<<<<<<<<<
  *                                              sz[iz] / (1 + sy[iy] + sz[iz])
  * 
  */
         __pyx_t_23 = __pyx_v_iy;
         __pyx_t_24 = __pyx_v_ix;
         __pyx_t_25 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1066
+        /* "libfds/fields.pyx":1074
  *                     self.sigma[ix, iy, iz] = sx[ix] / (1 + sy[iy] + sz[iz]) + \
  *                                              sy[iy] / (1 + sx[ix] + sz[iz]) + \
  *                                              sz[iz] / (1 + sy[iy] + sz[iz])             # <<<<<<<<<<<<<<
  * 
  *         # Set sigma to 0 at obstacle locations
  */
         __pyx_t_26 = __pyx_v_iz;
         __pyx_t_27 = __pyx_v_iy;
         __pyx_t_28 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1064
+        /* "libfds/fields.pyx":1072
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):
  *                     self.sigma[ix, iy, iz] = sx[ix] / (1 + sy[iy] + sz[iz]) + \             # <<<<<<<<<<<<<<
  *                                              sy[iy] / (1 + sx[ix] + sz[iz]) + \
  *                                              sz[iz] / (1 + sy[iy] + sz[iz])
  */
         __pyx_t_29 = __pyx_v_ix;
         __pyx_t_30 = __pyx_v_iy;
         __pyx_t_31 = __pyx_v_iz;
         *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->sigma.data + __pyx_t_29 * __pyx_v_self->sigma.strides[0]) ) + __pyx_t_30 * __pyx_v_self->sigma.strides[1]) )) + __pyx_t_31)) )) = ((((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_14)) ))) / ((1.0 + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_21)) )))) + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sz.data) + __pyx_t_22)) ))))) + ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_23)) ))) / ((1.0 + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sx.data) + __pyx_t_24)) )))) + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sz.data) + __pyx_t_25)) )))))) + ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sz.data) + __pyx_t_26)) ))) / ((1.0 + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sy.data) + __pyx_t_27)) )))) + (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_sz.data) + __pyx_t_28)) ))))));
       }
     }
   }
 
-  /* "libfds/fields.pyx":1069
+  /* "libfds/fields.pyx":1077
  * 
  *         # Set sigma to 0 at obstacle locations
  *         for obs in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1069, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_3 = __pyx_t_1; __Pyx_INCREF(__pyx_t_3); __pyx_t_10 = 0;
     __pyx_t_32 = NULL;
   } else {
-    __pyx_t_10 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1069, __pyx_L1_error)
+    __pyx_t_10 = -1; __pyx_t_3 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1077, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_32 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_32)) __PYX_ERR(0, 1069, __pyx_L1_error)
+    __pyx_t_32 = Py_TYPE(__pyx_t_3)->tp_iternext; if (unlikely(!__pyx_t_32)) __PYX_ERR(0, 1077, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_32)) {
       if (likely(PyList_CheckExact(__pyx_t_3))) {
         if (__pyx_t_10 >= PyList_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1069, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1077, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1069, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_10 >= PyTuple_GET_SIZE(__pyx_t_3)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1069, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_3, __pyx_t_10); __Pyx_INCREF(__pyx_t_1); __pyx_t_10++; if (unlikely(0 < 0)) __PYX_ERR(0, 1077, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1069, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_3, __pyx_t_10); __pyx_t_10++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1077, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_32(__pyx_t_3);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1069, __pyx_L1_error)
+          else __PYX_ERR(0, 1077, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_obs, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":1070
+    /* "libfds/fields.pyx":1078
  *         # Set sigma to 0 at obstacle locations
  *         for obs in self.msh.obstacles:
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  *                     for iz in range(obs.cn[2][0], obs.cn[2][1] + 1):
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_33 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_33 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_33 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_33 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-    __pyx_t_34 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_34 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1070, __pyx_L1_error)
+    __pyx_t_34 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_34 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1078, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __pyx_t_35 = __pyx_t_33;
     for (__pyx_t_11 = __pyx_t_34; __pyx_t_11 < __pyx_t_35; __pyx_t_11+=1) {
       __pyx_v_ix = __pyx_t_11;
 
-      /* "libfds/fields.pyx":1071
+      /* "libfds/fields.pyx":1079
  *         for obs in self.msh.obstacles:
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(obs.cn[2][0], obs.cn[2][1] + 1):
  *                         self.sigma[ix, iy, iz] = 0
  */
-      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyInt_AddObjC(__pyx_t_8, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_36 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_36 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_36 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_36 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
-      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-      __pyx_t_37 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_37 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1071, __pyx_L1_error)
+      __pyx_t_37 = __Pyx_PyInt_As_long(__pyx_t_1); if (unlikely((__pyx_t_37 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1079, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_t_38 = __pyx_t_36;
       for (__pyx_t_12 = __pyx_t_37; __pyx_t_12 < __pyx_t_38; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/fields.pyx":1072
+        /* "libfds/fields.pyx":1080
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  *                     for iz in range(obs.cn[2][0], obs.cn[2][1] + 1):             # <<<<<<<<<<<<<<
  *                         self.sigma[ix, iy, iz] = 0
  * 
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
-        __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyInt_AddObjC(__pyx_t_1, __pyx_int_1, 1, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_39 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_39 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_39 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_39 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_PyObject_GetAttrStr(__pyx_v_obs, __pyx_n_s_cn); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
-        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_GetItemInt(__pyx_t_8, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-        __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_8 = __Pyx_GetItemInt(__pyx_t_1, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_8);
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-        __pyx_t_40 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_40 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1072, __pyx_L1_error)
+        __pyx_t_40 = __Pyx_PyInt_As_long(__pyx_t_8); if (unlikely((__pyx_t_40 == (long)-1) && PyErr_Occurred())) __PYX_ERR(0, 1080, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
         __pyx_t_41 = __pyx_t_39;
         for (__pyx_t_15 = __pyx_t_40; __pyx_t_15 < __pyx_t_41; __pyx_t_15+=1) {
           __pyx_v_iz = __pyx_t_15;
 
-          /* "libfds/fields.pyx":1073
+          /* "libfds/fields.pyx":1081
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  *                     for iz in range(obs.cn[2][0], obs.cn[2][1] + 1):
  *                         self.sigma[ix, iy, iz] = 0             # <<<<<<<<<<<<<<
  * 
  *     cpdef tuple get_velocity(self):
  */
           __pyx_t_28 = __pyx_v_ix;
           __pyx_t_27 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->sigma.data + __pyx_t_28 * __pyx_v_self->sigma.strides[0]) ) + __pyx_t_27 * __pyx_v_self->sigma.strides[1]) )) + __pyx_t_26)) )) = 0.0;
         }
       }
     }
 
-    /* "libfds/fields.pyx":1069
+    /* "libfds/fields.pyx":1077
  * 
  *         # Set sigma to 0 at obstacle locations
  *         for obs in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in range(obs.cn[0][0], obs.cn[0][1] + 1):
  *                 for iy in range(obs.cn[1][0], obs.cn[1][1] + 1):
  */
   }
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-  /* "libfds/fields.pyx":1032
+  /* "libfds/fields.pyx":1040
  *         self.S23 = _np.zeros_like(self.Tk)
  * 
  *     cdef void init_buffer(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double s0 = 1.
  */
 
@@ -27804,15 +27873,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_sx, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_sy, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_sz, 1);
   __Pyx_XDECREF(__pyx_v_obs);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1075
+/* "libfds/fields.pyx":1083
  *                         self.sigma[ix, iy, iz] = 0
  * 
  *     cpdef tuple get_velocity(self):             # <<<<<<<<<<<<<<
  *         """ Return (vx, vz) """
  *         self.update('V')
  */
 
@@ -27825,53 +27894,53 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_velocity", 0);
 
-  /* "libfds/fields.pyx":1077
+  /* "libfds/fields.pyx":1085
  *     cpdef tuple get_velocity(self):
  *         """ Return (vx, vz) """
  *         self.update('V')             # <<<<<<<<<<<<<<
  *         return self.Eu, self.Ev, self.Ew
  * 
  */
   __pyx_f_6libfds_6fields_8Fields3d_update(__pyx_v_self, __pyx_n_u_V);
 
-  /* "libfds/fields.pyx":1078
+  /* "libfds/fields.pyx":1086
  *         """ Return (vx, vz) """
  *         self.update('V')
  *         return self.Eu, self.Ev, self.Ew             # <<<<<<<<<<<<<<
  * 
  *     cpdef double[:, :, ::1] monopole_distribution(self, (Py_ssize_t, Py_ssize_t, Py_ssize_t) origin, double B0):
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->Eu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->Eu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->Ew, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->Ew, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1078, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1086, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
   __pyx_r = ((PyObject*)__pyx_t_4);
   __pyx_t_4 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":1075
+  /* "libfds/fields.pyx":1083
  *                         self.sigma[ix, iy, iz] = 0
  * 
  *     cpdef tuple get_velocity(self):             # <<<<<<<<<<<<<<
  *         """ Return (vx, vz) """
  *         self.update('V')
  */
 
@@ -27908,15 +27977,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("get_velocity", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields3d_get_velocity(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1075, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields3d_get_velocity(__pyx_v_self, 1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1083, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -27925,15 +27994,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":1080
+/* "libfds/fields.pyx":1088
  *         return self.Eu, self.Ev, self.Ew
  * 
  *     cpdef double[:, :, ::1] monopole_distribution(self, (Py_ssize_t, Py_ssize_t, Py_ssize_t) origin, double B0):             # <<<<<<<<<<<<<<
  *         """ Monopole distribution
  * 
  */
 
@@ -27985,136 +28054,136 @@
   Py_ssize_t __pyx_t_30;
   Py_ssize_t __pyx_t_31;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("monopole_distribution", 0);
 
-  /* "libfds/fields.pyx":1092
+  /* "libfds/fields.pyx":1100
  * 
  *         cdef Py_ssize_t ix, iy, iz
  *         cdef Py_ssize_t ix0 = origin[0]             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t iy0 = origin[1]
  *         cdef Py_ssize_t iz0 = origin[2]
  */
   __pyx_v_ix0 = __pyx_v_origin.f0;
 
-  /* "libfds/fields.pyx":1093
+  /* "libfds/fields.pyx":1101
  *         cdef Py_ssize_t ix, iy, iz
  *         cdef Py_ssize_t ix0 = origin[0]
  *         cdef Py_ssize_t iy0 = origin[1]             # <<<<<<<<<<<<<<
  *         cdef Py_ssize_t iz0 = origin[2]
  *         cdef double[::1] x = self.msh.x
  */
   __pyx_v_iy0 = __pyx_v_origin.f1;
 
-  /* "libfds/fields.pyx":1094
+  /* "libfds/fields.pyx":1102
  *         cdef Py_ssize_t ix0 = origin[0]
  *         cdef Py_ssize_t iy0 = origin[1]
  *         cdef Py_ssize_t iz0 = origin[2]             # <<<<<<<<<<<<<<
  *         cdef double[::1] x = self.msh.x
  *         cdef double[::1] y = self.msh.y
  */
   __pyx_v_iz0 = __pyx_v_origin.f2;
 
-  /* "libfds/fields.pyx":1095
+  /* "libfds/fields.pyx":1103
  *         cdef Py_ssize_t iy0 = origin[1]
  *         cdef Py_ssize_t iz0 = origin[2]
  *         cdef double[::1] x = self.msh.x             # <<<<<<<<<<<<<<
  *         cdef double[::1] y = self.msh.y
  *         cdef double[::1] z = self.msh.z
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_x); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1103, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1095, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1103, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_x = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "libfds/fields.pyx":1096
+  /* "libfds/fields.pyx":1104
  *         cdef Py_ssize_t iz0 = origin[2]
  *         cdef double[::1] x = self.msh.x
  *         cdef double[::1] y = self.msh.y             # <<<<<<<<<<<<<<
  *         cdef double[::1] z = self.msh.z
  *         cdef double log2 = log(2.)
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1096, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_y); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1104, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1096, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1104, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_y = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "libfds/fields.pyx":1097
+  /* "libfds/fields.pyx":1105
  *         cdef double[::1] x = self.msh.x
  *         cdef double[::1] y = self.msh.y
  *         cdef double[::1] z = self.msh.z             # <<<<<<<<<<<<<<
  *         cdef double log2 = log(2.)
  *         cdef double Bx = (B0 * self.msh.dx) ** 2
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1097, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_z); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1105, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1097, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 1105, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_z = __pyx_t_2;
   __pyx_t_2.memview = NULL;
   __pyx_t_2.data = NULL;
 
-  /* "libfds/fields.pyx":1098
+  /* "libfds/fields.pyx":1106
  *         cdef double[::1] y = self.msh.y
  *         cdef double[::1] z = self.msh.z
  *         cdef double log2 = log(2.)             # <<<<<<<<<<<<<<
  *         cdef double Bx = (B0 * self.msh.dx) ** 2
  *         cdef double[:, :, ::1] m = _np.empty((self.nx, self.ny, self.nz))
  */
   __pyx_v_log2 = log(2.);
 
-  /* "libfds/fields.pyx":1099
+  /* "libfds/fields.pyx":1107
  *         cdef double[::1] z = self.msh.z
  *         cdef double log2 = log(2.)
  *         cdef double Bx = (B0 * self.msh.dx) ** 2             # <<<<<<<<<<<<<<
  *         cdef double[:, :, ::1] m = _np.empty((self.nx, self.ny, self.nz))
  * 
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_B0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_B0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_dx); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_4 = PyNumber_Multiply(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_3 = PyNumber_Power(__pyx_t_4, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Power(__pyx_t_4, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1107, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1099, __pyx_L1_error)
+  __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1107, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_Bx = __pyx_t_5;
 
-  /* "libfds/fields.pyx":1100
+  /* "libfds/fields.pyx":1108
  *         cdef double log2 = log(2.)
  *         cdef double Bx = (B0 * self.msh.dx) ** 2
  *         cdef double[:, :, ::1] m = _np.empty((self.nx, self.ny, self.nz))             # <<<<<<<<<<<<<<
  * 
  *         if self.mesh_type == 'curvilinear':
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_4, __pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_empty); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_self->nx); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_self->ny); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_self->nz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_8 = PyTuple_New(3); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_7);
@@ -28130,400 +28199,400 @@
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_1, function);
     }
   }
   __pyx_t_3 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_t_8) : __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_8);
   __Pyx_XDECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1100, __pyx_L1_error)
+  __pyx_t_9 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_9.memview)) __PYX_ERR(0, 1108, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_m = __pyx_t_9;
   __pyx_t_9.memview = NULL;
   __pyx_t_9.data = NULL;
 
-  /* "libfds/fields.pyx":1102
+  /* "libfds/fields.pyx":1110
  *         cdef double[:, :, ::1] m = _np.empty((self.nx, self.ny, self.nz))
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             for iz in range(self.nz):
  *                 for iy in range(self.ny):
  */
-  __pyx_t_10 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1102, __pyx_L1_error)
+  __pyx_t_10 = (__Pyx_PyUnicode_Equals(__pyx_v_self->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_10 < 0)) __PYX_ERR(0, 1110, __pyx_L1_error)
   __pyx_t_11 = (__pyx_t_10 != 0);
   if (__pyx_t_11) {
 
-    /* "libfds/fields.pyx":1103
+    /* "libfds/fields.pyx":1111
  * 
  *         if self.mesh_type == 'curvilinear':
  *             for iz in range(self.nz):             # <<<<<<<<<<<<<<
  *                 for iy in range(self.ny):
  *                     for ix in range(self.nx):
  */
     __pyx_t_12 = __pyx_v_self->nz;
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_iz = __pyx_t_14;
 
-      /* "libfds/fields.pyx":1104
+      /* "libfds/fields.pyx":1112
  *         if self.mesh_type == 'curvilinear':
  *             for iz in range(self.nz):
  *                 for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +
  */
       __pyx_t_15 = __pyx_v_self->ny;
       __pyx_t_16 = __pyx_t_15;
       for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
         __pyx_v_iy = __pyx_t_17;
 
-        /* "libfds/fields.pyx":1105
+        /* "libfds/fields.pyx":1113
  *             for iz in range(self.nz):
  *                 for iy in range(self.ny):
  *                     for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  */
         __pyx_t_18 = __pyx_v_self->nx;
         __pyx_t_19 = __pyx_t_18;
         for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
           __pyx_v_ix = __pyx_t_20;
 
-          /* "libfds/fields.pyx":1106
+          /* "libfds/fields.pyx":1114
  *                 for iy in range(self.ny):
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  */
-          __pyx_t_3 = PyFloat_FromDouble((-__pyx_v_log2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_3 = PyFloat_FromDouble((-__pyx_v_log2)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iz); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iz); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_8);
           PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_6);
           PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_6);
           __pyx_t_8 = 0;
           __pyx_t_7 = 0;
           __pyx_t_6 = 0;
-          __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_xp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_iz0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_iz0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_21 = PyTuple_New(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_21 = PyTuple_New(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_GIVEREF(__pyx_t_1);
           PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_1);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
           PyTuple_SET_ITEM(__pyx_t_21, 2, __pyx_t_8);
           __pyx_t_1 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_21); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_21); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_21 = PyNumber_Subtract(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_21 = PyNumber_Subtract(__pyx_t_6, __pyx_t_8); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __pyx_t_8 = PyNumber_Power(__pyx_t_21, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_8 = PyNumber_Power(__pyx_t_21, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
 
-          /* "libfds/fields.pyx":1107
+          /* "libfds/fields.pyx":1115
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  *         else:
  */
-          __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_21 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
-          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iz); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_GIVEREF(__pyx_t_6);
           PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_7);
           __pyx_t_6 = 0;
           __pyx_t_4 = 0;
           __pyx_t_7 = 0;
-          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_21, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_7 = __Pyx_PyObject_GetItem(__pyx_t_21, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_yp); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_21 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_21 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
-          __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_4 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iz0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_iz0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_22 = PyTuple_New(3); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_22 = PyTuple_New(3); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
           __Pyx_GIVEREF(__pyx_t_21);
           PyTuple_SET_ITEM(__pyx_t_22, 0, __pyx_t_21);
           __Pyx_GIVEREF(__pyx_t_4);
           PyTuple_SET_ITEM(__pyx_t_22, 1, __pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_6);
           PyTuple_SET_ITEM(__pyx_t_22, 2, __pyx_t_6);
           __pyx_t_21 = 0;
           __pyx_t_4 = 0;
           __pyx_t_6 = 0;
-          __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_22); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetItem(__pyx_t_1, __pyx_t_22); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
-          __pyx_t_22 = PyNumber_Subtract(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_22 = PyNumber_Subtract(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
           __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
-          __pyx_t_6 = PyNumber_Power(__pyx_t_22, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_6 = PyNumber_Power(__pyx_t_22, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
 
-          /* "libfds/fields.pyx":1106
+          /* "libfds/fields.pyx":1114
  *                 for iy in range(self.ny):
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  */
-          __pyx_t_22 = PyNumber_Add(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_22 = PyNumber_Add(__pyx_t_8, __pyx_t_6); if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_22);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
 
-          /* "libfds/fields.pyx":1108
+          /* "libfds/fields.pyx":1116
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(self.nx):
  */
-          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_zp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_zp); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_ix); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_iz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_1 = PyInt_FromSsize_t(__pyx_v_iz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
-          __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
           __Pyx_GIVEREF(__pyx_t_8);
           PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_1);
           PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_1);
           __pyx_t_8 = 0;
           __pyx_t_7 = 0;
           __pyx_t_1 = 0;
-          __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_1 = __Pyx_PyObject_GetItem(__pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
-          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_zp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_zp); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_4);
-          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_6 = PyInt_FromSsize_t(__pyx_v_ix0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_6);
-          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_7 = PyInt_FromSsize_t(__pyx_v_iy0); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_7);
-          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_iz0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_8 = PyInt_FromSsize_t(__pyx_v_iz0); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
-          __pyx_t_21 = PyTuple_New(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_21 = PyTuple_New(3); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_GIVEREF(__pyx_t_6);
           PyTuple_SET_ITEM(__pyx_t_21, 0, __pyx_t_6);
           __Pyx_GIVEREF(__pyx_t_7);
           PyTuple_SET_ITEM(__pyx_t_21, 1, __pyx_t_7);
           __Pyx_GIVEREF(__pyx_t_8);
           PyTuple_SET_ITEM(__pyx_t_21, 2, __pyx_t_8);
           __pyx_t_6 = 0;
           __pyx_t_7 = 0;
           __pyx_t_8 = 0;
-          __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_21); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_8 = __Pyx_PyObject_GetItem(__pyx_t_4, __pyx_t_21); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_21 = PyNumber_Subtract(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_21 = PyNumber_Subtract(__pyx_t_1, __pyx_t_8); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
-          __pyx_t_8 = PyNumber_Power(__pyx_t_21, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_8 = PyNumber_Power(__pyx_t_21, __pyx_int_2, Py_None); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
 
-          /* "libfds/fields.pyx":1107
+          /* "libfds/fields.pyx":1115
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  *         else:
  */
-          __pyx_t_21 = PyNumber_Add(__pyx_t_22, __pyx_t_8); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1107, __pyx_L1_error)
+          __pyx_t_21 = PyNumber_Add(__pyx_t_22, __pyx_t_8); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1115, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
           __Pyx_DECREF(__pyx_t_22); __pyx_t_22 = 0;
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
 
-          /* "libfds/fields.pyx":1106
+          /* "libfds/fields.pyx":1114
  *                 for iy in range(self.ny):
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  */
-          __pyx_t_8 = PyNumber_Multiply(__pyx_t_3, __pyx_t_21); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1106, __pyx_L1_error)
+          __pyx_t_8 = PyNumber_Multiply(__pyx_t_3, __pyx_t_21); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1114, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_8);
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
 
-          /* "libfds/fields.pyx":1108
+          /* "libfds/fields.pyx":1116
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(self.nx):
  */
-          __pyx_t_21 = PyFloat_FromDouble(__pyx_v_Bx); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_21 = PyFloat_FromDouble(__pyx_v_Bx); if (unlikely(!__pyx_t_21)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_21);
-          __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_8, __pyx_t_21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_3 = __Pyx_PyNumber_Divide(__pyx_t_8, __pyx_t_21); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_3);
           __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
           __Pyx_DECREF(__pyx_t_21); __pyx_t_21 = 0;
-          __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1108, __pyx_L1_error)
+          __pyx_t_5 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_5 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1116, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-          /* "libfds/fields.pyx":1106
+          /* "libfds/fields.pyx":1114
  *                 for iy in range(self.ny):
  *                     for ix in range(self.nx):
  *                         m[ix, iy, iz] = exp(-log2 * ((self.msh.xp[ix, iy, iz] - self.msh.xp[ix0, iy0, iz0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (self.msh.yp[ix, iy, iz] - self.msh.yp[ix0, iy0, iz0])**2 +
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  */
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_24 = __pyx_v_iy;
           __pyx_t_25 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_m.data + __pyx_t_23 * __pyx_v_m.strides[0]) ) + __pyx_t_24 * __pyx_v_m.strides[1]) )) + __pyx_t_25)) )) = exp(__pyx_t_5);
         }
       }
     }
 
-    /* "libfds/fields.pyx":1102
+    /* "libfds/fields.pyx":1110
  *         cdef double[:, :, ::1] m = _np.empty((self.nx, self.ny, self.nz))
  * 
  *         if self.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             for iz in range(self.nz):
  *                 for iy in range(self.ny):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1110
+  /* "libfds/fields.pyx":1118
  *                                                      (self.msh.zp[ix, iy, iz] - self.msh.zp[ix0, iy0, iz0])**2) / Bx)
  *         else:
  *             for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *                 for iy in range(self.ny):
  *                     for iz in range(self.nz):
  */
   /*else*/ {
     __pyx_t_12 = __pyx_v_self->nx;
     __pyx_t_13 = __pyx_t_12;
     for (__pyx_t_14 = 0; __pyx_t_14 < __pyx_t_13; __pyx_t_14+=1) {
       __pyx_v_ix = __pyx_t_14;
 
-      /* "libfds/fields.pyx":1111
+      /* "libfds/fields.pyx":1119
  *         else:
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                     for iz in range(self.nz):
  *                         m[ix, iy, iz] = exp(-log2 * ((x[ix] - x[ix0])**2 +
  */
       __pyx_t_15 = __pyx_v_self->ny;
       __pyx_t_16 = __pyx_t_15;
       for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_16; __pyx_t_17+=1) {
         __pyx_v_iy = __pyx_t_17;
 
-        /* "libfds/fields.pyx":1112
+        /* "libfds/fields.pyx":1120
  *             for ix in range(self.nx):
  *                 for iy in range(self.ny):
  *                     for iz in range(self.nz):             # <<<<<<<<<<<<<<
  *                         m[ix, iy, iz] = exp(-log2 * ((x[ix] - x[ix0])**2 +
  *                                                      (y[iy] - y[iy0])**2 +
  */
         __pyx_t_18 = __pyx_v_self->nz;
         __pyx_t_19 = __pyx_t_18;
         for (__pyx_t_20 = 0; __pyx_t_20 < __pyx_t_19; __pyx_t_20+=1) {
           __pyx_v_iz = __pyx_t_20;
 
-          /* "libfds/fields.pyx":1113
+          /* "libfds/fields.pyx":1121
  *                 for iy in range(self.ny):
  *                     for iz in range(self.nz):
  *                         m[ix, iy, iz] = exp(-log2 * ((x[ix] - x[ix0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (y[iy] - y[iy0])**2 +
  *                                                      (z[iz] - z[iz0])**2)/ Bx)
  */
           __pyx_t_25 = __pyx_v_ix;
           __pyx_t_24 = __pyx_v_ix0;
 
-          /* "libfds/fields.pyx":1114
+          /* "libfds/fields.pyx":1122
  *                     for iz in range(self.nz):
  *                         m[ix, iy, iz] = exp(-log2 * ((x[ix] - x[ix0])**2 +
  *                                                      (y[iy] - y[iy0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (z[iz] - z[iz0])**2)/ Bx)
  * 
  */
           __pyx_t_23 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iy0;
 
-          /* "libfds/fields.pyx":1115
+          /* "libfds/fields.pyx":1123
  *                         m[ix, iy, iz] = exp(-log2 * ((x[ix] - x[ix0])**2 +
  *                                                      (y[iy] - y[iy0])**2 +
  *                                                      (z[iz] - z[iz0])**2)/ Bx)             # <<<<<<<<<<<<<<
  * 
  *         return m
  */
           __pyx_t_27 = __pyx_v_iz;
           __pyx_t_28 = __pyx_v_iz0;
 
-          /* "libfds/fields.pyx":1113
+          /* "libfds/fields.pyx":1121
  *                 for iy in range(self.ny):
  *                     for iz in range(self.nz):
  *                         m[ix, iy, iz] = exp(-log2 * ((x[ix] - x[ix0])**2 +             # <<<<<<<<<<<<<<
  *                                                      (y[iy] - y[iy0])**2 +
  *                                                      (z[iz] - z[iz0])**2)/ Bx)
  */
           __pyx_t_29 = __pyx_v_ix;
@@ -28532,26 +28601,26 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_m.data + __pyx_t_29 * __pyx_v_m.strides[0]) ) + __pyx_t_30 * __pyx_v_m.strides[1]) )) + __pyx_t_31)) )) = exp((((-__pyx_v_log2) * ((pow(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_25)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x.data) + __pyx_t_24)) )))), 2.0) + pow(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_23)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y.data) + __pyx_t_26)) )))), 2.0)) + pow(((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_27)) ))) - (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_z.data) + __pyx_t_28)) )))), 2.0))) / __pyx_v_Bx));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1117
+  /* "libfds/fields.pyx":1125
  *                                                      (z[iz] - z[iz0])**2)/ Bx)
  * 
  *         return m             # <<<<<<<<<<<<<<
  * 
  *     cdef void pulse(self, (Py_ssize_t, Py_ssize_t, Py_ssize_t) origin, double S0, int B0):
  */
   __PYX_INC_MEMVIEW(&__pyx_v_m, 0);
   __pyx_r = __pyx_v_m;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":1080
+  /* "libfds/fields.pyx":1088
  *         return self.Eu, self.Ev, self.Ew
  * 
  *     cpdef double[:, :, ::1] monopole_distribution(self, (Py_ssize_t, Py_ssize_t, Py_ssize_t) origin, double B0):             # <<<<<<<<<<<<<<
  *         """ Monopole distribution
  * 
  */
 
@@ -28615,32 +28684,32 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_origin)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_B0)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, 1); __PYX_ERR(0, 1080, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, 1); __PYX_ERR(0, 1088, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "monopole_distribution") < 0)) __PYX_ERR(0, 1080, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "monopole_distribution") < 0)) __PYX_ERR(0, 1088, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 2) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
     }
-    __pyx_v_origin = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t__and_Py_ssize_t(values[0]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1080, __pyx_L3_error)
-    __pyx_v_B0 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_B0 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1080, __pyx_L3_error)
+    __pyx_v_origin = __pyx_convert__from_py___pyx_ctuple_Py_ssize_t__and_Py_ssize_t__and_Py_ssize_t(values[0]); if (unlikely(PyErr_Occurred())) __PYX_ERR(0, 1088, __pyx_L3_error)
+    __pyx_v_B0 = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_B0 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1088, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1080, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("monopole_distribution", 1, 2, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1088, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.Fields3d.monopole_distribution", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_8Fields3d_4monopole_distribution(((struct __pyx_obj_6libfds_6fields_Fields3d *)__pyx_v_self), __pyx_v_origin, __pyx_v_B0);
 
@@ -28655,16 +28724,16 @@
   __Pyx_memviewslice __pyx_t_1 = { 0, 0, { 0 }, { 0 }, { 0 } };
   PyObject *__pyx_t_2 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("monopole_distribution", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields3d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 1); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1080, __pyx_L1_error)
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1080, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields3d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 1); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1088, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1088, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
@@ -28677,15 +28746,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":1119
+/* "libfds/fields.pyx":1127
  *         return m
  * 
  *     cdef void pulse(self, (Py_ssize_t, Py_ssize_t, Py_ssize_t) origin, double S0, int B0):             # <<<<<<<<<<<<<<
  *         """ Pulse source. """
  * 
  */
 
@@ -28712,93 +28781,93 @@
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("pulse", 0);
 
-  /* "libfds/fields.pyx":1123
+  /* "libfds/fields.pyx":1131
  * 
  *         cdef Py_ssize_t ix, iy, iz
  *         cdef double[:, :, ::1] profile = self.monopole_distribution(origin, B0)             # <<<<<<<<<<<<<<
  * 
  *         for ix in range(self.nx):
  */
-  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields3d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 0); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1123, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fields_8Fields3d_monopole_distribution(__pyx_v_self, __pyx_v_origin, __pyx_v_B0, 0); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 1131, __pyx_L1_error)
   __pyx_v_profile = __pyx_t_1;
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
 
-  /* "libfds/fields.pyx":1125
+  /* "libfds/fields.pyx":1133
  *         cdef double[:, :, ::1] profile = self.monopole_distribution(origin, B0)
  * 
  *         for ix in range(self.nx):             # <<<<<<<<<<<<<<
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):
  */
   __pyx_t_2 = __pyx_v_self->nx;
   __pyx_t_3 = __pyx_t_2;
   for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
     __pyx_v_ix = __pyx_t_4;
 
-    /* "libfds/fields.pyx":1126
+    /* "libfds/fields.pyx":1134
  * 
  *         for ix in range(self.nx):
  *             for iy in range(self.ny):             # <<<<<<<<<<<<<<
  *                 for iz in range(self.nz):
  *                     self.p[ix, iy, iz] += S0 * profile[ix, iy, iz]
  */
     __pyx_t_5 = __pyx_v_self->ny;
     __pyx_t_6 = __pyx_t_5;
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
       __pyx_v_iy = __pyx_t_7;
 
-      /* "libfds/fields.pyx":1127
+      /* "libfds/fields.pyx":1135
  *         for ix in range(self.nx):
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):             # <<<<<<<<<<<<<<
  *                     self.p[ix, iy, iz] += S0 * profile[ix, iy, iz]
  *                     self.r[ix, iy, iz] += (self.p[ix, iy, iz] - self.p0) / (self.c0 * self.c0)
  */
       __pyx_t_8 = __pyx_v_self->nz;
       __pyx_t_9 = __pyx_t_8;
       for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
         __pyx_v_iz = __pyx_t_10;
 
-        /* "libfds/fields.pyx":1128
+        /* "libfds/fields.pyx":1136
  *             for iy in range(self.ny):
  *                 for iz in range(self.nz):
  *                     self.p[ix, iy, iz] += S0 * profile[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                     self.r[ix, iy, iz] += (self.p[ix, iy, iz] - self.p0) / (self.c0 * self.c0)
  *                     self.re[ix, iy, iz] = self.p[ix, iy, iz] / self.gaminusone
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_iz;
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
         __pyx_t_16 = __pyx_v_iz;
         *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_14 * __pyx_v_self->p.strides[0]) ) + __pyx_t_15 * __pyx_v_self->p.strides[1]) )) + __pyx_t_16)) )) += (__pyx_v_S0 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_profile.data + __pyx_t_11 * __pyx_v_profile.strides[0]) ) + __pyx_t_12 * __pyx_v_profile.strides[1]) )) + __pyx_t_13)) ))));
 
-        /* "libfds/fields.pyx":1129
+        /* "libfds/fields.pyx":1137
  *                 for iz in range(self.nz):
  *                     self.p[ix, iy, iz] += S0 * profile[ix, iy, iz]
  *                     self.r[ix, iy, iz] += (self.p[ix, iy, iz] - self.p0) / (self.c0 * self.c0)             # <<<<<<<<<<<<<<
  *                     self.re[ix, iy, iz] = self.p[ix, iy, iz] / self.gaminusone
  * 
  */
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_iz;
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
         __pyx_t_14 = __pyx_v_iz;
         *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_16 * __pyx_v_self->r.strides[0]) ) + __pyx_t_15 * __pyx_v_self->r.strides[1]) )) + __pyx_t_14)) )) += (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_13 * __pyx_v_self->p.strides[0]) ) + __pyx_t_12 * __pyx_v_self->p.strides[1]) )) + __pyx_t_11)) ))) - __pyx_v_self->p0) / (__pyx_v_self->c0 * __pyx_v_self->c0));
 
-        /* "libfds/fields.pyx":1130
+        /* "libfds/fields.pyx":1138
  *                     self.p[ix, iy, iz] += S0 * profile[ix, iy, iz]
  *                     self.r[ix, iy, iz] += (self.p[ix, iy, iz] - self.p0) / (self.c0 * self.c0)
  *                     self.re[ix, iy, iz] = self.p[ix, iy, iz] / self.gaminusone             # <<<<<<<<<<<<<<
  * 
  *     cdef void zero_obstacles(self):
  */
         __pyx_t_11 = __pyx_v_ix;
@@ -28808,15 +28877,15 @@
         __pyx_t_15 = __pyx_v_iy;
         __pyx_t_16 = __pyx_v_iz;
         *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_14 * __pyx_v_self->re.strides[0]) ) + __pyx_t_15 * __pyx_v_self->re.strides[1]) )) + __pyx_t_16)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_11 * __pyx_v_self->p.strides[0]) ) + __pyx_t_12 * __pyx_v_self->p.strides[1]) )) + __pyx_t_13)) ))) / __pyx_v_self->gaminusone);
       }
     }
   }
 
-  /* "libfds/fields.pyx":1119
+  /* "libfds/fields.pyx":1127
  *         return m
  * 
  *     cdef void pulse(self, (Py_ssize_t, Py_ssize_t, Py_ssize_t) origin, double S0, int B0):             # <<<<<<<<<<<<<<
  *         """ Pulse source. """
  * 
  */
 
@@ -28826,15 +28895,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.pulse", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_profile, 1);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1132
+/* "libfds/fields.pyx":1140
  *                     self.re[ix, iy, iz] = self.p[ix, iy, iz] / self.gaminusone
  * 
  *     cdef void zero_obstacles(self):             # <<<<<<<<<<<<<<
  *         """ Set velocity to 0 in obstacles. """
  * 
  */
 
@@ -28862,302 +28931,302 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("zero_obstacles", 0);
 
-  /* "libfds/fields.pyx":1137
+  /* "libfds/fields.pyx":1145
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         for sub in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->msh, __pyx_n_s_obstacles); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
     __pyx_t_2 = __pyx_t_1; __Pyx_INCREF(__pyx_t_2); __pyx_t_3 = 0;
     __pyx_t_4 = NULL;
   } else {
-    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_3 = -1; __pyx_t_2 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1145, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1137, __pyx_L1_error)
+    __pyx_t_4 = Py_TYPE(__pyx_t_2)->tp_iternext; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1145, __pyx_L1_error)
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   for (;;) {
     if (likely(!__pyx_t_4)) {
       if (likely(PyList_CheckExact(__pyx_t_2))) {
         if (__pyx_t_3 >= PyList_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1137, __pyx_L1_error)
+        __pyx_t_1 = PyList_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1145, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       } else {
         if (__pyx_t_3 >= PyTuple_GET_SIZE(__pyx_t_2)) break;
         #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1137, __pyx_L1_error)
+        __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_2, __pyx_t_3); __Pyx_INCREF(__pyx_t_1); __pyx_t_3++; if (unlikely(0 < 0)) __PYX_ERR(0, 1145, __pyx_L1_error)
         #else
-        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1137, __pyx_L1_error)
+        __pyx_t_1 = PySequence_ITEM(__pyx_t_2, __pyx_t_3); __pyx_t_3++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1145, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         #endif
       }
     } else {
       __pyx_t_1 = __pyx_t_4(__pyx_t_2);
       if (unlikely(!__pyx_t_1)) {
         PyObject* exc_type = PyErr_Occurred();
         if (exc_type) {
           if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-          else __PYX_ERR(0, 1137, __pyx_L1_error)
+          else __PYX_ERR(0, 1145, __pyx_L1_error)
         }
         break;
       }
       __Pyx_GOTREF(__pyx_t_1);
     }
     __Pyx_XDECREF_SET(__pyx_v_sub, __pyx_t_1);
     __pyx_t_1 = 0;
 
-    /* "libfds/fields.pyx":1138
+    /* "libfds/fields.pyx":1146
  * 
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:             # <<<<<<<<<<<<<<
  *                 for iy in sub.ry:
  *                     for iz in sub.rz:
  */
-    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_rx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1138, __pyx_L1_error)
+    __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_rx); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
     if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
       __pyx_t_5 = __pyx_t_1; __Pyx_INCREF(__pyx_t_5); __pyx_t_6 = 0;
       __pyx_t_7 = NULL;
     } else {
-      __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1138, __pyx_L1_error)
+      __pyx_t_6 = -1; __pyx_t_5 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1146, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
-      __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1138, __pyx_L1_error)
+      __pyx_t_7 = Py_TYPE(__pyx_t_5)->tp_iternext; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1146, __pyx_L1_error)
     }
     __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     for (;;) {
       if (likely(!__pyx_t_7)) {
         if (likely(PyList_CheckExact(__pyx_t_5))) {
           if (__pyx_t_6 >= PyList_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1138, __pyx_L1_error)
+          __pyx_t_1 = PyList_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1146, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1138, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         } else {
           if (__pyx_t_6 >= PyTuple_GET_SIZE(__pyx_t_5)) break;
           #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1138, __pyx_L1_error)
+          __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_5, __pyx_t_6); __Pyx_INCREF(__pyx_t_1); __pyx_t_6++; if (unlikely(0 < 0)) __PYX_ERR(0, 1146, __pyx_L1_error)
           #else
-          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1138, __pyx_L1_error)
+          __pyx_t_1 = PySequence_ITEM(__pyx_t_5, __pyx_t_6); __pyx_t_6++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1146, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_1);
           #endif
         }
       } else {
         __pyx_t_1 = __pyx_t_7(__pyx_t_5);
         if (unlikely(!__pyx_t_1)) {
           PyObject* exc_type = PyErr_Occurred();
           if (exc_type) {
             if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-            else __PYX_ERR(0, 1138, __pyx_L1_error)
+            else __PYX_ERR(0, 1146, __pyx_L1_error)
           }
           break;
         }
         __Pyx_GOTREF(__pyx_t_1);
       }
-      __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1138, __pyx_L1_error)
+      __pyx_t_8 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_8 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1146, __pyx_L1_error)
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __pyx_v_ix = __pyx_t_8;
 
-      /* "libfds/fields.pyx":1139
+      /* "libfds/fields.pyx":1147
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:
  *                 for iy in sub.ry:             # <<<<<<<<<<<<<<
  *                     for iz in sub.rz:
  *                         self.ru[ix, iy, iz] = 0
  */
-      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_ry); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
+      __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_ry); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
         __pyx_t_9 = __pyx_t_1; __Pyx_INCREF(__pyx_t_9); __pyx_t_8 = 0;
         __pyx_t_10 = NULL;
       } else {
-        __pyx_t_8 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1139, __pyx_L1_error)
+        __pyx_t_8 = -1; __pyx_t_9 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 1147, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_9);
-        __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1139, __pyx_L1_error)
+        __pyx_t_10 = Py_TYPE(__pyx_t_9)->tp_iternext; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1147, __pyx_L1_error)
       }
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       for (;;) {
         if (likely(!__pyx_t_10)) {
           if (likely(PyList_CheckExact(__pyx_t_9))) {
             if (__pyx_t_8 >= PyList_GET_SIZE(__pyx_t_9)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1139, __pyx_L1_error)
+            __pyx_t_1 = PyList_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1147, __pyx_L1_error)
             #else
-            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
+            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             #endif
           } else {
             if (__pyx_t_8 >= PyTuple_GET_SIZE(__pyx_t_9)) break;
             #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1139, __pyx_L1_error)
+            __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_9, __pyx_t_8); __Pyx_INCREF(__pyx_t_1); __pyx_t_8++; if (unlikely(0 < 0)) __PYX_ERR(0, 1147, __pyx_L1_error)
             #else
-            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1139, __pyx_L1_error)
+            __pyx_t_1 = PySequence_ITEM(__pyx_t_9, __pyx_t_8); __pyx_t_8++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1147, __pyx_L1_error)
             __Pyx_GOTREF(__pyx_t_1);
             #endif
           }
         } else {
           __pyx_t_1 = __pyx_t_10(__pyx_t_9);
           if (unlikely(!__pyx_t_1)) {
             PyObject* exc_type = PyErr_Occurred();
             if (exc_type) {
               if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-              else __PYX_ERR(0, 1139, __pyx_L1_error)
+              else __PYX_ERR(0, 1147, __pyx_L1_error)
             }
             break;
           }
           __Pyx_GOTREF(__pyx_t_1);
         }
-        __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1139, __pyx_L1_error)
+        __pyx_t_11 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_11 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1147, __pyx_L1_error)
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         __pyx_v_iy = __pyx_t_11;
 
-        /* "libfds/fields.pyx":1140
+        /* "libfds/fields.pyx":1148
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  *                     for iz in sub.rz:             # <<<<<<<<<<<<<<
  *                         self.ru[ix, iy, iz] = 0
  *                         self.rv[ix, iy, iz] = 0
  */
-        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_rz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1140, __pyx_L1_error)
+        __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_sub, __pyx_n_s_rz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1148, __pyx_L1_error)
         __Pyx_GOTREF(__pyx_t_1);
         if (likely(PyList_CheckExact(__pyx_t_1)) || PyTuple_CheckExact(__pyx_t_1)) {
           __pyx_t_12 = __pyx_t_1; __Pyx_INCREF(__pyx_t_12); __pyx_t_11 = 0;
           __pyx_t_13 = NULL;
         } else {
-          __pyx_t_11 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1140, __pyx_L1_error)
+          __pyx_t_11 = -1; __pyx_t_12 = PyObject_GetIter(__pyx_t_1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 1148, __pyx_L1_error)
           __Pyx_GOTREF(__pyx_t_12);
-          __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1140, __pyx_L1_error)
+          __pyx_t_13 = Py_TYPE(__pyx_t_12)->tp_iternext; if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 1148, __pyx_L1_error)
         }
         __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
         for (;;) {
           if (likely(!__pyx_t_13)) {
             if (likely(PyList_CheckExact(__pyx_t_12))) {
               if (__pyx_t_11 >= PyList_GET_SIZE(__pyx_t_12)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_1 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_11); __Pyx_INCREF(__pyx_t_1); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 1140, __pyx_L1_error)
+              __pyx_t_1 = PyList_GET_ITEM(__pyx_t_12, __pyx_t_11); __Pyx_INCREF(__pyx_t_1); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 1148, __pyx_L1_error)
               #else
-              __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1140, __pyx_L1_error)
+              __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1148, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
               #endif
             } else {
               if (__pyx_t_11 >= PyTuple_GET_SIZE(__pyx_t_12)) break;
               #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-              __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_11); __Pyx_INCREF(__pyx_t_1); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 1140, __pyx_L1_error)
+              __pyx_t_1 = PyTuple_GET_ITEM(__pyx_t_12, __pyx_t_11); __Pyx_INCREF(__pyx_t_1); __pyx_t_11++; if (unlikely(0 < 0)) __PYX_ERR(0, 1148, __pyx_L1_error)
               #else
-              __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1140, __pyx_L1_error)
+              __pyx_t_1 = PySequence_ITEM(__pyx_t_12, __pyx_t_11); __pyx_t_11++; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1148, __pyx_L1_error)
               __Pyx_GOTREF(__pyx_t_1);
               #endif
             }
           } else {
             __pyx_t_1 = __pyx_t_13(__pyx_t_12);
             if (unlikely(!__pyx_t_1)) {
               PyObject* exc_type = PyErr_Occurred();
               if (exc_type) {
                 if (likely(__Pyx_PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration))) PyErr_Clear();
-                else __PYX_ERR(0, 1140, __pyx_L1_error)
+                else __PYX_ERR(0, 1148, __pyx_L1_error)
               }
               break;
             }
             __Pyx_GOTREF(__pyx_t_1);
           }
-          __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1140, __pyx_L1_error)
+          __pyx_t_14 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_14 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1148, __pyx_L1_error)
           __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
           __pyx_v_iz = __pyx_t_14;
 
-          /* "libfds/fields.pyx":1141
+          /* "libfds/fields.pyx":1149
  *                 for iy in sub.ry:
  *                     for iz in sub.rz:
  *                         self.ru[ix, iy, iz] = 0             # <<<<<<<<<<<<<<
  *                         self.rv[ix, iy, iz] = 0
  *                         self.rw[ix, iy, iz] = 0
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_15 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_17)) )) = 0.0;
 
-          /* "libfds/fields.pyx":1142
+          /* "libfds/fields.pyx":1150
  *                     for iz in sub.rz:
  *                         self.ru[ix, iy, iz] = 0
  *                         self.rv[ix, iy, iz] = 0             # <<<<<<<<<<<<<<
  *                         self.rw[ix, iy, iz] = 0
  * 
  */
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_17 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_15)) )) = 0.0;
 
-          /* "libfds/fields.pyx":1143
+          /* "libfds/fields.pyx":1151
  *                         self.ru[ix, iy, iz] = 0
  *                         self.rv[ix, iy, iz] = 0
  *                         self.rw[ix, iy, iz] = 0             # <<<<<<<<<<<<<<
  * 
  *     cdef void update_sources(self):
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_15 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_17)) )) = 0.0;
 
-          /* "libfds/fields.pyx":1140
+          /* "libfds/fields.pyx":1148
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  *                     for iz in sub.rz:             # <<<<<<<<<<<<<<
  *                         self.ru[ix, iy, iz] = 0
  *                         self.rv[ix, iy, iz] = 0
  */
         }
         __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
 
-        /* "libfds/fields.pyx":1139
+        /* "libfds/fields.pyx":1147
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:
  *                 for iy in sub.ry:             # <<<<<<<<<<<<<<
  *                     for iz in sub.rz:
  *                         self.ru[ix, iy, iz] = 0
  */
       }
       __Pyx_DECREF(__pyx_t_9); __pyx_t_9 = 0;
 
-      /* "libfds/fields.pyx":1138
+      /* "libfds/fields.pyx":1146
  * 
  *         for sub in self.msh.obstacles:
  *             for ix in sub.rx:             # <<<<<<<<<<<<<<
  *                 for iy in sub.ry:
  *                     for iz in sub.rz:
  */
     }
     __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
 
-    /* "libfds/fields.pyx":1137
+    /* "libfds/fields.pyx":1145
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         for sub in self.msh.obstacles:             # <<<<<<<<<<<<<<
  *             for ix in sub.rx:
  *                 for iy in sub.ry:
  */
   }
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
 
-  /* "libfds/fields.pyx":1132
+  /* "libfds/fields.pyx":1140
  *                     self.re[ix, iy, iz] = self.p[ix, iy, iz] / self.gaminusone
  * 
  *     cdef void zero_obstacles(self):             # <<<<<<<<<<<<<<
  *         """ Set velocity to 0 in obstacles. """
  * 
  */
 
@@ -29171,15 +29240,15 @@
   __Pyx_XDECREF(__pyx_t_12);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.zero_obstacles", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF(__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1145
+/* "libfds/fields.pyx":1153
  *                         self.rw[ix, iy, iz] = 0
  * 
  *     cdef void update_sources(self):             # <<<<<<<<<<<<<<
  *         """ Update sources. """
  * 
  */
 
@@ -29215,102 +29284,102 @@
   Py_ssize_t __pyx_t_22;
   Py_ssize_t __pyx_t_23;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_sources", 0);
 
-  /* "libfds/fields.pyx":1151
+  /* "libfds/fields.pyx":1159
  *         cdef Monopole3d s
  *         cdef Py_ssize_t ix, iy, iz
  *         cdef Py_ssize_t it = self.cfg.it             # <<<<<<<<<<<<<<
  * 
  *         for s in self.src:
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1159, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1151, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyIndex_AsSsize_t(__pyx_t_1); if (unlikely((__pyx_t_2 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 1159, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_it = __pyx_t_2;
 
-  /* "libfds/fields.pyx":1153
+  /* "libfds/fields.pyx":1161
  *         cdef Py_ssize_t it = self.cfg.it
  * 
  *         for s in self.src:             # <<<<<<<<<<<<<<
  *             for sub in self.cdomains:
  *                 if sub.mp:
  */
   if (unlikely(__pyx_v_self->src == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 1153, __pyx_L1_error)
+    __PYX_ERR(0, 1161, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->src; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1153, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1161, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1153, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1161, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Monopole3d))))) __PYX_ERR(0, 1153, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Monopole3d))))) __PYX_ERR(0, 1161, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_s, ((struct __pyx_obj_6libfds_6fields_Monopole3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":1154
+    /* "libfds/fields.pyx":1162
  * 
  *         for s in self.src:
  *             for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  */
     if (unlikely(__pyx_v_self->cdomains == Py_None)) {
       PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-      __PYX_ERR(0, 1154, __pyx_L1_error)
+      __PYX_ERR(0, 1162, __pyx_L1_error)
     }
     __pyx_t_3 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_3); __pyx_t_4 = 0;
     for (;;) {
       if (__pyx_t_4 >= PyList_GET_SIZE(__pyx_t_3)) break;
       #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1154, __pyx_L1_error)
+      __pyx_t_5 = PyList_GET_ITEM(__pyx_t_3, __pyx_t_4); __Pyx_INCREF(__pyx_t_5); __pyx_t_4++; if (unlikely(0 < 0)) __PYX_ERR(0, 1162, __pyx_L1_error)
       #else
-      __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1154, __pyx_L1_error)
+      __pyx_t_5 = PySequence_ITEM(__pyx_t_3, __pyx_t_4); __pyx_t_4++; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1162, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_5);
       #endif
-      if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1154, __pyx_L1_error)
+      if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1162, __pyx_L1_error)
       __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_5));
       __pyx_t_5 = 0;
 
-      /* "libfds/fields.pyx":1155
+      /* "libfds/fields.pyx":1163
  *         for s in self.src:
  *             for sub in self.cdomains:
  *                 if sub.mp:             # <<<<<<<<<<<<<<
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  */
       __pyx_t_6 = (__pyx_v_sub->mp != 0);
       if (__pyx_t_6) {
 
-        /* "libfds/fields.pyx":1156
+        /* "libfds/fields.pyx":1164
  *             for sub in self.cdomains:
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  */
         {
             #ifdef WITH_THREAD
             PyThreadState *_save;
             Py_UNBLOCK_THREADS
             __Pyx_FastGIL_Remember();
             #endif
             /*try:*/ {
-              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 1156, __pyx_L11_error) }
+              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 1164, __pyx_L11_error) }
               __pyx_t_7 = __pyx_v_sub->ix.f0;
-              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 1156, __pyx_L11_error) }
+              if (unlikely(!__pyx_v_sub)) { __Pyx_RaiseUnboundLocalError("sub"); __PYX_ERR(0, 1164, __pyx_L11_error) }
               __pyx_t_8 = (__pyx_v_sub->ix.f1 + 1);
               if ((1 == 0)) abort();
               {
                   #if ((defined(__APPLE__) || defined(__OSX__)) && (defined(__GNUC__) && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))))
                       #undef likely
                       #undef unlikely
                       #define likely(x)   (x)
@@ -29329,39 +29398,39 @@
                           for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_10; __pyx_t_9++){
                               {
                                   __pyx_v_ix = (Py_ssize_t)(__pyx_t_7 + 1 * __pyx_t_9);
                                   /* Initialize private variables to invalid values */
                                   __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                                   __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                                  /* "libfds/fields.pyx":1157
+                                  /* "libfds/fields.pyx":1165
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):             # <<<<<<<<<<<<<<
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  *                                 self.p[ix, iy, iz] += s.evolution[it] * s.profile[ix, iy, iz] #* self.dtrk
  */
                                   __pyx_t_11 = (__pyx_v_sub->iy.f1 + 1);
                                   __pyx_t_12 = __pyx_t_11;
                                   for (__pyx_t_13 = __pyx_v_sub->iy.f0; __pyx_t_13 < __pyx_t_12; __pyx_t_13+=1) {
                                     __pyx_v_iy = __pyx_t_13;
 
-                                    /* "libfds/fields.pyx":1158
+                                    /* "libfds/fields.pyx":1166
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):             # <<<<<<<<<<<<<<
  *                                 self.p[ix, iy, iz] += s.evolution[it] * s.profile[ix, iy, iz] #* self.dtrk
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  */
                                     __pyx_t_14 = (__pyx_v_sub->iz.f1 + 1);
                                     __pyx_t_15 = __pyx_t_14;
                                     for (__pyx_t_16 = __pyx_v_sub->iz.f0; __pyx_t_16 < __pyx_t_15; __pyx_t_16+=1) {
                                       __pyx_v_iz = __pyx_t_16;
 
-                                      /* "libfds/fields.pyx":1159
+                                      /* "libfds/fields.pyx":1167
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  *                                 self.p[ix, iy, iz] += s.evolution[it] * s.profile[ix, iy, iz] #* self.dtrk             # <<<<<<<<<<<<<<
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  *                 else:
  */
                                       __pyx_t_17 = __pyx_v_it;
@@ -29383,15 +29452,15 @@
                   #undef likely
                   #undef unlikely
                   #define likely(x)   __builtin_expect(!!(x), 1)
                   #define unlikely(x) __builtin_expect(!!(x), 0)
               #endif
             }
 
-            /* "libfds/fields.pyx":1156
+            /* "libfds/fields.pyx":1164
  *             for sub in self.cdomains:
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  */
             /*finally:*/ {
@@ -29409,62 +29478,62 @@
                 #endif
                 goto __pyx_L1_error;
               }
               __pyx_L12:;
             }
         }
 
-        /* "libfds/fields.pyx":1155
+        /* "libfds/fields.pyx":1163
  *         for s in self.src:
  *             for sub in self.cdomains:
  *                 if sub.mp:             # <<<<<<<<<<<<<<
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  */
         goto __pyx_L7;
       }
 
-      /* "libfds/fields.pyx":1162
+      /* "libfds/fields.pyx":1170
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  *                 else:
  *                     for ix in range(sub.ix[0], sub.ix[1] + 1):             # <<<<<<<<<<<<<<
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  */
       /*else*/ {
         __pyx_t_10 = (__pyx_v_sub->ix.f1 + 1);
         __pyx_t_9 = __pyx_t_10;
         for (__pyx_t_8 = __pyx_v_sub->ix.f0; __pyx_t_8 < __pyx_t_9; __pyx_t_8+=1) {
           __pyx_v_ix = __pyx_t_8;
 
-          /* "libfds/fields.pyx":1163
+          /* "libfds/fields.pyx":1171
  *                 else:
  *                     for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):             # <<<<<<<<<<<<<<
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  *                                 self.p[ix, iy, iz] += s.evolution[it] * s.profile[ix, iy, iz] #* self.dtrk
  */
           __pyx_t_7 = (__pyx_v_sub->iy.f1 + 1);
           __pyx_t_11 = __pyx_t_7;
           for (__pyx_t_12 = __pyx_v_sub->iy.f0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
             __pyx_v_iy = __pyx_t_12;
 
-            /* "libfds/fields.pyx":1164
+            /* "libfds/fields.pyx":1172
  *                     for ix in range(sub.ix[0], sub.ix[1] + 1):
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):             # <<<<<<<<<<<<<<
  *                                 self.p[ix, iy, iz] += s.evolution[it] * s.profile[ix, iy, iz] #* self.dtrk
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  */
             __pyx_t_13 = (__pyx_v_sub->iz.f1 + 1);
             __pyx_t_14 = __pyx_t_13;
             for (__pyx_t_15 = __pyx_v_sub->iz.f0; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
               __pyx_v_iz = __pyx_t_15;
 
-              /* "libfds/fields.pyx":1165
+              /* "libfds/fields.pyx":1173
  *                         for iy in range(sub.iy[0], sub.iy[1] + 1):
  *                             for iz in range(sub.iz[0], sub.iz[1] + 1):
  *                                 self.p[ix, iy, iz] += s.evolution[it] * s.profile[ix, iy, iz] #* self.dtrk             # <<<<<<<<<<<<<<
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  * 
  */
               __pyx_t_20 = __pyx_v_it;
@@ -29477,35 +29546,35 @@
               *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_23 * __pyx_v_self->p.strides[0]) ) + __pyx_t_22 * __pyx_v_self->p.strides[1]) )) + __pyx_t_21)) )) += ((*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_s->evolution.data) + __pyx_t_20)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_s->profile.data + __pyx_t_19 * __pyx_v_s->profile.strides[0]) ) + __pyx_t_18 * __pyx_v_s->profile.strides[1]) )) + __pyx_t_17)) ))));
             }
           }
         }
       }
       __pyx_L7:;
 
-      /* "libfds/fields.pyx":1154
+      /* "libfds/fields.pyx":1162
  * 
  *         for s in self.src:
  *             for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *                 if sub.mp:
  *                     for ix in prange(sub.ix[0], sub.ix[1] + 1, nogil=True, num_threads=self.cpu):
  */
     }
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":1153
+    /* "libfds/fields.pyx":1161
  *         cdef Py_ssize_t it = self.cfg.it
  * 
  *         for s in self.src:             # <<<<<<<<<<<<<<
  *             for sub in self.cdomains:
  *                 if sub.mp:
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":1145
+  /* "libfds/fields.pyx":1153
  *                         self.rw[ix, iy, iz] = 0
  * 
  *     cdef void update_sources(self):             # <<<<<<<<<<<<<<
  *         """ Update sources. """
  * 
  */
 
@@ -29518,15 +29587,15 @@
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.update_sources", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_XDECREF((PyObject *)__pyx_v_s);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1168
+/* "libfds/fields.pyx":1176
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  * 
  *     cdef void update_odudtrk(self, double rk):             # <<<<<<<<<<<<<<
  * 
  *         self.dtrk = rk * self.cfg.dt
  */
 
@@ -29544,86 +29613,86 @@
   PyObject *__pyx_t_10 = NULL;
   __Pyx_memviewslice __pyx_t_11 = { 0, 0, { 0 }, { 0 }, { 0 } };
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_odudtrk", 0);
 
-  /* "libfds/fields.pyx":1170
+  /* "libfds/fields.pyx":1178
  *     cdef void update_odudtrk(self, double rk):
  * 
  *         self.dtrk = rk * self.cfg.dt             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_x == 's':
  */
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_rk); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1170, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_rk); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1170, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->cfg, __pyx_n_s_dt); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1170, __pyx_L1_error)
+  __pyx_t_3 = PyNumber_Multiply(__pyx_t_1, __pyx_t_2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1170, __pyx_L1_error)
+  __pyx_t_4 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1178, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __pyx_v_self->dtrk = __pyx_t_4;
 
-  /* "libfds/fields.pyx":1172
+  /* "libfds/fields.pyx":1180
  *         self.dtrk = rk * self.cfg.dt
  * 
  *         if self.flag_x == 's':             # <<<<<<<<<<<<<<
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1172, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1180, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":1173
+    /* "libfds/fields.pyx":1181
  * 
  *         if self.flag_x == 's':
  *             self.odxdtrk = - self.odxdt * rk             # <<<<<<<<<<<<<<
  *         elif self.flag_x == 'v':
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  */
     __pyx_v_self->odxdtrk = ((-__pyx_v_self->odxdt) * __pyx_v_rk);
 
-    /* "libfds/fields.pyx":1172
+    /* "libfds/fields.pyx":1180
  *         self.dtrk = rk * self.cfg.dt
  * 
  *         if self.flag_x == 's':             # <<<<<<<<<<<<<<
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1174
+  /* "libfds/fields.pyx":1182
  *         if self.flag_x == 's':
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1174, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_x, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1182, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":1175
+    /* "libfds/fields.pyx":1183
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_y == 's':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1175, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1183, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->odxdt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1175, __pyx_L1_error)
+    __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->odxdt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1183, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_1);
-    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1175, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1183, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_8 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_8 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_8)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -29632,118 +29701,118 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_1, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_8, __pyx_t_1, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1175, __pyx_L1_error)
+      __pyx_t_10 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1183, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_10);
       if (__pyx_t_8) {
         __Pyx_GIVEREF(__pyx_t_8); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_8); __pyx_t_8 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_1);
       PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_9, __pyx_t_1);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_9, __pyx_t_7);
       __pyx_t_1 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1175, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_10, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1183, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1175, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1183, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odxdtrk_v, 0);
     __pyx_v_self->odxdtrk_v = __pyx_t_11;
     __pyx_t_11.memview = NULL;
     __pyx_t_11.data = NULL;
 
-    /* "libfds/fields.pyx":1174
+    /* "libfds/fields.pyx":1182
  *         if self.flag_x == 's':
  *             self.odxdtrk = - self.odxdt * rk
  *         elif self.flag_x == 'v':             # <<<<<<<<<<<<<<
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  */
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1177
+  /* "libfds/fields.pyx":1185
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  *         if self.flag_y == 's':             # <<<<<<<<<<<<<<
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1177, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1185, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":1178
+    /* "libfds/fields.pyx":1186
  * 
  *         if self.flag_y == 's':
  *             self.odydtrk = - self.odydt * rk             # <<<<<<<<<<<<<<
  *         elif self.flag_y == 'v':
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  */
     __pyx_v_self->odydtrk = ((-__pyx_v_self->odydt) * __pyx_v_rk);
 
-    /* "libfds/fields.pyx":1177
+    /* "libfds/fields.pyx":1185
  *             self.odxdtrk_v = mult(self.odxdt_v, - rk)
  * 
  *         if self.flag_y == 's':             # <<<<<<<<<<<<<<
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':
  */
     goto __pyx_L4;
   }
 
-  /* "libfds/fields.pyx":1179
+  /* "libfds/fields.pyx":1187
  *         if self.flag_y == 's':
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1179, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_y, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1187, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":1180
+    /* "libfds/fields.pyx":1188
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':
  *             self.odydtrk_v = mult(self.odydt_v, - rk)             # <<<<<<<<<<<<<<
  * 
  *         if self.flag_z == 's':
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1180, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1188, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_self->odydt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1180, __pyx_L1_error)
+    __pyx_t_10 = __pyx_memoryview_fromslice(__pyx_v_self->odydt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 1188, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_10);
-    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1180, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1188, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_1 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_1)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -29752,118 +29821,118 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_10, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1180, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_1, __pyx_t_10, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1180, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_1); __pyx_t_1 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1180, __pyx_L1_error)
+      __pyx_t_8 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1188, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_8);
       if (__pyx_t_1) {
         __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_1); __pyx_t_1 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_10);
       PyTuple_SET_ITEM(__pyx_t_8, 0+__pyx_t_9, __pyx_t_10);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_8, 1+__pyx_t_9, __pyx_t_7);
       __pyx_t_10 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1180, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_8, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1188, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1180, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1188, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odydtrk_v, 0);
     __pyx_v_self->odydtrk_v = __pyx_t_11;
     __pyx_t_11.memview = NULL;
     __pyx_t_11.data = NULL;
 
-    /* "libfds/fields.pyx":1179
+    /* "libfds/fields.pyx":1187
  *         if self.flag_y == 's':
  *             self.odydtrk = - self.odydt * rk
  *         elif self.flag_y == 'v':             # <<<<<<<<<<<<<<
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  */
   }
   __pyx_L4:;
 
-  /* "libfds/fields.pyx":1182
+  /* "libfds/fields.pyx":1190
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  *         if self.flag_z == 's':             # <<<<<<<<<<<<<<
  *             self.odzdtrk = - self.odzdt * rk
  *         elif self.flag_z == 'v':
  */
-  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_z, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1182, __pyx_L1_error)
+  __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_z, __pyx_n_u_s, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1190, __pyx_L1_error)
   __pyx_t_6 = (__pyx_t_5 != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/fields.pyx":1183
+    /* "libfds/fields.pyx":1191
  * 
  *         if self.flag_z == 's':
  *             self.odzdtrk = - self.odzdt * rk             # <<<<<<<<<<<<<<
  *         elif self.flag_z == 'v':
  *             self.odzdtrk_v = mult(self.odzdt_v, - rk)
  */
     __pyx_v_self->odzdtrk = ((-__pyx_v_self->odzdt) * __pyx_v_rk);
 
-    /* "libfds/fields.pyx":1182
+    /* "libfds/fields.pyx":1190
  *             self.odydtrk_v = mult(self.odydt_v, - rk)
  * 
  *         if self.flag_z == 's':             # <<<<<<<<<<<<<<
  *             self.odzdtrk = - self.odzdt * rk
  *         elif self.flag_z == 'v':
  */
     goto __pyx_L5;
   }
 
-  /* "libfds/fields.pyx":1184
+  /* "libfds/fields.pyx":1192
  *         if self.flag_z == 's':
  *             self.odzdtrk = - self.odzdt * rk
  *         elif self.flag_z == 'v':             # <<<<<<<<<<<<<<
  *             self.odzdtrk_v = mult(self.odzdt_v, - rk)
  * 
  */
-  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_z, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1184, __pyx_L1_error)
+  __pyx_t_6 = (__Pyx_PyUnicode_Equals(__pyx_v_self->flag_z, __pyx_n_u_v, Py_EQ)); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(0, 1192, __pyx_L1_error)
   __pyx_t_5 = (__pyx_t_6 != 0);
   if (__pyx_t_5) {
 
-    /* "libfds/fields.pyx":1185
+    /* "libfds/fields.pyx":1193
  *             self.odzdtrk = - self.odzdt * rk
  *         elif self.flag_z == 'v':
  *             self.odzdtrk_v = mult(self.odzdt_v, - rk)             # <<<<<<<<<<<<<<
  * 
  *     cdef void update(self, str var):
  */
-    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_mult); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->odzdt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->odzdt_v, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 1193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    __pyx_t_7 = PyFloat_FromDouble((-__pyx_v_rk)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 1193, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __pyx_t_10 = NULL;
     __pyx_t_9 = 0;
     if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_2))) {
       __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_2);
       if (likely(__pyx_t_10)) {
         PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
@@ -29872,66 +29941,66 @@
         __Pyx_DECREF_SET(__pyx_t_2, function);
         __pyx_t_9 = 1;
       }
     }
     #if CYTHON_FAST_PYCALL
     if (PyFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_8, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     #if CYTHON_FAST_PYCCALL
     if (__Pyx_PyFastCFunction_Check(__pyx_t_2)) {
       PyObject *__pyx_temp[3] = {__pyx_t_10, __pyx_t_8, __pyx_t_7};
-      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyCFunction_FastCall(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 2+__pyx_t_9); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
       __Pyx_XDECREF(__pyx_t_10); __pyx_t_10 = 0;
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
       __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     } else
     #endif
     {
-      __pyx_t_1 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1185, __pyx_L1_error)
+      __pyx_t_1 = PyTuple_New(2+__pyx_t_9); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1193, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_1);
       if (__pyx_t_10) {
         __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_10); __pyx_t_10 = NULL;
       }
       __Pyx_GIVEREF(__pyx_t_8);
       PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_9, __pyx_t_8);
       __Pyx_GIVEREF(__pyx_t_7);
       PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_9, __pyx_t_7);
       __pyx_t_8 = 0;
       __pyx_t_7 = 0;
-      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1185, __pyx_L1_error)
+      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1193, __pyx_L1_error)
       __Pyx_GOTREF(__pyx_t_3);
       __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
     }
     __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1185, __pyx_L1_error)
+    __pyx_t_11 = __Pyx_PyObject_to_MemoryviewSlice_dc_double(__pyx_t_3, PyBUF_WRITABLE); if (unlikely(!__pyx_t_11.memview)) __PYX_ERR(0, 1193, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __PYX_XDEC_MEMVIEW(&__pyx_v_self->odzdtrk_v, 0);
     __pyx_v_self->odzdtrk_v = __pyx_t_11;
     __pyx_t_11.memview = NULL;
     __pyx_t_11.data = NULL;
 
-    /* "libfds/fields.pyx":1184
+    /* "libfds/fields.pyx":1192
  *         if self.flag_z == 's':
  *             self.odzdtrk = - self.odzdt * rk
  *         elif self.flag_z == 'v':             # <<<<<<<<<<<<<<
  *             self.odzdtrk_v = mult(self.odzdt_v, - rk)
  * 
  */
   }
   __pyx_L5:;
 
-  /* "libfds/fields.pyx":1168
+  /* "libfds/fields.pyx":1176
  *                                 #self.r[ix, iy] += amplitude / (self.c0 * self.c0)
  * 
  *     cdef void update_odudtrk(self, double rk):             # <<<<<<<<<<<<<<
  * 
  *         self.dtrk = rk * self.cfg.dt
  */
 
@@ -29946,15 +30015,15 @@
   __Pyx_XDECREF(__pyx_t_10);
   __PYX_XDEC_MEMVIEW(&__pyx_t_11, 1);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.update_odudtrk", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1187
+/* "libfds/fields.pyx":1195
  *             self.odzdtrk_v = mult(self.odzdt_v, - rk)
  * 
  *     cdef void update(self, str var):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -29967,252 +30036,252 @@
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update", 0);
 
-  /* "libfds/fields.pyx":1191
+  /* "libfds/fields.pyx":1199
  *         cdef Domain3d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 1191, __pyx_L1_error)
+    __PYX_ERR(0, 1199, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1199, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1191, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1199, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1191, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1199, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":1192
+    /* "libfds/fields.pyx":1200
  * 
  *         for sub in self.cdomains:
  *             if var == 'p':             # <<<<<<<<<<<<<<
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'K':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_p, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1192, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_p, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1200, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":1193
+      /* "libfds/fields.pyx":1201
  *         for sub in self.cdomains:
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_p(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1192
+      /* "libfds/fields.pyx":1200
  * 
  *         for sub in self.cdomains:
  *             if var == 'p':             # <<<<<<<<<<<<<<
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'K':
  */
     }
 
-    /* "libfds/fields.pyx":1194
+    /* "libfds/fields.pyx":1202
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'K':             # <<<<<<<<<<<<<<
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'Tk':
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_K, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1194, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_K, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1202, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":1195
+      /* "libfds/fields.pyx":1203
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_K(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1194
+      /* "libfds/fields.pyx":1202
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'K':             # <<<<<<<<<<<<<<
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'Tk':
  */
     }
 
-    /* "libfds/fields.pyx":1196
+    /* "libfds/fields.pyx":1204
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'Tk':             # <<<<<<<<<<<<<<
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'V':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_Tk, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1196, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_Tk, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1204, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":1197
+      /* "libfds/fields.pyx":1205
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_Tk(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1196
+      /* "libfds/fields.pyx":1204
  *             if var == 'K':
  *                 self._update_K(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'Tk':             # <<<<<<<<<<<<<<
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'V':
  */
     }
 
-    /* "libfds/fields.pyx":1198
+    /* "libfds/fields.pyx":1206
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'V':             # <<<<<<<<<<<<<<
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wx':
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_V, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1198, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_V, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1206, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":1199
+      /* "libfds/fields.pyx":1207
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'wx':
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_V(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1198
+      /* "libfds/fields.pyx":1206
  *             if var == 'Tk':
  *                 self._update_Tk(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'V':             # <<<<<<<<<<<<<<
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wx':
  */
     }
 
-    /* "libfds/fields.pyx":1200
+    /* "libfds/fields.pyx":1208
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wx':             # <<<<<<<<<<<<<<
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wy':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wx, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1200, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wx, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1208, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":1201
+      /* "libfds/fields.pyx":1209
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wx':
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'wy':
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_wx(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1200
+      /* "libfds/fields.pyx":1208
  *             if var == 'V':
  *                 self._update_V(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wx':             # <<<<<<<<<<<<<<
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wy':
  */
     }
 
-    /* "libfds/fields.pyx":1202
+    /* "libfds/fields.pyx":1210
  *             if var == 'wx':
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wy':             # <<<<<<<<<<<<<<
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wz':
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wy, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1202, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wy, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 1210, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fields.pyx":1203
+      /* "libfds/fields.pyx":1211
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wy':
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             if var == 'wz':
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_wy(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1202
+      /* "libfds/fields.pyx":1210
  *             if var == 'wx':
  *                 self._update_wx(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wy':             # <<<<<<<<<<<<<<
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wz':
  */
     }
 
-    /* "libfds/fields.pyx":1204
+    /* "libfds/fields.pyx":1212
  *             if var == 'wy':
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wz':             # <<<<<<<<<<<<<<
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wz, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1204, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_var, __pyx_n_u_wz, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 1212, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fields.pyx":1205
+      /* "libfds/fields.pyx":1213
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wz':
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_p(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
       __pyx_f_6libfds_6fields_8Fields3d__update_wz(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fields.pyx":1204
+      /* "libfds/fields.pyx":1212
  *             if var == 'wy':
  *                 self._update_wy(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             if var == 'wz':             # <<<<<<<<<<<<<<
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
     }
 
-    /* "libfds/fields.pyx":1191
+    /* "libfds/fields.pyx":1199
  *         cdef Domain3d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             if var == 'p':
  *                 self._update_p(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":1187
+  /* "libfds/fields.pyx":1195
  *             self.odzdtrk_v = mult(self.odzdt_v, - rk)
  * 
  *     cdef void update(self, str var):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -30223,15 +30292,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.update", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1207
+/* "libfds/fields.pyx":1215
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _update_p(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -30276,25 +30345,25 @@
   Py_ssize_t __pyx_t_34;
   Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
   Py_ssize_t __pyx_t_37;
   Py_ssize_t __pyx_t_38;
   __Pyx_RefNannySetupContext("_update_p", 0);
 
-  /* "libfds/fields.pyx":1211
+  /* "libfds/fields.pyx":1219
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1212
+    /* "libfds/fields.pyx":1220
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -30327,103 +30396,103 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1213
+                              /* "libfds/fields.pyx":1221
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1214
+                                /* "libfds/fields.pyx":1222
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1215
+                                  /* "libfds/fields.pyx":1223
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -             # <<<<<<<<<<<<<<
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
 
-                                  /* "libfds/fields.pyx":1216
+                                  /* "libfds/fields.pyx":1224
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  */
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fields.pyx":1217
+                                  /* "libfds/fields.pyx":1225
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  *         else:
  */
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
 
-                                  /* "libfds/fields.pyx":1218
+                                  /* "libfds/fields.pyx":1226
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
                                   __pyx_t_30 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_32 = __pyx_v_iz;
 
-                                  /* "libfds/fields.pyx":1216
+                                  /* "libfds/fields.pyx":1224
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  */
                                   __pyx_t_33 = __pyx_v_ix;
                                   __pyx_t_34 = __pyx_v_iy;
                                   __pyx_t_35 = __pyx_v_iz;
 
-                                  /* "libfds/fields.pyx":1215
+                                  /* "libfds/fields.pyx":1223
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -             # <<<<<<<<<<<<<<
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  */
                                   __pyx_t_36 = __pyx_v_ix;
@@ -30441,15 +30510,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1212
+        /* "libfds/fields.pyx":1220
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -30460,126 +30529,126 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1211
+    /* "libfds/fields.pyx":1219
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1220
+  /* "libfds/fields.pyx":1228
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1221
+      /* "libfds/fields.pyx":1229
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1222
+        /* "libfds/fields.pyx":1230
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1223
+          /* "libfds/fields.pyx":1231
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -             # <<<<<<<<<<<<<<
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  */
           __pyx_t_35 = __pyx_v_ix;
           __pyx_t_34 = __pyx_v_iy;
           __pyx_t_33 = __pyx_v_iz;
 
-          /* "libfds/fields.pyx":1224
+          /* "libfds/fields.pyx":1232
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  */
           __pyx_t_32 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_30 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fields.pyx":1225
+          /* "libfds/fields.pyx":1233
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  * 
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
 
-          /* "libfds/fields.pyx":1226
+          /* "libfds/fields.pyx":1234
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_K(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fields.pyx":1224
+          /* "libfds/fields.pyx":1232
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
 
-          /* "libfds/fields.pyx":1223
+          /* "libfds/fields.pyx":1231
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.p[ix, iy, iz] = (self.re[ix, iy, iz] -             # <<<<<<<<<<<<<<
  *                                             0.5 * (self.ru[ix, iy, iz] * self.ru[ix, iy, iz] +
  *                                                     self.rv[ix, iy, iz] * self.rv[ix, iy, iz] +
  */
           __pyx_t_38 = __pyx_v_ix;
@@ -30588,27 +30657,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_38 * __pyx_v_self->p.strides[0]) ) + __pyx_t_37 * __pyx_v_self->p.strides[1]) )) + __pyx_t_36)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_35 * __pyx_v_self->re.strides[0]) ) + __pyx_t_34 * __pyx_v_self->re.strides[1]) )) + __pyx_t_33)) ))) - ((0.5 * ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_32 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_31 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_30)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_29 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_28 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_27)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_26 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_24)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_23 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_21)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_20 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_18)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_17 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_15)) )))))) / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_14 * __pyx_v_self->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->r.strides[1]) )) + __pyx_t_12)) ))))) * __pyx_v_self->gaminusone);
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1207
+  /* "libfds/fields.pyx":1215
  *                 self._update_wz(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _update_p(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1228
+/* "libfds/fields.pyx":1236
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  * 
  *     cdef void _update_K(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -30632,25 +30701,25 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   __Pyx_RefNannySetupContext("_update_K", 0);
 
-  /* "libfds/fields.pyx":1232
+  /* "libfds/fields.pyx":1240
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1233
+    /* "libfds/fields.pyx":1241
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -30683,39 +30752,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1234
+                              /* "libfds/fields.pyx":1242
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1235
+                                /* "libfds/fields.pyx":1243
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1236
+                                  /* "libfds/fields.pyx":1244
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -30736,15 +30805,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1233
+        /* "libfds/fields.pyx":1241
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -30755,15 +30824,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1237
+    /* "libfds/fields.pyx":1245
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -30796,39 +30865,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1238
+                              /* "libfds/fields.pyx":1246
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1239
+                                /* "libfds/fields.pyx":1247
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1240
+                                  /* "libfds/fields.pyx":1248
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -30849,15 +30918,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1237
+        /* "libfds/fields.pyx":1245
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -30868,15 +30937,15 @@
             #endif
             goto __pyx_L19;
           }
           __pyx_L19:;
         }
     }
 
-    /* "libfds/fields.pyx":1241
+    /* "libfds/fields.pyx":1249
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -30909,39 +30978,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1242
+                              /* "libfds/fields.pyx":1250
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1243
+                                /* "libfds/fields.pyx":1251
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1244
+                                  /* "libfds/fields.pyx":1252
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -30962,15 +31031,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1241
+        /* "libfds/fields.pyx":1249
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -30981,15 +31050,15 @@
             #endif
             goto __pyx_L32;
           }
           __pyx_L32:;
         }
     }
 
-    /* "libfds/fields.pyx":1245
+    /* "libfds/fields.pyx":1253
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -31022,39 +31091,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1246
+                              /* "libfds/fields.pyx":1254
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1247
+                                /* "libfds/fields.pyx":1255
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1248
+                                  /* "libfds/fields.pyx":1256
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -31075,15 +31144,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1245
+        /* "libfds/fields.pyx":1253
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -31094,15 +31163,15 @@
             #endif
             goto __pyx_L45;
           }
           __pyx_L45:;
         }
     }
 
-    /* "libfds/fields.pyx":1249
+    /* "libfds/fields.pyx":1257
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -31135,39 +31204,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1250
+                              /* "libfds/fields.pyx":1258
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1251
+                                /* "libfds/fields.pyx":1259
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1252
+                                  /* "libfds/fields.pyx":1260
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -31188,15 +31257,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1249
+        /* "libfds/fields.pyx":1257
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -31207,62 +31276,62 @@
             #endif
             goto __pyx_L58;
           }
           __pyx_L58:;
         }
     }
 
-    /* "libfds/fields.pyx":1232
+    /* "libfds/fields.pyx":1240
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1254
+  /* "libfds/fields.pyx":1262
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1255
+      /* "libfds/fields.pyx":1263
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1256
+        /* "libfds/fields.pyx":1264
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1257
+          /* "libfds/fields.pyx":1265
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -31272,51 +31341,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->K.data + __pyx_t_17 * __pyx_v_self->K.strides[0]) ) + __pyx_t_16 * __pyx_v_self->K.strides[1]) )) + __pyx_t_15)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_14 * __pyx_v_self->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->r.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
 
-    /* "libfds/fields.pyx":1258
+    /* "libfds/fields.pyx":1266
  *                     for iz in range(izmin, izmax + 1):
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1259
+      /* "libfds/fields.pyx":1267
  *                         self.K[ix, iy, iz] = self.r[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1260
+        /* "libfds/fields.pyx":1268
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1261
+          /* "libfds/fields.pyx":1269
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -31326,51 +31395,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Ku.data + __pyx_t_15 * __pyx_v_self->Ku.strides[0]) ) + __pyx_t_16 * __pyx_v_self->Ku.strides[1]) )) + __pyx_t_17)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_12 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_14)) )));
         }
       }
     }
 
-    /* "libfds/fields.pyx":1262
+    /* "libfds/fields.pyx":1270
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1263
+      /* "libfds/fields.pyx":1271
  *                         self.Ku[ix, iy, iz] = self.ru[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1264
+        /* "libfds/fields.pyx":1272
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1265
+          /* "libfds/fields.pyx":1273
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -31380,51 +31449,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Kv.data + __pyx_t_17 * __pyx_v_self->Kv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->Kv.strides[1]) )) + __pyx_t_15)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_14 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
 
-    /* "libfds/fields.pyx":1266
+    /* "libfds/fields.pyx":1274
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1267
+      /* "libfds/fields.pyx":1275
  *                         self.Kv[ix, iy, iz] = self.rv[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1268
+        /* "libfds/fields.pyx":1276
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1269
+          /* "libfds/fields.pyx":1277
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -31434,51 +31503,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Kw.data + __pyx_t_15 * __pyx_v_self->Kw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->Kw.strides[1]) )) + __pyx_t_17)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_12 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_14)) )));
         }
       }
     }
 
-    /* "libfds/fields.pyx":1270
+    /* "libfds/fields.pyx":1278
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1271
+      /* "libfds/fields.pyx":1279
  *                         self.Kw[ix, iy, iz] = self.rw[ix, iy, iz]
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1272
+        /* "libfds/fields.pyx":1280
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1273
+          /* "libfds/fields.pyx":1281
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_Tk(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -31490,27 +31559,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Ke.data + __pyx_t_17 * __pyx_v_self->Ke.strides[0]) ) + __pyx_t_16 * __pyx_v_self->Ke.strides[1]) )) + __pyx_t_15)) )) = (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_14 * __pyx_v_self->re.strides[0]) ) + __pyx_t_13 * __pyx_v_self->re.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1228
+  /* "libfds/fields.pyx":1236
  *                                                     self.rw[ix, iy, iz] * self.rw[ix, iy, iz]) / self.r[ix, iy, iz]) * self.gaminusone
  * 
  *     cdef void _update_K(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1275
+/* "libfds/fields.pyx":1283
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  * 
  *     cdef void _update_Tk(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -31537,25 +31606,25 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("_update_Tk", 0);
 
-  /* "libfds/fields.pyx":1279
+  /* "libfds/fields.pyx":1287
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1280
+    /* "libfds/fields.pyx":1288
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -31588,39 +31657,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1281
+                              /* "libfds/fields.pyx":1289
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1282
+                                /* "libfds/fields.pyx":1290
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1283
+                                  /* "libfds/fields.pyx":1291
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -31644,15 +31713,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1280
+        /* "libfds/fields.pyx":1288
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -31663,62 +31732,62 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1279
+    /* "libfds/fields.pyx":1287
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1285
+  /* "libfds/fields.pyx":1293
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1286
+      /* "libfds/fields.pyx":1294
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1287
+        /* "libfds/fields.pyx":1295
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1288
+          /* "libfds/fields.pyx":1296
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_V(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -31733,27 +31802,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Tk.data + __pyx_t_20 * __pyx_v_self->Tk.strides[0]) ) + __pyx_t_19 * __pyx_v_self->Tk.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_17 * __pyx_v_self->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->p.strides[1]) )) + __pyx_t_15)) ))) / ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_14 * __pyx_v_self->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->r.strides[1]) )) + __pyx_t_12)) ))) * __pyx_v_self->cpmcv));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1275
+  /* "libfds/fields.pyx":1283
  *                         self.Ke[ix, iy, iz] = self.re[ix, iy, iz]
  * 
  *     cdef void _update_Tk(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1290
+/* "libfds/fields.pyx":1298
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  * 
  *     cdef void _update_V(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -31780,25 +31849,25 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("_update_V", 0);
 
-  /* "libfds/fields.pyx":1294
+  /* "libfds/fields.pyx":1302
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1295
+    /* "libfds/fields.pyx":1303
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -31831,39 +31900,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1296
+                              /* "libfds/fields.pyx":1304
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1297
+                                /* "libfds/fields.pyx":1305
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1298
+                                  /* "libfds/fields.pyx":1306
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -31887,15 +31956,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1295
+        /* "libfds/fields.pyx":1303
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -31906,15 +31975,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1300
+    /* "libfds/fields.pyx":1308
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -31947,39 +32016,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1301
+                              /* "libfds/fields.pyx":1309
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1302
+                                /* "libfds/fields.pyx":1310
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1303
+                                  /* "libfds/fields.pyx":1311
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  */
                                   __pyx_t_17 = __pyx_v_ix;
@@ -32003,15 +32072,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1300
+        /* "libfds/fields.pyx":1308
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -32022,15 +32091,15 @@
             #endif
             goto __pyx_L19;
           }
           __pyx_L19:;
         }
     }
 
-    /* "libfds/fields.pyx":1305
+    /* "libfds/fields.pyx":1313
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -32063,39 +32132,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1306
+                              /* "libfds/fields.pyx":1314
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1307
+                                /* "libfds/fields.pyx":1315
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1308
+                                  /* "libfds/fields.pyx":1316
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -32119,15 +32188,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1305
+        /* "libfds/fields.pyx":1313
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -32138,62 +32207,62 @@
             #endif
             goto __pyx_L32;
           }
           __pyx_L32:;
         }
     }
 
-    /* "libfds/fields.pyx":1294
+    /* "libfds/fields.pyx":1302
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1310
+  /* "libfds/fields.pyx":1318
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1311
+      /* "libfds/fields.pyx":1319
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1312
+        /* "libfds/fields.pyx":1320
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1313
+          /* "libfds/fields.pyx":1321
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -32206,51 +32275,51 @@
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Ee.data + __pyx_t_20 * __pyx_v_self->Ee.strides[0]) ) + __pyx_t_19 * __pyx_v_self->Ee.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_17 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_15)) ))) / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_14 * __pyx_v_self->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->r.strides[1]) )) + __pyx_t_12)) ))));
         }
       }
     }
 
-    /* "libfds/fields.pyx":1315
+    /* "libfds/fields.pyx":1323
  *                         self.Ee[ix, iy, iz] = self.ru[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1316
+      /* "libfds/fields.pyx":1324
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1317
+        /* "libfds/fields.pyx":1325
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1318
+          /* "libfds/fields.pyx":1326
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -32263,51 +32332,51 @@
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Fe.data + __pyx_t_18 * __pyx_v_self->Fe.strides[0]) ) + __pyx_t_19 * __pyx_v_self->Fe.strides[1]) )) + __pyx_t_20)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_12 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_14)) ))) / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_15 * __pyx_v_self->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->r.strides[1]) )) + __pyx_t_17)) ))));
         }
       }
     }
 
-    /* "libfds/fields.pyx":1320
+    /* "libfds/fields.pyx":1328
  *                         self.Fe[ix, iy, iz] = self.rv[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1321
+      /* "libfds/fields.pyx":1329
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1322
+        /* "libfds/fields.pyx":1330
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1323
+          /* "libfds/fields.pyx":1331
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_wx(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -32322,27 +32391,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->Ge.data + __pyx_t_20 * __pyx_v_self->Ge.strides[0]) ) + __pyx_t_19 * __pyx_v_self->Ge.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_17 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_15)) ))) / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_14 * __pyx_v_self->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->r.strides[1]) )) + __pyx_t_12)) ))));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1290
+  /* "libfds/fields.pyx":1298
  *                         self.Tk[ix, iy, iz] = self.p[ix, iy, iz] / (self.r[ix, iy, iz] * self.cpmcv)
  * 
  *     cdef void _update_V(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1325
+/* "libfds/fields.pyx":1333
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *     cdef void _update_wx(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -32369,25 +32438,25 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("_update_wx", 0);
 
-  /* "libfds/fields.pyx":1329
+  /* "libfds/fields.pyx":1337
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1330
+    /* "libfds/fields.pyx":1338
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -32420,39 +32489,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1331
+                              /* "libfds/fields.pyx":1339
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1332
+                                /* "libfds/fields.pyx":1340
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1333
+                                  /* "libfds/fields.pyx":1341
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -32476,15 +32545,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1330
+        /* "libfds/fields.pyx":1338
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -32495,62 +32564,62 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1329
+    /* "libfds/fields.pyx":1337
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1335
+  /* "libfds/fields.pyx":1343
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1336
+      /* "libfds/fields.pyx":1344
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1337
+        /* "libfds/fields.pyx":1345
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1338
+          /* "libfds/fields.pyx":1346
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_wy(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -32565,27 +32634,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->wx.data + __pyx_t_20 * __pyx_v_self->wx.strides[0]) ) + __pyx_t_19 * __pyx_v_self->wx.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->F.data + __pyx_t_17 * __pyx_v_self->F.strides[0]) ) + __pyx_t_16 * __pyx_v_self->F.strides[1]) )) + __pyx_t_15)) ))) - (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->G.data + __pyx_t_14 * __pyx_v_self->G.strides[0]) ) + __pyx_t_13 * __pyx_v_self->G.strides[1]) )) + __pyx_t_12)) ))));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1325
+  /* "libfds/fields.pyx":1333
  *                         self.Ge[ix, iy, iz] = self.rw[ix, iy, iz] / self.r[ix, iy, iz]
  * 
  *     cdef void _update_wx(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1340
+/* "libfds/fields.pyx":1348
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  * 
  *     cdef void _update_wy(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -32612,25 +32681,25 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("_update_wy", 0);
 
-  /* "libfds/fields.pyx":1344
+  /* "libfds/fields.pyx":1352
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1345
+    /* "libfds/fields.pyx":1353
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -32663,39 +32732,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1346
+                              /* "libfds/fields.pyx":1354
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1347
+                                /* "libfds/fields.pyx":1355
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1348
+                                  /* "libfds/fields.pyx":1356
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -32719,15 +32788,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1345
+        /* "libfds/fields.pyx":1353
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -32738,62 +32807,62 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1344
+    /* "libfds/fields.pyx":1352
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1350
+  /* "libfds/fields.pyx":1358
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1351
+      /* "libfds/fields.pyx":1359
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1352
+        /* "libfds/fields.pyx":1360
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1353
+          /* "libfds/fields.pyx":1361
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update_wz(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -32808,27 +32877,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->wy.data + __pyx_t_20 * __pyx_v_self->wy.strides[0]) ) + __pyx_t_19 * __pyx_v_self->wy.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->G.data + __pyx_t_17 * __pyx_v_self->G.strides[0]) ) + __pyx_t_16 * __pyx_v_self->G.strides[1]) )) + __pyx_t_15)) ))) - (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->E.data + __pyx_t_14 * __pyx_v_self->E.strides[0]) ) + __pyx_t_13 * __pyx_v_self->E.strides[1]) )) + __pyx_t_12)) ))));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1340
+  /* "libfds/fields.pyx":1348
  *                         self.wx[ix, iy, iz] = self.F[ix, iy, iz] - self.G[ix, iy, iz]
  * 
  *     cdef void _update_wy(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1355
+/* "libfds/fields.pyx":1363
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  * 
  *     cdef void _update_wz(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -32855,25 +32924,25 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("_update_wz", 0);
 
-  /* "libfds/fields.pyx":1359
+  /* "libfds/fields.pyx":1367
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1360
+    /* "libfds/fields.pyx":1368
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -32906,39 +32975,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1361
+                              /* "libfds/fields.pyx":1369
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1362
+                                /* "libfds/fields.pyx":1370
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1363
+                                  /* "libfds/fields.pyx":1371
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -32962,15 +33031,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1360
+        /* "libfds/fields.pyx":1368
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -32981,62 +33050,62 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1359
+    /* "libfds/fields.pyx":1367
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1365
+  /* "libfds/fields.pyx":1373
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1366
+      /* "libfds/fields.pyx":1374
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1367
+        /* "libfds/fields.pyx":1375
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1368
+          /* "libfds/fields.pyx":1376
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cpdef double residual(self):
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -33051,27 +33120,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->wz.data + __pyx_t_20 * __pyx_v_self->wz.strides[0]) ) + __pyx_t_19 * __pyx_v_self->wz.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->E.data + __pyx_t_17 * __pyx_v_self->E.strides[0]) ) + __pyx_t_16 * __pyx_v_self->E.strides[1]) )) + __pyx_t_15)) ))) - (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->F.data + __pyx_t_14 * __pyx_v_self->F.strides[0]) ) + __pyx_t_13 * __pyx_v_self->F.strides[1]) )) + __pyx_t_12)) ))));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1355
+  /* "libfds/fields.pyx":1363
  *                         self.wy[ix, iy, iz] = self.G[ix, iy, iz] - self.E[ix, iy, iz]
  * 
  *     cdef void _update_wz(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1370
+/* "libfds/fields.pyx":1378
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  * 
  *     cpdef double residual(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double res = 0
  */
 
@@ -33085,77 +33154,77 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("residual", 0);
 
-  /* "libfds/fields.pyx":1372
+  /* "libfds/fields.pyx":1380
  *     cpdef double residual(self):
  * 
  *         cdef double res = 0             # <<<<<<<<<<<<<<
  *         cdef Domain3d sub
  * 
  */
   __pyx_v_res = 0.0;
 
-  /* "libfds/fields.pyx":1375
+  /* "libfds/fields.pyx":1383
  *         cdef Domain3d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 1375, __pyx_L1_error)
+    __PYX_ERR(0, 1383, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1375, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1383, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1375, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1383, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1375, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1383, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":1376
+    /* "libfds/fields.pyx":1384
  * 
  *         for sub in self.cdomains:
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         return sqrt(res / self.nsize)
  */
     __pyx_v_res = (__pyx_v_res + __pyx_f_6libfds_6fields_8Fields3d__residual(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp));
 
-    /* "libfds/fields.pyx":1375
+    /* "libfds/fields.pyx":1383
  *         cdef Domain3d sub
  * 
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":1378
+  /* "libfds/fields.pyx":1386
  *            res += self._residual(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *         return sqrt(res / self.nsize)             # <<<<<<<<<<<<<<
  * 
  *     cdef double _residual(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
   __pyx_r = sqrt((__pyx_v_res / ((double)__pyx_v_self->nsize)));
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":1370
+  /* "libfds/fields.pyx":1378
  *                         self.wz[ix, iy, iz] = self.E[ix, iy, iz] - self.F[ix, iy, iz]
  * 
  *     cpdef double residual(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef double res = 0
  */
 
@@ -33189,15 +33258,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("residual", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_6libfds_6fields_8Fields3d_residual(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1370, __pyx_L1_error)
+  __pyx_t_1 = PyFloat_FromDouble(__pyx_f_6libfds_6fields_8Fields3d_residual(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1378, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -33206,15 +33275,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":1380
+/* "libfds/fields.pyx":1388
  *         return sqrt(res / self.nsize)
  * 
  *     cdef double _residual(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -33238,34 +33307,34 @@
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   __Pyx_RefNannySetupContext("_residual", 0);
 
-  /* "libfds/fields.pyx":1383
+  /* "libfds/fields.pyx":1391
  * 
  *         cdef Py_ssize_t ix, iy, iz
  *         cdef double res = 0             # <<<<<<<<<<<<<<
  *         cdef double pa
  * 
  */
   __pyx_v_res = 0.0;
 
-  /* "libfds/fields.pyx":1386
+  /* "libfds/fields.pyx":1394
  *         cdef double pa
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1387
+    /* "libfds/fields.pyx":1395
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -33299,51 +33368,51 @@
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_pa = ((double)__PYX_NAN());
 
-                              /* "libfds/fields.pyx":1388
+                              /* "libfds/fields.pyx":1396
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         pa = self.p[ix, iy, iz] - self.p0
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1389
+                                /* "libfds/fields.pyx":1397
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         pa = self.p[ix, iy, iz] - self.p0
  *                         res += pa * pa
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1390
+                                  /* "libfds/fields.pyx":1398
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         pa = self.p[ix, iy, iz] - self.p0             # <<<<<<<<<<<<<<
  *                         res += pa * pa
  *         else:
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_v_pa = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_12 * __pyx_v_self->p.strides[0]) ) + __pyx_t_13 * __pyx_v_self->p.strides[1]) )) + __pyx_t_14)) ))) - __pyx_v_self->p0);
 
-                                  /* "libfds/fields.pyx":1391
+                                  /* "libfds/fields.pyx":1399
  *                     for iz in range(izmin, izmax + 1):
  *                         pa = self.p[ix, iy, iz] - self.p0
  *                         res += pa * pa             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_v_res = (__pyx_v_res + (__pyx_v_pa * __pyx_v_pa));
@@ -33358,15 +33427,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1387
+        /* "libfds/fields.pyx":1395
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -33377,112 +33446,112 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1386
+    /* "libfds/fields.pyx":1394
  *         cdef double pa
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1393
+  /* "libfds/fields.pyx":1401
  *                         res += pa * pa
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1394
+      /* "libfds/fields.pyx":1402
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         pa = self.p[ix, iy, iz] - self.p0
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1395
+        /* "libfds/fields.pyx":1403
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         pa = self.p[ix, iy, iz] - self.p0
  *                         res += pa * pa
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1396
+          /* "libfds/fields.pyx":1404
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         pa = self.p[ix, iy, iz] - self.p0             # <<<<<<<<<<<<<<
  *                         res += pa * pa
  * 
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_v_pa = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->p.data + __pyx_t_14 * __pyx_v_self->p.strides[0]) ) + __pyx_t_13 * __pyx_v_self->p.strides[1]) )) + __pyx_t_12)) ))) - __pyx_v_self->p0);
 
-          /* "libfds/fields.pyx":1397
+          /* "libfds/fields.pyx":1405
  *                     for iz in range(izmin, izmax + 1):
  *                         pa = self.p[ix, iy, iz] - self.p0
  *                         res += pa * pa             # <<<<<<<<<<<<<<
  * 
  *         return res
  */
           __pyx_v_res = (__pyx_v_res + (__pyx_v_pa * __pyx_v_pa));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1399
+  /* "libfds/fields.pyx":1407
  *                         res += pa * pa
  * 
  *         return res             # <<<<<<<<<<<<<<
  * 
  *     cdef void phys2num(self):
  */
   __pyx_r = __pyx_v_res;
   goto __pyx_L0;
 
-  /* "libfds/fields.pyx":1380
+  /* "libfds/fields.pyx":1388
  *         return sqrt(res / self.nsize)
  * 
  *     cdef double _residual(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":1401
+/* "libfds/fields.pyx":1409
  *         return res
  * 
  *     cdef void phys2num(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -33493,71 +33562,71 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("phys2num", 0);
 
-  /* "libfds/fields.pyx":1405
+  /* "libfds/fields.pyx":1413
  *         cdef Domain3d sub
  * 
  *         self.grid = 'numerical'             # <<<<<<<<<<<<<<
  *         for sub in self.cdomains:
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   __Pyx_INCREF(__pyx_n_u_numerical);
   __Pyx_GIVEREF(__pyx_n_u_numerical);
   __Pyx_GOTREF(__pyx_v_self->grid);
   __Pyx_DECREF(__pyx_v_self->grid);
   __pyx_v_self->grid = __pyx_n_u_numerical;
 
-  /* "libfds/fields.pyx":1406
+  /* "libfds/fields.pyx":1414
  * 
  *         self.grid = 'numerical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 1406, __pyx_L1_error)
+    __PYX_ERR(0, 1414, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1406, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1414, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1406, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1414, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1406, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1414, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":1407
+    /* "libfds/fields.pyx":1415
  *         self.grid = 'numerical'
  *         for sub in self.cdomains:
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _phys2num(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
     __pyx_f_6libfds_6fields_8Fields3d__phys2num(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/fields.pyx":1406
+    /* "libfds/fields.pyx":1414
  * 
  *         self.grid = 'numerical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":1401
+  /* "libfds/fields.pyx":1409
  *         return res
  * 
  *     cdef void phys2num(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -33568,15 +33637,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.phys2num", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1409
+/* "libfds/fields.pyx":1417
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _phys2num(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -33600,25 +33669,25 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   __Pyx_RefNannySetupContext("_phys2num", 0);
 
-  /* "libfds/fields.pyx":1413
+  /* "libfds/fields.pyx":1421
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1414
+    /* "libfds/fields.pyx":1422
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -33651,99 +33720,99 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1415
+                              /* "libfds/fields.pyx":1423
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1416
+                                /* "libfds/fields.pyx":1424
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1417
+                                  /* "libfds/fields.pyx":1425
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_15 * __pyx_v_self->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->r.strides[1]) )) + __pyx_t_17)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-                                  /* "libfds/fields.pyx":1418
+                                  /* "libfds/fields.pyx":1426
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_17 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_15)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-                                  /* "libfds/fields.pyx":1419
+                                  /* "libfds/fields.pyx":1427
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_15 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_17)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-                                  /* "libfds/fields.pyx":1420
+                                  /* "libfds/fields.pyx":1428
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  *         else:
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_17 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_15)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-                                  /* "libfds/fields.pyx":1421
+                                  /* "libfds/fields.pyx":1429
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -33764,15 +33833,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1414
+        /* "libfds/fields.pyx":1422
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -33783,122 +33852,122 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1413
+    /* "libfds/fields.pyx":1421
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1423
+  /* "libfds/fields.pyx":1431
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1424
+      /* "libfds/fields.pyx":1432
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1425
+        /* "libfds/fields.pyx":1433
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1426
+          /* "libfds/fields.pyx":1434
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_17 * __pyx_v_self->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->r.strides[1]) )) + __pyx_t_15)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-          /* "libfds/fields.pyx":1427
+          /* "libfds/fields.pyx":1435
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_15 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_17)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-          /* "libfds/fields.pyx":1428
+          /* "libfds/fields.pyx":1436
  *                         self.r[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_17 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_15)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-          /* "libfds/fields.pyx":1429
+          /* "libfds/fields.pyx":1437
  *                         self.ru[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  * 
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_15 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_17)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-          /* "libfds/fields.pyx":1430
+          /* "libfds/fields.pyx":1438
  *                         self.rv[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] /= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cdef void num2phys(self):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -33910,27 +33979,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_17 * __pyx_v_self->re.strides[0]) ) + __pyx_t_16 * __pyx_v_self->re.strides[1]) )) + __pyx_t_15)) )) /= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1409
+  /* "libfds/fields.pyx":1417
  *             self._phys2num(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _phys2num(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1432
+/* "libfds/fields.pyx":1440
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  * 
  *     cdef void num2phys(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -33941,71 +34010,71 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("num2phys", 0);
 
-  /* "libfds/fields.pyx":1436
+  /* "libfds/fields.pyx":1444
  *         cdef Domain3d sub
  * 
  *         self.grid = 'physical'             # <<<<<<<<<<<<<<
  *         for sub in self.cdomains:
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   __Pyx_INCREF(__pyx_n_u_physical);
   __Pyx_GIVEREF(__pyx_n_u_physical);
   __Pyx_GOTREF(__pyx_v_self->grid);
   __Pyx_DECREF(__pyx_v_self->grid);
   __pyx_v_self->grid = __pyx_n_u_physical;
 
-  /* "libfds/fields.pyx":1437
+  /* "libfds/fields.pyx":1445
  * 
  *         self.grid = 'physical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 1437, __pyx_L1_error)
+    __PYX_ERR(0, 1445, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1437, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 1445, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1437, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1445, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1437, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 1445, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fields.pyx":1438
+    /* "libfds/fields.pyx":1446
  *         self.grid = 'physical'
  *         for sub in self.cdomains:
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _num2phys(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
     __pyx_f_6libfds_6fields_8Fields3d__num2phys(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/fields.pyx":1437
+    /* "libfds/fields.pyx":1445
  * 
  *         self.grid = 'physical'
  *         for sub in self.cdomains:             # <<<<<<<<<<<<<<
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fields.pyx":1432
+  /* "libfds/fields.pyx":1440
  *                         self.re[ix, iy, iz] /= self.J[ix, iy, iz]
  * 
  *     cdef void num2phys(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -34016,15 +34085,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fields.Fields3d.num2phys", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fields.pyx":1440
+/* "libfds/fields.pyx":1448
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _num2phys(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -34048,25 +34117,25 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   __Pyx_RefNannySetupContext("_num2phys", 0);
 
-  /* "libfds/fields.pyx":1444
+  /* "libfds/fields.pyx":1452
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fields.pyx":1445
+    /* "libfds/fields.pyx":1453
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -34099,99 +34168,99 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/fields.pyx":1446
+                              /* "libfds/fields.pyx":1454
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fields.pyx":1447
+                                /* "libfds/fields.pyx":1455
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fields.pyx":1448
+                                  /* "libfds/fields.pyx":1456
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_15 * __pyx_v_self->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->r.strides[1]) )) + __pyx_t_17)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-                                  /* "libfds/fields.pyx":1449
+                                  /* "libfds/fields.pyx":1457
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_17 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_15)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-                                  /* "libfds/fields.pyx":1450
+                                  /* "libfds/fields.pyx":1458
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_15 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_17)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-                                  /* "libfds/fields.pyx":1451
+                                  /* "libfds/fields.pyx":1459
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]
  *         else:
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_17 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_15)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-                                  /* "libfds/fields.pyx":1452
+                                  /* "libfds/fields.pyx":1460
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -34212,15 +34281,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fields.pyx":1445
+        /* "libfds/fields.pyx":1453
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -34231,122 +34300,122 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fields.pyx":1444
+    /* "libfds/fields.pyx":1452
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fields.pyx":1454
+  /* "libfds/fields.pyx":1462
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fields.pyx":1455
+      /* "libfds/fields.pyx":1463
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fields.pyx":1456
+        /* "libfds/fields.pyx":1464
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fields.pyx":1457
+          /* "libfds/fields.pyx":1465
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->r.data + __pyx_t_17 * __pyx_v_self->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->r.strides[1]) )) + __pyx_t_15)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-          /* "libfds/fields.pyx":1458
+          /* "libfds/fields.pyx":1466
  *                     for iz in range(izmin, izmax + 1):
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->ru.data + __pyx_t_15 * __pyx_v_self->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->ru.strides[1]) )) + __pyx_t_17)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-          /* "libfds/fields.pyx":1459
+          /* "libfds/fields.pyx":1467
  *                         self.r[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rv.data + __pyx_t_17 * __pyx_v_self->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rv.strides[1]) )) + __pyx_t_15)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
 
-          /* "libfds/fields.pyx":1460
+          /* "libfds/fields.pyx":1468
  *                         self.ru[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]
  * 
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->rw.data + __pyx_t_15 * __pyx_v_self->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->rw.strides[1]) )) + __pyx_t_17)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_12 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_14)) )));
 
-          /* "libfds/fields.pyx":1461
+          /* "libfds/fields.pyx":1469
  *                         self.rv[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.rw[ix, iy, iz] *= self.J[ix, iy, iz]
  *                         self.re[ix, iy, iz] *= self.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -34358,15 +34427,15 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->re.data + __pyx_t_17 * __pyx_v_self->re.strides[0]) ) + __pyx_t_16 * __pyx_v_self->re.strides[1]) )) + __pyx_t_15)) )) *= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->J.data + __pyx_t_14 * __pyx_v_self->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->J.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fields.pyx":1440
+  /* "libfds/fields.pyx":1448
  *             self._num2phys(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _num2phys(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -37401,15 +37470,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":1464
+/* "libfds/fields.pyx":1472
  * 
  * 
  * cpdef void update_p2d(double[:, ::1] p, double[:, ::1] r,             # <<<<<<<<<<<<<<
  *                      double[:, ::1] ru, double[:, ::1] rv, double[:, ::1] re,
  *                      double gamma):
  */
 
@@ -37438,106 +37507,106 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("update_p2d", 0);
 
-  /* "libfds/fields.pyx":1469
+  /* "libfds/fields.pyx":1477
  * 
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = p.shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t ny = p.shape[1]
  * 
  */
   __pyx_v_nx = (__pyx_v_p.shape[0]);
 
-  /* "libfds/fields.pyx":1470
+  /* "libfds/fields.pyx":1478
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = p.shape[0]
  *     cdef Py_ssize_t ny = p.shape[1]             # <<<<<<<<<<<<<<
  * 
  *     for ix in range(nx):
  */
   __pyx_v_ny = (__pyx_v_p.shape[1]);
 
-  /* "libfds/fields.pyx":1472
+  /* "libfds/fields.pyx":1480
  *     cdef Py_ssize_t ny = p.shape[1]
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         for iy in range(ny):
  *             p[ix, iy] = (re[ix, iy] - 0.5 * (ru[ix, iy] * ru[ix, iy] +
  */
   __pyx_t_1 = __pyx_v_nx;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_ix = __pyx_t_3;
 
-    /* "libfds/fields.pyx":1473
+    /* "libfds/fields.pyx":1481
  * 
  *     for ix in range(nx):
  *         for iy in range(ny):             # <<<<<<<<<<<<<<
  *             p[ix, iy] = (re[ix, iy] - 0.5 * (ru[ix, iy] * ru[ix, iy] +
  *                                     rv[ix, iy] * rv[ix, iy]) / r[ix, iy]) * (gamma-1)
  */
     __pyx_t_4 = __pyx_v_ny;
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_iy = __pyx_t_6;
 
-      /* "libfds/fields.pyx":1474
+      /* "libfds/fields.pyx":1482
  *     for ix in range(nx):
  *         for iy in range(ny):
  *             p[ix, iy] = (re[ix, iy] - 0.5 * (ru[ix, iy] * ru[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     rv[ix, iy] * rv[ix, iy]) / r[ix, iy]) * (gamma-1)
  * 
  */
       __pyx_t_7 = __pyx_v_ix;
       __pyx_t_8 = __pyx_v_iy;
       __pyx_t_9 = __pyx_v_ix;
       __pyx_t_10 = __pyx_v_iy;
       __pyx_t_11 = __pyx_v_ix;
       __pyx_t_12 = __pyx_v_iy;
 
-      /* "libfds/fields.pyx":1475
+      /* "libfds/fields.pyx":1483
  *         for iy in range(ny):
  *             p[ix, iy] = (re[ix, iy] - 0.5 * (ru[ix, iy] * ru[ix, iy] +
  *                                     rv[ix, iy] * rv[ix, iy]) / r[ix, iy]) * (gamma-1)             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_13 = __pyx_v_ix;
       __pyx_t_14 = __pyx_v_iy;
       __pyx_t_15 = __pyx_v_ix;
       __pyx_t_16 = __pyx_v_iy;
 
-      /* "libfds/fields.pyx":1474
+      /* "libfds/fields.pyx":1482
  *     for ix in range(nx):
  *         for iy in range(ny):
  *             p[ix, iy] = (re[ix, iy] - 0.5 * (ru[ix, iy] * ru[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     rv[ix, iy] * rv[ix, iy]) / r[ix, iy]) * (gamma-1)
  * 
  */
       __pyx_t_17 = __pyx_v_ix;
       __pyx_t_18 = __pyx_v_iy;
 
-      /* "libfds/fields.pyx":1475
+      /* "libfds/fields.pyx":1483
  *         for iy in range(ny):
  *             p[ix, iy] = (re[ix, iy] - 0.5 * (ru[ix, iy] * ru[ix, iy] +
  *                                     rv[ix, iy] * rv[ix, iy]) / r[ix, iy]) * (gamma-1)             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_19 = __pyx_v_ix;
       __pyx_t_20 = __pyx_v_iy;
       *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_p.data + __pyx_t_19 * __pyx_v_p.strides[0]) )) + __pyx_t_20)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_re.data + __pyx_t_7 * __pyx_v_re.strides[0]) )) + __pyx_t_8)) ))) - ((0.5 * (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_ru.data + __pyx_t_9 * __pyx_v_ru.strides[0]) )) + __pyx_t_10)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_ru.data + __pyx_t_11 * __pyx_v_ru.strides[0]) )) + __pyx_t_12)) )))) + ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_rv.data + __pyx_t_13 * __pyx_v_rv.strides[0]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_rv.data + __pyx_t_15 * __pyx_v_rv.strides[0]) )) + __pyx_t_16)) )))))) / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_r.data + __pyx_t_17 * __pyx_v_r.strides[0]) )) + __pyx_t_18)) ))))) * (__pyx_v_gamma - 1.0));
     }
   }
 
-  /* "libfds/fields.pyx":1464
+  /* "libfds/fields.pyx":1472
  * 
  * 
  * cpdef void update_p2d(double[:, ::1] p, double[:, ::1] r,             # <<<<<<<<<<<<<<
  *                      double[:, ::1] ru, double[:, ::1] rv, double[:, ::1] re,
  *                      double gamma):
  */
 
@@ -37587,64 +37656,64 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 1); __PYX_ERR(0, 1464, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 1); __PYX_ERR(0, 1472, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ru)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 2); __PYX_ERR(0, 1464, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 2); __PYX_ERR(0, 1472, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rv)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 3); __PYX_ERR(0, 1464, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 3); __PYX_ERR(0, 1472, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_re)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 4); __PYX_ERR(0, 1464, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 4); __PYX_ERR(0, 1472, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_gamma)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 5); __PYX_ERR(0, 1464, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, 5); __PYX_ERR(0, 1472, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_p2d") < 0)) __PYX_ERR(0, 1464, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_p2d") < 0)) __PYX_ERR(0, 1472, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 6) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
     }
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 1464, __pyx_L3_error)
-    __pyx_v_r = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 1464, __pyx_L3_error)
-    __pyx_v_ru = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_ru.memview)) __PYX_ERR(0, 1465, __pyx_L3_error)
-    __pyx_v_rv = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rv.memview)) __PYX_ERR(0, 1465, __pyx_L3_error)
-    __pyx_v_re = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_re.memview)) __PYX_ERR(0, 1465, __pyx_L3_error)
-    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1466, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 1472, __pyx_L3_error)
+    __pyx_v_r = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 1472, __pyx_L3_error)
+    __pyx_v_ru = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_ru.memview)) __PYX_ERR(0, 1473, __pyx_L3_error)
+    __pyx_v_rv = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rv.memview)) __PYX_ERR(0, 1473, __pyx_L3_error)
+    __pyx_v_re = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_re.memview)) __PYX_ERR(0, 1473, __pyx_L3_error)
+    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[5]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1474, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1464, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update_p2d", 1, 6, 6, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1472, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.update_p2d", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_2update_p2d(__pyx_self, __pyx_v_p, __pyx_v_r, __pyx_v_ru, __pyx_v_rv, __pyx_v_re, __pyx_v_gamma);
 
@@ -37658,15 +37727,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_p2d", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fields_update_p2d(__pyx_v_p, __pyx_v_r, __pyx_v_ru, __pyx_v_rv, __pyx_v_re, __pyx_v_gamma, 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1464, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fields_update_p2d(__pyx_v_p, __pyx_v_r, __pyx_v_ru, __pyx_v_rv, __pyx_v_re, __pyx_v_gamma, 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1472, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -37680,15 +37749,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_rv, 1);
   __PYX_XDEC_MEMVIEW(&__pyx_v_re, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fields.pyx":1478
+/* "libfds/fields.pyx":1486
  * 
  * 
  * cpdef void update_p3d(double[:, :, ::1] p, double[:, :, ::1] r,             # <<<<<<<<<<<<<<
  *                      double[:, :, ::1] ru, double[:, :, ::1] rv,
  *                      double[:, :, ::1] rw, double[:, :, ::1] re,
  */
 
@@ -37735,78 +37804,78 @@
   Py_ssize_t __pyx_t_32;
   Py_ssize_t __pyx_t_33;
   Py_ssize_t __pyx_t_34;
   Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
   __Pyx_RefNannySetupContext("update_p3d", 0);
 
-  /* "libfds/fields.pyx":1484
+  /* "libfds/fields.pyx":1492
  * 
  *     cdef Py_ssize_t ix, iy, iz
  *     cdef Py_ssize_t nx = p.shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t ny = p.shape[1]
  *     cdef Py_ssize_t nz = p.shape[2]
  */
   __pyx_v_nx = (__pyx_v_p.shape[0]);
 
-  /* "libfds/fields.pyx":1485
+  /* "libfds/fields.pyx":1493
  *     cdef Py_ssize_t ix, iy, iz
  *     cdef Py_ssize_t nx = p.shape[0]
  *     cdef Py_ssize_t ny = p.shape[1]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t nz = p.shape[2]
  * 
  */
   __pyx_v_ny = (__pyx_v_p.shape[1]);
 
-  /* "libfds/fields.pyx":1486
+  /* "libfds/fields.pyx":1494
  *     cdef Py_ssize_t nx = p.shape[0]
  *     cdef Py_ssize_t ny = p.shape[1]
  *     cdef Py_ssize_t nz = p.shape[2]             # <<<<<<<<<<<<<<
  * 
  *     for ix in range(nx):
  */
   __pyx_v_nz = (__pyx_v_p.shape[2]);
 
-  /* "libfds/fields.pyx":1488
+  /* "libfds/fields.pyx":1496
  *     cdef Py_ssize_t nz = p.shape[2]
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         for iy in range(ny):
  *             for iz in range(nz):
  */
   __pyx_t_1 = __pyx_v_nx;
   __pyx_t_2 = __pyx_t_1;
   for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3+=1) {
     __pyx_v_ix = __pyx_t_3;
 
-    /* "libfds/fields.pyx":1489
+    /* "libfds/fields.pyx":1497
  * 
  *     for ix in range(nx):
  *         for iy in range(ny):             # <<<<<<<<<<<<<<
  *             for iz in range(nz):
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +
  */
     __pyx_t_4 = __pyx_v_ny;
     __pyx_t_5 = __pyx_t_4;
     for (__pyx_t_6 = 0; __pyx_t_6 < __pyx_t_5; __pyx_t_6+=1) {
       __pyx_v_iy = __pyx_t_6;
 
-      /* "libfds/fields.pyx":1490
+      /* "libfds/fields.pyx":1498
  *     for ix in range(nx):
  *         for iy in range(ny):
  *             for iz in range(nz):             # <<<<<<<<<<<<<<
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +
  *                                     rv[ix, iy, iz] * rv[ix, iy, iz] +
  */
       __pyx_t_7 = __pyx_v_nz;
       __pyx_t_8 = __pyx_t_7;
       for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
         __pyx_v_iz = __pyx_t_9;
 
-        /* "libfds/fields.pyx":1491
+        /* "libfds/fields.pyx":1499
  *         for iy in range(ny):
  *             for iz in range(nz):
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                     rv[ix, iy, iz] * rv[ix, iy, iz] +
  *                                     rw[ix, iy, iz] * rw[ix, iy, iz]) / r[ix, iy, iz]) * (gamma-1)
  */
         __pyx_t_10 = __pyx_v_ix;
@@ -37815,64 +37884,64 @@
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         __pyx_t_15 = __pyx_v_iz;
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_17 = __pyx_v_iy;
         __pyx_t_18 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1492
+        /* "libfds/fields.pyx":1500
  *             for iz in range(nz):
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +
  *                                     rv[ix, iy, iz] * rv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                     rw[ix, iy, iz] * rw[ix, iy, iz]) / r[ix, iy, iz]) * (gamma-1)
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_20 = __pyx_v_iy;
         __pyx_t_21 = __pyx_v_iz;
         __pyx_t_22 = __pyx_v_ix;
         __pyx_t_23 = __pyx_v_iy;
         __pyx_t_24 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1493
+        /* "libfds/fields.pyx":1501
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +
  *                                     rv[ix, iy, iz] * rv[ix, iy, iz] +
  *                                     rw[ix, iy, iz] * rw[ix, iy, iz]) / r[ix, iy, iz]) * (gamma-1)             # <<<<<<<<<<<<<<
  */
         __pyx_t_25 = __pyx_v_ix;
         __pyx_t_26 = __pyx_v_iy;
         __pyx_t_27 = __pyx_v_iz;
         __pyx_t_28 = __pyx_v_ix;
         __pyx_t_29 = __pyx_v_iy;
         __pyx_t_30 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1491
+        /* "libfds/fields.pyx":1499
  *         for iy in range(ny):
  *             for iz in range(nz):
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                     rv[ix, iy, iz] * rv[ix, iy, iz] +
  *                                     rw[ix, iy, iz] * rw[ix, iy, iz]) / r[ix, iy, iz]) * (gamma-1)
  */
         __pyx_t_31 = __pyx_v_ix;
         __pyx_t_32 = __pyx_v_iy;
         __pyx_t_33 = __pyx_v_iz;
 
-        /* "libfds/fields.pyx":1493
+        /* "libfds/fields.pyx":1501
  *                 p[ix, iy, iz] = (re[ix, iy, iz] - 0.5 * (ru[ix, iy, iz] * ru[ix, iy, iz] +
  *                                     rv[ix, iy, iz] * rv[ix, iy, iz] +
  *                                     rw[ix, iy, iz] * rw[ix, iy, iz]) / r[ix, iy, iz]) * (gamma-1)             # <<<<<<<<<<<<<<
  */
         __pyx_t_34 = __pyx_v_ix;
         __pyx_t_35 = __pyx_v_iy;
         __pyx_t_36 = __pyx_v_iz;
         *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_p.data + __pyx_t_34 * __pyx_v_p.strides[0]) ) + __pyx_t_35 * __pyx_v_p.strides[1]) )) + __pyx_t_36)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_re.data + __pyx_t_10 * __pyx_v_re.strides[0]) ) + __pyx_t_11 * __pyx_v_re.strides[1]) )) + __pyx_t_12)) ))) - ((0.5 * ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ru.data + __pyx_t_13 * __pyx_v_ru.strides[0]) ) + __pyx_t_14 * __pyx_v_ru.strides[1]) )) + __pyx_t_15)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_ru.data + __pyx_t_16 * __pyx_v_ru.strides[0]) ) + __pyx_t_17 * __pyx_v_ru.strides[1]) )) + __pyx_t_18)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rv.data + __pyx_t_19 * __pyx_v_rv.strides[0]) ) + __pyx_t_20 * __pyx_v_rv.strides[1]) )) + __pyx_t_21)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rv.data + __pyx_t_22 * __pyx_v_rv.strides[0]) ) + __pyx_t_23 * __pyx_v_rv.strides[1]) )) + __pyx_t_24)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rw.data + __pyx_t_25 * __pyx_v_rw.strides[0]) ) + __pyx_t_26 * __pyx_v_rw.strides[1]) )) + __pyx_t_27)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_rw.data + __pyx_t_28 * __pyx_v_rw.strides[0]) ) + __pyx_t_29 * __pyx_v_rw.strides[1]) )) + __pyx_t_30)) )))))) / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_r.data + __pyx_t_31 * __pyx_v_r.strides[0]) ) + __pyx_t_32 * __pyx_v_r.strides[1]) )) + __pyx_t_33)) ))))) * (__pyx_v_gamma - 1.0));
       }
     }
   }
 
-  /* "libfds/fields.pyx":1478
+  /* "libfds/fields.pyx":1486
  * 
  * 
  * cpdef void update_p3d(double[:, :, ::1] p, double[:, :, ::1] r,             # <<<<<<<<<<<<<<
  *                      double[:, :, ::1] ru, double[:, :, ::1] rv,
  *                      double[:, :, ::1] rw, double[:, :, ::1] re,
  */
 
@@ -37925,72 +37994,72 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_p)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_r)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 1); __PYX_ERR(0, 1478, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 1); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_ru)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 2); __PYX_ERR(0, 1478, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 2); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (likely((values[3] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rv)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 3); __PYX_ERR(0, 1478, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 3); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  4:
         if (likely((values[4] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_rw)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 4); __PYX_ERR(0, 1478, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 4); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  5:
         if (likely((values[5] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_re)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 5); __PYX_ERR(0, 1478, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 5); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  6:
         if (likely((values[6] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_gamma)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 6); __PYX_ERR(0, 1478, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, 6); __PYX_ERR(0, 1486, __pyx_L3_error)
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_p3d") < 0)) __PYX_ERR(0, 1478, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "update_p3d") < 0)) __PYX_ERR(0, 1486, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 7) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
       values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
       values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
       values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
       values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
       values[5] = PyTuple_GET_ITEM(__pyx_args, 5);
       values[6] = PyTuple_GET_ITEM(__pyx_args, 6);
     }
-    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 1478, __pyx_L3_error)
-    __pyx_v_r = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 1478, __pyx_L3_error)
-    __pyx_v_ru = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_ru.memview)) __PYX_ERR(0, 1479, __pyx_L3_error)
-    __pyx_v_rv = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rv.memview)) __PYX_ERR(0, 1479, __pyx_L3_error)
-    __pyx_v_rw = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rw.memview)) __PYX_ERR(0, 1480, __pyx_L3_error)
-    __pyx_v_re = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_re.memview)) __PYX_ERR(0, 1480, __pyx_L3_error)
-    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1481, __pyx_L3_error)
+    __pyx_v_p = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_p.memview)) __PYX_ERR(0, 1486, __pyx_L3_error)
+    __pyx_v_r = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[1], PyBUF_WRITABLE); if (unlikely(!__pyx_v_r.memview)) __PYX_ERR(0, 1486, __pyx_L3_error)
+    __pyx_v_ru = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[2], PyBUF_WRITABLE); if (unlikely(!__pyx_v_ru.memview)) __PYX_ERR(0, 1487, __pyx_L3_error)
+    __pyx_v_rv = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[3], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rv.memview)) __PYX_ERR(0, 1487, __pyx_L3_error)
+    __pyx_v_rw = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[4], PyBUF_WRITABLE); if (unlikely(!__pyx_v_rw.memview)) __PYX_ERR(0, 1488, __pyx_L3_error)
+    __pyx_v_re = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(values[5], PyBUF_WRITABLE); if (unlikely(!__pyx_v_re.memview)) __PYX_ERR(0, 1488, __pyx_L3_error)
+    __pyx_v_gamma = __pyx_PyFloat_AsDouble(values[6]); if (unlikely((__pyx_v_gamma == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1489, __pyx_L3_error)
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1478, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("update_p3d", 1, 7, 7, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 1486, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fields.update_p3d", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fields_4update_p3d(__pyx_self, __pyx_v_p, __pyx_v_r, __pyx_v_ru, __pyx_v_rv, __pyx_v_rw, __pyx_v_re, __pyx_v_gamma);
 
@@ -38004,15 +38073,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("update_p3d", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fields_update_p3d(__pyx_v_p, __pyx_v_r, __pyx_v_ru, __pyx_v_rv, __pyx_v_rw, __pyx_v_re, __pyx_v_gamma, 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1478, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fields_update_p3d(__pyx_v_p, __pyx_v_r, __pyx_v_ru, __pyx_v_rv, __pyx_v_rw, __pyx_v_re, __pyx_v_gamma, 0)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1486, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -57265,15 +57334,15 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 
 static PyMethodDef __pyx_methods[] = {
-  {"Fields", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_6fields_1Fields, METH_VARARGS|METH_KEYWORDS, 0},
+  {"Fields", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_6fields_1Fields, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6libfds_6fields_Fields},
   {"update_p2d", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_6fields_3update_p2d, METH_VARARGS|METH_KEYWORDS, 0},
   {"update_p3d", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_6fields_5update_p3d, METH_VARARGS|METH_KEYWORDS, 0},
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
@@ -57317,21 +57386,21 @@
 #endif
 
 static __Pyx_StringTabEntry __pyx_string_tab[] = {
   {&__pyx_n_u_A, __pyx_k_A, sizeof(__pyx_k_A), 0, 1, 0, 1},
   {&__pyx_n_s_ASCII, __pyx_k_ASCII, sizeof(__pyx_k_ASCII), 0, 0, 1, 1},
   {&__pyx_n_s_B0, __pyx_k_B0, sizeof(__pyx_k_B0), 0, 0, 1, 1},
   {&__pyx_kp_s_Buffer_view_does_not_expose_stri, __pyx_k_Buffer_view_does_not_expose_stri, sizeof(__pyx_k_Buffer_view_does_not_expose_stri), 0, 0, 1, 0},
-  {&__pyx_n_s_CP, __pyx_k_CP, sizeof(__pyx_k_CP), 0, 0, 1, 1},
-  {&__pyx_n_s_CV, __pyx_k_CV, sizeof(__pyx_k_CV), 0, 0, 1, 1},
   {&__pyx_kp_s_Can_only_create_a_buffer_that_is, __pyx_k_Can_only_create_a_buffer_that_is, sizeof(__pyx_k_Can_only_create_a_buffer_that_is), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_assign_to_read_only_memor, __pyx_k_Cannot_assign_to_read_only_memor, sizeof(__pyx_k_Cannot_assign_to_read_only_memor), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_create_writable_memory_vi, __pyx_k_Cannot_create_writable_memory_vi, sizeof(__pyx_k_Cannot_create_writable_memory_vi), 0, 0, 1, 0},
   {&__pyx_kp_s_Cannot_index_with_type_s, __pyx_k_Cannot_index_with_type_s, sizeof(__pyx_k_Cannot_index_with_type_s), 0, 0, 1, 0},
   {&__pyx_kp_u_Coordinates, __pyx_k_Coordinates, sizeof(__pyx_k_Coordinates), 0, 1, 0, 0},
+  {&__pyx_n_s_Cp, __pyx_k_Cp, sizeof(__pyx_k_Cp), 0, 0, 1, 1},
+  {&__pyx_n_s_Cv, __pyx_k_Cv, sizeof(__pyx_k_Cv), 0, 0, 1, 1},
   {&__pyx_n_s_Domain2d, __pyx_k_Domain2d, sizeof(__pyx_k_Domain2d), 0, 0, 1, 1},
   {&__pyx_n_s_Domain3d, __pyx_k_Domain3d, sizeof(__pyx_k_Domain3d), 0, 0, 1, 1},
   {&__pyx_n_s_Ellipsis, __pyx_k_Ellipsis, sizeof(__pyx_k_Ellipsis), 0, 0, 1, 1},
   {&__pyx_kp_s_Empty_shape_tuple_for_cython_arr, __pyx_k_Empty_shape_tuple_for_cython_arr, sizeof(__pyx_k_Empty_shape_tuple_for_cython_arr), 0, 0, 1, 0},
   {&__pyx_n_s_Face2d, __pyx_k_Face2d, sizeof(__pyx_k_Face2d), 0, 0, 1, 1},
   {&__pyx_n_s_Face3d, __pyx_k_Face3d, sizeof(__pyx_k_Face3d), 0, 0, 1, 1},
   {&__pyx_n_u_False, __pyx_k_False, sizeof(__pyx_k_False), 0, 1, 0, 1},
@@ -57516,14 +57585,15 @@
   {&__pyx_kp_s_strided_and_direct, __pyx_k_strided_and_direct, sizeof(__pyx_k_strided_and_direct), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_direct_or_indirect, __pyx_k_strided_and_direct_or_indirect, sizeof(__pyx_k_strided_and_direct_or_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_strided_and_indirect, __pyx_k_strided_and_indirect, sizeof(__pyx_k_strided_and_indirect), 0, 0, 1, 0},
   {&__pyx_kp_s_stringsource, __pyx_k_stringsource, sizeof(__pyx_k_stringsource), 0, 0, 1, 0},
   {&__pyx_n_s_struct, __pyx_k_struct, sizeof(__pyx_k_struct), 0, 0, 1, 1},
   {&__pyx_n_s_tag, __pyx_k_tag, sizeof(__pyx_k_tag), 0, 0, 1, 1},
   {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
+  {&__pyx_n_s_tp, __pyx_k_tp, sizeof(__pyx_k_tp), 0, 0, 1, 1},
   {&__pyx_kp_s_unable_to_allocate_array_data, __pyx_k_unable_to_allocate_array_data, sizeof(__pyx_k_unable_to_allocate_array_data), 0, 0, 1, 0},
   {&__pyx_kp_s_unable_to_allocate_shape_and_str, __pyx_k_unable_to_allocate_shape_and_str, sizeof(__pyx_k_unable_to_allocate_shape_and_str), 0, 0, 1, 0},
   {&__pyx_n_s_unpack, __pyx_k_unpack, sizeof(__pyx_k_unpack), 0, 0, 1, 1},
   {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
   {&__pyx_n_u_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 1, 0, 1},
   {&__pyx_n_s_vrt, __pyx_k_vrt, sizeof(__pyx_k_vrt), 0, 0, 1, 1},
   {&__pyx_n_s_vsc, __pyx_k_vsc, sizeof(__pyx_k_vsc), 0, 0, 1, 1},
@@ -57673,102 +57743,102 @@
  * def __setstate_cython__(self, __pyx_state):
  *     raise TypeError("no default __reduce__ due to non-trivial __cinit__")             # <<<<<<<<<<<<<<
  */
   __pyx_tuple__13 = PyTuple_Pack(1, __pyx_kp_s_no_default___reduce___due_to_non); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(1, 4, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__13);
   __Pyx_GIVEREF(__pyx_tuple__13);
 
-  /* "libfds/fields.pyx":398
+  /* "libfds/fields.pyx":406
  * 
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:             # <<<<<<<<<<<<<<
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_slice__14 = PySlice_New(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__14)) __PYX_ERR(0, 398, __pyx_L1_error)
+  __pyx_slice__14 = PySlice_New(Py_None, __pyx_int_2, Py_None); if (unlikely(!__pyx_slice__14)) __PYX_ERR(0, 406, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__14);
   __Pyx_GIVEREF(__pyx_slice__14);
 
-  /* "libfds/fields.pyx":399
+  /* "libfds/fields.pyx":407
  *         # Periodic BC (SG: 3 pts / SC : 5 pts)
  *         if 'P' in self.msh.bc[:2]:
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))             # <<<<<<<<<<<<<<
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  */
-  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_int_5); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 399, __pyx_L1_error)
+  __pyx_tuple__15 = PyTuple_Pack(1, __pyx_int_5); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 407, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__15);
   __Pyx_GIVEREF(__pyx_tuple__15);
 
-  /* "libfds/fields.pyx":401
+  /* "libfds/fields.pyx":409
  *             self.P11x = _np.array(list(range(self.nx - 5, self.nx)) + list(range(self.nx)) + list(range(5)))
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))             # <<<<<<<<<<<<<<
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  */
-  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_int_1); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 401, __pyx_L1_error)
+  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_int_1); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 409, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__16);
   __Pyx_GIVEREF(__pyx_tuple__16);
 
-  /* "libfds/fields.pyx":402
+  /* "libfds/fields.pyx":410
  *             if self.cfg.cpt:
  *                 self.P3x = _np.array(list(range(self.nx - 1, self.nx)) + list(range(self.nx)) + list(range(1)))
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))             # <<<<<<<<<<<<<<
  * 
  *         if 'P' in self.msh.bc[2:]:
  */
-  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_int_2); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 402, __pyx_L1_error)
+  __pyx_tuple__17 = PyTuple_Pack(1, __pyx_int_2); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 410, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__17);
   __Pyx_GIVEREF(__pyx_tuple__17);
 
-  /* "libfds/fields.pyx":404
+  /* "libfds/fields.pyx":412
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[2:]:             # <<<<<<<<<<<<<<
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_slice__18 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__18)) __PYX_ERR(0, 404, __pyx_L1_error)
+  __pyx_slice__18 = PySlice_New(__pyx_int_2, Py_None, Py_None); if (unlikely(!__pyx_slice__18)) __PYX_ERR(0, 412, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__18);
   __Pyx_GIVEREF(__pyx_slice__18);
 
-  /* "libfds/fields.pyx":448
+  /* "libfds/fields.pyx":456
  *             self.wz = _np.zeros_like(self.p)
  *         else:
  *             self.wz = _np.zeros((0, ) * len(self.msh.shape))   # Because it's public!             # <<<<<<<<<<<<<<
  * 
  *         # Initial pulses
  */
-  __pyx_tuple__20 = PyTuple_New(1); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 448, __pyx_L1_error)
+  __pyx_tuple__20 = PyTuple_New(1); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 456, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_tuple__20);
   __Pyx_INCREF(__pyx_int_0);
   __Pyx_GIVEREF(__pyx_int_0);
   PyTuple_SET_ITEM(__pyx_tuple__20, 0, __pyx_int_0);
   __Pyx_GIVEREF(__pyx_tuple__20);
 
-  /* "libfds/fields.pyx":920
+  /* "libfds/fields.pyx":928
  *                 self.P5x = _np.array(list(range(self.nx - 2, self.nx)) + list(range(self.nx)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[2:4]:             # <<<<<<<<<<<<<<
  *             self.P11y = _np.array(list(range(self.ny - 5, self.ny)) + list(range(self.ny)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_slice__21 = PySlice_New(__pyx_int_2, __pyx_int_4, Py_None); if (unlikely(!__pyx_slice__21)) __PYX_ERR(0, 920, __pyx_L1_error)
+  __pyx_slice__21 = PySlice_New(__pyx_int_2, __pyx_int_4, Py_None); if (unlikely(!__pyx_slice__21)) __PYX_ERR(0, 928, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__21);
   __Pyx_GIVEREF(__pyx_slice__21);
 
-  /* "libfds/fields.pyx":926
+  /* "libfds/fields.pyx":934
  *                 self.P5y = _np.array(list(range(self.ny - 2, self.ny)) + list(range(self.ny)) + list(range(2)))
  * 
  *         if 'P' in self.msh.bc[4:]:             # <<<<<<<<<<<<<<
  *             self.P11z = _np.array(list(range(self.nz - 5, self.nz)) + list(range(self.nz)) + list(range(5)))
  *             if self.cfg.cpt:
  */
-  __pyx_slice__22 = PySlice_New(__pyx_int_4, Py_None, Py_None); if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 926, __pyx_L1_error)
+  __pyx_slice__22 = PySlice_New(__pyx_int_4, Py_None, Py_None); if (unlikely(!__pyx_slice__22)) __PYX_ERR(0, 934, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_slice__22);
   __Pyx_GIVEREF(__pyx_slice__22);
 
   /* "(tree fragment)":4
  *     cdef object __pyx_PickleError
  *     cdef object __pyx_result
  *     if __pyx_checksum not in (0xf0a1c33, 0x736324e, 0x6de3fe0):             # <<<<<<<<<<<<<<
@@ -58199,53 +58269,53 @@
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Face3d.tp_dictoffset && __pyx_type_6libfds_6fields_Face3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Face3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   if (__Pyx_SetVtable(__pyx_type_6libfds_6fields_Face3d.tp_dict, __pyx_vtabptr_6libfds_6fields_Face3d) < 0) __PYX_ERR(0, 131, __pyx_L1_error)
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Face3d, (PyObject *)&__pyx_type_6libfds_6fields_Face3d) < 0) __PYX_ERR(0, 131, __pyx_L1_error)
   if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Face3d) < 0) __PYX_ERR(0, 131, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Face3d = &__pyx_type_6libfds_6fields_Face3d;
-  if (PyType_Ready(&__pyx_type_6libfds_6fields_Monopole2d) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fields_Monopole2d) < 0) __PYX_ERR(0, 284, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fields_Monopole2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Monopole2d.tp_dictoffset && __pyx_type_6libfds_6fields_Monopole2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Monopole2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Monopole2d, (PyObject *)&__pyx_type_6libfds_6fields_Monopole2d) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Monopole2d) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Monopole2d, (PyObject *)&__pyx_type_6libfds_6fields_Monopole2d) < 0) __PYX_ERR(0, 284, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Monopole2d) < 0) __PYX_ERR(0, 284, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Monopole2d = &__pyx_type_6libfds_6fields_Monopole2d;
-  if (PyType_Ready(&__pyx_type_6libfds_6fields_Monopole3d) < 0) __PYX_ERR(0, 292, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fields_Monopole3d) < 0) __PYX_ERR(0, 293, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fields_Monopole3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Monopole3d.tp_dictoffset && __pyx_type_6libfds_6fields_Monopole3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Monopole3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Monopole3d, (PyObject *)&__pyx_type_6libfds_6fields_Monopole3d) < 0) __PYX_ERR(0, 292, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Monopole3d) < 0) __PYX_ERR(0, 292, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Monopole3d, (PyObject *)&__pyx_type_6libfds_6fields_Monopole3d) < 0) __PYX_ERR(0, 293, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Monopole3d) < 0) __PYX_ERR(0, 293, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Monopole3d = &__pyx_type_6libfds_6fields_Monopole3d;
   if (PyType_Ready(&__pyx_type_6libfds_6fields_Domain2d) < 0) __PYX_ERR(0, 231, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fields_Domain2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Domain2d.tp_dictoffset && __pyx_type_6libfds_6fields_Domain2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Domain2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
   if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Domain2d, (PyObject *)&__pyx_type_6libfds_6fields_Domain2d) < 0) __PYX_ERR(0, 231, __pyx_L1_error)
   if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Domain2d) < 0) __PYX_ERR(0, 231, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Domain2d = &__pyx_type_6libfds_6fields_Domain2d;
-  if (PyType_Ready(&__pyx_type_6libfds_6fields_Domain3d) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fields_Domain3d) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fields_Domain3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Domain3d.tp_dictoffset && __pyx_type_6libfds_6fields_Domain3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Domain3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Domain3d, (PyObject *)&__pyx_type_6libfds_6fields_Domain3d) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Domain3d) < 0) __PYX_ERR(0, 256, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Domain3d, (PyObject *)&__pyx_type_6libfds_6fields_Domain3d) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Domain3d) < 0) __PYX_ERR(0, 257, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Domain3d = &__pyx_type_6libfds_6fields_Domain3d;
   __pyx_vtabptr_6libfds_6fields_Fields2d = &__pyx_vtable_6libfds_6fields_Fields2d;
   __pyx_vtable_6libfds_6fields_Fields2d.init_parameters = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_init_parameters;
   __pyx_vtable_6libfds_6fields_Fields2d.init_grid = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_init_grid;
   __pyx_vtable_6libfds_6fields_Fields2d.init_spacial_steps = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_init_spacial_steps;
   __pyx_vtable_6libfds_6fields_Fields2d.init_bc = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_init_bc;
   __pyx_vtable_6libfds_6fields_Fields2d.init_subdomains = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_init_subdomains;
@@ -58267,24 +58337,24 @@
   __pyx_vtable_6libfds_6fields_Fields2d.residual = (double (*)(struct __pyx_obj_6libfds_6fields_Fields2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fields_8Fields2d_residual;
   __pyx_vtable_6libfds_6fields_Fields2d._residual = (double (*)(struct __pyx_obj_6libfds_6fields_Fields2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fields_8Fields2d__residual;
   __pyx_vtable_6libfds_6fields_Fields2d.get_velocity = (PyObject *(*)(struct __pyx_obj_6libfds_6fields_Fields2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fields_8Fields2d_get_velocity;
   __pyx_vtable_6libfds_6fields_Fields2d.phys2num = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_phys2num;
   __pyx_vtable_6libfds_6fields_Fields2d._phys2num = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fields_8Fields2d__phys2num;
   __pyx_vtable_6libfds_6fields_Fields2d.num2phys = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *))__pyx_f_6libfds_6fields_8Fields2d_num2phys;
   __pyx_vtable_6libfds_6fields_Fields2d._num2phys = (void (*)(struct __pyx_obj_6libfds_6fields_Fields2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fields_8Fields2d__num2phys;
-  if (PyType_Ready(&__pyx_type_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 310, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 318, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fields_Fields2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Fields2d.tp_dictoffset && __pyx_type_6libfds_6fields_Fields2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Fields2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_6fields_Fields2d.tp_dict, __pyx_vtabptr_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 310, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Fields2d, (PyObject *)&__pyx_type_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 310, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 310, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_6fields_Fields2d.tp_dict, __pyx_vtabptr_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 318, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Fields2d, (PyObject *)&__pyx_type_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 318, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Fields2d) < 0) __PYX_ERR(0, 318, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Fields2d = &__pyx_type_6libfds_6fields_Fields2d;
   __pyx_vtabptr_6libfds_6fields_Fields3d = &__pyx_vtable_6libfds_6fields_Fields3d;
   __pyx_vtable_6libfds_6fields_Fields3d.init_parameters = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_init_parameters;
   __pyx_vtable_6libfds_6fields_Fields3d.init_grid = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_init_grid;
   __pyx_vtable_6libfds_6fields_Fields3d.init_spacial_steps = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_init_spacial_steps;
   __pyx_vtable_6libfds_6fields_Fields3d.init_bc = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_init_bc;
   __pyx_vtable_6libfds_6fields_Fields3d.init_subdomains = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_init_subdomains;
@@ -58308,24 +58378,24 @@
   __pyx_vtable_6libfds_6fields_Fields3d.residual = (double (*)(struct __pyx_obj_6libfds_6fields_Fields3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fields_8Fields3d_residual;
   __pyx_vtable_6libfds_6fields_Fields3d._residual = (double (*)(struct __pyx_obj_6libfds_6fields_Fields3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fields_8Fields3d__residual;
   __pyx_vtable_6libfds_6fields_Fields3d.get_velocity = (PyObject *(*)(struct __pyx_obj_6libfds_6fields_Fields3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fields_8Fields3d_get_velocity;
   __pyx_vtable_6libfds_6fields_Fields3d.phys2num = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_phys2num;
   __pyx_vtable_6libfds_6fields_Fields3d._phys2num = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fields_8Fields3d__phys2num;
   __pyx_vtable_6libfds_6fields_Fields3d.num2phys = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *))__pyx_f_6libfds_6fields_8Fields3d_num2phys;
   __pyx_vtable_6libfds_6fields_Fields3d._num2phys = (void (*)(struct __pyx_obj_6libfds_6fields_Fields3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fields_8Fields3d__num2phys;
-  if (PyType_Ready(&__pyx_type_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fields_Fields3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fields_Fields3d.tp_dictoffset && __pyx_type_6libfds_6fields_Fields3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fields_Fields3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_6fields_Fields3d.tp_dict, __pyx_vtabptr_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Fields3d, (PyObject *)&__pyx_type_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 813, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_6fields_Fields3d.tp_dict, __pyx_vtabptr_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Fields3d, (PyObject *)&__pyx_type_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fields_Fields3d) < 0) __PYX_ERR(0, 821, __pyx_L1_error)
   __pyx_ptype_6libfds_6fields_Fields3d = &__pyx_type_6libfds_6fields_Fields3d;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
```

### Comparing `libfds-0.1.0/libfds/filters.c` & `libfds-0.2.0/libfds/filters.c`

 * *Files 1% similar despite different names*

```diff
@@ -2383,71 +2383,71 @@
   void (*_fxm)(struct __pyx_obj_6libfds_7libfilt_LF3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int, int __pyx_skip_dispatch);
   void (*_fym)(struct __pyx_obj_6libfds_7libfilt_LF3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int, int __pyx_skip_dispatch);
   void (*_fzm)(struct __pyx_obj_6libfds_7libfilt_LF3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_6libfds_7libfilt_LF3d *__pyx_vtabptr_6libfds_7libfilt_LF3d;
 
 
-/* "libfds/filters.pyx":73
+/* "libfds/filters.pyx":97
  * 
  * @cython.final
  * cdef class _SelectiveFilter2d:             # <<<<<<<<<<<<<<
- *     """ Selective Filter. (Bogey & al. --)
- *     """
+ *     """ 2d Selective Filter calculated using technique described in [1]_.
+ * 
  */
 
 struct __pyx_vtabstruct_6libfds_7filters__SelectiveFilter2d {
   void (*apply)(struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *, int __pyx_skip_dispatch);
   void (*_update)(struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 };
 static struct __pyx_vtabstruct_6libfds_7filters__SelectiveFilter2d *__pyx_vtabptr_6libfds_7filters__SelectiveFilter2d;
 static void __pyx_f_6libfds_7filters_18_SelectiveFilter2d_apply(struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_7filters_18_SelectiveFilter2d__update(struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/filters.pyx":153
+/* "libfds/filters.pyx":188
  * 
  * @cython.final
  * cdef class _SelectiveFilter3d:             # <<<<<<<<<<<<<<
- *     """ Selective Filter. (Bogey & al. --)
- *     """
+ *     """ 3d Selective Filter calculated using technique described in [1]_.
+ * 
  */
 
 struct __pyx_vtabstruct_6libfds_7filters__SelectiveFilter3d {
   void (*apply)(struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *, int __pyx_skip_dispatch);
   void (*_update)(struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 };
 static struct __pyx_vtabstruct_6libfds_7filters__SelectiveFilter3d *__pyx_vtabptr_6libfds_7filters__SelectiveFilter3d;
 static void __pyx_f_6libfds_7filters_18_SelectiveFilter3d_apply(struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_7filters_18_SelectiveFilter3d__update(struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/filters.pyx":265
+/* "libfds/filters.pyx":311
  * 
  * @cython.final
  * cdef class _ShockCapture2d:             # <<<<<<<<<<<<<<
- *     """ Shock Capturing procedure. (Bogey & al. -- JCP 228 -- 2009)
- *     """
+ *     """ 2d Shock capture procedure calculated using technique described in [1]_.
+ * 
  */
 
 struct __pyx_vtabstruct_6libfds_7filters__ShockCapture2d {
   void (*apply)(struct __pyx_obj_6libfds_7filters__ShockCapture2d *, int __pyx_skip_dispatch);
   void (*_update)(struct __pyx_obj_6libfds_7filters__ShockCapture2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 };
 static struct __pyx_vtabstruct_6libfds_7filters__ShockCapture2d *__pyx_vtabptr_6libfds_7filters__ShockCapture2d;
 static void __pyx_f_6libfds_7filters_15_ShockCapture2d_apply(struct __pyx_obj_6libfds_7filters__ShockCapture2d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_7filters_15_ShockCapture2d__update(struct __pyx_obj_6libfds_7filters__ShockCapture2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/filters.pyx":353
+/* "libfds/filters.pyx":410
  * 
  * @cython.final
  * cdef class _ShockCapture3d:             # <<<<<<<<<<<<<<
- *     """ Shock Capturing procedure. (Bogey & al. -- JCP 228 -- 2009)
- *     """
+ *     """ 3d Shock capture procedure calculated using technique described in [1]_.
+ * 
  */
 
 struct __pyx_vtabstruct_6libfds_7filters__ShockCapture3d {
   void (*apply)(struct __pyx_obj_6libfds_7filters__ShockCapture3d *, int __pyx_skip_dispatch);
   void (*_update)(struct __pyx_obj_6libfds_7filters__ShockCapture3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 };
 static struct __pyx_vtabstruct_6libfds_7filters__ShockCapture3d *__pyx_vtabptr_6libfds_7filters__ShockCapture3d;
@@ -3752,84 +3752,84 @@
 static PyObject *__pyx_codeobj__36;
 /* Late includes */
 
 /* "libfds/filters.pyx":58
  * 
  * 
  * cpdef SelectiveFilter(fld):             # <<<<<<<<<<<<<<
+ *     """ Selective Filter calculated using technique described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
 static PyObject *__pyx_pw_6libfds_7filters_1SelectiveFilter(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
 static PyObject *__pyx_f_6libfds_7filters_SelectiveFilter(PyObject *__pyx_v_fld, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("SelectiveFilter", 0);
 
-  /* "libfds/filters.pyx":60
- * cpdef SelectiveFilter(fld):
- * 
+  /* "libfds/filters.pyx":72
+ *         Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _SelectiveFilter2d(fld)
- * 
+ *     return _SelectiveFilter3d(fld)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/filters.pyx":61
- * 
+    /* "libfds/filters.pyx":73
+ *     """
  *     if isinstance(fld, Fields2d):
  *         return _SelectiveFilter2d(fld)             # <<<<<<<<<<<<<<
- * 
  *     return _SelectiveFilter3d(fld)
+ * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__SelectiveFilter2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__SelectiveFilter2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 73, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "libfds/filters.pyx":60
- * cpdef SelectiveFilter(fld):
- * 
+    /* "libfds/filters.pyx":72
+ *         Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _SelectiveFilter2d(fld)
- * 
+ *     return _SelectiveFilter3d(fld)
  */
   }
 
-  /* "libfds/filters.pyx":63
+  /* "libfds/filters.pyx":74
+ *     if isinstance(fld, Fields2d):
  *         return _SelectiveFilter2d(fld)
- * 
  *     return _SelectiveFilter3d(fld)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__SelectiveFilter3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 63, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__SelectiveFilter3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 74, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
   /* "libfds/filters.pyx":58
  * 
  * 
  * cpdef SelectiveFilter(fld):             # <<<<<<<<<<<<<<
+ *     """ Selective Filter calculated using technique described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("libfds.filters.SelectiveFilter", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
@@ -3837,14 +3837,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_7filters_1SelectiveFilter(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
+static char __pyx_doc_6libfds_7filters_SelectiveFilter[] = " Selective Filter calculated using technique described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d or Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n        flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n        Pages 194-214.\n    ";
 static PyObject *__pyx_pw_6libfds_7filters_1SelectiveFilter(PyObject *__pyx_self, PyObject *__pyx_v_fld) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("SelectiveFilter (wrapper)", 0);
   __pyx_r = __pyx_pf_6libfds_7filters_SelectiveFilter(__pyx_self, ((PyObject *)__pyx_v_fld));
 
   /* function exit code */
@@ -3874,88 +3875,88 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":66
+/* "libfds/filters.pyx":77
  * 
  * 
  * cpdef ShockCapture(fld):             # <<<<<<<<<<<<<<
- *     if isinstance(fld, Fields2d):
- *         return _ShockCapture2d(fld)
+ *     """ Shock capture procedure calculated using technique described in [1]_.
+ * 
  */
 
 static PyObject *__pyx_pw_6libfds_7filters_3ShockCapture(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
 static PyObject *__pyx_f_6libfds_7filters_ShockCapture(PyObject *__pyx_v_fld, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("ShockCapture", 0);
 
-  /* "libfds/filters.pyx":67
- * 
- * cpdef ShockCapture(fld):
+  /* "libfds/filters.pyx":91
+ *            Volume 228, Issue 5, 2009, Pages 1447-1465.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _ShockCapture2d(fld)
  *     return _ShockCapture3d(fld)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/filters.pyx":68
- * cpdef ShockCapture(fld):
+    /* "libfds/filters.pyx":92
+ *     """
  *     if isinstance(fld, Fields2d):
  *         return _ShockCapture2d(fld)             # <<<<<<<<<<<<<<
  *     return _ShockCapture3d(fld)
  * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__ShockCapture2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__ShockCapture2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "libfds/filters.pyx":67
- * 
- * cpdef ShockCapture(fld):
+    /* "libfds/filters.pyx":91
+ *            Volume 228, Issue 5, 2009, Pages 1447-1465.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _ShockCapture2d(fld)
  *     return _ShockCapture3d(fld)
  */
   }
 
-  /* "libfds/filters.pyx":69
+  /* "libfds/filters.pyx":93
  *     if isinstance(fld, Fields2d):
  *         return _ShockCapture2d(fld)
  *     return _ShockCapture3d(fld)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__ShockCapture3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_7filters__ShockCapture3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 93, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "libfds/filters.pyx":66
+  /* "libfds/filters.pyx":77
  * 
  * 
  * cpdef ShockCapture(fld):             # <<<<<<<<<<<<<<
- *     if isinstance(fld, Fields2d):
- *         return _ShockCapture2d(fld)
+ *     """ Shock capture procedure calculated using technique described in [1]_.
+ * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("libfds.filters.ShockCapture", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
@@ -3963,14 +3964,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_7filters_3ShockCapture(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
+static char __pyx_doc_6libfds_7filters_2ShockCapture[] = " Shock capture procedure calculated using technique described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d or Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, N. de Cacqueray, C. Bailly, \"A shock-capturing methodology based on adaptative \n           spatial filtering for high-order non-linear computations\", Journal of Computational Physics,\n           Volume 228, Issue 5, 2009, Pages 1447-1465.\n    ";
 static PyObject *__pyx_pw_6libfds_7filters_3ShockCapture(PyObject *__pyx_self, PyObject *__pyx_v_fld) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ShockCapture (wrapper)", 0);
   __pyx_r = __pyx_pf_6libfds_7filters_2ShockCapture(__pyx_self, ((PyObject *)__pyx_v_fld));
 
   /* function exit code */
@@ -3983,15 +3985,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("ShockCapture", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_7filters_ShockCapture(__pyx_v_fld, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 66, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_7filters_ShockCapture(__pyx_v_fld, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 77, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4000,15 +4002,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":77
+/* "libfds/filters.pyx":112
  *     """
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -4037,32 +4039,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 77, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 112, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields2d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 77, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 112, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.filters._SelectiveFilter2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 77, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 112, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_7filters_18_SelectiveFilter2d___cinit__(((struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -4077,152 +4079,152 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/filters.pyx":79
+  /* "libfds/filters.pyx":114
  *     def __cinit__(self, Fields2d fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         self.SFr = SF2d(self.fld.r, self.fld.K, self.fld)
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/filters.pyx":81
+  /* "libfds/filters.pyx":116
  *         self.fld = fld
  * 
  *         self.SFr = SF2d(self.fld.r, self.fld.K, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFru = SF2d(self.fld.ru, self.fld.Ku, self.fld)
  *         self.SFrv = SF2d(self.fld.rv, self.fld.Kv, self.fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 81, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 116, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SFr);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFr));
   __pyx_v_self->SFr = ((struct __pyx_obj_6libfds_7libfilt_SF2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":82
+  /* "libfds/filters.pyx":117
  * 
  *         self.SFr = SF2d(self.fld.r, self.fld.K, self.fld)
  *         self.SFru = SF2d(self.fld.ru, self.fld.Ku, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFrv = SF2d(self.fld.rv, self.fld.Kv, self.fld)
  *         self.SFre = SF2d(self.fld.re, self.fld.Ke, self.fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 117, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 117, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 82, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 117, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SFru);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFru));
   __pyx_v_self->SFru = ((struct __pyx_obj_6libfds_7libfilt_SF2d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":83
+  /* "libfds/filters.pyx":118
  *         self.SFr = SF2d(self.fld.r, self.fld.K, self.fld)
  *         self.SFru = SF2d(self.fld.ru, self.fld.Ku, self.fld)
  *         self.SFrv = SF2d(self.fld.rv, self.fld.Kv, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFre = SF2d(self.fld.re, self.fld.Ke, self.fld)
  * 
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 83, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 83, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_2, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 83, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 118, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->SFrv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFrv));
   __pyx_v_self->SFrv = ((struct __pyx_obj_6libfds_7libfilt_SF2d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":84
+  /* "libfds/filters.pyx":119
  *         self.SFru = SF2d(self.fld.ru, self.fld.Ku, self.fld)
  *         self.SFrv = SF2d(self.fld.rv, self.fld.Kv, self.fld)
  *         self.SFre = SF2d(self.fld.re, self.fld.Ke, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void apply(self):
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 84, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 119, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SFre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFre));
   __pyx_v_self->SFre = ((struct __pyx_obj_6libfds_7libfilt_SF2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":77
+  /* "libfds/filters.pyx":112
  *     """
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -4236,15 +4238,15 @@
   __Pyx_AddTraceback("libfds.filters._SelectiveFilter2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":86
+/* "libfds/filters.pyx":121
  *         self.SFre = SF2d(self.fld.re, self.fld.Ke, self.fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply selective filter. """
  * 
  */
 
@@ -4256,198 +4258,198 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
 
-  /* "libfds/filters.pyx":92
+  /* "libfds/filters.pyx":127
  * 
  *         # Calculate filter following x
  *         self.SFr.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFru.apply_x()
  *         self.SFrv.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFr->__pyx_vtab)->apply_x(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFr->__pyx_vtab)->apply_x(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 127, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":93
+  /* "libfds/filters.pyx":128
  *         # Calculate filter following x
  *         self.SFr.apply_x()
  *         self.SFru.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFrv.apply_x()
  *         self.SFre.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFru->__pyx_vtab)->apply_x(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 93, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFru->__pyx_vtab)->apply_x(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":94
+  /* "libfds/filters.pyx":129
  *         self.SFr.apply_x()
  *         self.SFru.apply_x()
  *         self.SFrv.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFre.apply_x()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_x(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 94, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_x(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":95
+  /* "libfds/filters.pyx":130
  *         self.SFru.apply_x()
  *         self.SFrv.apply_x()
  *         self.SFre.apply_x()             # <<<<<<<<<<<<<<
  * 
  *         # Apply filter following x
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFre->__pyx_vtab)->apply_x(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 95, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFre->__pyx_vtab)->apply_x(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":98
+  /* "libfds/filters.pyx":133
  * 
  *         # Apply filter following x
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->xdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 98, __pyx_L1_error)
+    __PYX_ERR(0, 133, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->xdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 133, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 98, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 133, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":99
+    /* "libfds/filters.pyx":134
  *         # Apply filter following x
  *         for sub in self.fld.xdomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Calculate filter following y
  */
     __pyx_f_6libfds_7filters_18_SelectiveFilter2d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":98
+    /* "libfds/filters.pyx":133
  * 
  *         # Apply filter following x
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":102
+  /* "libfds/filters.pyx":137
  * 
  *         # Calculate filter following y
  *         self.SFr.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFru.apply_y()
  *         self.SFrv.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFr->__pyx_vtab)->apply_y(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFr->__pyx_vtab)->apply_y(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":103
+  /* "libfds/filters.pyx":138
  *         # Calculate filter following y
  *         self.SFr.apply_y()
  *         self.SFru.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFrv.apply_y()
  *         self.SFre.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFru->__pyx_vtab)->apply_y(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFru->__pyx_vtab)->apply_y(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":104
+  /* "libfds/filters.pyx":139
  *         self.SFr.apply_y()
  *         self.SFru.apply_y()
  *         self.SFrv.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFre.apply_y()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_y(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_y(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":105
+  /* "libfds/filters.pyx":140
  *         self.SFru.apply_y()
  *         self.SFrv.apply_y()
  *         self.SFre.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         # Apply filter following y
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFre->__pyx_vtab)->apply_y(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF2d *)__pyx_v_self->SFre->__pyx_vtab)->apply_y(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":108
+  /* "libfds/filters.pyx":143
  * 
  *         # Apply filter following y
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->ydomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 108, __pyx_L1_error)
+    __PYX_ERR(0, 143, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->ydomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 143, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 108, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 108, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":109
+    /* "libfds/filters.pyx":144
  *         # Apply filter following y
  *         for sub in self.fld.ydomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Update pressure
  */
     __pyx_f_6libfds_7filters_18_SelectiveFilter2d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":108
+    /* "libfds/filters.pyx":143
  * 
  *         # Apply filter following y
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":112
+  /* "libfds/filters.pyx":147
  * 
  *         # Update pressure
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":86
+  /* "libfds/filters.pyx":121
  *         self.SFre = SF2d(self.fld.re, self.fld.Ke, self.fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply selective filter. """
  * 
  */
 
@@ -4481,15 +4483,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_18_SelectiveFilter2d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 86, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_18_SelectiveFilter2d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4498,15 +4500,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":114
+/* "libfds/filters.pyx":149
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -4524,25 +4526,25 @@
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   __Pyx_RefNannySetupContext("_update", 0);
 
-  /* "libfds/filters.pyx":118
+  /* "libfds/filters.pyx":153
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/filters.pyx":119
+    /* "libfds/filters.pyx":154
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  */
     {
@@ -4574,27 +4576,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":120
+                              /* "libfds/filters.pyx":155
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":121
+                                /* "libfds/filters.pyx":156
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -4612,15 +4614,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":119
+        /* "libfds/filters.pyx":154
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  */
         /*finally:*/ {
@@ -4631,15 +4633,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/filters.pyx":123
+    /* "libfds/filters.pyx":158
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  */
     {
@@ -4671,27 +4673,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":124
+                              /* "libfds/filters.pyx":159
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":125
+                                /* "libfds/filters.pyx":160
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -4709,15 +4711,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":123
+        /* "libfds/filters.pyx":158
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  */
         /*finally:*/ {
@@ -4728,15 +4730,15 @@
             #endif
             goto __pyx_L17;
           }
           __pyx_L17:;
         }
     }
 
-    /* "libfds/filters.pyx":127
+    /* "libfds/filters.pyx":162
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  */
     {
@@ -4768,27 +4770,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":128
+                              /* "libfds/filters.pyx":163
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":129
+                                /* "libfds/filters.pyx":164
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -4806,15 +4808,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":127
+        /* "libfds/filters.pyx":162
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  */
         /*finally:*/ {
@@ -4825,15 +4827,15 @@
             #endif
             goto __pyx_L28;
           }
           __pyx_L28:;
         }
     }
 
-    /* "libfds/filters.pyx":131
+    /* "libfds/filters.pyx":166
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  */
     {
@@ -4865,27 +4867,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":132
+                              /* "libfds/filters.pyx":167
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  *         else:
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":133
+                                /* "libfds/filters.pyx":168
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -4903,15 +4905,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":131
+        /* "libfds/filters.pyx":166
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  */
         /*finally:*/ {
@@ -4922,167 +4924,167 @@
             #endif
             goto __pyx_L39;
           }
           __pyx_L39:;
         }
     }
 
-    /* "libfds/filters.pyx":118
+    /* "libfds/filters.pyx":153
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":135
+  /* "libfds/filters.pyx":170
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  */
   /*else*/ {
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":136
+      /* "libfds/filters.pyx":171
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":137
+        /* "libfds/filters.pyx":172
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_11 * __pyx_v_self->fld->r.strides[0]) )) + __pyx_t_12)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->K.data + __pyx_t_9 * __pyx_v_self->fld->K.strides[0]) )) + __pyx_t_10)) )));
       }
     }
 
-    /* "libfds/filters.pyx":139
+    /* "libfds/filters.pyx":174
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":140
+      /* "libfds/filters.pyx":175
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":141
+        /* "libfds/filters.pyx":176
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ku.data + __pyx_t_10 * __pyx_v_self->fld->Ku.strides[0]) )) + __pyx_t_9)) )));
       }
     }
 
-    /* "libfds/filters.pyx":143
+    /* "libfds/filters.pyx":178
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":144
+      /* "libfds/filters.pyx":179
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":145
+        /* "libfds/filters.pyx":180
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_11 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_12)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Kv.data + __pyx_t_9 * __pyx_v_self->fld->Kv.strides[0]) )) + __pyx_t_10)) )));
       }
     }
 
-    /* "libfds/filters.pyx":147
+    /* "libfds/filters.pyx":182
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":148
+      /* "libfds/filters.pyx":183
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":149
+        /* "libfds/filters.pyx":184
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]             # <<<<<<<<<<<<<<
  * 
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
@@ -5091,15 +5093,15 @@
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_12 * __pyx_v_self->fld->re.strides[0]) )) + __pyx_t_11)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ke.data + __pyx_t_10 * __pyx_v_self->fld->Ke.strides[0]) )) + __pyx_t_9)) )));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":114
+  /* "libfds/filters.pyx":149
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -5216,15 +5218,15 @@
   __Pyx_AddTraceback("libfds.filters._SelectiveFilter2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":157
+/* "libfds/filters.pyx":203
  *     """
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -5253,32 +5255,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 157, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 203, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields3d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 157, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 203, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.filters._SelectiveFilter3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 157, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 203, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_7filters_18_SelectiveFilter3d___cinit__(((struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -5293,183 +5295,183 @@
   PyObject *__pyx_t_2 = NULL;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/filters.pyx":159
+  /* "libfds/filters.pyx":205
  *     def __cinit__(self, Fields3d fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         self.SFr = SF3d(self.fld.r, self.fld.K, self.fld)
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/filters.pyx":161
+  /* "libfds/filters.pyx":207
  *         self.fld = fld
  * 
  *         self.SFr = SF3d(self.fld.r, self.fld.K, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFru = SF3d(self.fld.ru, self.fld.Ku, self.fld)
  *         self.SFrv = SF3d(self.fld.rv, self.fld.Kv, self.fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 161, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 161, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 207, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SFr);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFr));
   __pyx_v_self->SFr = ((struct __pyx_obj_6libfds_7libfilt_SF3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":162
+  /* "libfds/filters.pyx":208
  * 
  *         self.SFr = SF3d(self.fld.r, self.fld.K, self.fld)
  *         self.SFru = SF3d(self.fld.ru, self.fld.Ku, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFrv = SF3d(self.fld.rv, self.fld.Kv, self.fld)
  *         self.SFrw = SF3d(self.fld.rw, self.fld.Kw, self.fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 162, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 208, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SFru);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFru));
   __pyx_v_self->SFru = ((struct __pyx_obj_6libfds_7libfilt_SF3d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":163
+  /* "libfds/filters.pyx":209
  *         self.SFr = SF3d(self.fld.r, self.fld.K, self.fld)
  *         self.SFru = SF3d(self.fld.ru, self.fld.Ku, self.fld)
  *         self.SFrv = SF3d(self.fld.rv, self.fld.Kv, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFrw = SF3d(self.fld.rw, self.fld.Kw, self.fld)
  *         self.SFre = SF3d(self.fld.re, self.fld.Ke, self.fld)
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 163, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 163, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(3); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_2, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 163, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 209, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->SFrv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFrv));
   __pyx_v_self->SFrv = ((struct __pyx_obj_6libfds_7libfilt_SF3d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":164
+  /* "libfds/filters.pyx":210
  *         self.SFru = SF3d(self.fld.ru, self.fld.Ku, self.fld)
  *         self.SFrv = SF3d(self.fld.rv, self.fld.Kv, self.fld)
  *         self.SFrw = SF3d(self.fld.rw, self.fld.Kw, self.fld)             # <<<<<<<<<<<<<<
  *         self.SFre = SF3d(self.fld.re, self.fld.Ke, self.fld)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 164, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 210, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 164, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 210, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 164, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 210, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 164, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 210, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SFrw);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFrw));
   __pyx_v_self->SFrw = ((struct __pyx_obj_6libfds_7libfilt_SF3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":165
+  /* "libfds/filters.pyx":211
  *         self.SFrv = SF3d(self.fld.rv, self.fld.Kv, self.fld)
  *         self.SFrw = SF3d(self.fld.rw, self.fld.Kw, self.fld)
  *         self.SFre = SF3d(self.fld.re, self.fld.Ke, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void apply(self):
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 165, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SF3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 211, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SFre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SFre));
   __pyx_v_self->SFre = ((struct __pyx_obj_6libfds_7libfilt_SF3d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":157
+  /* "libfds/filters.pyx":203
  *     """
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -5483,15 +5485,15 @@
   __Pyx_AddTraceback("libfds.filters._SelectiveFilter3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":167
+/* "libfds/filters.pyx":213
  *         self.SFre = SF3d(self.fld.re, self.fld.Ke, self.fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply selective filter. """
  * 
  */
 
@@ -5503,318 +5505,318 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
 
-  /* "libfds/filters.pyx":173
+  /* "libfds/filters.pyx":219
  * 
  *         # Calculate filter following x
  *         self.SFr.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFru.apply_x()
  *         self.SFrv.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFr->__pyx_vtab)->apply_x(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 173, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFr->__pyx_vtab)->apply_x(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":174
+  /* "libfds/filters.pyx":220
  *         # Calculate filter following x
  *         self.SFr.apply_x()
  *         self.SFru.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFrv.apply_x()
  *         self.SFrw.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFru->__pyx_vtab)->apply_x(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFru->__pyx_vtab)->apply_x(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 220, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":175
+  /* "libfds/filters.pyx":221
  *         self.SFr.apply_x()
  *         self.SFru.apply_x()
  *         self.SFrv.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFrw.apply_x()
  *         self.SFre.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_x(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 175, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_x(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 221, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":176
+  /* "libfds/filters.pyx":222
  *         self.SFru.apply_x()
  *         self.SFrv.apply_x()
  *         self.SFrw.apply_x()             # <<<<<<<<<<<<<<
  *         self.SFre.apply_x()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrw->__pyx_vtab)->apply_x(__pyx_v_self->SFrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrw->__pyx_vtab)->apply_x(__pyx_v_self->SFrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":177
+  /* "libfds/filters.pyx":223
  *         self.SFrv.apply_x()
  *         self.SFrw.apply_x()
  *         self.SFre.apply_x()             # <<<<<<<<<<<<<<
  * 
  *         # Apply filter following x
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFre->__pyx_vtab)->apply_x(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFre->__pyx_vtab)->apply_x(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 223, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":180
+  /* "libfds/filters.pyx":226
  * 
  *         # Apply filter following x
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->xdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 180, __pyx_L1_error)
+    __PYX_ERR(0, 226, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->xdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 180, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 226, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 180, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 226, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 180, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 226, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":181
+    /* "libfds/filters.pyx":227
  *         # Apply filter following x
  *         for sub in self.fld.xdomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Calculate filter following y
  */
     __pyx_f_6libfds_7filters_18_SelectiveFilter3d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":180
+    /* "libfds/filters.pyx":226
  * 
  *         # Apply filter following x
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":184
+  /* "libfds/filters.pyx":230
  * 
  *         # Calculate filter following y
  *         self.SFr.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFru.apply_y()
  *         self.SFrv.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFr->__pyx_vtab)->apply_y(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 184, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFr->__pyx_vtab)->apply_y(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 230, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":185
+  /* "libfds/filters.pyx":231
  *         # Calculate filter following y
  *         self.SFr.apply_y()
  *         self.SFru.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFrv.apply_y()
  *         self.SFrw.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFru->__pyx_vtab)->apply_y(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFru->__pyx_vtab)->apply_y(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 231, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":186
+  /* "libfds/filters.pyx":232
  *         self.SFr.apply_y()
  *         self.SFru.apply_y()
  *         self.SFrv.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFrw.apply_y()
  *         self.SFre.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_y(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_y(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 232, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":187
+  /* "libfds/filters.pyx":233
  *         self.SFru.apply_y()
  *         self.SFrv.apply_y()
  *         self.SFrw.apply_y()             # <<<<<<<<<<<<<<
  *         self.SFre.apply_y()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrw->__pyx_vtab)->apply_y(__pyx_v_self->SFrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 187, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrw->__pyx_vtab)->apply_y(__pyx_v_self->SFrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 233, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":188
+  /* "libfds/filters.pyx":234
  *         self.SFrv.apply_y()
  *         self.SFrw.apply_y()
  *         self.SFre.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         # Apply filter following y
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFre->__pyx_vtab)->apply_y(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFre->__pyx_vtab)->apply_y(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":191
+  /* "libfds/filters.pyx":237
  * 
  *         # Apply filter following y
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->ydomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 191, __pyx_L1_error)
+    __PYX_ERR(0, 237, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->ydomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 191, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 237, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 191, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 191, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 237, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":192
+    /* "libfds/filters.pyx":238
  *         # Apply filter following y
  *         for sub in self.fld.ydomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Calculate filter following z
  */
     __pyx_f_6libfds_7filters_18_SelectiveFilter3d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":191
+    /* "libfds/filters.pyx":237
  * 
  *         # Apply filter following y
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":195
+  /* "libfds/filters.pyx":241
  * 
  *         # Calculate filter following z
  *         self.SFr.apply_z()             # <<<<<<<<<<<<<<
  *         self.SFru.apply_z()
  *         self.SFrv.apply_z()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFr->__pyx_vtab)->apply_z(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFr->__pyx_vtab)->apply_z(__pyx_v_self->SFr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":196
+  /* "libfds/filters.pyx":242
  *         # Calculate filter following z
  *         self.SFr.apply_z()
  *         self.SFru.apply_z()             # <<<<<<<<<<<<<<
  *         self.SFrv.apply_z()
  *         self.SFrw.apply_z()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFru->__pyx_vtab)->apply_z(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 196, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFru->__pyx_vtab)->apply_z(__pyx_v_self->SFru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 242, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":197
+  /* "libfds/filters.pyx":243
  *         self.SFr.apply_z()
  *         self.SFru.apply_z()
  *         self.SFrv.apply_z()             # <<<<<<<<<<<<<<
  *         self.SFrw.apply_z()
  *         self.SFre.apply_z()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_z(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 197, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrv->__pyx_vtab)->apply_z(__pyx_v_self->SFrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 243, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":198
+  /* "libfds/filters.pyx":244
  *         self.SFru.apply_z()
  *         self.SFrv.apply_z()
  *         self.SFrw.apply_z()             # <<<<<<<<<<<<<<
  *         self.SFre.apply_z()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrw->__pyx_vtab)->apply_z(__pyx_v_self->SFrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFrw->__pyx_vtab)->apply_z(__pyx_v_self->SFrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":199
+  /* "libfds/filters.pyx":245
  *         self.SFrv.apply_z()
  *         self.SFrw.apply_z()
  *         self.SFre.apply_z()             # <<<<<<<<<<<<<<
  * 
  *         # Apply filter following z
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFre->__pyx_vtab)->apply_z(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 199, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SF3d *)__pyx_v_self->SFre->__pyx_vtab)->apply_z(__pyx_v_self->SFre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 245, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":202
+  /* "libfds/filters.pyx":248
  * 
  *         # Apply filter following z
  *         for sub in self.fld.zdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->zdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 202, __pyx_L1_error)
+    __PYX_ERR(0, 248, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->zdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 202, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 248, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 202, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 202, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 248, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":203
+    /* "libfds/filters.pyx":249
  *         # Apply filter following z
  *         for sub in self.fld.zdomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Update pressure
  */
     __pyx_f_6libfds_7filters_18_SelectiveFilter3d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":202
+    /* "libfds/filters.pyx":248
  * 
  *         # Apply filter following z
  *         for sub in self.fld.zdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":206
+  /* "libfds/filters.pyx":252
  * 
  *         # Update pressure
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":167
+  /* "libfds/filters.pyx":213
  *         self.SFre = SF3d(self.fld.re, self.fld.Ke, self.fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply selective filter. """
  * 
  */
 
@@ -5848,15 +5850,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_18_SelectiveFilter3d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 167, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_18_SelectiveFilter3d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -5865,15 +5867,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":208
+/* "libfds/filters.pyx":254
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -5897,25 +5899,25 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   __Pyx_RefNannySetupContext("_update", 0);
 
-  /* "libfds/filters.pyx":212
+  /* "libfds/filters.pyx":258
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/filters.pyx":213
+    /* "libfds/filters.pyx":259
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -5948,39 +5950,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":214
+                              /* "libfds/filters.pyx":260
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":215
+                                /* "libfds/filters.pyx":261
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":216
+                                  /* "libfds/filters.pyx":262
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -6001,15 +6003,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":213
+        /* "libfds/filters.pyx":259
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -6020,15 +6022,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/filters.pyx":218
+    /* "libfds/filters.pyx":264
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -6061,39 +6063,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":219
+                              /* "libfds/filters.pyx":265
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":220
+                                /* "libfds/filters.pyx":266
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":221
+                                  /* "libfds/filters.pyx":267
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -6114,15 +6116,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":218
+        /* "libfds/filters.pyx":264
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -6133,15 +6135,15 @@
             #endif
             goto __pyx_L19;
           }
           __pyx_L19:;
         }
     }
 
-    /* "libfds/filters.pyx":223
+    /* "libfds/filters.pyx":269
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -6174,39 +6176,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":224
+                              /* "libfds/filters.pyx":270
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":225
+                                /* "libfds/filters.pyx":271
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":226
+                                  /* "libfds/filters.pyx":272
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -6227,15 +6229,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":223
+        /* "libfds/filters.pyx":269
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -6246,15 +6248,15 @@
             #endif
             goto __pyx_L32;
           }
           __pyx_L32:;
         }
     }
 
-    /* "libfds/filters.pyx":228
+    /* "libfds/filters.pyx":274
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -6287,39 +6289,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":229
+                              /* "libfds/filters.pyx":275
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":230
+                                /* "libfds/filters.pyx":276
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":231
+                                  /* "libfds/filters.pyx":277
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -6340,15 +6342,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":228
+        /* "libfds/filters.pyx":274
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -6359,15 +6361,15 @@
             #endif
             goto __pyx_L45;
           }
           __pyx_L45:;
         }
     }
 
-    /* "libfds/filters.pyx":233
+    /* "libfds/filters.pyx":279
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -6400,39 +6402,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":234
+                              /* "libfds/filters.pyx":280
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":235
+                                /* "libfds/filters.pyx":281
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":236
+                                  /* "libfds/filters.pyx":282
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -6453,15 +6455,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":233
+        /* "libfds/filters.pyx":279
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -6472,62 +6474,62 @@
             #endif
             goto __pyx_L58;
           }
           __pyx_L58:;
         }
     }
 
-    /* "libfds/filters.pyx":212
+    /* "libfds/filters.pyx":258
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":238
+  /* "libfds/filters.pyx":284
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":239
+      /* "libfds/filters.pyx":285
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":240
+        /* "libfds/filters.pyx":286
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":241
+          /* "libfds/filters.pyx":287
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -6537,51 +6539,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_17 * __pyx_v_self->fld->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->r.strides[1]) )) + __pyx_t_15)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->K.data + __pyx_t_14 * __pyx_v_self->fld->K.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->K.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":243
+    /* "libfds/filters.pyx":289
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":244
+      /* "libfds/filters.pyx":290
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":245
+        /* "libfds/filters.pyx":291
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":246
+          /* "libfds/filters.pyx":292
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -6591,51 +6593,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_15 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_17)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ku.data + __pyx_t_12 * __pyx_v_self->fld->Ku.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ku.strides[1]) )) + __pyx_t_14)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":248
+    /* "libfds/filters.pyx":294
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":249
+      /* "libfds/filters.pyx":295
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":250
+        /* "libfds/filters.pyx":296
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":251
+          /* "libfds/filters.pyx":297
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -6645,51 +6647,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_17 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_15)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Kv.data + __pyx_t_14 * __pyx_v_self->fld->Kv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Kv.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":253
+    /* "libfds/filters.pyx":299
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":254
+      /* "libfds/filters.pyx":300
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":255
+        /* "libfds/filters.pyx":301
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":256
+          /* "libfds/filters.pyx":302
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -6699,51 +6701,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_15 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_17)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Kw.data + __pyx_t_12 * __pyx_v_self->fld->Kw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Kw.strides[1]) )) + __pyx_t_14)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":258
+    /* "libfds/filters.pyx":304
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":259
+      /* "libfds/filters.pyx":305
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":260
+        /* "libfds/filters.pyx":306
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":261
+          /* "libfds/filters.pyx":307
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -6755,15 +6757,15 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_17 * __pyx_v_self->fld->re.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->re.strides[1]) )) + __pyx_t_15)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ke.data + __pyx_t_14 * __pyx_v_self->fld->Ke.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ke.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":208
+  /* "libfds/filters.pyx":254
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy, iz
  */
 
@@ -6880,15 +6882,15 @@
   __Pyx_AddTraceback("libfds.filters._SelectiveFilter3d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":269
+/* "libfds/filters.pyx":326
  *     """
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -6917,32 +6919,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 269, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 326, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields2d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 269, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 326, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.filters._ShockCapture2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 269, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 326, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_7filters_15_ShockCapture2d___cinit__(((struct __pyx_obj_6libfds_7filters__ShockCapture2d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -6958,234 +6960,234 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/filters.pyx":271
+  /* "libfds/filters.pyx":328
  *     def __cinit__(self, Fields2d fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  *         self.LPL = LF2d(self.fld.p, self.fld.E, fld)
  *         self.SG = SG2d(self.fld.E, self.fld.F, fld)
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/filters.pyx":272
+  /* "libfds/filters.pyx":329
  * 
  *         self.fld = fld
  *         self.LPL = LF2d(self.fld.p, self.fld.E, fld)             # <<<<<<<<<<<<<<
  *         self.SG = SG2d(self.fld.E, self.fld.F, fld)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->p, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_LF2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 272, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_LF2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 329, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->LPL);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->LPL));
   __pyx_v_self->LPL = ((struct __pyx_obj_6libfds_7libfilt_LF2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":273
+  /* "libfds/filters.pyx":330
  *         self.fld = fld
  *         self.LPL = LF2d(self.fld.p, self.fld.E, fld)
  *         self.SG = SG2d(self.fld.E, self.fld.F, fld)             # <<<<<<<<<<<<<<
  * 
  *         self.SCr = SC2d(self.fld.r, self.fld.K, self.fld.F, fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 273, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 273, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_fld));
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SG2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 273, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SG2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SG);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SG));
   __pyx_v_self->SG = ((struct __pyx_obj_6libfds_7libfilt_SG2d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":275
+  /* "libfds/filters.pyx":332
  *         self.SG = SG2d(self.fld.E, self.fld.F, fld)
  * 
  *         self.SCr = SC2d(self.fld.r, self.fld.K, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCru = SC2d(self.fld.ru, self.fld.Ku, self.fld.F, fld)
  *         self.SCrv = SC2d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 275, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 275, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 275, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_4, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 275, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 332, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SCr);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCr));
   __pyx_v_self->SCr = ((struct __pyx_obj_6libfds_7libfilt_SC2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":276
+  /* "libfds/filters.pyx":333
  * 
  *         self.SCr = SC2d(self.fld.r, self.fld.K, self.fld.F, fld)
  *         self.SCru = SC2d(self.fld.ru, self.fld.Ku, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCrv = SC2d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  *         self.SCre = SC2d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_3, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 276, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 333, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->SCru);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCru));
   __pyx_v_self->SCru = ((struct __pyx_obj_6libfds_7libfilt_SC2d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":277
+  /* "libfds/filters.pyx":334
  *         self.SCr = SC2d(self.fld.r, self.fld.K, self.fld.F, fld)
  *         self.SCru = SC2d(self.fld.ru, self.fld.Ku, self.fld.F, fld)
  *         self.SCrv = SC2d(self.fld.rv, self.fld.Kv, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCre = SC2d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_4);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_2, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 277, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 334, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->SCrv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCrv));
   __pyx_v_self->SCrv = ((struct __pyx_obj_6libfds_7libfilt_SC2d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/filters.pyx":278
+  /* "libfds/filters.pyx":335
  *         self.SCru = SC2d(self.fld.ru, self.fld.Ku, self.fld.F, fld)
  *         self.SCrv = SC2d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  *         self.SCre = SC2d(self.fld.re, self.fld.Ke, self.fld.F, fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void apply(self):
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_4 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 335, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SCre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCre));
   __pyx_v_self->SCre = ((struct __pyx_obj_6libfds_7libfilt_SC2d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":269
+  /* "libfds/filters.pyx":326
  *     """
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -7200,15 +7202,15 @@
   __Pyx_AddTraceback("libfds.filters._ShockCapture2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":280
+/* "libfds/filters.pyx":337
  *         self.SCre = SC2d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply shock capture procedure. """
  * 
  */
 
@@ -7220,243 +7222,243 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
 
-  /* "libfds/filters.pyx":286
+  /* "libfds/filters.pyx":343
  * 
  *         # Capture following x
  *         self.LPL.apply_x()             # <<<<<<<<<<<<<<
  *         self.SG.apply_x()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_LF2d *)__pyx_v_self->LPL->__pyx_vtab)->apply_x(__pyx_v_self->LPL, 0);
 
-  /* "libfds/filters.pyx":287
+  /* "libfds/filters.pyx":344
  *         # Capture following x
  *         self.LPL.apply_x()
  *         self.SG.apply_x()             # <<<<<<<<<<<<<<
  * 
  *         self.SCr.apply_x()
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_SG2d *)__pyx_v_self->SG->__pyx_vtab)->apply_x(__pyx_v_self->SG, 0);
 
-  /* "libfds/filters.pyx":289
+  /* "libfds/filters.pyx":346
  *         self.SG.apply_x()
  * 
  *         self.SCr.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCru.apply_x()
  *         self.SCrv.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCr->__pyx_vtab)->apply_x(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCr->__pyx_vtab)->apply_x(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 346, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":290
+  /* "libfds/filters.pyx":347
  * 
  *         self.SCr.apply_x()
  *         self.SCru.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCrv.apply_x()
  *         self.SCre.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCru->__pyx_vtab)->apply_x(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 290, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCru->__pyx_vtab)->apply_x(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 347, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":291
+  /* "libfds/filters.pyx":348
  *         self.SCr.apply_x()
  *         self.SCru.apply_x()
  *         self.SCrv.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCre.apply_x()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_x(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 291, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_x(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 348, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":292
+  /* "libfds/filters.pyx":349
  *         self.SCru.apply_x()
  *         self.SCrv.apply_x()
  *         self.SCre.apply_x()             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.fld.xdomains:
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCre->__pyx_vtab)->apply_x(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCre->__pyx_vtab)->apply_x(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 349, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":294
+  /* "libfds/filters.pyx":351
  *         self.SCre.apply_x()
  * 
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->xdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 294, __pyx_L1_error)
+    __PYX_ERR(0, 351, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->xdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 294, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 351, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 351, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 294, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 351, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":295
+    /* "libfds/filters.pyx":352
  * 
  *         for sub in self.fld.xdomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Capture following y
  */
     __pyx_f_6libfds_7filters_15_ShockCapture2d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":294
+    /* "libfds/filters.pyx":351
  *         self.SCre.apply_x()
  * 
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":298
+  /* "libfds/filters.pyx":355
  * 
  *         # Capture following y
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  *         self.LPL.apply_y()
  *         self.SG.apply_y()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":299
+  /* "libfds/filters.pyx":356
  *         # Capture following y
  *         self.fld.update('p')
  *         self.LPL.apply_y()             # <<<<<<<<<<<<<<
  *         self.SG.apply_y()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_LF2d *)__pyx_v_self->LPL->__pyx_vtab)->apply_y(__pyx_v_self->LPL, 0);
 
-  /* "libfds/filters.pyx":300
+  /* "libfds/filters.pyx":357
  *         self.fld.update('p')
  *         self.LPL.apply_y()
  *         self.SG.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         self.SCr.apply_y()
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_SG2d *)__pyx_v_self->SG->__pyx_vtab)->apply_y(__pyx_v_self->SG, 0);
 
-  /* "libfds/filters.pyx":302
+  /* "libfds/filters.pyx":359
  *         self.SG.apply_y()
  * 
  *         self.SCr.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCru.apply_y()
  *         self.SCrv.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCr->__pyx_vtab)->apply_y(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCr->__pyx_vtab)->apply_y(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":303
+  /* "libfds/filters.pyx":360
  * 
  *         self.SCr.apply_y()
  *         self.SCru.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCrv.apply_y()
  *         self.SCre.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCru->__pyx_vtab)->apply_y(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 303, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCru->__pyx_vtab)->apply_y(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":304
+  /* "libfds/filters.pyx":361
  *         self.SCr.apply_y()
  *         self.SCru.apply_y()
  *         self.SCrv.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCre.apply_y()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_y(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_y(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":305
+  /* "libfds/filters.pyx":362
  *         self.SCru.apply_y()
  *         self.SCrv.apply_y()
  *         self.SCre.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.fld.ydomains:
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCre->__pyx_vtab)->apply_y(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC2d *)__pyx_v_self->SCre->__pyx_vtab)->apply_y(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 362, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":307
+  /* "libfds/filters.pyx":364
  *         self.SCre.apply_y()
  * 
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->ydomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 307, __pyx_L1_error)
+    __PYX_ERR(0, 364, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->ydomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 307, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 364, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 364, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 307, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 364, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":308
+    /* "libfds/filters.pyx":365
  * 
  *         for sub in self.fld.ydomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Update pressure
  */
     __pyx_f_6libfds_7filters_15_ShockCapture2d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":307
+    /* "libfds/filters.pyx":364
  *         self.SCre.apply_y()
  * 
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":311
+  /* "libfds/filters.pyx":368
  * 
  *         # Update pressure
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":280
+  /* "libfds/filters.pyx":337
  *         self.SCre = SC2d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply shock capture procedure. """
  * 
  */
 
@@ -7490,15 +7492,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_15_ShockCapture2d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_15_ShockCapture2d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 337, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7507,15 +7509,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":313
+/* "libfds/filters.pyx":370
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  *         """ Update fields. """
  * 
  */
 
@@ -7533,25 +7535,25 @@
   Py_ssize_t __pyx_t_8;
   Py_ssize_t __pyx_t_9;
   Py_ssize_t __pyx_t_10;
   Py_ssize_t __pyx_t_11;
   Py_ssize_t __pyx_t_12;
   __Pyx_RefNannySetupContext("_update", 0);
 
-  /* "libfds/filters.pyx":318
+  /* "libfds/filters.pyx":375
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/filters.pyx":319
+    /* "libfds/filters.pyx":376
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  */
     {
@@ -7583,27 +7585,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":320
+                              /* "libfds/filters.pyx":377
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":321
+                                /* "libfds/filters.pyx":378
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -7621,15 +7623,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":319
+        /* "libfds/filters.pyx":376
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  */
         /*finally:*/ {
@@ -7640,15 +7642,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/filters.pyx":323
+    /* "libfds/filters.pyx":380
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  */
     {
@@ -7680,27 +7682,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":324
+                              /* "libfds/filters.pyx":381
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":325
+                                /* "libfds/filters.pyx":382
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -7718,15 +7720,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":323
+        /* "libfds/filters.pyx":380
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  */
         /*finally:*/ {
@@ -7737,15 +7739,15 @@
             #endif
             goto __pyx_L17;
           }
           __pyx_L17:;
         }
     }
 
-    /* "libfds/filters.pyx":327
+    /* "libfds/filters.pyx":384
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  */
     {
@@ -7777,27 +7779,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":328
+                              /* "libfds/filters.pyx":385
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":329
+                                /* "libfds/filters.pyx":386
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                 __pyx_t_9 = __pyx_v_ix;
@@ -7815,15 +7817,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":327
+        /* "libfds/filters.pyx":384
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  */
         /*finally:*/ {
@@ -7834,15 +7836,15 @@
             #endif
             goto __pyx_L28;
           }
           __pyx_L28:;
         }
     }
 
-    /* "libfds/filters.pyx":331
+    /* "libfds/filters.pyx":388
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  */
     {
@@ -7874,27 +7876,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":332
+                              /* "libfds/filters.pyx":389
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  *         else:
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":333
+                                /* "libfds/filters.pyx":390
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax+1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -7912,15 +7914,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":331
+        /* "libfds/filters.pyx":388
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  */
         /*finally:*/ {
@@ -7931,167 +7933,167 @@
             #endif
             goto __pyx_L39;
           }
           __pyx_L39:;
         }
     }
 
-    /* "libfds/filters.pyx":318
+    /* "libfds/filters.pyx":375
  *         cdef Py_ssize_t ix, iy
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax+1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":335
+  /* "libfds/filters.pyx":392
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax+1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  */
   /*else*/ {
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":336
+      /* "libfds/filters.pyx":393
  *         else:
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":337
+        /* "libfds/filters.pyx":394
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax+1):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_11 * __pyx_v_self->fld->r.strides[0]) )) + __pyx_t_12)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->K.data + __pyx_t_9 * __pyx_v_self->fld->K.strides[0]) )) + __pyx_t_10)) )));
       }
     }
 
-    /* "libfds/filters.pyx":339
+    /* "libfds/filters.pyx":396
  *                     self.fld.r[ix, iy] -= self.fld.K[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax+1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":340
+      /* "libfds/filters.pyx":397
  * 
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":341
+        /* "libfds/filters.pyx":398
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax+1):
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ku.data + __pyx_t_10 * __pyx_v_self->fld->Ku.strides[0]) )) + __pyx_t_9)) )));
       }
     }
 
-    /* "libfds/filters.pyx":343
+    /* "libfds/filters.pyx":400
  *                     self.fld.ru[ix, iy] -= self.fld.Ku[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax+1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":344
+      /* "libfds/filters.pyx":401
  * 
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":345
+        /* "libfds/filters.pyx":402
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax+1):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_11 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_12)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Kv.data + __pyx_t_9 * __pyx_v_self->fld->Kv.strides[0]) )) + __pyx_t_10)) )));
       }
     }
 
-    /* "libfds/filters.pyx":347
+    /* "libfds/filters.pyx":404
  *                     self.fld.rv[ix, iy] -= self.fld.Kv[ix, iy]
  * 
  *             for ix in range(ixmin, ixmax+1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  */
     __pyx_t_2 = (__pyx_v_ixmax + 1);
     __pyx_t_3 = __pyx_t_2;
     for (__pyx_t_4 = __pyx_v_ixmin; __pyx_t_4 < __pyx_t_3; __pyx_t_4+=1) {
       __pyx_v_ix = __pyx_t_4;
 
-      /* "libfds/filters.pyx":348
+      /* "libfds/filters.pyx":405
  * 
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):             # <<<<<<<<<<<<<<
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]
  * 
  */
       __pyx_t_5 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_5;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":349
+        /* "libfds/filters.pyx":406
  *             for ix in range(ixmin, ixmax+1):
  *                 for iy in range(iymin, iymax+1):
  *                     self.fld.re[ix, iy] -= self.fld.Ke[ix, iy]             # <<<<<<<<<<<<<<
  * 
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
@@ -8100,15 +8102,15 @@
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_12 * __pyx_v_self->fld->re.strides[0]) )) + __pyx_t_11)) )) -= (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ke.data + __pyx_t_10 * __pyx_v_self->fld->Ke.strides[0]) )) + __pyx_t_9)) )));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":313
+  /* "libfds/filters.pyx":370
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  *         """ Update fields. """
  * 
  */
 
@@ -8225,15 +8227,15 @@
   __Pyx_AddTraceback("libfds.filters._ShockCapture2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":357
+/* "libfds/filters.pyx":425
  *     """
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -8262,32 +8264,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 357, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 425, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields3d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 357, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 425, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.filters._ShockCapture3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 357, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 425, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_7filters_15_ShockCapture3d___cinit__(((struct __pyx_obj_6libfds_7filters__ShockCapture3d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -8303,270 +8305,270 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/filters.pyx":359
+  /* "libfds/filters.pyx":427
  *     def __cinit__(self, Fields3d fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  *         self.LPL = LF3d(self.fld.p, self.fld.E, fld)
  *         self.SG = SG3d(self.fld.E, self.fld.F, fld)
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/filters.pyx":360
+  /* "libfds/filters.pyx":428
  * 
  *         self.fld = fld
  *         self.LPL = LF3d(self.fld.p, self.fld.E, fld)             # <<<<<<<<<<<<<<
  *         self.SG = SG3d(self.fld.E, self.fld.F, fld)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->p, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_3, 2, ((PyObject *)__pyx_v_fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_LF3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_LF3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 428, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->LPL);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->LPL));
   __pyx_v_self->LPL = ((struct __pyx_obj_6libfds_7libfilt_LF3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":361
+  /* "libfds/filters.pyx":429
  *         self.fld = fld
  *         self.LPL = LF3d(self.fld.p, self.fld.E, fld)
  *         self.SG = SG3d(self.fld.E, self.fld.F, fld)             # <<<<<<<<<<<<<<
  * 
  *         self.SCr = SC3d(self.fld.r, self.fld.K, self.fld.F, fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 429, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 429, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 429, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_1, 2, ((PyObject *)__pyx_v_fld));
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SG3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SG3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 429, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SG);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SG));
   __pyx_v_self->SG = ((struct __pyx_obj_6libfds_7libfilt_SG3d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":363
+  /* "libfds/filters.pyx":431
  *         self.SG = SG3d(self.fld.E, self.fld.F, fld)
  * 
  *         self.SCr = SC3d(self.fld.r, self.fld.K, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCru = SC3d(self.fld.ru, self.fld.Ku, self.fld.F, fld)
  *         self.SCrv = SC3d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_4, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 431, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SCr);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCr));
   __pyx_v_self->SCr = ((struct __pyx_obj_6libfds_7libfilt_SC3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":364
+  /* "libfds/filters.pyx":432
  * 
  *         self.SCr = SC3d(self.fld.r, self.fld.K, self.fld.F, fld)
  *         self.SCru = SC3d(self.fld.ru, self.fld.Ku, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCrv = SC3d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  *         self.SCrw = SC3d(self.fld.rw, self.fld.Kw, self.fld.F, fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_3, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_2 = 0;
   __pyx_t_4 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 364, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 432, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->SCru);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCru));
   __pyx_v_self->SCru = ((struct __pyx_obj_6libfds_7libfilt_SC3d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":365
+  /* "libfds/filters.pyx":433
  *         self.SCr = SC3d(self.fld.r, self.fld.K, self.fld.F, fld)
  *         self.SCru = SC3d(self.fld.ru, self.fld.Ku, self.fld.F, fld)
  *         self.SCrv = SC3d(self.fld.rv, self.fld.Kv, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCrw = SC3d(self.fld.rw, self.fld.Kw, self.fld.F, fld)
  *         self.SCre = SC3d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_4);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_2, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 433, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->SCrv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCrv));
   __pyx_v_self->SCrv = ((struct __pyx_obj_6libfds_7libfilt_SC3d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/filters.pyx":366
+  /* "libfds/filters.pyx":434
  *         self.SCru = SC3d(self.fld.ru, self.fld.Ku, self.fld.F, fld)
  *         self.SCrv = SC3d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  *         self.SCrw = SC3d(self.fld.rw, self.fld.Kw, self.fld.F, fld)             # <<<<<<<<<<<<<<
  *         self.SCre = SC3d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  * 
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_4 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 434, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->SCrw);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCrw));
   __pyx_v_self->SCrw = ((struct __pyx_obj_6libfds_7libfilt_SC3d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/filters.pyx":367
+  /* "libfds/filters.pyx":435
  *         self.SCrv = SC3d(self.fld.rv, self.fld.Kv, self.fld.F, fld)
  *         self.SCrw = SC3d(self.fld.rw, self.fld.Kw, self.fld.F, fld)
  *         self.SCre = SC3d(self.fld.re, self.fld.Ke, self.fld.F, fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void apply(self):
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 435, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 435, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 435, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   PyTuple_SET_ITEM(__pyx_t_4, 3, ((PyObject *)__pyx_v_fld));
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libfilt_SC3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 435, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->SCre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->SCre));
   __pyx_v_self->SCre = ((struct __pyx_obj_6libfds_7libfilt_SC3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/filters.pyx":357
+  /* "libfds/filters.pyx":425
  *     """
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -8581,15 +8583,15 @@
   __Pyx_AddTraceback("libfds.filters._ShockCapture3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":369
+/* "libfds/filters.pyx":437
  *         self.SCre = SC3d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply shock capture procedure. """
  * 
  */
 
@@ -8601,390 +8603,390 @@
   Py_ssize_t __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
 
-  /* "libfds/filters.pyx":375
+  /* "libfds/filters.pyx":443
  * 
  *         # Capture following x (Note : done at the end of sfilter)
  *         self.LPL.apply_x()             # <<<<<<<<<<<<<<
  *         self.SG.apply_x()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_LF3d *)__pyx_v_self->LPL->__pyx_vtab)->apply_x(__pyx_v_self->LPL, 0);
 
-  /* "libfds/filters.pyx":376
+  /* "libfds/filters.pyx":444
  *         # Capture following x (Note : done at the end of sfilter)
  *         self.LPL.apply_x()
  *         self.SG.apply_x()             # <<<<<<<<<<<<<<
  * 
  *         self.SCr.apply_x()
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_SG3d *)__pyx_v_self->SG->__pyx_vtab)->apply_x(__pyx_v_self->SG, 0);
 
-  /* "libfds/filters.pyx":378
+  /* "libfds/filters.pyx":446
  *         self.SG.apply_x()
  * 
  *         self.SCr.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCru.apply_x()
  *         self.SCrv.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCr->__pyx_vtab)->apply_x(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 378, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCr->__pyx_vtab)->apply_x(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 446, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":379
+  /* "libfds/filters.pyx":447
  * 
  *         self.SCr.apply_x()
  *         self.SCru.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCrv.apply_x()
  *         self.SCrw.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCru->__pyx_vtab)->apply_x(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 379, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCru->__pyx_vtab)->apply_x(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 447, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":380
+  /* "libfds/filters.pyx":448
  *         self.SCr.apply_x()
  *         self.SCru.apply_x()
  *         self.SCrv.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCrw.apply_x()
  *         self.SCre.apply_x()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_x(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 380, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_x(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 448, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":381
+  /* "libfds/filters.pyx":449
  *         self.SCru.apply_x()
  *         self.SCrv.apply_x()
  *         self.SCrw.apply_x()             # <<<<<<<<<<<<<<
  *         self.SCre.apply_x()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrw->__pyx_vtab)->apply_x(__pyx_v_self->SCrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 381, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrw->__pyx_vtab)->apply_x(__pyx_v_self->SCrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 449, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":382
+  /* "libfds/filters.pyx":450
  *         self.SCrv.apply_x()
  *         self.SCrw.apply_x()
  *         self.SCre.apply_x()             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.fld.xdomains:
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCre->__pyx_vtab)->apply_x(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 382, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCre->__pyx_vtab)->apply_x(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 450, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":384
+  /* "libfds/filters.pyx":452
  *         self.SCre.apply_x()
  * 
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->xdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 384, __pyx_L1_error)
+    __PYX_ERR(0, 452, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->xdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 452, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 384, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 452, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 384, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 452, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":385
+    /* "libfds/filters.pyx":453
  * 
  *         for sub in self.fld.xdomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Capture following y
  */
     __pyx_f_6libfds_7filters_15_ShockCapture3d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":384
+    /* "libfds/filters.pyx":452
  *         self.SCre.apply_x()
  * 
  *         for sub in self.fld.xdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":388
+  /* "libfds/filters.pyx":456
  * 
  *         # Capture following y
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  *         self.LPL.apply_y()
  *         self.SG.apply_y()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":389
+  /* "libfds/filters.pyx":457
  *         # Capture following y
  *         self.fld.update('p')
  *         self.LPL.apply_y()             # <<<<<<<<<<<<<<
  *         self.SG.apply_y()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_LF3d *)__pyx_v_self->LPL->__pyx_vtab)->apply_y(__pyx_v_self->LPL, 0);
 
-  /* "libfds/filters.pyx":390
+  /* "libfds/filters.pyx":458
  *         self.fld.update('p')
  *         self.LPL.apply_y()
  *         self.SG.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         self.SCr.apply_y()
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_SG3d *)__pyx_v_self->SG->__pyx_vtab)->apply_y(__pyx_v_self->SG, 0);
 
-  /* "libfds/filters.pyx":392
+  /* "libfds/filters.pyx":460
  *         self.SG.apply_y()
  * 
  *         self.SCr.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCru.apply_y()
  *         self.SCrv.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCr->__pyx_vtab)->apply_y(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 392, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCr->__pyx_vtab)->apply_y(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 460, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":393
+  /* "libfds/filters.pyx":461
  * 
  *         self.SCr.apply_y()
  *         self.SCru.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCrv.apply_y()
  *         self.SCrw.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCru->__pyx_vtab)->apply_y(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCru->__pyx_vtab)->apply_y(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 461, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":394
+  /* "libfds/filters.pyx":462
  *         self.SCr.apply_y()
  *         self.SCru.apply_y()
  *         self.SCrv.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCrw.apply_y()
  *         self.SCre.apply_y()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_y(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_y(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 462, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":395
+  /* "libfds/filters.pyx":463
  *         self.SCru.apply_y()
  *         self.SCrv.apply_y()
  *         self.SCrw.apply_y()             # <<<<<<<<<<<<<<
  *         self.SCre.apply_y()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrw->__pyx_vtab)->apply_y(__pyx_v_self->SCrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrw->__pyx_vtab)->apply_y(__pyx_v_self->SCrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 463, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":396
+  /* "libfds/filters.pyx":464
  *         self.SCrv.apply_y()
  *         self.SCrw.apply_y()
  *         self.SCre.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.fld.ydomains:
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCre->__pyx_vtab)->apply_y(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCre->__pyx_vtab)->apply_y(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 464, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":398
+  /* "libfds/filters.pyx":466
  *         self.SCre.apply_y()
  * 
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->ydomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 398, __pyx_L1_error)
+    __PYX_ERR(0, 466, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->ydomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 466, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 398, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 466, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 398, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 466, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":399
+    /* "libfds/filters.pyx":467
  * 
  *         for sub in self.fld.ydomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Capture following z
  */
     __pyx_f_6libfds_7filters_15_ShockCapture3d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":398
+    /* "libfds/filters.pyx":466
  *         self.SCre.apply_y()
  * 
  *         for sub in self.fld.ydomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":402
+  /* "libfds/filters.pyx":470
  * 
  *         # Capture following z
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  *         self.LPL.apply_z()
  *         self.SG.apply_z()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":403
+  /* "libfds/filters.pyx":471
  *         # Capture following z
  *         self.fld.update('p')
  *         self.LPL.apply_z()             # <<<<<<<<<<<<<<
  *         self.SG.apply_z()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_LF3d *)__pyx_v_self->LPL->__pyx_vtab)->apply_z(__pyx_v_self->LPL, 0);
 
-  /* "libfds/filters.pyx":404
+  /* "libfds/filters.pyx":472
  *         self.fld.update('p')
  *         self.LPL.apply_z()
  *         self.SG.apply_z()             # <<<<<<<<<<<<<<
  * 
  *         self.SCr.apply_z()
  */
   ((struct __pyx_vtabstruct_6libfds_7libfilt_SG3d *)__pyx_v_self->SG->__pyx_vtab)->apply_z(__pyx_v_self->SG, 0);
 
-  /* "libfds/filters.pyx":406
+  /* "libfds/filters.pyx":474
  *         self.SG.apply_z()
  * 
  *         self.SCr.apply_z()             # <<<<<<<<<<<<<<
  *         self.SCru.apply_z()
  *         self.SCrv.apply_z()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCr->__pyx_vtab)->apply_z(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 406, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCr->__pyx_vtab)->apply_z(__pyx_v_self->SCr, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 474, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":407
+  /* "libfds/filters.pyx":475
  * 
  *         self.SCr.apply_z()
  *         self.SCru.apply_z()             # <<<<<<<<<<<<<<
  *         self.SCrv.apply_z()
  *         self.SCrw.apply_z()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCru->__pyx_vtab)->apply_z(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCru->__pyx_vtab)->apply_z(__pyx_v_self->SCru, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 475, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":408
+  /* "libfds/filters.pyx":476
  *         self.SCr.apply_z()
  *         self.SCru.apply_z()
  *         self.SCrv.apply_z()             # <<<<<<<<<<<<<<
  *         self.SCrw.apply_z()
  *         self.SCre.apply_z()
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_z(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrv->__pyx_vtab)->apply_z(__pyx_v_self->SCrv, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 476, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":409
+  /* "libfds/filters.pyx":477
  *         self.SCru.apply_z()
  *         self.SCrv.apply_z()
  *         self.SCrw.apply_z()             # <<<<<<<<<<<<<<
  *         self.SCre.apply_z()
  * 
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrw->__pyx_vtab)->apply_z(__pyx_v_self->SCrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCrw->__pyx_vtab)->apply_z(__pyx_v_self->SCrw, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":410
+  /* "libfds/filters.pyx":478
  *         self.SCrv.apply_z()
  *         self.SCrw.apply_z()
  *         self.SCre.apply_z()             # <<<<<<<<<<<<<<
  * 
  *         for sub in self.fld.zdomains:
  */
-  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCre->__pyx_vtab)->apply_z(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
+  __pyx_t_1 = ((struct __pyx_vtabstruct_6libfds_7libfilt_SC3d *)__pyx_v_self->SCre->__pyx_vtab)->apply_z(__pyx_v_self->SCre, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":412
+  /* "libfds/filters.pyx":480
  *         self.SCre.apply_z()
  * 
  *         for sub in self.fld.zdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   if (unlikely(__pyx_v_self->fld->zdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 412, __pyx_L1_error)
+    __PYX_ERR(0, 480, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->zdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 412, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 480, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 412, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 412, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 480, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/filters.pyx":413
+    /* "libfds/filters.pyx":481
  * 
  *         for sub in self.fld.zdomains:
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *         # Update pressure
  */
     __pyx_f_6libfds_7filters_15_ShockCapture3d__update(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-    /* "libfds/filters.pyx":412
+    /* "libfds/filters.pyx":480
  *         self.SCre.apply_z()
  * 
  *         for sub in self.fld.zdomains:             # <<<<<<<<<<<<<<
  *             self._update(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/filters.pyx":416
+  /* "libfds/filters.pyx":484
  * 
  *         # Update pressure
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/filters.pyx":369
+  /* "libfds/filters.pyx":437
  *         self.SCre = SC3d(self.fld.re, self.fld.Ke, self.fld.F, fld)
  * 
  *     cpdef void apply(self):             # <<<<<<<<<<<<<<
  *         """ Apply shock capture procedure. """
  * 
  */
 
@@ -9018,15 +9020,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("apply", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_15_ShockCapture3d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 369, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_7filters_15_ShockCapture3d_apply(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 437, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -9035,15 +9037,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":418
+/* "libfds/filters.pyx":486
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """ Update fields. """
  * 
  */
 
@@ -9067,25 +9069,25 @@
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   __Pyx_RefNannySetupContext("_update", 0);
 
-  /* "libfds/filters.pyx":423
+  /* "libfds/filters.pyx":491
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/filters.pyx":424
+    /* "libfds/filters.pyx":492
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -9118,39 +9120,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":425
+                              /* "libfds/filters.pyx":493
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":426
+                                /* "libfds/filters.pyx":494
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":427
+                                  /* "libfds/filters.pyx":495
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -9171,15 +9173,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":424
+        /* "libfds/filters.pyx":492
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -9190,15 +9192,15 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/filters.pyx":429
+    /* "libfds/filters.pyx":497
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -9231,39 +9233,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":430
+                              /* "libfds/filters.pyx":498
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":431
+                                /* "libfds/filters.pyx":499
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":432
+                                  /* "libfds/filters.pyx":500
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -9284,15 +9286,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":429
+        /* "libfds/filters.pyx":497
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -9303,15 +9305,15 @@
             #endif
             goto __pyx_L19;
           }
           __pyx_L19:;
         }
     }
 
-    /* "libfds/filters.pyx":434
+    /* "libfds/filters.pyx":502
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -9344,39 +9346,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":435
+                              /* "libfds/filters.pyx":503
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":436
+                                /* "libfds/filters.pyx":504
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":437
+                                  /* "libfds/filters.pyx":505
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -9397,15 +9399,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":434
+        /* "libfds/filters.pyx":502
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -9416,15 +9418,15 @@
             #endif
             goto __pyx_L32;
           }
           __pyx_L32:;
         }
     }
 
-    /* "libfds/filters.pyx":439
+    /* "libfds/filters.pyx":507
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -9457,39 +9459,39 @@
                       for (__pyx_t_3 = 0; __pyx_t_3 < __pyx_t_2; __pyx_t_3++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_5 + 1 * __pyx_t_3);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":440
+                              /* "libfds/filters.pyx":508
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":441
+                                /* "libfds/filters.pyx":509
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":442
+                                  /* "libfds/filters.pyx":510
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -9510,15 +9512,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":439
+        /* "libfds/filters.pyx":507
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -9529,15 +9531,15 @@
             #endif
             goto __pyx_L45;
           }
           __pyx_L45:;
         }
     }
 
-    /* "libfds/filters.pyx":444
+    /* "libfds/filters.pyx":512
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -9570,39 +9572,39 @@
                       for (__pyx_t_4 = 0; __pyx_t_4 < __pyx_t_5; __pyx_t_4++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":445
+                              /* "libfds/filters.pyx":513
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/filters.pyx":446
+                                /* "libfds/filters.pyx":514
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  *         else:
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/filters.pyx":447
+                                  /* "libfds/filters.pyx":515
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -9623,15 +9625,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":444
+        /* "libfds/filters.pyx":512
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -9642,62 +9644,62 @@
             #endif
             goto __pyx_L58;
           }
           __pyx_L58:;
         }
     }
 
-    /* "libfds/filters.pyx":423
+    /* "libfds/filters.pyx":491
  *         cdef Py_ssize_t ix, iy, iz
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":449
+  /* "libfds/filters.pyx":517
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":450
+      /* "libfds/filters.pyx":518
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":451
+        /* "libfds/filters.pyx":519
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":452
+          /* "libfds/filters.pyx":520
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -9707,51 +9709,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_17 * __pyx_v_self->fld->r.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->r.strides[1]) )) + __pyx_t_15)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->K.data + __pyx_t_14 * __pyx_v_self->fld->K.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->K.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":454
+    /* "libfds/filters.pyx":522
  *                         self.fld.r[ix, iy, iz] -= self.fld.K[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":455
+      /* "libfds/filters.pyx":523
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":456
+        /* "libfds/filters.pyx":524
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":457
+          /* "libfds/filters.pyx":525
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -9761,51 +9763,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_15 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_17)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ku.data + __pyx_t_12 * __pyx_v_self->fld->Ku.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ku.strides[1]) )) + __pyx_t_14)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":459
+    /* "libfds/filters.pyx":527
  *                         self.fld.ru[ix, iy, iz] -= self.fld.Ku[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":460
+      /* "libfds/filters.pyx":528
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":461
+        /* "libfds/filters.pyx":529
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":462
+          /* "libfds/filters.pyx":530
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -9815,51 +9817,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_17 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_15)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Kv.data + __pyx_t_14 * __pyx_v_self->fld->Kv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Kv.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":464
+    /* "libfds/filters.pyx":532
  *                         self.fld.rv[ix, iy, iz] -= self.fld.Kv[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":465
+      /* "libfds/filters.pyx":533
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":466
+        /* "libfds/filters.pyx":534
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":467
+          /* "libfds/filters.pyx":535
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *             for ix in range(ixmin, ixmax + 1):
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -9869,51 +9871,51 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_15 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_17)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Kw.data + __pyx_t_12 * __pyx_v_self->fld->Kw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Kw.strides[1]) )) + __pyx_t_14)) )));
         }
       }
     }
 
-    /* "libfds/filters.pyx":469
+    /* "libfds/filters.pyx":537
  *                         self.fld.rw[ix, iy, iz] -= self.fld.Kw[ix, iy, iz]
  * 
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/filters.pyx":470
+      /* "libfds/filters.pyx":538
  * 
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/filters.pyx":471
+        /* "libfds/filters.pyx":539
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]
  * 
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/filters.pyx":472
+          /* "libfds/filters.pyx":540
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  *                         self.fld.re[ix, iy, iz] -= self.fld.Ke[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -9925,15 +9927,15 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_17 * __pyx_v_self->fld->re.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->re.strides[1]) )) + __pyx_t_15)) )) -= (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ke.data + __pyx_t_14 * __pyx_v_self->fld->Ke.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ke.strides[1]) )) + __pyx_t_12)) )));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":418
+  /* "libfds/filters.pyx":486
  *         self.fld.update('p')
  * 
  *     cdef void _update(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """ Update fields. """
  * 
  */
 
@@ -10050,20 +10052,20 @@
   __Pyx_AddTraceback("libfds.filters._ShockCapture3d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":475
+/* "libfds/filters.pyx":543
  * 
  * 
  * cpdef double[:, ::1] sfilter(double[:, ::1] v, double xnu_n, double xnu_0, int axis=-1, int cpu=1):             # <<<<<<<<<<<<<<
- *     """
- *         Returns high filtered v array.
+ *     """ 2d Selective Filter calculated using technique described in [1]_.
+ * 
  */
 
 static PyObject *__pyx_pw_6libfds_7filters_5sfilter(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static __Pyx_memviewslice __pyx_f_6libfds_7filters_sfilter(__Pyx_memviewslice __pyx_v_v, double __pyx_v_xnu_n, double __pyx_v_xnu_0, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6libfds_7filters_sfilter *__pyx_optional_args) {
   int __pyx_v_axis = ((int)-1);
   int __pyx_v_cpu = ((int)1);
   __Pyx_memviewslice __pyx_v_vf = { 0, 0, { 0 }, { 0 }, { 0 } };
@@ -10079,103 +10081,103 @@
       __pyx_v_axis = __pyx_optional_args->axis;
       if (__pyx_optional_args->__pyx_n > 1) {
         __pyx_v_cpu = __pyx_optional_args->cpu;
       }
     }
   }
 
-  /* "libfds/filters.pyx":482
+  /* "libfds/filters.pyx":574
  *     cdef double[:, ::1] vf
  * 
  *     if axis == 0:             # <<<<<<<<<<<<<<
  *         return _sfilter_x(v, xnu_n, xnu_0, cpu)
  *     elif axis == 1:
  */
   switch (__pyx_v_axis) {
     case 0:
 
-    /* "libfds/filters.pyx":483
+    /* "libfds/filters.pyx":575
  * 
  *     if axis == 0:
  *         return _sfilter_x(v, xnu_n, xnu_0, cpu)             # <<<<<<<<<<<<<<
  *     elif axis == 1:
  *         return _sfilter_y(v, xnu_n, xnu_0, cpu)
  */
-    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_x(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 483, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_x(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 575, __pyx_L1_error)
     __pyx_r = __pyx_t_1;
     __pyx_t_1.memview = NULL;
     __pyx_t_1.data = NULL;
     goto __pyx_L0;
 
-    /* "libfds/filters.pyx":482
+    /* "libfds/filters.pyx":574
  *     cdef double[:, ::1] vf
  * 
  *     if axis == 0:             # <<<<<<<<<<<<<<
  *         return _sfilter_x(v, xnu_n, xnu_0, cpu)
  *     elif axis == 1:
  */
     break;
     case 1:
 
-    /* "libfds/filters.pyx":485
+    /* "libfds/filters.pyx":577
  *         return _sfilter_x(v, xnu_n, xnu_0, cpu)
  *     elif axis == 1:
  *         return _sfilter_y(v, xnu_n, xnu_0, cpu)             # <<<<<<<<<<<<<<
  *     else:
  *         vf = _sfilter_x(v, xnu_n, xnu_0, cpu)
  */
-    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_y(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 485, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_y(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 577, __pyx_L1_error)
     __pyx_r = __pyx_t_1;
     __pyx_t_1.memview = NULL;
     __pyx_t_1.data = NULL;
     goto __pyx_L0;
 
-    /* "libfds/filters.pyx":484
+    /* "libfds/filters.pyx":576
  *     if axis == 0:
  *         return _sfilter_x(v, xnu_n, xnu_0, cpu)
  *     elif axis == 1:             # <<<<<<<<<<<<<<
  *         return _sfilter_y(v, xnu_n, xnu_0, cpu)
  *     else:
  */
     break;
     default:
 
-    /* "libfds/filters.pyx":487
+    /* "libfds/filters.pyx":579
  *         return _sfilter_y(v, xnu_n, xnu_0, cpu)
  *     else:
  *         vf = _sfilter_x(v, xnu_n, xnu_0, cpu)             # <<<<<<<<<<<<<<
  *         return _sfilter_y(vf, xnu_n, xnu_0, cpu)
  * 
  */
-    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_x(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 487, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_x(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 579, __pyx_L1_error)
     __pyx_v_vf = __pyx_t_1;
     __pyx_t_1.memview = NULL;
     __pyx_t_1.data = NULL;
 
-    /* "libfds/filters.pyx":488
+    /* "libfds/filters.pyx":580
  *     else:
  *         vf = _sfilter_x(v, xnu_n, xnu_0, cpu)
  *         return _sfilter_y(vf, xnu_n, xnu_0, cpu)             # <<<<<<<<<<<<<<
  * 
  * 
  */
-    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_y(__pyx_v_vf, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 488, __pyx_L1_error)
+    __pyx_t_1 = __pyx_f_6libfds_7filters__sfilter_y(__pyx_v_vf, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_cpu); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 580, __pyx_L1_error)
     __pyx_r = __pyx_t_1;
     __pyx_t_1.memview = NULL;
     __pyx_t_1.data = NULL;
     goto __pyx_L0;
     break;
   }
 
-  /* "libfds/filters.pyx":475
+  /* "libfds/filters.pyx":543
  * 
  * 
  * cpdef double[:, ::1] sfilter(double[:, ::1] v, double xnu_n, double xnu_0, int axis=-1, int cpu=1):             # <<<<<<<<<<<<<<
- *     """
- *         Returns high filtered v array.
+ *     """ 2d Selective Filter calculated using technique described in [1]_.
+ * 
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_r.data = NULL;
   __pyx_r.memview = NULL;
@@ -10189,15 +10191,15 @@
   __PYX_XDEC_MEMVIEW(&__pyx_v_vf, 1);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_7filters_5sfilter(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
-static char __pyx_doc_6libfds_7filters_4sfilter[] = "\n        Returns high filtered v array.\n    ";
+static char __pyx_doc_6libfds_7filters_4sfilter[] = " 2d Selective Filter calculated using technique described in [1]_.\n\n    Parameters\n    ----------\n    v: numpy.array\n        Array to be filtered.\n    xnu_n: float\n        Filter strength.\n    xnu_0: float\n        Filter strength on the points near a wall.\n    axis: int, optional\n        Direction of the filter. if axis not in [0, 1], the filter operates on both directions.\n    cpu: int, optional\n        Number of cpu to use for the computation.\n\n    Returns\n    -------\n    vf: numpy.array\n        The filtered array\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n        flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n        Pages 194-214.\n    ";
 static PyObject *__pyx_pw_6libfds_7filters_5sfilter(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   __Pyx_memviewslice __pyx_v_v = { 0, 0, { 0 }, { 0 }, { 0 } };
   double __pyx_v_xnu_n;
   double __pyx_v_xnu_0;
   int __pyx_v_axis;
   int __pyx_v_cpu;
   int __pyx_lineno = 0;
@@ -10231,21 +10233,21 @@
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_v)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
         CYTHON_FALLTHROUGH;
         case  1:
         if (likely((values[1] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_xnu_n)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("sfilter", 0, 3, 5, 1); __PYX_ERR(0, 475, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("sfilter", 0, 3, 5, 1); __PYX_ERR(0, 543, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  2:
         if (likely((values[2] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_xnu_0)) != 0)) kw_args--;
         else {
-          __Pyx_RaiseArgtupleInvalid("sfilter", 0, 3, 5, 2); __PYX_ERR(0, 475, __pyx_L3_error)
+          __Pyx_RaiseArgtupleInvalid("sfilter", 0, 3, 5, 2); __PYX_ERR(0, 543, __pyx_L3_error)
         }
         CYTHON_FALLTHROUGH;
         case  3:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_axis);
           if (value) { values[3] = value; kw_args--; }
         }
@@ -10253,46 +10255,46 @@
         case  4:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cpu);
           if (value) { values[4] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sfilter") < 0)) __PYX_ERR(0, 475, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "sfilter") < 0)) __PYX_ERR(0, 543, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  5: values[4] = PyTuple_GET_ITEM(__pyx_args, 4);
         CYTHON_FALLTHROUGH;
         case  4: values[3] = PyTuple_GET_ITEM(__pyx_args, 3);
         CYTHON_FALLTHROUGH;
         case  3: values[2] = PyTuple_GET_ITEM(__pyx_args, 2);
         values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
         default: goto __pyx_L5_argtuple_error;
       }
     }
-    __pyx_v_v = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_v.memview)) __PYX_ERR(0, 475, __pyx_L3_error)
-    __pyx_v_xnu_n = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_xnu_n == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L3_error)
-    __pyx_v_xnu_0 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_xnu_0 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L3_error)
+    __pyx_v_v = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(values[0], PyBUF_WRITABLE); if (unlikely(!__pyx_v_v.memview)) __PYX_ERR(0, 543, __pyx_L3_error)
+    __pyx_v_xnu_n = __pyx_PyFloat_AsDouble(values[1]); if (unlikely((__pyx_v_xnu_n == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 543, __pyx_L3_error)
+    __pyx_v_xnu_0 = __pyx_PyFloat_AsDouble(values[2]); if (unlikely((__pyx_v_xnu_0 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 543, __pyx_L3_error)
     if (values[3]) {
-      __pyx_v_axis = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_axis == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L3_error)
+      __pyx_v_axis = __Pyx_PyInt_As_int(values[3]); if (unlikely((__pyx_v_axis == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 543, __pyx_L3_error)
     } else {
       __pyx_v_axis = ((int)-1);
     }
     if (values[4]) {
-      __pyx_v_cpu = __Pyx_PyInt_As_int(values[4]); if (unlikely((__pyx_v_cpu == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 475, __pyx_L3_error)
+      __pyx_v_cpu = __Pyx_PyInt_As_int(values[4]); if (unlikely((__pyx_v_cpu == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 543, __pyx_L3_error)
     } else {
       __pyx_v_cpu = ((int)1);
     }
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("sfilter", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 475, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("sfilter", 0, 3, 5, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 543, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.filters.sfilter", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_7filters_4sfilter(__pyx_self, __pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, __pyx_v_axis, __pyx_v_cpu);
 
@@ -10311,16 +10313,16 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("sfilter", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 2;
   __pyx_t_2.axis = __pyx_v_axis;
   __pyx_t_2.cpu = __pyx_v_cpu;
-  __pyx_t_1 = __pyx_f_6libfds_7filters_sfilter(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 475, __pyx_L1_error)
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 475, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_7filters_sfilter(__pyx_v_v, __pyx_v_xnu_n, __pyx_v_xnu_0, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 543, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_1, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 543, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __PYX_XDEC_MEMVIEW(&__pyx_t_1, 1);
   __pyx_t_1.memview = NULL;
   __pyx_t_1.data = NULL;
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
@@ -10334,15 +10336,15 @@
   __pyx_L0:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_v, 1);
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":491
+/* "libfds/filters.pyx":583
  * 
  * 
  * cdef double[:, ::1] _sfilter_x(double[:, ::1] v, double xnu_n, double xnu_0, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy
  */
 
@@ -10391,79 +10393,79 @@
   Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_sfilter_x", 0);
 
-  /* "libfds/filters.pyx":494
+  /* "libfds/filters.pyx":586
  * 
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = v.shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t ny = v.shape[1]
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  */
   __pyx_v_nx = (__pyx_v_v.shape[0]);
 
-  /* "libfds/filters.pyx":495
+  /* "libfds/filters.pyx":587
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = v.shape[0]
  *     cdef Py_ssize_t ny = v.shape[1]             # <<<<<<<<<<<<<<
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  * 
  */
   __pyx_v_ny = (__pyx_v_v.shape[1]);
 
-  /* "libfds/filters.pyx":496
+  /* "libfds/filters.pyx":588
  *     cdef Py_ssize_t nx = v.shape[0]
  *     cdef Py_ssize_t ny = v.shape[1]
  *     cdef double[:, ::1] vf = _np.zeros_like(v)             # <<<<<<<<<<<<<<
  * 
  *     if cpu > 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 588, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 588, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_v, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_v, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 588, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 588, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 496, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 588, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_vf = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/filters.pyx":498
+  /* "libfds/filters.pyx":590
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  */
   __pyx_t_6 = ((__pyx_v_cpu > 1) != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/filters.pyx":499
+    /* "libfds/filters.pyx":591
  * 
  *     if cpu > 1:
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  */
     {
@@ -10494,97 +10496,97 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_9; __pyx_t_8++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(5 + 1 * __pyx_t_8);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":500
+                              /* "libfds/filters.pyx":592
  *     if cpu > 1:
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):
  *             for iy in range(ny):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  */
                               __pyx_t_10 = __pyx_v_ny;
                               __pyx_t_11 = __pyx_t_10;
                               for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
                                 __pyx_v_iy = __pyx_t_12;
 
-                                /* "libfds/filters.pyx":501
+                                /* "libfds/filters.pyx":593
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  */
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":502
+                                /* "libfds/filters.pyx":594
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  */
                                 __pyx_t_15 = (__pyx_v_ix + 1);
                                 __pyx_t_16 = __pyx_v_iy;
                                 __pyx_t_17 = (__pyx_v_ix - 1);
                                 __pyx_t_18 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":503
+                                /* "libfds/filters.pyx":595
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +
  */
                                 __pyx_t_19 = (__pyx_v_ix + 2);
                                 __pyx_t_20 = __pyx_v_iy;
                                 __pyx_t_21 = (__pyx_v_ix - 2);
                                 __pyx_t_22 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":504
+                                /* "libfds/filters.pyx":596
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))
  */
                                 __pyx_t_23 = (__pyx_v_ix + 3);
                                 __pyx_t_24 = __pyx_v_iy;
                                 __pyx_t_25 = (__pyx_v_ix - 3);
                                 __pyx_t_26 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":505
+                                /* "libfds/filters.pyx":597
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))
  *     else:
  */
                                 __pyx_t_27 = (__pyx_v_ix + 4);
                                 __pyx_t_28 = __pyx_v_iy;
                                 __pyx_t_29 = (__pyx_v_ix - 4);
                                 __pyx_t_30 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":506
+                                /* "libfds/filters.pyx":598
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))             # <<<<<<<<<<<<<<
  *     else:
  *         for ix in range(5, nx - 5):
  */
                                 __pyx_t_31 = (__pyx_v_ix + 5);
                                 __pyx_t_32 = __pyx_v_iy;
                                 __pyx_t_33 = (__pyx_v_ix - 5);
                                 __pyx_t_34 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":501
+                                /* "libfds/filters.pyx":593
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  */
                                 __pyx_t_35 = __pyx_v_ix;
@@ -10600,15 +10602,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":499
+        /* "libfds/filters.pyx":591
  * 
  *     if cpu > 1:
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  */
         /*finally:*/ {
@@ -10619,1081 +10621,1081 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/filters.pyx":498
+    /* "libfds/filters.pyx":590
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(5, nx - 5, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":508
+  /* "libfds/filters.pyx":600
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))
  *     else:
  *         for ix in range(5, nx - 5):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  */
   /*else*/ {
     __pyx_t_9 = (__pyx_v_nx - 5);
     __pyx_t_8 = __pyx_t_9;
     for (__pyx_t_7 = 5; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
       __pyx_v_ix = __pyx_t_7;
 
-      /* "libfds/filters.pyx":509
+      /* "libfds/filters.pyx":601
  *     else:
  *         for ix in range(5, nx - 5):
  *             for iy in range(ny):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  */
       __pyx_t_10 = __pyx_v_ny;
       __pyx_t_11 = __pyx_t_10;
       for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/filters.pyx":510
+        /* "libfds/filters.pyx":602
  *         for ix in range(5, nx - 5):
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  */
         __pyx_t_34 = __pyx_v_ix;
         __pyx_t_33 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":511
+        /* "libfds/filters.pyx":603
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  */
         __pyx_t_32 = (__pyx_v_ix + 1);
         __pyx_t_31 = __pyx_v_iy;
         __pyx_t_30 = (__pyx_v_ix - 1);
         __pyx_t_29 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":512
+        /* "libfds/filters.pyx":604
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +
  */
         __pyx_t_28 = (__pyx_v_ix + 2);
         __pyx_t_27 = __pyx_v_iy;
         __pyx_t_26 = (__pyx_v_ix - 2);
         __pyx_t_25 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":513
+        /* "libfds/filters.pyx":605
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))
  */
         __pyx_t_24 = (__pyx_v_ix + 3);
         __pyx_t_23 = __pyx_v_iy;
         __pyx_t_22 = (__pyx_v_ix - 3);
         __pyx_t_21 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":514
+        /* "libfds/filters.pyx":606
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +             # <<<<<<<<<<<<<<
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))
  * 
  */
         __pyx_t_20 = (__pyx_v_ix + 4);
         __pyx_t_19 = __pyx_v_iy;
         __pyx_t_18 = (__pyx_v_ix - 4);
         __pyx_t_17 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":515
+        /* "libfds/filters.pyx":607
  *                                     d11c[3]*(v[ix+3, iy] + v[ix-3, iy]) +
  *                                     d11c[4]*(v[ix+4, iy] + v[ix-4, iy]) +
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))             # <<<<<<<<<<<<<<
  * 
  *     for iy in range(ny):
  */
         __pyx_t_16 = (__pyx_v_ix + 5);
         __pyx_t_15 = __pyx_v_iy;
         __pyx_t_14 = (__pyx_v_ix - 5);
         __pyx_t_13 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":510
+        /* "libfds/filters.pyx":602
  *         for ix in range(5, nx - 5):
  *             for iy in range(ny):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix+1, iy] + v[ix-1, iy]) +
  *                                     d11c[2]*(v[ix+2, iy] + v[ix-2, iy]) +
  */
         __pyx_t_36 = __pyx_v_ix;
         __pyx_t_35 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((d11c[0]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) )))) + ((d11c[1]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) )))))) + ((d11c[2]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))))) + ((d11c[3]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) )))))) + ((d11c[4]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) )))))) + ((d11c[5]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) )))))));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":517
+  /* "libfds/filters.pyx":609
  *                                     d11c[5]*(v[ix+5, iy] + v[ix-5, iy]))
  * 
  *     for iy in range(ny):             # <<<<<<<<<<<<<<
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  */
   __pyx_t_9 = __pyx_v_ny;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_iy = __pyx_t_7;
 
-    /* "libfds/filters.pyx":518
+    /* "libfds/filters.pyx":610
  * 
  *     for iy in range(ny):
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  */
     __pyx_t_13 = 0;
     __pyx_t_14 = __pyx_v_iy;
     __pyx_t_15 = 1;
     __pyx_t_16 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":519
+    /* "libfds/filters.pyx":611
  *     for iy in range(ny):
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])             # <<<<<<<<<<<<<<
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  */
     __pyx_t_17 = 2;
     __pyx_t_18 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":518
+    /* "libfds/filters.pyx":610
  * 
  *     for iy in range(ny):
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  */
     __pyx_t_19 = 3;
     __pyx_t_20 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":519
+    /* "libfds/filters.pyx":611
  *     for iy in range(ny):
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])             # <<<<<<<<<<<<<<
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  */
     __pyx_t_21 = 0;
     __pyx_t_22 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_21 * __pyx_v_vf.strides[0]) )) + __pyx_t_22)) )) = (__pyx_v_xnu_0 * ((((((d11d[1])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) )))) + (((d11d[1])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) ))))) + (((d11d[1])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[1])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))));
 
-    /* "libfds/filters.pyx":520
+    /* "libfds/filters.pyx":612
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  */
     __pyx_t_20 = 0;
     __pyx_t_19 = __pyx_v_iy;
     __pyx_t_18 = 1;
     __pyx_t_17 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":521
+    /* "libfds/filters.pyx":613
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  *                            d11d[2][7]*v[6, iy])
  */
     __pyx_t_16 = 2;
     __pyx_t_15 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":520
+    /* "libfds/filters.pyx":612
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  */
     __pyx_t_14 = 3;
     __pyx_t_13 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":522
+    /* "libfds/filters.pyx":614
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[2][7]*v[6, iy])
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +
  */
     __pyx_t_22 = 4;
     __pyx_t_21 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":521
+    /* "libfds/filters.pyx":613
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  *                            d11d[2][7]*v[6, iy])
  */
     __pyx_t_23 = 5;
     __pyx_t_24 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":523
+    /* "libfds/filters.pyx":615
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  *                            d11d[2][7]*v[6, iy])             # <<<<<<<<<<<<<<
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  */
     __pyx_t_25 = 6;
     __pyx_t_26 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":520
+    /* "libfds/filters.pyx":612
  *         vf[0, iy] = xnu_0*(d11d[1][1]*v[0, iy] + d11d[1][2]*v[1, iy] +
  *                            d11d[1][3]*v[2, iy] + d11d[1][4]*v[3, iy])
  *         vf[1, iy] = xnu_n*(d11d[2][1]*v[0, iy] + d11d[2][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[2][3]*v[2, iy] + d11d[2][4]*v[3, iy] +
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  */
     __pyx_t_27 = 1;
     __pyx_t_28 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_27 * __pyx_v_vf.strides[0]) )) + __pyx_t_28)) )) = (__pyx_v_xnu_n * (((((((((d11d[2])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) )))) + (((d11d[2])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[2])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))) + (((d11d[2])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) ))))) + (((d11d[2])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[2])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[2])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
 
-    /* "libfds/filters.pyx":524
+    /* "libfds/filters.pyx":616
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  *                            d11d[2][7]*v[6, iy])
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  */
     __pyx_t_26 = 0;
     __pyx_t_25 = __pyx_v_iy;
     __pyx_t_24 = 1;
     __pyx_t_23 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":525
+    /* "libfds/filters.pyx":617
  *                            d11d[2][7]*v[6, iy])
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +
  */
     __pyx_t_21 = 2;
     __pyx_t_22 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":524
+    /* "libfds/filters.pyx":616
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  *                            d11d[2][7]*v[6, iy])
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  */
     __pyx_t_13 = 3;
     __pyx_t_14 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":526
+    /* "libfds/filters.pyx":618
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  */
     __pyx_t_15 = 4;
     __pyx_t_16 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":525
+    /* "libfds/filters.pyx":617
  *                            d11d[2][7]*v[6, iy])
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +
  */
     __pyx_t_17 = 5;
     __pyx_t_18 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":527
+    /* "libfds/filters.pyx":619
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  *                            d11d[3][11]*v[10, iy])
  */
     __pyx_t_19 = 6;
     __pyx_t_20 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":526
+    /* "libfds/filters.pyx":618
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  */
     __pyx_t_28 = 7;
     __pyx_t_27 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":528
+    /* "libfds/filters.pyx":620
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][11]*v[10, iy])
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +
  */
     __pyx_t_29 = 8;
     __pyx_t_30 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":527
+    /* "libfds/filters.pyx":619
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  *                            d11d[3][11]*v[10, iy])
  */
     __pyx_t_31 = 9;
     __pyx_t_32 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":529
+    /* "libfds/filters.pyx":621
  *                            d11d[3][7]*v[6, iy] + d11d[3][8]*v[7, iy] +
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  *                            d11d[3][11]*v[10, iy])             # <<<<<<<<<<<<<<
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  */
     __pyx_t_33 = 10;
     __pyx_t_34 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":524
+    /* "libfds/filters.pyx":616
  *                            d11d[2][5]*v[4, iy] + d11d[2][6]*v[5, iy] +
  *                            d11d[2][7]*v[6, iy])
  *         vf[2, iy] = xnu_n*(d11d[3][1]*v[0, iy] + d11d[3][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[3][3]*v[2, iy] + d11d[3][4]*v[3, iy] +
  *                            d11d[3][5]*v[4, iy] + d11d[3][6]*v[5, iy] +
  */
     __pyx_t_35 = 2;
     __pyx_t_36 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_35 * __pyx_v_vf.strides[0]) )) + __pyx_t_36)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[3])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))) + (((d11d[3])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))))) + (((d11d[3])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) )) + __pyx_t_22)) ))))) + (((d11d[3])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[3])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) ))))) + (((d11d[3])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[3])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[3])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))))) + (((d11d[3])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[3])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[3])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))));
 
-    /* "libfds/filters.pyx":530
+    /* "libfds/filters.pyx":622
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  *                            d11d[3][11]*v[10, iy])
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  */
     __pyx_t_34 = 0;
     __pyx_t_33 = __pyx_v_iy;
     __pyx_t_32 = 1;
     __pyx_t_31 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":531
+    /* "libfds/filters.pyx":623
  *                            d11d[3][11]*v[10, iy])
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +
  */
     __pyx_t_30 = 2;
     __pyx_t_29 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":530
+    /* "libfds/filters.pyx":622
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  *                            d11d[3][11]*v[10, iy])
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  */
     __pyx_t_27 = 3;
     __pyx_t_28 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":532
+    /* "libfds/filters.pyx":624
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  */
     __pyx_t_20 = 4;
     __pyx_t_19 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":531
+    /* "libfds/filters.pyx":623
  *                            d11d[3][11]*v[10, iy])
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +
  */
     __pyx_t_18 = 5;
     __pyx_t_17 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":533
+    /* "libfds/filters.pyx":625
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  *                            d11d[4][11]*v[10, iy])
  */
     __pyx_t_16 = 6;
     __pyx_t_15 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":532
+    /* "libfds/filters.pyx":624
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  */
     __pyx_t_14 = 7;
     __pyx_t_13 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":534
+    /* "libfds/filters.pyx":626
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][11]*v[10, iy])
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +
  */
     __pyx_t_22 = 8;
     __pyx_t_21 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":533
+    /* "libfds/filters.pyx":625
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  *                            d11d[4][11]*v[10, iy])
  */
     __pyx_t_23 = 9;
     __pyx_t_24 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":535
+    /* "libfds/filters.pyx":627
  *                            d11d[4][7]*v[6, iy] + d11d[4][8]*v[7, iy] +
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  *                            d11d[4][11]*v[10, iy])             # <<<<<<<<<<<<<<
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  */
     __pyx_t_25 = 10;
     __pyx_t_26 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":530
+    /* "libfds/filters.pyx":622
  *                            d11d[3][9]*v[8, iy] + d11d[3][10]*v[9, iy] +
  *                            d11d[3][11]*v[10, iy])
  *         vf[3, iy] = xnu_n*(d11d[4][1]*v[0, iy] + d11d[4][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[4][3]*v[2, iy] + d11d[4][4]*v[3, iy] +
  *                            d11d[4][5]*v[4, iy] + d11d[4][6]*v[5, iy] +
  */
     __pyx_t_36 = 3;
     __pyx_t_35 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[4])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) )))) + (((d11d[4])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[4])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[4])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))) + (((d11d[4])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))))) + (((d11d[4])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[4])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))) + (((d11d[4])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) ))))) + (((d11d[4])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[4])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[4])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
 
-    /* "libfds/filters.pyx":536
+    /* "libfds/filters.pyx":628
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  *                            d11d[4][11]*v[10, iy])
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  */
     __pyx_t_26 = 0;
     __pyx_t_25 = __pyx_v_iy;
     __pyx_t_24 = 1;
     __pyx_t_23 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":537
+    /* "libfds/filters.pyx":629
  *                            d11d[4][11]*v[10, iy])
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +
  */
     __pyx_t_21 = 2;
     __pyx_t_22 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":536
+    /* "libfds/filters.pyx":628
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  *                            d11d[4][11]*v[10, iy])
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  */
     __pyx_t_13 = 3;
     __pyx_t_14 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":538
+    /* "libfds/filters.pyx":630
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +
  *                            d11d[5][9]*v[8, iy] + d11d[5][10]*v[9, iy] +
  */
     __pyx_t_15 = 4;
     __pyx_t_16 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":537
+    /* "libfds/filters.pyx":629
  *                            d11d[4][11]*v[10, iy])
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +
  */
     __pyx_t_17 = 5;
     __pyx_t_18 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":539
+    /* "libfds/filters.pyx":631
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][9]*v[8, iy] + d11d[5][10]*v[9, iy] +
  *                            d11d[5][11]*v[10, iy])
  */
     __pyx_t_19 = 6;
     __pyx_t_20 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":538
+    /* "libfds/filters.pyx":630
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +
  *                            d11d[5][9]*v[8, iy] + d11d[5][10]*v[9, iy] +
  */
     __pyx_t_28 = 7;
     __pyx_t_27 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":540
+    /* "libfds/filters.pyx":632
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +
  *                            d11d[5][9]*v[8, iy] + d11d[5][10]*v[9, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][11]*v[10, iy])
  * 
  */
     __pyx_t_29 = 8;
     __pyx_t_30 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":539
+    /* "libfds/filters.pyx":631
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][9]*v[8, iy] + d11d[5][10]*v[9, iy] +
  *                            d11d[5][11]*v[10, iy])
  */
     __pyx_t_31 = 9;
     __pyx_t_32 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":541
+    /* "libfds/filters.pyx":633
  *                            d11d[5][7]*v[6, iy] + d11d[5][8]*v[7, iy] +
  *                            d11d[5][9]*v[8, iy] + d11d[5][10]*v[9, iy] +
  *                            d11d[5][11]*v[10, iy])             # <<<<<<<<<<<<<<
  * 
  *     for iy in range(ny):
  */
     __pyx_t_33 = 10;
     __pyx_t_34 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":536
+    /* "libfds/filters.pyx":628
  *                            d11d[4][9]*v[8, iy] + d11d[4][10]*v[9, iy] +
  *                            d11d[4][11]*v[10, iy])
  *         vf[4, iy] = xnu_n*(d11d[5][1]*v[0, iy] + d11d[5][2]*v[1, iy] +             # <<<<<<<<<<<<<<
  *                            d11d[5][3]*v[2, iy] + d11d[5][4]*v[3, iy] +
  *                            d11d[5][5]*v[4, iy] + d11d[5][6]*v[5, iy] +
  */
     __pyx_t_35 = 4;
     __pyx_t_36 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_35 * __pyx_v_vf.strides[0]) )) + __pyx_t_36)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[5])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))) + (((d11d[5])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))))) + (((d11d[5])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) )) + __pyx_t_22)) ))))) + (((d11d[5])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[5])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) ))))) + (((d11d[5])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[5])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[5])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))))) + (((d11d[5])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[5])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[5])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))));
   }
 
-  /* "libfds/filters.pyx":543
+  /* "libfds/filters.pyx":635
  *                            d11d[5][11]*v[10, iy])
  * 
  *     for iy in range(ny):             # <<<<<<<<<<<<<<
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  */
   __pyx_t_9 = __pyx_v_ny;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_iy = __pyx_t_7;
 
-    /* "libfds/filters.pyx":544
+    /* "libfds/filters.pyx":636
  * 
  *     for iy in range(ny):
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  */
     __pyx_t_34 = (__pyx_v_nx - 1);
     __pyx_t_33 = __pyx_v_iy;
     __pyx_t_32 = (__pyx_v_nx - 2);
     __pyx_t_31 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":545
+    /* "libfds/filters.pyx":637
  *     for iy in range(ny):
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])             # <<<<<<<<<<<<<<
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  */
     __pyx_t_30 = (__pyx_v_nx - 3);
     __pyx_t_29 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":544
+    /* "libfds/filters.pyx":636
  * 
  *     for iy in range(ny):
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  */
     __pyx_t_27 = (__pyx_v_nx - 4);
     __pyx_t_28 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":545
+    /* "libfds/filters.pyx":637
  *     for iy in range(ny):
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])             # <<<<<<<<<<<<<<
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  */
     __pyx_t_20 = (__pyx_v_nx - 1);
     __pyx_t_19 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_20 * __pyx_v_vf.strides[0]) )) + __pyx_t_19)) )) = (__pyx_v_xnu_0 * ((((((d11d[1])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) )))) + (((d11d[1])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[1])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[1])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))));
 
-    /* "libfds/filters.pyx":546
+    /* "libfds/filters.pyx":638
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  */
     __pyx_t_28 = (__pyx_v_nx - 1);
     __pyx_t_27 = __pyx_v_iy;
     __pyx_t_29 = (__pyx_v_nx - 2);
     __pyx_t_30 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":547
+    /* "libfds/filters.pyx":639
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  *                               d11d[2][7]*v[nx-7, iy])
  */
     __pyx_t_31 = (__pyx_v_nx - 3);
     __pyx_t_32 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":546
+    /* "libfds/filters.pyx":638
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  */
     __pyx_t_33 = (__pyx_v_nx - 4);
     __pyx_t_34 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":548
+    /* "libfds/filters.pyx":640
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[2][7]*v[nx-7, iy])
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +
  */
     __pyx_t_19 = (__pyx_v_nx - 5);
     __pyx_t_20 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":547
+    /* "libfds/filters.pyx":639
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  *                               d11d[2][7]*v[nx-7, iy])
  */
     __pyx_t_18 = (__pyx_v_nx - 6);
     __pyx_t_17 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":549
+    /* "libfds/filters.pyx":641
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  *                               d11d[2][7]*v[nx-7, iy])             # <<<<<<<<<<<<<<
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  */
     __pyx_t_16 = (__pyx_v_nx - 7);
     __pyx_t_15 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":546
+    /* "libfds/filters.pyx":638
  *         vf[nx-1, iy] = xnu_0*(d11d[1][1]*v[nx-1, iy] + d11d[1][2]*v[nx-2, iy] +
  *                               d11d[1][3]*v[nx-3, iy] + d11d[1][4]*v[nx-4, iy])
  *         vf[nx-2, iy] = xnu_n*(d11d[2][1]*v[nx-1, iy] + d11d[2][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[2][3]*v[nx-3, iy] + d11d[2][4]*v[nx-4, iy] +
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  */
     __pyx_t_14 = (__pyx_v_nx - 2);
     __pyx_t_13 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_14 * __pyx_v_vf.strides[0]) )) + __pyx_t_13)) )) = (__pyx_v_xnu_n * (((((((((d11d[2])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) )))) + (((d11d[2])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[2])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[2])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))) + (((d11d[2])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[2])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[2])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))));
 
-    /* "libfds/filters.pyx":550
+    /* "libfds/filters.pyx":642
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  *                               d11d[2][7]*v[nx-7, iy])
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  */
     __pyx_t_15 = (__pyx_v_nx - 1);
     __pyx_t_16 = __pyx_v_iy;
     __pyx_t_17 = (__pyx_v_nx - 2);
     __pyx_t_18 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":551
+    /* "libfds/filters.pyx":643
  *                               d11d[2][7]*v[nx-7, iy])
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +
  */
     __pyx_t_20 = (__pyx_v_nx - 3);
     __pyx_t_19 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":550
+    /* "libfds/filters.pyx":642
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  *                               d11d[2][7]*v[nx-7, iy])
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  */
     __pyx_t_34 = (__pyx_v_nx - 4);
     __pyx_t_33 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":552
+    /* "libfds/filters.pyx":644
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  */
     __pyx_t_32 = (__pyx_v_nx - 5);
     __pyx_t_31 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":551
+    /* "libfds/filters.pyx":643
  *                               d11d[2][7]*v[nx-7, iy])
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +
  */
     __pyx_t_30 = (__pyx_v_nx - 6);
     __pyx_t_29 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":553
+    /* "libfds/filters.pyx":645
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  *                               d11d[3][11]*v[nx-11, iy])
  */
     __pyx_t_27 = (__pyx_v_nx - 7);
     __pyx_t_28 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":552
+    /* "libfds/filters.pyx":644
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  */
     __pyx_t_13 = (__pyx_v_nx - 8);
     __pyx_t_14 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":554
+    /* "libfds/filters.pyx":646
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][11]*v[nx-11, iy])
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +
  */
     __pyx_t_22 = (__pyx_v_nx - 9);
     __pyx_t_21 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":553
+    /* "libfds/filters.pyx":645
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  *                               d11d[3][11]*v[nx-11, iy])
  */
     __pyx_t_23 = (__pyx_v_nx - 10);
     __pyx_t_24 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":555
+    /* "libfds/filters.pyx":647
  *                               d11d[3][7]*v[nx-7, iy] + d11d[3][8]*v[nx-8, iy] +
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  *                               d11d[3][11]*v[nx-11, iy])             # <<<<<<<<<<<<<<
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  */
     __pyx_t_25 = (__pyx_v_nx - 11);
     __pyx_t_26 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":550
+    /* "libfds/filters.pyx":642
  *                               d11d[2][5]*v[nx-5, iy] + d11d[2][6]*v[nx-6, iy] +
  *                               d11d[2][7]*v[nx-7, iy])
  *         vf[nx-3, iy] = xnu_n*(d11d[3][1]*v[nx-1, iy] + d11d[3][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[3][3]*v[nx-3, iy] + d11d[3][4]*v[nx-4, iy] +
  *                               d11d[3][5]*v[nx-5, iy] + d11d[3][6]*v[nx-6, iy] +
  */
     __pyx_t_36 = (__pyx_v_nx - 3);
     __pyx_t_35 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[3])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) )))) + (((d11d[3])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[3])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))))) + (((d11d[3])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) ))))) + (((d11d[3])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[3])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[3])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))) + (((d11d[3])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[3])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[3])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[3])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
 
-    /* "libfds/filters.pyx":556
+    /* "libfds/filters.pyx":648
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  *                               d11d[3][11]*v[nx-11, iy])
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  */
     __pyx_t_26 = (__pyx_v_nx - 1);
     __pyx_t_25 = __pyx_v_iy;
     __pyx_t_24 = (__pyx_v_nx - 2);
     __pyx_t_23 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":557
+    /* "libfds/filters.pyx":649
  *                               d11d[3][11]*v[nx-11, iy])
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +
  */
     __pyx_t_21 = (__pyx_v_nx - 3);
     __pyx_t_22 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":556
+    /* "libfds/filters.pyx":648
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  *                               d11d[3][11]*v[nx-11, iy])
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  */
     __pyx_t_14 = (__pyx_v_nx - 4);
     __pyx_t_13 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":558
+    /* "libfds/filters.pyx":650
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  */
     __pyx_t_28 = (__pyx_v_nx - 5);
     __pyx_t_27 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":557
+    /* "libfds/filters.pyx":649
  *                               d11d[3][11]*v[nx-11, iy])
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +
  */
     __pyx_t_29 = (__pyx_v_nx - 6);
     __pyx_t_30 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":559
+    /* "libfds/filters.pyx":651
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  *                               d11d[4][11]*v[nx-11, iy])
  */
     __pyx_t_31 = (__pyx_v_nx - 7);
     __pyx_t_32 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":558
+    /* "libfds/filters.pyx":650
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  */
     __pyx_t_33 = (__pyx_v_nx - 8);
     __pyx_t_34 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":560
+    /* "libfds/filters.pyx":652
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][11]*v[nx-11, iy])
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +
  */
     __pyx_t_19 = (__pyx_v_nx - 9);
     __pyx_t_20 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":559
+    /* "libfds/filters.pyx":651
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  *                               d11d[4][11]*v[nx-11, iy])
  */
     __pyx_t_18 = (__pyx_v_nx - 10);
     __pyx_t_17 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":561
+    /* "libfds/filters.pyx":653
  *                               d11d[4][7]*v[nx-7, iy] + d11d[4][8]*v[nx-8, iy] +
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  *                               d11d[4][11]*v[nx-11, iy])             # <<<<<<<<<<<<<<
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  */
     __pyx_t_16 = (__pyx_v_nx - 11);
     __pyx_t_15 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":556
+    /* "libfds/filters.pyx":648
  *                               d11d[3][9]*v[nx-9, iy] + d11d[3][10]*v[nx-10, iy] +
  *                               d11d[3][11]*v[nx-11, iy])
  *         vf[nx-4, iy] = xnu_n*(d11d[4][1]*v[nx-1, iy] + d11d[4][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[4][3]*v[nx-3, iy] + d11d[4][4]*v[nx-4, iy] +
  *                               d11d[4][5]*v[nx-5, iy] + d11d[4][6]*v[nx-6, iy] +
  */
     __pyx_t_35 = (__pyx_v_nx - 4);
     __pyx_t_36 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_35 * __pyx_v_vf.strides[0]) )) + __pyx_t_36)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[4])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))) + (((d11d[4])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))))) + (((d11d[4])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) )) + __pyx_t_22)) ))))) + (((d11d[4])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) ))))) + (((d11d[4])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))))) + (((d11d[4])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[4])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[4])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))) + (((d11d[4])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[4])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[4])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))));
 
-    /* "libfds/filters.pyx":562
+    /* "libfds/filters.pyx":654
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  *                               d11d[4][11]*v[nx-11, iy])
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  */
     __pyx_t_15 = (__pyx_v_nx - 1);
     __pyx_t_16 = __pyx_v_iy;
     __pyx_t_17 = (__pyx_v_nx - 2);
     __pyx_t_18 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":563
+    /* "libfds/filters.pyx":655
  *                               d11d[4][11]*v[nx-11, iy])
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +
  */
     __pyx_t_20 = (__pyx_v_nx - 3);
     __pyx_t_19 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":562
+    /* "libfds/filters.pyx":654
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  *                               d11d[4][11]*v[nx-11, iy])
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  */
     __pyx_t_34 = (__pyx_v_nx - 4);
     __pyx_t_33 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":564
+    /* "libfds/filters.pyx":656
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +
  *                               d11d[5][9]*v[nx-9, iy] + d11d[5][10]*v[nx-10, iy] +
  */
     __pyx_t_32 = (__pyx_v_nx - 5);
     __pyx_t_31 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":563
+    /* "libfds/filters.pyx":655
  *                               d11d[4][11]*v[nx-11, iy])
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +
  */
     __pyx_t_30 = (__pyx_v_nx - 6);
     __pyx_t_29 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":565
+    /* "libfds/filters.pyx":657
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][9]*v[nx-9, iy] + d11d[5][10]*v[nx-10, iy] +
  *                               d11d[5][11]*v[nx-11, iy])
  */
     __pyx_t_27 = (__pyx_v_nx - 7);
     __pyx_t_28 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":564
+    /* "libfds/filters.pyx":656
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +
  *                               d11d[5][9]*v[nx-9, iy] + d11d[5][10]*v[nx-10, iy] +
  */
     __pyx_t_13 = (__pyx_v_nx - 8);
     __pyx_t_14 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":566
+    /* "libfds/filters.pyx":658
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +
  *                               d11d[5][9]*v[nx-9, iy] + d11d[5][10]*v[nx-10, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][11]*v[nx-11, iy])
  * 
  */
     __pyx_t_22 = (__pyx_v_nx - 9);
     __pyx_t_21 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":565
+    /* "libfds/filters.pyx":657
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][9]*v[nx-9, iy] + d11d[5][10]*v[nx-10, iy] +
  *                               d11d[5][11]*v[nx-11, iy])
  */
     __pyx_t_23 = (__pyx_v_nx - 10);
     __pyx_t_24 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":567
+    /* "libfds/filters.pyx":659
  *                               d11d[5][7]*v[nx-7, iy] + d11d[5][8]*v[nx-8, iy] +
  *                               d11d[5][9]*v[nx-9, iy] + d11d[5][10]*v[nx-10, iy] +
  *                               d11d[5][11]*v[nx-11, iy])             # <<<<<<<<<<<<<<
  * 
  *     if cpu > 1:
  */
     __pyx_t_25 = (__pyx_v_nx - 11);
     __pyx_t_26 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":562
+    /* "libfds/filters.pyx":654
  *                               d11d[4][9]*v[nx-9, iy] + d11d[4][10]*v[nx-10, iy] +
  *                               d11d[4][11]*v[nx-11, iy])
  *         vf[nx-5, iy] = xnu_n*(d11d[5][1]*v[nx-1, iy] + d11d[5][2]*v[nx-2, iy] +             # <<<<<<<<<<<<<<
  *                               d11d[5][3]*v[nx-3, iy] + d11d[5][4]*v[nx-4, iy] +
  *                               d11d[5][5]*v[nx-5, iy] + d11d[5][6]*v[nx-6, iy] +
  */
     __pyx_t_36 = (__pyx_v_nx - 5);
     __pyx_t_35 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[5])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) )))) + (((d11d[5])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[5])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))))) + (((d11d[5])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) ))))) + (((d11d[5])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[5])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[5])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))) + (((d11d[5])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[5])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[5])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[5])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
   }
 
-  /* "libfds/filters.pyx":569
+  /* "libfds/filters.pyx":661
  *                               d11d[5][11]*v[nx-11, iy])
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  */
   __pyx_t_6 = ((__pyx_v_cpu > 1) != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/filters.pyx":570
+    /* "libfds/filters.pyx":662
  * 
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  */
     {
@@ -11724,27 +11726,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(0 + 1 * __pyx_t_8);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":571
+                              /* "libfds/filters.pyx":663
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  *     else:
  */
                               __pyx_t_10 = __pyx_v_ny;
                               __pyx_t_11 = __pyx_t_10;
                               for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
                                 __pyx_v_iy = __pyx_t_12;
 
-                                /* "libfds/filters.pyx":572
+                                /* "libfds/filters.pyx":664
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]             # <<<<<<<<<<<<<<
  *     else:
  *         for ix in range(nx):
  */
                                 __pyx_t_26 = __pyx_v_ix;
@@ -11764,15 +11766,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":570
+        /* "libfds/filters.pyx":662
  * 
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  */
         /*finally:*/ {
@@ -11783,50 +11785,50 @@
             #endif
             goto __pyx_L26;
           }
           __pyx_L26:;
         }
     }
 
-    /* "libfds/filters.pyx":569
+    /* "libfds/filters.pyx":661
  *                               d11d[5][11]*v[nx-11, iy])
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  */
     goto __pyx_L23;
   }
 
-  /* "libfds/filters.pyx":574
+  /* "libfds/filters.pyx":666
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  *     else:
  *         for ix in range(nx):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  */
   /*else*/ {
     __pyx_t_7 = __pyx_v_nx;
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_ix = __pyx_t_9;
 
-      /* "libfds/filters.pyx":575
+      /* "libfds/filters.pyx":667
  *     else:
  *         for ix in range(nx):
  *             for iy in range(ny):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  * 
  */
       __pyx_t_10 = __pyx_v_ny;
       __pyx_t_11 = __pyx_t_10;
       for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/filters.pyx":576
+        /* "libfds/filters.pyx":668
  *         for ix in range(nx):
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     return vf
  */
         __pyx_t_23 = __pyx_v_ix;
@@ -11837,26 +11839,26 @@
         __pyx_t_21 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_22 * __pyx_v_vf.strides[0]) )) + __pyx_t_21)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_25 * __pyx_v_vf.strides[0]) )) + __pyx_t_26)) ))));
       }
     }
   }
   __pyx_L23:;
 
-  /* "libfds/filters.pyx":578
+  /* "libfds/filters.pyx":670
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  * 
  *     return vf             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __PYX_INC_MEMVIEW(&__pyx_v_vf, 0);
   __pyx_r = __pyx_v_vf;
   goto __pyx_L0;
 
-  /* "libfds/filters.pyx":491
+  /* "libfds/filters.pyx":583
  * 
  * 
  * cdef double[:, ::1] _sfilter_x(double[:, ::1] v, double xnu_n, double xnu_0, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy
  */
 
@@ -11877,15 +11879,15 @@
   }
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_vf, 1);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":581
+/* "libfds/filters.pyx":673
  * 
  * 
  * cdef double[:, ::1] _sfilter_y(double[:, ::1] v, double xnu_n, double xnu_0, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy
  */
 
@@ -11934,79 +11936,79 @@
   Py_ssize_t __pyx_t_35;
   Py_ssize_t __pyx_t_36;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_sfilter_y", 0);
 
-  /* "libfds/filters.pyx":584
+  /* "libfds/filters.pyx":676
  * 
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = v.shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t ny = v.shape[1]
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  */
   __pyx_v_nx = (__pyx_v_v.shape[0]);
 
-  /* "libfds/filters.pyx":585
+  /* "libfds/filters.pyx":677
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = v.shape[0]
  *     cdef Py_ssize_t ny = v.shape[1]             # <<<<<<<<<<<<<<
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  * 
  */
   __pyx_v_ny = (__pyx_v_v.shape[1]);
 
-  /* "libfds/filters.pyx":586
+  /* "libfds/filters.pyx":678
  *     cdef Py_ssize_t nx = v.shape[0]
  *     cdef Py_ssize_t ny = v.shape[1]
  *     cdef double[:, ::1] vf = _np.zeros_like(v)             # <<<<<<<<<<<<<<
  * 
  *     if cpu > 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_v, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_v, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 586, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 586, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 678, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_vf = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/filters.pyx":588
+  /* "libfds/filters.pyx":680
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(5, ny - 5):
  */
   __pyx_t_6 = ((__pyx_v_cpu > 1) != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/filters.pyx":589
+    /* "libfds/filters.pyx":681
  * 
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  */
     {
@@ -12037,97 +12039,97 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_9; __pyx_t_8++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(0 + 1 * __pyx_t_8);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":590
+                              /* "libfds/filters.pyx":682
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(5, ny - 5):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  */
                               __pyx_t_10 = (__pyx_v_ny - 5);
                               __pyx_t_11 = __pyx_t_10;
                               for (__pyx_t_12 = 5; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
                                 __pyx_v_iy = __pyx_t_12;
 
-                                /* "libfds/filters.pyx":591
+                                /* "libfds/filters.pyx":683
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  */
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":592
+                                /* "libfds/filters.pyx":684
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +             # <<<<<<<<<<<<<<
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  */
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = (__pyx_v_iy + 1);
                                 __pyx_t_17 = __pyx_v_ix;
                                 __pyx_t_18 = (__pyx_v_iy - 1);
 
-                                /* "libfds/filters.pyx":593
+                                /* "libfds/filters.pyx":685
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +             # <<<<<<<<<<<<<<
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +
  */
                                 __pyx_t_19 = __pyx_v_ix;
                                 __pyx_t_20 = (__pyx_v_iy + 2);
                                 __pyx_t_21 = __pyx_v_ix;
                                 __pyx_t_22 = (__pyx_v_iy - 2);
 
-                                /* "libfds/filters.pyx":594
+                                /* "libfds/filters.pyx":686
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +             # <<<<<<<<<<<<<<
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))
  */
                                 __pyx_t_23 = __pyx_v_ix;
                                 __pyx_t_24 = (__pyx_v_iy + 3);
                                 __pyx_t_25 = __pyx_v_ix;
                                 __pyx_t_26 = (__pyx_v_iy - 3);
 
-                                /* "libfds/filters.pyx":595
+                                /* "libfds/filters.pyx":687
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +             # <<<<<<<<<<<<<<
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))
  *     else:
  */
                                 __pyx_t_27 = __pyx_v_ix;
                                 __pyx_t_28 = (__pyx_v_iy + 4);
                                 __pyx_t_29 = __pyx_v_ix;
                                 __pyx_t_30 = (__pyx_v_iy - 4);
 
-                                /* "libfds/filters.pyx":596
+                                /* "libfds/filters.pyx":688
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))             # <<<<<<<<<<<<<<
  *     else:
  *         for ix in range(nx):
  */
                                 __pyx_t_31 = __pyx_v_ix;
                                 __pyx_t_32 = (__pyx_v_iy + 5);
                                 __pyx_t_33 = __pyx_v_ix;
                                 __pyx_t_34 = (__pyx_v_iy - 5);
 
-                                /* "libfds/filters.pyx":591
+                                /* "libfds/filters.pyx":683
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  */
                                 __pyx_t_35 = __pyx_v_ix;
@@ -12143,15 +12145,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":589
+        /* "libfds/filters.pyx":681
  * 
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  */
         /*finally:*/ {
@@ -12162,1081 +12164,1081 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/filters.pyx":588
+    /* "libfds/filters.pyx":680
  *     cdef double[:, ::1] vf = _np.zeros_like(v)
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(5, ny - 5):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":598
+  /* "libfds/filters.pyx":690
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))
  *     else:
  *         for ix in range(nx):             # <<<<<<<<<<<<<<
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  */
   /*else*/ {
     __pyx_t_9 = __pyx_v_nx;
     __pyx_t_8 = __pyx_t_9;
     for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
       __pyx_v_ix = __pyx_t_7;
 
-      /* "libfds/filters.pyx":599
+      /* "libfds/filters.pyx":691
  *     else:
  *         for ix in range(nx):
  *             for iy in range(5, ny - 5):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  */
       __pyx_t_10 = (__pyx_v_ny - 5);
       __pyx_t_11 = __pyx_t_10;
       for (__pyx_t_12 = 5; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/filters.pyx":600
+        /* "libfds/filters.pyx":692
  *         for ix in range(nx):
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  */
         __pyx_t_34 = __pyx_v_ix;
         __pyx_t_33 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":601
+        /* "libfds/filters.pyx":693
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +             # <<<<<<<<<<<<<<
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  */
         __pyx_t_32 = __pyx_v_ix;
         __pyx_t_31 = (__pyx_v_iy + 1);
         __pyx_t_30 = __pyx_v_ix;
         __pyx_t_29 = (__pyx_v_iy - 1);
 
-        /* "libfds/filters.pyx":602
+        /* "libfds/filters.pyx":694
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +             # <<<<<<<<<<<<<<
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +
  */
         __pyx_t_28 = __pyx_v_ix;
         __pyx_t_27 = (__pyx_v_iy + 2);
         __pyx_t_26 = __pyx_v_ix;
         __pyx_t_25 = (__pyx_v_iy - 2);
 
-        /* "libfds/filters.pyx":603
+        /* "libfds/filters.pyx":695
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +             # <<<<<<<<<<<<<<
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))
  */
         __pyx_t_24 = __pyx_v_ix;
         __pyx_t_23 = (__pyx_v_iy + 3);
         __pyx_t_22 = __pyx_v_ix;
         __pyx_t_21 = (__pyx_v_iy - 3);
 
-        /* "libfds/filters.pyx":604
+        /* "libfds/filters.pyx":696
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +             # <<<<<<<<<<<<<<
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))
  * 
  */
         __pyx_t_20 = __pyx_v_ix;
         __pyx_t_19 = (__pyx_v_iy + 4);
         __pyx_t_18 = __pyx_v_ix;
         __pyx_t_17 = (__pyx_v_iy - 4);
 
-        /* "libfds/filters.pyx":605
+        /* "libfds/filters.pyx":697
  *                                     d11c[3]*(v[ix, iy+3] + v[ix, iy-3]) +
  *                                     d11c[4]*(v[ix, iy+4] + v[ix, iy-4]) +
  *                                     d11c[5]*(v[ix, iy+5] + v[ix, iy-5]))             # <<<<<<<<<<<<<<
  * 
  * 
  */
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = (__pyx_v_iy + 5);
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = (__pyx_v_iy - 5);
 
-        /* "libfds/filters.pyx":600
+        /* "libfds/filters.pyx":692
  *         for ix in range(nx):
  *             for iy in range(5, ny - 5):
  *                 vf[ix, iy] = xnu_n*(d11c[0]*v[ix, iy] +             # <<<<<<<<<<<<<<
  *                                     d11c[1]*(v[ix, iy+1] + v[ix, iy-1]) +
  *                                     d11c[2]*(v[ix, iy+2] + v[ix, iy-2]) +
  */
         __pyx_t_36 = __pyx_v_ix;
         __pyx_t_35 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((d11c[0]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) )))) + ((d11c[1]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) )))))) + ((d11c[2]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))))) + ((d11c[3]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) )))))) + ((d11c[4]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) )))))) + ((d11c[5]) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) )))))));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":608
+  /* "libfds/filters.pyx":700
  * 
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  */
   __pyx_t_9 = __pyx_v_nx;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_ix = __pyx_t_7;
 
-    /* "libfds/filters.pyx":609
+    /* "libfds/filters.pyx":701
  * 
  *     for ix in range(nx):
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  */
     __pyx_t_13 = __pyx_v_ix;
     __pyx_t_14 = 0;
     __pyx_t_15 = __pyx_v_ix;
     __pyx_t_16 = 1;
 
-    /* "libfds/filters.pyx":610
+    /* "libfds/filters.pyx":702
  *     for ix in range(nx):
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])             # <<<<<<<<<<<<<<
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  */
     __pyx_t_17 = __pyx_v_ix;
     __pyx_t_18 = 2;
 
-    /* "libfds/filters.pyx":609
+    /* "libfds/filters.pyx":701
  * 
  *     for ix in range(nx):
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  */
     __pyx_t_19 = __pyx_v_ix;
     __pyx_t_20 = 3;
 
-    /* "libfds/filters.pyx":610
+    /* "libfds/filters.pyx":702
  *     for ix in range(nx):
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])             # <<<<<<<<<<<<<<
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  */
     __pyx_t_21 = __pyx_v_ix;
     __pyx_t_22 = 0;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_21 * __pyx_v_vf.strides[0]) )) + __pyx_t_22)) )) = (__pyx_v_xnu_0 * ((((((d11d[1])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) )))) + (((d11d[1])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) ))))) + (((d11d[1])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[1])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))));
 
-    /* "libfds/filters.pyx":611
+    /* "libfds/filters.pyx":703
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  */
     __pyx_t_20 = __pyx_v_ix;
     __pyx_t_19 = 0;
     __pyx_t_18 = __pyx_v_ix;
     __pyx_t_17 = 1;
 
-    /* "libfds/filters.pyx":612
+    /* "libfds/filters.pyx":704
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  *                            d11d[2][7]*v[ix, 6])
  */
     __pyx_t_16 = __pyx_v_ix;
     __pyx_t_15 = 2;
 
-    /* "libfds/filters.pyx":611
+    /* "libfds/filters.pyx":703
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  */
     __pyx_t_14 = __pyx_v_ix;
     __pyx_t_13 = 3;
 
-    /* "libfds/filters.pyx":613
+    /* "libfds/filters.pyx":705
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[2][7]*v[ix, 6])
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +
  */
     __pyx_t_22 = __pyx_v_ix;
     __pyx_t_21 = 4;
 
-    /* "libfds/filters.pyx":612
+    /* "libfds/filters.pyx":704
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  *                            d11d[2][7]*v[ix, 6])
  */
     __pyx_t_23 = __pyx_v_ix;
     __pyx_t_24 = 5;
 
-    /* "libfds/filters.pyx":614
+    /* "libfds/filters.pyx":706
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  *                            d11d[2][7]*v[ix, 6])             # <<<<<<<<<<<<<<
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  */
     __pyx_t_25 = __pyx_v_ix;
     __pyx_t_26 = 6;
 
-    /* "libfds/filters.pyx":611
+    /* "libfds/filters.pyx":703
  *         vf[ix, 0] = xnu_0*(d11d[1][1]*v[ix, 0] + d11d[1][2]*v[ix, 1] +
  *                            d11d[1][3]*v[ix, 2] + d11d[1][4]*v[ix, 3])
  *         vf[ix, 1] = xnu_n*(d11d[2][1]*v[ix, 0] + d11d[2][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[2][3]*v[ix, 2] + d11d[2][4]*v[ix, 3] +
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  */
     __pyx_t_27 = __pyx_v_ix;
     __pyx_t_28 = 1;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_27 * __pyx_v_vf.strides[0]) )) + __pyx_t_28)) )) = (__pyx_v_xnu_n * (((((((((d11d[2])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) )))) + (((d11d[2])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[2])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))) + (((d11d[2])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) ))))) + (((d11d[2])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[2])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[2])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
 
-    /* "libfds/filters.pyx":615
+    /* "libfds/filters.pyx":707
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  *                            d11d[2][7]*v[ix, 6])
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  */
     __pyx_t_26 = __pyx_v_ix;
     __pyx_t_25 = 0;
     __pyx_t_24 = __pyx_v_ix;
     __pyx_t_23 = 1;
 
-    /* "libfds/filters.pyx":616
+    /* "libfds/filters.pyx":708
  *                            d11d[2][7]*v[ix, 6])
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +
  */
     __pyx_t_21 = __pyx_v_ix;
     __pyx_t_22 = 2;
 
-    /* "libfds/filters.pyx":615
+    /* "libfds/filters.pyx":707
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  *                            d11d[2][7]*v[ix, 6])
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  */
     __pyx_t_13 = __pyx_v_ix;
     __pyx_t_14 = 3;
 
-    /* "libfds/filters.pyx":617
+    /* "libfds/filters.pyx":709
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  */
     __pyx_t_15 = __pyx_v_ix;
     __pyx_t_16 = 4;
 
-    /* "libfds/filters.pyx":616
+    /* "libfds/filters.pyx":708
  *                            d11d[2][7]*v[ix, 6])
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +
  */
     __pyx_t_17 = __pyx_v_ix;
     __pyx_t_18 = 5;
 
-    /* "libfds/filters.pyx":618
+    /* "libfds/filters.pyx":710
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +             # <<<<<<<<<<<<<<
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  *                            d11d[3][11]*v[ix, 10])
  */
     __pyx_t_19 = __pyx_v_ix;
     __pyx_t_20 = 6;
 
-    /* "libfds/filters.pyx":617
+    /* "libfds/filters.pyx":709
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  */
     __pyx_t_28 = __pyx_v_ix;
     __pyx_t_27 = 7;
 
-    /* "libfds/filters.pyx":619
+    /* "libfds/filters.pyx":711
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +             # <<<<<<<<<<<<<<
  *                            d11d[3][11]*v[ix, 10])
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +
  */
     __pyx_t_29 = __pyx_v_ix;
     __pyx_t_30 = 8;
 
-    /* "libfds/filters.pyx":618
+    /* "libfds/filters.pyx":710
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +             # <<<<<<<<<<<<<<
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  *                            d11d[3][11]*v[ix, 10])
  */
     __pyx_t_31 = __pyx_v_ix;
     __pyx_t_32 = 9;
 
-    /* "libfds/filters.pyx":620
+    /* "libfds/filters.pyx":712
  *                            d11d[3][7]*v[ix, 6] + d11d[3][8]*v[ix, 7] +
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  *                            d11d[3][11]*v[ix, 10])             # <<<<<<<<<<<<<<
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  */
     __pyx_t_33 = __pyx_v_ix;
     __pyx_t_34 = 10;
 
-    /* "libfds/filters.pyx":615
+    /* "libfds/filters.pyx":707
  *                            d11d[2][5]*v[ix, 4] + d11d[2][6]*v[ix, 5] +
  *                            d11d[2][7]*v[ix, 6])
  *         vf[ix, 2] = xnu_n*(d11d[3][1]*v[ix, 0] + d11d[3][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[3][3]*v[ix, 2] + d11d[3][4]*v[ix, 3] +
  *                            d11d[3][5]*v[ix, 4] + d11d[3][6]*v[ix, 5] +
  */
     __pyx_t_35 = __pyx_v_ix;
     __pyx_t_36 = 2;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_35 * __pyx_v_vf.strides[0]) )) + __pyx_t_36)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[3])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))) + (((d11d[3])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))))) + (((d11d[3])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) )) + __pyx_t_22)) ))))) + (((d11d[3])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[3])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) ))))) + (((d11d[3])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[3])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[3])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))))) + (((d11d[3])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[3])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[3])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))));
 
-    /* "libfds/filters.pyx":621
+    /* "libfds/filters.pyx":713
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  *                            d11d[3][11]*v[ix, 10])
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  */
     __pyx_t_34 = __pyx_v_ix;
     __pyx_t_33 = 0;
     __pyx_t_32 = __pyx_v_ix;
     __pyx_t_31 = 1;
 
-    /* "libfds/filters.pyx":622
+    /* "libfds/filters.pyx":714
  *                            d11d[3][11]*v[ix, 10])
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +
  */
     __pyx_t_30 = __pyx_v_ix;
     __pyx_t_29 = 2;
 
-    /* "libfds/filters.pyx":621
+    /* "libfds/filters.pyx":713
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  *                            d11d[3][11]*v[ix, 10])
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  */
     __pyx_t_27 = __pyx_v_ix;
     __pyx_t_28 = 3;
 
-    /* "libfds/filters.pyx":623
+    /* "libfds/filters.pyx":715
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  */
     __pyx_t_20 = __pyx_v_ix;
     __pyx_t_19 = 4;
 
-    /* "libfds/filters.pyx":622
+    /* "libfds/filters.pyx":714
  *                            d11d[3][11]*v[ix, 10])
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +
  */
     __pyx_t_18 = __pyx_v_ix;
     __pyx_t_17 = 5;
 
-    /* "libfds/filters.pyx":624
+    /* "libfds/filters.pyx":716
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +             # <<<<<<<<<<<<<<
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  *                            d11d[4][11]*v[ix, 10])
  */
     __pyx_t_16 = __pyx_v_ix;
     __pyx_t_15 = 6;
 
-    /* "libfds/filters.pyx":623
+    /* "libfds/filters.pyx":715
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  */
     __pyx_t_14 = __pyx_v_ix;
     __pyx_t_13 = 7;
 
-    /* "libfds/filters.pyx":625
+    /* "libfds/filters.pyx":717
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +             # <<<<<<<<<<<<<<
  *                            d11d[4][11]*v[ix, 10])
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +
  */
     __pyx_t_22 = __pyx_v_ix;
     __pyx_t_21 = 8;
 
-    /* "libfds/filters.pyx":624
+    /* "libfds/filters.pyx":716
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +             # <<<<<<<<<<<<<<
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  *                            d11d[4][11]*v[ix, 10])
  */
     __pyx_t_23 = __pyx_v_ix;
     __pyx_t_24 = 9;
 
-    /* "libfds/filters.pyx":626
+    /* "libfds/filters.pyx":718
  *                            d11d[4][7]*v[ix, 6] + d11d[4][8]*v[ix, 7] +
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  *                            d11d[4][11]*v[ix, 10])             # <<<<<<<<<<<<<<
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  */
     __pyx_t_25 = __pyx_v_ix;
     __pyx_t_26 = 10;
 
-    /* "libfds/filters.pyx":621
+    /* "libfds/filters.pyx":713
  *                            d11d[3][9]*v[ix, 8] + d11d[3][10]*v[ix, 9] +
  *                            d11d[3][11]*v[ix, 10])
  *         vf[ix, 3] = xnu_n*(d11d[4][1]*v[ix, 0] + d11d[4][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[4][3]*v[ix, 2] + d11d[4][4]*v[ix, 3] +
  *                            d11d[4][5]*v[ix, 4] + d11d[4][6]*v[ix, 5] +
  */
     __pyx_t_36 = __pyx_v_ix;
     __pyx_t_35 = 3;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[4])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) )))) + (((d11d[4])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[4])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[4])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))) + (((d11d[4])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))))) + (((d11d[4])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[4])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))) + (((d11d[4])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) ))))) + (((d11d[4])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[4])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[4])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
 
-    /* "libfds/filters.pyx":627
+    /* "libfds/filters.pyx":719
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  *                            d11d[4][11]*v[ix, 10])
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  */
     __pyx_t_26 = __pyx_v_ix;
     __pyx_t_25 = 0;
     __pyx_t_24 = __pyx_v_ix;
     __pyx_t_23 = 1;
 
-    /* "libfds/filters.pyx":628
+    /* "libfds/filters.pyx":720
  *                            d11d[4][11]*v[ix, 10])
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +
  */
     __pyx_t_21 = __pyx_v_ix;
     __pyx_t_22 = 2;
 
-    /* "libfds/filters.pyx":627
+    /* "libfds/filters.pyx":719
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  *                            d11d[4][11]*v[ix, 10])
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  */
     __pyx_t_13 = __pyx_v_ix;
     __pyx_t_14 = 3;
 
-    /* "libfds/filters.pyx":629
+    /* "libfds/filters.pyx":721
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +
  *                            d11d[5][9]*v[ix, 8] + d11d[5][10]*v[ix, 9] +
  */
     __pyx_t_15 = __pyx_v_ix;
     __pyx_t_16 = 4;
 
-    /* "libfds/filters.pyx":628
+    /* "libfds/filters.pyx":720
  *                            d11d[4][11]*v[ix, 10])
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +             # <<<<<<<<<<<<<<
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +
  */
     __pyx_t_17 = __pyx_v_ix;
     __pyx_t_18 = 5;
 
-    /* "libfds/filters.pyx":630
+    /* "libfds/filters.pyx":722
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +             # <<<<<<<<<<<<<<
  *                            d11d[5][9]*v[ix, 8] + d11d[5][10]*v[ix, 9] +
  *                            d11d[5][11]*v[ix, 10])
  */
     __pyx_t_19 = __pyx_v_ix;
     __pyx_t_20 = 6;
 
-    /* "libfds/filters.pyx":629
+    /* "libfds/filters.pyx":721
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +             # <<<<<<<<<<<<<<
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +
  *                            d11d[5][9]*v[ix, 8] + d11d[5][10]*v[ix, 9] +
  */
     __pyx_t_28 = __pyx_v_ix;
     __pyx_t_27 = 7;
 
-    /* "libfds/filters.pyx":631
+    /* "libfds/filters.pyx":723
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +
  *                            d11d[5][9]*v[ix, 8] + d11d[5][10]*v[ix, 9] +             # <<<<<<<<<<<<<<
  *                            d11d[5][11]*v[ix, 10])
  * 
  */
     __pyx_t_29 = __pyx_v_ix;
     __pyx_t_30 = 8;
 
-    /* "libfds/filters.pyx":630
+    /* "libfds/filters.pyx":722
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +             # <<<<<<<<<<<<<<
  *                            d11d[5][9]*v[ix, 8] + d11d[5][10]*v[ix, 9] +
  *                            d11d[5][11]*v[ix, 10])
  */
     __pyx_t_31 = __pyx_v_ix;
     __pyx_t_32 = 9;
 
-    /* "libfds/filters.pyx":632
+    /* "libfds/filters.pyx":724
  *                            d11d[5][7]*v[ix, 6] + d11d[5][8]*v[ix, 7] +
  *                            d11d[5][9]*v[ix, 8] + d11d[5][10]*v[ix, 9] +
  *                            d11d[5][11]*v[ix, 10])             # <<<<<<<<<<<<<<
  * 
  *     for ix in range(nx):
  */
     __pyx_t_33 = __pyx_v_ix;
     __pyx_t_34 = 10;
 
-    /* "libfds/filters.pyx":627
+    /* "libfds/filters.pyx":719
  *                            d11d[4][9]*v[ix, 8] + d11d[4][10]*v[ix, 9] +
  *                            d11d[4][11]*v[ix, 10])
  *         vf[ix, 4] = xnu_n*(d11d[5][1]*v[ix, 0] + d11d[5][2]*v[ix, 1] +             # <<<<<<<<<<<<<<
  *                            d11d[5][3]*v[ix, 2] + d11d[5][4]*v[ix, 3] +
  *                            d11d[5][5]*v[ix, 4] + d11d[5][6]*v[ix, 5] +
  */
     __pyx_t_35 = __pyx_v_ix;
     __pyx_t_36 = 4;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_35 * __pyx_v_vf.strides[0]) )) + __pyx_t_36)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[5])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))) + (((d11d[5])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))))) + (((d11d[5])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) )) + __pyx_t_22)) ))))) + (((d11d[5])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[5])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) ))))) + (((d11d[5])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[5])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[5])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))))) + (((d11d[5])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[5])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[5])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))));
   }
 
-  /* "libfds/filters.pyx":634
+  /* "libfds/filters.pyx":726
  *                            d11d[5][11]*v[ix, 10])
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  */
   __pyx_t_9 = __pyx_v_nx;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_ix = __pyx_t_7;
 
-    /* "libfds/filters.pyx":635
+    /* "libfds/filters.pyx":727
  * 
  *     for ix in range(nx):
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  */
     __pyx_t_34 = __pyx_v_ix;
     __pyx_t_33 = (__pyx_v_ny - 1);
     __pyx_t_32 = __pyx_v_ix;
     __pyx_t_31 = (__pyx_v_ny - 2);
 
-    /* "libfds/filters.pyx":636
+    /* "libfds/filters.pyx":728
  *     for ix in range(nx):
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])             # <<<<<<<<<<<<<<
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  */
     __pyx_t_30 = __pyx_v_ix;
     __pyx_t_29 = (__pyx_v_ny - 3);
 
-    /* "libfds/filters.pyx":635
+    /* "libfds/filters.pyx":727
  * 
  *     for ix in range(nx):
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  */
     __pyx_t_27 = __pyx_v_ix;
     __pyx_t_28 = (__pyx_v_ny - 4);
 
-    /* "libfds/filters.pyx":636
+    /* "libfds/filters.pyx":728
  *     for ix in range(nx):
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])             # <<<<<<<<<<<<<<
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  */
     __pyx_t_20 = __pyx_v_ix;
     __pyx_t_19 = (__pyx_v_ny - 1);
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_20 * __pyx_v_vf.strides[0]) )) + __pyx_t_19)) )) = (__pyx_v_xnu_0 * ((((((d11d[1])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) )))) + (((d11d[1])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[1])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[1])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))));
 
-    /* "libfds/filters.pyx":637
+    /* "libfds/filters.pyx":729
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  */
     __pyx_t_28 = __pyx_v_ix;
     __pyx_t_27 = (__pyx_v_ny - 1);
     __pyx_t_29 = __pyx_v_ix;
     __pyx_t_30 = (__pyx_v_ny - 2);
 
-    /* "libfds/filters.pyx":638
+    /* "libfds/filters.pyx":730
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  *                               d11d[2][7]*v[ix, ny-7])
  */
     __pyx_t_31 = __pyx_v_ix;
     __pyx_t_32 = (__pyx_v_ny - 3);
 
-    /* "libfds/filters.pyx":637
+    /* "libfds/filters.pyx":729
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  */
     __pyx_t_33 = __pyx_v_ix;
     __pyx_t_34 = (__pyx_v_ny - 4);
 
-    /* "libfds/filters.pyx":639
+    /* "libfds/filters.pyx":731
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[2][7]*v[ix, ny-7])
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +
  */
     __pyx_t_19 = __pyx_v_ix;
     __pyx_t_20 = (__pyx_v_ny - 5);
 
-    /* "libfds/filters.pyx":638
+    /* "libfds/filters.pyx":730
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  *                               d11d[2][7]*v[ix, ny-7])
  */
     __pyx_t_18 = __pyx_v_ix;
     __pyx_t_17 = (__pyx_v_ny - 6);
 
-    /* "libfds/filters.pyx":640
+    /* "libfds/filters.pyx":732
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  *                               d11d[2][7]*v[ix, ny-7])             # <<<<<<<<<<<<<<
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  */
     __pyx_t_16 = __pyx_v_ix;
     __pyx_t_15 = (__pyx_v_ny - 7);
 
-    /* "libfds/filters.pyx":637
+    /* "libfds/filters.pyx":729
  *         vf[ix, ny-1] = xnu_0*(d11d[1][1]*v[ix, ny-1] + d11d[1][2]*v[ix, ny-2] +
  *                               d11d[1][3]*v[ix, ny-3] + d11d[1][4]*v[ix, ny-4])
  *         vf[ix, ny-2] = xnu_n*(d11d[2][1]*v[ix, ny-1] + d11d[2][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[2][3]*v[ix, ny-3] + d11d[2][4]*v[ix, ny-4] +
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  */
     __pyx_t_14 = __pyx_v_ix;
     __pyx_t_13 = (__pyx_v_ny - 2);
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_14 * __pyx_v_vf.strides[0]) )) + __pyx_t_13)) )) = (__pyx_v_xnu_n * (((((((((d11d[2])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) )))) + (((d11d[2])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[2])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[2])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))) + (((d11d[2])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[2])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[2])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))));
 
-    /* "libfds/filters.pyx":641
+    /* "libfds/filters.pyx":733
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  *                               d11d[2][7]*v[ix, ny-7])
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  */
     __pyx_t_15 = __pyx_v_ix;
     __pyx_t_16 = (__pyx_v_ny - 1);
     __pyx_t_17 = __pyx_v_ix;
     __pyx_t_18 = (__pyx_v_ny - 2);
 
-    /* "libfds/filters.pyx":642
+    /* "libfds/filters.pyx":734
  *                               d11d[2][7]*v[ix, ny-7])
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +
  */
     __pyx_t_20 = __pyx_v_ix;
     __pyx_t_19 = (__pyx_v_ny - 3);
 
-    /* "libfds/filters.pyx":641
+    /* "libfds/filters.pyx":733
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  *                               d11d[2][7]*v[ix, ny-7])
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  */
     __pyx_t_34 = __pyx_v_ix;
     __pyx_t_33 = (__pyx_v_ny - 4);
 
-    /* "libfds/filters.pyx":643
+    /* "libfds/filters.pyx":735
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  */
     __pyx_t_32 = __pyx_v_ix;
     __pyx_t_31 = (__pyx_v_ny - 5);
 
-    /* "libfds/filters.pyx":642
+    /* "libfds/filters.pyx":734
  *                               d11d[2][7]*v[ix, ny-7])
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +
  */
     __pyx_t_30 = __pyx_v_ix;
     __pyx_t_29 = (__pyx_v_ny - 6);
 
-    /* "libfds/filters.pyx":644
+    /* "libfds/filters.pyx":736
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +             # <<<<<<<<<<<<<<
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  *                               d11d[3][11]*v[ix, ny-11])
  */
     __pyx_t_27 = __pyx_v_ix;
     __pyx_t_28 = (__pyx_v_ny - 7);
 
-    /* "libfds/filters.pyx":643
+    /* "libfds/filters.pyx":735
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  */
     __pyx_t_13 = __pyx_v_ix;
     __pyx_t_14 = (__pyx_v_ny - 8);
 
-    /* "libfds/filters.pyx":645
+    /* "libfds/filters.pyx":737
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +             # <<<<<<<<<<<<<<
  *                               d11d[3][11]*v[ix, ny-11])
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +
  */
     __pyx_t_22 = __pyx_v_ix;
     __pyx_t_21 = (__pyx_v_ny - 9);
 
-    /* "libfds/filters.pyx":644
+    /* "libfds/filters.pyx":736
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +             # <<<<<<<<<<<<<<
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  *                               d11d[3][11]*v[ix, ny-11])
  */
     __pyx_t_23 = __pyx_v_ix;
     __pyx_t_24 = (__pyx_v_ny - 10);
 
-    /* "libfds/filters.pyx":646
+    /* "libfds/filters.pyx":738
  *                               d11d[3][7]*v[ix, ny-7] + d11d[3][8]*v[ix, ny-8] +
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  *                               d11d[3][11]*v[ix, ny-11])             # <<<<<<<<<<<<<<
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  */
     __pyx_t_25 = __pyx_v_ix;
     __pyx_t_26 = (__pyx_v_ny - 11);
 
-    /* "libfds/filters.pyx":641
+    /* "libfds/filters.pyx":733
  *                               d11d[2][5]*v[ix, ny-5] + d11d[2][6]*v[ix, ny-6] +
  *                               d11d[2][7]*v[ix, ny-7])
  *         vf[ix, ny-3] = xnu_n*(d11d[3][1]*v[ix, ny-1] + d11d[3][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[3][3]*v[ix, ny-3] + d11d[3][4]*v[ix, ny-4] +
  *                               d11d[3][5]*v[ix, ny-5] + d11d[3][6]*v[ix, ny-6] +
  */
     __pyx_t_36 = __pyx_v_ix;
     __pyx_t_35 = (__pyx_v_ny - 3);
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[3])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) )))) + (((d11d[3])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[3])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))))) + (((d11d[3])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) ))))) + (((d11d[3])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[3])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[3])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))) + (((d11d[3])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[3])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[3])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[3])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
 
-    /* "libfds/filters.pyx":647
+    /* "libfds/filters.pyx":739
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  *                               d11d[3][11]*v[ix, ny-11])
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  */
     __pyx_t_26 = __pyx_v_ix;
     __pyx_t_25 = (__pyx_v_ny - 1);
     __pyx_t_24 = __pyx_v_ix;
     __pyx_t_23 = (__pyx_v_ny - 2);
 
-    /* "libfds/filters.pyx":648
+    /* "libfds/filters.pyx":740
  *                               d11d[3][11]*v[ix, ny-11])
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +
  */
     __pyx_t_21 = __pyx_v_ix;
     __pyx_t_22 = (__pyx_v_ny - 3);
 
-    /* "libfds/filters.pyx":647
+    /* "libfds/filters.pyx":739
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  *                               d11d[3][11]*v[ix, ny-11])
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  */
     __pyx_t_14 = __pyx_v_ix;
     __pyx_t_13 = (__pyx_v_ny - 4);
 
-    /* "libfds/filters.pyx":649
+    /* "libfds/filters.pyx":741
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  */
     __pyx_t_28 = __pyx_v_ix;
     __pyx_t_27 = (__pyx_v_ny - 5);
 
-    /* "libfds/filters.pyx":648
+    /* "libfds/filters.pyx":740
  *                               d11d[3][11]*v[ix, ny-11])
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +
  */
     __pyx_t_29 = __pyx_v_ix;
     __pyx_t_30 = (__pyx_v_ny - 6);
 
-    /* "libfds/filters.pyx":650
+    /* "libfds/filters.pyx":742
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +             # <<<<<<<<<<<<<<
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  *                               d11d[4][11]*v[ix, ny-11])
  */
     __pyx_t_31 = __pyx_v_ix;
     __pyx_t_32 = (__pyx_v_ny - 7);
 
-    /* "libfds/filters.pyx":649
+    /* "libfds/filters.pyx":741
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  */
     __pyx_t_33 = __pyx_v_ix;
     __pyx_t_34 = (__pyx_v_ny - 8);
 
-    /* "libfds/filters.pyx":651
+    /* "libfds/filters.pyx":743
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +             # <<<<<<<<<<<<<<
  *                               d11d[4][11]*v[ix, ny-11])
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +
  */
     __pyx_t_19 = __pyx_v_ix;
     __pyx_t_20 = (__pyx_v_ny - 9);
 
-    /* "libfds/filters.pyx":650
+    /* "libfds/filters.pyx":742
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +             # <<<<<<<<<<<<<<
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  *                               d11d[4][11]*v[ix, ny-11])
  */
     __pyx_t_18 = __pyx_v_ix;
     __pyx_t_17 = (__pyx_v_ny - 10);
 
-    /* "libfds/filters.pyx":652
+    /* "libfds/filters.pyx":744
  *                               d11d[4][7]*v[ix, ny-7] + d11d[4][8]*v[ix, ny-8] +
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  *                               d11d[4][11]*v[ix, ny-11])             # <<<<<<<<<<<<<<
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  */
     __pyx_t_16 = __pyx_v_ix;
     __pyx_t_15 = (__pyx_v_ny - 11);
 
-    /* "libfds/filters.pyx":647
+    /* "libfds/filters.pyx":739
  *                               d11d[3][9]*v[ix, ny-9] + d11d[3][10]*v[ix, ny-10] +
  *                               d11d[3][11]*v[ix, ny-11])
  *         vf[ix, ny-4] = xnu_n*(d11d[4][1]*v[ix, ny-1] + d11d[4][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[4][3]*v[ix, ny-3] + d11d[4][4]*v[ix, ny-4] +
  *                               d11d[4][5]*v[ix, ny-5] + d11d[4][6]*v[ix, ny-6] +
  */
     __pyx_t_35 = __pyx_v_ix;
     __pyx_t_36 = (__pyx_v_ny - 4);
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_35 * __pyx_v_vf.strides[0]) )) + __pyx_t_36)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[4])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_26 * __pyx_v_v.strides[0]) )) + __pyx_t_25)) )))) + (((d11d[4])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_24 * __pyx_v_v.strides[0]) )) + __pyx_t_23)) ))))) + (((d11d[4])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_21 * __pyx_v_v.strides[0]) )) + __pyx_t_22)) ))))) + (((d11d[4])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_14 * __pyx_v_v.strides[0]) )) + __pyx_t_13)) ))))) + (((d11d[4])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_28 * __pyx_v_v.strides[0]) )) + __pyx_t_27)) ))))) + (((d11d[4])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_29 * __pyx_v_v.strides[0]) )) + __pyx_t_30)) ))))) + (((d11d[4])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_31 * __pyx_v_v.strides[0]) )) + __pyx_t_32)) ))))) + (((d11d[4])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_33 * __pyx_v_v.strides[0]) )) + __pyx_t_34)) ))))) + (((d11d[4])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_19 * __pyx_v_v.strides[0]) )) + __pyx_t_20)) ))))) + (((d11d[4])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_18 * __pyx_v_v.strides[0]) )) + __pyx_t_17)) ))))) + (((d11d[4])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_16 * __pyx_v_v.strides[0]) )) + __pyx_t_15)) ))))));
 
-    /* "libfds/filters.pyx":653
+    /* "libfds/filters.pyx":745
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  *                               d11d[4][11]*v[ix, ny-11])
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  */
     __pyx_t_15 = __pyx_v_ix;
     __pyx_t_16 = (__pyx_v_ny - 1);
     __pyx_t_17 = __pyx_v_ix;
     __pyx_t_18 = (__pyx_v_ny - 2);
 
-    /* "libfds/filters.pyx":654
+    /* "libfds/filters.pyx":746
  *                               d11d[4][11]*v[ix, ny-11])
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +
  */
     __pyx_t_20 = __pyx_v_ix;
     __pyx_t_19 = (__pyx_v_ny - 3);
 
-    /* "libfds/filters.pyx":653
+    /* "libfds/filters.pyx":745
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  *                               d11d[4][11]*v[ix, ny-11])
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  */
     __pyx_t_34 = __pyx_v_ix;
     __pyx_t_33 = (__pyx_v_ny - 4);
 
-    /* "libfds/filters.pyx":655
+    /* "libfds/filters.pyx":747
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +
  *                               d11d[5][9]*v[ix, ny-9] + d11d[5][10]*v[ix, ny-10] +
  */
     __pyx_t_32 = __pyx_v_ix;
     __pyx_t_31 = (__pyx_v_ny - 5);
 
-    /* "libfds/filters.pyx":654
+    /* "libfds/filters.pyx":746
  *                               d11d[4][11]*v[ix, ny-11])
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +             # <<<<<<<<<<<<<<
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +
  */
     __pyx_t_30 = __pyx_v_ix;
     __pyx_t_29 = (__pyx_v_ny - 6);
 
-    /* "libfds/filters.pyx":656
+    /* "libfds/filters.pyx":748
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +             # <<<<<<<<<<<<<<
  *                               d11d[5][9]*v[ix, ny-9] + d11d[5][10]*v[ix, ny-10] +
  *                               d11d[5][11]*v[ix, ny-11])
  */
     __pyx_t_27 = __pyx_v_ix;
     __pyx_t_28 = (__pyx_v_ny - 7);
 
-    /* "libfds/filters.pyx":655
+    /* "libfds/filters.pyx":747
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +             # <<<<<<<<<<<<<<
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +
  *                               d11d[5][9]*v[ix, ny-9] + d11d[5][10]*v[ix, ny-10] +
  */
     __pyx_t_13 = __pyx_v_ix;
     __pyx_t_14 = (__pyx_v_ny - 8);
 
-    /* "libfds/filters.pyx":657
+    /* "libfds/filters.pyx":749
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +
  *                               d11d[5][9]*v[ix, ny-9] + d11d[5][10]*v[ix, ny-10] +             # <<<<<<<<<<<<<<
  *                               d11d[5][11]*v[ix, ny-11])
  * 
  */
     __pyx_t_22 = __pyx_v_ix;
     __pyx_t_21 = (__pyx_v_ny - 9);
 
-    /* "libfds/filters.pyx":656
+    /* "libfds/filters.pyx":748
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +             # <<<<<<<<<<<<<<
  *                               d11d[5][9]*v[ix, ny-9] + d11d[5][10]*v[ix, ny-10] +
  *                               d11d[5][11]*v[ix, ny-11])
  */
     __pyx_t_23 = __pyx_v_ix;
     __pyx_t_24 = (__pyx_v_ny - 10);
 
-    /* "libfds/filters.pyx":658
+    /* "libfds/filters.pyx":750
  *                               d11d[5][7]*v[ix, ny-7] + d11d[5][8]*v[ix, ny-8] +
  *                               d11d[5][9]*v[ix, ny-9] + d11d[5][10]*v[ix, ny-10] +
  *                               d11d[5][11]*v[ix, ny-11])             # <<<<<<<<<<<<<<
  * 
  *     if cpu > 1:
  */
     __pyx_t_25 = __pyx_v_ix;
     __pyx_t_26 = (__pyx_v_ny - 11);
 
-    /* "libfds/filters.pyx":653
+    /* "libfds/filters.pyx":745
  *                               d11d[4][9]*v[ix, ny-9] + d11d[4][10]*v[ix, ny-10] +
  *                               d11d[4][11]*v[ix, ny-11])
  *         vf[ix, ny-5] = xnu_n*(d11d[5][1]*v[ix, ny-1]   + d11d[5][2]*v[ix, ny-2] +             # <<<<<<<<<<<<<<
  *                               d11d[5][3]*v[ix, ny-3] + d11d[5][4]*v[ix, ny-4] +
  *                               d11d[5][5]*v[ix, ny-5] + d11d[5][6]*v[ix, ny-6] +
  */
     __pyx_t_36 = __pyx_v_ix;
     __pyx_t_35 = (__pyx_v_ny - 5);
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_36 * __pyx_v_vf.strides[0]) )) + __pyx_t_35)) )) = (__pyx_v_xnu_n * (((((((((((((d11d[5])[1]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_15 * __pyx_v_v.strides[0]) )) + __pyx_t_16)) )))) + (((d11d[5])[2]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_17 * __pyx_v_v.strides[0]) )) + __pyx_t_18)) ))))) + (((d11d[5])[3]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_20 * __pyx_v_v.strides[0]) )) + __pyx_t_19)) ))))) + (((d11d[5])[4]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_34 * __pyx_v_v.strides[0]) )) + __pyx_t_33)) ))))) + (((d11d[5])[5]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_32 * __pyx_v_v.strides[0]) )) + __pyx_t_31)) ))))) + (((d11d[5])[6]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_30 * __pyx_v_v.strides[0]) )) + __pyx_t_29)) ))))) + (((d11d[5])[7]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_27 * __pyx_v_v.strides[0]) )) + __pyx_t_28)) ))))) + (((d11d[5])[8]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_13 * __pyx_v_v.strides[0]) )) + __pyx_t_14)) ))))) + (((d11d[5])[9]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_22 * __pyx_v_v.strides[0]) )) + __pyx_t_21)) ))))) + (((d11d[5])[10]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))))) + (((d11d[5])[11]) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_25 * __pyx_v_v.strides[0]) )) + __pyx_t_26)) ))))));
   }
 
-  /* "libfds/filters.pyx":660
+  /* "libfds/filters.pyx":752
  *                               d11d[5][11]*v[ix, ny-11])
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  */
   __pyx_t_6 = ((__pyx_v_cpu > 1) != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/filters.pyx":661
+    /* "libfds/filters.pyx":753
  * 
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  */
     {
@@ -13267,27 +13269,27 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(0 + 1 * __pyx_t_8);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":662
+                              /* "libfds/filters.pyx":754
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  *     else:
  */
                               __pyx_t_10 = __pyx_v_ny;
                               __pyx_t_11 = __pyx_t_10;
                               for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
                                 __pyx_v_iy = __pyx_t_12;
 
-                                /* "libfds/filters.pyx":663
+                                /* "libfds/filters.pyx":755
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]             # <<<<<<<<<<<<<<
  *     else:
  *         for ix in range(nx):
  */
                                 __pyx_t_26 = __pyx_v_ix;
@@ -13307,15 +13309,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":661
+        /* "libfds/filters.pyx":753
  * 
  *     if cpu > 1:
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  */
         /*finally:*/ {
@@ -13326,50 +13328,50 @@
             #endif
             goto __pyx_L26;
           }
           __pyx_L26:;
         }
     }
 
-    /* "libfds/filters.pyx":660
+    /* "libfds/filters.pyx":752
  *                               d11d[5][11]*v[ix, ny-11])
  * 
  *     if cpu > 1:             # <<<<<<<<<<<<<<
  *         for ix in prange(0, nx, nogil=True, num_threads=cpu):
  *             for iy in range(ny):
  */
     goto __pyx_L23;
   }
 
-  /* "libfds/filters.pyx":665
+  /* "libfds/filters.pyx":757
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  *     else:
  *         for ix in range(nx):             # <<<<<<<<<<<<<<
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  */
   /*else*/ {
     __pyx_t_7 = __pyx_v_nx;
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = 0; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_ix = __pyx_t_9;
 
-      /* "libfds/filters.pyx":666
+      /* "libfds/filters.pyx":758
  *     else:
  *         for ix in range(nx):
  *             for iy in range(ny):             # <<<<<<<<<<<<<<
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  * 
  */
       __pyx_t_10 = __pyx_v_ny;
       __pyx_t_11 = __pyx_t_10;
       for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/filters.pyx":667
+        /* "libfds/filters.pyx":759
  *         for ix in range(nx):
  *             for iy in range(ny):
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     return vf
  */
         __pyx_t_23 = __pyx_v_ix;
@@ -13380,26 +13382,26 @@
         __pyx_t_21 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_22 * __pyx_v_vf.strides[0]) )) + __pyx_t_21)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_v.data + __pyx_t_23 * __pyx_v_v.strides[0]) )) + __pyx_t_24)) ))) - (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vf.data + __pyx_t_25 * __pyx_v_vf.strides[0]) )) + __pyx_t_26)) ))));
       }
     }
   }
   __pyx_L23:;
 
-  /* "libfds/filters.pyx":669
+  /* "libfds/filters.pyx":761
  *                 vf[ix, iy] = v[ix, iy] - vf[ix, iy]
  * 
  *     return vf             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __PYX_INC_MEMVIEW(&__pyx_v_vf, 0);
   __pyx_r = __pyx_v_vf;
   goto __pyx_L0;
 
-  /* "libfds/filters.pyx":581
+  /* "libfds/filters.pyx":673
  * 
  * 
  * cdef double[:, ::1] _sfilter_y(double[:, ::1] v, double xnu_n, double xnu_0, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy
  */
 
@@ -13420,20 +13422,20 @@
   }
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_vf, 1);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":672
+/* "libfds/filters.pyx":764
  * 
  * 
  * cpdef laplacian(u, cpu = 1):             # <<<<<<<<<<<<<<
+ *     """ Laplacian filter.
  * 
- *     if u.ndim == 3:
  */
 
 static PyObject *__pyx_pw_6libfds_7filters_7laplacian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
 static PyObject *__pyx_f_6libfds_7filters_laplacian(PyObject *__pyx_v_u, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_6libfds_7filters_laplacian *__pyx_optional_args) {
   PyObject *__pyx_v_cpu = ((PyObject *)__pyx_int_1);
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
@@ -13451,91 +13453,91 @@
   __Pyx_RefNannySetupContext("laplacian", 0);
   if (__pyx_optional_args) {
     if (__pyx_optional_args->__pyx_n > 0) {
       __pyx_v_cpu = __pyx_optional_args->cpu;
     }
   }
 
-  /* "libfds/filters.pyx":674
- * cpdef laplacian(u, cpu = 1):
- * 
+  /* "libfds/filters.pyx":779
+ *         The filtered array
+ *     """
  *     if u.ndim == 3:             # <<<<<<<<<<<<<<
  *         return _lplf3_3d(u, cpu)
  * 
  */
-  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_u, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_u, __pyx_n_s_ndim); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyInt_EqObjC(__pyx_t_1, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
-  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 674, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_IsTrue(__pyx_t_2); if (unlikely(__pyx_t_3 < 0)) __PYX_ERR(0, 779, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   if (__pyx_t_3) {
 
-    /* "libfds/filters.pyx":675
- * 
+    /* "libfds/filters.pyx":780
+ *     """
  *     if u.ndim == 3:
  *         return _lplf3_3d(u, cpu)             # <<<<<<<<<<<<<<
  * 
  *     return _lplf3_2d(u, cpu)
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_v_u, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 675, __pyx_L1_error)
-    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_cpu); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 675, __pyx_L1_error)
-    __pyx_t_6 = __pyx_f_6libfds_7filters__lplf3_3d(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_v_u, PyBUF_WRITABLE); if (unlikely(!__pyx_t_4.memview)) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_cpu); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 780, __pyx_L1_error)
+    __pyx_t_6 = __pyx_f_6libfds_7filters__lplf3_3d(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 780, __pyx_L1_error)
     __PYX_XDEC_MEMVIEW(&__pyx_t_4, 1);
     __pyx_t_4.memview = NULL;
     __pyx_t_4.data = NULL;
-    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_6, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)
+    __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_6, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 780, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_2);
     __PYX_XDEC_MEMVIEW(&__pyx_t_6, 1);
     __pyx_t_6.memview = NULL;
     __pyx_t_6.data = NULL;
     __pyx_r = __pyx_t_2;
     __pyx_t_2 = 0;
     goto __pyx_L0;
 
-    /* "libfds/filters.pyx":674
- * cpdef laplacian(u, cpu = 1):
- * 
+    /* "libfds/filters.pyx":779
+ *         The filtered array
+ *     """
  *     if u.ndim == 3:             # <<<<<<<<<<<<<<
  *         return _lplf3_3d(u, cpu)
  * 
  */
   }
 
-  /* "libfds/filters.pyx":677
+  /* "libfds/filters.pyx":782
  *         return _lplf3_3d(u, cpu)
  * 
  *     return _lplf3_2d(u, cpu)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_u, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 677, __pyx_L1_error)
-  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_cpu); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 677, __pyx_L1_error)
-  __pyx_t_8 = __pyx_f_6libfds_7filters__lplf3_2d(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 677, __pyx_L1_error)
+  __pyx_t_7 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_v_u, PyBUF_WRITABLE); if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_v_cpu); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 782, __pyx_L1_error)
+  __pyx_t_8 = __pyx_f_6libfds_7filters__lplf3_2d(__pyx_t_7, __pyx_t_5); if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 782, __pyx_L1_error)
   __PYX_XDEC_MEMVIEW(&__pyx_t_7, 1);
   __pyx_t_7.memview = NULL;
   __pyx_t_7.data = NULL;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_8, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 677, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_8, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 782, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_8, 1);
   __pyx_t_8.memview = NULL;
   __pyx_t_8.data = NULL;
   __pyx_r = __pyx_t_2;
   __pyx_t_2 = 0;
   goto __pyx_L0;
 
-  /* "libfds/filters.pyx":672
+  /* "libfds/filters.pyx":764
  * 
  * 
  * cpdef laplacian(u, cpu = 1):             # <<<<<<<<<<<<<<
+ *     """ Laplacian filter.
  * 
- *     if u.ndim == 3:
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_1);
   __Pyx_XDECREF(__pyx_t_2);
   __PYX_XDEC_MEMVIEW(&__pyx_t_4, 1);
@@ -13548,14 +13550,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_7filters_7laplacian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
+static char __pyx_doc_6libfds_7filters_6laplacian[] = " Laplacian filter. \n\n    Parameters\n    ----------\n    u: numpy.array\n        Array to be filtered\n    cpu: int, optional\n        Number of cpu to use for the computation.\n\n    Returns\n    -------\n    uf: numpy.array\n        The filtered array\n    ";
 static PyObject *__pyx_pw_6libfds_7filters_7laplacian(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
   PyObject *__pyx_v_u = 0;
   PyObject *__pyx_v_cpu = 0;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   PyObject *__pyx_r = 0;
@@ -13585,15 +13588,15 @@
         case  1:
         if (kw_args > 0) {
           PyObject* value = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_cpu);
           if (value) { values[1] = value; kw_args--; }
         }
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "laplacian") < 0)) __PYX_ERR(0, 672, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "laplacian") < 0)) __PYX_ERR(0, 764, __pyx_L3_error)
       }
     } else {
       switch (PyTuple_GET_SIZE(__pyx_args)) {
         case  2: values[1] = PyTuple_GET_ITEM(__pyx_args, 1);
         CYTHON_FALLTHROUGH;
         case  1: values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
         break;
@@ -13601,15 +13604,15 @@
       }
     }
     __pyx_v_u = values[0];
     __pyx_v_cpu = values[1];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("laplacian", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 672, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("laplacian", 0, 1, 2, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 764, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.filters.laplacian", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return NULL;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_7filters_6laplacian(__pyx_self, __pyx_v_u, __pyx_v_cpu);
 
@@ -13626,15 +13629,15 @@
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("laplacian", 0);
   __Pyx_XDECREF(__pyx_r);
   __pyx_t_2.__pyx_n = 1;
   __pyx_t_2.cpu = __pyx_v_cpu;
-  __pyx_t_1 = __pyx_f_6libfds_7filters_laplacian(__pyx_v_u, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_7filters_laplacian(__pyx_v_u, 0, &__pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -13643,15 +13646,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":680
+/* "libfds/filters.pyx":785
  * 
  * 
  * cdef double[:,::1] _lplf3_2d(double[:, ::1] u, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy
  */
 
@@ -13690,154 +13693,154 @@
   Py_ssize_t __pyx_t_25;
   Py_ssize_t __pyx_t_26;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_lplf3_2d", 0);
 
-  /* "libfds/filters.pyx":683
+  /* "libfds/filters.pyx":788
  * 
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = u.shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t ny = u.shape[1]
  *     cdef double[:, ::1] out = _np.empty_like(u)
  */
   __pyx_v_nx = (__pyx_v_u.shape[0]);
 
-  /* "libfds/filters.pyx":684
+  /* "libfds/filters.pyx":789
  *     cdef Py_ssize_t ix, iy
  *     cdef Py_ssize_t nx = u.shape[0]
  *     cdef Py_ssize_t ny = u.shape[1]             # <<<<<<<<<<<<<<
  *     cdef double[:, ::1] out = _np.empty_like(u)
  * 
  */
   __pyx_v_ny = (__pyx_v_u.shape[1]);
 
-  /* "libfds/filters.pyx":685
+  /* "libfds/filters.pyx":790
  *     cdef Py_ssize_t nx = u.shape[0]
  *     cdef Py_ssize_t ny = u.shape[1]
  *     cdef double[:, ::1] out = _np.empty_like(u)             # <<<<<<<<<<<<<<
  * 
  *     if cpu == 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 790, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 790, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_u, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_u, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 790, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 685, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 790, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_out = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/filters.pyx":687
+  /* "libfds/filters.pyx":792
  *     cdef double[:, ::1] out = _np.empty_like(u)
  * 
  *     if cpu == 1:             # <<<<<<<<<<<<<<
  *         for ix in range(1, nx - 1):
  *             for iy in range(1, ny - 1):
  */
   __pyx_t_6 = ((__pyx_v_cpu == 1) != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/filters.pyx":688
+    /* "libfds/filters.pyx":793
  * 
  *     if cpu == 1:
  *         for ix in range(1, nx - 1):             # <<<<<<<<<<<<<<
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  */
     __pyx_t_7 = (__pyx_v_nx - 1);
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = 1; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_ix = __pyx_t_9;
 
-      /* "libfds/filters.pyx":689
+      /* "libfds/filters.pyx":794
  *     if cpu == 1:
  *         for ix in range(1, nx - 1):
  *             for iy in range(1, ny - 1):             # <<<<<<<<<<<<<<
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  */
       __pyx_t_10 = (__pyx_v_ny - 1);
       __pyx_t_11 = __pyx_t_10;
       for (__pyx_t_12 = 1; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/filters.pyx":690
+        /* "libfds/filters.pyx":795
  *         for ix in range(1, nx - 1):
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \             # <<<<<<<<<<<<<<
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  * 
  */
         __pyx_t_13 = (__pyx_v_ix + 1);
         __pyx_t_14 = __pyx_v_iy;
         __pyx_t_15 = __pyx_v_ix;
         __pyx_t_16 = __pyx_v_iy;
         __pyx_t_17 = (__pyx_v_ix - 1);
         __pyx_t_18 = __pyx_v_iy;
 
-        /* "libfds/filters.pyx":691
+        /* "libfds/filters.pyx":796
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])             # <<<<<<<<<<<<<<
  * 
  *     else:
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_20 = (__pyx_v_iy + 1);
         __pyx_t_21 = __pyx_v_ix;
         __pyx_t_22 = __pyx_v_iy;
         __pyx_t_23 = __pyx_v_ix;
         __pyx_t_24 = (__pyx_v_iy - 1);
 
-        /* "libfds/filters.pyx":690
+        /* "libfds/filters.pyx":795
  *         for ix in range(1, nx - 1):
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \             # <<<<<<<<<<<<<<
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  * 
  */
         __pyx_t_25 = __pyx_v_ix;
         __pyx_t_26 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) )) + __pyx_t_26)) )) = ((((-0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_13 * __pyx_v_u.strides[0]) )) + __pyx_t_14)) )))) + (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_15 * __pyx_v_u.strides[0]) )) + __pyx_t_16)) ))))) - (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_17 * __pyx_v_u.strides[0]) )) + __pyx_t_18)) ))))) + (((-0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) )) + __pyx_t_20)) )))) + (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_21 * __pyx_v_u.strides[0]) )) + __pyx_t_22)) ))))) - (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_23 * __pyx_v_u.strides[0]) )) + __pyx_t_24)) ))))));
       }
     }
 
-    /* "libfds/filters.pyx":687
+    /* "libfds/filters.pyx":792
  *     cdef double[:, ::1] out = _np.empty_like(u)
  * 
  *     if cpu == 1:             # <<<<<<<<<<<<<<
  *         for ix in range(1, nx - 1):
  *             for iy in range(1, ny - 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":694
+  /* "libfds/filters.pyx":799
  * 
  *     else:
  *         for ix in prange(1, nx - 1, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  */
   /*else*/ {
@@ -13869,55 +13872,55 @@
                       #endif /* _OPENMP */
                       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_9; __pyx_t_8++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(1 + 1 * __pyx_t_8);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":695
+                              /* "libfds/filters.pyx":800
  *     else:
  *         for ix in prange(1, nx - 1, nogil=True, num_threads=cpu):
  *             for iy in range(1, ny - 1):             # <<<<<<<<<<<<<<
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  */
                               __pyx_t_10 = (__pyx_v_ny - 1);
                               __pyx_t_11 = __pyx_t_10;
                               for (__pyx_t_12 = 1; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
                                 __pyx_v_iy = __pyx_t_12;
 
-                                /* "libfds/filters.pyx":696
+                                /* "libfds/filters.pyx":801
  *         for ix in prange(1, nx - 1, nogil=True, num_threads=cpu):
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \             # <<<<<<<<<<<<<<
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  * 
  */
                                 __pyx_t_24 = (__pyx_v_ix + 1);
                                 __pyx_t_23 = __pyx_v_iy;
                                 __pyx_t_22 = __pyx_v_ix;
                                 __pyx_t_21 = __pyx_v_iy;
                                 __pyx_t_20 = (__pyx_v_ix - 1);
                                 __pyx_t_19 = __pyx_v_iy;
 
-                                /* "libfds/filters.pyx":697
+                                /* "libfds/filters.pyx":802
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])             # <<<<<<<<<<<<<<
  * 
  *     for ix in range(nx):
  */
                                 __pyx_t_18 = __pyx_v_ix;
                                 __pyx_t_17 = (__pyx_v_iy + 1);
                                 __pyx_t_16 = __pyx_v_ix;
                                 __pyx_t_15 = __pyx_v_iy;
                                 __pyx_t_14 = __pyx_v_ix;
                                 __pyx_t_13 = (__pyx_v_iy - 1);
 
-                                /* "libfds/filters.pyx":696
+                                /* "libfds/filters.pyx":801
  *         for ix in prange(1, nx - 1, nogil=True, num_threads=cpu):
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \             # <<<<<<<<<<<<<<
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  * 
  */
                                 __pyx_t_26 = __pyx_v_ix;
@@ -13933,15 +13936,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":694
+        /* "libfds/filters.pyx":799
  * 
  *     else:
  *         for ix in prange(1, nx - 1, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(1, ny - 1):
  *                 out[ix, iy] = (-0.25*u[ix + 1, iy] + 0.5*u[ix, iy] - 0.25*u[ix - 1, iy]) + \
  */
         /*finally:*/ {
@@ -13954,208 +13957,208 @@
           }
           __pyx_L10:;
         }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":699
+  /* "libfds/filters.pyx":804
  *                               (-0.25*u[ix, iy + 1] + 0.5*u[ix, iy] - 0.25*u[ix, iy - 1])
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         out[ix, 0] = (-0.25*u[ix + 1, 0] + 0.5*u[ix, 0] - 0.25*u[ix - 1, 0]) + \
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])
  */
   __pyx_t_9 = __pyx_v_nx;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_ix = __pyx_t_7;
 
-    /* "libfds/filters.pyx":700
+    /* "libfds/filters.pyx":805
  * 
  *     for ix in range(nx):
  *         out[ix, 0] = (-0.25*u[ix + 1, 0] + 0.5*u[ix, 0] - 0.25*u[ix - 1, 0]) + \             # <<<<<<<<<<<<<<
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])
  *         out[ix, ny - 1] = (-0.25*u[ix + 1, ny - 1] + 0.5*u[ix, ny - 1] - 0.25*u[ix - 1, ny - 1]) + \
  */
     __pyx_t_13 = (__pyx_v_ix + 1);
     __pyx_t_14 = 0;
     __pyx_t_15 = __pyx_v_ix;
     __pyx_t_16 = 0;
     __pyx_t_17 = (__pyx_v_ix - 1);
     __pyx_t_18 = 0;
 
-    /* "libfds/filters.pyx":701
+    /* "libfds/filters.pyx":806
  *     for ix in range(nx):
  *         out[ix, 0] = (-0.25*u[ix + 1, 0] + 0.5*u[ix, 0] - 0.25*u[ix - 1, 0]) + \
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])             # <<<<<<<<<<<<<<
  *         out[ix, ny - 1] = (-0.25*u[ix + 1, ny - 1] + 0.5*u[ix, ny - 1] - 0.25*u[ix - 1, ny - 1]) + \
  *                           (0.25*u[ix, ny - 1] - 0.5*u[ix, ny - 2] + 0.25*u[ix, ny - 3])
  */
     __pyx_t_19 = __pyx_v_ix;
     __pyx_t_20 = 0;
     __pyx_t_21 = __pyx_v_ix;
     __pyx_t_22 = 1;
     __pyx_t_23 = __pyx_v_ix;
     __pyx_t_24 = 2;
 
-    /* "libfds/filters.pyx":700
+    /* "libfds/filters.pyx":805
  * 
  *     for ix in range(nx):
  *         out[ix, 0] = (-0.25*u[ix + 1, 0] + 0.5*u[ix, 0] - 0.25*u[ix - 1, 0]) + \             # <<<<<<<<<<<<<<
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])
  *         out[ix, ny - 1] = (-0.25*u[ix + 1, ny - 1] + 0.5*u[ix, ny - 1] - 0.25*u[ix - 1, ny - 1]) + \
  */
     __pyx_t_25 = __pyx_v_ix;
     __pyx_t_26 = 0;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) )) + __pyx_t_26)) )) = ((((-0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_13 * __pyx_v_u.strides[0]) )) + __pyx_t_14)) )))) + (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_15 * __pyx_v_u.strides[0]) )) + __pyx_t_16)) ))))) - (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_17 * __pyx_v_u.strides[0]) )) + __pyx_t_18)) ))))) + (((0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) )) + __pyx_t_20)) )))) - (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_21 * __pyx_v_u.strides[0]) )) + __pyx_t_22)) ))))) + (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_23 * __pyx_v_u.strides[0]) )) + __pyx_t_24)) ))))));
 
-    /* "libfds/filters.pyx":702
+    /* "libfds/filters.pyx":807
  *         out[ix, 0] = (-0.25*u[ix + 1, 0] + 0.5*u[ix, 0] - 0.25*u[ix - 1, 0]) + \
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])
  *         out[ix, ny - 1] = (-0.25*u[ix + 1, ny - 1] + 0.5*u[ix, ny - 1] - 0.25*u[ix - 1, ny - 1]) + \             # <<<<<<<<<<<<<<
  *                           (0.25*u[ix, ny - 1] - 0.5*u[ix, ny - 2] + 0.25*u[ix, ny - 3])
  * 
  */
     __pyx_t_24 = (__pyx_v_ix + 1);
     __pyx_t_23 = (__pyx_v_ny - 1);
     __pyx_t_22 = __pyx_v_ix;
     __pyx_t_21 = (__pyx_v_ny - 1);
     __pyx_t_20 = (__pyx_v_ix - 1);
     __pyx_t_19 = (__pyx_v_ny - 1);
 
-    /* "libfds/filters.pyx":703
+    /* "libfds/filters.pyx":808
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])
  *         out[ix, ny - 1] = (-0.25*u[ix + 1, ny - 1] + 0.5*u[ix, ny - 1] - 0.25*u[ix - 1, ny - 1]) + \
  *                           (0.25*u[ix, ny - 1] - 0.5*u[ix, ny - 2] + 0.25*u[ix, ny - 3])             # <<<<<<<<<<<<<<
  * 
  *     for iy in range(ny):
  */
     __pyx_t_18 = __pyx_v_ix;
     __pyx_t_17 = (__pyx_v_ny - 1);
     __pyx_t_16 = __pyx_v_ix;
     __pyx_t_15 = (__pyx_v_ny - 2);
     __pyx_t_14 = __pyx_v_ix;
     __pyx_t_13 = (__pyx_v_ny - 3);
 
-    /* "libfds/filters.pyx":702
+    /* "libfds/filters.pyx":807
  *         out[ix, 0] = (-0.25*u[ix + 1, 0] + 0.5*u[ix, 0] - 0.25*u[ix - 1, 0]) + \
  *                      (0.25*u[ix, 0] - 0.5*u[ix, 1] + 0.25*u[ix, 2])
  *         out[ix, ny - 1] = (-0.25*u[ix + 1, ny - 1] + 0.5*u[ix, ny - 1] - 0.25*u[ix - 1, ny - 1]) + \             # <<<<<<<<<<<<<<
  *                           (0.25*u[ix, ny - 1] - 0.5*u[ix, ny - 2] + 0.25*u[ix, ny - 3])
  * 
  */
     __pyx_t_26 = __pyx_v_ix;
     __pyx_t_25 = (__pyx_v_ny - 1);
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_26 * __pyx_v_out.strides[0]) )) + __pyx_t_25)) )) = ((((-0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_24 * __pyx_v_u.strides[0]) )) + __pyx_t_23)) )))) + (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_22 * __pyx_v_u.strides[0]) )) + __pyx_t_21)) ))))) - (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_20 * __pyx_v_u.strides[0]) )) + __pyx_t_19)) ))))) + (((0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_18 * __pyx_v_u.strides[0]) )) + __pyx_t_17)) )))) - (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_16 * __pyx_v_u.strides[0]) )) + __pyx_t_15)) ))))) + (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_14 * __pyx_v_u.strides[0]) )) + __pyx_t_13)) ))))));
   }
 
-  /* "libfds/filters.pyx":705
+  /* "libfds/filters.pyx":810
  *                           (0.25*u[ix, ny - 1] - 0.5*u[ix, ny - 2] + 0.25*u[ix, ny - 3])
  * 
  *     for iy in range(ny):             # <<<<<<<<<<<<<<
  *         out[0, iy] = (-0.25*u[0, iy + 1] + 0.5*u[0, iy] - 0.25*u[0, iy - 1]) + \
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])
  */
   __pyx_t_9 = __pyx_v_ny;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_iy = __pyx_t_7;
 
-    /* "libfds/filters.pyx":706
+    /* "libfds/filters.pyx":811
  * 
  *     for iy in range(ny):
  *         out[0, iy] = (-0.25*u[0, iy + 1] + 0.5*u[0, iy] - 0.25*u[0, iy - 1]) + \             # <<<<<<<<<<<<<<
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])
  *         out[nx - 1, iy] = (-0.25*u[nx - 1, iy + 1] + 0.5*u[nx - 1, iy] - 0.25*u[nx - 1, iy - 1]) + \
  */
     __pyx_t_13 = 0;
     __pyx_t_14 = (__pyx_v_iy + 1);
     __pyx_t_15 = 0;
     __pyx_t_16 = __pyx_v_iy;
     __pyx_t_17 = 0;
     __pyx_t_18 = (__pyx_v_iy - 1);
 
-    /* "libfds/filters.pyx":707
+    /* "libfds/filters.pyx":812
  *     for iy in range(ny):
  *         out[0, iy] = (-0.25*u[0, iy + 1] + 0.5*u[0, iy] - 0.25*u[0, iy - 1]) + \
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])             # <<<<<<<<<<<<<<
  *         out[nx - 1, iy] = (-0.25*u[nx - 1, iy + 1] + 0.5*u[nx - 1, iy] - 0.25*u[nx - 1, iy - 1]) + \
  *                           (0.25*u[nx - 1, iy] - 0.5*u[nx - 2, iy] + 0.25*u[nx - 3, iy])
  */
     __pyx_t_19 = 0;
     __pyx_t_20 = __pyx_v_iy;
     __pyx_t_21 = 1;
     __pyx_t_22 = __pyx_v_iy;
     __pyx_t_23 = 2;
     __pyx_t_24 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":706
+    /* "libfds/filters.pyx":811
  * 
  *     for iy in range(ny):
  *         out[0, iy] = (-0.25*u[0, iy + 1] + 0.5*u[0, iy] - 0.25*u[0, iy - 1]) + \             # <<<<<<<<<<<<<<
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])
  *         out[nx - 1, iy] = (-0.25*u[nx - 1, iy + 1] + 0.5*u[nx - 1, iy] - 0.25*u[nx - 1, iy - 1]) + \
  */
     __pyx_t_25 = 0;
     __pyx_t_26 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_25 * __pyx_v_out.strides[0]) )) + __pyx_t_26)) )) = ((((-0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_13 * __pyx_v_u.strides[0]) )) + __pyx_t_14)) )))) + (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_15 * __pyx_v_u.strides[0]) )) + __pyx_t_16)) ))))) - (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_17 * __pyx_v_u.strides[0]) )) + __pyx_t_18)) ))))) + (((0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) )) + __pyx_t_20)) )))) - (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_21 * __pyx_v_u.strides[0]) )) + __pyx_t_22)) ))))) + (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_23 * __pyx_v_u.strides[0]) )) + __pyx_t_24)) ))))));
 
-    /* "libfds/filters.pyx":708
+    /* "libfds/filters.pyx":813
  *         out[0, iy] = (-0.25*u[0, iy + 1] + 0.5*u[0, iy] - 0.25*u[0, iy - 1]) + \
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])
  *         out[nx - 1, iy] = (-0.25*u[nx - 1, iy + 1] + 0.5*u[nx - 1, iy] - 0.25*u[nx - 1, iy - 1]) + \             # <<<<<<<<<<<<<<
  *                           (0.25*u[nx - 1, iy] - 0.5*u[nx - 2, iy] + 0.25*u[nx - 3, iy])
  * 
  */
     __pyx_t_24 = (__pyx_v_nx - 1);
     __pyx_t_23 = (__pyx_v_iy + 1);
     __pyx_t_22 = (__pyx_v_nx - 1);
     __pyx_t_21 = __pyx_v_iy;
     __pyx_t_20 = (__pyx_v_nx - 1);
     __pyx_t_19 = (__pyx_v_iy - 1);
 
-    /* "libfds/filters.pyx":709
+    /* "libfds/filters.pyx":814
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])
  *         out[nx - 1, iy] = (-0.25*u[nx - 1, iy + 1] + 0.5*u[nx - 1, iy] - 0.25*u[nx - 1, iy - 1]) + \
  *                           (0.25*u[nx - 1, iy] - 0.5*u[nx - 2, iy] + 0.25*u[nx - 3, iy])             # <<<<<<<<<<<<<<
  * 
  *     return out
  */
     __pyx_t_18 = (__pyx_v_nx - 1);
     __pyx_t_17 = __pyx_v_iy;
     __pyx_t_16 = (__pyx_v_nx - 2);
     __pyx_t_15 = __pyx_v_iy;
     __pyx_t_14 = (__pyx_v_nx - 3);
     __pyx_t_13 = __pyx_v_iy;
 
-    /* "libfds/filters.pyx":708
+    /* "libfds/filters.pyx":813
  *         out[0, iy] = (-0.25*u[0, iy + 1] + 0.5*u[0, iy] - 0.25*u[0, iy - 1]) + \
  *                      (0.25*u[0, iy] - 0.5*u[1, iy] + 0.25*u[2, iy])
  *         out[nx - 1, iy] = (-0.25*u[nx - 1, iy + 1] + 0.5*u[nx - 1, iy] - 0.25*u[nx - 1, iy - 1]) + \             # <<<<<<<<<<<<<<
  *                           (0.25*u[nx - 1, iy] - 0.5*u[nx - 2, iy] + 0.25*u[nx - 3, iy])
  * 
  */
     __pyx_t_26 = (__pyx_v_nx - 1);
     __pyx_t_25 = __pyx_v_iy;
     *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_out.data + __pyx_t_26 * __pyx_v_out.strides[0]) )) + __pyx_t_25)) )) = ((((-0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_24 * __pyx_v_u.strides[0]) )) + __pyx_t_23)) )))) + (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_22 * __pyx_v_u.strides[0]) )) + __pyx_t_21)) ))))) - (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_20 * __pyx_v_u.strides[0]) )) + __pyx_t_19)) ))))) + (((0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_18 * __pyx_v_u.strides[0]) )) + __pyx_t_17)) )))) - (0.5 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_16 * __pyx_v_u.strides[0]) )) + __pyx_t_15)) ))))) + (0.25 * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_u.data + __pyx_t_14 * __pyx_v_u.strides[0]) )) + __pyx_t_13)) ))))));
   }
 
-  /* "libfds/filters.pyx":711
+  /* "libfds/filters.pyx":816
  *                           (0.25*u[nx - 1, iy] - 0.5*u[nx - 2, iy] + 0.25*u[nx - 3, iy])
  * 
  *     return out             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __PYX_INC_MEMVIEW(&__pyx_v_out, 0);
   __pyx_r = __pyx_v_out;
   goto __pyx_L0;
 
-  /* "libfds/filters.pyx":680
+  /* "libfds/filters.pyx":785
  * 
  * 
  * cdef double[:,::1] _lplf3_2d(double[:, ::1] u, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy
  */
 
@@ -14176,15 +14179,15 @@
   }
   __pyx_L2:;
   __PYX_XDEC_MEMVIEW(&__pyx_v_out, 1);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/filters.pyx":714
+/* "libfds/filters.pyx":819
  * 
  * 
  * cdef double[:, :, ::1] _lplf3_3d(double[:, :, ::1] u, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy, iz
  */
 
@@ -14244,124 +14247,124 @@
   Py_ssize_t __pyx_t_44;
   Py_ssize_t __pyx_t_45;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("_lplf3_3d", 0);
 
-  /* "libfds/filters.pyx":717
+  /* "libfds/filters.pyx":822
  * 
  *     cdef Py_ssize_t ix, iy, iz
  *     cdef Py_ssize_t nx = u.shape[0]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t ny = u.shape[1]
  *     cdef Py_ssize_t nz = u.shape[2]
  */
   __pyx_v_nx = (__pyx_v_u.shape[0]);
 
-  /* "libfds/filters.pyx":718
+  /* "libfds/filters.pyx":823
  *     cdef Py_ssize_t ix, iy, iz
  *     cdef Py_ssize_t nx = u.shape[0]
  *     cdef Py_ssize_t ny = u.shape[1]             # <<<<<<<<<<<<<<
  *     cdef Py_ssize_t nz = u.shape[2]
  *     cdef double[:, :, ::1] out = _np.empty_like(u)
  */
   __pyx_v_ny = (__pyx_v_u.shape[1]);
 
-  /* "libfds/filters.pyx":719
+  /* "libfds/filters.pyx":824
  *     cdef Py_ssize_t nx = u.shape[0]
  *     cdef Py_ssize_t ny = u.shape[1]
  *     cdef Py_ssize_t nz = u.shape[2]             # <<<<<<<<<<<<<<
  *     cdef double[:, :, ::1] out = _np.empty_like(u)
  * 
  */
   __pyx_v_nz = (__pyx_v_u.shape[2]);
 
-  /* "libfds/filters.pyx":720
+  /* "libfds/filters.pyx":825
  *     cdef Py_ssize_t ny = u.shape[1]
  *     cdef Py_ssize_t nz = u.shape[2]
  *     cdef double[:, :, ::1] out = _np.empty_like(u)             # <<<<<<<<<<<<<<
  * 
  *     if cpu == 1:
  */
-  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __Pyx_GetModuleGlobalName(__pyx_t_2, __pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_empty_like); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_u, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_u, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __pyx_t_4 = NULL;
   if (CYTHON_UNPACK_METHODS && unlikely(PyMethod_Check(__pyx_t_3))) {
     __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
     if (likely(__pyx_t_4)) {
       PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
       __Pyx_INCREF(__pyx_t_4);
       __Pyx_INCREF(function);
       __Pyx_DECREF_SET(__pyx_t_3, function);
     }
   }
   __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_4, __pyx_t_2) : __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_2);
   __Pyx_XDECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
-  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
+  if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
-  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 720, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_double(__pyx_t_1, PyBUF_WRITABLE); if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 825, __pyx_L1_error)
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __pyx_v_out = __pyx_t_5;
   __pyx_t_5.memview = NULL;
   __pyx_t_5.data = NULL;
 
-  /* "libfds/filters.pyx":722
+  /* "libfds/filters.pyx":827
  *     cdef double[:, :, ::1] out = _np.empty_like(u)
  * 
  *     if cpu == 1:             # <<<<<<<<<<<<<<
  *         for ix in range(1, nx-1):
  *             for iy in range(1, ny-1):
  */
   __pyx_t_6 = ((__pyx_v_cpu == 1) != 0);
   if (__pyx_t_6) {
 
-    /* "libfds/filters.pyx":723
+    /* "libfds/filters.pyx":828
  * 
  *     if cpu == 1:
  *         for ix in range(1, nx-1):             # <<<<<<<<<<<<<<
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  */
     __pyx_t_7 = (__pyx_v_nx - 1);
     __pyx_t_8 = __pyx_t_7;
     for (__pyx_t_9 = 1; __pyx_t_9 < __pyx_t_8; __pyx_t_9+=1) {
       __pyx_v_ix = __pyx_t_9;
 
-      /* "libfds/filters.pyx":724
+      /* "libfds/filters.pyx":829
  *     if cpu == 1:
  *         for ix in range(1, nx-1):
  *             for iy in range(1, ny-1):             # <<<<<<<<<<<<<<
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  */
       __pyx_t_10 = (__pyx_v_ny - 1);
       __pyx_t_11 = __pyx_t_10;
       for (__pyx_t_12 = 1; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
         __pyx_v_iy = __pyx_t_12;
 
-        /* "libfds/filters.pyx":725
+        /* "libfds/filters.pyx":830
  *         for ix in range(1, nx-1):
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):             # <<<<<<<<<<<<<<
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  */
         __pyx_t_13 = (__pyx_v_nz - 1);
         __pyx_t_14 = __pyx_t_13;
         for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
           __pyx_v_iz = __pyx_t_15;
 
-          /* "libfds/filters.pyx":726
+          /* "libfds/filters.pyx":831
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  */
           __pyx_t_16 = (__pyx_v_ix + 1);
@@ -14370,15 +14373,15 @@
           __pyx_t_19 = __pyx_v_ix;
           __pyx_t_20 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_t_22 = (__pyx_v_ix - 1);
           __pyx_t_23 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
 
-          /* "libfds/filters.pyx":727
+          /* "libfds/filters.pyx":832
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \             # <<<<<<<<<<<<<<
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  * 
  */
           __pyx_t_25 = __pyx_v_ix;
@@ -14387,15 +14390,15 @@
           __pyx_t_28 = __pyx_v_ix;
           __pyx_t_29 = __pyx_v_iy;
           __pyx_t_30 = __pyx_v_iz;
           __pyx_t_31 = __pyx_v_ix;
           __pyx_t_32 = (__pyx_v_iy - 1);
           __pyx_t_33 = __pyx_v_iz;
 
-          /* "libfds/filters.pyx":728
+          /* "libfds/filters.pyx":833
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])             # <<<<<<<<<<<<<<
  * 
  *     else:
  */
           __pyx_t_34 = __pyx_v_ix;
@@ -14404,40 +14407,40 @@
           __pyx_t_37 = __pyx_v_ix;
           __pyx_t_38 = __pyx_v_iy;
           __pyx_t_39 = __pyx_v_iz;
           __pyx_t_40 = __pyx_v_ix;
           __pyx_t_41 = __pyx_v_iy;
           __pyx_t_42 = (__pyx_v_iz - 1);
 
-          /* "libfds/filters.pyx":726
+          /* "libfds/filters.pyx":831
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  */
           __pyx_t_43 = __pyx_v_ix;
           __pyx_t_44 = __pyx_v_iy;
           __pyx_t_45 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_43 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_45)) )) = (((((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_16 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_18)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_21)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_22 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_24)) ))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_25 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_27)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_28 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_30)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_31 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_33)) )))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_34 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_36)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_37 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_39)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_40 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_42)) ))))));
         }
       }
     }
 
-    /* "libfds/filters.pyx":722
+    /* "libfds/filters.pyx":827
  *     cdef double[:, :, ::1] out = _np.empty_like(u)
  * 
  *     if cpu == 1:             # <<<<<<<<<<<<<<
  *         for ix in range(1, nx-1):
  *             for iy in range(1, ny-1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/filters.pyx":731
+  /* "libfds/filters.pyx":836
  * 
  *     else:
  *         for ix in prange(1, nx-1, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  */
   /*else*/ {
@@ -14470,39 +14473,39 @@
                       for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_9; __pyx_t_8++){
                           {
                               __pyx_v_ix = (Py_ssize_t)(1 + 1 * __pyx_t_8);
                               /* Initialize private variables to invalid values */
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
 
-                              /* "libfds/filters.pyx":732
+                              /* "libfds/filters.pyx":837
  *     else:
  *         for ix in prange(1, nx-1, nogil=True, num_threads=cpu):
  *             for iy in range(1, ny-1):             # <<<<<<<<<<<<<<
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  */
                               __pyx_t_10 = (__pyx_v_ny - 1);
                               __pyx_t_11 = __pyx_t_10;
                               for (__pyx_t_12 = 1; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
                                 __pyx_v_iy = __pyx_t_12;
 
-                                /* "libfds/filters.pyx":733
+                                /* "libfds/filters.pyx":838
  *         for ix in prange(1, nx-1, nogil=True, num_threads=cpu):
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):             # <<<<<<<<<<<<<<
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  */
                                 __pyx_t_13 = (__pyx_v_nz - 1);
                                 __pyx_t_14 = __pyx_t_13;
                                 for (__pyx_t_15 = 1; __pyx_t_15 < __pyx_t_14; __pyx_t_15+=1) {
                                   __pyx_v_iz = __pyx_t_15;
 
-                                  /* "libfds/filters.pyx":734
+                                  /* "libfds/filters.pyx":839
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  */
                                   __pyx_t_42 = (__pyx_v_ix + 1);
@@ -14511,15 +14514,15 @@
                                   __pyx_t_39 = __pyx_v_ix;
                                   __pyx_t_38 = __pyx_v_iy;
                                   __pyx_t_37 = __pyx_v_iz;
                                   __pyx_t_36 = (__pyx_v_ix - 1);
                                   __pyx_t_35 = __pyx_v_iy;
                                   __pyx_t_34 = __pyx_v_iz;
 
-                                  /* "libfds/filters.pyx":735
+                                  /* "libfds/filters.pyx":840
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \             # <<<<<<<<<<<<<<
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  * 
  */
                                   __pyx_t_33 = __pyx_v_ix;
@@ -14528,15 +14531,15 @@
                                   __pyx_t_30 = __pyx_v_ix;
                                   __pyx_t_29 = __pyx_v_iy;
                                   __pyx_t_28 = __pyx_v_iz;
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_26 = (__pyx_v_iy - 1);
                                   __pyx_t_25 = __pyx_v_iz;
 
-                                  /* "libfds/filters.pyx":736
+                                  /* "libfds/filters.pyx":841
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])             # <<<<<<<<<<<<<<
  * 
  *     for iy in range(ny):
  */
                                   __pyx_t_24 = __pyx_v_ix;
@@ -14545,15 +14548,15 @@
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_20 = __pyx_v_iy;
                                   __pyx_t_19 = __pyx_v_iz;
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_17 = __pyx_v_iy;
                                   __pyx_t_16 = (__pyx_v_iz - 1);
 
-                                  /* "libfds/filters.pyx":734
+                                  /* "libfds/filters.pyx":839
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  *                     out[ix, iy, iz] = (-0.25*u[ix+1, iy, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix-1, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                                       (-0.25*u[ix, iy+1, iz] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy-1, iz]) + \
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  */
                                   __pyx_t_45 = __pyx_v_ix;
@@ -14571,15 +14574,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/filters.pyx":731
+        /* "libfds/filters.pyx":836
  * 
  *     else:
  *         for ix in prange(1, nx-1, nogil=True, num_threads=cpu):             # <<<<<<<<<<<<<<
  *             for iy in range(1, ny-1):
  *                 for iz in range(1, nz-1):
  */
         /*finally:*/ {
@@ -14592,39 +14595,39 @@
           }
           __pyx_L12:;
         }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/filters.pyx":738
+  /* "libfds/filters.pyx":843
  *                                       (-0.25*u[ix, iy, iz+1] + 0.5*u[ix, iy, iz] - 0.25*u[ix, iy, iz-1])
  * 
  *     for iy in range(ny):             # <<<<<<<<<<<<<<
  *         for iz in range(nz):
  *             out[0, iy, iz] = (0.25*u[0, iy, iz] - 0.5*u[1, iy, iz] + 0.25*u[2, iy, iz]) + \
  */
   __pyx_t_9 = __pyx_v_ny;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_iy = __pyx_t_7;
 
-    /* "libfds/filters.pyx":739
+    /* "libfds/filters.pyx":844
  * 
  *     for iy in range(ny):
  *         for iz in range(nz):             # <<<<<<<<<<<<<<
  *             out[0, iy, iz] = (0.25*u[0, iy, iz] - 0.5*u[1, iy, iz] + 0.25*u[2, iy, iz]) + \
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \
  */
     __pyx_t_10 = __pyx_v_nz;
     __pyx_t_11 = __pyx_t_10;
     for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
       __pyx_v_iz = __pyx_t_12;
 
-      /* "libfds/filters.pyx":740
+      /* "libfds/filters.pyx":845
  *     for iy in range(ny):
  *         for iz in range(nz):
  *             out[0, iy, iz] = (0.25*u[0, iy, iz] - 0.5*u[1, iy, iz] + 0.25*u[2, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])
  */
       __pyx_t_16 = 0;
@@ -14633,15 +14636,15 @@
       __pyx_t_19 = 1;
       __pyx_t_20 = __pyx_v_iy;
       __pyx_t_21 = __pyx_v_iz;
       __pyx_t_22 = 2;
       __pyx_t_23 = __pyx_v_iy;
       __pyx_t_24 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":741
+      /* "libfds/filters.pyx":846
  *         for iz in range(nz):
  *             out[0, iy, iz] = (0.25*u[0, iy, iz] - 0.5*u[1, iy, iz] + 0.25*u[2, iy, iz]) + \
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \             # <<<<<<<<<<<<<<
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])
  *             out[nx-1, iy, iz] = (0.25*u[nx-1, iy, iz] - 0.5*u[nx-2, iy, iz] + 0.25*u[nx-3, iy, iz]) + \
  */
       __pyx_t_25 = 0;
@@ -14650,15 +14653,15 @@
       __pyx_t_28 = 0;
       __pyx_t_29 = __pyx_v_iy;
       __pyx_t_30 = __pyx_v_iz;
       __pyx_t_31 = 0;
       __pyx_t_32 = (__pyx_v_iy - 1);
       __pyx_t_33 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":742
+      /* "libfds/filters.pyx":847
  *             out[0, iy, iz] = (0.25*u[0, iy, iz] - 0.5*u[1, iy, iz] + 0.25*u[2, iy, iz]) + \
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])             # <<<<<<<<<<<<<<
  *             out[nx-1, iy, iz] = (0.25*u[nx-1, iy, iz] - 0.5*u[nx-2, iy, iz] + 0.25*u[nx-3, iy, iz]) + \
  *                                   (-0.25*u[nx-1, iy+1, iz] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy-1, iz]) + \
  */
       __pyx_t_34 = 0;
@@ -14667,27 +14670,27 @@
       __pyx_t_37 = 0;
       __pyx_t_38 = __pyx_v_iy;
       __pyx_t_39 = __pyx_v_iz;
       __pyx_t_40 = 0;
       __pyx_t_41 = __pyx_v_iy;
       __pyx_t_42 = (__pyx_v_iz - 1);
 
-      /* "libfds/filters.pyx":740
+      /* "libfds/filters.pyx":845
  *     for iy in range(ny):
  *         for iz in range(nz):
  *             out[0, iy, iz] = (0.25*u[0, iy, iz] - 0.5*u[1, iy, iz] + 0.25*u[2, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])
  */
       __pyx_t_43 = 0;
       __pyx_t_44 = __pyx_v_iy;
       __pyx_t_45 = __pyx_v_iz;
       *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_43 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_45)) )) = (((((0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_16 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_18)) )))) - (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_21)) ))))) + (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_22 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_24)) ))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_25 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_27)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_28 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_30)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_31 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_33)) )))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_34 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_36)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_37 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_39)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_40 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_42)) ))))));
 
-      /* "libfds/filters.pyx":743
+      /* "libfds/filters.pyx":848
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])
  *             out[nx-1, iy, iz] = (0.25*u[nx-1, iy, iz] - 0.5*u[nx-2, iy, iz] + 0.25*u[nx-3, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                                   (-0.25*u[nx-1, iy+1, iz] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy-1, iz]) + \
  *                                   (-0.25*u[nx-1, iy, iz+1] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy, iz-1])
  */
       __pyx_t_42 = (__pyx_v_nx - 1);
@@ -14696,15 +14699,15 @@
       __pyx_t_39 = (__pyx_v_nx - 2);
       __pyx_t_38 = __pyx_v_iy;
       __pyx_t_37 = __pyx_v_iz;
       __pyx_t_36 = (__pyx_v_nx - 3);
       __pyx_t_35 = __pyx_v_iy;
       __pyx_t_34 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":744
+      /* "libfds/filters.pyx":849
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])
  *             out[nx-1, iy, iz] = (0.25*u[nx-1, iy, iz] - 0.5*u[nx-2, iy, iz] + 0.25*u[nx-3, iy, iz]) + \
  *                                   (-0.25*u[nx-1, iy+1, iz] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy-1, iz]) + \             # <<<<<<<<<<<<<<
  *                                   (-0.25*u[nx-1, iy, iz+1] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy, iz-1])
  * 
  */
       __pyx_t_33 = (__pyx_v_nx - 1);
@@ -14713,15 +14716,15 @@
       __pyx_t_30 = (__pyx_v_nx - 1);
       __pyx_t_29 = __pyx_v_iy;
       __pyx_t_28 = __pyx_v_iz;
       __pyx_t_27 = (__pyx_v_nx - 1);
       __pyx_t_26 = (__pyx_v_iy - 1);
       __pyx_t_25 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":745
+      /* "libfds/filters.pyx":850
  *             out[nx-1, iy, iz] = (0.25*u[nx-1, iy, iz] - 0.5*u[nx-2, iy, iz] + 0.25*u[nx-3, iy, iz]) + \
  *                                   (-0.25*u[nx-1, iy+1, iz] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy-1, iz]) + \
  *                                   (-0.25*u[nx-1, iy, iz+1] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy, iz-1])             # <<<<<<<<<<<<<<
  * 
  * 
  */
       __pyx_t_24 = (__pyx_v_nx - 1);
@@ -14730,53 +14733,53 @@
       __pyx_t_21 = (__pyx_v_nx - 1);
       __pyx_t_20 = __pyx_v_iy;
       __pyx_t_19 = __pyx_v_iz;
       __pyx_t_18 = (__pyx_v_nx - 1);
       __pyx_t_17 = __pyx_v_iy;
       __pyx_t_16 = (__pyx_v_iz - 1);
 
-      /* "libfds/filters.pyx":743
+      /* "libfds/filters.pyx":848
  *                              (-0.25*u[0, iy+1, iz] + 0.5*u[0, iy, iz] - 0.25*u[0, iy-1, iz]) + \
  *                              (-0.25*u[0, iy, iz+1] + 0.5*u[0, iy, iz] - 0.25*u[0, iy, iz-1])
  *             out[nx-1, iy, iz] = (0.25*u[nx-1, iy, iz] - 0.5*u[nx-2, iy, iz] + 0.25*u[nx-3, iy, iz]) + \             # <<<<<<<<<<<<<<
  *                                   (-0.25*u[nx-1, iy+1, iz] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy-1, iz]) + \
  *                                   (-0.25*u[nx-1, iy, iz+1] + 0.5*u[nx-1, iy, iz] - 0.25*u[nx-1, iy, iz-1])
  */
       __pyx_t_45 = (__pyx_v_nx - 1);
       __pyx_t_44 = __pyx_v_iy;
       __pyx_t_43 = __pyx_v_iz;
       *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_45 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_43)) )) = (((((0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_42 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_40)) )))) - (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_39 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_37)) ))))) + (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_36 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_34)) ))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_33 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_31)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_30 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_28)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_27 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_25)) )))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_24 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_22)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_21 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_19)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_18 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_16)) ))))));
     }
   }
 
-  /* "libfds/filters.pyx":748
+  /* "libfds/filters.pyx":853
  * 
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         for iz in range(nz):
  *             out[ix, 0, iz] = (-0.25*u[ix+1, 0, iz] + 0.5*u[ix, 0, iz] - 0.25*u[ix-1, 0, iz]) + \
  */
   __pyx_t_9 = __pyx_v_nx;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_ix = __pyx_t_7;
 
-    /* "libfds/filters.pyx":749
+    /* "libfds/filters.pyx":854
  * 
  *     for ix in range(nx):
  *         for iz in range(nz):             # <<<<<<<<<<<<<<
  *             out[ix, 0, iz] = (-0.25*u[ix+1, 0, iz] + 0.5*u[ix, 0, iz] - 0.25*u[ix-1, 0, iz]) + \
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \
  */
     __pyx_t_10 = __pyx_v_nz;
     __pyx_t_11 = __pyx_t_10;
     for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
       __pyx_v_iz = __pyx_t_12;
 
-      /* "libfds/filters.pyx":750
+      /* "libfds/filters.pyx":855
  *     for ix in range(nx):
  *         for iz in range(nz):
  *             out[ix, 0, iz] = (-0.25*u[ix+1, 0, iz] + 0.5*u[ix, 0, iz] - 0.25*u[ix-1, 0, iz]) + \             # <<<<<<<<<<<<<<
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])
  */
       __pyx_t_16 = (__pyx_v_ix + 1);
@@ -14785,15 +14788,15 @@
       __pyx_t_19 = __pyx_v_ix;
       __pyx_t_20 = 0;
       __pyx_t_21 = __pyx_v_iz;
       __pyx_t_22 = (__pyx_v_ix - 1);
       __pyx_t_23 = 0;
       __pyx_t_24 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":751
+      /* "libfds/filters.pyx":856
  *         for iz in range(nz):
  *             out[ix, 0, iz] = (-0.25*u[ix+1, 0, iz] + 0.5*u[ix, 0, iz] - 0.25*u[ix-1, 0, iz]) + \
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \             # <<<<<<<<<<<<<<
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])
  *             out[ix, ny-1, iz] = (-0.25*u[ix+1, ny-1, iz] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix-1, ny-1, iz]) + \
  */
       __pyx_t_25 = __pyx_v_ix;
@@ -14802,15 +14805,15 @@
       __pyx_t_28 = __pyx_v_ix;
       __pyx_t_29 = 1;
       __pyx_t_30 = __pyx_v_iz;
       __pyx_t_31 = __pyx_v_ix;
       __pyx_t_32 = 2;
       __pyx_t_33 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":752
+      /* "libfds/filters.pyx":857
  *             out[ix, 0, iz] = (-0.25*u[ix+1, 0, iz] + 0.5*u[ix, 0, iz] - 0.25*u[ix-1, 0, iz]) + \
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])             # <<<<<<<<<<<<<<
  *             out[ix, ny-1, iz] = (-0.25*u[ix+1, ny-1, iz] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix-1, ny-1, iz]) + \
  *                                   (0.25*u[ix, ny-1, iz] - 0.5*u[ix, ny-2, iz] + 0.25*u[ix, ny-3, iz]) + \
  */
       __pyx_t_34 = __pyx_v_ix;
@@ -14819,27 +14822,27 @@
       __pyx_t_37 = __pyx_v_ix;
       __pyx_t_38 = 0;
       __pyx_t_39 = __pyx_v_iz;
       __pyx_t_40 = __pyx_v_ix;
       __pyx_t_41 = 0;
       __pyx_t_42 = (__pyx_v_iz - 1);
 
-      /* "libfds/filters.pyx":750
+      /* "libfds/filters.pyx":855
  *     for ix in range(nx):
  *         for iz in range(nz):
  *             out[ix, 0, iz] = (-0.25*u[ix+1, 0, iz] + 0.5*u[ix, 0, iz] - 0.25*u[ix-1, 0, iz]) + \             # <<<<<<<<<<<<<<
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])
  */
       __pyx_t_43 = __pyx_v_ix;
       __pyx_t_44 = 0;
       __pyx_t_45 = __pyx_v_iz;
       *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_43 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_45)) )) = (((((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_16 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_18)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_21)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_22 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_24)) ))))) + (((0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_25 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_27)) )))) - (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_28 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_30)) ))))) + (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_31 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_33)) )))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_34 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_36)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_37 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_39)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_40 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_42)) ))))));
 
-      /* "libfds/filters.pyx":753
+      /* "libfds/filters.pyx":858
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])
  *             out[ix, ny-1, iz] = (-0.25*u[ix+1, ny-1, iz] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix-1, ny-1, iz]) + \             # <<<<<<<<<<<<<<
  *                                   (0.25*u[ix, ny-1, iz] - 0.5*u[ix, ny-2, iz] + 0.25*u[ix, ny-3, iz]) + \
  *                                   (-0.25*u[ix, ny-1, iz+1] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix, ny-1, iz-1])
  */
       __pyx_t_42 = (__pyx_v_ix + 1);
@@ -14848,15 +14851,15 @@
       __pyx_t_39 = __pyx_v_ix;
       __pyx_t_38 = (__pyx_v_ny - 1);
       __pyx_t_37 = __pyx_v_iz;
       __pyx_t_36 = (__pyx_v_ix - 1);
       __pyx_t_35 = (__pyx_v_ny - 1);
       __pyx_t_34 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":754
+      /* "libfds/filters.pyx":859
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])
  *             out[ix, ny-1, iz] = (-0.25*u[ix+1, ny-1, iz] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix-1, ny-1, iz]) + \
  *                                   (0.25*u[ix, ny-1, iz] - 0.5*u[ix, ny-2, iz] + 0.25*u[ix, ny-3, iz]) + \             # <<<<<<<<<<<<<<
  *                                   (-0.25*u[ix, ny-1, iz+1] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix, ny-1, iz-1])
  * 
  */
       __pyx_t_33 = __pyx_v_ix;
@@ -14865,15 +14868,15 @@
       __pyx_t_30 = __pyx_v_ix;
       __pyx_t_29 = (__pyx_v_ny - 2);
       __pyx_t_28 = __pyx_v_iz;
       __pyx_t_27 = __pyx_v_ix;
       __pyx_t_26 = (__pyx_v_ny - 3);
       __pyx_t_25 = __pyx_v_iz;
 
-      /* "libfds/filters.pyx":755
+      /* "libfds/filters.pyx":860
  *             out[ix, ny-1, iz] = (-0.25*u[ix+1, ny-1, iz] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix-1, ny-1, iz]) + \
  *                                   (0.25*u[ix, ny-1, iz] - 0.5*u[ix, ny-2, iz] + 0.25*u[ix, ny-3, iz]) + \
  *                                   (-0.25*u[ix, ny-1, iz+1] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix, ny-1, iz-1])             # <<<<<<<<<<<<<<
  * 
  *     for ix in range(nx):
  */
       __pyx_t_24 = __pyx_v_ix;
@@ -14882,53 +14885,53 @@
       __pyx_t_21 = __pyx_v_ix;
       __pyx_t_20 = (__pyx_v_ny - 1);
       __pyx_t_19 = __pyx_v_iz;
       __pyx_t_18 = __pyx_v_ix;
       __pyx_t_17 = (__pyx_v_ny - 1);
       __pyx_t_16 = (__pyx_v_iz - 1);
 
-      /* "libfds/filters.pyx":753
+      /* "libfds/filters.pyx":858
  *                              (0.25*u[ix, 0, iz] - 0.5*u[ix, 1, iz] + 0.25*u[ix, 2, iz]) + \
  *                              (-0.25*u[ix, 0, iz+1] + 0.5*u[ix, 0, iz] - 0.25*u[ix, 0, iz-1])
  *             out[ix, ny-1, iz] = (-0.25*u[ix+1, ny-1, iz] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix-1, ny-1, iz]) + \             # <<<<<<<<<<<<<<
  *                                   (0.25*u[ix, ny-1, iz] - 0.5*u[ix, ny-2, iz] + 0.25*u[ix, ny-3, iz]) + \
  *                                   (-0.25*u[ix, ny-1, iz+1] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix, ny-1, iz-1])
  */
       __pyx_t_45 = __pyx_v_ix;
       __pyx_t_44 = (__pyx_v_ny - 1);
       __pyx_t_43 = __pyx_v_iz;
       *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_45 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_43)) )) = (((((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_42 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_40)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_39 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_37)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_36 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_34)) ))))) + (((0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_33 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_31)) )))) - (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_30 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_28)) ))))) + (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_27 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_25)) )))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_24 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_22)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_21 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_19)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_18 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_16)) ))))));
     }
   }
 
-  /* "libfds/filters.pyx":757
+  /* "libfds/filters.pyx":862
  *                                   (-0.25*u[ix, ny-1, iz+1] + 0.5*u[ix, ny-1, iz] - 0.25*u[ix, ny-1, iz-1])
  * 
  *     for ix in range(nx):             # <<<<<<<<<<<<<<
  *         for iy in range(ny):
  *             out[ix, iy, 0] = (-0.25*u[ix+1, iy, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix-1, iy, 0]) + \
  */
   __pyx_t_9 = __pyx_v_nx;
   __pyx_t_8 = __pyx_t_9;
   for (__pyx_t_7 = 0; __pyx_t_7 < __pyx_t_8; __pyx_t_7+=1) {
     __pyx_v_ix = __pyx_t_7;
 
-    /* "libfds/filters.pyx":758
+    /* "libfds/filters.pyx":863
  * 
  *     for ix in range(nx):
  *         for iy in range(ny):             # <<<<<<<<<<<<<<
  *             out[ix, iy, 0] = (-0.25*u[ix+1, iy, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix-1, iy, 0]) + \
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \
  */
     __pyx_t_10 = __pyx_v_ny;
     __pyx_t_11 = __pyx_t_10;
     for (__pyx_t_12 = 0; __pyx_t_12 < __pyx_t_11; __pyx_t_12+=1) {
       __pyx_v_iy = __pyx_t_12;
 
-      /* "libfds/filters.pyx":759
+      /* "libfds/filters.pyx":864
  *     for ix in range(nx):
  *         for iy in range(ny):
  *             out[ix, iy, 0] = (-0.25*u[ix+1, iy, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix-1, iy, 0]) + \             # <<<<<<<<<<<<<<
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])
  */
       __pyx_t_16 = (__pyx_v_ix + 1);
@@ -14937,15 +14940,15 @@
       __pyx_t_19 = __pyx_v_ix;
       __pyx_t_20 = __pyx_v_iy;
       __pyx_t_21 = 0;
       __pyx_t_22 = (__pyx_v_ix - 1);
       __pyx_t_23 = __pyx_v_iy;
       __pyx_t_24 = 0;
 
-      /* "libfds/filters.pyx":760
+      /* "libfds/filters.pyx":865
  *         for iy in range(ny):
  *             out[ix, iy, 0] = (-0.25*u[ix+1, iy, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix-1, iy, 0]) + \
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \             # <<<<<<<<<<<<<<
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])
  *             out[ix, iy, nz-1] = (-0.25*u[ix+1, iy, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix-1, iy, nz-1]) + \
  */
       __pyx_t_25 = __pyx_v_ix;
@@ -14954,15 +14957,15 @@
       __pyx_t_28 = __pyx_v_ix;
       __pyx_t_29 = __pyx_v_iy;
       __pyx_t_30 = 0;
       __pyx_t_31 = __pyx_v_ix;
       __pyx_t_32 = (__pyx_v_iy - 1);
       __pyx_t_33 = 0;
 
-      /* "libfds/filters.pyx":761
+      /* "libfds/filters.pyx":866
  *             out[ix, iy, 0] = (-0.25*u[ix+1, iy, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix-1, iy, 0]) + \
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])             # <<<<<<<<<<<<<<
  *             out[ix, iy, nz-1] = (-0.25*u[ix+1, iy, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix-1, iy, nz-1]) + \
  *                                   (-0.25*u[ix, iy+1, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix, iy-1, nz-1]) + \
  */
       __pyx_t_34 = __pyx_v_ix;
@@ -14971,27 +14974,27 @@
       __pyx_t_37 = __pyx_v_ix;
       __pyx_t_38 = __pyx_v_iy;
       __pyx_t_39 = 1;
       __pyx_t_40 = __pyx_v_ix;
       __pyx_t_41 = __pyx_v_iy;
       __pyx_t_42 = 2;
 
-      /* "libfds/filters.pyx":759
+      /* "libfds/filters.pyx":864
  *     for ix in range(nx):
  *         for iy in range(ny):
  *             out[ix, iy, 0] = (-0.25*u[ix+1, iy, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix-1, iy, 0]) + \             # <<<<<<<<<<<<<<
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])
  */
       __pyx_t_43 = __pyx_v_ix;
       __pyx_t_44 = __pyx_v_iy;
       __pyx_t_45 = 0;
       *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_43 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_45)) )) = (((((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_16 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_18)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_19 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_21)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_22 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_24)) ))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_25 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_27)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_28 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_30)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_31 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_33)) )))))) + (((0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_34 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_36)) )))) - (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_37 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_39)) ))))) + (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_40 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_42)) ))))));
 
-      /* "libfds/filters.pyx":762
+      /* "libfds/filters.pyx":867
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])
  *             out[ix, iy, nz-1] = (-0.25*u[ix+1, iy, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix-1, iy, nz-1]) + \             # <<<<<<<<<<<<<<
  *                                   (-0.25*u[ix, iy+1, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix, iy-1, nz-1]) + \
  *                                   (0.25*u[ix, iy, nz-1] - 0.5*u[ix, iy, nz-2] + 0.25*u[ix, iy, nz-3])
  */
       __pyx_t_42 = (__pyx_v_ix + 1);
@@ -15000,15 +15003,15 @@
       __pyx_t_39 = __pyx_v_ix;
       __pyx_t_38 = __pyx_v_iy;
       __pyx_t_37 = (__pyx_v_nz - 1);
       __pyx_t_36 = (__pyx_v_ix - 1);
       __pyx_t_35 = __pyx_v_iy;
       __pyx_t_34 = (__pyx_v_nz - 1);
 
-      /* "libfds/filters.pyx":763
+      /* "libfds/filters.pyx":868
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])
  *             out[ix, iy, nz-1] = (-0.25*u[ix+1, iy, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix-1, iy, nz-1]) + \
  *                                   (-0.25*u[ix, iy+1, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix, iy-1, nz-1]) + \             # <<<<<<<<<<<<<<
  *                                   (0.25*u[ix, iy, nz-1] - 0.5*u[ix, iy, nz-2] + 0.25*u[ix, iy, nz-3])
  *     return out
  */
       __pyx_t_33 = __pyx_v_ix;
@@ -15017,15 +15020,15 @@
       __pyx_t_30 = __pyx_v_ix;
       __pyx_t_29 = __pyx_v_iy;
       __pyx_t_28 = (__pyx_v_nz - 1);
       __pyx_t_27 = __pyx_v_ix;
       __pyx_t_26 = (__pyx_v_iy - 1);
       __pyx_t_25 = (__pyx_v_nz - 1);
 
-      /* "libfds/filters.pyx":764
+      /* "libfds/filters.pyx":869
  *             out[ix, iy, nz-1] = (-0.25*u[ix+1, iy, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix-1, iy, nz-1]) + \
  *                                   (-0.25*u[ix, iy+1, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix, iy-1, nz-1]) + \
  *                                   (0.25*u[ix, iy, nz-1] - 0.5*u[ix, iy, nz-2] + 0.25*u[ix, iy, nz-3])             # <<<<<<<<<<<<<<
  *     return out
  */
       __pyx_t_24 = __pyx_v_ix;
       __pyx_t_23 = __pyx_v_iy;
@@ -15033,38 +15036,38 @@
       __pyx_t_21 = __pyx_v_ix;
       __pyx_t_20 = __pyx_v_iy;
       __pyx_t_19 = (__pyx_v_nz - 2);
       __pyx_t_18 = __pyx_v_ix;
       __pyx_t_17 = __pyx_v_iy;
       __pyx_t_16 = (__pyx_v_nz - 3);
 
-      /* "libfds/filters.pyx":762
+      /* "libfds/filters.pyx":867
  *                              (-0.25*u[ix, iy+1, 0] + 0.5*u[ix, iy, 0] - 0.25*u[ix, iy-1, 0]) + \
  *                              (0.25*u[ix, iy, 0] - 0.5*u[ix, iy, 1] + 0.25*u[ix, iy, 2])
  *             out[ix, iy, nz-1] = (-0.25*u[ix+1, iy, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix-1, iy, nz-1]) + \             # <<<<<<<<<<<<<<
  *                                   (-0.25*u[ix, iy+1, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix, iy-1, nz-1]) + \
  *                                   (0.25*u[ix, iy, nz-1] - 0.5*u[ix, iy, nz-2] + 0.25*u[ix, iy, nz-3])
  */
       __pyx_t_45 = __pyx_v_ix;
       __pyx_t_44 = __pyx_v_iy;
       __pyx_t_43 = (__pyx_v_nz - 1);
       *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_out.data + __pyx_t_45 * __pyx_v_out.strides[0]) ) + __pyx_t_44 * __pyx_v_out.strides[1]) )) + __pyx_t_43)) )) = (((((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_42 * __pyx_v_u.strides[0]) ) + __pyx_t_41 * __pyx_v_u.strides[1]) )) + __pyx_t_40)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_39 * __pyx_v_u.strides[0]) ) + __pyx_t_38 * __pyx_v_u.strides[1]) )) + __pyx_t_37)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_36 * __pyx_v_u.strides[0]) ) + __pyx_t_35 * __pyx_v_u.strides[1]) )) + __pyx_t_34)) ))))) + (((-0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_33 * __pyx_v_u.strides[0]) ) + __pyx_t_32 * __pyx_v_u.strides[1]) )) + __pyx_t_31)) )))) + (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_30 * __pyx_v_u.strides[0]) ) + __pyx_t_29 * __pyx_v_u.strides[1]) )) + __pyx_t_28)) ))))) - (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_27 * __pyx_v_u.strides[0]) ) + __pyx_t_26 * __pyx_v_u.strides[1]) )) + __pyx_t_25)) )))))) + (((0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_24 * __pyx_v_u.strides[0]) ) + __pyx_t_23 * __pyx_v_u.strides[1]) )) + __pyx_t_22)) )))) - (0.5 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_21 * __pyx_v_u.strides[0]) ) + __pyx_t_20 * __pyx_v_u.strides[1]) )) + __pyx_t_19)) ))))) + (0.25 * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_u.data + __pyx_t_18 * __pyx_v_u.strides[0]) ) + __pyx_t_17 * __pyx_v_u.strides[1]) )) + __pyx_t_16)) ))))));
     }
   }
 
-  /* "libfds/filters.pyx":765
+  /* "libfds/filters.pyx":870
  *                                   (-0.25*u[ix, iy+1, nz-1] + 0.5*u[ix, iy, nz-1] - 0.25*u[ix, iy-1, nz-1]) + \
  *                                   (0.25*u[ix, iy, nz-1] - 0.5*u[ix, iy, nz-2] + 0.25*u[ix, iy, nz-3])
  *     return out             # <<<<<<<<<<<<<<
  */
   __PYX_INC_MEMVIEW(&__pyx_v_out, 0);
   __pyx_r = __pyx_v_out;
   goto __pyx_L0;
 
-  /* "libfds/filters.pyx":714
+  /* "libfds/filters.pyx":819
  * 
  * 
  * cdef double[:, :, ::1] _lplf3_3d(double[:, :, ::1] u, int cpu):             # <<<<<<<<<<<<<<
  * 
  *     cdef Py_ssize_t ix, iy, iz
  */
 
@@ -29254,15 +29257,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  " Selective Filter. (Bogey & al. --)\n    ", /*tp_doc*/
+  " 2d Selective Filter calculated using technique described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n        flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n        Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_7filters__SelectiveFilter2d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_7filters__SelectiveFilter2d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_7filters__SelectiveFilter2d, /*tp_methods*/
@@ -29414,15 +29417,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  " Selective Filter. (Bogey & al. --)\n    ", /*tp_doc*/
+  " 3d Selective Filter calculated using technique described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n        flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n        Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_7filters__SelectiveFilter3d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_7filters__SelectiveFilter3d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_7filters__SelectiveFilter3d, /*tp_methods*/
@@ -29582,15 +29585,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  " Shock Capturing procedure. (Bogey & al. -- JCP 228 -- 2009)\n    ", /*tp_doc*/
+  " 2d Shock capture procedure calculated using technique described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, N. de Cacqueray, C. Bailly, \"A shock-capturing methodology based on adaptative \n           spatial filtering for high-order non-linear computations\", Journal of Computational Physics,\n           Volume 228, Issue 5, 2009, Pages 1447-1465.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_7filters__ShockCapture2d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_7filters__ShockCapture2d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_7filters__ShockCapture2d, /*tp_methods*/
@@ -29758,15 +29761,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  " Shock Capturing procedure. (Bogey & al. -- JCP 228 -- 2009)\n    ", /*tp_doc*/
+  " 3d Shock capture procedure calculated using technique described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, N. de Cacqueray, C. Bailly, \"A shock-capturing methodology based on adaptative \n           spatial filtering for high-order non-linear computations\", Journal of Computational Physics,\n           Volume 228, Issue 5, 2009, Pages 1447-1465.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_7filters__ShockCapture3d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_7filters__ShockCapture3d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_7filters__ShockCapture3d, /*tp_methods*/
@@ -30527,18 +30530,18 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 
 static PyMethodDef __pyx_methods[] = {
-  {"SelectiveFilter", (PyCFunction)__pyx_pw_6libfds_7filters_1SelectiveFilter, METH_O, 0},
-  {"ShockCapture", (PyCFunction)__pyx_pw_6libfds_7filters_3ShockCapture, METH_O, 0},
+  {"SelectiveFilter", (PyCFunction)__pyx_pw_6libfds_7filters_1SelectiveFilter, METH_O, __pyx_doc_6libfds_7filters_SelectiveFilter},
+  {"ShockCapture", (PyCFunction)__pyx_pw_6libfds_7filters_3ShockCapture, METH_O, __pyx_doc_6libfds_7filters_2ShockCapture},
   {"sfilter", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_7filters_5sfilter, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6libfds_7filters_4sfilter},
-  {"laplacian", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_7filters_7laplacian, METH_VARARGS|METH_KEYWORDS, 0},
+  {"laplacian", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_6libfds_7filters_7laplacian, METH_VARARGS|METH_KEYWORDS, __pyx_doc_6libfds_7filters_6laplacian},
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
 static int __pyx_pymod_exec_filters(PyObject* module); /*proto*/
@@ -30684,15 +30687,15 @@
   {&__pyx_n_s_v, __pyx_k_v, sizeof(__pyx_k_v), 0, 0, 1, 1},
   {&__pyx_n_s_xnu_0, __pyx_k_xnu_0, sizeof(__pyx_k_xnu_0), 0, 0, 1, 1},
   {&__pyx_n_s_xnu_n, __pyx_k_xnu_n, sizeof(__pyx_k_xnu_n), 0, 0, 1, 1},
   {&__pyx_n_s_zeros_like, __pyx_k_zeros_like, sizeof(__pyx_k_zeros_like), 0, 0, 1, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 120, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 155, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(2, 944, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 134, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 149, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 152, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 406, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 615, __pyx_L1_error)
@@ -31153,66 +31156,66 @@
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__Pyx_modinit_type_init_code", 0);
   /*--- Type init code ---*/
   __pyx_vtabptr_6libfds_7filters__SelectiveFilter2d = &__pyx_vtable_6libfds_7filters__SelectiveFilter2d;
   __pyx_vtable_6libfds_7filters__SelectiveFilter2d.apply = (void (*)(struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_7filters_18_SelectiveFilter2d_apply;
   __pyx_vtable_6libfds_7filters__SelectiveFilter2d._update = (void (*)(struct __pyx_obj_6libfds_7filters__SelectiveFilter2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_7filters_18_SelectiveFilter2d__update;
-  if (PyType_Ready(&__pyx_type_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 73, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 97, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_7filters__SelectiveFilter2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_7filters__SelectiveFilter2d.tp_dictoffset && __pyx_type_6libfds_7filters__SelectiveFilter2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_7filters__SelectiveFilter2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__SelectiveFilter2d.tp_dict, __pyx_vtabptr_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 73, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_SelectiveFilter2d, (PyObject *)&__pyx_type_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 73, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 73, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__SelectiveFilter2d.tp_dict, __pyx_vtabptr_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 97, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_SelectiveFilter2d, (PyObject *)&__pyx_type_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 97, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__SelectiveFilter2d) < 0) __PYX_ERR(0, 97, __pyx_L1_error)
   __pyx_ptype_6libfds_7filters__SelectiveFilter2d = &__pyx_type_6libfds_7filters__SelectiveFilter2d;
   __pyx_vtabptr_6libfds_7filters__SelectiveFilter3d = &__pyx_vtable_6libfds_7filters__SelectiveFilter3d;
   __pyx_vtable_6libfds_7filters__SelectiveFilter3d.apply = (void (*)(struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_7filters_18_SelectiveFilter3d_apply;
   __pyx_vtable_6libfds_7filters__SelectiveFilter3d._update = (void (*)(struct __pyx_obj_6libfds_7filters__SelectiveFilter3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_7filters_18_SelectiveFilter3d__update;
-  if (PyType_Ready(&__pyx_type_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 188, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_7filters__SelectiveFilter3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_7filters__SelectiveFilter3d.tp_dictoffset && __pyx_type_6libfds_7filters__SelectiveFilter3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_7filters__SelectiveFilter3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__SelectiveFilter3d.tp_dict, __pyx_vtabptr_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_SelectiveFilter3d, (PyObject *)&__pyx_type_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__SelectiveFilter3d.tp_dict, __pyx_vtabptr_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 188, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_SelectiveFilter3d, (PyObject *)&__pyx_type_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 188, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__SelectiveFilter3d) < 0) __PYX_ERR(0, 188, __pyx_L1_error)
   __pyx_ptype_6libfds_7filters__SelectiveFilter3d = &__pyx_type_6libfds_7filters__SelectiveFilter3d;
   __pyx_vtabptr_6libfds_7filters__ShockCapture2d = &__pyx_vtable_6libfds_7filters__ShockCapture2d;
   __pyx_vtable_6libfds_7filters__ShockCapture2d.apply = (void (*)(struct __pyx_obj_6libfds_7filters__ShockCapture2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_7filters_15_ShockCapture2d_apply;
   __pyx_vtable_6libfds_7filters__ShockCapture2d._update = (void (*)(struct __pyx_obj_6libfds_7filters__ShockCapture2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_7filters_15_ShockCapture2d__update;
-  if (PyType_Ready(&__pyx_type_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 265, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 311, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_7filters__ShockCapture2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_7filters__ShockCapture2d.tp_dictoffset && __pyx_type_6libfds_7filters__ShockCapture2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_7filters__ShockCapture2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__ShockCapture2d.tp_dict, __pyx_vtabptr_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 265, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ShockCapture2d, (PyObject *)&__pyx_type_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 265, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 265, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__ShockCapture2d.tp_dict, __pyx_vtabptr_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 311, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ShockCapture2d, (PyObject *)&__pyx_type_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 311, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__ShockCapture2d) < 0) __PYX_ERR(0, 311, __pyx_L1_error)
   __pyx_ptype_6libfds_7filters__ShockCapture2d = &__pyx_type_6libfds_7filters__ShockCapture2d;
   __pyx_vtabptr_6libfds_7filters__ShockCapture3d = &__pyx_vtable_6libfds_7filters__ShockCapture3d;
   __pyx_vtable_6libfds_7filters__ShockCapture3d.apply = (void (*)(struct __pyx_obj_6libfds_7filters__ShockCapture3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_7filters_15_ShockCapture3d_apply;
   __pyx_vtable_6libfds_7filters__ShockCapture3d._update = (void (*)(struct __pyx_obj_6libfds_7filters__ShockCapture3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_7filters_15_ShockCapture3d__update;
-  if (PyType_Ready(&__pyx_type_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 353, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 410, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_7filters__ShockCapture3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_7filters__ShockCapture3d.tp_dictoffset && __pyx_type_6libfds_7filters__ShockCapture3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_7filters__ShockCapture3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__ShockCapture3d.tp_dict, __pyx_vtabptr_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 353, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ShockCapture3d, (PyObject *)&__pyx_type_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 353, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 353, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_7filters__ShockCapture3d.tp_dict, __pyx_vtabptr_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 410, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ShockCapture3d, (PyObject *)&__pyx_type_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 410, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_7filters__ShockCapture3d) < 0) __PYX_ERR(0, 410, __pyx_L1_error)
   __pyx_ptype_6libfds_7filters__ShockCapture3d = &__pyx_type_6libfds_7filters__ShockCapture3d;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
```

### Comparing `libfds-0.1.0/libfds/fluxes.c` & `libfds-0.2.0/libfds/fluxes.c`

 * *Files 1% similar despite different names*

```diff
@@ -1952,56 +1952,56 @@
   __Pyx_memviewslice vx;
   __Pyx_memviewslice vy;
   __Pyx_memviewslice vz;
   struct __pyx_obj_6libfds_6fields_Fields3d *fld;
 };
 
 
-/* "libfds/fluxes.pyx":82
+/* "libfds/fluxes.pyx":115
  * 
  * @cython.final
  * cdef class _EulerianFluxes2d:             # <<<<<<<<<<<<<<
+ *     """ 2d Eulerian fluxes calculation using schemes described in [1]_.
  * 
- *     cdef Fields2d fld
  */
 struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d {
   PyObject_HEAD
   struct __pyx_vtabstruct_6libfds_6fluxes__EulerianFluxes2d *__pyx_vtab;
   struct __pyx_obj_6libfds_6fields_Fields2d *fld;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *dr;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *dru;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *drv;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *dre;
 };
 
 
-/* "libfds/fluxes.pyx":286
+/* "libfds/fluxes.pyx":332
  * 
  * @cython.final
  * cdef class _EulerianFluxes3d:             # <<<<<<<<<<<<<<
+ *     """ 3d Eulerian fluxes calculation using schemes described in [1]_.
  * 
- *     cdef Fields3d fld
  */
 struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d {
   PyObject_HEAD
   struct __pyx_vtabstruct_6libfds_6fluxes__EulerianFluxes3d *__pyx_vtab;
   struct __pyx_obj_6libfds_6fields_Fields3d *fld;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *dr;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *dru;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *drv;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *drw;
   struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *dre;
 };
 
 
-/* "libfds/fluxes.pyx":602
+/* "libfds/fluxes.pyx":661
  * 
  * @cython.final
  * cdef class _ViscousFluxes2d:             # <<<<<<<<<<<<<<
- *     """
+ *     """ 2d Viscous fluxes calculation using schemes described in [1]_.
  * 
  */
 struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d {
   PyObject_HEAD
   struct __pyx_vtabstruct_6libfds_6fluxes__ViscousFluxes2d *__pyx_vtab;
   struct __pyx_obj_6libfds_6fields_Fields2d *fld;
   struct __pyx_obj_6libfds_7libdiff_Derivative2d *dTk;
@@ -2009,19 +2009,19 @@
   struct __pyx_obj_6libfds_7libdiff_Derivative2d *dS22;
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative2d *dru;
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative2d *drv;
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative2d *dre;
 };
 
 
-/* "libfds/fluxes.pyx":721
+/* "libfds/fluxes.pyx":789
  * 
  * @cython.final
  * cdef class _ViscousFluxes3d:             # <<<<<<<<<<<<<<
- *     """
+ *     """ 3d Viscous fluxes calculation using schemes described in [1]_.
  * 
  */
 struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d {
   PyObject_HEAD
   struct __pyx_vtabstruct_6libfds_6fluxes__ViscousFluxes3d *__pyx_vtab;
   struct __pyx_obj_6libfds_6fields_Fields3d *fld;
   struct __pyx_obj_6libfds_7libdiff_Derivative3d *dTk;
@@ -2031,35 +2031,35 @@
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *dru;
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *drv;
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *drw;
   struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *dre;
 };
 
 
-/* "libfds/fluxes.pyx":862
+/* "libfds/fluxes.pyx":940
  * 
  * @cython.final
  * cdef class _Vorticity2d:             # <<<<<<<<<<<<<<
+ *     """ 2d Vorticity calculation using schemes described in [1]_.
  * 
- *     cdef Fields2d fld
  */
 struct __pyx_obj_6libfds_6fluxes__Vorticity2d {
   PyObject_HEAD
   struct __pyx_obj_6libfds_6fields_Fields2d *fld;
   struct __pyx_obj_6libfds_7libdiff_Derivative2d *dvx;
   struct __pyx_obj_6libfds_7libdiff_Derivative2d *dvy;
 };
 
 
-/* "libfds/fluxes.pyx":886
+/* "libfds/fluxes.pyx":977
  * 
  * @cython.final
  * cdef class _Vorticity3d:             # <<<<<<<<<<<<<<
+ *     """ 3d Vorticity calculation using schemes described in [1]_.
  * 
- *     cdef Fields3d fld
  */
 struct __pyx_obj_6libfds_6fluxes__Vorticity3d {
   PyObject_HEAD
   struct __pyx_obj_6libfds_6fields_Fields3d *fld;
   struct __pyx_obj_6libfds_7libdiff_Derivative3d *dvx;
   struct __pyx_obj_6libfds_7libdiff_Derivative3d *dvy;
   struct __pyx_obj_6libfds_7libdiff_Derivative3d *dvz;
@@ -2465,20 +2465,20 @@
   void (*_dym_v)(struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int, int __pyx_skip_dispatch);
   void (*_dzm_s)(struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int, int __pyx_skip_dispatch);
   void (*_dzm_v)(struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int, int __pyx_skip_dispatch);
 };
 static struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative3d *__pyx_vtabptr_6libfds_7libdiff_ViscousDerivative3d;
 
 
-/* "libfds/fluxes.pyx":82
+/* "libfds/fluxes.pyx":115
  * 
  * @cython.final
  * cdef class _EulerianFluxes2d:             # <<<<<<<<<<<<<<
+ *     """ 2d Eulerian fluxes calculation using schemes described in [1]_.
  * 
- *     cdef Fields2d fld
  */
 
 struct __pyx_vtabstruct_6libfds_6fluxes__EulerianFluxes2d {
   void (*rk4)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, int __pyx_skip_dispatch);
   void (*cout)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, int __pyx_skip_dispatch);
   void (*cin)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *);
   void (*fluxes)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *);
@@ -2490,20 +2490,20 @@
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cout(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cin(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_fluxes(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d__fluxes_crt(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d__fluxes_crv(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/fluxes.pyx":286
+/* "libfds/fluxes.pyx":332
  * 
  * @cython.final
  * cdef class _EulerianFluxes3d:             # <<<<<<<<<<<<<<
+ *     """ 3d Eulerian fluxes calculation using schemes described in [1]_.
  * 
- *     cdef Fields3d fld
  */
 
 struct __pyx_vtabstruct_6libfds_6fluxes__EulerianFluxes3d {
   void (*rk4)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, int __pyx_skip_dispatch);
   void (*cout)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, int __pyx_skip_dispatch);
   void (*cin)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *);
   void (*fluxes)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *);
@@ -2515,19 +2515,19 @@
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cout(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cin(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_fluxes(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d__fluxes_crt(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d__fluxes_crv(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/fluxes.pyx":602
+/* "libfds/fluxes.pyx":661
  * 
  * @cython.final
  * cdef class _ViscousFluxes2d:             # <<<<<<<<<<<<<<
- *     """
+ *     """ 2d Viscous fluxes calculation using schemes described in [1]_.
  * 
  */
 
 struct __pyx_vtabstruct_6libfds_6fluxes__ViscousFluxes2d {
   void (*integrate)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, int __pyx_skip_dispatch);
   void (*fluxes)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *);
   void (*_fluxes_crt)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
@@ -2536,19 +2536,19 @@
 static struct __pyx_vtabstruct_6libfds_6fluxes__ViscousFluxes2d *__pyx_vtabptr_6libfds_6fluxes__ViscousFluxes2d;
 static void __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_integrate(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, int __pyx_skip_dispatch);
 static void __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_fluxes(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *);
 static void __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d__fluxes_crt(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 static void __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d__fluxes_crv(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
 
 
-/* "libfds/fluxes.pyx":721
+/* "libfds/fluxes.pyx":789
  * 
  * @cython.final
  * cdef class _ViscousFluxes3d:             # <<<<<<<<<<<<<<
- *     """
+ *     """ 3d Viscous fluxes calculation using schemes described in [1]_.
  * 
  */
 
 struct __pyx_vtabstruct_6libfds_6fluxes__ViscousFluxes3d {
   void (*integrate)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *, int __pyx_skip_dispatch);
   void (*fluxes)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *);
   void (*_fluxes_crt)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int);
@@ -3851,84 +3851,84 @@
 static PyObject *__pyx_codeobj__40;
 /* Late includes */
 
 /* "libfds/fluxes.pyx":57
  * 
  * 
  * cpdef EulerianFluxes(fld):             # <<<<<<<<<<<<<<
+ *     """ Eulerian fluxes calculation using schemes described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
 static PyObject *__pyx_pw_6libfds_6fluxes_1EulerianFluxes(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
 static PyObject *__pyx_f_6libfds_6fluxes_EulerianFluxes(PyObject *__pyx_v_fld, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("EulerianFluxes", 0);
 
-  /* "libfds/fluxes.pyx":59
- * cpdef EulerianFluxes(fld):
- * 
+  /* "libfds/fluxes.pyx":71
+ *            Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _EulerianFluxes2d(fld)
- * 
+ *     return _EulerianFluxes3d(fld)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":60
- * 
+    /* "libfds/fluxes.pyx":72
+ *     """
  *     if isinstance(fld, Fields2d):
  *         return _EulerianFluxes2d(fld)             # <<<<<<<<<<<<<<
- * 
  *     return _EulerianFluxes3d(fld)
+ * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__EulerianFluxes2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__EulerianFluxes2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 72, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "libfds/fluxes.pyx":59
- * cpdef EulerianFluxes(fld):
- * 
+    /* "libfds/fluxes.pyx":71
+ *            Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _EulerianFluxes2d(fld)
- * 
+ *     return _EulerianFluxes3d(fld)
  */
   }
 
-  /* "libfds/fluxes.pyx":62
+  /* "libfds/fluxes.pyx":73
+ *     if isinstance(fld, Fields2d):
  *         return _EulerianFluxes2d(fld)
- * 
  *     return _EulerianFluxes3d(fld)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__EulerianFluxes3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__EulerianFluxes3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 73, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
   /* "libfds/fluxes.pyx":57
  * 
  * 
  * cpdef EulerianFluxes(fld):             # <<<<<<<<<<<<<<
+ *     """ Eulerian fluxes calculation using schemes described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("libfds.fluxes.EulerianFluxes", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
@@ -3936,14 +3936,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_6fluxes_1EulerianFluxes(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
+static char __pyx_doc_6libfds_6fluxes_EulerianFluxes[] = " Eulerian fluxes calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d or Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ";
 static PyObject *__pyx_pw_6libfds_6fluxes_1EulerianFluxes(PyObject *__pyx_self, PyObject *__pyx_v_fld) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("EulerianFluxes (wrapper)", 0);
   __pyx_r = __pyx_pf_6libfds_6fluxes_EulerianFluxes(__pyx_self, ((PyObject *)__pyx_v_fld));
 
   /* function exit code */
@@ -3973,88 +3974,88 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":65
+/* "libfds/fluxes.pyx":76
  * 
  * 
  * cpdef ViscousFluxes(fld):             # <<<<<<<<<<<<<<
+ *     """ Viscous fluxes calculation using schemes described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
 static PyObject *__pyx_pw_6libfds_6fluxes_3ViscousFluxes(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
 static PyObject *__pyx_f_6libfds_6fluxes_ViscousFluxes(PyObject *__pyx_v_fld, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("ViscousFluxes", 0);
 
-  /* "libfds/fluxes.pyx":67
- * cpdef ViscousFluxes(fld):
- * 
+  /* "libfds/fluxes.pyx":90
+ *            Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _ViscousFluxes2d(fld)
- * 
+ *     return _ViscousFluxes3d(fld)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":68
- * 
+    /* "libfds/fluxes.pyx":91
+ *     """
  *     if isinstance(fld, Fields2d):
  *         return _ViscousFluxes2d(fld)             # <<<<<<<<<<<<<<
- * 
  *     return _ViscousFluxes3d(fld)
+ * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__ViscousFluxes2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__ViscousFluxes2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 91, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "libfds/fluxes.pyx":67
- * cpdef ViscousFluxes(fld):
- * 
+    /* "libfds/fluxes.pyx":90
+ *            Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _ViscousFluxes2d(fld)
- * 
+ *     return _ViscousFluxes3d(fld)
  */
   }
 
-  /* "libfds/fluxes.pyx":70
+  /* "libfds/fluxes.pyx":92
+ *     if isinstance(fld, Fields2d):
  *         return _ViscousFluxes2d(fld)
- * 
  *     return _ViscousFluxes3d(fld)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__ViscousFluxes3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 70, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__ViscousFluxes3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 92, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fluxes.pyx":65
+  /* "libfds/fluxes.pyx":76
  * 
  * 
  * cpdef ViscousFluxes(fld):             # <<<<<<<<<<<<<<
+ *     """ Viscous fluxes calculation using schemes described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("libfds.fluxes.ViscousFluxes", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
@@ -4062,14 +4063,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_6fluxes_3ViscousFluxes(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
+static char __pyx_doc_6libfds_6fluxes_2ViscousFluxes[] = " Viscous fluxes calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d or Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ";
 static PyObject *__pyx_pw_6libfds_6fluxes_3ViscousFluxes(PyObject *__pyx_self, PyObject *__pyx_v_fld) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("ViscousFluxes (wrapper)", 0);
   __pyx_r = __pyx_pf_6libfds_6fluxes_2ViscousFluxes(__pyx_self, ((PyObject *)__pyx_v_fld));
 
   /* function exit code */
@@ -4082,15 +4084,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("ViscousFluxes", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fluxes_ViscousFluxes(__pyx_v_fld, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fluxes_ViscousFluxes(__pyx_v_fld, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4099,88 +4101,88 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":73
+/* "libfds/fluxes.pyx":95
  * 
  * 
  * cpdef Vorticity(fld):             # <<<<<<<<<<<<<<
+ *     """ Vorticity calculation using schemes described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
 static PyObject *__pyx_pw_6libfds_6fluxes_5Vorticity(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
 static PyObject *__pyx_f_6libfds_6fluxes_Vorticity(PyObject *__pyx_v_fld, CYTHON_UNUSED int __pyx_skip_dispatch) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   int __pyx_t_2;
   PyObject *__pyx_t_3 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("Vorticity", 0);
 
-  /* "libfds/fluxes.pyx":75
- * cpdef Vorticity(fld):
- * 
+  /* "libfds/fluxes.pyx":109
+ *            Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _Vorticity2d(fld)
- * 
+ *     return _Vorticity3d(fld)
  */
   __pyx_t_1 = __Pyx_TypeCheck(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d); 
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":76
- * 
+    /* "libfds/fluxes.pyx":110
+ *     """
  *     if isinstance(fld, Fields2d):
  *         return _Vorticity2d(fld)             # <<<<<<<<<<<<<<
- * 
  *     return _Vorticity3d(fld)
+ * 
  */
     __Pyx_XDECREF(__pyx_r);
-    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__Vorticity2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 76, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__Vorticity2d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 110, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __pyx_r = __pyx_t_3;
     __pyx_t_3 = 0;
     goto __pyx_L0;
 
-    /* "libfds/fluxes.pyx":75
- * cpdef Vorticity(fld):
- * 
+    /* "libfds/fluxes.pyx":109
+ *            Pages 194-214.
+ *     """
  *     if isinstance(fld, Fields2d):             # <<<<<<<<<<<<<<
  *         return _Vorticity2d(fld)
- * 
+ *     return _Vorticity3d(fld)
  */
   }
 
-  /* "libfds/fluxes.pyx":78
+  /* "libfds/fluxes.pyx":111
+ *     if isinstance(fld, Fields2d):
  *         return _Vorticity2d(fld)
- * 
  *     return _Vorticity3d(fld)             # <<<<<<<<<<<<<<
  * 
  * 
  */
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__Vorticity3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 78, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_CallOneArg(((PyObject *)__pyx_ptype_6libfds_6fluxes__Vorticity3d), __pyx_v_fld); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 111, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __pyx_r = __pyx_t_3;
   __pyx_t_3 = 0;
   goto __pyx_L0;
 
-  /* "libfds/fluxes.pyx":73
+  /* "libfds/fluxes.pyx":95
  * 
  * 
  * cpdef Vorticity(fld):             # <<<<<<<<<<<<<<
+ *     """ Vorticity calculation using schemes described in [1]_.
  * 
- *     if isinstance(fld, Fields2d):
  */
 
   /* function exit code */
   __pyx_L1_error:;
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_AddTraceback("libfds.fluxes.Vorticity", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = 0;
@@ -4188,14 +4190,15 @@
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
 /* Python wrapper */
 static PyObject *__pyx_pw_6libfds_6fluxes_5Vorticity(PyObject *__pyx_self, PyObject *__pyx_v_fld); /*proto*/
+static char __pyx_doc_6libfds_6fluxes_4Vorticity[] = " Vorticity calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d or Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ";
 static PyObject *__pyx_pw_6libfds_6fluxes_5Vorticity(PyObject *__pyx_self, PyObject *__pyx_v_fld) {
   PyObject *__pyx_r = 0;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("Vorticity (wrapper)", 0);
   __pyx_r = __pyx_pf_6libfds_6fluxes_4Vorticity(__pyx_self, ((PyObject *)__pyx_v_fld));
 
   /* function exit code */
@@ -4208,15 +4211,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("Vorticity", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __pyx_f_6libfds_6fluxes_Vorticity(__pyx_v_fld, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)
+  __pyx_t_1 = __pyx_f_6libfds_6fluxes_Vorticity(__pyx_v_fld, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 95, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4225,15 +4228,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":87
+/* "libfds/fluxes.pyx":133
  *     cdef EulerDerivative2d dr, dru, drv, dre
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  *         """ msh,  """
  * 
  */
 
@@ -4262,32 +4265,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 87, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 133, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields2d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 87, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 133, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fluxes._EulerianFluxes2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 87, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 133, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_6fluxes_17_EulerianFluxes2d___cinit__(((struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -4306,54 +4309,54 @@
   PyObject *__pyx_t_6 = NULL;
   PyObject *__pyx_t_7 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fluxes.pyx":90
+  /* "libfds/fluxes.pyx":136
  *         """ msh,  """
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         if self.fld.mesh_type == 'cartesian':
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/fluxes.pyx":92
+  /* "libfds/fluxes.pyx":138
  *         self.fld = fld
  * 
  *         if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld)
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld)
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 92, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 138, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":93
+    /* "libfds/fluxes.pyx":139
  * 
  *         if self.fld.mesh_type == 'cartesian':
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld)             # <<<<<<<<<<<<<<
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld)
  * 
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = PyTuple_New(5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_5);
@@ -4362,39 +4365,39 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_7, 4, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
-    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 93, __pyx_L1_error)
+    __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 139, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GIVEREF(__pyx_t_6);
     __Pyx_GOTREF(__pyx_v_self->dr);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dr));
     __pyx_v_self->dr = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *)__pyx_t_6);
     __pyx_t_6 = 0;
 
-    /* "libfds/fluxes.pyx":94
+    /* "libfds/fluxes.pyx":140
  *         if self.fld.mesh_type == 'cartesian':
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld)
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         elif self.fld.mesh_type == 'curvilinear':
  */
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 94, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 94, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 94, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 94, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyTuple_New(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 94, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_5);
@@ -4403,60 +4406,60 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_3, 4, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_6 = 0;
     __pyx_t_7 = 0;
     __pyx_t_5 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 94, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GIVEREF(__pyx_t_4);
     __Pyx_GOTREF(__pyx_v_self->dru);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dru));
     __pyx_v_self->dru = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "libfds/fluxes.pyx":92
+    /* "libfds/fluxes.pyx":138
  *         self.fld = fld
  * 
  *         if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld)
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld)
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":96
+  /* "libfds/fluxes.pyx":142
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld)
  * 
  *         elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld)
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld)
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 96, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 142, __pyx_L1_error)
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":97
+    /* "libfds/fluxes.pyx":143
  * 
  *         elif self.fld.mesh_type == 'curvilinear':
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld)             # <<<<<<<<<<<<<<
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld)
  * 
  */
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 97, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 97, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 97, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 97, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = PyTuple_New(5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 97, __pyx_L1_error)
+    __pyx_t_6 = PyTuple_New(5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_t_5);
@@ -4465,39 +4468,39 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_6, 4, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_4 = 0;
     __pyx_t_3 = 0;
     __pyx_t_5 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 97, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 143, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
     __Pyx_GIVEREF(__pyx_t_7);
     __Pyx_GOTREF(__pyx_v_self->dr);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dr));
     __pyx_v_self->dr = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *)__pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "libfds/fluxes.pyx":98
+    /* "libfds/fluxes.pyx":144
  *         elif self.fld.mesh_type == 'curvilinear':
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld)
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         self.drv = EulerDerivative2d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld)
  */
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 144, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 144, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 144, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fu, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 144, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_6);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_5);
@@ -4506,49 +4509,49 @@
     __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_4, 4, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_7 = 0;
     __pyx_t_6 = 0;
     __pyx_t_5 = 0;
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 98, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GIVEREF(__pyx_t_3);
     __Pyx_GOTREF(__pyx_v_self->dru);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dru));
     __pyx_v_self->dru = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":96
+    /* "libfds/fluxes.pyx":142
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld)
  * 
  *         elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative2d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld)
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld)
  */
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":100
+  /* "libfds/fluxes.pyx":146
  *             self.dru = EulerDerivative2d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld)
  * 
  *         self.drv = EulerDerivative2d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld)             # <<<<<<<<<<<<<<
  *         self.dre = EulerDerivative2d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld)
  * 
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = PyTuple_New(5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_5);
@@ -4557,39 +4560,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_7, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
   __pyx_t_5 = 0;
   __pyx_t_6 = 0;
-  __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 100, __pyx_L1_error)
+  __pyx_t_6 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 146, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_GIVEREF(__pyx_t_6);
   __Pyx_GOTREF(__pyx_v_self->drv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->drv));
   __pyx_v_self->drv = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *)__pyx_t_6);
   __pyx_t_6 = 0;
 
-  /* "libfds/fluxes.pyx":101
+  /* "libfds/fluxes.pyx":147
  * 
  *         self.drv = EulerDerivative2d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld)
  *         self.dre = EulerDerivative2d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void rk4(self):
  */
-  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_5);
@@ -4598,24 +4601,24 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_3, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_6 = 0;
   __pyx_t_7 = 0;
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 101, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 147, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->dre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dre));
   __pyx_v_self->dre = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative2d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/fluxes.pyx":87
+  /* "libfds/fluxes.pyx":133
  *     cdef EulerDerivative2d dr, dru, drv, dre
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  *         """ msh,  """
  * 
  */
 
@@ -4631,15 +4634,15 @@
   __Pyx_AddTraceback("libfds.fluxes._EulerianFluxes2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":103
+/* "libfds/fluxes.pyx":149
  *         self.dre = EulerDerivative2d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld)
  * 
  *     cpdef void rk4(self):             # <<<<<<<<<<<<<<
  *         """
  *           Avancement de la solution en temps  l'aide d'un algortihme de
  */
 
@@ -4651,158 +4654,158 @@
   int __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("rk4", 0);
 
-  /* "libfds/fluxes.pyx":113
+  /* "libfds/fluxes.pyx":159
  *         # Make copy of (r, ru, rv, re) => (K, Ku, Kv, Ke)
  *         # or (r/J, ru/J, ...) in curvilinear rather than (r, ru, ...)
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.phys2num()
  * 
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 113, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 159, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":114
+    /* "libfds/fluxes.pyx":160
  *         # or (r/J, ru/J, ...) in curvilinear rather than (r, ru, ...)
  *         if self.fld.mesh_type == 'curvilinear':
  *             self.fld.phys2num()             # <<<<<<<<<<<<<<
  * 
  *         self.fld.update('K')
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->phys2num(__pyx_v_self->fld);
 
-    /* "libfds/fluxes.pyx":113
+    /* "libfds/fluxes.pyx":159
  *         # Make copy of (r, ru, rv, re) => (K, Ku, Kv, Ke)
  *         # or (r/J, ru/J, ...) in curvilinear rather than (r, ru, ...)
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.phys2num()
  * 
  */
   }
 
-  /* "libfds/fluxes.pyx":116
+  /* "libfds/fluxes.pyx":162
  *             self.fld.phys2num()
  * 
  *         self.fld.update('K')             # <<<<<<<<<<<<<<
  * 
  *         # Get back to physical vars to calculate fluxes
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_K);
 
-  /* "libfds/fluxes.pyx":119
+  /* "libfds/fluxes.pyx":165
  * 
  *         # Get back to physical vars to calculate fluxes
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.num2phys()
  * 
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 119, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 165, __pyx_L1_error)
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":120
+    /* "libfds/fluxes.pyx":166
  *         # Get back to physical vars to calculate fluxes
  *         if self.fld.mesh_type == 'curvilinear':
  *             self.fld.num2phys()             # <<<<<<<<<<<<<<
  * 
  *         for irk in range(1, 7):
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->num2phys(__pyx_v_self->fld);
 
-    /* "libfds/fluxes.pyx":119
+    /* "libfds/fluxes.pyx":165
  * 
  *         # Get back to physical vars to calculate fluxes
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.num2phys()
  * 
  */
   }
 
-  /* "libfds/fluxes.pyx":122
+  /* "libfds/fluxes.pyx":168
  *             self.fld.num2phys()
  * 
  *         for irk in range(1, 7):             # <<<<<<<<<<<<<<
  * 
  *             # Eulerian fluxes
  */
   for (__pyx_t_3 = 1; __pyx_t_3 < 7; __pyx_t_3+=1) {
     __pyx_v_irk = __pyx_t_3;
 
-    /* "libfds/fluxes.pyx":125
+    /* "libfds/fluxes.pyx":171
  * 
  *             # Eulerian fluxes
  *             self.fld.update_odudtrk(rk[irk])             # <<<<<<<<<<<<<<
  *             self.cin()
  * 
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update_odudtrk(__pyx_v_self->fld, (rk[__pyx_v_irk]));
 
-    /* "libfds/fluxes.pyx":126
+    /* "libfds/fluxes.pyx":172
  *             # Eulerian fluxes
  *             self.fld.update_odudtrk(rk[irk])
  *             self.cin()             # <<<<<<<<<<<<<<
  * 
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  */
     __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cin(__pyx_v_self);
 
-    /* "libfds/fluxes.pyx":129
+    /* "libfds/fluxes.pyx":175
  * 
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  *             if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self.fld.num2phys()
  * 
  */
-    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 129, __pyx_L1_error)
+    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 175, __pyx_L1_error)
     __pyx_t_2 = (__pyx_t_1 != 0);
     if (__pyx_t_2) {
 
-      /* "libfds/fluxes.pyx":130
+      /* "libfds/fluxes.pyx":176
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  *             if self.fld.mesh_type == 'curvilinear':
  *                 self.fld.num2phys()             # <<<<<<<<<<<<<<
  * 
  *             # Boundary conditions
  */
       ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->num2phys(__pyx_v_self->fld);
 
-      /* "libfds/fluxes.pyx":129
+      /* "libfds/fluxes.pyx":175
  * 
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  *             if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self.fld.num2phys()
  * 
  */
     }
 
-    /* "libfds/fluxes.pyx":133
+    /* "libfds/fluxes.pyx":179
  * 
  *             # Boundary conditions
  *             self.cout()             # <<<<<<<<<<<<<<
  * 
  *             # Compute p
  */
     __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cout(__pyx_v_self, 0);
 
-    /* "libfds/fluxes.pyx":136
+    /* "libfds/fluxes.pyx":182
  * 
  *             # Compute p
  *             self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  * 
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
   }
 
-  /* "libfds/fluxes.pyx":103
+  /* "libfds/fluxes.pyx":149
  *         self.dre = EulerDerivative2d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld)
  * 
  *     cpdef void rk4(self):             # <<<<<<<<<<<<<<
  *         """
  *           Avancement de la solution en temps  l'aide d'un algortihme de
  */
 
@@ -4833,15 +4836,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("rk4", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_rk4(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_rk4(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4850,15 +4853,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":139
+/* "libfds/fluxes.pyx":185
  * 
  * 
  *     cpdef void cout(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Face2d face
  */
 
@@ -4871,62 +4874,62 @@
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("cout", 0);
 
-  /* "libfds/fluxes.pyx":143
+  /* "libfds/fluxes.pyx":189
  *         cdef Face2d face
  * 
  *         for face in self.fld.bc:             # <<<<<<<<<<<<<<
  *             face.apply_bc(self.fld.cfg.it)
  * 
  */
   if (unlikely(__pyx_v_self->fld->bc == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 143, __pyx_L1_error)
+    __PYX_ERR(0, 189, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->bc; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 189, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 143, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 189, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Face2d))))) __PYX_ERR(0, 143, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Face2d))))) __PYX_ERR(0, 189, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_face, ((struct __pyx_obj_6libfds_6fields_Face2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":144
+    /* "libfds/fluxes.pyx":190
  * 
  *         for face in self.fld.bc:
  *             face.apply_bc(self.fld.cfg.it)             # <<<<<<<<<<<<<<
  * 
  *     cdef void cin(self):
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->fld->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 144, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->fld->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 190, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 190, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     ((struct __pyx_vtabstruct_6libfds_6fields_Face2d *)__pyx_v_face->__pyx_vtab)->apply_bc(__pyx_v_face, __pyx_t_4);
 
-    /* "libfds/fluxes.pyx":143
+    /* "libfds/fluxes.pyx":189
  *         cdef Face2d face
  * 
  *         for face in self.fld.bc:             # <<<<<<<<<<<<<<
  *             face.apply_bc(self.fld.cfg.it)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":139
+  /* "libfds/fluxes.pyx":185
  * 
  * 
  *     cpdef void cout(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Face2d face
  */
 
@@ -4959,15 +4962,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("cout", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cout(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cout(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 185, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -4976,113 +4979,113 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":146
+/* "libfds/fluxes.pyx":192
  *             face.apply_bc(self.fld.cfg.it)
  * 
  *     cdef void cin(self):             # <<<<<<<<<<<<<<
  *         """ Interior domain. """
  * 
  */
 
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cin(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("cin", 0);
 
-  /* "libfds/fluxes.pyx":150
+  /* "libfds/fluxes.pyx":196
  * 
  *         # update sources
  *         if self.fld.src:             # <<<<<<<<<<<<<<
  *             self.fld.update_sources()
  * 
  */
   __pyx_t_1 = (__pyx_v_self->fld->src != Py_None)&&(PyList_GET_SIZE(__pyx_v_self->fld->src) != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":151
+    /* "libfds/fluxes.pyx":197
  *         # update sources
  *         if self.fld.src:
  *             self.fld.update_sources()             # <<<<<<<<<<<<<<
  * 
  *         # Update fluxes
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update_sources(__pyx_v_self->fld);
 
-    /* "libfds/fluxes.pyx":150
+    /* "libfds/fluxes.pyx":196
  * 
  *         # update sources
  *         if self.fld.src:             # <<<<<<<<<<<<<<
  *             self.fld.update_sources()
  * 
  */
   }
 
-  /* "libfds/fluxes.pyx":154
+  /* "libfds/fluxes.pyx":200
  * 
  *         # Update fluxes
  *         self.fluxes()             # <<<<<<<<<<<<<<
  * 
  *         # Derivate + integrate fluxes
  */
   __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_fluxes(__pyx_v_self);
 
-  /* "libfds/fluxes.pyx":157
+  /* "libfds/fluxes.pyx":203
  * 
  *         # Derivate + integrate fluxes
  *         self.dr.apply()             # <<<<<<<<<<<<<<
  *         self.dru.apply()
  *         self.drv.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative2d *)__pyx_v_self->dr->__pyx_vtab)->apply(__pyx_v_self->dr);
 
-  /* "libfds/fluxes.pyx":158
+  /* "libfds/fluxes.pyx":204
  *         # Derivate + integrate fluxes
  *         self.dr.apply()
  *         self.dru.apply()             # <<<<<<<<<<<<<<
  *         self.drv.apply()
  *         self.dre.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative2d *)__pyx_v_self->dru->__pyx_vtab)->apply(__pyx_v_self->dru);
 
-  /* "libfds/fluxes.pyx":159
+  /* "libfds/fluxes.pyx":205
  *         self.dr.apply()
  *         self.dru.apply()
  *         self.drv.apply()             # <<<<<<<<<<<<<<
  *         self.dre.apply()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative2d *)__pyx_v_self->drv->__pyx_vtab)->apply(__pyx_v_self->drv);
 
-  /* "libfds/fluxes.pyx":160
+  /* "libfds/fluxes.pyx":206
  *         self.dru.apply()
  *         self.drv.apply()
  *         self.dre.apply()             # <<<<<<<<<<<<<<
  * 
  *     cdef void fluxes(self):
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative2d *)__pyx_v_self->dre->__pyx_vtab)->apply(__pyx_v_self->dre);
 
-  /* "libfds/fluxes.pyx":146
+  /* "libfds/fluxes.pyx":192
  *             face.apply_bc(self.fld.cfg.it)
  * 
  *     cdef void cin(self):             # <<<<<<<<<<<<<<
  *         """ Interior domain. """
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":162
+/* "libfds/fluxes.pyx":208
  *         self.dre.apply()
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -5095,109 +5098,109 @@
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fluxes", 0);
 
-  /* "libfds/fluxes.pyx":166
+  /* "libfds/fluxes.pyx":212
  *         cdef Domain2d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  * 
  *             if self.fld.mesh_type == 'cartesian':
  */
   if (unlikely(__pyx_v_self->fld->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 166, __pyx_L1_error)
+    __PYX_ERR(0, 212, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 166, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 212, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 212, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 166, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 212, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":168
+    /* "libfds/fluxes.pyx":214
  *         for sub in self.fld.cdomains:
  * 
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 168, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 214, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fluxes.pyx":169
+      /* "libfds/fluxes.pyx":215
  * 
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *             elif self.fld.mesh_type == 'curvilinear':
  */
       __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d__fluxes_crt(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":168
+      /* "libfds/fluxes.pyx":214
  *         for sub in self.fld.cdomains:
  * 
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
       goto __pyx_L5;
     }
 
-    /* "libfds/fluxes.pyx":171
+    /* "libfds/fluxes.pyx":217
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 171, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 217, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fluxes.pyx":172
+      /* "libfds/fluxes.pyx":218
  * 
  *             elif self.fld.mesh_type == 'curvilinear':
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
       __pyx_f_6libfds_6fluxes_17_EulerianFluxes2d__fluxes_crv(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":171
+      /* "libfds/fluxes.pyx":217
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
     }
     __pyx_L5:;
 
-    /* "libfds/fluxes.pyx":166
+    /* "libfds/fluxes.pyx":212
  *         cdef Domain2d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  * 
  *             if self.fld.mesh_type == 'cartesian':
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":162
+  /* "libfds/fluxes.pyx":208
  *         self.dre.apply()
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -5208,15 +5211,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fluxes._EulerianFluxes2d.fluxes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":174
+/* "libfds/fluxes.pyx":220
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -5240,25 +5243,25 @@
   Py_ssize_t __pyx_t_12;
   Py_ssize_t __pyx_t_13;
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   __Pyx_RefNannySetupContext("_fluxes_crt", 0);
 
-  /* "libfds/fluxes.pyx":179
+  /* "libfds/fluxes.pyx":225
  *         cdef double invr, pre
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":180
+    /* "libfds/fluxes.pyx":226
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
     {
@@ -5292,51 +5295,51 @@
                           {
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_invr = ((double)__PYX_NAN());
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_pre = ((double)__PYX_NAN());
 
-                              /* "libfds/fluxes.pyx":181
+                              /* "libfds/fluxes.pyx":227
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fluxes.pyx":183
+                                /* "libfds/fluxes.pyx":229
  *                 for iy in range(iymin, iymax + 1):
  * 
  *                     invr = 1. / self.fld.r[ix, iy]             # <<<<<<<<<<<<<<
  *                     pre = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  * 
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_v_invr = (1. / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_9 * __pyx_v_self->fld->r.strides[0]) )) + __pyx_t_10)) ))));
 
-                                /* "libfds/fluxes.pyx":184
+                                /* "libfds/fluxes.pyx":230
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  *                     pre = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])             # <<<<<<<<<<<<<<
  * 
  *                     #self.fld.E[ix, iy] = self.fld.ru[ix, iy]
  */
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_v_pre = (__pyx_v_invr * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_10 * __pyx_v_self->fld->re.strides[0]) )) + __pyx_t_9)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))));
 
-                                /* "libfds/fluxes.pyx":187
+                                /* "libfds/fluxes.pyx":233
  * 
  *                     #self.fld.E[ix, iy] = self.fld.ru[ix, iy]
  *                     self.fld.Eu[ix, iy] = self.fld.ru[ix, iy] * self.fld.ru[ix, iy] * invr + self.fld.p[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.fld.Ev[ix, iy] = self.fld.ru[ix, iy] * self.fld.rv[ix, iy] * invr
  *                     self.fld.Ee[ix, iy] = self.fld.ru[ix, iy] * pre
  */
                                 __pyx_t_12 = __pyx_v_ix;
@@ -5345,43 +5348,43 @@
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_15 * __pyx_v_self->fld->Eu.strides[0]) )) + __pyx_t_16)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_9 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_10)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_13 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_14)) ))));
 
-                                /* "libfds/fluxes.pyx":188
+                                /* "libfds/fluxes.pyx":234
  *                     #self.fld.E[ix, iy] = self.fld.ru[ix, iy]
  *                     self.fld.Eu[ix, iy] = self.fld.ru[ix, iy] * self.fld.ru[ix, iy] * invr + self.fld.p[ix, iy]
  *                     self.fld.Ev[ix, iy] = self.fld.ru[ix, iy] * self.fld.rv[ix, iy] * invr             # <<<<<<<<<<<<<<
  *                     self.fld.Ee[ix, iy] = self.fld.ru[ix, iy] * pre
  * 
  */
                                 __pyx_t_14 = __pyx_v_ix;
                                 __pyx_t_13 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_11 * __pyx_v_self->fld->Ev.strides[0]) )) + __pyx_t_12)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_14 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_13)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) )))) * __pyx_v_invr);
 
-                                /* "libfds/fluxes.pyx":189
+                                /* "libfds/fluxes.pyx":235
  *                     self.fld.Eu[ix, iy] = self.fld.ru[ix, iy] * self.fld.ru[ix, iy] * invr + self.fld.p[ix, iy]
  *                     self.fld.Ev[ix, iy] = self.fld.ru[ix, iy] * self.fld.rv[ix, iy] * invr
  *                     self.fld.Ee[ix, iy] = self.fld.ru[ix, iy] * pre             # <<<<<<<<<<<<<<
  * 
  *                     #self.fld.F[ix, iy] = self.fld.rv[ix, iy]
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_13 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_14)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_9 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_10)) ))) * __pyx_v_pre);
 
-                                /* "libfds/fluxes.pyx":193
+                                /* "libfds/fluxes.pyx":239
  *                     #self.fld.F[ix, iy] = self.fld.rv[ix, iy]
  *                     #self.fld.Fu[ix, iy] = self.fld.Ev[ix, iy]
  *                     self.fld.Fv[ix, iy] = self.fld.rv[ix, iy] * self.fld.rv[ix, iy] * invr + self.fld.p[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre
  *         else:
  */
                                 __pyx_t_10 = __pyx_v_ix;
@@ -5390,15 +5393,15 @@
                                 __pyx_t_13 = __pyx_v_iy;
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_16 = __pyx_v_ix;
                                 __pyx_t_15 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_16 * __pyx_v_self->fld->Fv.strides[0]) )) + __pyx_t_15)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_14 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_13)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_11)) ))));
 
-                                /* "libfds/fluxes.pyx":194
+                                /* "libfds/fluxes.pyx":240
  *                     #self.fld.Fu[ix, iy] = self.fld.Ev[ix, iy]
  *                     self.fld.Fv[ix, iy] = self.fld.rv[ix, iy] * self.fld.rv[ix, iy] * invr + self.fld.p[ix, iy]
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_11 = __pyx_v_ix;
@@ -5416,15 +5419,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fluxes.pyx":180
+        /* "libfds/fluxes.pyx":226
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
         /*finally:*/ {
@@ -5435,74 +5438,74 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fluxes.pyx":179
+    /* "libfds/fluxes.pyx":225
  *         cdef double invr, pre
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":196
+  /* "libfds/fluxes.pyx":242
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fluxes.pyx":197
+      /* "libfds/fluxes.pyx":243
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fluxes.pyx":199
+        /* "libfds/fluxes.pyx":245
  *                 for iy in range(iymin, iymax + 1):
  * 
  *                     invr = 1. / self.fld.r[ix, iy]             # <<<<<<<<<<<<<<
  *                     pre = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  * 
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_v_invr = (1. / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_12 * __pyx_v_self->fld->r.strides[0]) )) + __pyx_t_11)) ))));
 
-        /* "libfds/fluxes.pyx":200
+        /* "libfds/fluxes.pyx":246
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  *                     pre = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])             # <<<<<<<<<<<<<<
  * 
  *                     #self.fld.E[ix, iy] = self.fld.ru[ix, iy]
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         __pyx_v_pre = (__pyx_v_invr * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_11 * __pyx_v_self->fld->re.strides[0]) )) + __pyx_t_12)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_14 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_13)) )))));
 
-        /* "libfds/fluxes.pyx":203
+        /* "libfds/fluxes.pyx":249
  * 
  *                     #self.fld.E[ix, iy] = self.fld.ru[ix, iy]
  *                     self.fld.Eu[ix, iy] = self.fld.ru[ix, iy] * self.fld.ru[ix, iy] * invr + self.fld.p[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.fld.Ev[ix, iy] = self.fld.ru[ix, iy] * self.fld.rv[ix, iy] * invr
  *                     self.fld.Ee[ix, iy] = self.fld.ru[ix, iy] * pre
  */
         __pyx_t_13 = __pyx_v_ix;
@@ -5511,43 +5514,43 @@
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_15 = __pyx_v_ix;
         __pyx_t_16 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_15 * __pyx_v_self->fld->Eu.strides[0]) )) + __pyx_t_16)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_13 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_9 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_10)) ))));
 
-        /* "libfds/fluxes.pyx":204
+        /* "libfds/fluxes.pyx":250
  *                     #self.fld.E[ix, iy] = self.fld.ru[ix, iy]
  *                     self.fld.Eu[ix, iy] = self.fld.ru[ix, iy] * self.fld.ru[ix, iy] * invr + self.fld.p[ix, iy]
  *                     self.fld.Ev[ix, iy] = self.fld.ru[ix, iy] * self.fld.rv[ix, iy] * invr             # <<<<<<<<<<<<<<
  *                     self.fld.Ee[ix, iy] = self.fld.ru[ix, iy] * pre
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_14 * __pyx_v_self->fld->Ev.strides[0]) )) + __pyx_t_13)) )) = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_10 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_9)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_11 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_12)) )))) * __pyx_v_invr);
 
-        /* "libfds/fluxes.pyx":205
+        /* "libfds/fluxes.pyx":251
  *                     self.fld.Eu[ix, iy] = self.fld.ru[ix, iy] * self.fld.ru[ix, iy] * invr + self.fld.p[ix, iy]
  *                     self.fld.Ev[ix, iy] = self.fld.ru[ix, iy] * self.fld.rv[ix, iy] * invr
  *                     self.fld.Ee[ix, iy] = self.fld.ru[ix, iy] * pre             # <<<<<<<<<<<<<<
  * 
  *                     #self.fld.F[ix, iy] = self.fld.rv[ix, iy]
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_9 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_10)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) ))) * __pyx_v_pre);
 
-        /* "libfds/fluxes.pyx":209
+        /* "libfds/fluxes.pyx":255
  *                     #self.fld.F[ix, iy] = self.fld.rv[ix, iy]
  *                     #self.fld.Fu[ix, iy] = self.fld.Ev[ix, iy]
  *                     self.fld.Fv[ix, iy] = self.fld.rv[ix, iy] * self.fld.rv[ix, iy] * invr + self.fld.p[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre
  * 
  */
         __pyx_t_11 = __pyx_v_ix;
@@ -5556,15 +5559,15 @@
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_16 * __pyx_v_self->fld->Fv.strides[0]) )) + __pyx_t_15)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_11 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_13 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_14)) ))));
 
-        /* "libfds/fluxes.pyx":210
+        /* "libfds/fluxes.pyx":256
  *                     #self.fld.Fu[ix, iy] = self.fld.Ev[ix, iy]
  *                     self.fld.Fv[ix, iy] = self.fld.rv[ix, iy] * self.fld.rv[ix, iy] * invr + self.fld.p[ix, iy]
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
         __pyx_t_14 = __pyx_v_ix;
@@ -5573,27 +5576,27 @@
         __pyx_t_10 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_9 * __pyx_v_self->fld->Fe.strides[0]) )) + __pyx_t_10)) )) = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_14 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_13)) ))) * __pyx_v_pre);
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":174
+  /* "libfds/fluxes.pyx":220
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":212
+/* "libfds/fluxes.pyx":258
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -5625,25 +5628,25 @@
   Py_ssize_t __pyx_t_14;
   Py_ssize_t __pyx_t_15;
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   __Pyx_RefNannySetupContext("_fluxes_crv", 0);
 
-  /* "libfds/fluxes.pyx":219
+  /* "libfds/fluxes.pyx":265
  *         cdef double ruv, ruu, rvv
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":220
+    /* "libfds/fluxes.pyx":266
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
     {
@@ -5683,376 +5686,376 @@
                               __pyx_v_p_plus_e = ((double)__PYX_NAN());
                               __pyx_v_ru_p_plus_e = ((double)__PYX_NAN());
                               __pyx_v_ruu = ((double)__PYX_NAN());
                               __pyx_v_ruv = ((double)__PYX_NAN());
                               __pyx_v_rv_p_plus_e = ((double)__PYX_NAN());
                               __pyx_v_rvv = ((double)__PYX_NAN());
 
-                              /* "libfds/fluxes.pyx":221
+                              /* "libfds/fluxes.pyx":267
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fluxes.pyx":223
+                                /* "libfds/fluxes.pyx":269
  *                 for iy in range(iymin, iymax + 1):
  * 
  *                     invr = 1. / self.fld.r[ix, iy]             # <<<<<<<<<<<<<<
  *                     invJ = 1. / self.fld.J[ix, iy]
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_v_invr = (1. / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_9 * __pyx_v_self->fld->r.strides[0]) )) + __pyx_t_10)) ))));
 
-                                /* "libfds/fluxes.pyx":224
+                                /* "libfds/fluxes.pyx":270
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  *                     invJ = 1. / self.fld.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  */
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_v_invJ = (1. / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->J.data + __pyx_t_10 * __pyx_v_self->fld->J.strides[0]) )) + __pyx_t_9)) ))));
 
-                                /* "libfds/fluxes.pyx":225
+                                /* "libfds/fluxes.pyx":271
  *                     invr = 1. / self.fld.r[ix, iy]
  *                     invJ = 1. / self.fld.J[ix, iy]
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])             # <<<<<<<<<<<<<<
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_v_p_plus_e = (__pyx_v_invr * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_9 * __pyx_v_self->fld->re.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))));
 
-                                /* "libfds/fluxes.pyx":226
+                                /* "libfds/fluxes.pyx":272
  *                     invJ = 1. / self.fld.J[ix, iy]
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e             # <<<<<<<<<<<<<<
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_v_ru_p_plus_e = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) ))) * __pyx_v_p_plus_e);
 
-                                /* "libfds/fluxes.pyx":227
+                                /* "libfds/fluxes.pyx":273
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e             # <<<<<<<<<<<<<<
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_v_rv_p_plus_e = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_11 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_12)) ))) * __pyx_v_p_plus_e);
 
-                                /* "libfds/fluxes.pyx":228
+                                /* "libfds/fluxes.pyx":274
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]             # <<<<<<<<<<<<<<
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_v_ruv = ((__pyx_v_invr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) ))));
 
-                                /* "libfds/fluxes.pyx":229
+                                /* "libfds/fluxes.pyx":275
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]             # <<<<<<<<<<<<<<
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  * 
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_v_ruu = ((__pyx_v_invr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_9 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_10)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_11 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_12)) ))));
 
-                                /* "libfds/fluxes.pyx":230
+                                /* "libfds/fluxes.pyx":276
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_v_rvv = ((__pyx_v_invr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) ))));
 
-                                /* "libfds/fluxes.pyx":232
+                                /* "libfds/fluxes.pyx":278
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":233
+                                /* "libfds/fluxes.pyx":279
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  */
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":232
+                                /* "libfds/fluxes.pyx":278
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  */
                                 __pyx_t_17 = __pyx_v_ix;
                                 __pyx_t_18 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_17 * __pyx_v_self->fld->E.strides[0]) )) + __pyx_t_18)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_9 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_10)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_11 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_12)) )))) + ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_13 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_15 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_16)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":234
+                                /* "libfds/fluxes.pyx":280
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
                                 __pyx_t_16 = __pyx_v_ix;
                                 __pyx_t_15 = __pyx_v_iy;
                                 __pyx_t_14 = __pyx_v_ix;
                                 __pyx_t_13 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":235
+                                /* "libfds/fluxes.pyx":281
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":234
+                                /* "libfds/fluxes.pyx":280
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
                                 __pyx_t_18 = __pyx_v_ix;
                                 __pyx_t_17 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_18 * __pyx_v_self->fld->F.strides[0]) )) + __pyx_t_17)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_16 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_15)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_14 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_13)) )))) + ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_11)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_10 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":237
+                                /* "libfds/fluxes.pyx":283
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":238
+                                /* "libfds/fluxes.pyx":284
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":237
+                                /* "libfds/fluxes.pyx":283
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  */
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_15 * __pyx_v_self->fld->Eu.strides[0]) )) + __pyx_t_16)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_9 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_10)) )))) + ((__pyx_v_ruu + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_13 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_14)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":239
+                                /* "libfds/fluxes.pyx":285
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  */
                                 __pyx_t_14 = __pyx_v_ix;
                                 __pyx_t_13 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":240
+                                /* "libfds/fluxes.pyx":286
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":239
+                                /* "libfds/fluxes.pyx":285
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  */
                                 __pyx_t_16 = __pyx_v_ix;
                                 __pyx_t_15 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fu.data + __pyx_t_16 * __pyx_v_self->fld->Fu.strides[0]) )) + __pyx_t_15)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_14 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_13)) )))) + ((__pyx_v_ruu + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_10 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":242
+                                /* "libfds/fluxes.pyx":288
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":243
+                                /* "libfds/fluxes.pyx":289
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":242
+                                /* "libfds/fluxes.pyx":288
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  */
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_15 * __pyx_v_self->fld->Ev.strides[0]) )) + __pyx_t_16)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_9 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_10)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_13 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_14)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":244
+                                /* "libfds/fluxes.pyx":290
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
                                 __pyx_t_14 = __pyx_v_ix;
                                 __pyx_t_13 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":245
+                                /* "libfds/fluxes.pyx":291
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":244
+                                /* "libfds/fluxes.pyx":290
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
                                 __pyx_t_16 = __pyx_v_ix;
                                 __pyx_t_15 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_16 * __pyx_v_self->fld->Fv.strides[0]) )) + __pyx_t_15)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_14 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_13)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_10 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":247
+                                /* "libfds/fluxes.pyx":293
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":248
+                                /* "libfds/fluxes.pyx":294
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":247
+                                /* "libfds/fluxes.pyx":293
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  */
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_13 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_14)) )) = (((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_9 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_10)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_11 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_12)) ))))) * __pyx_v_invJ);
 
-                                /* "libfds/fluxes.pyx":249
+                                /* "libfds/fluxes.pyx":295
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  *         else:
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":250
+                                /* "libfds/fluxes.pyx":296
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":249
+                                /* "libfds/fluxes.pyx":295
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  *         else:
  */
                                 __pyx_t_14 = __pyx_v_ix;
@@ -6068,15 +6071,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fluxes.pyx":220
+        /* "libfds/fluxes.pyx":266
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
         /*finally:*/ {
@@ -6087,414 +6090,414 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fluxes.pyx":219
+    /* "libfds/fluxes.pyx":265
  *         cdef double ruv, ruu, rvv
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":252
+  /* "libfds/fluxes.pyx":298
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fluxes.pyx":253
+      /* "libfds/fluxes.pyx":299
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fluxes.pyx":255
+        /* "libfds/fluxes.pyx":301
  *                 for iy in range(iymin, iymax + 1):
  * 
  *                     invr = 1. / self.fld.r[ix, iy]             # <<<<<<<<<<<<<<
  *                     invJ = 1. / self.fld.J[ix, iy]
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_v_invr = (1. / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_9 * __pyx_v_self->fld->r.strides[0]) )) + __pyx_t_10)) ))));
 
-        /* "libfds/fluxes.pyx":256
+        /* "libfds/fluxes.pyx":302
  * 
  *                     invr = 1. / self.fld.r[ix, iy]
  *                     invJ = 1. / self.fld.J[ix, iy]             # <<<<<<<<<<<<<<
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_v_invJ = (1. / (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->J.data + __pyx_t_10 * __pyx_v_self->fld->J.strides[0]) )) + __pyx_t_9)) ))));
 
-        /* "libfds/fluxes.pyx":257
+        /* "libfds/fluxes.pyx":303
  *                     invr = 1. / self.fld.r[ix, iy]
  *                     invJ = 1. / self.fld.J[ix, iy]
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])             # <<<<<<<<<<<<<<
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_v_p_plus_e = (__pyx_v_invr * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_9 * __pyx_v_self->fld->re.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))));
 
-        /* "libfds/fluxes.pyx":258
+        /* "libfds/fluxes.pyx":304
  *                     invJ = 1. / self.fld.J[ix, iy]
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e             # <<<<<<<<<<<<<<
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_v_ru_p_plus_e = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) ))) * __pyx_v_p_plus_e);
 
-        /* "libfds/fluxes.pyx":259
+        /* "libfds/fluxes.pyx":305
  *                     p_plus_e = invr * (self.fld.re[ix, iy] + self.fld.p[ix, iy])
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e             # <<<<<<<<<<<<<<
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_v_rv_p_plus_e = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_11 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_12)) ))) * __pyx_v_p_plus_e);
 
-        /* "libfds/fluxes.pyx":260
+        /* "libfds/fluxes.pyx":306
  *                     ru_p_plus_e = self.fld.ru[ix, iy] * p_plus_e
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]             # <<<<<<<<<<<<<<
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_v_ruv = ((__pyx_v_invr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) ))));
 
-        /* "libfds/fluxes.pyx":261
+        /* "libfds/fluxes.pyx":307
  *                     rv_p_plus_e = self.fld.rv[ix, iy] * p_plus_e
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]             # <<<<<<<<<<<<<<
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  * 
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_v_ruu = ((__pyx_v_invr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_9 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_10)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_11 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_12)) ))));
 
-        /* "libfds/fluxes.pyx":262
+        /* "libfds/fluxes.pyx":308
  *                     ruv = invr * self.fld.ru[ix, iy] * self.fld.rv[ix, iy]
  *                     ruu = invr * self.fld.ru[ix, iy] * self.fld.ru[ix, iy]
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_v_rvv = ((__pyx_v_invr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_10 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_9)) ))));
 
-        /* "libfds/fluxes.pyx":264
+        /* "libfds/fluxes.pyx":310
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":265
+        /* "libfds/fluxes.pyx":311
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  */
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         __pyx_t_15 = __pyx_v_ix;
         __pyx_t_16 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":264
+        /* "libfds/fluxes.pyx":310
  *                     rvv = invr * self.fld.rv[ix, iy] * self.fld.rv[ix, iy]
  * 
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  */
         __pyx_t_17 = __pyx_v_ix;
         __pyx_t_18 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_17 * __pyx_v_self->fld->E.strides[0]) )) + __pyx_t_18)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_9 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_10)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_11 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_12)) )))) + ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_13 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_15 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_16)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":266
+        /* "libfds/fluxes.pyx":312
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":267
+        /* "libfds/fluxes.pyx":313
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":266
+        /* "libfds/fluxes.pyx":312
  *                     self.fld.E[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dx_du[ix, iy] +
  *                                           self.fld.rv[ix, iy] * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.F[ix, iy] = (self.fld.ru[ix, iy] * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
         __pyx_t_18 = __pyx_v_ix;
         __pyx_t_17 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_18 * __pyx_v_self->fld->F.strides[0]) )) + __pyx_t_17)) )) = ((((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_16 * __pyx_v_self->fld->ru.strides[0]) )) + __pyx_t_15)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_14 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_13)) )))) + ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) )) + __pyx_t_11)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_10 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":269
+        /* "libfds/fluxes.pyx":315
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":270
+        /* "libfds/fluxes.pyx":316
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":269
+        /* "libfds/fluxes.pyx":315
  *                                           self.fld.rv[ix, iy] * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  */
         __pyx_t_15 = __pyx_v_ix;
         __pyx_t_16 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_15 * __pyx_v_self->fld->Eu.strides[0]) )) + __pyx_t_16)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_9 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_10)) )))) + ((__pyx_v_ruu + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_13 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_14)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":271
+        /* "libfds/fluxes.pyx":317
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  */
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":272
+        /* "libfds/fluxes.pyx":318
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":271
+        /* "libfds/fluxes.pyx":317
  *                     self.fld.Eu[ix, iy] = (ruv * self.fld.dx_dv[ix, iy] +
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dx_du[ix, iy]) * invJ
  *                     self.fld.Fu[ix, iy] = (ruv * self.fld.dy_dv[ix, iy] + \             # <<<<<<<<<<<<<<
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  */
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fu.data + __pyx_t_16 * __pyx_v_self->fld->Fu.strides[0]) )) + __pyx_t_15)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_14 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_13)) )))) + ((__pyx_v_ruu + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_10 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":274
+        /* "libfds/fluxes.pyx":320
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":275
+        /* "libfds/fluxes.pyx":321
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":274
+        /* "libfds/fluxes.pyx":320
  *                                            (ruu + self.fld.p[ix, iy]) * self.fld.dy_du[ix, iy]) * invJ
  * 
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  */
         __pyx_t_15 = __pyx_v_ix;
         __pyx_t_16 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_15 * __pyx_v_self->fld->Ev.strides[0]) )) + __pyx_t_16)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_9 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_10)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_11 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_12)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_13 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_14)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":276
+        /* "libfds/fluxes.pyx":322
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":277
+        /* "libfds/fluxes.pyx":323
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":276
+        /* "libfds/fluxes.pyx":322
  *                     self.fld.Ev[ix, iy] = (ruv * self.fld.dx_du[ix, iy] +
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fv[ix, iy] = (ruv * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_16 * __pyx_v_self->fld->Fv.strides[0]) )) + __pyx_t_15)) )) = (((__pyx_v_ruv * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_14 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_13)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) )) + __pyx_t_11)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_10 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":279
+        /* "libfds/fluxes.pyx":325
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":280
+        /* "libfds/fluxes.pyx":326
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":279
+        /* "libfds/fluxes.pyx":325
  *                                            (rvv + self.fld.p[ix, iy]) * self.fld.dy_dv[ix, iy]) * invJ
  * 
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  */
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_13 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_14)) )) = (((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_9 * __pyx_v_self->fld->dx_du.strides[0]) )) + __pyx_t_10)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_11 * __pyx_v_self->fld->dx_dv.strides[0]) )) + __pyx_t_12)) ))))) * __pyx_v_invJ);
 
-        /* "libfds/fluxes.pyx":281
+        /* "libfds/fluxes.pyx":327
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":282
+        /* "libfds/fluxes.pyx":328
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ             # <<<<<<<<<<<<<<
  * 
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":281
+        /* "libfds/fluxes.pyx":327
  *                     self.fld.Ee[ix, iy] = (ru_p_plus_e * self.fld.dx_du[ix, iy] +
  *                                            rv_p_plus_e * self.fld.dx_dv[ix, iy]) * invJ
  *                     self.fld.Fe[ix, iy] = (ru_p_plus_e * self.fld.dy_du[ix, iy] +             # <<<<<<<<<<<<<<
  *                                            rv_p_plus_e * self.fld.dy_dv[ix, iy]) * invJ
  * 
  */
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_14 * __pyx_v_self->fld->Fe.strides[0]) )) + __pyx_t_13)) )) = (((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_12 * __pyx_v_self->fld->dy_du.strides[0]) )) + __pyx_t_11)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_10 * __pyx_v_self->fld->dy_dv.strides[0]) )) + __pyx_t_9)) ))))) * __pyx_v_invJ);
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":212
+  /* "libfds/fluxes.pyx":258
  *                     self.fld.Fe[ix, iy] = self.fld.rv[ix, iy] * pre
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  * 
  *         cdef Py_ssize_t ix, iy
  */
 
@@ -6611,15 +6614,15 @@
   __Pyx_AddTraceback("libfds.fluxes._EulerianFluxes2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":291
+/* "libfds/fluxes.pyx":350
  *     cdef EulerDerivative3d dr, dru, drv, drw, dre
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  *         """ msh,  """
  * 
  */
 
@@ -6648,32 +6651,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 291, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 350, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields3d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 291, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 350, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fluxes._EulerianFluxes3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 291, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 350, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_6fluxes_17_EulerianFluxes3d___cinit__(((struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -6693,56 +6696,56 @@
   PyObject *__pyx_t_7 = NULL;
   PyObject *__pyx_t_8 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fluxes.pyx":294
+  /* "libfds/fluxes.pyx":353
  *         """ msh,  """
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         if self.fld.mesh_type == 'cartesian':
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/fluxes.pyx":296
+  /* "libfds/fluxes.pyx":355
  *         self.fld = fld
  * 
  *         if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld.rw, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld.Ew, self.fld)
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 296, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 355, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":297
+    /* "libfds/fluxes.pyx":356
  * 
  *         if self.fld.mesh_type == 'cartesian':
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld.rw, self.fld)             # <<<<<<<<<<<<<<
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld.Ew, self.fld)
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Fw, self.fld)
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = PyTuple_New(6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_5);
@@ -6754,41 +6757,41 @@
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_8, 5, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 297, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 356, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GIVEREF(__pyx_t_7);
     __Pyx_GOTREF(__pyx_v_self->dr);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dr));
     __pyx_v_self->dr = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "libfds/fluxes.pyx":298
+    /* "libfds/fluxes.pyx":357
  *         if self.fld.mesh_type == 'cartesian':
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld.rw, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld.Ew, self.fld)             # <<<<<<<<<<<<<<
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Fw, self.fld)
  * 
  */
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ew, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ew, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyTuple_New(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_6);
@@ -6800,41 +6803,41 @@
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_3, 5, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
     __pyx_t_6 = 0;
     __pyx_t_5 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 357, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GIVEREF(__pyx_t_4);
     __Pyx_GOTREF(__pyx_v_self->dru);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dru));
     __pyx_v_self->dru = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "libfds/fluxes.pyx":299
+    /* "libfds/fluxes.pyx":358
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld.rw, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld.Ew, self.fld)
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Fw, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         elif self.fld.mesh_type == 'curvilinear':
  */
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = PyTuple_New(6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_7 = PyTuple_New(6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_5);
@@ -6846,62 +6849,62 @@
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_7, 5, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_4 = 0;
     __pyx_t_3 = 0;
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
     __pyx_t_8 = 0;
-    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 299, __pyx_L1_error)
+    __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 358, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
     __Pyx_GIVEREF(__pyx_t_8);
     __Pyx_GOTREF(__pyx_v_self->drv);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->drv));
     __pyx_v_self->drv = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_8);
     __pyx_t_8 = 0;
 
-    /* "libfds/fluxes.pyx":296
+    /* "libfds/fluxes.pyx":355
  *         self.fld = fld
  * 
  *         if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.ru, self.fld.rv, self.fld.rw, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Ev, self.fld.Ew, self.fld)
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":301
+  /* "libfds/fluxes.pyx":360
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Fw, self.fld)
  * 
  *         elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld.Gu, self.fld)
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 301, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 360, __pyx_L1_error)
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":302
+    /* "libfds/fluxes.pyx":361
  * 
  *         elif self.fld.mesh_type == 'curvilinear':
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld.G, self.fld)             # <<<<<<<<<<<<<<
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld.Gu, self.fld)
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Gv, self.fld)
  */
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->r, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->K, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = PyTuple_New(6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_4 = PyTuple_New(6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_6);
@@ -6913,41 +6916,41 @@
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_4, 5, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_8 = 0;
     __pyx_t_7 = 0;
     __pyx_t_6 = 0;
     __pyx_t_5 = 0;
     __pyx_t_3 = 0;
-    __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 361, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
     __Pyx_GIVEREF(__pyx_t_3);
     __Pyx_GOTREF(__pyx_v_self->dr);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dr));
     __pyx_v_self->dr = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_3);
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":303
+    /* "libfds/fluxes.pyx":362
  *         elif self.fld.mesh_type == 'curvilinear':
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld.Gu, self.fld)             # <<<<<<<<<<<<<<
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Gv, self.fld)
  * 
  */
-    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ku, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Eu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Gu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Gu, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = PyTuple_New(6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_8 = PyTuple_New(6); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_3);
     PyTuple_SET_ITEM(__pyx_t_8, 0, __pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_4);
     PyTuple_SET_ITEM(__pyx_t_8, 1, __pyx_t_4);
     __Pyx_GIVEREF(__pyx_t_5);
     PyTuple_SET_ITEM(__pyx_t_8, 2, __pyx_t_5);
@@ -6959,41 +6962,41 @@
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_8, 5, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_3 = 0;
     __pyx_t_4 = 0;
     __pyx_t_5 = 0;
     __pyx_t_6 = 0;
     __pyx_t_7 = 0;
-    __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 303, __pyx_L1_error)
+    __pyx_t_7 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_8, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 362, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
     __Pyx_DECREF(__pyx_t_8); __pyx_t_8 = 0;
     __Pyx_GIVEREF(__pyx_t_7);
     __Pyx_GOTREF(__pyx_v_self->dru);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->dru));
     __pyx_v_self->dru = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_7);
     __pyx_t_7 = 0;
 
-    /* "libfds/fluxes.pyx":304
+    /* "libfds/fluxes.pyx":363
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld.Gu, self.fld)
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Gv, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         self.drw = EulerDerivative3d(self.fld.rw, self.fld.Kw, self.fld.Ew, self.fld.Fw, self.fld.Gw, self.fld)
  */
-    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_7);
-    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_8);
-    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ev, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_6);
-    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_5);
-    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Gv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Gv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
-    __pyx_t_3 = PyTuple_New(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_3 = PyTuple_New(6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     __Pyx_GIVEREF(__pyx_t_7);
     PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_7);
     __Pyx_GIVEREF(__pyx_t_8);
     PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_8);
     __Pyx_GIVEREF(__pyx_t_6);
     PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_6);
@@ -7005,51 +7008,51 @@
     __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
     PyTuple_SET_ITEM(__pyx_t_3, 5, ((PyObject *)__pyx_v_self->fld));
     __pyx_t_7 = 0;
     __pyx_t_8 = 0;
     __pyx_t_6 = 0;
     __pyx_t_5 = 0;
     __pyx_t_4 = 0;
-    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 304, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 363, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_4);
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     __Pyx_GIVEREF(__pyx_t_4);
     __Pyx_GOTREF(__pyx_v_self->drv);
     __Pyx_DECREF(((PyObject *)__pyx_v_self->drv));
     __pyx_v_self->drv = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_4);
     __pyx_t_4 = 0;
 
-    /* "libfds/fluxes.pyx":301
+    /* "libfds/fluxes.pyx":360
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Fw, self.fld)
  * 
  *         elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.dr = EulerDerivative3d(self.fld.r, self.fld.K, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *             self.dru = EulerDerivative3d(self.fld.ru, self.fld.Ku, self.fld.Eu, self.fld.Fu, self.fld.Gu, self.fld)
  */
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":306
+  /* "libfds/fluxes.pyx":365
  *             self.drv = EulerDerivative3d(self.fld.rv, self.fld.Kv, self.fld.Ev, self.fld.Fv, self.fld.Gv, self.fld)
  * 
  *         self.drw = EulerDerivative3d(self.fld.rw, self.fld.Kw, self.fld.Ew, self.fld.Fw, self.fld.Gw, self.fld)             # <<<<<<<<<<<<<<
  *         self.dre = EulerDerivative3d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld.Ge, self.fld)
  * 
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Kw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ew, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ew, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Gw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Gw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_7 = PyTuple_New(6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_7 = PyTuple_New(6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_7, 2, __pyx_t_5);
@@ -7061,41 +7064,41 @@
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_7, 5, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
   __pyx_t_5 = 0;
   __pyx_t_6 = 0;
   __pyx_t_8 = 0;
-  __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 306, __pyx_L1_error)
+  __pyx_t_8 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_7, NULL); if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 365, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
   __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
   __Pyx_GIVEREF(__pyx_t_8);
   __Pyx_GOTREF(__pyx_v_self->drw);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->drw));
   __pyx_v_self->drw = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_8);
   __pyx_t_8 = 0;
 
-  /* "libfds/fluxes.pyx":307
+  /* "libfds/fluxes.pyx":366
  * 
  *         self.drw = EulerDerivative3d(self.fld.rw, self.fld.Kw, self.fld.Ew, self.fld.Fw, self.fld.Gw, self.fld)
  *         self.dre = EulerDerivative3d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld.Ge, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void rk4(self):
  */
-  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_8 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_8);
-  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_7 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ke, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_7);
-  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_6 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_6);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ge, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ge, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_8);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_8);
   __Pyx_GIVEREF(__pyx_t_7);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_7);
   __Pyx_GIVEREF(__pyx_t_6);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_6);
@@ -7107,24 +7110,24 @@
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 5, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_8 = 0;
   __pyx_t_7 = 0;
   __pyx_t_6 = 0;
   __pyx_t_5 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_EulerDerivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 366, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->dre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dre));
   __pyx_v_self->dre = ((struct __pyx_obj_6libfds_7libdiff_EulerDerivative3d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/fluxes.pyx":291
+  /* "libfds/fluxes.pyx":350
  *     cdef EulerDerivative3d dr, dru, drv, drw, dre
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  *         """ msh,  """
  * 
  */
 
@@ -7141,15 +7144,15 @@
   __Pyx_AddTraceback("libfds.fluxes._EulerianFluxes3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":309
+/* "libfds/fluxes.pyx":368
  *         self.dre = EulerDerivative3d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld.Ge, self.fld)
  * 
  *     cpdef void rk4(self):             # <<<<<<<<<<<<<<
  *         """
  *           Avancement de la solution en temps  l'aide d'un algortihme de
  */
 
@@ -7161,158 +7164,158 @@
   int __pyx_t_2;
   Py_ssize_t __pyx_t_3;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("rk4", 0);
 
-  /* "libfds/fluxes.pyx":319
+  /* "libfds/fluxes.pyx":378
  *         # Make copy of (r, ru, rv, rw, re) => (K, Ku, Kv, Kw, Ke)
  *         # or (r/J, ru/J, ...) in curvilinear rather than (r, ru, ...)
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.phys2num()
  * 
  */
-  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 319, __pyx_L1_error)
+  __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 378, __pyx_L1_error)
   __pyx_t_2 = (__pyx_t_1 != 0);
   if (__pyx_t_2) {
 
-    /* "libfds/fluxes.pyx":320
+    /* "libfds/fluxes.pyx":379
  *         # or (r/J, ru/J, ...) in curvilinear rather than (r, ru, ...)
  *         if self.fld.mesh_type == 'curvilinear':
  *             self.fld.phys2num()             # <<<<<<<<<<<<<<
  * 
  *         self.fld.update('K')
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->phys2num(__pyx_v_self->fld);
 
-    /* "libfds/fluxes.pyx":319
+    /* "libfds/fluxes.pyx":378
  *         # Make copy of (r, ru, rv, rw, re) => (K, Ku, Kv, Kw, Ke)
  *         # or (r/J, ru/J, ...) in curvilinear rather than (r, ru, ...)
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.phys2num()
  * 
  */
   }
 
-  /* "libfds/fluxes.pyx":322
+  /* "libfds/fluxes.pyx":381
  *             self.fld.phys2num()
  * 
  *         self.fld.update('K')             # <<<<<<<<<<<<<<
  * 
  *         # Get back to physical vars to calculate fluxes
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_K);
 
-  /* "libfds/fluxes.pyx":325
+  /* "libfds/fluxes.pyx":384
  * 
  *         # Get back to physical vars to calculate fluxes
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.num2phys()
  * 
  */
-  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 325, __pyx_L1_error)
+  __pyx_t_2 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 384, __pyx_L1_error)
   __pyx_t_1 = (__pyx_t_2 != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":326
+    /* "libfds/fluxes.pyx":385
  *         # Get back to physical vars to calculate fluxes
  *         if self.fld.mesh_type == 'curvilinear':
  *             self.fld.num2phys()             # <<<<<<<<<<<<<<
  * 
  *         for irk in range(1, 7):
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->num2phys(__pyx_v_self->fld);
 
-    /* "libfds/fluxes.pyx":325
+    /* "libfds/fluxes.pyx":384
  * 
  *         # Get back to physical vars to calculate fluxes
  *         if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *             self.fld.num2phys()
  * 
  */
   }
 
-  /* "libfds/fluxes.pyx":328
+  /* "libfds/fluxes.pyx":387
  *             self.fld.num2phys()
  * 
  *         for irk in range(1, 7):             # <<<<<<<<<<<<<<
  * 
  *             # Eulerian fluxes
  */
   for (__pyx_t_3 = 1; __pyx_t_3 < 7; __pyx_t_3+=1) {
     __pyx_v_irk = __pyx_t_3;
 
-    /* "libfds/fluxes.pyx":331
+    /* "libfds/fluxes.pyx":390
  * 
  *             # Eulerian fluxes
  *             self.fld.update_odudtrk(rk[irk])             # <<<<<<<<<<<<<<
  *             self.cin()
  * 
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update_odudtrk(__pyx_v_self->fld, (rk[__pyx_v_irk]));
 
-    /* "libfds/fluxes.pyx":332
+    /* "libfds/fluxes.pyx":391
  *             # Eulerian fluxes
  *             self.fld.update_odudtrk(rk[irk])
  *             self.cin()             # <<<<<<<<<<<<<<
  * 
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  */
     __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cin(__pyx_v_self);
 
-    /* "libfds/fluxes.pyx":335
+    /* "libfds/fluxes.pyx":394
  * 
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  *             if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self.fld.num2phys()
  * 
  */
-    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 335, __pyx_L1_error)
+    __pyx_t_1 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_1 < 0)) __PYX_ERR(0, 394, __pyx_L1_error)
     __pyx_t_2 = (__pyx_t_1 != 0);
     if (__pyx_t_2) {
 
-      /* "libfds/fluxes.pyx":336
+      /* "libfds/fluxes.pyx":395
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  *             if self.fld.mesh_type == 'curvilinear':
  *                 self.fld.num2phys()             # <<<<<<<<<<<<<<
  * 
  *             # Boundary conditions
  */
       ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->num2phys(__pyx_v_self->fld);
 
-      /* "libfds/fluxes.pyx":335
+      /* "libfds/fluxes.pyx":394
  * 
  *             # got (U/J) from cin() in curvilinear so get back to physical vars
  *             if self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self.fld.num2phys()
  * 
  */
     }
 
-    /* "libfds/fluxes.pyx":339
+    /* "libfds/fluxes.pyx":398
  * 
  *             # Boundary conditions
  *             self.cout()             # <<<<<<<<<<<<<<
  * 
  *             # Compute p
  */
     __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cout(__pyx_v_self, 0);
 
-    /* "libfds/fluxes.pyx":342
+    /* "libfds/fluxes.pyx":401
  * 
  *             # Compute p
  *             self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cpdef void cout(self):
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
   }
 
-  /* "libfds/fluxes.pyx":309
+  /* "libfds/fluxes.pyx":368
  *         self.dre = EulerDerivative3d(self.fld.re, self.fld.Ke, self.fld.Ee, self.fld.Fe, self.fld.Ge, self.fld)
  * 
  *     cpdef void rk4(self):             # <<<<<<<<<<<<<<
  *         """
  *           Avancement de la solution en temps  l'aide d'un algortihme de
  */
 
@@ -7343,15 +7346,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("rk4", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_rk4(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_rk4(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 368, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7360,15 +7363,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":344
+/* "libfds/fluxes.pyx":403
  *             self.fld.update('p')
  * 
  *     cpdef void cout(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Face3d face
  */
 
@@ -7381,62 +7384,62 @@
   PyObject *__pyx_t_3 = NULL;
   Py_ssize_t __pyx_t_4;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("cout", 0);
 
-  /* "libfds/fluxes.pyx":348
+  /* "libfds/fluxes.pyx":407
  *         cdef Face3d face
  * 
  *         for face in self.fld.bc:             # <<<<<<<<<<<<<<
  *             face.apply_bc(self.fld.cfg.it)
  * 
  */
   if (unlikely(__pyx_v_self->fld->bc == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 348, __pyx_L1_error)
+    __PYX_ERR(0, 407, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->bc; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 348, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 407, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 348, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Face3d))))) __PYX_ERR(0, 348, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Face3d))))) __PYX_ERR(0, 407, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_face, ((struct __pyx_obj_6libfds_6fields_Face3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":349
+    /* "libfds/fluxes.pyx":408
  * 
  *         for face in self.fld.bc:
  *             face.apply_bc(self.fld.cfg.it)             # <<<<<<<<<<<<<<
  * 
  *     cdef void cin(self):
  */
-    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->fld->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 349, __pyx_L1_error)
+    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_v_self->fld->cfg, __pyx_n_s_it); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
-    __pyx_t_4 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 349, __pyx_L1_error)
+    __pyx_t_4 = __Pyx_PyIndex_AsSsize_t(__pyx_t_3); if (unlikely((__pyx_t_4 == (Py_ssize_t)-1) && PyErr_Occurred())) __PYX_ERR(0, 408, __pyx_L1_error)
     __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
     ((struct __pyx_vtabstruct_6libfds_6fields_Face3d *)__pyx_v_face->__pyx_vtab)->apply_bc(__pyx_v_face, __pyx_t_4);
 
-    /* "libfds/fluxes.pyx":348
+    /* "libfds/fluxes.pyx":407
  *         cdef Face3d face
  * 
  *         for face in self.fld.bc:             # <<<<<<<<<<<<<<
  *             face.apply_bc(self.fld.cfg.it)
  * 
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":344
+  /* "libfds/fluxes.pyx":403
  *             self.fld.update('p')
  * 
  *     cpdef void cout(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Face3d face
  */
 
@@ -7469,15 +7472,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("cout", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cout(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cout(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -7486,122 +7489,122 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":351
+/* "libfds/fluxes.pyx":410
  *             face.apply_bc(self.fld.cfg.it)
  * 
  *     cdef void cin(self):             # <<<<<<<<<<<<<<
  *         """ Interior domain. """
  * 
  */
 
 static void __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cin(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *__pyx_v_self) {
   __Pyx_RefNannyDeclarations
   int __pyx_t_1;
   __Pyx_RefNannySetupContext("cin", 0);
 
-  /* "libfds/fluxes.pyx":355
+  /* "libfds/fluxes.pyx":414
  * 
  *         # update sources
  *         if self.fld.src:             # <<<<<<<<<<<<<<
  *             self.fld.update_sources()
  * 
  */
   __pyx_t_1 = (__pyx_v_self->fld->src != Py_None)&&(PyList_GET_SIZE(__pyx_v_self->fld->src) != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":356
+    /* "libfds/fluxes.pyx":415
  *         # update sources
  *         if self.fld.src:
  *             self.fld.update_sources()             # <<<<<<<<<<<<<<
  * 
  *         # Update E & F
  */
     ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update_sources(__pyx_v_self->fld);
 
-    /* "libfds/fluxes.pyx":355
+    /* "libfds/fluxes.pyx":414
  * 
  *         # update sources
  *         if self.fld.src:             # <<<<<<<<<<<<<<
  *             self.fld.update_sources()
  * 
  */
   }
 
-  /* "libfds/fluxes.pyx":359
+  /* "libfds/fluxes.pyx":418
  * 
  *         # Update E & F
  *         self.fluxes()             # <<<<<<<<<<<<<<
  * 
  *         # Derivate + integrate fluxes
  */
   __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_fluxes(__pyx_v_self);
 
-  /* "libfds/fluxes.pyx":362
+  /* "libfds/fluxes.pyx":421
  * 
  *         # Derivate + integrate fluxes
  *         self.dr.apply()             # <<<<<<<<<<<<<<
  *         self.dru.apply()
  *         self.drv.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative3d *)__pyx_v_self->dr->__pyx_vtab)->apply(__pyx_v_self->dr);
 
-  /* "libfds/fluxes.pyx":363
+  /* "libfds/fluxes.pyx":422
  *         # Derivate + integrate fluxes
  *         self.dr.apply()
  *         self.dru.apply()             # <<<<<<<<<<<<<<
  *         self.drv.apply()
  *         self.drw.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative3d *)__pyx_v_self->dru->__pyx_vtab)->apply(__pyx_v_self->dru);
 
-  /* "libfds/fluxes.pyx":364
+  /* "libfds/fluxes.pyx":423
  *         self.dr.apply()
  *         self.dru.apply()
  *         self.drv.apply()             # <<<<<<<<<<<<<<
  *         self.drw.apply()
  *         self.dre.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative3d *)__pyx_v_self->drv->__pyx_vtab)->apply(__pyx_v_self->drv);
 
-  /* "libfds/fluxes.pyx":365
+  /* "libfds/fluxes.pyx":424
  *         self.dru.apply()
  *         self.drv.apply()
  *         self.drw.apply()             # <<<<<<<<<<<<<<
  *         self.dre.apply()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative3d *)__pyx_v_self->drw->__pyx_vtab)->apply(__pyx_v_self->drw);
 
-  /* "libfds/fluxes.pyx":366
+  /* "libfds/fluxes.pyx":425
  *         self.drv.apply()
  *         self.drw.apply()
  *         self.dre.apply()             # <<<<<<<<<<<<<<
  * 
  *     cdef void fluxes(self):
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_EulerDerivative3d *)__pyx_v_self->dre->__pyx_vtab)->apply(__pyx_v_self->dre);
 
-  /* "libfds/fluxes.pyx":351
+  /* "libfds/fluxes.pyx":410
  *             face.apply_bc(self.fld.cfg.it)
  * 
  *     cdef void cin(self):             # <<<<<<<<<<<<<<
  *         """ Interior domain. """
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":368
+/* "libfds/fluxes.pyx":427
  *         self.dre.apply()
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -7614,109 +7617,109 @@
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fluxes", 0);
 
-  /* "libfds/fluxes.pyx":372
+  /* "libfds/fluxes.pyx":431
  *         cdef Domain3d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   if (unlikely(__pyx_v_self->fld->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 372, __pyx_L1_error)
+    __PYX_ERR(0, 431, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 431, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 372, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 431, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 372, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 431, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":373
+    /* "libfds/fluxes.pyx":432
  * 
  *         for sub in self.fld.cdomains:
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 373, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 432, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fluxes.pyx":374
+      /* "libfds/fluxes.pyx":433
  *         for sub in self.fld.cdomains:
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             elif self.fld.mesh_type == 'curvilinear':
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d__fluxes_crt(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":373
+      /* "libfds/fluxes.pyx":432
  * 
  *         for sub in self.fld.cdomains:
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':
  */
       goto __pyx_L5;
     }
 
-    /* "libfds/fluxes.pyx":375
+    /* "libfds/fluxes.pyx":434
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 375, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 434, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fluxes.pyx":376
+      /* "libfds/fluxes.pyx":435
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
       __pyx_f_6libfds_6fluxes_17_EulerianFluxes3d__fluxes_crv(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":375
+      /* "libfds/fluxes.pyx":434
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
     }
     __pyx_L5:;
 
-    /* "libfds/fluxes.pyx":372
+    /* "libfds/fluxes.pyx":431
  *         cdef Domain3d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":368
+  /* "libfds/fluxes.pyx":427
  *         self.dre.apply()
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -7727,15 +7730,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fluxes._EulerianFluxes3d.fluxes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":378
+/* "libfds/fluxes.pyx":437
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """  """
  * 
  */
 
@@ -7767,25 +7770,25 @@
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   Py_ssize_t __pyx_t_21;
   Py_ssize_t __pyx_t_22;
   Py_ssize_t __pyx_t_23;
   __Pyx_RefNannySetupContext("_fluxes_crt", 0);
 
-  /* "libfds/fluxes.pyx":385
+  /* "libfds/fluxes.pyx":444
  * 
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":386
+    /* "libfds/fluxes.pyx":445
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -7820,66 +7823,66 @@
                               __pyx_v_ix = (Py_ssize_t)(__pyx_t_2 + 1 * __pyx_t_4);
                               /* Initialize private variables to invalid values */
                               __pyx_v_invr = ((double)__PYX_NAN());
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_pre = ((double)__PYX_NAN());
 
-                              /* "libfds/fluxes.pyx":387
+                              /* "libfds/fluxes.pyx":446
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fluxes.pyx":388
+                                /* "libfds/fluxes.pyx":447
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  * 
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fluxes.pyx":390
+                                  /* "libfds/fluxes.pyx":449
  *                     for iz in range(izmin, izmax + 1):
  * 
  *                         invr = 1. / self.fld.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         pre = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  * 
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_v_invr = (1. / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_12 * __pyx_v_self->fld->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->r.strides[1]) )) + __pyx_t_14)) ))));
 
-                                  /* "libfds/fluxes.pyx":391
+                                  /* "libfds/fluxes.pyx":450
  * 
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         pre = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])             # <<<<<<<<<<<<<<
  * 
  *                         #self.fld.E[ix, iy, iz] = self.fld.ru[ix, iy, iz]
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_v_pre = (__pyx_v_invr * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_14 * __pyx_v_self->fld->re.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->re.strides[1]) )) + __pyx_t_12)) ))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_15 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_17)) )))));
 
-                                  /* "libfds/fluxes.pyx":394
+                                  /* "libfds/fluxes.pyx":453
  * 
  *                         #self.fld.E[ix, iy, iz] = self.fld.ru[ix, iy, iz]
  *                         self.fld.Eu[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  */
                                   __pyx_t_17 = __pyx_v_ix;
@@ -7892,15 +7895,15 @@
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_21 * __pyx_v_self->fld->Eu.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->Eu.strides[1]) )) + __pyx_t_23)) )) = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_17 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_15)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_14)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_18 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_20)) ))));
 
-                                  /* "libfds/fluxes.pyx":395
+                                  /* "libfds/fluxes.pyx":454
  *                         #self.fld.E[ix, iy, iz] = self.fld.ru[ix, iy, iz]
  *                         self.fld.Eu[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr             # <<<<<<<<<<<<<<
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Ee[ix, iy, iz] = self.fld.ru[ix, iy, iz] * pre
  */
                                   __pyx_t_20 = __pyx_v_ix;
@@ -7910,15 +7913,15 @@
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_15 * __pyx_v_self->fld->Ev.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ev.strides[1]) )) + __pyx_t_17)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_20 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_18)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_14 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_12)) )))) * __pyx_v_invr);
 
-                                  /* "libfds/fluxes.pyx":396
+                                  /* "libfds/fluxes.pyx":455
  *                         self.fld.Eu[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr             # <<<<<<<<<<<<<<
  *                         self.fld.Ee[ix, iy, iz] = self.fld.ru[ix, iy, iz] * pre
  * 
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -7928,30 +7931,30 @@
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ew.data + __pyx_t_17 * __pyx_v_self->fld->Ew.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ew.strides[1]) )) + __pyx_t_15)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_18 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_20)) )))) * __pyx_v_invr);
 
-                                  /* "libfds/fluxes.pyx":397
+                                  /* "libfds/fluxes.pyx":456
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Ee[ix, iy, iz] = self.fld.ru[ix, iy, iz] * pre             # <<<<<<<<<<<<<<
  * 
  *                         #self.fld.F[ix, iy, iz] = self.fld.rv[ix, iy, iz]
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_14 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_12)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_20 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_18)) ))) * __pyx_v_pre);
 
-                                  /* "libfds/fluxes.pyx":401
+                                  /* "libfds/fluxes.pyx":460
  *                         #self.fld.F[ix, iy, iz] = self.fld.rv[ix, iy, iz]
  *                         #self.fld.Fu[ix, iy, iz] = self.fld.Ev[ix, iy, iz]
  *                         self.fld.Fv[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.Fw[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Fe[ix, iy, iz] = self.fld.rv[ix, iy, iz] * pre
  */
                                   __pyx_t_18 = __pyx_v_ix;
@@ -7964,15 +7967,15 @@
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_23 * __pyx_v_self->fld->Fv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->Fv.strides[1]) )) + __pyx_t_21)) )) = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_18 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_20)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_14)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_15 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_17)) ))));
 
-                                  /* "libfds/fluxes.pyx":402
+                                  /* "libfds/fluxes.pyx":461
  *                         #self.fld.Fu[ix, iy, iz] = self.fld.Ev[ix, iy, iz]
  *                         self.fld.Fv[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Fw[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr             # <<<<<<<<<<<<<<
  *                         self.fld.Fe[ix, iy, iz] = self.fld.rv[ix, iy, iz] * pre
  * 
  */
                                   __pyx_t_17 = __pyx_v_ix;
@@ -7982,30 +7985,30 @@
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fw.data + __pyx_t_20 * __pyx_v_self->fld->Fw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->Fw.strides[1]) )) + __pyx_t_18)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_17 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_15)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) )))) * __pyx_v_invr);
 
-                                  /* "libfds/fluxes.pyx":403
+                                  /* "libfds/fluxes.pyx":462
  *                         self.fld.Fv[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Fw[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Fe[ix, iy, iz] = self.fld.rv[ix, iy, iz] * pre             # <<<<<<<<<<<<<<
  * 
  *                         #self.fld.G[ix, iy, iz] = self.fld.rw[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_15 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_17)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_14)) ))) * __pyx_v_pre);
 
-                                  /* "libfds/fluxes.pyx":408
+                                  /* "libfds/fluxes.pyx":467
  *                         #self.fld.Gu[ix, iy, iz] = self.fld.Ew[ix, iy, iz]
  *                         #self.fld.Gv[ix, iy, iz] = self.fld.Fw[ix, iy, iz]
  *                         self.fld.Gw[ix, iy, iz] = self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre
  *         else:
  */
                                   __pyx_t_14 = __pyx_v_ix;
@@ -8018,15 +8021,15 @@
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gw.data + __pyx_t_21 * __pyx_v_self->fld->Gw.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->Gw.strides[1]) )) + __pyx_t_23)) )) = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_17 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_15)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_18 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_20)) ))));
 
-                                  /* "libfds/fluxes.pyx":409
+                                  /* "libfds/fluxes.pyx":468
  *                         #self.fld.Gv[ix, iy, iz] = self.fld.Fw[ix, iy, iz]
  *                         self.fld.Gw[ix, iy, iz] = self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_20 = __pyx_v_ix;
@@ -8047,15 +8050,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fluxes.pyx":386
+        /* "libfds/fluxes.pyx":445
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -8066,89 +8069,89 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fluxes.pyx":385
+    /* "libfds/fluxes.pyx":444
  * 
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":411
+  /* "libfds/fluxes.pyx":470
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fluxes.pyx":412
+      /* "libfds/fluxes.pyx":471
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  * 
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fluxes.pyx":413
+        /* "libfds/fluxes.pyx":472
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  * 
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fluxes.pyx":415
+          /* "libfds/fluxes.pyx":474
  *                     for iz in range(izmin, izmax + 1):
  * 
  *                         invr = 1. / self.fld.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         pre = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  * 
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
           __pyx_v_invr = (1. / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_18 * __pyx_v_self->fld->r.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->r.strides[1]) )) + __pyx_t_20)) ))));
 
-          /* "libfds/fluxes.pyx":416
+          /* "libfds/fluxes.pyx":475
  * 
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         pre = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])             # <<<<<<<<<<<<<<
  * 
  *                         #self.fld.E[ix, iy, iz] = self.fld.ru[ix, iy, iz]
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           __pyx_v_pre = (__pyx_v_invr * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_20 * __pyx_v_self->fld->re.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->re.strides[1]) )) + __pyx_t_18)) ))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_17 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_15)) )))));
 
-          /* "libfds/fluxes.pyx":419
+          /* "libfds/fluxes.pyx":478
  * 
  *                         #self.fld.E[ix, iy, iz] = self.fld.ru[ix, iy, iz]
  *                         self.fld.Eu[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  */
           __pyx_t_15 = __pyx_v_ix;
@@ -8161,15 +8164,15 @@
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_23 * __pyx_v_self->fld->Eu.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->Eu.strides[1]) )) + __pyx_t_21)) )) = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_15 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_17)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_18 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_20)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_14)) ))));
 
-          /* "libfds/fluxes.pyx":420
+          /* "libfds/fluxes.pyx":479
  *                         #self.fld.E[ix, iy, iz] = self.fld.ru[ix, iy, iz]
  *                         self.fld.Eu[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr             # <<<<<<<<<<<<<<
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Ee[ix, iy, iz] = self.fld.ru[ix, iy, iz] * pre
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -8179,15 +8182,15 @@
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_17 * __pyx_v_self->fld->Ev.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ev.strides[1]) )) + __pyx_t_15)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_14 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_20 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_18)) )))) * __pyx_v_invr);
 
-          /* "libfds/fluxes.pyx":421
+          /* "libfds/fluxes.pyx":480
  *                         self.fld.Eu[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr             # <<<<<<<<<<<<<<
  *                         self.fld.Ee[ix, iy, iz] = self.fld.ru[ix, iy, iz] * pre
  * 
  */
           __pyx_t_18 = __pyx_v_ix;
@@ -8197,30 +8200,30 @@
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ew.data + __pyx_t_15 * __pyx_v_self->fld->Ew.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ew.strides[1]) )) + __pyx_t_17)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_18 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_20)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_12 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_14)) )))) * __pyx_v_invr);
 
-          /* "libfds/fluxes.pyx":422
+          /* "libfds/fluxes.pyx":481
  *                         self.fld.Ev[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr
  *                         self.fld.Ew[ix, iy, iz] = self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Ee[ix, iy, iz] = self.fld.ru[ix, iy, iz] * pre             # <<<<<<<<<<<<<<
  * 
  *                         #self.fld.F[ix, iy, iz] = self.fld.rv[ix, iy, iz]
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_20 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_18)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_14 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_12)) ))) * __pyx_v_pre);
 
-          /* "libfds/fluxes.pyx":426
+          /* "libfds/fluxes.pyx":485
  *                         #self.fld.F[ix, iy, iz] = self.fld.rv[ix, iy, iz]
  *                         #self.fld.Fu[ix, iy, iz] = self.fld.Ev[ix, iy, iz]
  *                         self.fld.Fv[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.Fw[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Fe[ix, iy, iz] = self.fld.rv[ix, iy, iz] * pre
  */
           __pyx_t_12 = __pyx_v_ix;
@@ -8233,15 +8236,15 @@
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_21 * __pyx_v_self->fld->Fv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->Fv.strides[1]) )) + __pyx_t_23)) )) = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_18 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_20)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_17 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_15)) ))));
 
-          /* "libfds/fluxes.pyx":427
+          /* "libfds/fluxes.pyx":486
  *                         #self.fld.Fu[ix, iy, iz] = self.fld.Ev[ix, iy, iz]
  *                         self.fld.Fv[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Fw[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr             # <<<<<<<<<<<<<<
  *                         self.fld.Fe[ix, iy, iz] = self.fld.rv[ix, iy, iz] * pre
  * 
  */
           __pyx_t_15 = __pyx_v_ix;
@@ -8251,30 +8254,30 @@
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fw.data + __pyx_t_14 * __pyx_v_self->fld->Fw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Fw.strides[1]) )) + __pyx_t_12)) )) = (((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_15 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_17)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_20 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_18)) )))) * __pyx_v_invr);
 
-          /* "libfds/fluxes.pyx":428
+          /* "libfds/fluxes.pyx":487
  *                         self.fld.Fv[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Fw[ix, iy, iz] = self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr
  *                         self.fld.Fe[ix, iy, iz] = self.fld.rv[ix, iy, iz] * pre             # <<<<<<<<<<<<<<
  * 
  *                         #self.fld.G[ix, iy, iz] = self.fld.rw[ix, iy, iz]
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_17 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_15)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_18 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_20)) ))) * __pyx_v_pre);
 
-          /* "libfds/fluxes.pyx":433
+          /* "libfds/fluxes.pyx":492
  *                         #self.fld.Gu[ix, iy, iz] = self.fld.Ew[ix, iy, iz]
  *                         #self.fld.Gv[ix, iy, iz] = self.fld.Fw[ix, iy, iz]
  *                         self.fld.Gw[ix, iy, iz] = self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre
  * 
  */
           __pyx_t_20 = __pyx_v_ix;
@@ -8287,15 +8290,15 @@
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gw.data + __pyx_t_23 * __pyx_v_self->fld->Gw.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->Gw.strides[1]) )) + __pyx_t_21)) )) = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_20 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_18)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_15 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_17)) )))) * __pyx_v_invr) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_14)) ))));
 
-          /* "libfds/fluxes.pyx":434
+          /* "libfds/fluxes.pyx":493
  *                         #self.fld.Gv[ix, iy, iz] = self.fld.Fw[ix, iy, iz]
  *                         self.fld.Gw[ix, iy, iz] = self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz] * invr + self.fld.p[ix, iy, iz]
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_14 = __pyx_v_ix;
@@ -8307,27 +8310,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_17 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_15)) )) = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) ))) * __pyx_v_pre);
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":378
+  /* "libfds/fluxes.pyx":437
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """  """
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":436
+/* "libfds/fluxes.pyx":495
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """  """
  * 
  */
 
@@ -8378,25 +8381,25 @@
   Py_ssize_t __pyx_t_28;
   Py_ssize_t __pyx_t_29;
   Py_ssize_t __pyx_t_30;
   Py_ssize_t __pyx_t_31;
   Py_ssize_t __pyx_t_32;
   __Pyx_RefNannySetupContext("_fluxes_crv", 0);
 
-  /* "libfds/fluxes.pyx":444
+  /* "libfds/fluxes.pyx":503
  *         cdef double ruv, ruw, rvw, ruu, rvv, rww
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":445
+    /* "libfds/fluxes.pyx":504
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -8441,921 +8444,921 @@
                               __pyx_v_ruw = ((double)__PYX_NAN());
                               __pyx_v_rv_p_plus_e = ((double)__PYX_NAN());
                               __pyx_v_rvv = ((double)__PYX_NAN());
                               __pyx_v_rvw = ((double)__PYX_NAN());
                               __pyx_v_rw_p_plus_e = ((double)__PYX_NAN());
                               __pyx_v_rww = ((double)__PYX_NAN());
 
-                              /* "libfds/fluxes.pyx":446
+                              /* "libfds/fluxes.pyx":505
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fluxes.pyx":447
+                                /* "libfds/fluxes.pyx":506
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  * 
  *                         invJ = 1. / self.fld.J[ix, iy, iz]
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fluxes.pyx":449
+                                  /* "libfds/fluxes.pyx":508
  *                     for iz in range(izmin, izmax + 1):
  * 
  *                         invJ = 1. / self.fld.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_v_invJ = (1. / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->J.data + __pyx_t_12 * __pyx_v_self->fld->J.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->J.strides[1]) )) + __pyx_t_14)) ))));
 
-                                  /* "libfds/fluxes.pyx":450
+                                  /* "libfds/fluxes.pyx":509
  * 
  *                         invJ = 1. / self.fld.J[ix, iy, iz]
  *                         invr = 1. / self.fld.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_v_invr = (1. / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_14 * __pyx_v_self->fld->r.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->r.strides[1]) )) + __pyx_t_12)) ))));
 
-                                  /* "libfds/fluxes.pyx":451
+                                  /* "libfds/fluxes.pyx":510
  *                         invJ = 1. / self.fld.J[ix, iy, iz]
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_v_ruv = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_12 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_14)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_15 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_17)) ))));
 
-                                  /* "libfds/fluxes.pyx":452
+                                  /* "libfds/fluxes.pyx":511
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  */
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_v_ruw = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_17 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_15)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) ))));
 
-                                  /* "libfds/fluxes.pyx":453
+                                  /* "libfds/fluxes.pyx":512
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_v_rvw = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_14)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_15 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_17)) ))));
 
-                                  /* "libfds/fluxes.pyx":454
+                                  /* "libfds/fluxes.pyx":513
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  */
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_v_ruu = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_17 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_15)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_14 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_12)) ))));
 
-                                  /* "libfds/fluxes.pyx":455
+                                  /* "libfds/fluxes.pyx":514
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_v_rvv = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_12 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_14)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_15 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_17)) ))));
 
-                                  /* "libfds/fluxes.pyx":456
+                                  /* "libfds/fluxes.pyx":515
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  */
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_v_rww = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_17 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_15)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) ))));
 
-                                  /* "libfds/fluxes.pyx":457
+                                  /* "libfds/fluxes.pyx":516
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])             # <<<<<<<<<<<<<<
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_v_p_plus_e = (__pyx_v_invr * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_12 * __pyx_v_self->fld->re.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->re.strides[1]) )) + __pyx_t_14)) ))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_15 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_17)) )))));
 
-                                  /* "libfds/fluxes.pyx":458
+                                  /* "libfds/fluxes.pyx":517
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e             # <<<<<<<<<<<<<<
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  */
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   __pyx_v_ru_p_plus_e = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_17 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_15)) ))) * __pyx_v_p_plus_e);
 
-                                  /* "libfds/fluxes.pyx":459
+                                  /* "libfds/fluxes.pyx":518
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e             # <<<<<<<<<<<<<<
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  * 
  */
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_v_rv_p_plus_e = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_15 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_17)) ))) * __pyx_v_p_plus_e);
 
-                                  /* "libfds/fluxes.pyx":460
+                                  /* "libfds/fluxes.pyx":519
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +
  */
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   __pyx_v_rw_p_plus_e = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_17 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_15)) ))) * __pyx_v_p_plus_e);
 
-                                  /* "libfds/fluxes.pyx":462
+                                  /* "libfds/fluxes.pyx":521
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":463
+                                  /* "libfds/fluxes.pyx":522
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":464
+                                  /* "libfds/fluxes.pyx":523
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":462
+                                  /* "libfds/fluxes.pyx":521
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_30 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_32 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_30 * __pyx_v_self->fld->E.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->E.strides[1]) )) + __pyx_t_32)) )) = (((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_15 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_17)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_14 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_12)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_18 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_20)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_21 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_23)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_24 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_26)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_27 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_29)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":466
+                                  /* "libfds/fluxes.pyx":525
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":467
+                                  /* "libfds/fluxes.pyx":526
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":468
+                                  /* "libfds/fluxes.pyx":527
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":466
+                                  /* "libfds/fluxes.pyx":525
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_32 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_30 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_32 * __pyx_v_self->fld->F.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->F.strides[1]) )) + __pyx_t_30)) )) = (((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_29 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_27)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_26 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_24)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_23 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_21)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_20 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_18)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_12 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_17 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":470
+                                  /* "libfds/fluxes.pyx":529
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":471
+                                  /* "libfds/fluxes.pyx":530
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":472
+                                  /* "libfds/fluxes.pyx":531
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":470
+                                  /* "libfds/fluxes.pyx":529
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_30 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_32 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->G.data + __pyx_t_30 * __pyx_v_self->fld->G.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->G.strides[1]) )) + __pyx_t_32)) )) = (((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_15 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_17)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_14 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_12)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_18 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_20)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_21 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_23)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_24 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_26)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_27 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_29)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":474
+                                  /* "libfds/fluxes.pyx":533
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":475
+                                  /* "libfds/fluxes.pyx":534
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":476
+                                  /* "libfds/fluxes.pyx":535
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":474
+                                  /* "libfds/fluxes.pyx":533
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_12 * __pyx_v_self->fld->Eu.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Eu.strides[1]) )) + __pyx_t_14)) )) = (((((__pyx_v_ruu + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_29 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_27)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_26 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_24)) )))) + (__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_23 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_21)) ))))) + (__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_20 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_18)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":478
+                                  /* "libfds/fluxes.pyx":537
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":479
+                                  /* "libfds/fluxes.pyx":538
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":480
+                                  /* "libfds/fluxes.pyx":539
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +
  */
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":478
+                                  /* "libfds/fluxes.pyx":537
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fu.data + __pyx_t_14 * __pyx_v_self->fld->Fu.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Fu.strides[1]) )) + __pyx_t_12)) )) = (((((__pyx_v_ruu + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_18 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_20)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_21 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_23)) )))) + (__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_24 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_26)) ))))) + (__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_27 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_29)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":482
+                                  /* "libfds/fluxes.pyx":541
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":483
+                                  /* "libfds/fluxes.pyx":542
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":484
+                                  /* "libfds/fluxes.pyx":543
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":482
+                                  /* "libfds/fluxes.pyx":541
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gu.data + __pyx_t_12 * __pyx_v_self->fld->Gu.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Gu.strides[1]) )) + __pyx_t_14)) )) = (((((__pyx_v_ruu + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_29 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_27)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_26 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_24)) )))) + (__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_23 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_21)) ))))) + (__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_20 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_18)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":486
+                                  /* "libfds/fluxes.pyx":545
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":487
+                                  /* "libfds/fluxes.pyx":546
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":488
+                                  /* "libfds/fluxes.pyx":547
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +
  */
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":486
+                                  /* "libfds/fluxes.pyx":545
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_14 * __pyx_v_self->fld->Ev.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ev.strides[1]) )) + __pyx_t_12)) )) = ((((__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_18 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_20)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_21 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_23)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_24 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_26)) ))))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_27 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_29)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":490
+                                  /* "libfds/fluxes.pyx":549
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":491
+                                  /* "libfds/fluxes.pyx":550
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":492
+                                  /* "libfds/fluxes.pyx":551
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":490
+                                  /* "libfds/fluxes.pyx":549
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_12 * __pyx_v_self->fld->Fv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Fv.strides[1]) )) + __pyx_t_14)) )) = ((((__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_29 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_27)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_26 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_24)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_23 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_21)) ))))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_20 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_18)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":494
+                                  /* "libfds/fluxes.pyx":553
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":495
+                                  /* "libfds/fluxes.pyx":554
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":496
+                                  /* "libfds/fluxes.pyx":555
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +
  */
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":494
+                                  /* "libfds/fluxes.pyx":553
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gv.data + __pyx_t_14 * __pyx_v_self->fld->Gv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Gv.strides[1]) )) + __pyx_t_12)) )) = ((((__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_18 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_20)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_21 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_23)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_24 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_26)) ))))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_27 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_29)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":498
+                                  /* "libfds/fluxes.pyx":557
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":499
+                                  /* "libfds/fluxes.pyx":558
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":500
+                                  /* "libfds/fluxes.pyx":559
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +
  */
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":498
+                                  /* "libfds/fluxes.pyx":557
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ew.data + __pyx_t_12 * __pyx_v_self->fld->Ew.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ew.strides[1]) )) + __pyx_t_14)) )) = ((((__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_29 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_27)) )))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_26 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_24)) ))))) + ((__pyx_v_rww + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_23 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_21)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_20 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_18)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":502
+                                  /* "libfds/fluxes.pyx":561
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":503
+                                  /* "libfds/fluxes.pyx":562
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":504
+                                  /* "libfds/fluxes.pyx":563
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":502
+                                  /* "libfds/fluxes.pyx":561
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fw.data + __pyx_t_14 * __pyx_v_self->fld->Fw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Fw.strides[1]) )) + __pyx_t_12)) )) = ((((__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_18 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_20)) )))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_21 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_23)) ))))) + ((__pyx_v_rww + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_24 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_26)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_27 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_29)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":506
+                                  /* "libfds/fluxes.pyx":565
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":507
+                                  /* "libfds/fluxes.pyx":566
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":508
+                                  /* "libfds/fluxes.pyx":567
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +
  */
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":506
+                                  /* "libfds/fluxes.pyx":565
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gw.data + __pyx_t_12 * __pyx_v_self->fld->Gw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Gw.strides[1]) )) + __pyx_t_14)) )) = ((((__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_29 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_27)) )))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_26 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_24)) ))))) + ((__pyx_v_rww + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_23 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_21)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_20 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_18)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":510
+                                  /* "libfds/fluxes.pyx":569
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":511
+                                  /* "libfds/fluxes.pyx":570
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":512
+                                  /* "libfds/fluxes.pyx":571
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":510
+                                  /* "libfds/fluxes.pyx":569
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_27 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_29)) )) = ((((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_18 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_20)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_21 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_23)) ))))) + (__pyx_v_rw_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_24 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_26)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":514
+                                  /* "libfds/fluxes.pyx":573
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":515
+                                  /* "libfds/fluxes.pyx":574
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":516
+                                  /* "libfds/fluxes.pyx":575
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":514
+                                  /* "libfds/fluxes.pyx":573
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_29 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_27)) )) = ((((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_26 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_24)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_23 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_21)) ))))) + (__pyx_v_rw_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_20 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_18)) ))))) * __pyx_v_invJ);
 
-                                  /* "libfds/fluxes.pyx":518
+                                  /* "libfds/fluxes.pyx":577
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":519
+                                  /* "libfds/fluxes.pyx":578
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":520
+                                  /* "libfds/fluxes.pyx":579
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *         else:
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":518
+                                  /* "libfds/fluxes.pyx":577
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
                                   __pyx_t_27 = __pyx_v_ix;
@@ -9373,15 +9376,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fluxes.pyx":445
+        /* "libfds/fluxes.pyx":504
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -9392,944 +9395,944 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fluxes.pyx":444
+    /* "libfds/fluxes.pyx":503
  *         cdef double ruv, ruw, rvw, ruu, rvv, rww
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":523
+  /* "libfds/fluxes.pyx":582
  * 
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fluxes.pyx":524
+      /* "libfds/fluxes.pyx":583
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  * 
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fluxes.pyx":525
+        /* "libfds/fluxes.pyx":584
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  * 
  *                         invJ = 1. / self.fld.J[ix, iy, iz]
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fluxes.pyx":527
+          /* "libfds/fluxes.pyx":586
  *                     for iz in range(izmin, izmax + 1):
  * 
  *                         invJ = 1. / self.fld.J[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_v_invJ = (1. / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->J.data + __pyx_t_26 * __pyx_v_self->fld->J.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->J.strides[1]) )) + __pyx_t_24)) ))));
 
-          /* "libfds/fluxes.pyx":528
+          /* "libfds/fluxes.pyx":587
  * 
  *                         invJ = 1. / self.fld.J[ix, iy, iz]
  *                         invr = 1. / self.fld.r[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_v_invr = (1. / (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->r.data + __pyx_t_24 * __pyx_v_self->fld->r.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->r.strides[1]) )) + __pyx_t_26)) ))));
 
-          /* "libfds/fluxes.pyx":529
+          /* "libfds/fluxes.pyx":588
  *                         invJ = 1. / self.fld.J[ix, iy, iz]
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_v_ruv = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_26 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_24)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_23 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_21)) ))));
 
-          /* "libfds/fluxes.pyx":530
+          /* "libfds/fluxes.pyx":589
  *                         invr = 1. / self.fld.r[ix, iy, iz]
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  */
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_v_ruw = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_21 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_23)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_24 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_26)) ))));
 
-          /* "libfds/fluxes.pyx":531
+          /* "libfds/fluxes.pyx":590
  *                         ruv = invr * self.fld.ru[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_v_rvw = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_26 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_24)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_23 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_21)) ))));
 
-          /* "libfds/fluxes.pyx":532
+          /* "libfds/fluxes.pyx":591
  *                         ruw = invr * self.fld.ru[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  */
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_v_ruu = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_21 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_23)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_24 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_26)) ))));
 
-          /* "libfds/fluxes.pyx":533
+          /* "libfds/fluxes.pyx":592
  *                         rvw = invr * self.fld.rv[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_v_rvv = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_26 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_24)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_23 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_21)) ))));
 
-          /* "libfds/fluxes.pyx":534
+          /* "libfds/fluxes.pyx":593
  *                         ruu = invr * self.fld.ru[ix, iy, iz] * self.fld.ru[ix, iy, iz]
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  */
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_v_rww = ((__pyx_v_invr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_21 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_23)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_24 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_26)) ))));
 
-          /* "libfds/fluxes.pyx":535
+          /* "libfds/fluxes.pyx":594
  *                         rvv = invr * self.fld.rv[ix, iy, iz] * self.fld.rv[ix, iy, iz]
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])             # <<<<<<<<<<<<<<
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_v_p_plus_e = (__pyx_v_invr * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->re.data + __pyx_t_26 * __pyx_v_self->fld->re.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->re.strides[1]) )) + __pyx_t_24)) ))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_23 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_21)) )))));
 
-          /* "libfds/fluxes.pyx":536
+          /* "libfds/fluxes.pyx":595
  *                         rww = invr * self.fld.rw[ix, iy, iz] * self.fld.rw[ix, iy, iz]
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e             # <<<<<<<<<<<<<<
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  */
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
           __pyx_v_ru_p_plus_e = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_21 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_23)) ))) * __pyx_v_p_plus_e);
 
-          /* "libfds/fluxes.pyx":537
+          /* "libfds/fluxes.pyx":596
  *                         p_plus_e = invr * (self.fld.re[ix, iy, iz] + self.fld.p[ix, iy, iz])
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e             # <<<<<<<<<<<<<<
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  * 
  */
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_v_rv_p_plus_e = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_23 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_21)) ))) * __pyx_v_p_plus_e);
 
-          /* "libfds/fluxes.pyx":538
+          /* "libfds/fluxes.pyx":597
  *                         ru_p_plus_e = self.fld.ru[ix, iy, iz] * p_plus_e
  *                         rv_p_plus_e = self.fld.rv[ix, iy, iz] * p_plus_e
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +
  */
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
           __pyx_v_rw_p_plus_e = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_21 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_23)) ))) * __pyx_v_p_plus_e);
 
-          /* "libfds/fluxes.pyx":540
+          /* "libfds/fluxes.pyx":599
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":541
+          /* "libfds/fluxes.pyx":600
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":542
+          /* "libfds/fluxes.pyx":601
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":540
+          /* "libfds/fluxes.pyx":599
  *                         rw_p_plus_e = self.fld.rw[ix, iy, iz] * p_plus_e
  * 
  *                         self.fld.E[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dx_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_32 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_30 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_32 * __pyx_v_self->fld->E.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->E.strides[1]) )) + __pyx_t_30)) )) = (((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_23 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_21)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_24 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_26)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_20 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_18)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_29 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_27)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_17 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":544
+          /* "libfds/fluxes.pyx":603
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":545
+          /* "libfds/fluxes.pyx":604
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":546
+          /* "libfds/fluxes.pyx":605
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":544
+          /* "libfds/fluxes.pyx":603
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.F[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dy_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_30 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_32 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_30 * __pyx_v_self->fld->F.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->F.strides[1]) )) + __pyx_t_32)) )) = (((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_15 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_17)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_12 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_14)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_27 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_29)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_18 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_20)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_26 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_24)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_21 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_23)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":548
+          /* "libfds/fluxes.pyx":607
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":549
+          /* "libfds/fluxes.pyx":608
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":550
+          /* "libfds/fluxes.pyx":609
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":548
+          /* "libfds/fluxes.pyx":607
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.G[ix, iy, iz] = (self.fld.ru[ix, iy, iz] * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                   self.fld.rv[ix, iy, iz] * self.fld.dz_dv[ix, iy, iz] +
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_32 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_30 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->G.data + __pyx_t_32 * __pyx_v_self->fld->G.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->G.strides[1]) )) + __pyx_t_30)) )) = (((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->ru.data + __pyx_t_23 * __pyx_v_self->fld->ru.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->ru.strides[1]) )) + __pyx_t_21)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_24 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_26)) )))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rv.data + __pyx_t_20 * __pyx_v_self->fld->rv.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->rv.strides[1]) )) + __pyx_t_18)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_29 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_27)) ))))) + ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->rw.data + __pyx_t_14 * __pyx_v_self->fld->rw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->rw.strides[1]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_17 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":552
+          /* "libfds/fluxes.pyx":611
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":553
+          /* "libfds/fluxes.pyx":612
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":554
+          /* "libfds/fluxes.pyx":613
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":552
+          /* "libfds/fluxes.pyx":611
  *                                                   self.fld.rw[ix, iy, iz] * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Eu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dx_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Eu.data + __pyx_t_26 * __pyx_v_self->fld->Eu.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Eu.strides[1]) )) + __pyx_t_24)) )) = (((((__pyx_v_ruu + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_15 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_17)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_12 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_14)) )))) + (__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_27 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_29)) ))))) + (__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_18 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_20)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":556
+          /* "libfds/fluxes.pyx":615
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":557
+          /* "libfds/fluxes.pyx":616
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":558
+          /* "libfds/fluxes.pyx":617
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +
  */
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":556
+          /* "libfds/fluxes.pyx":615
  *                                                    ruw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dy_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fu.data + __pyx_t_24 * __pyx_v_self->fld->Fu.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Fu.strides[1]) )) + __pyx_t_26)) )) = (((((__pyx_v_ruu + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_20 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_18)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_29 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_27)) )))) + (__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_14 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_12)) ))))) + (__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_17 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":560
+          /* "libfds/fluxes.pyx":619
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":561
+          /* "libfds/fluxes.pyx":620
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":562
+          /* "libfds/fluxes.pyx":621
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":560
+          /* "libfds/fluxes.pyx":619
  *                                                    ruw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gu[ix, iy, iz] = ((ruu + self.fld.p[ix, iy, iz]) * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    ruv * self.fld.dz_dv[ix, iy, iz] +
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gu.data + __pyx_t_26 * __pyx_v_self->fld->Gu.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Gu.strides[1]) )) + __pyx_t_24)) )) = (((((__pyx_v_ruu + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_15 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_17)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_12 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_14)) )))) + (__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_27 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_29)) ))))) + (__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_18 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_20)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":564
+          /* "libfds/fluxes.pyx":623
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":565
+          /* "libfds/fluxes.pyx":624
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":566
+          /* "libfds/fluxes.pyx":625
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +
  */
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":564
+          /* "libfds/fluxes.pyx":623
  *                                                    ruw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ev[ix, iy, iz] = (ruv * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ev.data + __pyx_t_24 * __pyx_v_self->fld->Ev.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Ev.strides[1]) )) + __pyx_t_26)) )) = ((((__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_20 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_18)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_29 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_27)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_14 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_12)) ))))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_17 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":568
+          /* "libfds/fluxes.pyx":627
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":569
+          /* "libfds/fluxes.pyx":628
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":570
+          /* "libfds/fluxes.pyx":629
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":568
+          /* "libfds/fluxes.pyx":627
  *                                                    rvw * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fv[ix, iy, iz] = (ruv * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fv.data + __pyx_t_26 * __pyx_v_self->fld->Fv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Fv.strides[1]) )) + __pyx_t_24)) )) = ((((__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_15 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_17)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_12 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_14)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_27 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_29)) ))))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_18 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_20)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":572
+          /* "libfds/fluxes.pyx":631
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":573
+          /* "libfds/fluxes.pyx":632
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":574
+          /* "libfds/fluxes.pyx":633
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +
  */
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":572
+          /* "libfds/fluxes.pyx":631
  *                                                    rvw * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gv[ix, iy, iz] = (ruv * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rvv + self.fld.p[ix, iy, iz]) * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gv.data + __pyx_t_24 * __pyx_v_self->fld->Gv.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Gv.strides[1]) )) + __pyx_t_26)) )) = ((((__pyx_v_ruv * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_20 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_18)) )))) + ((__pyx_v_rvv + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_29 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_27)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_14 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_12)) ))))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_17 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":576
+          /* "libfds/fluxes.pyx":635
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":577
+          /* "libfds/fluxes.pyx":636
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":578
+          /* "libfds/fluxes.pyx":637
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +
  */
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":576
+          /* "libfds/fluxes.pyx":635
  *                                                    rvw * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ew[ix, iy, iz] = (ruw * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dx_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ew.data + __pyx_t_26 * __pyx_v_self->fld->Ew.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Ew.strides[1]) )) + __pyx_t_24)) )) = ((((__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_15 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_17)) )))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_12 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_14)) ))))) + ((__pyx_v_rww + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_27 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_29)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_18 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_20)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":580
+          /* "libfds/fluxes.pyx":639
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":581
+          /* "libfds/fluxes.pyx":640
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":582
+          /* "libfds/fluxes.pyx":641
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":580
+          /* "libfds/fluxes.pyx":639
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fw[ix, iy, iz] = (ruw * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dy_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fw.data + __pyx_t_24 * __pyx_v_self->fld->Fw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Fw.strides[1]) )) + __pyx_t_26)) )) = ((((__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_20 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_18)) )))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_29 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_27)) ))))) + ((__pyx_v_rww + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_14 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_12)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_17 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_15)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":584
+          /* "libfds/fluxes.pyx":643
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":585
+          /* "libfds/fluxes.pyx":644
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":586
+          /* "libfds/fluxes.pyx":645
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +
  */
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":584
+          /* "libfds/fluxes.pyx":643
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Gw[ix, iy, iz] = (ruw * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rvw * self.fld.dz_dv[ix, iy, iz] +
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Gw.data + __pyx_t_26 * __pyx_v_self->fld->Gw.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Gw.strides[1]) )) + __pyx_t_24)) )) = ((((__pyx_v_ruw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_15 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_17)) )))) + (__pyx_v_rvw * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_12 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_14)) ))))) + ((__pyx_v_rww + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->p.data + __pyx_t_27 * __pyx_v_self->fld->p.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->p.strides[1]) )) + __pyx_t_29)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_18 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_20)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":588
+          /* "libfds/fluxes.pyx":647
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":589
+          /* "libfds/fluxes.pyx":648
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":590
+          /* "libfds/fluxes.pyx":649
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":588
+          /* "libfds/fluxes.pyx":647
  *                                                    (rww + self.fld.p[ix, iy, iz]) * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ee[ix, iy, iz] = (ru_p_plus_e * self.fld.dx_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dx_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_17 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_15)) )) = ((((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_du.data + __pyx_t_20 * __pyx_v_self->fld->dx_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dx_du.strides[1]) )) + __pyx_t_18)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dv.data + __pyx_t_29 * __pyx_v_self->fld->dx_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dx_dv.strides[1]) )) + __pyx_t_27)) ))))) + (__pyx_v_rw_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dx_dw.data + __pyx_t_14 * __pyx_v_self->fld->dx_dw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dx_dw.strides[1]) )) + __pyx_t_12)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":592
+          /* "libfds/fluxes.pyx":651
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":593
+          /* "libfds/fluxes.pyx":652
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":594
+          /* "libfds/fluxes.pyx":653
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":592
+          /* "libfds/fluxes.pyx":651
  *                                                    rw_p_plus_e * self.fld.dx_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Fe[ix, iy, iz] = (ru_p_plus_e * self.fld.dy_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dy_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_15 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_17)) )) = ((((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_du.data + __pyx_t_12 * __pyx_v_self->fld->dy_du.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dy_du.strides[1]) )) + __pyx_t_14)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dv.data + __pyx_t_27 * __pyx_v_self->fld->dy_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dy_dv.strides[1]) )) + __pyx_t_29)) ))))) + (__pyx_v_rw_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dy_dw.data + __pyx_t_18 * __pyx_v_self->fld->dy_dw.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dy_dw.strides[1]) )) + __pyx_t_20)) ))))) * __pyx_v_invJ);
 
-          /* "libfds/fluxes.pyx":596
+          /* "libfds/fluxes.pyx":655
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":597
+          /* "libfds/fluxes.pyx":656
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ
  * 
  */
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":598
+          /* "libfds/fluxes.pyx":657
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ             # <<<<<<<<<<<<<<
  * 
  * 
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":596
+          /* "libfds/fluxes.pyx":655
  *                                                    rw_p_plus_e * self.fld.dy_dw[ix, iy, iz]) * invJ
  * 
  *                         self.fld.Ge[ix, iy, iz] = (ru_p_plus_e * self.fld.dz_du[ix, iy, iz] +             # <<<<<<<<<<<<<<
  *                                                    rv_p_plus_e * self.fld.dz_dv[ix, iy, iz] +
  *                                                    rw_p_plus_e * self.fld.dz_dw[ix, iy, iz]) * invJ
  */
           __pyx_t_17 = __pyx_v_ix;
@@ -10338,15 +10341,15 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_17 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_15)) )) = ((((__pyx_v_ru_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_du.data + __pyx_t_20 * __pyx_v_self->fld->dz_du.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->dz_du.strides[1]) )) + __pyx_t_18)) )))) + (__pyx_v_rv_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dv.data + __pyx_t_29 * __pyx_v_self->fld->dz_dv.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->dz_dv.strides[1]) )) + __pyx_t_27)) ))))) + (__pyx_v_rw_p_plus_e * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->dz_dw.data + __pyx_t_14 * __pyx_v_self->fld->dz_dw.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->dz_dw.strides[1]) )) + __pyx_t_12)) ))))) * __pyx_v_invJ);
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":436
+  /* "libfds/fluxes.pyx":495
  *                         self.fld.Ge[ix, iy, iz] = self.fld.rw[ix, iy, iz] * pre
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """  """
  * 
  */
 
@@ -10463,15 +10466,15 @@
   __Pyx_AddTraceback("libfds.fluxes._EulerianFluxes3d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":612
+/* "libfds/fluxes.pyx":680
  *     cdef ViscousDerivative2d dru, drv, dre
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -10500,32 +10503,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 612, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 680, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields2d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 612, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 680, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fluxes._ViscousFluxes2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 612, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields2d, 1, "fld", 0))) __PYX_ERR(0, 680, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_6fluxes_16_ViscousFluxes2d___cinit__(((struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -10541,244 +10544,244 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fluxes.pyx":614
+  /* "libfds/fluxes.pyx":682
  *     def __cinit__(self, Fields2d fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         self.dTk = Derivative2d(self.fld.Tk, self.fld.E, self.fld.F, self.fld)
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/fluxes.pyx":616
+  /* "libfds/fluxes.pyx":684
  *         self.fld = fld
  * 
  *         self.dTk = Derivative2d(self.fld.Tk, self.fld.E, self.fld.F, self.fld)             # <<<<<<<<<<<<<<
  *         self.dS11 = Derivative2d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld)
  *         self.dS22 = Derivative2d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Tk, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 616, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->dTk);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dTk));
   __pyx_v_self->dTk = ((struct __pyx_obj_6libfds_7libdiff_Derivative2d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/fluxes.pyx":617
+  /* "libfds/fluxes.pyx":685
  * 
  *         self.dTk = Derivative2d(self.fld.Tk, self.fld.E, self.fld.F, self.fld)
  *         self.dS11 = Derivative2d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld)             # <<<<<<<<<<<<<<
  *         self.dS22 = Derivative2d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld)
  * 
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 617, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 685, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->dS11);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dS11));
   __pyx_v_self->dS11 = ((struct __pyx_obj_6libfds_7libdiff_Derivative2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/fluxes.pyx":618
+  /* "libfds/fluxes.pyx":686
  *         self.dTk = Derivative2d(self.fld.Tk, self.fld.E, self.fld.F, self.fld)
  *         self.dS11 = Derivative2d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld)
  *         self.dS22 = Derivative2d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         self.dru = ViscousDerivative2d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld)
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 686, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_3 = PyTuple_New(4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_t_4);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_3, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_1 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 618, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->dS22);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dS22));
   __pyx_v_self->dS22 = ((struct __pyx_obj_6libfds_7libdiff_Derivative2d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/fluxes.pyx":620
+  /* "libfds/fluxes.pyx":688
  *         self.dS22 = Derivative2d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld)
  * 
  *         self.dru = ViscousDerivative2d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld)             # <<<<<<<<<<<<<<
  *         self.drv = ViscousDerivative2d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld)
  *         self.dre = ViscousDerivative2d(self.fld.re, self.fld.E, self.fld.F, self.fld)
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_1);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_2, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative2d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 620, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative2d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->dru);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dru));
   __pyx_v_self->dru = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative2d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":621
+  /* "libfds/fluxes.pyx":689
  * 
  *         self.dru = ViscousDerivative2d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld)
  *         self.drv = ViscousDerivative2d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld)             # <<<<<<<<<<<<<<
  *         self.dre = ViscousDerivative2d(self.fld.re, self.fld.E, self.fld.F, self.fld)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->drv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->drv));
   __pyx_v_self->drv = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative2d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/fluxes.pyx":622
+  /* "libfds/fluxes.pyx":690
  *         self.dru = ViscousDerivative2d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld)
  *         self.drv = ViscousDerivative2d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld)
  *         self.dre = ViscousDerivative2d(self.fld.re, self.fld.E, self.fld.F, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void integrate(self):
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 690, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 690, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 622, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 690, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->dre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dre));
   __pyx_v_self->dre = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/fluxes.pyx":612
+  /* "libfds/fluxes.pyx":680
  *     cdef ViscousDerivative2d dru, drv, dre
  * 
  *     def __cinit__(self, Fields2d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -10793,121 +10796,121 @@
   __Pyx_AddTraceback("libfds.fluxes._ViscousFluxes2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":624
+/* "libfds/fluxes.pyx":692
  *         self.dre = ViscousDerivative2d(self.fld.re, self.fld.E, self.fld.F, self.fld)
  * 
  *     cpdef void integrate(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate u and v and assign to Ee and Fe
  */
 
 static PyObject *__pyx_pw_6libfds_6fluxes_16_ViscousFluxes2d_3integrate(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static void __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_integrate(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *__pyx_v_self, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __Pyx_RefNannyDeclarations
   struct __pyx_opt_args_6libfds_7libdiff_12Derivative2d_apply __pyx_t_1;
   __Pyx_RefNannySetupContext("integrate", 0);
 
-  /* "libfds/fluxes.pyx":627
+  /* "libfds/fluxes.pyx":695
  * 
  *         # Calculate u and v and assign to Ee and Fe
  *         self.fld.update('V')             # <<<<<<<<<<<<<<
  * 
  *         # Strain tensor
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_V);
 
-  /* "libfds/fluxes.pyx":632
+  /* "libfds/fluxes.pyx":700
  *         # S11 = dEe/dx  ||  S12 = dEe/dy
  *         # S12 += dFe/dx ||  S22 = dFe/dy
  *         self.dS11.apply()             # <<<<<<<<<<<<<<
  *         self.dS22.apply(add_x=True)
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative2d *)__pyx_v_self->dS11->__pyx_vtab)->apply(__pyx_v_self->dS11, 0, NULL);
 
-  /* "libfds/fluxes.pyx":633
+  /* "libfds/fluxes.pyx":701
  *         # S12 += dFe/dx ||  S22 = dFe/dy
  *         self.dS11.apply()
  *         self.dS22.apply(add_x=True)             # <<<<<<<<<<<<<<
  * 
  *         # Temperature gradient (dTk/dx, dTk/dy) => (E, F)
  */
   __pyx_t_1.__pyx_n = 1;
   __pyx_t_1.add_x = 1;
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative2d *)__pyx_v_self->dS22->__pyx_vtab)->apply(__pyx_v_self->dS22, 0, &__pyx_t_1); 
 
-  /* "libfds/fluxes.pyx":636
+  /* "libfds/fluxes.pyx":704
  * 
  *         # Temperature gradient (dTk/dx, dTk/dy) => (E, F)
  *         self.fld.update('Tk')             # <<<<<<<<<<<<<<
  *         self.dTk.apply()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_Tk);
 
-  /* "libfds/fluxes.pyx":637
+  /* "libfds/fluxes.pyx":705
  *         # Temperature gradient (dTk/dx, dTk/dy) => (E, F)
  *         self.fld.update('Tk')
  *         self.dTk.apply()             # <<<<<<<<<<<<<<
  * 
  *         # Viscous fluxes
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative2d *)__pyx_v_self->dTk->__pyx_vtab)->apply(__pyx_v_self->dTk, 0, NULL);
 
-  /* "libfds/fluxes.pyx":640
+  /* "libfds/fluxes.pyx":708
  * 
  *         # Viscous fluxes
  *         self.fluxes()             # <<<<<<<<<<<<<<
  * 
  *         # Viscous fluxes derivation then integration
  */
   __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_fluxes(__pyx_v_self);
 
-  /* "libfds/fluxes.pyx":643
+  /* "libfds/fluxes.pyx":711
  * 
  *         # Viscous fluxes derivation then integration
  *         self.dru.apply()             # <<<<<<<<<<<<<<
  *         self.drv.apply()
  *         self.dre.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative2d *)__pyx_v_self->dru->__pyx_vtab)->apply(__pyx_v_self->dru);
 
-  /* "libfds/fluxes.pyx":644
+  /* "libfds/fluxes.pyx":712
  *         # Viscous fluxes derivation then integration
  *         self.dru.apply()
  *         self.drv.apply()             # <<<<<<<<<<<<<<
  *         self.dre.apply()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative2d *)__pyx_v_self->drv->__pyx_vtab)->apply(__pyx_v_self->drv);
 
-  /* "libfds/fluxes.pyx":645
+  /* "libfds/fluxes.pyx":713
  *         self.dru.apply()
  *         self.drv.apply()
  *         self.dre.apply()             # <<<<<<<<<<<<<<
  * 
  *         # Update p
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative2d *)__pyx_v_self->dre->__pyx_vtab)->apply(__pyx_v_self->dre);
 
-  /* "libfds/fluxes.pyx":648
+  /* "libfds/fluxes.pyx":716
  * 
  *         # Update p
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cdef void fluxes(self):
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/fluxes.pyx":624
+  /* "libfds/fluxes.pyx":692
  *         self.dre = ViscousDerivative2d(self.fld.re, self.fld.E, self.fld.F, self.fld)
  * 
  *     cpdef void integrate(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate u and v and assign to Ee and Fe
  */
 
@@ -10933,15 +10936,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("integrate", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_integrate(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 624, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_integrate(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -10950,15 +10953,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":650
+/* "libfds/fluxes.pyx":718
  *         self.fld.update('p')
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -10971,109 +10974,109 @@
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fluxes", 0);
 
-  /* "libfds/fluxes.pyx":654
+  /* "libfds/fluxes.pyx":722
  *         cdef Domain2d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  * 
  *             if self.fld.mesh_type == 'cartesian':
  */
   if (unlikely(__pyx_v_self->fld->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 654, __pyx_L1_error)
+    __PYX_ERR(0, 722, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 722, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 654, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 654, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain2d))))) __PYX_ERR(0, 722, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain2d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":656
+    /* "libfds/fluxes.pyx":724
  *         for sub in self.fld.cdomains:
  * 
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 656, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 724, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fluxes.pyx":657
+      /* "libfds/fluxes.pyx":725
  * 
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *             elif self.fld.mesh_type == 'curvilinear':
  */
       __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d__fluxes_crt(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":656
+      /* "libfds/fluxes.pyx":724
  *         for sub in self.fld.cdomains:
  * 
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
       goto __pyx_L5;
     }
 
-    /* "libfds/fluxes.pyx":659
+    /* "libfds/fluxes.pyx":727
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 659, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 727, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fluxes.pyx":660
+      /* "libfds/fluxes.pyx":728
  * 
  *             elif self.fld.mesh_type == 'curvilinear':
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
       __pyx_f_6libfds_6fluxes_16_ViscousFluxes2d__fluxes_crv(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":659
+      /* "libfds/fluxes.pyx":727
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  */
     }
     __pyx_L5:;
 
-    /* "libfds/fluxes.pyx":654
+    /* "libfds/fluxes.pyx":722
  *         cdef Domain2d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  * 
  *             if self.fld.mesh_type == 'cartesian':
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":650
+  /* "libfds/fluxes.pyx":718
  *         self.fld.update('p')
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain2d sub
  */
 
@@ -11084,15 +11087,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fluxes._ViscousFluxes2d.fluxes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":662
+/* "libfds/fluxes.pyx":730
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  *         """ """
  * 
  */
 
@@ -11123,25 +11126,25 @@
   Py_ssize_t __pyx_t_16;
   Py_ssize_t __pyx_t_17;
   Py_ssize_t __pyx_t_18;
   Py_ssize_t __pyx_t_19;
   Py_ssize_t __pyx_t_20;
   __Pyx_RefNannySetupContext("_fluxes_crt", 0);
 
-  /* "libfds/fluxes.pyx":668
+  /* "libfds/fluxes.pyx":736
  *         cdef double mu, mu2, mucppr, Stot, T
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":669
+    /* "libfds/fluxes.pyx":737
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
     {
@@ -11178,196 +11181,196 @@
                               __pyx_v_Stot = ((double)__PYX_NAN());
                               __pyx_v_T = ((double)__PYX_NAN());
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_mu = ((double)__PYX_NAN());
                               __pyx_v_mu2 = ((double)__PYX_NAN());
                               __pyx_v_mucppr = ((double)__PYX_NAN());
 
-                              /* "libfds/fluxes.pyx":670
+                              /* "libfds/fluxes.pyx":738
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  * 
  *                     T = self.fld.Tk[ix, iy] / self.fld.T0
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fluxes.pyx":672
+                                /* "libfds/fluxes.pyx":740
  *                 for iy in range(iymin, iymax + 1):
  * 
  *                     T = self.fld.Tk[ix, iy] / self.fld.T0             # <<<<<<<<<<<<<<
  *                     mu = self.fld.mu0 * T * sqrt(T) * \
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_v_T = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_9 * __pyx_v_self->fld->Tk.strides[0]) )) + __pyx_t_10)) ))) / __pyx_v_self->fld->T0);
 
-                                /* "libfds/fluxes.pyx":674
+                                /* "libfds/fluxes.pyx":742
  *                     T = self.fld.Tk[ix, iy] / self.fld.T0
  *                     mu = self.fld.mu0 * T * sqrt(T) * \
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)             # <<<<<<<<<<<<<<
  *                     mu2 = 2 * mu
  *                     mucppr = mu * self.fld.cppr
  */
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 __pyx_v_mu = ((((__pyx_v_self->fld->mu0 * __pyx_v_T) * sqrt(__pyx_v_T)) * (__pyx_v_self->fld->T0 + __pyx_v_self->fld->Ssu)) / ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_10 * __pyx_v_self->fld->Tk.strides[0]) )) + __pyx_t_9)) ))) + __pyx_v_self->fld->Ssu));
 
-                                /* "libfds/fluxes.pyx":675
+                                /* "libfds/fluxes.pyx":743
  *                     mu = self.fld.mu0 * T * sqrt(T) * \
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)
  *                     mu2 = 2 * mu             # <<<<<<<<<<<<<<
  *                     mucppr = mu * self.fld.cppr
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.
  */
                                 __pyx_v_mu2 = (2.0 * __pyx_v_mu);
 
-                                /* "libfds/fluxes.pyx":676
+                                /* "libfds/fluxes.pyx":744
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)
  *                     mu2 = 2 * mu
  *                     mucppr = mu * self.fld.cppr             # <<<<<<<<<<<<<<
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.
  * 
  */
                                 __pyx_v_mucppr = (__pyx_v_mu * __pyx_v_self->fld->cppr);
 
-                                /* "libfds/fluxes.pyx":677
+                                /* "libfds/fluxes.pyx":745
  *                     mu2 = 2 * mu
  *                     mucppr = mu * self.fld.cppr
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11
  */
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_v_Stot = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_9 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_10)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_11 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_12)) )))) / 3.);
 
-                                /* "libfds/fluxes.pyx":679
+                                /* "libfds/fluxes.pyx":747
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.
  * 
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11             # <<<<<<<<<<<<<<
  *                     self.fld.S22[ix, iy] = - mu2 * (self.fld.S22[ix, iy] - Stot)  # tau22
  *                     self.fld.S12[ix, iy] *= - mu                                  # tau12
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_10 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_9)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_12 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_11)) ))) - __pyx_v_Stot));
 
-                                /* "libfds/fluxes.pyx":680
+                                /* "libfds/fluxes.pyx":748
  * 
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11
  *                     self.fld.S22[ix, iy] = - mu2 * (self.fld.S22[ix, iy] - Stot)  # tau22             # <<<<<<<<<<<<<<
  *                     self.fld.S12[ix, iy] *= - mu                                  # tau12
  * 
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_9 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_10)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_11 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_12)) ))) - __pyx_v_Stot));
 
-                                /* "libfds/fluxes.pyx":681
+                                /* "libfds/fluxes.pyx":749
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11
  *                     self.fld.S22[ix, iy] = - mu2 * (self.fld.S22[ix, iy] - Stot)  # tau22
  *                     self.fld.S12[ix, iy] *= - mu                                  # tau12             # <<<<<<<<<<<<<<
  * 
  *                     # (Qu, Qv) = (E, F)
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_12 * __pyx_v_self->fld->S12.strides[0]) )) + __pyx_t_11)) )) *= (-__pyx_v_mu);
 
-                                /* "libfds/fluxes.pyx":684
+                                /* "libfds/fluxes.pyx":752
  * 
  *                     # (Qu, Qv) = (E, F)
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  */
                                 __pyx_t_11 = __pyx_v_ix;
                                 __pyx_t_12 = __pyx_v_iy;
                                 __pyx_t_10 = __pyx_v_ix;
                                 __pyx_t_9 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":685
+                                /* "libfds/fluxes.pyx":753
  *                     # (Qu, Qv) = (E, F)
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  */
                                 __pyx_t_13 = __pyx_v_ix;
                                 __pyx_t_14 = __pyx_v_iy;
                                 __pyx_t_15 = __pyx_v_ix;
                                 __pyx_t_16 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":686
+                                /* "libfds/fluxes.pyx":754
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  */
                                 __pyx_t_17 = __pyx_v_ix;
                                 __pyx_t_18 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":684
+                                /* "libfds/fluxes.pyx":752
  * 
  *                     # (Qu, Qv) = (E, F)
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  */
                                 __pyx_t_19 = __pyx_v_ix;
                                 __pyx_t_20 = __pyx_v_iy;
                                 *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_19 * __pyx_v_self->fld->E.strides[0]) )) + __pyx_t_20)) )) = ((((-(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_11 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_12)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_10 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_9)) )))) - ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_13 * __pyx_v_self->fld->Fe.strides[0]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_15 * __pyx_v_self->fld->S12.strides[0]) )) + __pyx_t_16)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_17 * __pyx_v_self->fld->E.strides[0]) )) + __pyx_t_18)) )))));
 
-                                /* "libfds/fluxes.pyx":687
+                                /* "libfds/fluxes.pyx":755
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  *                                         mucppr * self.fld.F[ix, iy]
  */
                                 __pyx_t_18 = __pyx_v_ix;
                                 __pyx_t_17 = __pyx_v_iy;
                                 __pyx_t_16 = __pyx_v_ix;
                                 __pyx_t_15 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":688
+                                /* "libfds/fluxes.pyx":756
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         mucppr * self.fld.F[ix, iy]
  *         else:
  */
                                 __pyx_t_14 = __pyx_v_ix;
                                 __pyx_t_13 = __pyx_v_iy;
                                 __pyx_t_9 = __pyx_v_ix;
                                 __pyx_t_10 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":689
+                                /* "libfds/fluxes.pyx":757
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  *                                         mucppr * self.fld.F[ix, iy]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                 __pyx_t_12 = __pyx_v_ix;
                                 __pyx_t_11 = __pyx_v_iy;
 
-                                /* "libfds/fluxes.pyx":687
+                                /* "libfds/fluxes.pyx":755
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  *                                         mucppr * self.fld.F[ix, iy]
  */
                                 __pyx_t_20 = __pyx_v_ix;
@@ -11383,15 +11386,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fluxes.pyx":669
+        /* "libfds/fluxes.pyx":737
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
         /*finally:*/ {
@@ -11402,246 +11405,246 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fluxes.pyx":668
+    /* "libfds/fluxes.pyx":736
  *         cdef double mu, mu2, mucppr, Stot, T
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":691
+  /* "libfds/fluxes.pyx":759
  *                                         mucppr * self.fld.F[ix, iy]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  * 
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fluxes.pyx":692
+      /* "libfds/fluxes.pyx":760
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  * 
  *                     T = self.fld.Tk[ix, iy] / self.fld.T0
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fluxes.pyx":694
+        /* "libfds/fluxes.pyx":762
  *                 for iy in range(iymin, iymax + 1):
  * 
  *                     T = self.fld.Tk[ix, iy] / self.fld.T0             # <<<<<<<<<<<<<<
  *                     mu = self.fld.mu0 * T * sqrt(T) * \
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_v_T = ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_11 * __pyx_v_self->fld->Tk.strides[0]) )) + __pyx_t_12)) ))) / __pyx_v_self->fld->T0);
 
-        /* "libfds/fluxes.pyx":696
+        /* "libfds/fluxes.pyx":764
  *                     T = self.fld.Tk[ix, iy] / self.fld.T0
  *                     mu = self.fld.mu0 * T * sqrt(T) * \
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)             # <<<<<<<<<<<<<<
  *                     mu2 = 2 * mu
  *                     mucppr = mu * self.fld.cppr
  */
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         __pyx_v_mu = ((((__pyx_v_self->fld->mu0 * __pyx_v_T) * sqrt(__pyx_v_T)) * (__pyx_v_self->fld->T0 + __pyx_v_self->fld->Ssu)) / ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_12 * __pyx_v_self->fld->Tk.strides[0]) )) + __pyx_t_11)) ))) + __pyx_v_self->fld->Ssu));
 
-        /* "libfds/fluxes.pyx":697
+        /* "libfds/fluxes.pyx":765
  *                     mu = self.fld.mu0 * T * sqrt(T) * \
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)
  *                     mu2 = 2 * mu             # <<<<<<<<<<<<<<
  *                     mucppr = mu * self.fld.cppr
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.
  */
         __pyx_v_mu2 = (2.0 * __pyx_v_mu);
 
-        /* "libfds/fluxes.pyx":698
+        /* "libfds/fluxes.pyx":766
  *                         (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy] + self.fld.Ssu)
  *                     mu2 = 2 * mu
  *                     mucppr = mu * self.fld.cppr             # <<<<<<<<<<<<<<
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.
  * 
  */
         __pyx_v_mucppr = (__pyx_v_mu * __pyx_v_self->fld->cppr);
 
-        /* "libfds/fluxes.pyx":699
+        /* "libfds/fluxes.pyx":767
  *                     mu2 = 2 * mu
  *                     mucppr = mu * self.fld.cppr
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.             # <<<<<<<<<<<<<<
  * 
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11
  */
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_v_Stot = (((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_11 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_12)) ))) + (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_10 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_9)) )))) / 3.);
 
-        /* "libfds/fluxes.pyx":701
+        /* "libfds/fluxes.pyx":769
  *                     Stot = (self.fld.S11[ix, iy] + self.fld.S22[ix, iy]) / 3.
  * 
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11             # <<<<<<<<<<<<<<
  *                     self.fld.S22[ix, iy] = - mu2 * (self.fld.S22[ix, iy] - Stot)  # tau22
  *                     self.fld.S12[ix, iy] *= - mu                                  # tau12
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_12 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_11)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_9 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_10)) ))) - __pyx_v_Stot));
 
-        /* "libfds/fluxes.pyx":702
+        /* "libfds/fluxes.pyx":770
  * 
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11
  *                     self.fld.S22[ix, iy] = - mu2 * (self.fld.S22[ix, iy] - Stot)  # tau22             # <<<<<<<<<<<<<<
  *                     self.fld.S12[ix, iy] *= - mu                                  # tau12
  * 
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_11 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_12)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_10 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_9)) ))) - __pyx_v_Stot));
 
-        /* "libfds/fluxes.pyx":703
+        /* "libfds/fluxes.pyx":771
  *                     self.fld.S11[ix, iy] = - mu2 * (self.fld.S11[ix, iy] - Stot)  # tau11
  *                     self.fld.S22[ix, iy] = - mu2 * (self.fld.S22[ix, iy] - Stot)  # tau22
  *                     self.fld.S12[ix, iy] *= - mu                                  # tau12             # <<<<<<<<<<<<<<
  * 
  *                     # (Qu, Qv) = (E, F)
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_9 * __pyx_v_self->fld->S12.strides[0]) )) + __pyx_t_10)) )) *= (-__pyx_v_mu);
 
-        /* "libfds/fluxes.pyx":706
+        /* "libfds/fluxes.pyx":774
  * 
  *                     # (Qu, Qv) = (E, F)
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  */
         __pyx_t_10 = __pyx_v_ix;
         __pyx_t_9 = __pyx_v_iy;
         __pyx_t_12 = __pyx_v_ix;
         __pyx_t_11 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":707
+        /* "libfds/fluxes.pyx":775
  *                     # (Qu, Qv) = (E, F)
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  */
         __pyx_t_13 = __pyx_v_ix;
         __pyx_t_14 = __pyx_v_iy;
         __pyx_t_15 = __pyx_v_ix;
         __pyx_t_16 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":708
+        /* "libfds/fluxes.pyx":776
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]             # <<<<<<<<<<<<<<
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  */
         __pyx_t_17 = __pyx_v_ix;
         __pyx_t_18 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":706
+        /* "libfds/fluxes.pyx":774
  * 
  *                     # (Qu, Qv) = (E, F)
  *                     self.fld.E[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S11[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  */
         __pyx_t_19 = __pyx_v_ix;
         __pyx_t_20 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_19 * __pyx_v_self->fld->E.strides[0]) )) + __pyx_t_20)) )) = ((((-(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_10 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_9)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_12 * __pyx_v_self->fld->S11.strides[0]) )) + __pyx_t_11)) )))) - ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_13 * __pyx_v_self->fld->Fe.strides[0]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_15 * __pyx_v_self->fld->S12.strides[0]) )) + __pyx_t_16)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_17 * __pyx_v_self->fld->E.strides[0]) )) + __pyx_t_18)) )))));
 
-        /* "libfds/fluxes.pyx":709
+        /* "libfds/fluxes.pyx":777
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  *                                         mucppr * self.fld.F[ix, iy]
  */
         __pyx_t_18 = __pyx_v_ix;
         __pyx_t_17 = __pyx_v_iy;
         __pyx_t_16 = __pyx_v_ix;
         __pyx_t_15 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":710
+        /* "libfds/fluxes.pyx":778
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         mucppr * self.fld.F[ix, iy]
  * 
  */
         __pyx_t_14 = __pyx_v_ix;
         __pyx_t_13 = __pyx_v_iy;
         __pyx_t_11 = __pyx_v_ix;
         __pyx_t_12 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":711
+        /* "libfds/fluxes.pyx":779
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  *                                         mucppr * self.fld.F[ix, iy]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):
  */
         __pyx_t_9 = __pyx_v_ix;
         __pyx_t_10 = __pyx_v_iy;
 
-        /* "libfds/fluxes.pyx":709
+        /* "libfds/fluxes.pyx":777
  *                                         self.fld.Fe[ix, iy] * self.fld.S12[ix, iy] - \
  *                                         mucppr * self.fld.E[ix, iy]
  *                     self.fld.F[ix, iy] = - self.fld.Ee[ix, iy] * self.fld.S12[ix, iy] - \             # <<<<<<<<<<<<<<
  *                                         self.fld.Fe[ix, iy] * self.fld.S22[ix, iy] - \
  *                                         mucppr * self.fld.F[ix, iy]
  */
         __pyx_t_20 = __pyx_v_ix;
         __pyx_t_19 = __pyx_v_iy;
         *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_20 * __pyx_v_self->fld->F.strides[0]) )) + __pyx_t_19)) )) = ((((-(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_18 * __pyx_v_self->fld->Ee.strides[0]) )) + __pyx_t_17)) )))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_16 * __pyx_v_self->fld->S12.strides[0]) )) + __pyx_t_15)) )))) - ((*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_14 * __pyx_v_self->fld->Fe.strides[0]) )) + __pyx_t_13)) ))) * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_11 * __pyx_v_self->fld->S22.strides[0]) )) + __pyx_t_12)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_9 * __pyx_v_self->fld->F.strides[0]) )) + __pyx_t_10)) )))));
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":662
+  /* "libfds/fluxes.pyx":730
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  *         """ """
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":713
+/* "libfds/fluxes.pyx":781
  *                                         mucppr * self.fld.F[ix, iy]
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, bint mp):             # <<<<<<<<<<<<<<
  *         """ """
  * 
  */
 
@@ -11762,15 +11765,15 @@
   __Pyx_AddTraceback("libfds.fluxes._ViscousFluxes2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":730
+/* "libfds/fluxes.pyx":808
  *     cdef ViscousDerivative3d dru, drv, drw, dre
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -11799,32 +11802,32 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 730, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 808, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = ((struct __pyx_obj_6libfds_6fields_Fields3d *)values[0]);
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 730, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 808, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fluxes._ViscousFluxes3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
-  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 730, __pyx_L1_error)
+  if (unlikely(!__Pyx_ArgTypeTest(((PyObject *)__pyx_v_fld), __pyx_ptype_6libfds_6fields_Fields3d, 1, "fld", 0))) __PYX_ERR(0, 808, __pyx_L1_error)
   __pyx_r = __pyx_pf_6libfds_6fluxes_16_ViscousFluxes3d___cinit__(((struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *)__pyx_v_self), __pyx_v_fld);
 
   /* function exit code */
   goto __pyx_L0;
   __pyx_L1_error:;
   __pyx_r = -1;
   __pyx_L0:;
@@ -11841,43 +11844,43 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fluxes.pyx":732
+  /* "libfds/fluxes.pyx":810
  *     def __cinit__(self, Fields3d fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         self.dTk = Derivative3d(self.fld.Tk, self.fld.E, self.fld.F, self.fld.G, self.fld)
  */
   __Pyx_INCREF(((PyObject *)__pyx_v_fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_fld));
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = __pyx_v_fld;
 
-  /* "libfds/fluxes.pyx":734
+  /* "libfds/fluxes.pyx":812
  *         self.fld = fld
  * 
  *         self.dTk = Derivative3d(self.fld.Tk, self.fld.E, self.fld.F, self.fld.G, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         self.dS11 = Derivative3d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Tk, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
@@ -11886,39 +11889,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_5, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 734, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->dTk);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dTk));
   __pyx_v_self->dTk = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/fluxes.pyx":736
+  /* "libfds/fluxes.pyx":814
  *         self.dTk = Derivative3d(self.fld.Tk, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  *         self.dS11 = Derivative3d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)             # <<<<<<<<<<<<<<
  *         self.dS22 = Derivative3d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)
  *         self.dS33 = Derivative3d(self.fld.Ge, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
@@ -11927,39 +11930,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_4 = 0;
   __pyx_t_5 = 0;
   __pyx_t_3 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 736, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->dS11);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dS11));
   __pyx_v_self->dS11 = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/fluxes.pyx":737
+  /* "libfds/fluxes.pyx":815
  * 
  *         self.dS11 = Derivative3d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)
  *         self.dS22 = Derivative3d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)             # <<<<<<<<<<<<<<
  *         self.dS33 = Derivative3d(self.fld.Ge, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)
  * 
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 815, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 815, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 815, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 815, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
@@ -11968,39 +11971,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 737, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 815, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_5);
   __Pyx_GOTREF(__pyx_v_self->dS22);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dS22));
   __pyx_v_self->dS22 = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "libfds/fluxes.pyx":738
+  /* "libfds/fluxes.pyx":816
  *         self.dS11 = Derivative3d(self.fld.Ee, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)
  *         self.dS22 = Derivative3d(self.fld.Fe, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)
  *         self.dS33 = Derivative3d(self.fld.Ge, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)             # <<<<<<<<<<<<<<
  * 
  *         self.dru = ViscousDerivative3d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)
  */
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ge, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ge, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S33, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S33, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_3);
@@ -12009,39 +12012,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_2, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 738, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 816, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->dS33);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dS33));
   __pyx_v_self->dS33 = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":740
+  /* "libfds/fluxes.pyx":818
  *         self.dS33 = Derivative3d(self.fld.Ge, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)
  * 
  *         self.dru = ViscousDerivative3d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)             # <<<<<<<<<<<<<<
  *         self.drv = ViscousDerivative3d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)
  *         self.drw = ViscousDerivative3d(self.fld.rw, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->ru, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S11, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
@@ -12050,39 +12053,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_5, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 818, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->dru);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dru));
   __pyx_v_self->dru = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/fluxes.pyx":741
+  /* "libfds/fluxes.pyx":819
  * 
  *         self.dru = ViscousDerivative3d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)
  *         self.drv = ViscousDerivative3d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)             # <<<<<<<<<<<<<<
  *         self.drw = ViscousDerivative3d(self.fld.rw, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)
  *         self.dre = ViscousDerivative3d(self.fld.re, self.fld.E, self.fld.F, self.fld.G, self.fld)
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rv, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S12, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S22, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
@@ -12091,39 +12094,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_4 = 0;
   __pyx_t_5 = 0;
   __pyx_t_3 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 741, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 819, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->drv);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->drv));
   __pyx_v_self->drv = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/fluxes.pyx":742
+  /* "libfds/fluxes.pyx":820
  *         self.dru = ViscousDerivative3d(self.fld.ru, self.fld.S11, self.fld.S12, self.fld.S13, self.fld)
  *         self.drv = ViscousDerivative3d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)
  *         self.drw = ViscousDerivative3d(self.fld.rw, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)             # <<<<<<<<<<<<<<
  *         self.dre = ViscousDerivative3d(self.fld.re, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->rw, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S13, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S23, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S33, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->S33, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
@@ -12132,39 +12135,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 742, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 820, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_5);
   __Pyx_GOTREF(__pyx_v_self->drw);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->drw));
   __pyx_v_self->drw = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "libfds/fluxes.pyx":743
+  /* "libfds/fluxes.pyx":821
  *         self.drv = ViscousDerivative3d(self.fld.rv, self.fld.S12, self.fld.S22, self.fld.S23, self.fld)
  *         self.drw = ViscousDerivative3d(self.fld.rw, self.fld.S13, self.fld.S23, self.fld.S33, self.fld)
  *         self.dre = ViscousDerivative3d(self.fld.re, self.fld.E, self.fld.F, self.fld.G, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     cpdef void integrate(self):
  */
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->re, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_2 = PyTuple_New(5); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_2, 0, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_2, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_2, 2, __pyx_t_3);
@@ -12173,24 +12176,24 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_2, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_5 = 0;
   __pyx_t_4 = 0;
   __pyx_t_3 = 0;
   __pyx_t_1 = 0;
-  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_ViscousDerivative3d), __pyx_t_2, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 821, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->dre);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dre));
   __pyx_v_self->dre = ((struct __pyx_obj_6libfds_7libdiff_ViscousDerivative3d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":730
+  /* "libfds/fluxes.pyx":808
  *     cdef ViscousDerivative3d dru, drv, drw, dre
  * 
  *     def __cinit__(self, Fields3d fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -12206,142 +12209,142 @@
   __Pyx_AddTraceback("libfds.fluxes._ViscousFluxes3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":745
+/* "libfds/fluxes.pyx":823
  *         self.dre = ViscousDerivative3d(self.fld.re, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  *     cpdef void integrate(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate (u, v, w) and assign to (Ee, Fe, Ge)
  */
 
 static PyObject *__pyx_pw_6libfds_6fluxes_16_ViscousFluxes3d_3integrate(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
 static void __pyx_f_6libfds_6fluxes_16_ViscousFluxes3d_integrate(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *__pyx_v_self, CYTHON_UNUSED int __pyx_skip_dispatch) {
   __Pyx_RefNannyDeclarations
   struct __pyx_opt_args_6libfds_7libdiff_12Derivative3d_apply __pyx_t_1;
   __Pyx_RefNannySetupContext("integrate", 0);
 
-  /* "libfds/fluxes.pyx":748
+  /* "libfds/fluxes.pyx":826
  * 
  *         # Calculate (u, v, w) and assign to (Ee, Fe, Ge)
  *         self.fld.update('V')             # <<<<<<<<<<<<<<
  * 
  *         # Strain tensor
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_V);
 
-  /* "libfds/fluxes.pyx":754
+  /* "libfds/fluxes.pyx":832
  *         # S12 += dFe/dx || S22 = dFe/dy  || S23 = dFe/dz
  *         # S13 += dGe/dx || S23 += dGe/dy || S33 = dGe/dz
  *         self.dS11.apply()             # <<<<<<<<<<<<<<
  *         self.dS22.apply(add_x=True)
  *         self.dS33.apply(add_x=True, add_y=True)
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dS11->__pyx_vtab)->apply(__pyx_v_self->dS11, 0, NULL);
 
-  /* "libfds/fluxes.pyx":755
+  /* "libfds/fluxes.pyx":833
  *         # S13 += dGe/dx || S23 += dGe/dy || S33 = dGe/dz
  *         self.dS11.apply()
  *         self.dS22.apply(add_x=True)             # <<<<<<<<<<<<<<
  *         self.dS33.apply(add_x=True, add_y=True)
  * 
  */
   __pyx_t_1.__pyx_n = 1;
   __pyx_t_1.add_x = 1;
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dS22->__pyx_vtab)->apply(__pyx_v_self->dS22, 0, &__pyx_t_1); 
 
-  /* "libfds/fluxes.pyx":756
+  /* "libfds/fluxes.pyx":834
  *         self.dS11.apply()
  *         self.dS22.apply(add_x=True)
  *         self.dS33.apply(add_x=True, add_y=True)             # <<<<<<<<<<<<<<
  * 
  *         # Temperature gradient (dTk/dx, dTk/dy, dTk/dz) => (E, F, G)
  */
   __pyx_t_1.__pyx_n = 2;
   __pyx_t_1.add_x = 1;
   __pyx_t_1.add_y = 1;
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dS33->__pyx_vtab)->apply(__pyx_v_self->dS33, 0, &__pyx_t_1); 
 
-  /* "libfds/fluxes.pyx":759
+  /* "libfds/fluxes.pyx":837
  * 
  *         # Temperature gradient (dTk/dx, dTk/dy, dTk/dz) => (E, F, G)
  *         self.fld.update('Tk')             # <<<<<<<<<<<<<<
  *         self.dTk.apply()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_Tk);
 
-  /* "libfds/fluxes.pyx":760
+  /* "libfds/fluxes.pyx":838
  *         # Temperature gradient (dTk/dx, dTk/dy, dTk/dz) => (E, F, G)
  *         self.fld.update('Tk')
  *         self.dTk.apply()             # <<<<<<<<<<<<<<
  * 
  *         # Viscous fluxes
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dTk->__pyx_vtab)->apply(__pyx_v_self->dTk, 0, NULL);
 
-  /* "libfds/fluxes.pyx":763
+  /* "libfds/fluxes.pyx":841
  * 
  *         # Viscous fluxes
  *         self.fluxes()             # <<<<<<<<<<<<<<
  * 
  *         # Viscous fluxes derivation then integration
  */
   __pyx_f_6libfds_6fluxes_16_ViscousFluxes3d_fluxes(__pyx_v_self);
 
-  /* "libfds/fluxes.pyx":766
+  /* "libfds/fluxes.pyx":844
  * 
  *         # Viscous fluxes derivation then integration
  *         self.dru.apply()             # <<<<<<<<<<<<<<
  *         self.drv.apply()
  *         self.drw.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative3d *)__pyx_v_self->dru->__pyx_vtab)->apply(__pyx_v_self->dru);
 
-  /* "libfds/fluxes.pyx":767
+  /* "libfds/fluxes.pyx":845
  *         # Viscous fluxes derivation then integration
  *         self.dru.apply()
  *         self.drv.apply()             # <<<<<<<<<<<<<<
  *         self.drw.apply()
  *         self.dre.apply()
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative3d *)__pyx_v_self->drv->__pyx_vtab)->apply(__pyx_v_self->drv);
 
-  /* "libfds/fluxes.pyx":768
+  /* "libfds/fluxes.pyx":846
  *         self.dru.apply()
  *         self.drv.apply()
  *         self.drw.apply()             # <<<<<<<<<<<<<<
  *         self.dre.apply()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative3d *)__pyx_v_self->drw->__pyx_vtab)->apply(__pyx_v_self->drw);
 
-  /* "libfds/fluxes.pyx":769
+  /* "libfds/fluxes.pyx":847
  *         self.drv.apply()
  *         self.drw.apply()
  *         self.dre.apply()             # <<<<<<<<<<<<<<
  * 
  *         # Update p
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_ViscousDerivative3d *)__pyx_v_self->dre->__pyx_vtab)->apply(__pyx_v_self->dre);
 
-  /* "libfds/fluxes.pyx":772
+  /* "libfds/fluxes.pyx":850
  * 
  *         # Update p
  *         self.fld.update('p')             # <<<<<<<<<<<<<<
  * 
  *     cdef void fluxes(self):
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_p);
 
-  /* "libfds/fluxes.pyx":745
+  /* "libfds/fluxes.pyx":823
  *         self.dre = ViscousDerivative3d(self.fld.re, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  *     cpdef void integrate(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate (u, v, w) and assign to (Ee, Fe, Ge)
  */
 
@@ -12367,15 +12370,15 @@
   __Pyx_RefNannyDeclarations
   PyObject *__pyx_t_1 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("integrate", 0);
   __Pyx_XDECREF(__pyx_r);
-  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_16_ViscousFluxes3d_integrate(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)
+  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_6libfds_6fluxes_16_ViscousFluxes3d_integrate(__pyx_v_self, 1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 823, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __pyx_r = __pyx_t_1;
   __pyx_t_1 = 0;
   goto __pyx_L0;
 
   /* function exit code */
   __pyx_L1_error:;
@@ -12384,15 +12387,15 @@
   __pyx_r = NULL;
   __pyx_L0:;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":774
+/* "libfds/fluxes.pyx":852
  *         self.fld.update('p')
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -12405,109 +12408,109 @@
   int __pyx_t_4;
   int __pyx_t_5;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("fluxes", 0);
 
-  /* "libfds/fluxes.pyx":778
+  /* "libfds/fluxes.pyx":856
  *         cdef Domain3d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   if (unlikely(__pyx_v_self->fld->cdomains == Py_None)) {
     PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
-    __PYX_ERR(0, 778, __pyx_L1_error)
+    __PYX_ERR(0, 856, __pyx_L1_error)
   }
   __pyx_t_1 = __pyx_v_self->fld->cdomains; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
   for (;;) {
     if (__pyx_t_2 >= PyList_GET_SIZE(__pyx_t_1)) break;
     #if CYTHON_ASSUME_SAFE_MACROS && !CYTHON_AVOID_BORROWED_REFS
-    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_3 = PyList_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(0, 856, __pyx_L1_error)
     #else
-    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 778, __pyx_L1_error)
+    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 856, __pyx_L1_error)
     __Pyx_GOTREF(__pyx_t_3);
     #endif
-    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 778, __pyx_L1_error)
+    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_6libfds_6fields_Domain3d))))) __PYX_ERR(0, 856, __pyx_L1_error)
     __Pyx_XDECREF_SET(__pyx_v_sub, ((struct __pyx_obj_6libfds_6fields_Domain3d *)__pyx_t_3));
     __pyx_t_3 = 0;
 
-    /* "libfds/fluxes.pyx":779
+    /* "libfds/fluxes.pyx":857
  * 
  *         for sub in self.fld.cdomains:
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':
  */
-    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 779, __pyx_L1_error)
+    __pyx_t_4 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_cartesian, Py_EQ)); if (unlikely(__pyx_t_4 < 0)) __PYX_ERR(0, 857, __pyx_L1_error)
     __pyx_t_5 = (__pyx_t_4 != 0);
     if (__pyx_t_5) {
 
-      /* "libfds/fluxes.pyx":780
+      /* "libfds/fluxes.pyx":858
  *         for sub in self.fld.cdomains:
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  *             elif self.fld.mesh_type == 'curvilinear':
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
       __pyx_f_6libfds_6fluxes_16_ViscousFluxes3d__fluxes_crt(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":779
+      /* "libfds/fluxes.pyx":857
  * 
  *         for sub in self.fld.cdomains:
  *             if self.fld.mesh_type == 'cartesian':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':
  */
       goto __pyx_L5;
     }
 
-    /* "libfds/fluxes.pyx":781
+    /* "libfds/fluxes.pyx":859
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
-    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 781, __pyx_L1_error)
+    __pyx_t_5 = (__Pyx_PyUnicode_Equals(__pyx_v_self->fld->mesh_type, __pyx_n_u_curvilinear, Py_EQ)); if (unlikely(__pyx_t_5 < 0)) __PYX_ERR(0, 859, __pyx_L1_error)
     __pyx_t_4 = (__pyx_t_5 != 0);
     if (__pyx_t_4) {
 
-      /* "libfds/fluxes.pyx":782
+      /* "libfds/fluxes.pyx":860
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
       __pyx_f_6libfds_6fluxes_16_ViscousFluxes3d__fluxes_crv(__pyx_v_self, __pyx_v_sub->ix.f0, __pyx_v_sub->ix.f1, __pyx_v_sub->iy.f0, __pyx_v_sub->iy.f1, __pyx_v_sub->iz.f0, __pyx_v_sub->iz.f1, __pyx_v_sub->mp);
 
-      /* "libfds/fluxes.pyx":781
+      /* "libfds/fluxes.pyx":859
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  *             elif self.fld.mesh_type == 'curvilinear':             # <<<<<<<<<<<<<<
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  */
     }
     __pyx_L5:;
 
-    /* "libfds/fluxes.pyx":778
+    /* "libfds/fluxes.pyx":856
  *         cdef Domain3d sub
  * 
  *         for sub in self.fld.cdomains:             # <<<<<<<<<<<<<<
  *             if self.fld.mesh_type == 'cartesian':
  *                 self._fluxes_crt(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  */
   }
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":774
+  /* "libfds/fluxes.pyx":852
  *         self.fld.update('p')
  * 
  *     cdef void fluxes(self):             # <<<<<<<<<<<<<<
  * 
  *         cdef Domain3d sub
  */
 
@@ -12518,15 +12521,15 @@
   __Pyx_XDECREF(__pyx_t_3);
   __Pyx_WriteUnraisable("libfds.fluxes._ViscousFluxes3d.fluxes", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
   __pyx_L0:;
   __Pyx_XDECREF((PyObject *)__pyx_v_sub);
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":784
+/* "libfds/fluxes.pyx":862
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """  """
  * 
  */
 
@@ -12573,25 +12576,25 @@
   Py_ssize_t __pyx_t_31;
   Py_ssize_t __pyx_t_32;
   Py_ssize_t __pyx_t_33;
   Py_ssize_t __pyx_t_34;
   Py_ssize_t __pyx_t_35;
   __Pyx_RefNannySetupContext("_fluxes_crt", 0);
 
-  /* "libfds/fluxes.pyx":790
+  /* "libfds/fluxes.pyx":868
  *         cdef double mu, mu2, mucppr, Stot, T
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
   __pyx_t_1 = (__pyx_v_mp != 0);
   if (__pyx_t_1) {
 
-    /* "libfds/fluxes.pyx":791
+    /* "libfds/fluxes.pyx":869
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
     {
@@ -12629,81 +12632,81 @@
                               __pyx_v_T = ((double)__PYX_NAN());
                               __pyx_v_iy = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_iz = ((Py_ssize_t)0xbad0bad0);
                               __pyx_v_mu = ((double)__PYX_NAN());
                               __pyx_v_mu2 = ((double)__PYX_NAN());
                               __pyx_v_mucppr = ((double)__PYX_NAN());
 
-                              /* "libfds/fluxes.pyx":792
+                              /* "libfds/fluxes.pyx":870
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  * 
  */
                               __pyx_t_6 = (__pyx_v_iymax + 1);
                               __pyx_t_7 = __pyx_t_6;
                               for (__pyx_t_8 = __pyx_v_iymin; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
                                 __pyx_v_iy = __pyx_t_8;
 
-                                /* "libfds/fluxes.pyx":793
+                                /* "libfds/fluxes.pyx":871
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  * 
  *                         T = self.fld.Tk[ix, iy, iz] / self.fld.T0
  */
                                 __pyx_t_9 = (__pyx_v_izmax + 1);
                                 __pyx_t_10 = __pyx_t_9;
                                 for (__pyx_t_11 = __pyx_v_izmin; __pyx_t_11 < __pyx_t_10; __pyx_t_11+=1) {
                                   __pyx_v_iz = __pyx_t_11;
 
-                                  /* "libfds/fluxes.pyx":795
+                                  /* "libfds/fluxes.pyx":873
  *                     for iz in range(izmin, izmax + 1):
  * 
  *                         T = self.fld.Tk[ix, iy, iz] / self.fld.T0             # <<<<<<<<<<<<<<
  *                         mu = self.fld.mu0 * T * sqrt(T) * \
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_v_T = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_12 * __pyx_v_self->fld->Tk.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Tk.strides[1]) )) + __pyx_t_14)) ))) / __pyx_v_self->fld->T0);
 
-                                  /* "libfds/fluxes.pyx":797
+                                  /* "libfds/fluxes.pyx":875
  *                         T = self.fld.Tk[ix, iy, iz] / self.fld.T0
  *                         mu = self.fld.mu0 * T * sqrt(T) * \
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)             # <<<<<<<<<<<<<<
  *                         mu2 = - 2 * mu
  *                         mucppr = mu * self.fld.cppr
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_v_mu = ((((__pyx_v_self->fld->mu0 * __pyx_v_T) * sqrt(__pyx_v_T)) * (__pyx_v_self->fld->T0 + __pyx_v_self->fld->Ssu)) / ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_14 * __pyx_v_self->fld->Tk.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Tk.strides[1]) )) + __pyx_t_12)) ))) + __pyx_v_self->fld->Ssu));
 
-                                  /* "libfds/fluxes.pyx":798
+                                  /* "libfds/fluxes.pyx":876
  *                         mu = self.fld.mu0 * T * sqrt(T) * \
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)
  *                         mu2 = - 2 * mu             # <<<<<<<<<<<<<<
  *                         mucppr = mu * self.fld.cppr
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.
  */
                                   __pyx_v_mu2 = (-2.0 * __pyx_v_mu);
 
-                                  /* "libfds/fluxes.pyx":799
+                                  /* "libfds/fluxes.pyx":877
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)
  *                         mu2 = - 2 * mu
  *                         mucppr = mu * self.fld.cppr             # <<<<<<<<<<<<<<
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.
  * 
  */
                                   __pyx_v_mucppr = (__pyx_v_mu * __pyx_v_self->fld->cppr);
 
-                                  /* "libfds/fluxes.pyx":800
+                                  /* "libfds/fluxes.pyx":878
  *                         mu2 = - 2 * mu
  *                         mucppr = mu * self.fld.cppr
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11
  */
                                   __pyx_t_12 = __pyx_v_ix;
@@ -12713,279 +12716,279 @@
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_v_Stot = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_12 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_14)) ))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_15 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_17)) )))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_18 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_20)) )))) / 3.);
 
-                                  /* "libfds/fluxes.pyx":802
+                                  /* "libfds/fluxes.pyx":880
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.
  * 
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11             # <<<<<<<<<<<<<<
  *                         self.fld.S22[ix, iy, iz] = - mu2 * (self.fld.S22[ix, iy, iz] - Stot)       # tau22
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_17 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_15)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_20 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_18)) ))) - __pyx_v_Stot));
 
-                                  /* "libfds/fluxes.pyx":803
+                                  /* "libfds/fluxes.pyx":881
  * 
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11
  *                         self.fld.S22[ix, iy, iz] = - mu2 * (self.fld.S22[ix, iy, iz] - Stot)       # tau22             # <<<<<<<<<<<<<<
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33
  * 
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_15 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_17)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_18 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_20)) ))) - __pyx_v_Stot));
 
-                                  /* "libfds/fluxes.pyx":804
+                                  /* "libfds/fluxes.pyx":882
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11
  *                         self.fld.S22[ix, iy, iz] = - mu2 * (self.fld.S22[ix, iy, iz] - Stot)       # tau22
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_17 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_15)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_20 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_18)) ))) - __pyx_v_Stot));
 
-                                  /* "libfds/fluxes.pyx":806
+                                  /* "libfds/fluxes.pyx":884
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33
  * 
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12             # <<<<<<<<<<<<<<
  *                         self.fld.S13[ix, iy, iz] *= - mu                                           # tau13
  *                         self.fld.S23[ix, iy, iz] *= - mu                                           # tau23
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_18 * __pyx_v_self->fld->S12.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S12.strides[1]) )) + __pyx_t_20)) )) *= (-__pyx_v_mu);
 
-                                  /* "libfds/fluxes.pyx":807
+                                  /* "libfds/fluxes.pyx":885
  * 
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12
  *                         self.fld.S13[ix, iy, iz] *= - mu                                           # tau13             # <<<<<<<<<<<<<<
  *                         self.fld.S23[ix, iy, iz] *= - mu                                           # tau23
  * 
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S13.data + __pyx_t_20 * __pyx_v_self->fld->S13.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S13.strides[1]) )) + __pyx_t_18)) )) *= (-__pyx_v_mu);
 
-                                  /* "libfds/fluxes.pyx":808
+                                  /* "libfds/fluxes.pyx":886
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12
  *                         self.fld.S13[ix, iy, iz] *= - mu                                           # tau13
  *                         self.fld.S23[ix, iy, iz] *= - mu                                           # tau23             # <<<<<<<<<<<<<<
  * 
  *                         # (Qu, Qv, Qw) = (E, F, G)
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S23.data + __pyx_t_18 * __pyx_v_self->fld->S23.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->S23.strides[1]) )) + __pyx_t_20)) )) *= (-__pyx_v_mu);
 
-                                  /* "libfds/fluxes.pyx":811
+                                  /* "libfds/fluxes.pyx":889
  * 
  *                         # (Qu, Qv, Qw) = (E, F, G)
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":812
+                                  /* "libfds/fluxes.pyx":890
  *                         # (Qu, Qv, Qw) = (E, F, G)
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":813
+                                  /* "libfds/fluxes.pyx":891
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":814
+                                  /* "libfds/fluxes.pyx":892
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  */
                                   __pyx_t_30 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_32 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":811
+                                  /* "libfds/fluxes.pyx":889
  * 
  *                         # (Qu, Qv, Qw) = (E, F, G)
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  */
                                   __pyx_t_33 = __pyx_v_ix;
                                   __pyx_t_34 = __pyx_v_iy;
                                   __pyx_t_35 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_33 * __pyx_v_self->fld->E.strides[0]) ) + __pyx_t_34 * __pyx_v_self->fld->E.strides[1]) )) + __pyx_t_35)) )) = (((((-(*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_20 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_18)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_15 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_17)) )))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_14 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_21 * __pyx_v_self->fld->S12.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->S12.strides[1]) )) + __pyx_t_23)) ))))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_24 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_26)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S13.data + __pyx_t_27 * __pyx_v_self->fld->S13.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S13.strides[1]) )) + __pyx_t_29)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_30 * __pyx_v_self->fld->E.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->E.strides[1]) )) + __pyx_t_32)) )))));
 
-                                  /* "libfds/fluxes.pyx":815
+                                  /* "libfds/fluxes.pyx":893
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  */
                                   __pyx_t_32 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_30 = __pyx_v_iz;
                                   __pyx_t_29 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_27 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":816
+                                  /* "libfds/fluxes.pyx":894
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  */
                                   __pyx_t_26 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_24 = __pyx_v_iz;
                                   __pyx_t_23 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_21 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":817
+                                  /* "libfds/fluxes.pyx":895
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  */
                                   __pyx_t_12 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_14 = __pyx_v_iz;
                                   __pyx_t_17 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_15 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":818
+                                  /* "libfds/fluxes.pyx":896
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  */
                                   __pyx_t_18 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_20 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":815
+                                  /* "libfds/fluxes.pyx":893
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  */
                                   __pyx_t_35 = __pyx_v_ix;
                                   __pyx_t_34 = __pyx_v_iy;
                                   __pyx_t_33 = __pyx_v_iz;
                                   *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_35 * __pyx_v_self->fld->F.strides[0]) ) + __pyx_t_34 * __pyx_v_self->fld->F.strides[1]) )) + __pyx_t_33)) )) = (((((-(*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_32 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_30)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_29 * __pyx_v_self->fld->S12.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S12.strides[1]) )) + __pyx_t_27)) )))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_26 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_24)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_23 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_21)) ))))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_12 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S23.data + __pyx_t_17 * __pyx_v_self->fld->S23.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S23.strides[1]) )) + __pyx_t_15)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_18 * __pyx_v_self->fld->F.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->F.strides[1]) )) + __pyx_t_20)) )))));
 
-                                  /* "libfds/fluxes.pyx":819
+                                  /* "libfds/fluxes.pyx":897
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  */
                                   __pyx_t_20 = __pyx_v_ix;
                                   __pyx_t_19 = __pyx_v_iy;
                                   __pyx_t_18 = __pyx_v_iz;
                                   __pyx_t_15 = __pyx_v_ix;
                                   __pyx_t_16 = __pyx_v_iy;
                                   __pyx_t_17 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":820
+                                  /* "libfds/fluxes.pyx":898
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  *                                                 mucppr * self.fld.G[ix, iy, iz]
  */
                                   __pyx_t_14 = __pyx_v_ix;
                                   __pyx_t_13 = __pyx_v_iy;
                                   __pyx_t_12 = __pyx_v_iz;
                                   __pyx_t_21 = __pyx_v_ix;
                                   __pyx_t_22 = __pyx_v_iy;
                                   __pyx_t_23 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":821
+                                  /* "libfds/fluxes.pyx":899
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 mucppr * self.fld.G[ix, iy, iz]
  *         else:
  */
                                   __pyx_t_24 = __pyx_v_ix;
                                   __pyx_t_25 = __pyx_v_iy;
                                   __pyx_t_26 = __pyx_v_iz;
                                   __pyx_t_27 = __pyx_v_ix;
                                   __pyx_t_28 = __pyx_v_iy;
                                   __pyx_t_29 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":822
+                                  /* "libfds/fluxes.pyx":900
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  *                                                 mucppr * self.fld.G[ix, iy, iz]             # <<<<<<<<<<<<<<
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  */
                                   __pyx_t_30 = __pyx_v_ix;
                                   __pyx_t_31 = __pyx_v_iy;
                                   __pyx_t_32 = __pyx_v_iz;
 
-                                  /* "libfds/fluxes.pyx":819
+                                  /* "libfds/fluxes.pyx":897
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  */
                                   __pyx_t_33 = __pyx_v_ix;
@@ -13003,15 +13006,15 @@
               #undef likely
               #undef unlikely
               #define likely(x)   __builtin_expect(!!(x), 1)
               #define unlikely(x) __builtin_expect(!!(x), 0)
           #endif
         }
 
-        /* "libfds/fluxes.pyx":791
+        /* "libfds/fluxes.pyx":869
  * 
  *         if mp:
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
         /*finally:*/ {
@@ -13022,104 +13025,104 @@
             #endif
             goto __pyx_L6;
           }
           __pyx_L6:;
         }
     }
 
-    /* "libfds/fluxes.pyx":790
+    /* "libfds/fluxes.pyx":868
  *         cdef double mu, mu2, mucppr, Stot, T
  * 
  *         if mp:             # <<<<<<<<<<<<<<
  *             for ix in prange(ixmin, ixmax + 1, nogil=True, num_threads=self.fld.cpu):
  *                 for iy in range(iymin, iymax + 1):
  */
     goto __pyx_L3;
   }
 
-  /* "libfds/fluxes.pyx":824
+  /* "libfds/fluxes.pyx":902
  *                                                 mucppr * self.fld.G[ix, iy, iz]
  *         else:
  *             for ix in range(ixmin, ixmax + 1):             # <<<<<<<<<<<<<<
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):
  */
   /*else*/ {
     __pyx_t_5 = (__pyx_v_ixmax + 1);
     __pyx_t_4 = __pyx_t_5;
     for (__pyx_t_3 = __pyx_v_ixmin; __pyx_t_3 < __pyx_t_4; __pyx_t_3+=1) {
       __pyx_v_ix = __pyx_t_3;
 
-      /* "libfds/fluxes.pyx":825
+      /* "libfds/fluxes.pyx":903
  *         else:
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):             # <<<<<<<<<<<<<<
  *                     for iz in range(izmin, izmax + 1):
  * 
  */
       __pyx_t_2 = (__pyx_v_iymax + 1);
       __pyx_t_6 = __pyx_t_2;
       for (__pyx_t_7 = __pyx_v_iymin; __pyx_t_7 < __pyx_t_6; __pyx_t_7+=1) {
         __pyx_v_iy = __pyx_t_7;
 
-        /* "libfds/fluxes.pyx":826
+        /* "libfds/fluxes.pyx":904
  *             for ix in range(ixmin, ixmax + 1):
  *                 for iy in range(iymin, iymax + 1):
  *                     for iz in range(izmin, izmax + 1):             # <<<<<<<<<<<<<<
  * 
  *                         T = self.fld.Tk[ix, iy, iz] / self.fld.T0
  */
         __pyx_t_8 = (__pyx_v_izmax + 1);
         __pyx_t_9 = __pyx_t_8;
         for (__pyx_t_10 = __pyx_v_izmin; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
           __pyx_v_iz = __pyx_t_10;
 
-          /* "libfds/fluxes.pyx":828
+          /* "libfds/fluxes.pyx":906
  *                     for iz in range(izmin, izmax + 1):
  * 
  *                         T = self.fld.Tk[ix, iy, iz] / self.fld.T0             # <<<<<<<<<<<<<<
  *                         mu = self.fld.mu0 * T * sqrt(T) * \
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)
  */
           __pyx_t_32 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_30 = __pyx_v_iz;
           __pyx_v_T = ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_32 * __pyx_v_self->fld->Tk.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->Tk.strides[1]) )) + __pyx_t_30)) ))) / __pyx_v_self->fld->T0);
 
-          /* "libfds/fluxes.pyx":830
+          /* "libfds/fluxes.pyx":908
  *                         T = self.fld.Tk[ix, iy, iz] / self.fld.T0
  *                         mu = self.fld.mu0 * T * sqrt(T) * \
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)             # <<<<<<<<<<<<<<
  *                         mu2 = - 2 * mu
  *                         mucppr = mu * self.fld.cppr
  */
           __pyx_t_30 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_32 = __pyx_v_iz;
           __pyx_v_mu = ((((__pyx_v_self->fld->mu0 * __pyx_v_T) * sqrt(__pyx_v_T)) * (__pyx_v_self->fld->T0 + __pyx_v_self->fld->Ssu)) / ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Tk.data + __pyx_t_30 * __pyx_v_self->fld->Tk.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->Tk.strides[1]) )) + __pyx_t_32)) ))) + __pyx_v_self->fld->Ssu));
 
-          /* "libfds/fluxes.pyx":831
+          /* "libfds/fluxes.pyx":909
  *                         mu = self.fld.mu0 * T * sqrt(T) * \
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)
  *                         mu2 = - 2 * mu             # <<<<<<<<<<<<<<
  *                         mucppr = mu * self.fld.cppr
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.
  */
           __pyx_v_mu2 = (-2.0 * __pyx_v_mu);
 
-          /* "libfds/fluxes.pyx":832
+          /* "libfds/fluxes.pyx":910
  *                             (self.fld.T0 + self.fld.Ssu) / (self.fld.Tk[ix, iy, iz] + self.fld.Ssu)
  *                         mu2 = - 2 * mu
  *                         mucppr = mu * self.fld.cppr             # <<<<<<<<<<<<<<
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.
  * 
  */
           __pyx_v_mucppr = (__pyx_v_mu * __pyx_v_self->fld->cppr);
 
-          /* "libfds/fluxes.pyx":833
+          /* "libfds/fluxes.pyx":911
  *                         mu2 = - 2 * mu
  *                         mucppr = mu * self.fld.cppr
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11
  */
           __pyx_t_32 = __pyx_v_ix;
@@ -13129,279 +13132,279 @@
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_v_Stot = ((((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_32 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_30)) ))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_29 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_27)) )))) + (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_26 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_24)) )))) / 3.);
 
-          /* "libfds/fluxes.pyx":835
+          /* "libfds/fluxes.pyx":913
  *                         Stot = (self.fld.S11[ix, iy, iz] + self.fld.S22[ix, iy, iz] + self.fld.S33[ix, iy, iz]) / 3.
  * 
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11             # <<<<<<<<<<<<<<
  *                         self.fld.S22[ix, iy, iz] = - mu2 * (self.fld.S22[ix, iy, iz] - Stot)       # tau22
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_27 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_29)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_24 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_26)) ))) - __pyx_v_Stot));
 
-          /* "libfds/fluxes.pyx":836
+          /* "libfds/fluxes.pyx":914
  * 
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11
  *                         self.fld.S22[ix, iy, iz] = - mu2 * (self.fld.S22[ix, iy, iz] - Stot)       # tau22             # <<<<<<<<<<<<<<
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33
  * 
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_29 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_27)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_26 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_24)) ))) - __pyx_v_Stot));
 
-          /* "libfds/fluxes.pyx":837
+          /* "libfds/fluxes.pyx":915
  *                         self.fld.S11[ix, iy, iz] = - mu2 * (self.fld.S11[ix, iy, iz] - Stot)       # tau11
  *                         self.fld.S22[ix, iy, iz] = - mu2 * (self.fld.S22[ix, iy, iz] - Stot)       # tau22
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33             # <<<<<<<<<<<<<<
  * 
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_27 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_29)) )) = ((-__pyx_v_mu2) * ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_24 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_26)) ))) - __pyx_v_Stot));
 
-          /* "libfds/fluxes.pyx":839
+          /* "libfds/fluxes.pyx":917
  *                         self.fld.S33[ix, iy, iz] = - mu2 * (self.fld.S33[ix, iy, iz] - Stot)       # tau33
  * 
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12             # <<<<<<<<<<<<<<
  *                         self.fld.S13[ix, iy, iz] *= - mu                                           # tau13
  *                         self.fld.S23[ix, iy, iz] *= - mu                                           # tau23
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_26 * __pyx_v_self->fld->S12.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S12.strides[1]) )) + __pyx_t_24)) )) *= (-__pyx_v_mu);
 
-          /* "libfds/fluxes.pyx":840
+          /* "libfds/fluxes.pyx":918
  * 
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12
  *                         self.fld.S13[ix, iy, iz] *= - mu                                           # tau13             # <<<<<<<<<<<<<<
  *                         self.fld.S23[ix, iy, iz] *= - mu                                           # tau23
  * 
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S13.data + __pyx_t_24 * __pyx_v_self->fld->S13.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S13.strides[1]) )) + __pyx_t_26)) )) *= (-__pyx_v_mu);
 
-          /* "libfds/fluxes.pyx":841
+          /* "libfds/fluxes.pyx":919
  *                         self.fld.S12[ix, iy, iz] *= - mu                                           # tau12
  *                         self.fld.S13[ix, iy, iz] *= - mu                                           # tau13
  *                         self.fld.S23[ix, iy, iz] *= - mu                                           # tau23             # <<<<<<<<<<<<<<
  * 
  *                         # (Qu, Qv, Qw) = (E, F, G)
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S23.data + __pyx_t_26 * __pyx_v_self->fld->S23.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->S23.strides[1]) )) + __pyx_t_24)) )) *= (-__pyx_v_mu);
 
-          /* "libfds/fluxes.pyx":844
+          /* "libfds/fluxes.pyx":922
  * 
  *                         # (Qu, Qv, Qw) = (E, F, G)
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":845
+          /* "libfds/fluxes.pyx":923
  *                         # (Qu, Qv, Qw) = (E, F, G)
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  */
           __pyx_t_30 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_32 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":846
+          /* "libfds/fluxes.pyx":924
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":847
+          /* "libfds/fluxes.pyx":925
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":844
+          /* "libfds/fluxes.pyx":922
  * 
  *                         # (Qu, Qv, Qw) = (E, F, G)
  *                         self.fld.E[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S11[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  */
           __pyx_t_35 = __pyx_v_ix;
           __pyx_t_34 = __pyx_v_iy;
           __pyx_t_33 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_35 * __pyx_v_self->fld->E.strides[0]) ) + __pyx_t_34 * __pyx_v_self->fld->E.strides[1]) )) + __pyx_t_33)) )) = (((((-(*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_24 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_26)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S11.data + __pyx_t_29 * __pyx_v_self->fld->S11.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S11.strides[1]) )) + __pyx_t_27)) )))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_30 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_32)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_23 * __pyx_v_self->fld->S12.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->S12.strides[1]) )) + __pyx_t_21)) ))))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_12 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S13.data + __pyx_t_17 * __pyx_v_self->fld->S13.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S13.strides[1]) )) + __pyx_t_15)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->E.data + __pyx_t_18 * __pyx_v_self->fld->E.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->E.strides[1]) )) + __pyx_t_20)) )))));
 
-          /* "libfds/fluxes.pyx":848
+          /* "libfds/fluxes.pyx":926
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  */
           __pyx_t_20 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_18 = __pyx_v_iz;
           __pyx_t_15 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_17 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":849
+          /* "libfds/fluxes.pyx":927
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  */
           __pyx_t_14 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_12 = __pyx_v_iz;
           __pyx_t_21 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_23 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":850
+          /* "libfds/fluxes.pyx":928
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  */
           __pyx_t_32 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_30 = __pyx_v_iz;
           __pyx_t_27 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_29 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":851
+          /* "libfds/fluxes.pyx":929
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]             # <<<<<<<<<<<<<<
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  */
           __pyx_t_26 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_24 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":848
+          /* "libfds/fluxes.pyx":926
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 mucppr * self.fld.E[ix, iy, iz]
  *                         self.fld.F[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S12[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S22[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  */
           __pyx_t_33 = __pyx_v_ix;
           __pyx_t_34 = __pyx_v_iy;
           __pyx_t_35 = __pyx_v_iz;
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_33 * __pyx_v_self->fld->F.strides[0]) ) + __pyx_t_34 * __pyx_v_self->fld->F.strides[1]) )) + __pyx_t_35)) )) = (((((-(*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_20 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_18)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S12.data + __pyx_t_15 * __pyx_v_self->fld->S12.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S12.strides[1]) )) + __pyx_t_17)) )))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_14 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_12)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S22.data + __pyx_t_21 * __pyx_v_self->fld->S22.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->S22.strides[1]) )) + __pyx_t_23)) ))))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_32 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_30)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S23.data + __pyx_t_27 * __pyx_v_self->fld->S23.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S23.strides[1]) )) + __pyx_t_29)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->F.data + __pyx_t_26 * __pyx_v_self->fld->F.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->F.strides[1]) )) + __pyx_t_24)) )))));
 
-          /* "libfds/fluxes.pyx":852
+          /* "libfds/fluxes.pyx":930
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  */
           __pyx_t_24 = __pyx_v_ix;
           __pyx_t_25 = __pyx_v_iy;
           __pyx_t_26 = __pyx_v_iz;
           __pyx_t_29 = __pyx_v_ix;
           __pyx_t_28 = __pyx_v_iy;
           __pyx_t_27 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":853
+          /* "libfds/fluxes.pyx":931
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  *                                                 mucppr * self.fld.G[ix, iy, iz]
  */
           __pyx_t_30 = __pyx_v_ix;
           __pyx_t_31 = __pyx_v_iy;
           __pyx_t_32 = __pyx_v_iz;
           __pyx_t_23 = __pyx_v_ix;
           __pyx_t_22 = __pyx_v_iy;
           __pyx_t_21 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":854
+          /* "libfds/fluxes.pyx":932
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 mucppr * self.fld.G[ix, iy, iz]
  * 
  */
           __pyx_t_12 = __pyx_v_ix;
           __pyx_t_13 = __pyx_v_iy;
           __pyx_t_14 = __pyx_v_iz;
           __pyx_t_17 = __pyx_v_ix;
           __pyx_t_16 = __pyx_v_iy;
           __pyx_t_15 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":855
+          /* "libfds/fluxes.pyx":933
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  *                                                 mucppr * self.fld.G[ix, iy, iz]             # <<<<<<<<<<<<<<
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):
  */
           __pyx_t_18 = __pyx_v_ix;
           __pyx_t_19 = __pyx_v_iy;
           __pyx_t_20 = __pyx_v_iz;
 
-          /* "libfds/fluxes.pyx":852
+          /* "libfds/fluxes.pyx":930
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 mucppr * self.fld.F[ix, iy, iz]
  *                         self.fld.G[ix, iy, iz] = - self.fld.Ee[ix, iy, iz] * self.fld.S13[ix, iy, iz] - \             # <<<<<<<<<<<<<<
  *                                                 self.fld.Fe[ix, iy, iz] * self.fld.S23[ix, iy, iz] - \
  *                                                 self.fld.Ge[ix, iy, iz] * self.fld.S33[ix, iy, iz] - \
  */
           __pyx_t_35 = __pyx_v_ix;
@@ -13410,27 +13413,27 @@
           *((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->G.data + __pyx_t_35 * __pyx_v_self->fld->G.strides[0]) ) + __pyx_t_34 * __pyx_v_self->fld->G.strides[1]) )) + __pyx_t_33)) )) = (((((-(*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ee.data + __pyx_t_24 * __pyx_v_self->fld->Ee.strides[0]) ) + __pyx_t_25 * __pyx_v_self->fld->Ee.strides[1]) )) + __pyx_t_26)) )))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S13.data + __pyx_t_29 * __pyx_v_self->fld->S13.strides[0]) ) + __pyx_t_28 * __pyx_v_self->fld->S13.strides[1]) )) + __pyx_t_27)) )))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Fe.data + __pyx_t_30 * __pyx_v_self->fld->Fe.strides[0]) ) + __pyx_t_31 * __pyx_v_self->fld->Fe.strides[1]) )) + __pyx_t_32)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S23.data + __pyx_t_23 * __pyx_v_self->fld->S23.strides[0]) ) + __pyx_t_22 * __pyx_v_self->fld->S23.strides[1]) )) + __pyx_t_21)) ))))) - ((*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->Ge.data + __pyx_t_12 * __pyx_v_self->fld->Ge.strides[0]) ) + __pyx_t_13 * __pyx_v_self->fld->Ge.strides[1]) )) + __pyx_t_14)) ))) * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->S33.data + __pyx_t_17 * __pyx_v_self->fld->S33.strides[0]) ) + __pyx_t_16 * __pyx_v_self->fld->S33.strides[1]) )) + __pyx_t_15)) ))))) - (__pyx_v_mucppr * (*((double *) ( /* dim=2 */ ((char *) (((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_self->fld->G.data + __pyx_t_18 * __pyx_v_self->fld->G.strides[0]) ) + __pyx_t_19 * __pyx_v_self->fld->G.strides[1]) )) + __pyx_t_20)) )))));
         }
       }
     }
   }
   __pyx_L3:;
 
-  /* "libfds/fluxes.pyx":784
+  /* "libfds/fluxes.pyx":862
  *                 self._fluxes_crv(sub.ix[0], sub.ix[1], sub.iy[0], sub.iy[1], sub.iz[0], sub.iz[1], sub.mp)
  * 
  *     cdef void _fluxes_crt(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         """  """
  * 
  */
 
   /* function exit code */
   __Pyx_RefNannyFinishContext();
 }
 
-/* "libfds/fluxes.pyx":857
+/* "libfds/fluxes.pyx":935
  *                                                 mucppr * self.fld.G[ix, iy, iz]
  * 
  *     cdef void _fluxes_crv(self, Py_ssize_t ixmin, Py_ssize_t ixmax, Py_ssize_t iymin, Py_ssize_t iymax, Py_ssize_t izmin, Py_ssize_t izmax, bint mp):             # <<<<<<<<<<<<<<
  *         pass
  * 
  */
 
@@ -13551,15 +13554,15 @@
   __Pyx_AddTraceback("libfds.fluxes._ViscousFluxes3d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":867
+/* "libfds/fluxes.pyx":958
  *     cdef Derivative2d dvx, dvy
  * 
  *     def __cinit__(self, fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -13588,26 +13591,26 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 867, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 958, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 867, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 958, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fluxes._Vorticity2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fluxes_12_Vorticity2d___cinit__(((struct __pyx_obj_6libfds_6fluxes__Vorticity2d *)__pyx_v_self), __pyx_v_fld);
 
@@ -13624,103 +13627,103 @@
   PyObject *__pyx_t_3 = NULL;
   PyObject *__pyx_t_4 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fluxes.pyx":869
+  /* "libfds/fluxes.pyx":960
  *     def __cinit__(self, fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         self.dvx = Derivative2d(self.fld.Ee, self.fld.E, self.fld.F, self.fld)
  */
-  if (!(likely(((__pyx_v_fld) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d))))) __PYX_ERR(0, 869, __pyx_L1_error)
+  if (!(likely(((__pyx_v_fld) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields2d))))) __PYX_ERR(0, 960, __pyx_L1_error)
   __pyx_t_1 = __pyx_v_fld;
   __Pyx_INCREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = ((struct __pyx_obj_6libfds_6fields_Fields2d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":871
+  /* "libfds/fluxes.pyx":962
  *         self.fld = fld
  * 
  *         self.dvx = Derivative2d(self.fld.Ee, self.fld.E, self.fld.F, self.fld)             # <<<<<<<<<<<<<<
  *         self.dvy = Derivative2d(self.fld.Fe, self.fld.E, self.fld.F, self.fld)
  * 
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 871, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 871, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 871, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 871, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(4); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
-  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 871, __pyx_L1_error)
+  __pyx_t_3 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 962, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_3);
   __Pyx_GOTREF(__pyx_v_self->dvx);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dvx));
   __pyx_v_self->dvx = ((struct __pyx_obj_6libfds_7libdiff_Derivative2d *)__pyx_t_3);
   __pyx_t_3 = 0;
 
-  /* "libfds/fluxes.pyx":872
+  /* "libfds/fluxes.pyx":963
  * 
  *         self.dvx = Derivative2d(self.fld.Ee, self.fld.E, self.fld.F, self.fld)
  *         self.dvy = Derivative2d(self.fld.Fe, self.fld.E, self.fld.F, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     def compute(self):
  */
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 872, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 872, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 872, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 2, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 872, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_2);
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 3, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 872, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative2d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 963, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->dvy);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dvy));
   __pyx_v_self->dvy = ((struct __pyx_obj_6libfds_7libdiff_Derivative2d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/fluxes.pyx":867
+  /* "libfds/fluxes.pyx":958
  *     cdef Derivative2d dvx, dvy
  * 
  *     def __cinit__(self, fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -13735,15 +13738,15 @@
   __Pyx_AddTraceback("libfds.fluxes._Vorticity2d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":874
+/* "libfds/fluxes.pyx":965
  *         self.dvy = Derivative2d(self.fld.Fe, self.fld.E, self.fld.F, self.fld)
  * 
  *     def compute(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate u and v and assign to Ee and Fe
  */
 
@@ -13761,51 +13764,51 @@
 }
 
 static PyObject *__pyx_pf_6libfds_6fluxes_12_Vorticity2d_2compute(struct __pyx_obj_6libfds_6fluxes__Vorticity2d *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("compute", 0);
 
-  /* "libfds/fluxes.pyx":877
+  /* "libfds/fluxes.pyx":968
  * 
  *         # Calculate u and v and assign to Ee and Fe
  *         self.fld.update('V')             # <<<<<<<<<<<<<<
  * 
  *         self.dvy.apply_x()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_V);
 
-  /* "libfds/fluxes.pyx":879
+  /* "libfds/fluxes.pyx":970
  *         self.fld.update('V')
  * 
  *         self.dvy.apply_x()             # <<<<<<<<<<<<<<
  *         self.dvx.apply_y()
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative2d *)__pyx_v_self->dvy->__pyx_vtab)->apply_x(__pyx_v_self->dvy, 0, NULL);
 
-  /* "libfds/fluxes.pyx":880
+  /* "libfds/fluxes.pyx":971
  * 
  *         self.dvy.apply_x()
  *         self.dvx.apply_y()             # <<<<<<<<<<<<<<
  * 
  *         self.fld.update('wz')
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative2d *)__pyx_v_self->dvx->__pyx_vtab)->apply_y(__pyx_v_self->dvx, 0, NULL);
 
-  /* "libfds/fluxes.pyx":882
+  /* "libfds/fluxes.pyx":973
  *         self.dvx.apply_y()
  * 
  *         self.fld.update('wz')             # <<<<<<<<<<<<<<
  * 
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields2d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_wz);
 
-  /* "libfds/fluxes.pyx":874
+  /* "libfds/fluxes.pyx":965
  *         self.dvy = Derivative2d(self.fld.Fe, self.fld.E, self.fld.F, self.fld)
  * 
  *     def compute(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate u and v and assign to Ee and Fe
  */
 
@@ -13925,15 +13928,15 @@
   __Pyx_AddTraceback("libfds.fluxes._Vorticity2d.__setstate_cython__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = NULL;
   __Pyx_XGIVEREF(__pyx_r);
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":891
+/* "libfds/fluxes.pyx":995
  *     cdef Derivative3d dvx, dvy, dvz
  * 
  *     def __cinit__(self, fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -13962,26 +13965,26 @@
       kw_args = PyDict_Size(__pyx_kwds);
       switch (pos_args) {
         case  0:
         if (likely((values[0] = __Pyx_PyDict_GetItemStr(__pyx_kwds, __pyx_n_s_fld)) != 0)) kw_args--;
         else goto __pyx_L5_argtuple_error;
       }
       if (unlikely(kw_args > 0)) {
-        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 891, __pyx_L3_error)
+        if (unlikely(__Pyx_ParseOptionalKeywords(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") < 0)) __PYX_ERR(0, 995, __pyx_L3_error)
       }
     } else if (PyTuple_GET_SIZE(__pyx_args) != 1) {
       goto __pyx_L5_argtuple_error;
     } else {
       values[0] = PyTuple_GET_ITEM(__pyx_args, 0);
     }
     __pyx_v_fld = values[0];
   }
   goto __pyx_L4_argument_unpacking_done;
   __pyx_L5_argtuple_error:;
-  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 891, __pyx_L3_error)
+  __Pyx_RaiseArgtupleInvalid("__cinit__", 1, 1, 1, PyTuple_GET_SIZE(__pyx_args)); __PYX_ERR(0, 995, __pyx_L3_error)
   __pyx_L3_error:;
   __Pyx_AddTraceback("libfds.fluxes._Vorticity3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __Pyx_RefNannyFinishContext();
   return -1;
   __pyx_L4_argument_unpacking_done:;
   __pyx_r = __pyx_pf_6libfds_6fluxes_12_Vorticity3d___cinit__(((struct __pyx_obj_6libfds_6fluxes__Vorticity3d *)__pyx_v_self), __pyx_v_fld);
 
@@ -13999,46 +14002,46 @@
   PyObject *__pyx_t_4 = NULL;
   PyObject *__pyx_t_5 = NULL;
   int __pyx_lineno = 0;
   const char *__pyx_filename = NULL;
   int __pyx_clineno = 0;
   __Pyx_RefNannySetupContext("__cinit__", 0);
 
-  /* "libfds/fluxes.pyx":893
+  /* "libfds/fluxes.pyx":997
  *     def __cinit__(self, fld):
  * 
  *         self.fld = fld             # <<<<<<<<<<<<<<
  * 
  *         self.dvx = Derivative3d(self.fld.Ee, self.fld.E, self.fld.F, self.fld.G, self.fld)
  */
-  if (!(likely(((__pyx_v_fld) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields3d))))) __PYX_ERR(0, 893, __pyx_L1_error)
+  if (!(likely(((__pyx_v_fld) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_fld, __pyx_ptype_6libfds_6fields_Fields3d))))) __PYX_ERR(0, 997, __pyx_L1_error)
   __pyx_t_1 = __pyx_v_fld;
   __Pyx_INCREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_1);
   __Pyx_GOTREF(__pyx_v_self->fld);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->fld));
   __pyx_v_self->fld = ((struct __pyx_obj_6libfds_6fields_Fields3d *)__pyx_t_1);
   __pyx_t_1 = 0;
 
-  /* "libfds/fluxes.pyx":895
+  /* "libfds/fluxes.pyx":999
  *         self.fld = fld
  * 
  *         self.dvx = Derivative3d(self.fld.Ee, self.fld.E, self.fld.F, self.fld.G, self.fld)             # <<<<<<<<<<<<<<
  *         self.dvy = Derivative3d(self.fld.Fe, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *         self.dvz = Derivative3d(self.fld.Ge, self.fld.E, self.fld.F, self.fld.G, self.fld)
  */
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ee, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = PyTuple_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_5 = PyTuple_New(5); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_5, 2, __pyx_t_3);
@@ -14047,39 +14050,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_5, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_1 = 0;
   __pyx_t_2 = 0;
   __pyx_t_3 = 0;
   __pyx_t_4 = 0;
-  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 895, __pyx_L1_error)
+  __pyx_t_4 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 999, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
   __Pyx_GIVEREF(__pyx_t_4);
   __Pyx_GOTREF(__pyx_v_self->dvx);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dvx));
   __pyx_v_self->dvx = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_4);
   __pyx_t_4 = 0;
 
-  /* "libfds/fluxes.pyx":896
+  /* "libfds/fluxes.pyx":1000
  * 
  *         self.dvx = Derivative3d(self.fld.Ee, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *         self.dvy = Derivative3d(self.fld.Fe, self.fld.E, self.fld.F, self.fld.G, self.fld)             # <<<<<<<<<<<<<<
  *         self.dvz = Derivative3d(self.fld.Ge, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  */
-  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_4 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Fe, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_1 = PyTuple_New(5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_4);
   PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_5);
   PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_t_5);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_t_3);
@@ -14088,39 +14091,39 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_1, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_4 = 0;
   __pyx_t_5 = 0;
   __pyx_t_3 = 0;
   __pyx_t_2 = 0;
-  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 896, __pyx_L1_error)
+  __pyx_t_2 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_1, NULL); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1000, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
   __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
   __Pyx_GIVEREF(__pyx_t_2);
   __Pyx_GOTREF(__pyx_v_self->dvy);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dvy));
   __pyx_v_self->dvy = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_2);
   __pyx_t_2 = 0;
 
-  /* "libfds/fluxes.pyx":897
+  /* "libfds/fluxes.pyx":1001
  *         self.dvx = Derivative3d(self.fld.Ee, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *         self.dvy = Derivative3d(self.fld.Fe, self.fld.E, self.fld.F, self.fld.G, self.fld)
  *         self.dvz = Derivative3d(self.fld.Ge, self.fld.E, self.fld.F, self.fld.G, self.fld)             # <<<<<<<<<<<<<<
  * 
  *     def compute(self):
  */
-  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ge, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_v_self->fld->Ge, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_2);
-  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_1 = __pyx_memoryview_fromslice(__pyx_v_self->fld->E, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_1);
-  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_v_self->fld->F, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_3);
-  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_5 = __pyx_memoryview_fromslice(__pyx_v_self->fld->G, 3, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);; if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
-  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_4 = PyTuple_New(5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_4);
   __Pyx_GIVEREF(__pyx_t_2);
   PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_2);
   __Pyx_GIVEREF(__pyx_t_1);
   PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_1);
   __Pyx_GIVEREF(__pyx_t_3);
   PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_t_3);
@@ -14129,24 +14132,24 @@
   __Pyx_INCREF(((PyObject *)__pyx_v_self->fld));
   __Pyx_GIVEREF(((PyObject *)__pyx_v_self->fld));
   PyTuple_SET_ITEM(__pyx_t_4, 4, ((PyObject *)__pyx_v_self->fld));
   __pyx_t_2 = 0;
   __pyx_t_1 = 0;
   __pyx_t_3 = 0;
   __pyx_t_5 = 0;
-  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 897, __pyx_L1_error)
+  __pyx_t_5 = __Pyx_PyObject_Call(((PyObject *)__pyx_ptype_6libfds_7libdiff_Derivative3d), __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1001, __pyx_L1_error)
   __Pyx_GOTREF(__pyx_t_5);
   __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
   __Pyx_GIVEREF(__pyx_t_5);
   __Pyx_GOTREF(__pyx_v_self->dvz);
   __Pyx_DECREF(((PyObject *)__pyx_v_self->dvz));
   __pyx_v_self->dvz = ((struct __pyx_obj_6libfds_7libdiff_Derivative3d *)__pyx_t_5);
   __pyx_t_5 = 0;
 
-  /* "libfds/fluxes.pyx":891
+  /* "libfds/fluxes.pyx":995
  *     cdef Derivative3d dvx, dvy, dvz
  * 
  *     def __cinit__(self, fld):             # <<<<<<<<<<<<<<
  * 
  *         self.fld = fld
  */
 
@@ -14162,15 +14165,15 @@
   __Pyx_AddTraceback("libfds.fluxes._Vorticity3d.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
   __pyx_r = -1;
   __pyx_L0:;
   __Pyx_RefNannyFinishContext();
   return __pyx_r;
 }
 
-/* "libfds/fluxes.pyx":899
+/* "libfds/fluxes.pyx":1003
  *         self.dvz = Derivative3d(self.fld.Ge, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  *     def compute(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate (u, v, w) and assign to (Ee, Fe, Ge)
  */
 
@@ -14188,102 +14191,102 @@
 }
 
 static PyObject *__pyx_pf_6libfds_6fluxes_12_Vorticity3d_2compute(struct __pyx_obj_6libfds_6fluxes__Vorticity3d *__pyx_v_self) {
   PyObject *__pyx_r = NULL;
   __Pyx_RefNannyDeclarations
   __Pyx_RefNannySetupContext("compute", 0);
 
-  /* "libfds/fluxes.pyx":902
+  /* "libfds/fluxes.pyx":1006
  * 
  *         # Calculate (u, v, w) and assign to (Ee, Fe, Ge)
  *         self.fld.update('V')             # <<<<<<<<<<<<<<
  * 
  *         self.dvz.apply_y()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_V);
 
-  /* "libfds/fluxes.pyx":904
+  /* "libfds/fluxes.pyx":1008
  *         self.fld.update('V')
  * 
  *         self.dvz.apply_y()             # <<<<<<<<<<<<<<
  *         self.dvy.apply_z()
  *         self.fld.update('wx')
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dvz->__pyx_vtab)->apply_y(__pyx_v_self->dvz, 0, NULL);
 
-  /* "libfds/fluxes.pyx":905
+  /* "libfds/fluxes.pyx":1009
  * 
  *         self.dvz.apply_y()
  *         self.dvy.apply_z()             # <<<<<<<<<<<<<<
  *         self.fld.update('wx')
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dvy->__pyx_vtab)->apply_z(__pyx_v_self->dvy, 0, NULL);
 
-  /* "libfds/fluxes.pyx":906
+  /* "libfds/fluxes.pyx":1010
  *         self.dvz.apply_y()
  *         self.dvy.apply_z()
  *         self.fld.update('wx')             # <<<<<<<<<<<<<<
  * 
  *         self.dvx.apply_z()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_wx);
 
-  /* "libfds/fluxes.pyx":908
+  /* "libfds/fluxes.pyx":1012
  *         self.fld.update('wx')
  * 
  *         self.dvx.apply_z()             # <<<<<<<<<<<<<<
  *         self.dvz.apply_x()
  *         self.fld.update('wy')
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dvx->__pyx_vtab)->apply_z(__pyx_v_self->dvx, 0, NULL);
 
-  /* "libfds/fluxes.pyx":909
+  /* "libfds/fluxes.pyx":1013
  * 
  *         self.dvx.apply_z()
  *         self.dvz.apply_x()             # <<<<<<<<<<<<<<
  *         self.fld.update('wy')
  * 
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dvz->__pyx_vtab)->apply_x(__pyx_v_self->dvz, 0, NULL);
 
-  /* "libfds/fluxes.pyx":910
+  /* "libfds/fluxes.pyx":1014
  *         self.dvx.apply_z()
  *         self.dvz.apply_x()
  *         self.fld.update('wy')             # <<<<<<<<<<<<<<
  * 
  *         self.dvy.apply_z()
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_wy);
 
-  /* "libfds/fluxes.pyx":912
+  /* "libfds/fluxes.pyx":1016
  *         self.fld.update('wy')
  * 
  *         self.dvy.apply_z()             # <<<<<<<<<<<<<<
  *         self.dvz.apply_y()
  *         self.fld.update('wz')
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dvy->__pyx_vtab)->apply_z(__pyx_v_self->dvy, 0, NULL);
 
-  /* "libfds/fluxes.pyx":913
+  /* "libfds/fluxes.pyx":1017
  * 
  *         self.dvy.apply_z()
  *         self.dvz.apply_y()             # <<<<<<<<<<<<<<
  *         self.fld.update('wz')
  */
   ((struct __pyx_vtabstruct_6libfds_7libdiff_Derivative3d *)__pyx_v_self->dvz->__pyx_vtab)->apply_y(__pyx_v_self->dvz, 0, NULL);
 
-  /* "libfds/fluxes.pyx":914
+  /* "libfds/fluxes.pyx":1018
  *         self.dvy.apply_z()
  *         self.dvz.apply_y()
  *         self.fld.update('wz')             # <<<<<<<<<<<<<<
  */
   ((struct __pyx_vtabstruct_6libfds_6fields_Fields3d *)__pyx_v_self->fld->__pyx_vtab)->update(__pyx_v_self->fld, __pyx_n_u_wz);
 
-  /* "libfds/fluxes.pyx":899
+  /* "libfds/fluxes.pyx":1003
  *         self.dvz = Derivative3d(self.fld.Ge, self.fld.E, self.fld.F, self.fld.G, self.fld)
  * 
  *     def compute(self):             # <<<<<<<<<<<<<<
  * 
  *         # Calculate (u, v, w) and assign to (Ee, Fe, Ge)
  */
 
@@ -28573,15 +28576,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
+  " 2d Eulerian fluxes calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_6fluxes__EulerianFluxes2d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_6fluxes__EulerianFluxes2d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_6fluxes__EulerianFluxes2d, /*tp_methods*/
@@ -28734,15 +28737,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
+  " 3d Eulerian fluxes calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_6fluxes__EulerianFluxes3d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_6fluxes__EulerianFluxes3d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_6fluxes__EulerianFluxes3d, /*tp_methods*/
@@ -28902,15 +28905,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  "\n\n\n    ", /*tp_doc*/
+  " 2d Viscous fluxes calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_6fluxes__ViscousFluxes2d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_6fluxes__ViscousFluxes2d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_6fluxes__ViscousFluxes2d, /*tp_methods*/
@@ -29086,15 +29089,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  "\n\n    ", /*tp_doc*/
+  " 3d Viscous fluxes calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_6fluxes__ViscousFluxes3d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_6fluxes__ViscousFluxes3d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_6fluxes__ViscousFluxes3d, /*tp_methods*/
@@ -29220,15 +29223,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
+  " 2d Vorticity calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields2d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_6fluxes__Vorticity2d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_6fluxes__Vorticity2d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_6fluxes__Vorticity2d, /*tp_methods*/
@@ -29362,15 +29365,15 @@
   0, /*tp_hash*/
   0, /*tp_call*/
   0, /*tp_str*/
   0, /*tp_getattro*/
   0, /*tp_setattro*/
   0, /*tp_as_buffer*/
   Py_TPFLAGS_DEFAULT|Py_TPFLAGS_HAVE_VERSION_TAG|Py_TPFLAGS_CHECKTYPES|Py_TPFLAGS_HAVE_NEWBUFFER|Py_TPFLAGS_HAVE_GC, /*tp_flags*/
-  0, /*tp_doc*/
+  " 3d Vorticity calculation using schemes described in [1]_. \n\n    Parameters\n    ----------\n    fld: Fields3d\n\n    References\n    ----------\n\n    .. [1] C. Bogey, C. Bailly, \"A family of low dispersive and low dissipative explicit schemes for\n           flow and noise computations\", Journal of Computational Physics, Volume 194, Issue 1, 2004, \n           Pages 194-214.\n    ", /*tp_doc*/
   __pyx_tp_traverse_6libfds_6fluxes__Vorticity3d, /*tp_traverse*/
   __pyx_tp_clear_6libfds_6fluxes__Vorticity3d, /*tp_clear*/
   0, /*tp_richcompare*/
   0, /*tp_weaklistoffset*/
   0, /*tp_iter*/
   0, /*tp_iternext*/
   __pyx_methods_6libfds_6fluxes__Vorticity3d, /*tp_methods*/
@@ -30131,17 +30134,17 @@
   #endif
   #if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX >= 0x03090000 && PY_VERSION_HEX < 0x030a0000
   0, /*tp_pypy_flags*/
   #endif
 };
 
 static PyMethodDef __pyx_methods[] = {
-  {"EulerianFluxes", (PyCFunction)__pyx_pw_6libfds_6fluxes_1EulerianFluxes, METH_O, 0},
-  {"ViscousFluxes", (PyCFunction)__pyx_pw_6libfds_6fluxes_3ViscousFluxes, METH_O, 0},
-  {"Vorticity", (PyCFunction)__pyx_pw_6libfds_6fluxes_5Vorticity, METH_O, 0},
+  {"EulerianFluxes", (PyCFunction)__pyx_pw_6libfds_6fluxes_1EulerianFluxes, METH_O, __pyx_doc_6libfds_6fluxes_EulerianFluxes},
+  {"ViscousFluxes", (PyCFunction)__pyx_pw_6libfds_6fluxes_3ViscousFluxes, METH_O, __pyx_doc_6libfds_6fluxes_2ViscousFluxes},
+  {"Vorticity", (PyCFunction)__pyx_pw_6libfds_6fluxes_5Vorticity, METH_O, __pyx_doc_6libfds_6fluxes_4Vorticity},
   {0, 0, 0, 0}
 };
 
 #if PY_MAJOR_VERSION >= 3
 #if CYTHON_PEP489_MULTI_PHASE_INIT
 static PyObject* __pyx_pymod_create(PyObject *spec, PyModuleDef *def); /*proto*/
 static int __pyx_pymod_exec_fluxes(PyObject* module); /*proto*/
@@ -30290,15 +30293,15 @@
   {&__pyx_n_s_update, __pyx_k_update, sizeof(__pyx_k_update), 0, 0, 1, 1},
   {&__pyx_n_u_wx, __pyx_k_wx, sizeof(__pyx_k_wx), 0, 1, 0, 1},
   {&__pyx_n_u_wy, __pyx_k_wy, sizeof(__pyx_k_wy), 0, 1, 0, 1},
   {&__pyx_n_u_wz, __pyx_k_wz, sizeof(__pyx_k_wz), 0, 1, 0, 1},
   {0, 0, 0, 0, 0, 0, 0}
 };
 static CYTHON_SMALL_CODE int __Pyx_InitCachedBuiltins(void) {
-  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 122, __pyx_L1_error)
+  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 168, __pyx_L1_error)
   __pyx_builtin_TypeError = __Pyx_GetBuiltinName(__pyx_n_s_TypeError); if (!__pyx_builtin_TypeError) __PYX_ERR(1, 2, __pyx_L1_error)
   __pyx_builtin_ImportError = __Pyx_GetBuiltinName(__pyx_n_s_ImportError); if (!__pyx_builtin_ImportError) __PYX_ERR(2, 944, __pyx_L1_error)
   __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 134, __pyx_L1_error)
   __pyx_builtin_MemoryError = __Pyx_GetBuiltinName(__pyx_n_s_MemoryError); if (!__pyx_builtin_MemoryError) __PYX_ERR(1, 149, __pyx_L1_error)
   __pyx_builtin_enumerate = __Pyx_GetBuiltinName(__pyx_n_s_enumerate); if (!__pyx_builtin_enumerate) __PYX_ERR(1, 152, __pyx_L1_error)
   __pyx_builtin_Ellipsis = __Pyx_GetBuiltinName(__pyx_n_s_Ellipsis); if (!__pyx_builtin_Ellipsis) __PYX_ERR(1, 406, __pyx_L1_error)
   __pyx_builtin_id = __Pyx_GetBuiltinName(__pyx_n_s_id); if (!__pyx_builtin_id) __PYX_ERR(1, 615, __pyx_L1_error)
@@ -30786,94 +30789,94 @@
   __pyx_vtabptr_6libfds_6fluxes__EulerianFluxes2d = &__pyx_vtable_6libfds_6fluxes__EulerianFluxes2d;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes2d.rk4 = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_rk4;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes2d.cout = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cout;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes2d.cin = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *))__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_cin;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes2d.fluxes = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *))__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d_fluxes;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes2d._fluxes_crt = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d__fluxes_crt;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes2d._fluxes_crv = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_17_EulerianFluxes2d__fluxes_crv;
-  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 82, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 115, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fluxes__EulerianFluxes2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fluxes__EulerianFluxes2d.tp_dictoffset && __pyx_type_6libfds_6fluxes__EulerianFluxes2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fluxes__EulerianFluxes2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__EulerianFluxes2d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 82, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_EulerianFluxes2d, (PyObject *)&__pyx_type_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 82, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 82, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__EulerianFluxes2d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 115, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_EulerianFluxes2d, (PyObject *)&__pyx_type_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 115, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__EulerianFluxes2d) < 0) __PYX_ERR(0, 115, __pyx_L1_error)
   __pyx_ptype_6libfds_6fluxes__EulerianFluxes2d = &__pyx_type_6libfds_6fluxes__EulerianFluxes2d;
   __pyx_vtabptr_6libfds_6fluxes__EulerianFluxes3d = &__pyx_vtable_6libfds_6fluxes__EulerianFluxes3d;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes3d.rk4 = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_rk4;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes3d.cout = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cout;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes3d.cin = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *))__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_cin;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes3d.fluxes = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *))__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d_fluxes;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes3d._fluxes_crt = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d__fluxes_crt;
   __pyx_vtable_6libfds_6fluxes__EulerianFluxes3d._fluxes_crv = (void (*)(struct __pyx_obj_6libfds_6fluxes__EulerianFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_17_EulerianFluxes3d__fluxes_crv;
-  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 286, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 332, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fluxes__EulerianFluxes3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fluxes__EulerianFluxes3d.tp_dictoffset && __pyx_type_6libfds_6fluxes__EulerianFluxes3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fluxes__EulerianFluxes3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__EulerianFluxes3d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 286, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_EulerianFluxes3d, (PyObject *)&__pyx_type_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 286, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 286, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__EulerianFluxes3d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 332, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_EulerianFluxes3d, (PyObject *)&__pyx_type_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 332, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__EulerianFluxes3d) < 0) __PYX_ERR(0, 332, __pyx_L1_error)
   __pyx_ptype_6libfds_6fluxes__EulerianFluxes3d = &__pyx_type_6libfds_6fluxes__EulerianFluxes3d;
   __pyx_vtabptr_6libfds_6fluxes__ViscousFluxes2d = &__pyx_vtable_6libfds_6fluxes__ViscousFluxes2d;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes2d.integrate = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_integrate;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes2d.fluxes = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *))__pyx_f_6libfds_6fluxes_16_ViscousFluxes2d_fluxes;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes2d._fluxes_crt = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_16_ViscousFluxes2d__fluxes_crt;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes2d._fluxes_crv = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes2d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_16_ViscousFluxes2d__fluxes_crv;
-  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 602, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fluxes__ViscousFluxes2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fluxes__ViscousFluxes2d.tp_dictoffset && __pyx_type_6libfds_6fluxes__ViscousFluxes2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fluxes__ViscousFluxes2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__ViscousFluxes2d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 602, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ViscousFluxes2d, (PyObject *)&__pyx_type_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 602, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 602, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__ViscousFluxes2d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ViscousFluxes2d, (PyObject *)&__pyx_type_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__ViscousFluxes2d) < 0) __PYX_ERR(0, 661, __pyx_L1_error)
   __pyx_ptype_6libfds_6fluxes__ViscousFluxes2d = &__pyx_type_6libfds_6fluxes__ViscousFluxes2d;
   __pyx_vtabptr_6libfds_6fluxes__ViscousFluxes3d = &__pyx_vtable_6libfds_6fluxes__ViscousFluxes3d;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes3d.integrate = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *, int __pyx_skip_dispatch))__pyx_f_6libfds_6fluxes_16_ViscousFluxes3d_integrate;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes3d.fluxes = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *))__pyx_f_6libfds_6fluxes_16_ViscousFluxes3d_fluxes;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes3d._fluxes_crt = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_16_ViscousFluxes3d__fluxes_crt;
   __pyx_vtable_6libfds_6fluxes__ViscousFluxes3d._fluxes_crv = (void (*)(struct __pyx_obj_6libfds_6fluxes__ViscousFluxes3d *, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, Py_ssize_t, int))__pyx_f_6libfds_6fluxes_16_ViscousFluxes3d__fluxes_crv;
-  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 721, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 789, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fluxes__ViscousFluxes3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fluxes__ViscousFluxes3d.tp_dictoffset && __pyx_type_6libfds_6fluxes__ViscousFluxes3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fluxes__ViscousFluxes3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__ViscousFluxes3d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 721, __pyx_L1_error)
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ViscousFluxes3d, (PyObject *)&__pyx_type_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 721, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 721, __pyx_L1_error)
+  if (__Pyx_SetVtable(__pyx_type_6libfds_6fluxes__ViscousFluxes3d.tp_dict, __pyx_vtabptr_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 789, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_ViscousFluxes3d, (PyObject *)&__pyx_type_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 789, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__ViscousFluxes3d) < 0) __PYX_ERR(0, 789, __pyx_L1_error)
   __pyx_ptype_6libfds_6fluxes__ViscousFluxes3d = &__pyx_type_6libfds_6fluxes__ViscousFluxes3d;
-  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__Vorticity2d) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__Vorticity2d) < 0) __PYX_ERR(0, 940, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fluxes__Vorticity2d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fluxes__Vorticity2d.tp_dictoffset && __pyx_type_6libfds_6fluxes__Vorticity2d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fluxes__Vorticity2d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Vorticity2d, (PyObject *)&__pyx_type_6libfds_6fluxes__Vorticity2d) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__Vorticity2d) < 0) __PYX_ERR(0, 862, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Vorticity2d, (PyObject *)&__pyx_type_6libfds_6fluxes__Vorticity2d) < 0) __PYX_ERR(0, 940, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__Vorticity2d) < 0) __PYX_ERR(0, 940, __pyx_L1_error)
   __pyx_ptype_6libfds_6fluxes__Vorticity2d = &__pyx_type_6libfds_6fluxes__Vorticity2d;
-  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__Vorticity3d) < 0) __PYX_ERR(0, 886, __pyx_L1_error)
+  if (PyType_Ready(&__pyx_type_6libfds_6fluxes__Vorticity3d) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type_6libfds_6fluxes__Vorticity3d.tp_print = 0;
   #endif
   if ((CYTHON_USE_TYPE_SLOTS && CYTHON_USE_PYTYPE_LOOKUP) && likely(!__pyx_type_6libfds_6fluxes__Vorticity3d.tp_dictoffset && __pyx_type_6libfds_6fluxes__Vorticity3d.tp_getattro == PyObject_GenericGetAttr)) {
     __pyx_type_6libfds_6fluxes__Vorticity3d.tp_getattro = __Pyx_PyObject_GenericGetAttrNoDict;
   }
-  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Vorticity3d, (PyObject *)&__pyx_type_6libfds_6fluxes__Vorticity3d) < 0) __PYX_ERR(0, 886, __pyx_L1_error)
-  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__Vorticity3d) < 0) __PYX_ERR(0, 886, __pyx_L1_error)
+  if (PyObject_SetAttr(__pyx_m, __pyx_n_s_Vorticity3d, (PyObject *)&__pyx_type_6libfds_6fluxes__Vorticity3d) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
+  if (__Pyx_setup_reduce((PyObject*)&__pyx_type_6libfds_6fluxes__Vorticity3d) < 0) __PYX_ERR(0, 977, __pyx_L1_error)
   __pyx_ptype_6libfds_6fluxes__Vorticity3d = &__pyx_type_6libfds_6fluxes__Vorticity3d;
   __pyx_vtabptr_array = &__pyx_vtable_array;
   __pyx_vtable_array.get_memview = (PyObject *(*)(struct __pyx_array_obj *))__pyx_array_get_memview;
   if (PyType_Ready(&__pyx_type___pyx_array) < 0) __PYX_ERR(1, 106, __pyx_L1_error)
   #if PY_VERSION_HEX < 0x030800B1
   __pyx_type___pyx_array.tp_print = 0;
   #endif
```

### Comparing `libfds-0.1.0/libfds/libdiff.c` & `libfds-0.2.0/libfds/libdiff.c`

 * *Files identical despite different names*

### Comparing `libfds-0.1.0/libfds/libfilt.c` & `libfds-0.2.0/libfds/libfilt.c`

 * *Files identical despite different names*

### Comparing `libfds-0.1.0/libfds.egg-info/PKG-INFO` & `libfds-0.2.0/libfds.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: libfds
-Version: 0.1.0
+Version: 0.2.0
 Summary: Finite difference library used by nsfds2/3
 Author: Cyril Desjouy
 Author-email: cyril.desjouy@univ-lemans.fr
 License: GPL
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: Python :: 3
 Classifier: Intended Audience :: Science/Research
```

### Comparing `libfds-0.1.0/setup.py` & `libfds-0.2.0/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -110,15 +110,15 @@
 
 setup(
 
     name='libfds',
     description="Finite difference library used by nsfds2/3",
     #    long_description=open('README.md').read(),
     long_description_content_type='text/markdown',
-    version='0.1.0',
+    version='0.2.0',
     license="GPL",
     author="Cyril Desjouy",
     author_email="cyril.desjouy@univ-lemans.fr",
     install_requires=["numpy"],
     cmdclass={'build_ext': build_ext},
     setup_requires=['numpy'],
     ext_modules=extensions,
```

