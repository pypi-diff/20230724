# Comparing `tmp/scoamp-0.4.0a2-py3-none-any.whl.zip` & `tmp/scoamp-0.4.0a3-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,24 +1,24 @@
-Zip file size: 26519 bytes, number of entries: 22
--rw-r--r--  2.0 unx       24 b- defN 23-Jul-20 09:19 scoamp/__init__.py
+Zip file size: 26687 bytes, number of entries: 22
+-rw-r--r--  2.0 unx       24 b- defN 23-Jul-21 10:35 scoamp/__init__.py
 -rw-r--r--  2.0 unx     7991 b- defN 23-Jul-14 11:03 scoamp/api.py
 -rw-r--r--  2.0 unx     2212 b- defN 23-Jul-13 12:34 scoamp/globals.py
--rw-r--r--  2.0 unx    14701 b- defN 23-Jul-20 09:12 scoamp/toolkit.py
+-rw-r--r--  2.0 unx    15216 b- defN 23-Jul-21 10:32 scoamp/toolkit.py
 -rw-r--r--  2.0 unx      486 b- defN 23-Jun-06 04:20 scoamp/commands/__init__.py
--rw-r--r--  2.0 unx     4405 b- defN 23-Jul-18 04:16 scoamp/commands/api.py
+-rw-r--r--  2.0 unx     4381 b- defN 23-Jul-21 09:46 scoamp/commands/api.py
 -rw-r--r--  2.0 unx     7581 b- defN 23-Jun-06 04:20 scoamp/commands/lfs.py
 -rw-r--r--  2.0 unx     2135 b- defN 23-Jun-06 04:20 scoamp/schema/public-model-meta.json
 -rw-r--r--  2.0 unx        0 b- defN 23-Jun-06 04:20 scoamp/utils/__init__.py
 -rw-r--r--  2.0 unx     5080 b- defN 23-Jun-27 08:29 scoamp/utils/api_utils.py
 -rw-r--r--  2.0 unx      501 b- defN 23-Jul-13 08:00 scoamp/utils/decrypt.py
 -rw-r--r--  2.0 unx     1779 b- defN 23-Jul-20 09:14 scoamp/utils/error.py
 -rw-r--r--  2.0 unx     5150 b- defN 23-Jul-13 07:42 scoamp/utils/helper.py
 -rw-r--r--  2.0 unx      421 b- defN 23-Jul-20 09:08 scoamp/utils/logger.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Jun-27 08:29 tests/__init__.py
 -rw-r--r--  2.0 unx     9110 b- defN 23-Jun-27 08:29 tests/test_utils_helper.py
--rw-r--r--  2.0 unx    11334 b- defN 23-Jul-20 09:20 scoamp-0.4.0a2.dist-info/LICENSE
--rw-r--r--  2.0 unx     1239 b- defN 23-Jul-20 09:20 scoamp-0.4.0a2.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jul-20 09:20 scoamp-0.4.0a2.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 23-Jul-20 09:20 scoamp-0.4.0a2.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       13 b- defN 23-Jul-20 09:20 scoamp-0.4.0a2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     1742 b- defN 23-Jul-20 09:20 scoamp-0.4.0a2.dist-info/RECORD
-22 files, 76043 bytes uncompressed, 23711 bytes compressed:  68.8%
+-rw-r--r--  2.0 unx    11334 b- defN 23-Jul-21 10:36 scoamp-0.4.0a3.dist-info/LICENSE
+-rw-r--r--  2.0 unx     1239 b- defN 23-Jul-21 10:36 scoamp-0.4.0a3.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jul-21 10:36 scoamp-0.4.0a3.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 23-Jul-21 10:36 scoamp-0.4.0a3.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       13 b- defN 23-Jul-21 10:36 scoamp-0.4.0a3.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     1742 b- defN 23-Jul-21 10:36 scoamp-0.4.0a3.dist-info/RECORD
+22 files, 76534 bytes uncompressed, 23879 bytes compressed:  68.8%
```

## zipnote {}

```diff
@@ -42,26 +42,26 @@
 
 Filename: tests/__init__.py
 Comment: 
 
 Filename: tests/test_utils_helper.py
 Comment: 
 
-Filename: scoamp-0.4.0a2.dist-info/LICENSE
+Filename: scoamp-0.4.0a3.dist-info/LICENSE
 Comment: 
 
-Filename: scoamp-0.4.0a2.dist-info/METADATA
+Filename: scoamp-0.4.0a3.dist-info/METADATA
 Comment: 
 
-Filename: scoamp-0.4.0a2.dist-info/WHEEL
+Filename: scoamp-0.4.0a3.dist-info/WHEEL
 Comment: 
 
-Filename: scoamp-0.4.0a2.dist-info/entry_points.txt
+Filename: scoamp-0.4.0a3.dist-info/entry_points.txt
 Comment: 
 
-Filename: scoamp-0.4.0a2.dist-info/top_level.txt
+Filename: scoamp-0.4.0a3.dist-info/top_level.txt
 Comment: 
 
-Filename: scoamp-0.4.0a2.dist-info/RECORD
+Filename: scoamp-0.4.0a3.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## scoamp/__init__.py

```diff
@@ -1 +1 @@
-__version__ = '0.4.0a2'
+__version__ = '0.4.0a3'
```

## scoamp/toolkit.py

```diff
@@ -10,15 +10,15 @@
 from filelock import FileLock
 from requests.adapters import Retry
 from tqdm import tqdm
 from urllib.parse import urlparse, urlunparse
 
 from scoamp.globals import global_api as api
 from scoamp.globals import Environment
-from scoamp.utils.error import FileDownloadError, APIError
+from scoamp.utils.error import FileDownloadError, APIError, SubprocessError
 from scoamp.utils.logger import get_logger
 
 logger = get_logger()
 
 def model_file_list(
     model_id: str,
     *,
@@ -360,14 +360,15 @@
         model_info = api.get_user_model_info(model_id)
         if not allow_exist:
             raise ValueError(f"model id '{model_id}' has been exists at amp")
         files = model_file_list(model_id)
         # ensure has only one file, and must named '.gitattributes'
         if len(files) != 1 or files[0]['path'] != '.gitattributes':
             raise ValueError(f"invalid remote model repo '{model_id}': has more than one file")
+        logger.warning("model has been created on AMP before, resuse it!")
     except APIError as err:
         if err.status_code != 404: raise
         # create a new one
         model_info = api.create_user_model(model_id, model_space_name)
     git_url = model_info['repository_uri']
     logger.info(f"remote model url: {git_url}")
 
@@ -385,25 +386,34 @@
         r = subprocess.run(f'git clone {authed_git_url} {tmp_git_dir_path}', shell=True, check=False, capture_output=True, encoding='utf-8')
         if r.returncode:
             raise RuntimeError(f'git clone remote model error: {r.stderr}')
         
         logger.info('upload local model to remote repo...')
 
         shell_script = f"""
-        set -e
+        set -ex
         git config user.name 'scoamp-agent'
         git config user.email 'scoamp-agent@sensecore.cn'
         scoamp lfs setup .
         git --work-tree {local_dir_path} add --no-all .
         git commit -m 'add model files'
         git push origin master
         """
 
-        r = subprocess.run(
-            shell_script,
-            shell=True,
-            check=True,
-            cwd=tmp_git_dir_path,
-            capture_output=True
-        )
+        try:
+            subprocess.run(
+                shell_script,
+                shell=True,
+                check=True,
+                cwd=tmp_git_dir_path,
+                capture_output=True,
+                encoding='utf-8',
+            )
+        except subprocess.CalledProcessError as exc:
+            logger.error("something error when uploading local model files to AMP")
+            raise SubprocessError(
+                f"run sub-process error, see details below\n"\
+                f"[origin output]\n{exc.stderr}\n"\
+                f"[exit code]\n{exc.returncode}"
+            )
 
     return git_url
```

## scoamp/commands/api.py

```diff
@@ -120,15 +120,14 @@
     #auth = load_auth()
 
     # make request
     #from scoamp.api import set_auth_info, set_endpoint
     #set_endpoint(auth.endpoint)
     #set_auth_info(auth.access_key, auth.secret_key)
 
-    #from scoamp.globals import global_api
-    space_name = 'xxxxx'
+    from scoamp.globals import global_api
+    space_name = 'a520a4e0-b4a3-4746-8117-ee81925ab272'
     from scoamp.toolkit import create_and_upload_model
-    #r = create_and_upload_model('test-0714-3', 'repo1', space_name, allow_exist=True)
-    r = create_and_upload_model('test-0714-3', 'TODO', 'xxx')
+    r = create_and_upload_model('test-0721-1', 'example/model1', space_name, allow_exist=True)
     print(r)
```

## Comparing `scoamp-0.4.0a2.dist-info/LICENSE` & `scoamp-0.4.0a3.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `scoamp-0.4.0a2.dist-info/METADATA` & `scoamp-0.4.0a3.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: scoamp
-Version: 0.4.0a2
+Version: 0.4.0a3
 Summary: SenseCore AI Model Platform Command Line Tool
 Author: SenseTime, Inc.
 Author-email: hpan@sensetime.com
 License: Apache 2.0
 Keywords: machine-learning deep-learning models
 Classifier: License :: OSI Approved :: Apache Software License
 Classifier: Operating System :: OS Independent
```

## Comparing `scoamp-0.4.0a2.dist-info/RECORD` & `scoamp-0.4.0a3.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,22 +1,22 @@
-scoamp/__init__.py,sha256=yOYhZuDQfzd13XlFZmcbgO7OEZK5cWh6Ov3h39MWJ5w,24
+scoamp/__init__.py,sha256=grwYdZgmq_CjrYrqng6OLRTMVDWfoVSGwTqiOZ0qvq4,24
 scoamp/api.py,sha256=uJNzWsra5PVxCNSd2XysKNffAxR7f_lXoswDgeua4jA,7991
 scoamp/globals.py,sha256=5YSnbgclYWmPEcgQZK0mUXqqijb7-MMK5HeIeeshK4o,2212
-scoamp/toolkit.py,sha256=dx0cKgNoQH5vGZ-1afJj7YapdkotQ6IxFuuDDgtQzjU,14701
+scoamp/toolkit.py,sha256=U0XDgyfyR_5FD-_pH6bLXV5jvuWXFcB5skeDHYUEUT4,15216
 scoamp/commands/__init__.py,sha256=y1F-rP1F_zPOEYhMd_wRmC9a6ZZyr9QcE4GWkIbT0og,486
-scoamp/commands/api.py,sha256=h50jqMpm2SwjeUqS1v16305nvHuy5xf4fXDBHVws670,4405
+scoamp/commands/api.py,sha256=gL_0BFSJi0hw3umtSRPY5h2cgDnKDOqYQpTGrthYxZE,4381
 scoamp/commands/lfs.py,sha256=YA4Zj7W7lzoYQF-ulcG1bRgnJ0TXyi_D0JE4aLNNJzU,7581
 scoamp/schema/public-model-meta.json,sha256=EIQMSVftVNCt6GS6-x9XbKirK-SS75mJRKMsFQWCsEg,2135
 scoamp/utils/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 scoamp/utils/api_utils.py,sha256=P9JHJl2KHOqspJrHMOsLvJl-FY3CpjBWDjglNncGQHU,5080
 scoamp/utils/decrypt.py,sha256=EUaCTnBnp2aoh5RXwGB9-Gd81W-j23Zubmh68Rv_To8,501
 scoamp/utils/error.py,sha256=oLeuhUsB-pc3pi8o5kZNpB4lZcK-H4JtSjDdIMOjE_Q,1779
 scoamp/utils/helper.py,sha256=KLH089HaSyENxYb0c0o9b1aUJgvnGWL6GYInAfEdEF0,5150
 scoamp/utils/logger.py,sha256=YpQWJbDfWtGG9kpRcGefULZVLYu34zXkCDjPvZTeZLY,421
 tests/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 tests/test_utils_helper.py,sha256=gFx9h7jjiCao2hbZoT_ES08xtrFRizfPLIvp17uronQ,9110
-scoamp-0.4.0a2.dist-info/LICENSE,sha256=R-z_qud7owqMORJyRv9VAVEhRkcRWJOyCJnyCG4Ds5E,11334
-scoamp-0.4.0a2.dist-info/METADATA,sha256=N5ieGckMjmEqmhuCTADoqtmntPhA8apRzXTrdAZC5RU,1239
-scoamp-0.4.0a2.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-scoamp-0.4.0a2.dist-info/entry_points.txt,sha256=2_nLlE4zJ0B1KOQHAxdSH7jHNesWCZXKXSCmtlSBm1A,47
-scoamp-0.4.0a2.dist-info/top_level.txt,sha256=R-1KO00uSz-w1PWLRS6mRHjNP5yFJIKSrafHwVzvYBU,13
-scoamp-0.4.0a2.dist-info/RECORD,,
+scoamp-0.4.0a3.dist-info/LICENSE,sha256=R-z_qud7owqMORJyRv9VAVEhRkcRWJOyCJnyCG4Ds5E,11334
+scoamp-0.4.0a3.dist-info/METADATA,sha256=duUCP5JHNvO6pP6hLsetSV0K2EmuS_oU6Rslb2vj6sQ,1239
+scoamp-0.4.0a3.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+scoamp-0.4.0a3.dist-info/entry_points.txt,sha256=2_nLlE4zJ0B1KOQHAxdSH7jHNesWCZXKXSCmtlSBm1A,47
+scoamp-0.4.0a3.dist-info/top_level.txt,sha256=R-1KO00uSz-w1PWLRS6mRHjNP5yFJIKSrafHwVzvYBU,13
+scoamp-0.4.0a3.dist-info/RECORD,,
```

